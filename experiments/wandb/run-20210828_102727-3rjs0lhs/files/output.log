Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0828 10:27:34.207618 139804919769088 run_experiment.py:549] Creating TrainRunner ...
I0828 10:27:34.215474 139804919769088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:27:34.215653 139804919769088 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:27:34.215747 139804919769088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:27:34.215811 139804919769088 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:27:34.215879 139804919769088 dqn_agent.py:275] 	 update_period: 4
I0828 10:27:34.215983 139804919769088 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:27:34.216065 139804919769088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:27:34.216148 139804919769088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:27:34.216202 139804919769088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:27:34.216253 139804919769088 dqn_agent.py:280] 	 optimizer: adam
I0828 10:27:34.216304 139804919769088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:27:34.216355 139804919769088 dqn_agent.py:283] 	 seed: 1630146454215424
I0828 10:27:34.219842 139804919769088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:27:34.220101 139804919769088 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:27:34.220316 139804919769088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:27:34.220449 139804919769088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:27:34.220534 139804919769088 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:27:34.220638 139804919769088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:27:34.220736 139804919769088 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:27:34.221188 139804919769088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:27:34.221366 139804919769088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:27:34.265777 139804919769088 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:34.813898 139804919769088 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:34.829557 139804919769088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:27:34.838217 139804919769088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:27:34.838428 139804919769088 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:27:34.838572 139804919769088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:27:34.838885 139804919769088 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:27:34.839204 139804919769088 dqn_agent.py:275] 	 update_period: 4
I0828 10:27:34.839392 139804919769088 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:27:34.839548 139804919769088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:27:34.839711 139804919769088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:27:34.839834 139804919769088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:27:34.839992 139804919769088 dqn_agent.py:280] 	 optimizer: adam
I0828 10:27:34.840127 139804919769088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:27:34.840250 139804919769088 dqn_agent.py:283] 	 seed: 1630146454838163
I0828 10:27:34.843213 139804919769088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:27:34.843393 139804919769088 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:27:34.843579 139804919769088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:27:34.843715 139804919769088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:27:34.843825 139804919769088 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:27:34.843931 139804919769088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:27:34.844037 139804919769088 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:27:34.844140 139804919769088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:27:34.844257 139804919769088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:27:34.878546 139804919769088 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:34.900589 139804919769088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:27:34.900867 139804919769088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.89
I0828 10:27:41.485498 139804919769088 replay_runner.py:36] Average training steps per second: 151.89
Steps executed: 206 Episode length: 16 Return: 16.0
I0828 10:27:42.678861 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.73
INFO:tensorflow:Starting iteration 1
I0828 10:27:42.868602 139804919769088 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 207.56
I0828 10:27:47.686826 139804919769088 replay_runner.py:36] Average training steps per second: 207.56

Steps executed: 202 Episode length: 102 Return: 102.0
INFO:tensorflow:Starting iteration 2

Steps executed: 283 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 211.19
I0828 10:27:52.732495 139804919769088 replay_runner.py:36] Average training steps per second: 211.19
I0828 10:27:52.892372 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 3

Steps executed: 266 Episode length: 89 Return: 89.0.0
INFO:tensorflow:Average training steps per second: 212.76
I0828 10:27:57.751979 139804919769088 replay_runner.py:36] Average training steps per second: 212.76
I0828 10:27:57.955022 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 88.67
INFO:tensorflow:Starting iteration 4

Steps executed: 211 Episode length: 108 Return: 108.0
INFO:tensorflow:Average training steps per second: 207.25
I0828 10:28:02.951183 139804919769088 replay_runner.py:36] Average training steps per second: 207.25
I0828 10:28:03.125486 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 105.50
INFO:tensorflow:Starting iteration 5

Steps executed: 283 Episode length: 97 Return: 97.0.0
INFO:tensorflow:Average training steps per second: 188.59
I0828 10:28:08.631978 139804919769088 replay_runner.py:36] Average training steps per second: 188.59
I0828 10:28:08.818126 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 94.33
INFO:tensorflow:Starting iteration 6

Steps executed: 240 Episode length: 79 Return: 79.0.0
INFO:tensorflow:Average training steps per second: 191.79
I0828 10:28:14.214665 139804919769088 replay_runner.py:36] Average training steps per second: 191.79
I0828 10:28:14.377136 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 80.00
INFO:tensorflow:Starting iteration 7

Steps executed: 214 Episode length: 60 Return: 60.0.0
INFO:tensorflow:Average training steps per second: 194.59
I0828 10:28:19.706301 139804919769088 replay_runner.py:36] Average training steps per second: 194.59
I0828 10:28:19.854466 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 71.33
INFO:tensorflow:Starting iteration 8

Steps executed: 219 Episode length: 85 Return: 85.0.0
INFO:tensorflow:Average training steps per second: 194.18
I0828 10:28:25.192610 139804919769088 replay_runner.py:36] Average training steps per second: 194.18
I0828 10:28:25.346743 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 109.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.10
I0828 10:28:30.616199 139804919769088 replay_runner.py:36] Average training steps per second: 197.10
I0828 10:28:30.756930 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0828 10:28:30.951534 139804919769088 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 194.87
I0828 10:28:36.083685 139804919769088 replay_runner.py:36] Average training steps per second: 194.87
I0828 10:28:36.220138 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11
I0828 10:28:36.409819 139804919769088 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 195.20
I0828 10:28:41.533194 139804919769088 replay_runner.py:36] Average training steps per second: 195.20
I0828 10:28:41.668835 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 315 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 194.65
I0828 10:28:47.000161 139804919769088 replay_runner.py:36] Average training steps per second: 194.65
I0828 10:28:47.198613 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.46
I0828 10:28:52.610486 139804919769088 replay_runner.py:36] Average training steps per second: 191.46
I0828 10:28:52.756784 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0828 10:28:52.935207 139804919769088 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 198.17

Steps executed: 364 Episode length: 192 Return: 192.0
I0828 10:28:58.231536 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.58
I0828 10:29:03.548938 139804919769088 replay_runner.py:36] Average training steps per second: 195.58
I0828 10:29:03.688649 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 227 Episode length: 110 Return: 110.0
INFO:tensorflow:Average training steps per second: 196.90
I0828 10:29:08.963246 139804919769088 replay_runner.py:36] Average training steps per second: 196.90
I0828 10:29:09.123405 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.50
INFO:tensorflow:Starting iteration 17

Steps executed: 308 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 195.75
I0828 10:29:14.414336 139804919769088 replay_runner.py:36] Average training steps per second: 195.75
I0828 10:29:14.616785 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 18

Steps executed: 248 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 194.34
I0828 10:29:19.952158 139804919769088 replay_runner.py:36] Average training steps per second: 194.34
I0828 10:29:20.115944 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 19

Steps executed: 354 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 201.34
I0828 10:29:25.269217 139804919769088 replay_runner.py:36] Average training steps per second: 201.34
I0828 10:29:25.516193 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 20

Steps executed: 214 Episode length: 107 Return: 107.0
INFO:tensorflow:Average training steps per second: 197.59
I0828 10:29:30.773538 139804919769088 replay_runner.py:36] Average training steps per second: 197.59
I0828 10:29:30.923086 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.00
INFO:tensorflow:Starting iteration 21

Steps executed: 159 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 194.52

Steps executed: 310 Episode length: 151 Return: 151.0
I0828 10:29:36.478495 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 22

Steps executed: 210 Episode length: 30 Return: 30.0.0
INFO:tensorflow:Average training steps per second: 192.00
I0828 10:29:41.885957 139804919769088 replay_runner.py:36] Average training steps per second: 192.00
I0828 10:29:42.021841 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.25
INFO:tensorflow:Starting iteration 23

Steps executed: 239 Episode length: 80 Return: 80.0.0
INFO:tensorflow:Average training steps per second: 188.72
I0828 10:29:47.506718 139804919769088 replay_runner.py:36] Average training steps per second: 188.72
I0828 10:29:47.665968 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.67
INFO:tensorflow:Starting iteration 24

Steps executed: 243 Episode length: 83 Return: 83.0.0
INFO:tensorflow:Average training steps per second: 199.05
I0828 10:29:52.879554 139804919769088 replay_runner.py:36] Average training steps per second: 199.05
I0828 10:29:53.051474 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 81.00
INFO:tensorflow:Starting iteration 25

Steps executed: 245 Episode length: 80 Return: 80.0.0
INFO:tensorflow:Average training steps per second: 194.76
I0828 10:29:58.374156 139804919769088 replay_runner.py:36] Average training steps per second: 194.76
I0828 10:29:58.538705 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 81.67
INFO:tensorflow:Starting iteration 26

Steps executed: 233 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 197.98
I0828 10:30:03.776542 139804919769088 replay_runner.py:36] Average training steps per second: 197.98
I0828 10:30:03.942610 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.50
INFO:tensorflow:Starting iteration 27

Steps executed: 249 Episode length: 83 Return: 83.0.0
INFO:tensorflow:Average training steps per second: 197.14
I0828 10:30:09.209761 139804919769088 replay_runner.py:36] Average training steps per second: 197.14
I0828 10:30:09.365485 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 83.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.33
I0828 10:30:14.801325 139804919769088 replay_runner.py:36] Average training steps per second: 190.33
I0828 10:30:14.938001 139804919769088 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 258 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 209.49
I0828 10:30:20.083319 139804919769088 replay_runner.py:36] Average training steps per second: 209.49

Done fixed training!Episode length: 129 Return: 129.0