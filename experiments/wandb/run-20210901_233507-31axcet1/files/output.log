Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 23:35:13.795393 140156774885376 run_experiment.py:549] Creating TrainRunner ...
I0901 23:35:13.802756 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:13.803059 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:13.803254 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:13.803419 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:13.803530 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:13.803646 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:13.803773 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:13.804106 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:13.804263 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:13.804393 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:13.804479 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:13.804554 140156774885376 dqn_agent.py:283] 	 seed: 1630539313802685
I0901 23:35:13.807137 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:13.807261 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:35:13.807340 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:13.807404 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:13.807462 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:13.807549 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:13.807647 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:13.807772 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:13.807832 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:13.835825 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:14.256073 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:14.270143 140156774885376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:35:14.277736 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:14.277968 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:14.278077 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:14.278255 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:14.278368 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:14.278514 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:14.278622 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:14.278738 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:14.278816 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:14.278976 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:14.279798 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:14.279974 140156774885376 dqn_agent.py:283] 	 seed: 1630539314277686
I0901 23:35:14.292962 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:14.293291 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:35:14.293420 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:14.293510 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:14.293620 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:14.299013 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:14.308833 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:14.309137 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:14.309320 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:14.337870 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:14.358689 140156774885376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:35:14.359006 140156774885376 replay_runner.py:41] Starting iteration 0
Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 169.20
I0901 23:35:20.269853 140156774885376 replay_runner.py:36] Average training steps per second: 169.20
I0901 23:35:21.288971 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1
I0901 23:35:21.485650 140156774885376 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 201.24
I0901 23:35:26.462578 140156774885376 replay_runner.py:36] Average training steps per second: 201.24
I0901 23:35:26.592739 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 2


Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 200.25
I0901 23:35:31.772359 140156774885376 replay_runner.py:36] Average training steps per second: 200.25
I0901 23:35:31.910338 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 3

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 196.20
I0901 23:35:37.189041 140156774885376 replay_runner.py:36] Average training steps per second: 196.20
I0901 23:35:37.329392 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 4

Steps executed: 211 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 196.55
I0901 23:35:42.595526 140156774885376 replay_runner.py:36] Average training steps per second: 196.55
I0901 23:35:42.751331 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.59
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 189.89
I0901 23:35:48.216765 140156774885376 replay_runner.py:36] Average training steps per second: 189.89
I0901 23:35:48.362490 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6

Steps executed: 155 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.68

Steps executed: 201 Episode length: 10 Return: 10.0
I0901 23:35:53.759750 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 7

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.23
I0901 23:35:59.020985 140156774885376 replay_runner.py:36] Average training steps per second: 197.23
I0901 23:35:59.160523 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 8

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 194.26
I0901 23:36:04.477283 140156774885376 replay_runner.py:36] Average training steps per second: 194.26
I0901 23:36:04.621390 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 9

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.43
I0901 23:36:09.977231 140156774885376 replay_runner.py:36] Average training steps per second: 193.43
I0901 23:36:10.127276 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 10

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.17
I0901 23:36:15.415221 140156774885376 replay_runner.py:36] Average training steps per second: 196.17
I0901 23:36:15.552947 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.83
I0901 23:36:20.849247 140156774885376 replay_runner.py:36] Average training steps per second: 195.83
I0901 23:36:20.994265 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 12

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 199.86
I0901 23:36:26.202978 140156774885376 replay_runner.py:36] Average training steps per second: 199.86
I0901 23:36:26.341404 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.71
INFO:tensorflow:Starting iteration 13
I0901 23:36:26.528111 140156774885376 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 190.97
I0901 23:36:31.764935 140156774885376 replay_runner.py:36] Average training steps per second: 190.97

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Starting iteration 14

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.00
I0901 23:36:37.160538 140156774885376 replay_runner.py:36] Average training steps per second: 198.00
I0901 23:36:37.312489 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 15

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 194.42
I0901 23:36:42.652253 140156774885376 replay_runner.py:36] Average training steps per second: 194.42
I0901 23:36:42.800022 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 16
I0901 23:36:42.969660 140156774885376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 194.90

Steps executed: 207 Episode length: 10 Return: 10.0
I0901 23:36:48.260471 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 17

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.20
I0901 23:36:53.581240 140156774885376 replay_runner.py:36] Average training steps per second: 195.20
I0901 23:36:53.724853 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 18

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 192.06
I0901 23:36:59.118801 140156774885376 replay_runner.py:36] Average training steps per second: 192.06
I0901 23:36:59.260730 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 19

Steps executed: 202 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 195.01
I0901 23:37:04.569412 140156774885376 replay_runner.py:36] Average training steps per second: 195.01
I0901 23:37:04.718190 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 20

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.50
I0901 23:37:10.080871 140156774885376 replay_runner.py:36] Average training steps per second: 193.50
I0901 23:37:10.213119 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 21

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 192.96
I0901 23:37:15.581889 140156774885376 replay_runner.py:36] Average training steps per second: 192.96
I0901 23:37:15.724678 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 22

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 199.90
I0901 23:37:20.920087 140156774885376 replay_runner.py:36] Average training steps per second: 199.90
I0901 23:37:21.063838 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 23

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 194.41
I0901 23:37:26.420635 140156774885376 replay_runner.py:36] Average training steps per second: 194.41
I0901 23:37:26.560111 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 24

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.91
I0901 23:37:31.777676 140156774885376 replay_runner.py:36] Average training steps per second: 198.91
I0901 23:37:31.936124 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 25

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.35
I0901 23:37:37.430055 140156774885376 replay_runner.py:36] Average training steps per second: 195.35
I0901 23:37:37.566946 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 26

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.70
I0901 23:37:42.916088 140156774885376 replay_runner.py:36] Average training steps per second: 193.70
I0901 23:37:43.060655 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 27

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.81
I0901 23:37:48.284482 140156774885376 replay_runner.py:36] Average training steps per second: 198.81
I0901 23:37:48.416337 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 191.58
I0901 23:37:53.831439 140156774885376 replay_runner.py:36] Average training steps per second: 191.58
I0901 23:37:53.972803 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 205.31
I0901 23:37:59.073398 140156774885376 replay_runner.py:36] Average training steps per second: 205.31
I0901 23:37:59.220613 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09