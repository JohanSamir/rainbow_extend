I0910 11:19:16.446099 140501590198272 run_experiment.py:549] Creating TrainRunner ...
I0910 11:19:16.452686 140501590198272 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:16.452820 140501590198272 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:16.452893 140501590198272 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:16.452955 140501590198272 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:16.453009 140501590198272 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:16.453090 140501590198272 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:16.453146 140501590198272 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:16.453235 140501590198272 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:16.453305 140501590198272 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:16.453378 140501590198272 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:16.453448 140501590198272 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:16.453534 140501590198272 dqn_agent.py:283] 	 seed: 1631272756452649
I0910 11:19:16.455165 140501590198272 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:16.455281 140501590198272 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:16.455358 140501590198272 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:16.455421 140501590198272 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:16.455477 140501590198272 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:16.455530 140501590198272 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:16.455600 140501590198272 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:16.455679 140501590198272 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:16.455733 140501590198272 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:16.479386 140501590198272 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:16.498997 140501590198272 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:16.499187 140501590198272 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:16.499289 140501590198272 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:16.499395 140501590198272 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:16.499457 140501590198272 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:16.499513 140501590198272 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:16.499568 140501590198272 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:16.499652 140501590198272 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:16.499812 140501590198272 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:16.499892 140501590198272 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:16.499978 140501590198272 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:16.500065 140501590198272 dqn_agent.py:283] 	 seed: 1631272756498956
I0910 11:19:16.501715 140501590198272 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:16.501832 140501590198272 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:16.501902 140501590198272 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:16.501983 140501590198272 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:16.502047 140501590198272 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:16.502124 140501590198272 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:16.502180 140501590198272 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:16.502262 140501590198272 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:16.502337 140501590198272 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:16.527231 140501590198272 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:16.541859 140501590198272 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:19:16.542052 140501590198272 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 811434.32
I0910 11:19:16.543418 140501590198272 replay_runner.py:39] Average training steps per second: 811434.32
I0910 11:19:17.370327 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:19:17.420186 140501590198272 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 748849.13
I0910 11:19:17.421808 140501590198272 replay_runner.py:39] Average training steps per second: 748849.13
I0910 11:19:17.602643 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:19:17.646711 140501590198272 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 783103.81
I0910 11:19:17.648251 140501590198272 replay_runner.py:39] Average training steps per second: 783103.81
I0910 11:19:17.823888 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:19:17.867927 140501590198272 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 779610.41
I0910 11:19:17.869440 140501590198272 replay_runner.py:39] Average training steps per second: 779610.41
Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:19:18.081290 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:19:18.124833 140501590198272 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 786038.98
I0910 11:19:18.126333 140501590198272 replay_runner.py:39] Average training steps per second: 786038.98
I0910 11:19:18.322798 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:19:18.368103 140501590198272 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 795581.18
I0910 11:19:18.369605 140501590198272 replay_runner.py:39] Average training steps per second: 795581.18
I0910 11:19:18.603861 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:19:18.648547 140501590198272 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 798458.79
I0910 11:19:18.650062 140501590198272 replay_runner.py:39] Average training steps per second: 798458.79
I0910 11:19:18.833543 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:19:18.877873 140501590198272 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 793324.00
I0910 11:19:18.879386 140501590198272 replay_runner.py:39] Average training steps per second: 793324.00
I0910 11:19:19.085233 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:19:19.130326 140501590198272 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 782665.42
I0910 11:19:19.131856 140501590198272 replay_runner.py:39] Average training steps per second: 782665.42
I0910 11:19:19.330196 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:19:19.375353 140501590198272 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 747914.41
I0910 11:19:19.376950 140501590198272 replay_runner.py:39] Average training steps per second: 747914.41
I0910 11:19:19.582242 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:19:19.632204 140501590198272 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 702563.48
I0910 11:19:19.633903 140501590198272 replay_runner.py:39] Average training steps per second: 702563.48
I0910 11:19:19.819680 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:19:19.865621 140501590198272 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 785009.17
I0910 11:19:19.867145 140501590198272 replay_runner.py:39] Average training steps per second: 785009.17
I0910 11:19:20.061545 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:19:20.106303 140501590198272 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 782081.67
I0910 11:19:20.107820 140501590198272 replay_runner.py:39] Average training steps per second: 782081.67
I0910 11:19:20.300323 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:19:20.344375 140501590198272 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 786776.21
I0910 11:19:20.345872 140501590198272 replay_runner.py:39] Average training steps per second: 786776.21
I0910 11:19:20.536674 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:19:20.580981 140501590198272 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 830390.81
I0910 11:19:20.582409 140501590198272 replay_runner.py:39] Average training steps per second: 830390.81
I0910 11:19:20.760640 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:19:20.876228 140501590198272 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 770870.06
I0910 11:19:20.877804 140501590198272 replay_runner.py:39] Average training steps per second: 770870.06
I0910 11:19:21.068822 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:19:21.114620 140501590198272 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 742223.32
I0910 11:19:21.116201 140501590198272 replay_runner.py:39] Average training steps per second: 742223.32
I0910 11:19:21.297757 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:19:21.341716 140501590198272 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 799524.21
I0910 11:19:21.343200 140501590198272 replay_runner.py:39] Average training steps per second: 799524.21
I0910 11:19:21.525478 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:19:21.569313 140501590198272 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 824190.21
I0910 11:19:21.570725 140501590198272 replay_runner.py:39] Average training steps per second: 824190.21
I0910 11:19:21.743803 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:19:21.793612 140501590198272 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 790036.54
I0910 11:19:21.795206 140501590198272 replay_runner.py:39] Average training steps per second: 790036.54
I0910 11:19:21.980536 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:19:22.030033 140501590198272 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 788106.73
I0910 11:19:22.031534 140501590198272 replay_runner.py:39] Average training steps per second: 788106.73
I0910 11:19:22.210901 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:19:22.253564 140501590198272 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 874177.57
I0910 11:19:22.254914 140501590198272 replay_runner.py:39] Average training steps per second: 874177.57
I0910 11:19:22.422401 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:19:22.463529 140501590198272 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 861253.39
I0910 11:19:22.464905 140501590198272 replay_runner.py:39] Average training steps per second: 861253.39
I0910 11:19:22.650831 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:19:22.693782 140501590198272 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 885808.66
I0910 11:19:22.695153 140501590198272 replay_runner.py:39] Average training steps per second: 885808.66
I0910 11:19:22.869821 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:19:22.909548 140501590198272 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 922230.43
I0910 11:19:22.910840 140501590198272 replay_runner.py:39] Average training steps per second: 922230.43
I0910 11:19:23.087689 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:19:23.130433 140501590198272 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 802430.46
I0910 11:19:23.131887 140501590198272 replay_runner.py:39] Average training steps per second: 802430.46
I0910 11:19:23.306949 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:19:23.346777 140501590198272 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 787810.67
I0910 11:19:23.348290 140501590198272 replay_runner.py:39] Average training steps per second: 787810.67
I0910 11:19:23.512988 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:19:23.554590 140501590198272 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 941482.38
I0910 11:19:23.555864 140501590198272 replay_runner.py:39] Average training steps per second: 941482.38
I0910 11:19:23.783643 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:19:23.831329 140501590198272 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 934351.53
I0910 11:19:23.832606 140501590198272 replay_runner.py:39] Average training steps per second: 934351.53

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 29
I0910 11:19:24.028431 140501590198272 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 839028.61
I0910 11:19:24.029970 140501590198272 replay_runner.py:39] Average training steps per second: 839028.61
I0910 11:19:24.188882 140501590198272 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00