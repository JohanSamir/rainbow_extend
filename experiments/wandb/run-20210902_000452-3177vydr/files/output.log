Loaded trained dqn in cartpole
Training fixed agent 5, please be patient, may be a while...
I0902 00:04:58.734657 140410190899200 run_experiment.py:549] Creating TrainRunner ...
I0902 00:04:58.744606 140410190899200 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:04:58.744836 140410190899200 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:04:58.745021 140410190899200 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:04:58.745139 140410190899200 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:04:58.745266 140410190899200 dqn_agent.py:275] 	 update_period: 4
I0902 00:04:58.745460 140410190899200 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:04:58.745647 140410190899200 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:04:58.745741 140410190899200 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:04:58.745814 140410190899200 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:04:58.745883 140410190899200 dqn_agent.py:280] 	 optimizer: adam
I0902 00:04:58.745963 140410190899200 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:04:58.746040 140410190899200 dqn_agent.py:283] 	 seed: 1630541098744528
I0902 00:04:58.749093 140410190899200 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:04:58.749263 140410190899200 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:04:58.749355 140410190899200 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:04:58.749489 140410190899200 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:04:58.749708 140410190899200 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:04:58.749800 140410190899200 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:04:58.749873 140410190899200 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:04:58.750045 140410190899200 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:04:58.750260 140410190899200 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:04:58.789561 140410190899200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:04:59.302109 140410190899200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:04:59.317148 140410190899200 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:04:59.326373 140410190899200 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:04:59.326721 140410190899200 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:04:59.326923 140410190899200 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:04:59.327078 140410190899200 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:04:59.327208 140410190899200 dqn_agent.py:275] 	 update_period: 4
I0902 00:04:59.327454 140410190899200 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:04:59.327813 140410190899200 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:04:59.327945 140410190899200 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:04:59.328315 140410190899200 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:04:59.328459 140410190899200 dqn_agent.py:280] 	 optimizer: adam
I0902 00:04:59.328571 140410190899200 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:04:59.328664 140410190899200 dqn_agent.py:283] 	 seed: 1630541099326304
I0902 00:04:59.330541 140410190899200 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:04:59.330683 140410190899200 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:04:59.330853 140410190899200 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:04:59.331024 140410190899200 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:04:59.331108 140410190899200 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:04:59.331197 140410190899200 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:04:59.331330 140410190899200 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:04:59.331454 140410190899200 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:04:59.331542 140410190899200 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:04:59.364139 140410190899200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:04:59.388614 140410190899200 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:04:59.388845 140410190899200 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.80
I0902 00:05:06.109246 140410190899200 replay_runner.py:36] Average training steps per second: 148.80
Steps executed: 200 Episode length: 101 Return: 101.0
I0902 00:05:07.290843 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 100.00
INFO:tensorflow:Starting iteration 1

Steps executed: 310 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 193.92
I0902 00:05:12.647300 140410190899200 replay_runner.py:36] Average training steps per second: 193.92
I0902 00:05:12.866669 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.81
I0902 00:05:18.208786 140410190899200 replay_runner.py:36] Average training steps per second: 193.81
I0902 00:05:18.342563 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 00:05:18.521806 140410190899200 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.14
I0902 00:05:23.620669 140410190899200 replay_runner.py:36] Average training steps per second: 196.14
I0902 00:05:23.759854 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 340 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 194.24
I0902 00:05:29.147509 140410190899200 replay_runner.py:36] Average training steps per second: 194.24
I0902 00:05:29.362767 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.13
I0902 00:05:34.653837 140410190899200 replay_runner.py:36] Average training steps per second: 196.13
I0902 00:05:34.782794 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 362 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 200.99
I0902 00:05:40.000184 140410190899200 replay_runner.py:36] Average training steps per second: 200.99
I0902 00:05:40.229194 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.00
INFO:tensorflow:Starting iteration 7

Steps executed: 375 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.51
I0902 00:05:45.458295 140410190899200 replay_runner.py:36] Average training steps per second: 201.51
I0902 00:05:45.700026 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 8
I0902 00:05:45.880136 140410190899200 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 207.56

Steps executed: 338 Episode length: 151 Return: 151.0
I0902 00:05:50.895955 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 9

Steps executed: 262 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 203.65
I0902 00:05:56.015497 140410190899200 replay_runner.py:36] Average training steps per second: 203.65
I0902 00:05:56.192642 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 10

Steps executed: 334 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 203.07
I0902 00:06:01.308370 140410190899200 replay_runner.py:36] Average training steps per second: 203.07
I0902 00:06:01.550266 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 11

Steps executed: 257 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 203.82
I0902 00:06:06.645348 140410190899200 replay_runner.py:36] Average training steps per second: 203.82
I0902 00:06:06.807293 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 12

Steps executed: 282 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 200.74
I0902 00:06:11.977638 140410190899200 replay_runner.py:36] Average training steps per second: 200.74
I0902 00:06:12.160339 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 13

Steps executed: 287 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 194.45
I0902 00:06:17.485735 140410190899200 replay_runner.py:36] Average training steps per second: 194.45
I0902 00:06:17.698807 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.50
INFO:tensorflow:Starting iteration 14
I0902 00:06:17.888443 140410190899200 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 202.12
I0902 00:06:22.836512 140410190899200 replay_runner.py:36] Average training steps per second: 202.12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 15
I0902 00:06:23.165451 140410190899200 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.96
I0902 00:06:28.321491 140410190899200 replay_runner.py:36] Average training steps per second: 193.96
I0902 00:06:28.455618 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 00:06:28.645258 140410190899200 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.30
I0902 00:06:33.739908 140410190899200 replay_runner.py:36] Average training steps per second: 196.30
I0902 00:06:33.892329 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 00:06:34.089347 140410190899200 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.54
I0902 00:06:39.101571 140410190899200 replay_runner.py:36] Average training steps per second: 199.54
I0902 00:06:39.234342 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 00:06:39.510686 140410190899200 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.84
I0902 00:06:44.617370 140410190899200 replay_runner.py:36] Average training steps per second: 195.84
I0902 00:06:44.745174 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 00:06:44.938688 140410190899200 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 199.86
I0902 00:06:49.942794 140410190899200 replay_runner.py:36] Average training steps per second: 199.86
I0902 00:06:50.075927 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 00:06:50.259229 140410190899200 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 201.63
I0902 00:06:55.219062 140410190899200 replay_runner.py:36] Average training steps per second: 201.63
I0902 00:06:55.350865 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:06:55.528606 140410190899200 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.71
I0902 00:07:00.718230 140410190899200 replay_runner.py:36] Average training steps per second: 192.71
I0902 00:07:00.852010 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:07:01.043196 140410190899200 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.32
I0902 00:07:06.216398 140410190899200 replay_runner.py:36] Average training steps per second: 193.32
I0902 00:07:06.358608 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:07:06.554729 140410190899200 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.87
I0902 00:07:11.739921 140410190899200 replay_runner.py:36] Average training steps per second: 192.87
I0902 00:07:11.883069 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 00:07:12.076090 140410190899200 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 194.61
I0902 00:07:17.214963 140410190899200 replay_runner.py:36] Average training steps per second: 194.61
I0902 00:07:17.346279 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 00:07:17.533221 140410190899200 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 200.50
I0902 00:07:22.521443 140410190899200 replay_runner.py:36] Average training steps per second: 200.50
I0902 00:07:22.657727 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:07:22.846909 140410190899200 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 188.98
I0902 00:07:28.138904 140410190899200 replay_runner.py:36] Average training steps per second: 188.98
I0902 00:07:28.273189 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:07:28.464061 140410190899200 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.83
I0902 00:07:33.545408 140410190899200 replay_runner.py:36] Average training steps per second: 196.83
I0902 00:07:33.688749 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 00:07:33.885445 140410190899200 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.15
I0902 00:07:39.063268 140410190899200 replay_runner.py:36] Average training steps per second: 193.15
I0902 00:07:39.195176 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.40
I0902 00:07:44.247369 140410190899200 replay_runner.py:36] Average training steps per second: 205.40
I0902 00:07:44.388592 140410190899200 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00