I0902 00:34:46.558284 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:46.565237 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:46.565366 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:46.565439 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:46.565499 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:46.565555 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:46.565616 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:46.565674 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:46.565831 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:46.565953 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:46.566023 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:46.566076 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:46.566159 140183943698432 dqn_agent.py:283] 	 seed: 1630542886565202
I0902 00:34:46.569153 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:46.569314 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:46.569415 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:46.569492 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:46.569585 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:46.569693 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:46.569765 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:46.569830 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:46.569903 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:46.598955 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:46.862021 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:46.870839 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:46.877662 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:46.877783 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:46.877841 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:46.877912 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:46.877970 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:46.878023 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:46.878080 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:46.878173 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:46.878233 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:46.878314 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:46.878380 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:46.878447 140183943698432 dqn_agent.py:283] 	 seed: 1630542886877633
I0902 00:34:46.879765 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:46.879868 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:46.879935 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:46.879994 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:46.880073 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:46.880131 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:46.880221 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:46.880271 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:46.880321 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:46.900424 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:46.916682 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:46.916978 140183943698432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 257.87
I0902 00:34:50.795343 140183943698432 replay_runner.py:36] Average training steps per second: 257.87
I0902 00:34:51.737635 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.67
Steps executed: 380 Episode length: 274 Return: -277.76612757022497
INFO:tensorflow:Starting iteration 1

Steps executed: 161 Episode length: 78 Return: -507.071113533449657
INFO:tensorflow:Average training steps per second: 362.79
I0902 00:34:57.986963 140183943698432 replay_runner.py:36] Average training steps per second: 362.79

Steps executed: 250 Episode length: 89 Return: -494.776777650883157
INFO:tensorflow:Starting iteration 2

Steps executed: 207 Episode length: 128 Return: -383.95629633351734
INFO:tensorflow:Average training steps per second: 369.61
I0902 00:35:04.330903 140183943698432 replay_runner.py:36] Average training steps per second: 369.61
I0902 00:35:04.431429 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.94
INFO:tensorflow:Starting iteration 3

Steps executed: 208 Episode length: 71 Return: -148.513538652765334
INFO:tensorflow:Average training steps per second: 354.54
I0902 00:35:10.797708 140183943698432 replay_runner.py:36] Average training steps per second: 354.54
I0902 00:35:10.912355 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.63
INFO:tensorflow:Starting iteration 4

Steps executed: 508 Episode length: 376 Return: -485.46678247236388
INFO:tensorflow:Average training steps per second: 345.10
I0902 00:35:17.302518 140183943698432 replay_runner.py:36] Average training steps per second: 345.10
I0902 00:35:17.759853 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.86
INFO:tensorflow:Starting iteration 5

Steps executed: 245 Episode length: 245 Return: -153.33009162434567
INFO:tensorflow:Average training steps per second: 353.83
I0902 00:35:24.085834 140183943698432 replay_runner.py:36] Average training steps per second: 353.83
I0902 00:35:24.254000 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.33
INFO:tensorflow:Starting iteration 6

Steps executed: 646 Episode length: 646 Return: -443.58352391792357
INFO:tensorflow:Average training steps per second: 347.44
I0902 00:35:30.592193 140183943698432 replay_runner.py:36] Average training steps per second: 347.44
I0902 00:35:31.365301 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.58
INFO:tensorflow:Starting iteration 7

Steps executed: 220 Episode length: 220 Return: -553.44619625881687
INFO:tensorflow:Average training steps per second: 348.89
I0902 00:35:37.674672 140183943698432 replay_runner.py:36] Average training steps per second: 348.89
I0902 00:35:37.834504 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -553.45
INFO:tensorflow:Starting iteration 8
I0902 00:35:41.339607 140183943698432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 350.93

Steps executed: 1000 Episode length: 1000 Return: -172.5378508910951
I0902 00:35:46.522146 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.54
INFO:tensorflow:Starting iteration 9

Steps executed: 385 Episode length: 385 Return: -205.612402978049121
INFO:tensorflow:Average training steps per second: 368.17
I0902 00:35:52.731009 140183943698432 replay_runner.py:36] Average training steps per second: 368.17
I0902 00:35:53.044867 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.61
INFO:tensorflow:Starting iteration 10

Steps executed: 201 Episode length: 62 Return: -610.5715231028341121
INFO:tensorflow:Average training steps per second: 364.86
I0902 00:35:59.330346 140183943698432 replay_runner.py:36] Average training steps per second: 364.86
I0902 00:35:59.441618 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -541.83
INFO:tensorflow:Starting iteration 11

Steps executed: 275 Episode length: 275 Return: -186.973780900525581
INFO:tensorflow:Average training steps per second: 370.03
I0902 00:36:05.689763 140183943698432 replay_runner.py:36] Average training steps per second: 370.03
I0902 00:36:05.880282 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.97
INFO:tensorflow:Starting iteration 12

Steps executed: 209 Episode length: 98 Return: -696.8993652009077481
INFO:tensorflow:Average training steps per second: 359.39
I0902 00:36:12.183909 140183943698432 replay_runner.py:36] Average training steps per second: 359.39
I0902 00:36:12.310000 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -668.62
INFO:tensorflow:Starting iteration 13
I0902 00:36:15.788252 140183943698432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 350.06

Steps executed: 279 Episode length: 106 Return: -138.521804124274481
I0902 00:36:18.813242 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.57
INFO:tensorflow:Starting iteration 14

Steps executed: 232 Episode length: 58 Return: -109.6787688378183241
INFO:tensorflow:Average training steps per second: 354.03
I0902 00:36:25.110855 140183943698432 replay_runner.py:36] Average training steps per second: 354.03
I0902 00:36:25.234826 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.50
INFO:tensorflow:Starting iteration 15

Steps executed: 269 Episode length: 160 Return: -134.869870810470451
INFO:tensorflow:Average training steps per second: 352.76
I0902 00:36:31.543900 140183943698432 replay_runner.py:36] Average training steps per second: 352.76
I0902 00:36:31.692265 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.95
INFO:tensorflow:Starting iteration 16

Steps executed: 248 Episode length: 87 Return: -553.1880552156701451
INFO:tensorflow:Average training steps per second: 354.39
I0902 00:36:38.037512 140183943698432 replay_runner.py:36] Average training steps per second: 354.39
I0902 00:36:38.178324 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.60
INFO:tensorflow:Starting iteration 17
I0902 00:36:41.694313 140183943698432 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 368.53

Steps executed: 523 Episode length: 523 Return: -729.828125698184251
I0902 00:36:45.241527 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -729.83
INFO:tensorflow:Starting iteration 18

Steps executed: 265 Episode length: 68 Return: -122.3562256710656751
INFO:tensorflow:Average training steps per second: 354.39
I0902 00:36:51.554391 140183943698432 replay_runner.py:36] Average training steps per second: 354.39
I0902 00:36:51.712068 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.49
INFO:tensorflow:Starting iteration 19

Steps executed: 254 Episode length: 117 Return: -703.429923178483381
INFO:tensorflow:Average training steps per second: 348.17
I0902 00:36:58.087304 140183943698432 replay_runner.py:36] Average training steps per second: 348.17
I0902 00:36:58.265878 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.92
INFO:tensorflow:Starting iteration 20

Steps executed: 264 Episode length: 125 Return: -313.545205776965481
INFO:tensorflow:Average training steps per second: 340.05
I0902 00:37:04.719987 140183943698432 replay_runner.py:36] Average training steps per second: 340.05
I0902 00:37:04.895015 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.60
INFO:tensorflow:Starting iteration 21

Steps executed: 262 Episode length: 135 Return: -202.597865539273131
INFO:tensorflow:Average training steps per second: 355.52
I0902 00:37:11.221532 140183943698432 replay_runner.py:36] Average training steps per second: 355.52
I0902 00:37:11.386010 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.96
INFO:tensorflow:Starting iteration 22

Steps executed: 236 Episode length: 144 Return: -129.009574027422841
INFO:tensorflow:Average training steps per second: 351.88
I0902 00:37:17.721861 140183943698432 replay_runner.py:36] Average training steps per second: 351.88
I0902 00:37:17.872825 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.27
INFO:tensorflow:Starting iteration 23

Steps executed: 349 Episode length: 155 Return: -121.312682507060471
INFO:tensorflow:Average training steps per second: 353.67
I0902 00:37:24.177753 140183943698432 replay_runner.py:36] Average training steps per second: 353.67
I0902 00:37:24.380931 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.41
INFO:tensorflow:Starting iteration 24

Steps executed: 230 Episode length: 114 Return: -714.190800609646271
INFO:tensorflow:Average training steps per second: 352.90
I0902 00:37:30.717684 140183943698432 replay_runner.py:36] Average training steps per second: 352.90
I0902 00:37:30.854646 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.45
INFO:tensorflow:Starting iteration 25

Steps executed: 280 Episode length: 147 Return: -178.899359863132471
INFO:tensorflow:Average training steps per second: 348.10
I0902 00:37:37.139418 140183943698432 replay_runner.py:36] Average training steps per second: 348.10
I0902 00:37:37.324003 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.80
INFO:tensorflow:Starting iteration 26

Steps executed: 219 Episode length: 65 Return: -627.7808646545084571
INFO:tensorflow:Average training steps per second: 347.45
I0902 00:37:43.569017 140183943698432 replay_runner.py:36] Average training steps per second: 347.45
I0902 00:37:43.700646 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.70
INFO:tensorflow:Starting iteration 27

Steps executed: 373 Episode length: 204 Return: -646.130191055939271
INFO:tensorflow:Average training steps per second: 350.31
I0902 00:37:50.023256 140183943698432 replay_runner.py:36] Average training steps per second: 350.31
I0902 00:37:50.276256 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -664.59
INFO:tensorflow:Starting iteration 28

Steps executed: 214 Episode length: 128 Return: -794.736379955018771
INFO:tensorflow:Average training steps per second: 366.12
I0902 00:37:56.483322 140183943698432 replay_runner.py:36] Average training steps per second: 366.12
I0902 00:37:56.601770 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -814.48
INFO:tensorflow:Starting iteration 29

Steps executed: 254 Episode length: 64 Return: -480.8676547651789471
INFO:tensorflow:Average training steps per second: 340.59
I0902 00:38:02.863884 140183943698432 replay_runner.py:36] Average training steps per second: 340.59

Done fixed training!Episode length: 64 Return: -480.8676547651789471