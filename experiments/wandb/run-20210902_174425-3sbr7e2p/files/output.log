Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 17:44:31.903180 139702310836224 run_experiment.py:549] Creating TrainRunner ...
I0902 17:44:31.911492 139702310836224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:31.911648 139702310836224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:31.911728 139702310836224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:31.911797 139702310836224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:31.911853 139702310836224 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:31.911944 139702310836224 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:31.911998 139702310836224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:31.912061 139702310836224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:31.912169 139702310836224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:31.912267 139702310836224 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:31.912540 139702310836224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:31.912637 139702310836224 dqn_agent.py:283] 	 seed: 1630604671911451
I0902 17:44:31.915945 139702310836224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:31.916189 139702310836224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:31.916422 139702310836224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:31.916719 139702310836224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:31.916887 139702310836224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:31.916999 139702310836224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:31.917156 139702310836224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:31.917290 139702310836224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:31.917428 139702310836224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:31.951698 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:32.360499 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:32.374280 139702310836224 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:44:32.383768 139702310836224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:32.384037 139702310836224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:32.384237 139702310836224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:32.384559 139702310836224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:32.384726 139702310836224 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:32.384942 139702310836224 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:32.385128 139702310836224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:32.385268 139702310836224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:32.385387 139702310836224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:32.385503 139702310836224 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:32.385638 139702310836224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:32.385859 139702310836224 dqn_agent.py:283] 	 seed: 1630604672383718
I0902 17:44:32.389039 139702310836224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:32.389212 139702310836224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:32.389328 139702310836224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:32.389413 139702310836224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:32.389489 139702310836224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:32.389629 139702310836224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:32.389764 139702310836224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:32.389842 139702310836224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:32.389922 139702310836224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:32.459881 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:32.480417 139702310836224 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:44:32.480766 139702310836224 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.95
I0902 17:44:39.286390 139702310836224 replay_runner.py:36] Average training steps per second: 146.95
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:44:40.817862 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:44:41.049071 139702310836224 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 199.13
I0902 17:44:46.071458 139702310836224 replay_runner.py:36] Average training steps per second: 199.13
I0902 17:44:46.461774 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:44:46.705004 139702310836224 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 191.16
I0902 17:44:51.936593 139702310836224 replay_runner.py:36] Average training steps per second: 191.16
I0902 17:44:52.346529 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:44:52.584293 139702310836224 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 203.81
I0902 17:44:57.491170 139702310836224 replay_runner.py:36] Average training steps per second: 203.81
I0902 17:44:57.921130 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:44:58.172663 139702310836224 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 195.30
I0902 17:45:03.293445 139702310836224 replay_runner.py:36] Average training steps per second: 195.30
I0902 17:45:03.655983 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:45:03.881636 139702310836224 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 194.00
I0902 17:45:09.036870 139702310836224 replay_runner.py:36] Average training steps per second: 194.00
I0902 17:45:09.451999 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:45:09.693795 139702310836224 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 204.42
I0902 17:45:14.586203 139702310836224 replay_runner.py:36] Average training steps per second: 204.42
I0902 17:45:14.977502 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:45:15.217565 139702310836224 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 192.97
I0902 17:45:20.400289 139702310836224 replay_runner.py:36] Average training steps per second: 192.97
I0902 17:45:20.791787 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:45:21.027273 139702310836224 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 201.60
I0902 17:45:25.988152 139702310836224 replay_runner.py:36] Average training steps per second: 201.60
I0902 17:45:26.421061 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:45:26.674522 139702310836224 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 200.42
I0902 17:45:31.664611 139702310836224 replay_runner.py:36] Average training steps per second: 200.42
I0902 17:45:32.050568 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:45:32.291511 139702310836224 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 196.73
I0902 17:45:37.375229 139702310836224 replay_runner.py:36] Average training steps per second: 196.73
I0902 17:45:37.795242 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:45:38.022735 139702310836224 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 203.17
I0902 17:45:42.945410 139702310836224 replay_runner.py:36] Average training steps per second: 203.17
I0902 17:45:43.386343 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:45:43.647483 139702310836224 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 198.41
I0902 17:45:48.688101 139702310836224 replay_runner.py:36] Average training steps per second: 198.41
I0902 17:45:49.070968 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:45:49.307004 139702310836224 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.08
I0902 17:45:54.355882 139702310836224 replay_runner.py:36] Average training steps per second: 198.08
I0902 17:45:54.787477 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:45:55.040617 139702310836224 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 212.26
I0902 17:45:59.752335 139702310836224 replay_runner.py:36] Average training steps per second: 212.26
I0902 17:46:00.127989 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:46:00.361158 139702310836224 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 217.84
I0902 17:46:04.952108 139702310836224 replay_runner.py:36] Average training steps per second: 217.84
I0902 17:46:05.391274 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:46:05.622926 139702310836224 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.51
I0902 17:46:10.686355 139702310836224 replay_runner.py:36] Average training steps per second: 197.51
I0902 17:46:11.091269 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:46:11.340232 139702310836224 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 202.23
I0902 17:46:16.285433 139702310836224 replay_runner.py:36] Average training steps per second: 202.23
I0902 17:46:16.707890 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:46:16.951231 139702310836224 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.72
I0902 17:46:21.983783 139702310836224 replay_runner.py:36] Average training steps per second: 198.72
I0902 17:46:22.388876 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:46:22.626021 139702310836224 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 198.46
I0902 17:46:27.665439 139702310836224 replay_runner.py:36] Average training steps per second: 198.46
I0902 17:46:28.083357 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:46:28.329403 139702310836224 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.82
I0902 17:46:33.334689 139702310836224 replay_runner.py:36] Average training steps per second: 199.82
I0902 17:46:33.727204 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:46:33.976093 139702310836224 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.26
I0902 17:46:39.072082 139702310836224 replay_runner.py:36] Average training steps per second: 196.26
I0902 17:46:39.481923 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 17:46:39.729047 139702310836224 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 201.82
I0902 17:46:44.684523 139702310836224 replay_runner.py:36] Average training steps per second: 201.82
I0902 17:46:45.109510 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 17:46:45.327477 139702310836224 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 201.43
I0902 17:46:50.292399 139702310836224 replay_runner.py:36] Average training steps per second: 201.43
I0902 17:46:50.685901 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:46:50.915472 139702310836224 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 198.04
I0902 17:46:55.965561 139702310836224 replay_runner.py:36] Average training steps per second: 198.04
I0902 17:46:56.381850 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 17:46:56.615391 139702310836224 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.86
I0902 17:47:01.473453 139702310836224 replay_runner.py:36] Average training steps per second: 205.86
I0902 17:47:01.874115 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:47:02.121734 139702310836224 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.25
I0902 17:47:07.141031 139702310836224 replay_runner.py:36] Average training steps per second: 199.25
I0902 17:47:07.512470 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 17:47:07.744725 139702310836224 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 226.45
I0902 17:47:12.161216 139702310836224 replay_runner.py:36] Average training steps per second: 226.45
I0902 17:47:12.520790 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0902 17:47:12.744063 139702310836224 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 207.92
I0902 17:47:17.554090 139702310836224 replay_runner.py:36] Average training steps per second: 207.92
I0902 17:47:17.933358 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 216.54
I0902 17:47:22.780637 139702310836224 replay_runner.py:36] Average training steps per second: 216.54
I0902 17:47:23.171700 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00