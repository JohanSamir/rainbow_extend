Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 17:46:12.500756 139685444462592 run_experiment.py:549] Creating TrainRunner ...
I0902 17:46:12.512441 139685444462592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:46:12.512708 139685444462592 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:46:12.512814 139685444462592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:46:12.512908 139685444462592 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:46:12.512990 139685444462592 dqn_agent.py:275] 	 update_period: 4
I0902 17:46:12.513101 139685444462592 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:46:12.513467 139685444462592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:46:12.513682 139685444462592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:46:12.513794 139685444462592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:46:12.514050 139685444462592 dqn_agent.py:280] 	 optimizer: adam
I0902 17:46:12.514183 139685444462592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:46:12.514328 139685444462592 dqn_agent.py:283] 	 seed: 1630604772512351
I0902 17:46:12.517575 139685444462592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:46:12.517763 139685444462592 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:46:12.517886 139685444462592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:46:12.517978 139685444462592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:46:12.518085 139685444462592 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:46:12.518181 139685444462592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:46:12.518247 139685444462592 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:46:12.518393 139685444462592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:46:12.518518 139685444462592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:46:12.555401 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:12.906151 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:12.920296 139685444462592 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:46:12.929156 139685444462592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:46:12.929399 139685444462592 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:46:12.929533 139685444462592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:46:12.929651 139685444462592 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:46:12.929792 139685444462592 dqn_agent.py:275] 	 update_period: 4
I0902 17:46:12.929912 139685444462592 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:46:12.930018 139685444462592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:46:12.930123 139685444462592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:46:12.930221 139685444462592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:46:12.930312 139685444462592 dqn_agent.py:280] 	 optimizer: adam
I0902 17:46:12.930405 139685444462592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:46:12.930491 139685444462592 dqn_agent.py:283] 	 seed: 1630604772929103
I0902 17:46:12.932903 139685444462592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:46:12.933088 139685444462592 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:46:12.933198 139685444462592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:46:12.933334 139685444462592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:46:12.933435 139685444462592 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:46:12.933670 139685444462592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:46:12.933804 139685444462592 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:46:12.933928 139685444462592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:46:12.934051 139685444462592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:46:12.963711 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:12.985481 139685444462592 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:46:13.243676 139685444462592 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.51
I0902 17:46:19.359828 139685444462592 replay_runner.py:36] Average training steps per second: 163.51
Steps executed: 229 Episode length: 144 Return: -936.8406671686729
I0902 17:46:20.549406 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -685.72
INFO:tensorflow:Starting iteration 1

Steps executed: 430 Episode length: 340 Return: -3160.6390482086977
INFO:tensorflow:Average training steps per second: 214.80
I0902 17:46:29.535209 139685444462592 replay_runner.py:36] Average training steps per second: 214.80
I0902 17:46:30.089285 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -1836.12
INFO:tensorflow:Starting iteration 2

Steps executed: 258 Episode length: 258 Return: -1874.4613457984977
INFO:tensorflow:Average training steps per second: 218.53
I0902 17:46:39.034678 139685444462592 replay_runner.py:36] Average training steps per second: 218.53
I0902 17:46:39.380751 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -1874.46
INFO:tensorflow:Starting iteration 3
I0902 17:46:43.696991 139685444462592 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 223.10
I0902 17:46:48.180132 139685444462592 replay_runner.py:36] Average training steps per second: 223.10

Steps executed: 225 Episode length: 70 Return: -646.518849274647957
INFO:tensorflow:Starting iteration 4

Steps executed: 296 Episode length: 207 Return: -223.44048159280055
INFO:tensorflow:Average training steps per second: 226.01
I0902 17:46:57.011521 139685444462592 replay_runner.py:36] Average training steps per second: 226.01
I0902 17:46:57.300397 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.23
INFO:tensorflow:Starting iteration 5

Steps executed: 163 Episode length: 89 Return: -309.142968510038545
INFO:tensorflow:Average training steps per second: 227.14
I0902 17:47:06.057002 139685444462592 replay_runner.py:36] Average training steps per second: 227.14

Steps executed: 261 Episode length: 98 Return: -289.105342667330945
INFO:tensorflow:Starting iteration 6
I0902 17:47:10.423384 139685444462592 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 238.45

Steps executed: 215 Episode length: 99 Return: -234.333417572656464
I0902 17:47:14.779809 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.11
INFO:tensorflow:Starting iteration 7

Steps executed: 249 Episode length: 111 Return: -260.26384736956084
INFO:tensorflow:Average training steps per second: 240.21
I0902 17:47:23.128950 139685444462592 replay_runner.py:36] Average training steps per second: 240.21
I0902 17:47:23.323432 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.38
INFO:tensorflow:Starting iteration 8

Steps executed: 232 Episode length: 232 Return: -340.48606118590934
INFO:tensorflow:Average training steps per second: 243.03
I0902 17:47:31.469778 139685444462592 replay_runner.py:36] Average training steps per second: 243.03
I0902 17:47:31.686727 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.49
INFO:tensorflow:Starting iteration 9

Steps executed: 195 Episode length: 136 Return: -285.54572860389114
INFO:tensorflow:Average training steps per second: 231.12

Steps executed: 487 Episode length: 292 Return: -519.24214980214644
I0902 17:47:40.743762 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.39
INFO:tensorflow:Starting iteration 10

Steps executed: 375 Episode length: 251 Return: -666.46440629351913
INFO:tensorflow:Average training steps per second: 223.70
I0902 17:47:49.573852 139685444462592 replay_runner.py:36] Average training steps per second: 223.70
I0902 17:47:49.923278 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.42
INFO:tensorflow:Starting iteration 11

Steps executed: 295 Episode length: 98 Return: -254.792224136482963
INFO:tensorflow:Average training steps per second: 224.19
I0902 17:47:58.763741 139685444462592 replay_runner.py:36] Average training steps per second: 224.19
I0902 17:47:59.000373 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.51
INFO:tensorflow:Starting iteration 12

Steps executed: 226 Episode length: 77 Return: -530.045700662314693
INFO:tensorflow:Average training steps per second: 217.88
I0902 17:48:07.991127 139685444462592 replay_runner.py:36] Average training steps per second: 217.88
I0902 17:48:08.189153 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.12
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 255 Return: -542.90255874119933
INFO:tensorflow:Average training steps per second: 223.07
I0902 17:48:17.009547 139685444462592 replay_runner.py:36] Average training steps per second: 223.07
I0902 17:48:17.266460 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -542.90
INFO:tensorflow:Starting iteration 14

Steps executed: 210 Episode length: 90 Return: -241.563602459449421
INFO:tensorflow:Average training steps per second: 223.18
I0902 17:48:25.903906 139685444462592 replay_runner.py:36] Average training steps per second: 223.18
I0902 17:48:26.064821 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.66
INFO:tensorflow:Starting iteration 15

Steps executed: 266 Episode length: 127 Return: -210.99398773768104
INFO:tensorflow:Average training steps per second: 222.41
I0902 17:48:34.839208 139685444462592 replay_runner.py:36] Average training steps per second: 222.41
I0902 17:48:35.051094 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.09
INFO:tensorflow:Starting iteration 16

Steps executed: 233 Episode length: 122 Return: -260.41280604867944
INFO:tensorflow:Average training steps per second: 228.10
I0902 17:48:43.820904 139685444462592 replay_runner.py:36] Average training steps per second: 228.10
I0902 17:48:44.001039 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.76
INFO:tensorflow:Starting iteration 17

Steps executed: 330 Episode length: 171 Return: -533.94546923531957
INFO:tensorflow:Average training steps per second: 221.79
I0902 17:48:52.905369 139685444462592 replay_runner.py:36] Average training steps per second: 221.79
I0902 17:48:53.220609 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.56
INFO:tensorflow:Starting iteration 18

Steps executed: 225 Episode length: 128 Return: -557.08038540107857
INFO:tensorflow:Average training steps per second: 224.01
I0902 17:49:02.001990 139685444462592 replay_runner.py:36] Average training steps per second: 224.01
I0902 17:49:02.189269 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.43
INFO:tensorflow:Starting iteration 19

Steps executed: 227 Episode length: 151 Return: -571.02559542717597
INFO:tensorflow:Average training steps per second: 229.60
I0902 17:49:10.849946 139685444462592 replay_runner.py:36] Average training steps per second: 229.60
I0902 17:49:11.057582 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.86
INFO:tensorflow:Starting iteration 20

Steps executed: 266 Episode length: 153 Return: -514.94889395776327
INFO:tensorflow:Average training steps per second: 216.51
I0902 17:49:19.889069 139685444462592 replay_runner.py:36] Average training steps per second: 216.51
I0902 17:49:20.150233 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -560.30
INFO:tensorflow:Starting iteration 21

Steps executed: 276 Episode length: 276 Return: -482.35247888143887
INFO:tensorflow:Average training steps per second: 222.65
I0902 17:49:28.890970 139685444462592 replay_runner.py:36] Average training steps per second: 222.65
I0902 17:49:29.219391 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.35
INFO:tensorflow:Starting iteration 22

Steps executed: 220 Episode length: 127 Return: -571.10035797195637
INFO:tensorflow:Average training steps per second: 220.85
I0902 17:49:38.139341 139685444462592 replay_runner.py:36] Average training steps per second: 220.85
I0902 17:49:38.321752 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.26
INFO:tensorflow:Starting iteration 23

Steps executed: 202 Episode length: 120 Return: -554.61720978187947
INFO:tensorflow:Average training steps per second: 224.91
I0902 17:49:47.105634 139685444462592 replay_runner.py:36] Average training steps per second: 224.91
I0902 17:49:47.288011 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.81
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 131 Return: -221.70450088964492
INFO:tensorflow:Average training steps per second: 224.29
I0902 17:49:56.030849 139685444462592 replay_runner.py:36] Average training steps per second: 224.29
I0902 17:49:56.205988 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.22
INFO:tensorflow:Starting iteration 25
I0902 17:50:00.604356 139685444462592 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 230.31

Steps executed: 266 Episode length: 90 Return: -297.554130519628765
I0902 17:50:05.168093 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.18
INFO:tensorflow:Starting iteration 26

Steps executed: 287 Episode length: 196 Return: -271.63380729869155
INFO:tensorflow:Average training steps per second: 235.03
I0902 17:50:13.577972 139685444462592 replay_runner.py:36] Average training steps per second: 235.03
I0902 17:50:13.824661 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.97
INFO:tensorflow:Starting iteration 27

Steps executed: 233 Episode length: 104 Return: -530.19334554451175
INFO:tensorflow:Average training steps per second: 233.83
I0902 17:50:22.343261 139685444462592 replay_runner.py:36] Average training steps per second: 233.83
I0902 17:50:22.550618 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.69
INFO:tensorflow:Starting iteration 28
I0902 17:50:26.789198 139685444462592 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 231.58

Steps executed: 287 Episode length: 134 Return: -279.38546696654015
I0902 17:50:31.368817 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.16
INFO:tensorflow:Starting iteration 29

Steps executed: 263 Episode length: 187 Return: -487.51382945600315
INFO:tensorflow:Average training steps per second: 231.81
I0902 17:50:39.789219 139685444462592 replay_runner.py:36] Average training steps per second: 231.81

Done fixed training!Episode length: 187 Return: -487.51382945600315