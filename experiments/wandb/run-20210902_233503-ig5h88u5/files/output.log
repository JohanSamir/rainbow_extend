Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 23:35:09.795610 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0902 23:35:09.807287 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:09.807573 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:09.807712 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:09.807830 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:09.807995 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:09.808113 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:09.808221 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:09.808438 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:09.808577 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:09.808692 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:09.808849 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:09.808964 139819819333632 dqn_agent.py:283] 	 seed: 1630625709807220
I0902 23:35:09.812669 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:09.812913 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:09.813128 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:09.813266 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:09.813381 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:09.813490 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:09.813605 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:09.813716 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:09.813819 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:09.857601 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:10.234040 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:10.249682 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:35:10.260154 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:10.260482 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:10.260615 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:10.260761 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:10.260936 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:10.261149 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:10.261282 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:10.261415 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:10.261563 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:10.261693 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:10.261851 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:10.261974 139819819333632 dqn_agent.py:283] 	 seed: 1630625710260085
I0902 23:35:10.264828 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:10.264988 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:10.265091 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:10.265186 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:10.265315 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:10.265430 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:10.265559 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:10.265655 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:10.265755 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:10.340687 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:10.361909 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:35:10.362169 139819819333632 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.38
I0902 23:35:16.445871 139819819333632 replay_runner.py:36] Average training steps per second: 164.38
Steps executed: 270 Episode length: 151 Return: -555.1465686164764
I0902 23:35:17.608016 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -542.12
INFO:tensorflow:Starting iteration 1

Steps executed: 293 Episode length: 117 Return: -116.24056976598116
INFO:tensorflow:Average training steps per second: 222.47
I0902 23:35:26.334617 139819819333632 replay_runner.py:36] Average training steps per second: 222.47
I0902 23:35:26.604591 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.21
INFO:tensorflow:Starting iteration 2
I0902 23:35:30.906884 139819819333632 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 230.55

Steps executed: 290 Episode length: 94 Return: -573.558294441519746
I0902 23:35:35.544914 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -604.33
INFO:tensorflow:Starting iteration 3
I0902 23:35:39.887086 139819819333632 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 222.27

Steps executed: 1000 Episode length: 1000 Return: -9.472507104915001
I0902 23:35:47.326122 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -9.47
INFO:tensorflow:Starting iteration 4
I0902 23:35:51.660770 139819819333632 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 219.36

Steps executed: 1000 Episode length: 1000 Return: -60.27224120886231
I0902 23:35:59.492679 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.27
INFO:tensorflow:Starting iteration 5
I0902 23:36:03.906333 139819819333632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 221.47

Steps executed: 1000 Episode length: 1000 Return: -97.37157552107291
I0902 23:36:12.360087 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.37
INFO:tensorflow:Starting iteration 6

Steps executed: 249 Episode length: 249 Return: -299.681672660570541
INFO:tensorflow:Average training steps per second: 228.15
I0902 23:36:21.186021 139819819333632 replay_runner.py:36] Average training steps per second: 228.15
I0902 23:36:21.445979 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.68
INFO:tensorflow:Starting iteration 7
I0902 23:36:25.777827 139819819333632 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 224.43

Steps executed: 1000 Episode length: 1000 Return: -174.61948810378593
I0902 23:36:32.726977 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.62
INFO:tensorflow:Starting iteration 8
I0902 23:36:37.158151 139819819333632 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 227.42

Steps executed: 386 Episode length: 386 Return: -293.7317061249525593
I0902 23:36:42.205220 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.73
INFO:tensorflow:Starting iteration 9

Steps executed: 448 Episode length: 448 Return: -296.1855682336896593
INFO:tensorflow:Average training steps per second: 225.29
I0902 23:36:50.921339 139819819333632 replay_runner.py:36] Average training steps per second: 225.29
I0902 23:36:51.481194 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.19
INFO:tensorflow:Starting iteration 10
I0902 23:36:55.704555 139819819333632 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.36

Steps executed: 1000 Episode length: 1000 Return: -61.406357901001314
I0902 23:37:02.304585 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.41
INFO:tensorflow:Starting iteration 11
I0902 23:37:06.630401 139819819333632 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 223.08

Steps executed: 765 Episode length: 765 Return: -294.1928247374327314
I0902 23:37:12.464152 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.19
INFO:tensorflow:Starting iteration 12

Steps executed: 187 Episode length: 187 Return: -88.93852060318011314
INFO:tensorflow:Average training steps per second: 232.87

Steps executed: 604 Episode length: 417 Return: -293.5084145144171314
I0902 23:37:22.274364 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.22
INFO:tensorflow:Starting iteration 13

Steps executed: 468 Episode length: 468 Return: -115.0160516801932314
INFO:tensorflow:Average training steps per second: 226.74
I0902 23:37:30.929380 139819819333632 replay_runner.py:36] Average training steps per second: 226.74
I0902 23:37:31.510622 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.02
INFO:tensorflow:Starting iteration 14
I0902 23:37:35.857427 139819819333632 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 231.75

Steps executed: 1000 Episode length: 1000 Return: -126.53541315520891
I0902 23:37:43.490859 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.54
INFO:tensorflow:Starting iteration 15
I0902 23:37:47.832722 139819819333632 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 225.50

Steps executed: 1000 Episode length: 1000 Return: -73.769873296366641
I0902 23:37:55.944654 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.77
INFO:tensorflow:Starting iteration 16

Steps executed: 308 Episode length: 114 Return: -401.1095856195575641
INFO:tensorflow:Average training steps per second: 220.87
I0902 23:38:04.760391 139819819333632 replay_runner.py:36] Average training steps per second: 220.87
I0902 23:38:05.016900 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.21
INFO:tensorflow:Starting iteration 17

Steps executed: 298 Episode length: 191 Return: -465.4940545102965641
INFO:tensorflow:Average training steps per second: 230.37
I0902 23:38:13.712855 139819819333632 replay_runner.py:36] Average training steps per second: 230.37
I0902 23:38:14.031256 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -416.33
INFO:tensorflow:Starting iteration 18

Steps executed: 338 Episode length: 189 Return: -209.2113359296894541
INFO:tensorflow:Average training steps per second: 227.05
I0902 23:38:22.778886 139819819333632 replay_runner.py:36] Average training steps per second: 227.05
I0902 23:38:23.057140 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.87
INFO:tensorflow:Starting iteration 19
I0902 23:38:27.457159 139819819333632 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 223.65
I0902 23:38:31.929046 139819819333632 replay_runner.py:36] Average training steps per second: 223.65

Steps executed: 318 Episode length: 129 Return: -127.3518952528734641
INFO:tensorflow:Starting iteration 20

Steps executed: 227 Episode length: 227 Return: -5.433782542814697641
INFO:tensorflow:Average training steps per second: 218.27
I0902 23:38:41.131911 139819819333632 replay_runner.py:36] Average training steps per second: 218.27
I0902 23:38:41.407134 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.43
INFO:tensorflow:Starting iteration 21
I0902 23:38:45.806061 139819819333632 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 220.34

Steps executed: 215 Episode length: 101 Return: -273.7480485988021441
I0902 23:38:50.544966 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.80
INFO:tensorflow:Starting iteration 22

Steps executed: 234 Episode length: 234 Return: 14.950714876231373441
INFO:tensorflow:Average training steps per second: 221.17
I0902 23:38:59.341709 139819819333632 replay_runner.py:36] Average training steps per second: 221.17
I0902 23:38:59.601644 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.95
INFO:tensorflow:Starting iteration 23
I0902 23:39:03.980285 139819819333632 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 218.93

Steps executed: 283 Episode length: 151 Return: -140.0541216520113541
I0902 23:39:08.815412 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.83
INFO:tensorflow:Starting iteration 24
I0902 23:39:13.213310 139819819333632 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 215.79
I0902 23:39:17.848247 139819819333632 replay_runner.py:36] Average training steps per second: 215.79

Steps executed: 234 Episode length: 234 Return: -247.6910222145651841
INFO:tensorflow:Starting iteration 25
I0902 23:39:22.442816 139819819333632 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 221.27

Steps executed: 664 Episode length: 664 Return: -30.11751290913987641
I0902 23:39:28.420286 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.12
INFO:tensorflow:Starting iteration 26
I0902 23:39:32.694225 139819819333632 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 222.60

Steps executed: 1000 Episode length: 1000 Return: 25.8618472411765051
I0902 23:39:39.866878 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.86
INFO:tensorflow:Starting iteration 27

Steps executed: 458 Episode length: 328 Return: -230.4362103518933051
INFO:tensorflow:Average training steps per second: 231.68
I0902 23:39:48.627804 139819819333632 replay_runner.py:36] Average training steps per second: 231.68
I0902 23:39:49.214333 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.00
INFO:tensorflow:Starting iteration 28

Steps executed: 233 Episode length: 104 Return: -695.8163317475847051
INFO:tensorflow:Average training steps per second: 239.43
I0902 23:39:57.966515 139819819333632 replay_runner.py:36] Average training steps per second: 239.43
I0902 23:39:58.176660 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.01
INFO:tensorflow:Starting iteration 29

Steps executed: 239 Episode length: 114 Return: -120.6508906631928751
INFO:tensorflow:Average training steps per second: 226.32
I0902 23:40:07.062297 139819819333632 replay_runner.py:36] Average training steps per second: 226.32

Done fixed training!Episode length: 114 Return: -120.6508906631928751