Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 23:59:50.199615 139919604459520 run_experiment.py:549] Creating TrainRunner ...
I0901 23:59:50.209354 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:50.209621 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:50.209751 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:50.209875 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:50.209988 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:50.210090 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:50.210215 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:50.210319 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:50.210418 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:50.210512 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:50.210607 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:50.210702 139919604459520 dqn_agent.py:283] 	 seed: 1630540790209295
I0901 23:59:50.213656 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:50.213859 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:59:50.214001 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:50.214143 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:50.214439 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:50.214630 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:50.214775 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:50.214891 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:50.214996 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:50.256882 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:51.110004 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:51.125160 139919604459520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:59:51.132634 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:51.132829 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:51.132920 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:51.132986 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:51.133043 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:51.133102 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:51.133191 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:51.133328 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:51.133484 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:51.133600 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:51.133693 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:51.133799 139919604459520 dqn_agent.py:283] 	 seed: 1630540791132590
I0901 23:59:51.136755 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:51.136971 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:59:51.137111 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:51.137265 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:51.137413 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:51.137541 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:51.137661 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:51.137772 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:51.137862 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:51.173238 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:51.196415 139919604459520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:59:51.196740 139919604459520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.14
I0901 23:59:57.726948 139919604459520 replay_runner.py:36] Average training steps per second: 153.14
Steps executed: 240 Episode length: 240 Return: -239.0
I0901 23:59:58.928769 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.00
INFO:tensorflow:Starting iteration 1
I0901 23:59:59.161142 139919604459520 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 204.39

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:00:04.473160 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 00:00:04.707312 139919604459520 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 200.52
I0902 00:00:09.694939 139919604459520 replay_runner.py:36] Average training steps per second: 200.52
I0902 00:00:10.096210 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 00:00:10.346065 139919604459520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 198.22
I0902 00:00:15.391495 139919604459520 replay_runner.py:36] Average training steps per second: 198.22
I0902 00:00:15.806842 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 405 Episode length: 405 Return: -404.0
INFO:tensorflow:Average training steps per second: 201.22
I0902 00:00:21.014874 139919604459520 replay_runner.py:36] Average training steps per second: 201.22
I0902 00:00:21.372948 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.00
INFO:tensorflow:Starting iteration 5

Steps executed: 245 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 203.09
I0902 00:00:26.538965 139919604459520 replay_runner.py:36] Average training steps per second: 203.09
I0902 00:00:26.735715 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 6

Steps executed: 290 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 197.29
I0902 00:00:32.052320 139919604459520 replay_runner.py:36] Average training steps per second: 197.29
I0902 00:00:32.303870 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 7

Steps executed: 206 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 200.91
I0902 00:00:37.527569 139919604459520 replay_runner.py:36] Average training steps per second: 200.91
I0902 00:00:37.696358 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 8

Steps executed: 259 Episode length: 259 Return: -258.0
INFO:tensorflow:Average training steps per second: 191.71
I0902 00:00:43.153622 139919604459520 replay_runner.py:36] Average training steps per second: 191.71
I0902 00:00:43.403838 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.00
INFO:tensorflow:Starting iteration 9

Steps executed: 263 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 195.82
I0902 00:00:48.759584 139919604459520 replay_runner.py:36] Average training steps per second: 195.82
I0902 00:00:48.990671 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.39
I0902 00:00:54.437888 139919604459520 replay_runner.py:36] Average training steps per second: 192.39
I0902 00:00:54.878105 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 138 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 198.07

Steps executed: 289 Episode length: 151 Return: -150.0
I0902 00:01:00.416301 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 12

Steps executed: 201 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 198.43
I0902 00:01:05.684471 139919604459520 replay_runner.py:36] Average training steps per second: 198.43
I0902 00:01:05.864503 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 13

Steps executed: 239 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 200.62
I0902 00:01:11.096020 139919604459520 replay_runner.py:36] Average training steps per second: 200.62
I0902 00:01:11.307629 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 14

Steps executed: 257 Episode length: 79 Return: -78.000
INFO:tensorflow:Average training steps per second: 198.44
I0902 00:01:16.597551 139919604459520 replay_runner.py:36] Average training steps per second: 198.44
I0902 00:01:16.821851 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 15
I0902 00:01:17.070584 139919604459520 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 192.75
I0902 00:01:22.259115 139919604459520 replay_runner.py:36] Average training steps per second: 192.75

Steps executed: 249 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Starting iteration 16

Steps executed: 233 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 198.62
I0902 00:01:27.741517 139919604459520 replay_runner.py:36] Average training steps per second: 198.62
I0902 00:01:27.933202 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 17

Steps executed: 248 Episode length: 75 Return: -74.000
INFO:tensorflow:Average training steps per second: 196.89
I0902 00:01:33.259220 139919604459520 replay_runner.py:36] Average training steps per second: 196.89
I0902 00:01:33.475185 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 18

Steps executed: 241 Episode length: 90 Return: -89.000
INFO:tensorflow:Average training steps per second: 200.57
I0902 00:01:38.687248 139919604459520 replay_runner.py:36] Average training steps per second: 200.57
I0902 00:01:38.904641 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 19
I0902 00:01:39.287760 139919604459520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 200.54
I0902 00:01:44.274709 139919604459520 replay_runner.py:36] Average training steps per second: 200.54

Steps executed: 252 Episode length: 76 Return: -75.000
INFO:tensorflow:Starting iteration 20

Steps executed: 323 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 200.27
I0902 00:01:49.702593 139919604459520 replay_runner.py:36] Average training steps per second: 200.27
I0902 00:01:49.953903 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.67
INFO:tensorflow:Starting iteration 21

Steps executed: 211 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 204.08
I0902 00:01:55.085636 139919604459520 replay_runner.py:36] Average training steps per second: 204.08
I0902 00:01:55.251231 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 22

Steps executed: 211 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 195.84
I0902 00:02:00.591670 139919604459520 replay_runner.py:36] Average training steps per second: 195.84
I0902 00:02:00.757732 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 23

Steps executed: 280 Episode length: 90 Return: -89.000
INFO:tensorflow:Average training steps per second: 198.01
I0902 00:02:06.052379 139919604459520 replay_runner.py:36] Average training steps per second: 198.01
I0902 00:02:06.280827 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.33
INFO:tensorflow:Starting iteration 24

Steps executed: 260 Episode length: 85 Return: -84.000
INFO:tensorflow:Average training steps per second: 194.85
I0902 00:02:11.656686 139919604459520 replay_runner.py:36] Average training steps per second: 194.85
I0902 00:02:11.877502 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 25

Steps executed: 215 Episode length: 64 Return: -63.000
INFO:tensorflow:Average training steps per second: 200.51
I0902 00:02:17.091055 139919604459520 replay_runner.py:36] Average training steps per second: 200.51
I0902 00:02:17.277055 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.67
INFO:tensorflow:Starting iteration 26

Steps executed: 256 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 195.78
I0902 00:02:22.629426 139919604459520 replay_runner.py:36] Average training steps per second: 195.78
I0902 00:02:22.829590 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 27

Steps executed: 260 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 193.92
I0902 00:02:28.218820 139919604459520 replay_runner.py:36] Average training steps per second: 193.92
I0902 00:02:28.447352 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 28

Steps executed: 270 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 201.50
I0902 00:02:33.640191 139919604459520 replay_runner.py:36] Average training steps per second: 201.50
I0902 00:02:33.840972 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 192.22
I0902 00:02:39.259724 139919604459520 replay_runner.py:36] Average training steps per second: 192.22
I0902 00:02:39.442366 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00