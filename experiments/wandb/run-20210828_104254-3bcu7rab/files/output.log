Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0828 10:43:01.278767 140088388143104 run_experiment.py:549] Creating TrainRunner ...
I0828 10:43:01.289972 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:43:01.290353 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:43:01.290525 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:43:01.290787 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:43:01.290948 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:43:01.291108 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:43:01.291192 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:43:01.291264 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:43:01.291607 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:43:01.291748 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:43:01.291848 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:43:01.291933 140088388143104 dqn_agent.py:283] 	 seed: 1630147381289893
I0828 10:43:01.294681 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:43:01.294910 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:43:01.295023 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:43:01.295107 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:43:01.295184 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:43:01.295263 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:43:01.295316 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:43:01.295417 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:43:01.295504 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:43:01.332031 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000010, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:43:01.731771 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000010, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:43:01.747354 140088388143104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:43:01.755792 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:43:01.755980 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:43:01.756069 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:43:01.756131 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:43:01.756228 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:43:01.756383 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:43:01.756516 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:43:01.756640 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:43:01.756817 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:43:01.756908 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:43:01.757142 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:43:01.757346 140088388143104 dqn_agent.py:283] 	 seed: 1630147381755747
I0828 10:43:01.760316 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:43:01.760506 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:43:01.760624 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:43:01.760832 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:43:01.760936 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:43:01.761083 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:43:01.761209 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:43:01.761322 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:43:01.761415 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:43:01.834100 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000010, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:43:01.855829 140088388143104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:43:01.856127 140088388143104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.66
I0828 10:43:08.406848 140088388143104 replay_runner.py:36] Average training steps per second: 152.66
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:43:09.834894 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:43:10.073445 140088388143104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 203.52
I0828 10:43:14.987338 140088388143104 replay_runner.py:36] Average training steps per second: 203.52
I0828 10:43:15.371917 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:43:15.666742 140088388143104 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 207.64
I0828 10:43:20.483132 140088388143104 replay_runner.py:36] Average training steps per second: 207.64
I0828 10:43:20.878350 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0828 10:43:21.105473 140088388143104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 212.57
I0828 10:43:25.810288 140088388143104 replay_runner.py:36] Average training steps per second: 212.57
I0828 10:43:26.195482 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0828 10:43:26.437126 140088388143104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 207.93
I0828 10:43:31.246926 140088388143104 replay_runner.py:36] Average training steps per second: 207.93
I0828 10:43:31.626099 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0828 10:43:31.855823 140088388143104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 209.07
I0828 10:43:36.639200 140088388143104 replay_runner.py:36] Average training steps per second: 209.07
I0828 10:43:37.061949 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0828 10:43:37.306062 140088388143104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 206.51
I0828 10:43:42.148863 140088388143104 replay_runner.py:36] Average training steps per second: 206.51
I0828 10:43:42.555038 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0828 10:43:42.798938 140088388143104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.10
I0828 10:43:47.847225 140088388143104 replay_runner.py:36] Average training steps per second: 198.10
I0828 10:43:48.250547 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0828 10:43:48.491854 140088388143104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 203.65
I0828 10:43:53.402703 140088388143104 replay_runner.py:36] Average training steps per second: 203.65
I0828 10:43:53.801717 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0828 10:43:54.040624 140088388143104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 199.55
I0828 10:43:59.052199 140088388143104 replay_runner.py:36] Average training steps per second: 199.55
I0828 10:43:59.466546 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:43:59.692675 140088388143104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 205.96
I0828 10:44:04.548441 140088388143104 replay_runner.py:36] Average training steps per second: 205.96
I0828 10:44:04.945908 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:44:05.179368 140088388143104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 202.71
I0828 10:44:10.113044 140088388143104 replay_runner.py:36] Average training steps per second: 202.71
I0828 10:44:10.510627 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 296 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 198.01
I0828 10:44:15.805995 140088388143104 replay_runner.py:36] Average training steps per second: 198.01
I0828 10:44:16.051268 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.00
INFO:tensorflow:Starting iteration 13
I0828 10:44:16.270434 140088388143104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 202.47

Steps executed: 617 Episode length: 500 Return: -500.0
I0828 10:44:21.695949 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.00
INFO:tensorflow:Starting iteration 14

Steps executed: 122 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 200.18
I0828 10:44:26.936449 140088388143104 replay_runner.py:36] Average training steps per second: 200.18
I0828 10:44:27.140606 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 15


Steps executed: 224 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 206.51
I0828 10:44:32.223027 140088388143104 replay_runner.py:36] Average training steps per second: 206.51
I0828 10:44:32.416722 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.29
I0828 10:44:37.624153 140088388143104 replay_runner.py:36] Average training steps per second: 201.29
I0828 10:44:38.028280 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:44:38.437669 140088388143104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 205.09

Steps executed: 667 Episode length: 500 Return: -500.0
I0828 10:44:43.876143 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.00
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 209.54
I0828 10:44:48.876228 140088388143104 replay_runner.py:36] Average training steps per second: 209.54
I0828 10:44:49.249147 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:44:49.467743 140088388143104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 208.67
I0828 10:44:54.260353 140088388143104 replay_runner.py:36] Average training steps per second: 208.67
I0828 10:44:54.670223 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:44:54.909126 140088388143104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 210.35
I0828 10:44:59.663946 140088388143104 replay_runner.py:36] Average training steps per second: 210.35
I0828 10:45:00.075822 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:45:00.327542 140088388143104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 203.80
I0828 10:45:05.234636 140088388143104 replay_runner.py:36] Average training steps per second: 203.80
I0828 10:45:05.628145 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:45:05.847196 140088388143104 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 223.53
I0828 10:45:10.321234 140088388143104 replay_runner.py:36] Average training steps per second: 223.53
I0828 10:45:10.727486 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:45:10.963260 140088388143104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 219.23
I0828 10:45:15.524947 140088388143104 replay_runner.py:36] Average training steps per second: 219.23
I0828 10:45:15.885485 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:45:16.114846 140088388143104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 217.05
I0828 10:45:20.722565 140088388143104 replay_runner.py:36] Average training steps per second: 217.05
I0828 10:45:21.119335 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:45:21.354744 140088388143104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 232.81
I0828 10:45:25.650611 140088388143104 replay_runner.py:36] Average training steps per second: 232.81
I0828 10:45:25.997885 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:45:26.219913 140088388143104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 224.56
I0828 10:45:30.673563 140088388143104 replay_runner.py:36] Average training steps per second: 224.56
I0828 10:45:31.022840 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:45:31.231576 140088388143104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 237.73
I0828 10:45:35.438424 140088388143104 replay_runner.py:36] Average training steps per second: 237.73
I0828 10:45:35.805608 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:45:36.032700 140088388143104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 234.80
I0828 10:45:40.292189 140088388143104 replay_runner.py:36] Average training steps per second: 234.80
I0828 10:45:40.635946 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29
I0828 10:45:40.855505 140088388143104 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 233.77
I0828 10:45:45.133584 140088388143104 replay_runner.py:36] Average training steps per second: 233.77

Done fixed training!Episode length: 500 Return: -500.0