Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0901 12:54:54.404626 140298343233536 run_experiment.py:549] Creating TrainRunner ...
I0901 12:54:54.416281 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:54:54.416574 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:54:54.416743 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:54:54.416871 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:54:54.417001 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 12:54:54.417122 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:54:54.417325 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:54:54.417456 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:54:54.417587 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:54:54.417734 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 12:54:54.417833 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:54:54.418186 140298343233536 dqn_agent.py:283] 	 seed: 1630500894416217
I0901 12:54:54.421962 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:54:54.422194 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:54:54.422354 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:54:54.422478 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:54:54.422585 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:54:54.422688 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:54:54.422815 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:54:54.422909 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:54:54.423002 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:54:54.491310 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:54:55.207132 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:54:55.220255 140298343233536 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:54:55.227690 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:54:55.227863 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:54:55.227941 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:54:55.228004 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:54:55.228065 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 12:54:55.228119 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:54:55.228221 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:54:55.228381 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:54:55.228555 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:54:55.228680 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 12:54:55.228804 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:54:55.228902 140298343233536 dqn_agent.py:283] 	 seed: 1630500895227653
I0901 12:54:55.231980 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:54:55.232251 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:54:55.232404 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:54:55.232703 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:54:55.233054 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:54:55.233251 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:54:55.233397 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:54:55.233540 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:54:55.233702 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:54:55.266552 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:54:55.288334 140298343233536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:54:55.288661 140298343233536 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.26
I0901 12:55:01.688562 140298343233536 replay_runner.py:36] Average training steps per second: 156.26
Steps executed: 232 Episode length: 63 Return: -479.40874000264414
I0901 12:55:02.972995 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -492.24
INFO:tensorflow:Starting iteration 1

Steps executed: 166 Episode length: 76 Return: -515.47073129357644
INFO:tensorflow:Average training steps per second: 225.68
I0901 12:55:11.821202 140298343233536 replay_runner.py:36] Average training steps per second: 225.68

Steps executed: 273 Episode length: 107 Return: -586.8670214993572
INFO:tensorflow:Starting iteration 2

Steps executed: 238 Episode length: 94 Return: -304.72735028824474
INFO:tensorflow:Average training steps per second: 225.68
I0901 12:55:20.832607 140298343233536 replay_runner.py:36] Average training steps per second: 225.68
I0901 12:55:21.022270 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.19
INFO:tensorflow:Starting iteration 3

Steps executed: 278 Episode length: 163 Return: -488.1193271932277
INFO:tensorflow:Average training steps per second: 226.64
I0901 12:55:29.770672 140298343233536 replay_runner.py:36] Average training steps per second: 226.64
I0901 12:55:30.000629 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -457.74
INFO:tensorflow:Starting iteration 4

Steps executed: 345 Episode length: 250 Return: -357.23179336393605
INFO:tensorflow:Average training steps per second: 224.71
I0901 12:55:38.841953 140298343233536 replay_runner.py:36] Average training steps per second: 224.71
I0901 12:55:39.204553 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.99
INFO:tensorflow:Starting iteration 5
I0901 12:55:43.670984 140298343233536 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.15

Steps executed: 309 Episode length: 309 Return: -229.41756044480076
I0901 12:55:48.525233 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.42
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 100 Return: -206.12828961456592
INFO:tensorflow:Average training steps per second: 218.66
I0901 12:55:57.457156 140298343233536 replay_runner.py:36] Average training steps per second: 218.66
I0901 12:55:57.640335 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.46
INFO:tensorflow:Starting iteration 7

Steps executed: 260 Episode length: 141 Return: -481.42624082448684
INFO:tensorflow:Average training steps per second: 219.08
I0901 12:56:06.572641 140298343233536 replay_runner.py:36] Average training steps per second: 219.08
I0901 12:56:06.823963 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.95
INFO:tensorflow:Starting iteration 8

Steps executed: 283 Episode length: 107 Return: -294.29727092724784
INFO:tensorflow:Average training steps per second: 220.16
I0901 12:56:15.774205 140298343233536 replay_runner.py:36] Average training steps per second: 220.16
I0901 12:56:16.050067 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.84
INFO:tensorflow:Starting iteration 9

Steps executed: 244 Episode length: 156 Return: -129.89618615181166
INFO:tensorflow:Average training steps per second: 222.92
I0901 12:56:24.859067 140298343233536 replay_runner.py:36] Average training steps per second: 222.92
I0901 12:56:25.066383 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.01
INFO:tensorflow:Starting iteration 10

Steps executed: 234 Episode length: 106 Return: -223.93813567672674
INFO:tensorflow:Average training steps per second: 226.76
I0901 12:56:33.841649 140298343233536 replay_runner.py:36] Average training steps per second: 226.76
I0901 12:56:34.051757 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.81
INFO:tensorflow:Starting iteration 11

Steps executed: 286 Episode length: 113 Return: -105.99267511300377
INFO:tensorflow:Average training steps per second: 224.18
I0901 12:56:42.975192 140298343233536 replay_runner.py:36] Average training steps per second: 224.18
I0901 12:56:43.236488 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.16
INFO:tensorflow:Starting iteration 12

Steps executed: 249 Episode length: 133 Return: -226.44567155629898
INFO:tensorflow:Average training steps per second: 228.49
I0901 12:56:51.826883 140298343233536 replay_runner.py:36] Average training steps per second: 228.49
I0901 12:56:52.049468 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.48
INFO:tensorflow:Starting iteration 13

Steps executed: 226 Episode length: 107 Return: -61.254606272526544
INFO:tensorflow:Average training steps per second: 219.11
I0901 12:57:01.041005 140298343233536 replay_runner.py:36] Average training steps per second: 219.11
I0901 12:57:01.249358 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.39
INFO:tensorflow:Starting iteration 14

Steps executed: 218 Episode length: 70 Return: -601.158741009245944
INFO:tensorflow:Average training steps per second: 216.80
I0901 12:57:10.251475 140298343233536 replay_runner.py:36] Average training steps per second: 216.80
I0901 12:57:10.441192 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.82
INFO:tensorflow:Starting iteration 15

Steps executed: 253 Episode length: 91 Return: -428.437410986026074
INFO:tensorflow:Average training steps per second: 218.01
I0901 12:57:19.533590 140298343233536 replay_runner.py:36] Average training steps per second: 218.01
I0901 12:57:19.742511 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.45
INFO:tensorflow:Starting iteration 16
I0901 12:57:24.234926 140298343233536 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 221.83

Steps executed: 445 Episode length: 295 Return: 13.5251579510332934
I0901 12:57:29.256477 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.19
INFO:tensorflow:Starting iteration 17
I0901 12:57:33.726618 140298343233536 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 224.61
I0901 12:57:38.179177 140298343233536 replay_runner.py:36] Average training steps per second: 224.61

Steps executed: 220 Episode length: 220 Return: 42.9945969284958134
INFO:tensorflow:Starting iteration 18

Steps executed: 281 Episode length: 129 Return: -355.73227529358877
INFO:tensorflow:Average training steps per second: 219.42
I0901 12:57:47.414046 140298343233536 replay_runner.py:36] Average training steps per second: 219.42
I0901 12:57:47.687770 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.86
INFO:tensorflow:Starting iteration 19

Steps executed: 104 Episode length: 104 Return: -462.04852544122377
INFO:tensorflow:Average training steps per second: 219.36
I0901 12:57:56.336476 140298343233536 replay_runner.py:36] Average training steps per second: 219.36

Steps executed: 230 Episode length: 126 Return: -320.10849658550416
INFO:tensorflow:Starting iteration 20

Steps executed: 270 Episode length: 119 Return: -357.00728017956247
INFO:tensorflow:Average training steps per second: 216.86
I0901 12:58:05.613042 140298343233536 replay_runner.py:36] Average training steps per second: 216.86
I0901 12:58:05.853188 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.08
INFO:tensorflow:Starting iteration 21
I0901 12:58:10.282160 140298343233536 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 217.90

Steps executed: 378 Episode length: 260 Return: -160.06205525610108
I0901 12:58:15.267328 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.44
INFO:tensorflow:Starting iteration 22

Steps executed: 84 Episode length: 84 Return: -195.5913319453757108
INFO:tensorflow:Average training steps per second: 211.95
I0901 12:58:24.368437 140298343233536 replay_runner.py:36] Average training steps per second: 211.95

Steps executed: 269 Episode length: 185 Return: -61.032761381616346
INFO:tensorflow:Starting iteration 23

Steps executed: 266 Episode length: 105 Return: -353.71563304989377
INFO:tensorflow:Average training steps per second: 221.05
I0901 12:58:33.601715 140298343233536 replay_runner.py:36] Average training steps per second: 221.05
I0901 12:58:33.832092 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.19
INFO:tensorflow:Starting iteration 24
I0901 12:58:38.198197 140298343233536 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 221.88
I0901 12:58:42.705434 140298343233536 replay_runner.py:36] Average training steps per second: 221.88

Steps executed: 287 Episode length: 110 Return: -80.660183697674557
INFO:tensorflow:Starting iteration 25

Steps executed: 275 Episode length: 161 Return: -221.38312445279532
INFO:tensorflow:Average training steps per second: 219.53
I0901 12:58:51.998694 140298343233536 replay_runner.py:36] Average training steps per second: 219.53
I0901 12:58:52.234896 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.75
INFO:tensorflow:Starting iteration 26
I0901 12:58:55.995564 140298343233536 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 213.05

Steps executed: 303 Episode length: 109 Return: -146.81279526619798
I0901 12:59:01.017405 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.96
INFO:tensorflow:Starting iteration 27

Steps executed: 289 Episode length: 110 Return: -246.69499010295928
INFO:tensorflow:Average training steps per second: 221.09
I0901 12:59:10.024847 140298343233536 replay_runner.py:36] Average training steps per second: 221.09
I0901 12:59:10.316284 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.87
INFO:tensorflow:Starting iteration 28

Steps executed: 325 Episode length: 196 Return: -80.224392934277138
INFO:tensorflow:Average training steps per second: 217.65
I0901 12:59:18.978243 140298343233536 replay_runner.py:36] Average training steps per second: 217.65
I0901 12:59:19.287205 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.21
INFO:tensorflow:Starting iteration 29

Steps executed: 210 Episode length: 210 Return: -553.90078817719518
INFO:tensorflow:Average training steps per second: 216.56
I0901 12:59:28.411107 140298343233536 replay_runner.py:36] Average training steps per second: 216.56

Done fixed training!Episode length: 210 Return: -553.90078817719518