Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 23:38:27.023419 140720164866048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:38:27.032683 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:38:27.032983 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:38:27.033229 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:38:27.033351 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:38:27.033553 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:38:27.033697 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:38:27.033838 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:38:27.034026 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:38:27.034133 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:38:27.034215 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:38:27.034381 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:38:27.035026 140720164866048 dqn_agent.py:283] 	 seed: 1630625907032627
I0902 23:38:27.038925 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:38:27.039281 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:38:27.039441 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:38:27.039570 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:38:27.039654 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:38:27.039762 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:38:27.040000 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:38:27.040306 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:38:27.040581 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:38:27.091473 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:38:27.586204 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:38:27.602364 140720164866048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:38:27.612909 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:38:27.613193 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:38:27.613349 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:38:27.613476 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:38:27.613596 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:38:27.613704 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:38:27.613808 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:38:27.613933 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:38:27.614168 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:38:27.614322 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:38:27.614500 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:38:27.614701 140720164866048 dqn_agent.py:283] 	 seed: 1630625907612838
I0902 23:38:27.617618 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:38:27.617841 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:38:27.618022 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:38:27.618217 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:38:27.618376 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:38:27.618521 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:38:27.618887 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:38:27.619098 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:38:27.619364 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:38:27.658637 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:38:27.683660 140720164866048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:38:27.683966 140720164866048 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 139.78
I0902 23:38:34.838469 140720164866048 replay_runner.py:36] Average training steps per second: 139.78
I0902 23:38:36.440088 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 270 Episode length: 270 Return: -269.0
INFO:tensorflow:Average training steps per second: 186.08
I0902 23:38:42.074077 140720164866048 replay_runner.py:36] Average training steps per second: 186.08
I0902 23:38:42.300544 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.33
I0902 23:38:47.966837 140720164866048 replay_runner.py:36] Average training steps per second: 184.33
I0902 23:38:48.418915 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:38:48.668380 140720164866048 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.54
I0902 23:38:53.808991 140720164866048 replay_runner.py:36] Average training steps per second: 194.54
I0902 23:38:54.243147 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 23:38:54.491585 140720164866048 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 186.86
I0902 23:38:59.843578 140720164866048 replay_runner.py:36] Average training steps per second: 186.86
I0902 23:39:00.265926 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:39:00.505711 140720164866048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 188.97
I0902 23:39:05.798357 140720164866048 replay_runner.py:36] Average training steps per second: 188.97
I0902 23:39:06.295504 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 335 Episode length: 166 Return: -165.0
INFO:tensorflow:Average training steps per second: 190.14
I0902 23:39:11.802345 140720164866048 replay_runner.py:36] Average training steps per second: 190.14
I0902 23:39:12.089813 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.67
INFO:tensorflow:Starting iteration 7

Steps executed: 276 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 183.32
I0902 23:39:17.775167 140720164866048 replay_runner.py:36] Average training steps per second: 183.32
I0902 23:39:17.992305 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 8

Steps executed: 225 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 191.74
I0902 23:39:23.443048 140720164866048 replay_runner.py:36] Average training steps per second: 191.74
I0902 23:39:23.628386 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 9

Steps executed: 261 Episode length: 68 Return: -67.0.0
INFO:tensorflow:Average training steps per second: 191.77
I0902 23:39:29.151772 140720164866048 replay_runner.py:36] Average training steps per second: 191.77
I0902 23:39:29.359181 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 10
I0902 23:39:29.591572 140720164866048 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 185.19

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:39:35.422712 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 23:39:35.663554 140720164866048 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 191.96
I0902 23:39:40.873241 140720164866048 replay_runner.py:36] Average training steps per second: 191.96
I0902 23:39:41.300032 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 255 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 191.46
I0902 23:39:46.772504 140720164866048 replay_runner.py:36] Average training steps per second: 191.46
I0902 23:39:46.983795 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 13

Steps executed: 225 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 188.78
I0902 23:39:52.523797 140720164866048 replay_runner.py:36] Average training steps per second: 188.78
I0902 23:39:52.714482 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 14

Steps executed: 225 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 197.96
I0902 23:39:58.013732 140720164866048 replay_runner.py:36] Average training steps per second: 197.96
I0902 23:39:58.206371 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 15

Steps executed: 287 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 192.58
I0902 23:40:03.648879 140720164866048 replay_runner.py:36] Average training steps per second: 192.58
I0902 23:40:03.901436 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 16

Steps executed: 266 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 188.67
I0902 23:40:09.435752 140720164866048 replay_runner.py:36] Average training steps per second: 188.67
I0902 23:40:09.677094 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.20
I0902 23:40:15.203134 140720164866048 replay_runner.py:36] Average training steps per second: 189.20
I0902 23:40:15.600730 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 23:40:15.834601 140720164866048 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 191.54

Steps executed: 677 Episode length: 500 Return: -500.0
I0902 23:40:21.594308 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.00
INFO:tensorflow:Starting iteration 19
I0902 23:40:21.826456 140720164866048 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 194.28

Steps executed: 647 Episode length: 500 Return: -500.0
I0902 23:40:27.489174 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.00
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 200.68
I0902 23:40:32.754247 140720164866048 replay_runner.py:36] Average training steps per second: 200.68
I0902 23:40:32.909653 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.00
INFO:tensorflow:Starting iteration 21

Steps executed: 249 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 186.30
I0902 23:40:38.494790 140720164866048 replay_runner.py:36] Average training steps per second: 186.30
I0902 23:40:38.683196 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 22

Steps executed: 449 Episode length: 449 Return: -448.0
INFO:tensorflow:Average training steps per second: 198.34
I0902 23:40:43.949850 140720164866048 replay_runner.py:36] Average training steps per second: 198.34
I0902 23:40:44.319680 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.00
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 195.39
I0902 23:40:49.688301 140720164866048 replay_runner.py:36] Average training steps per second: 195.39
I0902 23:40:49.865064 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 24
I0902 23:40:50.095216 140720164866048 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 191.90
I0902 23:40:55.306625 140720164866048 replay_runner.py:36] Average training steps per second: 191.90

Steps executed: 298 Episode length: 104 Return: -103.0
INFO:tensorflow:Starting iteration 25

Steps executed: 253 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 189.07
I0902 23:41:01.070454 140720164866048 replay_runner.py:36] Average training steps per second: 189.07
I0902 23:41:01.310145 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 26

Steps executed: 238 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 189.37
I0902 23:41:06.839442 140720164866048 replay_runner.py:36] Average training steps per second: 189.37
I0902 23:41:07.049838 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 27

Steps executed: 228 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 186.96
I0902 23:41:12.642588 140720164866048 replay_runner.py:36] Average training steps per second: 186.96
I0902 23:41:12.840202 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 28

Steps executed: 224 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 194.72
I0902 23:41:18.218194 140720164866048 replay_runner.py:36] Average training steps per second: 194.72
I0902 23:41:18.401482 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 189.82
I0902 23:41:23.913193 140720164866048 replay_runner.py:36] Average training steps per second: 189.82
I0902 23:41:24.115689 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00