Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 17:50:21.745756 140669712693248 run_experiment.py:549] Creating TrainRunner ...
I0902 17:50:21.754765 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:21.754961 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:21.755038 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:21.755111 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:21.755173 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:21.755233 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:50:21.755304 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:21.755359 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:21.755413 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:21.755534 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:21.755635 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:21.755789 140669712693248 dqn_agent.py:283] 	 seed: 1630605021754719
I0902 17:50:21.759457 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:21.759760 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:50:21.760159 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:21.760435 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:21.760591 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:21.760725 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:21.760897 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:21.761014 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:21.761117 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:21.798352 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:22.335432 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:22.349501 140669712693248 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:50:22.358167 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:22.358425 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:22.358571 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:22.358685 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:22.358794 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:22.358901 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:50:22.359009 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:22.359113 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:22.359196 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:22.359285 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:22.359400 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:22.359486 140669712693248 dqn_agent.py:283] 	 seed: 1630605022358105
I0902 17:50:22.362174 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:22.362557 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:50:22.362808 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:22.362970 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:22.363089 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:22.363210 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:22.363302 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:22.363352 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:22.363412 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:22.398439 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:22.418692 140669712693248 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:50:22.418903 140669712693248 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.38
I0902 17:50:28.938923 140669712693248 replay_runner.py:36] Average training steps per second: 153.38
Steps executed: 200 Episode length: 200 Return: 200.0
I0902 17:50:30.018076 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 1

Steps executed: 259 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 215.71
I0902 17:50:34.842405 140669712693248 replay_runner.py:36] Average training steps per second: 215.71
I0902 17:50:34.989485 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 203.37
I0902 17:50:40.080256 140669712693248 replay_runner.py:36] Average training steps per second: 203.37
I0902 17:50:40.195813 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.00
INFO:tensorflow:Starting iteration 3

Steps executed: 217 Episode length: 27 Return: 27.0.0
INFO:tensorflow:Average training steps per second: 219.48
I0902 17:50:44.932909 140669712693248 replay_runner.py:36] Average training steps per second: 219.48
I0902 17:50:45.054233 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 27.12
INFO:tensorflow:Starting iteration 4

Steps executed: 274 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 220.95
I0902 17:50:49.788138 140669712693248 replay_runner.py:36] Average training steps per second: 220.95
I0902 17:50:49.950186 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 91.33
INFO:tensorflow:Starting iteration 5

Steps executed: 242 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 201.16
I0902 17:50:55.150548 140669712693248 replay_runner.py:36] Average training steps per second: 201.16
I0902 17:50:55.353753 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.00
INFO:tensorflow:Starting iteration 6

Steps executed: 285 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 196.52
I0902 17:51:00.664213 140669712693248 replay_runner.py:36] Average training steps per second: 196.52
I0902 17:51:00.860637 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 7

Steps executed: 209 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 197.96
I0902 17:51:06.107324 140669712693248 replay_runner.py:36] Average training steps per second: 197.96
I0902 17:51:06.258015 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 8

Steps executed: 202 Episode length: 8 Return: 8.0.0.0
INFO:tensorflow:Average training steps per second: 202.27
I0902 17:51:11.401378 140669712693248 replay_runner.py:36] Average training steps per second: 202.27
I0902 17:51:11.539145 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 9

Steps executed: 205 Episode length: 8 Return: 8.0.0.0
INFO:tensorflow:Average training steps per second: 196.67
I0902 17:51:16.817651 140669712693248 replay_runner.py:36] Average training steps per second: 196.67
I0902 17:51:16.957678 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 10

Steps executed: 206 Episode length: 8 Return: 8.0.0.0
INFO:tensorflow:Average training steps per second: 198.27
I0902 17:51:22.184716 140669712693248 replay_runner.py:36] Average training steps per second: 198.27
I0902 17:51:22.318582 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 11
I0902 17:51:22.518205 140669712693248 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 202.28
I0902 17:51:27.462534 140669712693248 replay_runner.py:36] Average training steps per second: 202.28
I0902 17:51:27.598139 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 12


Steps executed: 206 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 199.22
I0902 17:51:32.790248 140669712693248 replay_runner.py:36] Average training steps per second: 199.22
I0902 17:51:32.935740 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 13

Steps executed: 201 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 200.99
I0902 17:51:38.110312 140669712693248 replay_runner.py:36] Average training steps per second: 200.99
I0902 17:51:38.252216 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 14

Steps executed: 83 Episode length: 9 Return: 9.0.00.0
INFO:tensorflow:Average training steps per second: 195.41
I0902 17:51:43.562722 140669712693248 replay_runner.py:36] Average training steps per second: 195.41
I0902 17:51:43.704188 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 15


Steps executed: 203 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 201.92
I0902 17:51:48.841895 140669712693248 replay_runner.py:36] Average training steps per second: 201.92
I0902 17:51:48.985983 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.67
INFO:tensorflow:Starting iteration 16

Steps executed: 202 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 197.90
I0902 17:51:54.230512 140669712693248 replay_runner.py:36] Average training steps per second: 197.90
I0902 17:51:54.363173 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 17

Steps executed: 203 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 198.08
I0902 17:51:59.601931 140669712693248 replay_runner.py:36] Average training steps per second: 198.08
I0902 17:51:59.744393 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 18

Steps executed: 207 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 202.15
I0902 17:52:04.886433 140669712693248 replay_runner.py:36] Average training steps per second: 202.15
I0902 17:52:05.023365 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 19

Steps executed: 207 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 193.47
I0902 17:52:10.383954 140669712693248 replay_runner.py:36] Average training steps per second: 193.47
I0902 17:52:10.529911 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 197.51
I0902 17:52:15.786394 140669712693248 replay_runner.py:36] Average training steps per second: 197.51
I0902 17:52:15.925716 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 84 Return: 84.0.0
INFO:tensorflow:Average training steps per second: 196.97
I0902 17:52:21.183538 140669712693248 replay_runner.py:36] Average training steps per second: 196.97
I0902 17:52:21.359910 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 89.33
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.52
I0902 17:52:26.611923 140669712693248 replay_runner.py:36] Average training steps per second: 197.52
I0902 17:52:26.742721 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 17:52:26.923573 140669712693248 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.66
I0902 17:52:31.983080 140669712693248 replay_runner.py:36] Average training steps per second: 197.66
I0902 17:52:32.108122 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 17:52:32.290430 140669712693248 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 198.25
I0902 17:52:37.335201 140669712693248 replay_runner.py:36] Average training steps per second: 198.25
I0902 17:52:37.468771 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 17:52:37.658461 140669712693248 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.95
I0902 17:52:42.762232 140669712693248 replay_runner.py:36] Average training steps per second: 195.95
I0902 17:52:42.894784 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 17:52:43.093274 140669712693248 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.62
I0902 17:52:48.103281 140669712693248 replay_runner.py:36] Average training steps per second: 199.62
I0902 17:52:48.241261 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 17:52:48.436900 140669712693248 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.84
I0902 17:52:53.517577 140669712693248 replay_runner.py:36] Average training steps per second: 196.84
I0902 17:52:53.651143 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 349 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 201.33
I0902 17:52:58.809191 140669712693248 replay_runner.py:36] Average training steps per second: 201.33
I0902 17:52:59.046310 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 29
I0902 17:52:59.236635 140669712693248 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 202.87

Done fixed training!Episode length: 156 Return: 156.0
I0902 17:53:04.364466 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00