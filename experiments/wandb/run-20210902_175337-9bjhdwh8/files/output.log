Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0902 17:53:43.664181 140223945852928 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:43.672375 140223945852928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:43.672582 140223945852928 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:43.672880 140223945852928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:43.673029 140223945852928 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:43.673138 140223945852928 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:43.673391 140223945852928 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:43.673671 140223945852928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:43.673792 140223945852928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:43.673890 140223945852928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:43.673988 140223945852928 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:43.674120 140223945852928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:43.674305 140223945852928 dqn_agent.py:283] 	 seed: 1630605223672304
I0902 17:53:43.676563 140223945852928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:43.676716 140223945852928 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:43.676839 140223945852928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:43.676997 140223945852928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:43.677098 140223945852928 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:43.677183 140223945852928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:43.677314 140223945852928 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:43.677410 140223945852928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:43.677494 140223945852928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:43.712048 140223945852928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:44.135928 140223945852928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:44.148609 140223945852928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:44.458800 140223945852928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:44.458990 140223945852928 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:44.459095 140223945852928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:44.459192 140223945852928 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:44.459753 140223945852928 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:44.459977 140223945852928 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:44.460164 140223945852928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:44.460544 140223945852928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:44.460675 140223945852928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:44.460866 140223945852928 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:44.460985 140223945852928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:44.461317 140223945852928 dqn_agent.py:283] 	 seed: 1630605224458754
I0902 17:53:44.463821 140223945852928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:44.463942 140223945852928 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:44.464046 140223945852928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:44.464129 140223945852928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:44.464210 140223945852928 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:44.464293 140223945852928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:44.464394 140223945852928 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:44.464475 140223945852928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:44.464553 140223945852928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:44.490295 140223945852928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:44.513182 140223945852928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:44.513450 140223945852928 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.85
I0902 17:53:51.099017 140223945852928 replay_runner.py:36] Average training steps per second: 151.85
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:53:52.611319 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:53:52.909584 140223945852928 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 201.99
I0902 17:53:57.861029 140223945852928 replay_runner.py:36] Average training steps per second: 201.99
I0902 17:53:58.256153 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:53:58.491600 140223945852928 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 196.94
I0902 17:54:03.569568 140223945852928 replay_runner.py:36] Average training steps per second: 196.94
I0902 17:54:03.981317 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:54:04.220360 140223945852928 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 201.83
I0902 17:54:09.175585 140223945852928 replay_runner.py:36] Average training steps per second: 201.83
I0902 17:54:09.598782 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:54:09.845519 140223945852928 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.27
I0902 17:54:14.915203 140223945852928 replay_runner.py:36] Average training steps per second: 197.27
I0902 17:54:15.312544 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:54:15.548503 140223945852928 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.86
I0902 17:54:20.603195 140223945852928 replay_runner.py:36] Average training steps per second: 197.86
I0902 17:54:21.047781 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:54:21.299202 140223945852928 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.48
I0902 17:54:26.389434 140223945852928 replay_runner.py:36] Average training steps per second: 196.48
I0902 17:54:26.826465 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 311 Episode length: 197 Return: -196.0
INFO:tensorflow:Average training steps per second: 193.55
I0902 17:54:32.245911 140223945852928 replay_runner.py:36] Average training steps per second: 193.55
I0902 17:54:32.512603 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.50
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.39
I0902 17:54:37.831885 140223945852928 replay_runner.py:36] Average training steps per second: 197.39
I0902 17:54:38.271627 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:54:38.513119 140223945852928 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 197.55
I0902 17:54:43.575626 140223945852928 replay_runner.py:36] Average training steps per second: 197.55
I0902 17:54:44.009902 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:54:44.239420 140223945852928 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 197.85
I0902 17:54:49.294348 140223945852928 replay_runner.py:36] Average training steps per second: 197.85
I0902 17:54:49.716786 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:54:49.972219 140223945852928 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 194.94
I0902 17:54:55.102598 140223945852928 replay_runner.py:36] Average training steps per second: 194.94
I0902 17:54:55.505081 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:54:55.750386 140223945852928 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 194.69
I0902 17:55:00.887483 140223945852928 replay_runner.py:36] Average training steps per second: 194.69
I0902 17:55:01.305161 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:55:01.547465 140223945852928 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 199.75
I0902 17:55:06.554216 140223945852928 replay_runner.py:36] Average training steps per second: 199.75
I0902 17:55:06.977762 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:55:07.219721 140223945852928 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 198.68
I0902 17:55:12.253398 140223945852928 replay_runner.py:36] Average training steps per second: 198.68
I0902 17:55:12.656685 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:55:12.902373 140223945852928 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 200.26
I0902 17:55:17.896245 140223945852928 replay_runner.py:36] Average training steps per second: 200.26
I0902 17:55:18.318854 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:55:18.564472 140223945852928 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.74
I0902 17:55:23.673762 140223945852928 replay_runner.py:36] Average training steps per second: 195.74
I0902 17:55:24.057881 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:55:24.299259 140223945852928 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 207.68
I0902 17:55:29.114773 140223945852928 replay_runner.py:36] Average training steps per second: 207.68
I0902 17:55:29.496384 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 202 Episode length: 202 Return: -201.0
INFO:tensorflow:Average training steps per second: 200.18
I0902 17:55:34.719631 140223945852928 replay_runner.py:36] Average training steps per second: 200.18
I0902 17:55:34.885183 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 19
I0902 17:55:35.113399 140223945852928 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 206.47

Steps executed: 319 Episode length: 184 Return: -183.0
I0902 17:55:40.218187 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.50
INFO:tensorflow:Starting iteration 20

Steps executed: 277 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 202.40
I0902 17:55:45.393210 140223945852928 replay_runner.py:36] Average training steps per second: 202.40
I0902 17:55:45.616701 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.50
INFO:tensorflow:Starting iteration 21

Steps executed: 373 Episode length: 373 Return: -372.0
INFO:tensorflow:Average training steps per second: 206.94
I0902 17:55:50.704824 140223945852928 replay_runner.py:36] Average training steps per second: 206.94
I0902 17:55:51.001680 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.00
INFO:tensorflow:Starting iteration 22

Steps executed: 252 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 201.91
I0902 17:55:56.189648 140223945852928 replay_runner.py:36] Average training steps per second: 201.91
I0902 17:55:56.387182 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 23

Steps executed: 313 Episode length: 196 Return: -195.0
INFO:tensorflow:Average training steps per second: 204.34
I0902 17:56:01.512467 140223945852928 replay_runner.py:36] Average training steps per second: 204.34
I0902 17:56:01.775155 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.50
INFO:tensorflow:Starting iteration 24

Steps executed: 304 Episode length: 183 Return: -182.0
INFO:tensorflow:Average training steps per second: 219.79
I0902 17:56:06.550449 140223945852928 replay_runner.py:36] Average training steps per second: 219.79
I0902 17:56:06.781029 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.00
INFO:tensorflow:Starting iteration 25

Steps executed: 292 Episode length: 162 Return: -161.0
INFO:tensorflow:Average training steps per second: 204.96
I0902 17:56:11.892817 140223945852928 replay_runner.py:36] Average training steps per second: 204.96
I0902 17:56:12.155411 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 26

Steps executed: 449 Episode length: 264 Return: -263.0
INFO:tensorflow:Average training steps per second: 213.34
I0902 17:56:17.069129 140223945852928 replay_runner.py:36] Average training steps per second: 213.34
I0902 17:56:17.422421 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.67
INFO:tensorflow:Starting iteration 27

Steps executed: 209 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 200.21
I0902 17:56:22.647504 140223945852928 replay_runner.py:36] Average training steps per second: 200.21
I0902 17:56:22.809777 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 28

Steps executed: 77 Episode length: 77 Return: -76.06.0
INFO:tensorflow:Average training steps per second: 205.40

Steps executed: 577 Episode length: 500 Return: -500.0
I0902 17:56:28.397862 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 199.93
I0902 17:56:33.634503 140223945852928 replay_runner.py:36] Average training steps per second: 199.93
I0902 17:56:33.831436 140223945852928 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67