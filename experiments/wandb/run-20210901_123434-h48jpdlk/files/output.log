Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0901 12:34:41.138698 139816666404864 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:41.147754 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:41.147989 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:41.148117 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:41.148223 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:41.148312 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:41.148402 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:41.148482 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:41.148611 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:41.148754 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:41.148844 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:41.148927 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:41.149005 139816666404864 dqn_agent.py:283] 	 seed: 1630499681147695
I0901 12:34:41.151803 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:41.152062 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:41.152220 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:41.152327 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:41.152445 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:41.152556 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:41.152651 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:41.152733 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:41.152814 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:41.199670 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:41.729652 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:41.744076 139816666404864 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:41.752418 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:41.752619 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:41.752924 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:41.753055 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:41.753138 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:41.753211 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:41.753281 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:41.753418 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:41.753562 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:41.753686 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:41.753772 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:41.753863 139816666404864 dqn_agent.py:283] 	 seed: 1630499681752371
I0901 12:34:41.756783 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:41.756971 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:41.757136 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:41.757364 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:41.757491 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:41.757605 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:41.757714 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:41.757848 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:41.757971 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:41.795326 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:41.818995 139816666404864 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:41.819314 139816666404864 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 138.55
I0901 12:34:49.037309 139816666404864 replay_runner.py:36] Average training steps per second: 138.55
I0901 12:34:50.601488 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 1
I0901 12:34:50.841539 139816666404864 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 183.78
I0901 12:34:56.283039 139816666404864 replay_runner.py:36] Average training steps per second: 183.78
I0901 12:34:56.719529 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:34:56.960481 139816666404864 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.85
I0901 12:35:02.146254 139816666404864 replay_runner.py:36] Average training steps per second: 192.85
I0901 12:35:02.583488 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:35:02.832084 139816666404864 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 188.22
I0901 12:35:08.145630 139816666404864 replay_runner.py:36] Average training steps per second: 188.22
I0901 12:35:08.606426 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 648 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.44
I0901 12:35:14.217164 139816666404864 replay_runner.py:36] Average training steps per second: 186.44
I0901 12:35:14.837470 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.94
I0901 12:35:20.206914 139816666404864 replay_runner.py:36] Average training steps per second: 195.94
I0901 12:35:20.659561 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:35:20.911425 139816666404864 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 182.82
I0901 12:35:26.381728 139816666404864 replay_runner.py:36] Average training steps per second: 182.82
I0901 12:35:26.838613 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:35:27.089025 139816666404864 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 189.42
I0901 12:35:32.368632 139816666404864 replay_runner.py:36] Average training steps per second: 189.42
I0901 12:35:32.838077 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:35:33.099805 139816666404864 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 182.53
I0901 12:35:38.578814 139816666404864 replay_runner.py:36] Average training steps per second: 182.53
I0901 12:35:39.016466 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 364 Episode length: 364 Return: -363.0
INFO:tensorflow:Average training steps per second: 185.59
I0901 12:35:44.633251 139816666404864 replay_runner.py:36] Average training steps per second: 185.59
I0901 12:35:44.992678 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.00
INFO:tensorflow:Starting iteration 10

Steps executed: 321 Episode length: 321 Return: -320.0
INFO:tensorflow:Average training steps per second: 189.95
I0901 12:35:50.514473 139816666404864 replay_runner.py:36] Average training steps per second: 189.95
I0901 12:35:50.822507 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.39
I0901 12:35:56.502885 139816666404864 replay_runner.py:36] Average training steps per second: 184.39
I0901 12:35:56.943332 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 284 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 186.39
I0901 12:36:02.564829 139816666404864 replay_runner.py:36] Average training steps per second: 186.39
I0901 12:36:02.843675 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.60
I0901 12:36:08.430167 139816666404864 replay_runner.py:36] Average training steps per second: 186.60
I0901 12:36:08.878241 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 12:36:09.122917 139816666404864 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 182.70
I0901 12:36:14.596853 139816666404864 replay_runner.py:36] Average training steps per second: 182.70
I0901 12:36:15.051763 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 189.77
I0901 12:36:20.572796 139816666404864 replay_runner.py:36] Average training steps per second: 189.77
I0901 12:36:20.754764 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 16

Steps executed: 211 Episode length: 211 Return: -210.0
INFO:tensorflow:Average training steps per second: 186.76
I0901 12:36:26.355601 139816666404864 replay_runner.py:36] Average training steps per second: 186.76
I0901 12:36:26.545820 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.00
INFO:tensorflow:Starting iteration 17

Steps executed: 315 Episode length: 205 Return: -204.0
INFO:tensorflow:Average training steps per second: 185.81
I0901 12:36:32.167740 139816666404864 replay_runner.py:36] Average training steps per second: 185.81
I0901 12:36:32.458992 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50
INFO:tensorflow:Starting iteration 18

Steps executed: 427 Episode length: 236 Return: -235.0
INFO:tensorflow:Average training steps per second: 188.26
I0901 12:36:38.022500 139816666404864 replay_runner.py:36] Average training steps per second: 188.26
I0901 12:36:38.395036 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.33
INFO:tensorflow:Starting iteration 19

Steps executed: 242 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 183.62
I0901 12:36:44.088943 139816666404864 replay_runner.py:36] Average training steps per second: 183.62
I0901 12:36:44.311216 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 20

Steps executed: 204 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 186.37
I0901 12:36:49.930821 139816666404864 replay_runner.py:36] Average training steps per second: 186.37
I0901 12:36:50.119625 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.20
I0901 12:36:55.682767 139816666404864 replay_runner.py:36] Average training steps per second: 188.20
I0901 12:36:56.129688 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 196.59
I0901 12:37:01.458213 139816666404864 replay_runner.py:36] Average training steps per second: 196.59
I0901 12:37:01.653997 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 23

Steps executed: 118 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 193.12
I0901 12:37:07.068580 139816666404864 replay_runner.py:36] Average training steps per second: 193.12

Steps executed: 237 Episode length: 119 Return: -118.0
INFO:tensorflow:Starting iteration 24

Steps executed: 274 Episode length: 140 Return: -139.0
INFO:tensorflow:Average training steps per second: 195.19
I0901 12:37:12.608387 139816666404864 replay_runner.py:36] Average training steps per second: 195.19
I0901 12:37:12.860843 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.58
I0901 12:37:18.413526 139816666404864 replay_runner.py:36] Average training steps per second: 188.58
I0901 12:37:18.849623 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 224 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 183.30
I0901 12:37:24.542492 139816666404864 replay_runner.py:36] Average training steps per second: 183.30
I0901 12:37:24.742527 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 27

Steps executed: 663 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.05
I0901 12:37:30.280063 139816666404864 replay_runner.py:36] Average training steps per second: 189.05
I0901 12:37:30.880999 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.33
INFO:tensorflow:Starting iteration 28

Steps executed: 231 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 191.15
I0901 12:37:36.366483 139816666404864 replay_runner.py:36] Average training steps per second: 191.15
I0901 12:37:36.581460 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 183.84
I0901 12:37:42.253240 139816666404864 replay_runner.py:36] Average training steps per second: 183.84
I0901 12:37:42.674572 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00