I0828 10:18:36.777417 139730981537792 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:36.778028 139730981537792 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:36.842488 139730981537792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:36.843713 139730981537792 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:36.843819 139730981537792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:36.843895 139730981537792 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:36.844013 139730981537792 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:36.844088 139730981537792 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:36.844151 139730981537792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:36.844223 139730981537792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:36.844300 139730981537792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:36.844394 139730981537792 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:36.844468 139730981537792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:36.844542 139730981537792 dqn_agent.py:283] 	 seed: 1630145916842427
I0828 10:18:36.846660 139730981537792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:36.846843 139730981537792 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:18:36.846973 139730981537792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:36.847062 139730981537792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:36.847170 139730981537792 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:36.847249 139730981537792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:36.847330 139730981537792 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:36.847411 139730981537792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:36.847491 139730981537792 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0828 10:18:38.310135 139730981537792 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.765347 139730981537792 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.772991 139730981537792 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.777465 139730981537792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.777611 139730981537792 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.777713 139730981537792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.777776 139730981537792 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.777836 139730981537792 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.777891 139730981537792 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:38.780697 139730981537792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.780785 139730981537792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.780843 139730981537792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.780902 139730981537792 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.780996 139730981537792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.781069 139730981537792 dqn_agent.py:283] 	 seed: 1630145918777430
I0828 10:18:38.782656 139730981537792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.782773 139730981537792 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:18:38.782850 139730981537792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.782937 139730981537792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.783053 139730981537792 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.783111 139730981537792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.783180 139730981537792 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.783260 139730981537792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.783351 139730981537792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.802493 139730981537792 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.813999 139730981537792 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.814240 139730981537792 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 155.30
I0828 10:18:45.253853 139730981537792 replay_runner.py:36] Average training steps per second: 155.30
I0828 10:18:46.297076 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:18:46.522954 139730981537792 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.99
I0828 10:18:51.599656 139730981537792 replay_runner.py:36] Average training steps per second: 196.99
I0828 10:18:52.021068 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 204 Return: -203.0
INFO:tensorflow:Average training steps per second: 194.51
I0828 10:18:57.414300 139730981537792 replay_runner.py:36] Average training steps per second: 194.51
I0828 10:18:57.565268 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.00
INFO:tensorflow:Starting iteration 3

Steps executed: 318 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 190.64
I0828 10:19:03.039578 139730981537792 replay_runner.py:36] Average training steps per second: 190.64
I0828 10:19:03.326571 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 4
I0828 10:19:03.582780 139730981537792 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 207.57

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:19:08.848463 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 234 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 193.12
I0828 10:19:14.288676 139730981537792 replay_runner.py:36] Average training steps per second: 193.12
I0828 10:19:14.473902 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 6

Steps executed: 262 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 199.15
I0828 10:19:19.728225 139730981537792 replay_runner.py:36] Average training steps per second: 199.15
I0828 10:19:19.971455 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 7

Steps executed: 235 Episode length: 235 Return: -234.0
INFO:tensorflow:Average training steps per second: 202.85
I0828 10:19:25.151046 139730981537792 replay_runner.py:36] Average training steps per second: 202.85
I0828 10:19:25.343126 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.00
INFO:tensorflow:Starting iteration 8
I0828 10:19:25.586464 139730981537792 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 194.15

Steps executed: 553 Episode length: 354 Return: -353.0
I0828 10:19:31.216821 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 213.12
I0828 10:19:36.153203 139730981537792 replay_runner.py:36] Average training steps per second: 213.12
I0828 10:19:36.617938 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:19:36.872134 139730981537792 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 198.10
I0828 10:19:41.920567 139730981537792 replay_runner.py:36] Average training steps per second: 198.10
I0828 10:19:42.307846 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:19:42.540213 139730981537792 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 196.86
I0828 10:19:47.620525 139730981537792 replay_runner.py:36] Average training steps per second: 196.86
I0828 10:19:48.058086 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0828 10:19:48.314727 139730981537792 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 206.84
I0828 10:19:53.150029 139730981537792 replay_runner.py:36] Average training steps per second: 206.84
I0828 10:19:53.570227 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:19:53.823468 139730981537792 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.06
I0828 10:19:59.003689 139730981537792 replay_runner.py:36] Average training steps per second: 193.06
I0828 10:19:59.407353 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:19:59.636470 139730981537792 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 207.14
I0828 10:20:04.464493 139730981537792 replay_runner.py:36] Average training steps per second: 207.14
I0828 10:20:04.929709 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:20:05.195913 139730981537792 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 203.30
I0828 10:20:10.115442 139730981537792 replay_runner.py:36] Average training steps per second: 203.30
I0828 10:20:10.499628 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:20:10.746556 139730981537792 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.74
I0828 10:20:15.935264 139730981537792 replay_runner.py:36] Average training steps per second: 192.74
I0828 10:20:16.355216 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:20:16.586060 139730981537792 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 208.64
I0828 10:20:21.379830 139730981537792 replay_runner.py:36] Average training steps per second: 208.64
I0828 10:20:21.802007 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:20:22.043090 139730981537792 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.20
I0828 10:20:27.166526 139730981537792 replay_runner.py:36] Average training steps per second: 195.20
I0828 10:20:27.563084 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:20:27.805355 139730981537792 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 200.65
I0828 10:20:32.789912 139730981537792 replay_runner.py:36] Average training steps per second: 200.65
I0828 10:20:33.231408 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:20:33.476130 139730981537792 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 207.63
I0828 10:20:38.292757 139730981537792 replay_runner.py:36] Average training steps per second: 207.63
I0828 10:20:38.694936 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:20:38.943083 139730981537792 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 194.97
I0828 10:20:44.072776 139730981537792 replay_runner.py:36] Average training steps per second: 194.97
I0828 10:20:44.477288 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:20:44.704975 139730981537792 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 205.42
I0828 10:20:49.573571 139730981537792 replay_runner.py:36] Average training steps per second: 205.42
I0828 10:20:50.035865 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:20:50.273829 139730981537792 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.72
I0828 10:20:55.256394 139730981537792 replay_runner.py:36] Average training steps per second: 200.72
I0828 10:20:55.643579 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:20:55.873722 139730981537792 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 199.16
I0828 10:21:00.895166 139730981537792 replay_runner.py:36] Average training steps per second: 199.16
I0828 10:21:01.315428 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:21:01.568762 139730981537792 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.16
I0828 10:21:06.443662 139730981537792 replay_runner.py:36] Average training steps per second: 205.16
I0828 10:21:06.862762 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:21:07.094532 139730981537792 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.41
I0828 10:21:12.238900 139730981537792 replay_runner.py:36] Average training steps per second: 194.41
I0828 10:21:12.622659 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:21:12.862479 139730981537792 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 198.88
I0828 10:21:17.891321 139730981537792 replay_runner.py:36] Average training steps per second: 198.88
I0828 10:21:18.338877 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:21:18.575896 139730981537792 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 208.95
I0828 10:21:23.362281 139730981537792 replay_runner.py:36] Average training steps per second: 208.95
I0828 10:21:23.745836 139730981537792 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29
I0828 10:21:23.968881 139730981537792 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 211.80
I0828 10:21:28.690734 139730981537792 replay_runner.py:36] Average training steps per second: 211.80

Done fixed training!Episode length: 500 Return: -500.0