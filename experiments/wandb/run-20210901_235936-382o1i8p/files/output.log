Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0901 23:59:43.218784 140630304192512 run_experiment.py:549] Creating TrainRunner ...
I0901 23:59:43.233516 140630304192512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:43.239169 140630304192512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:43.239551 140630304192512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:43.239672 140630304192512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:43.240035 140630304192512 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:43.240139 140630304192512 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:43.240475 140630304192512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:43.240575 140630304192512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:43.240895 140630304192512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:43.241000 140630304192512 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:43.241322 140630304192512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:43.241416 140630304192512 dqn_agent.py:283] 	 seed: 1630540783233459
I0901 23:59:43.247627 140630304192512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:43.247813 140630304192512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:59:43.248504 140630304192512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:43.248627 140630304192512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:43.249019 140630304192512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:43.249123 140630304192512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:43.249457 140630304192512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:43.249554 140630304192512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:43.249876 140630304192512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:43.323248 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:43.787637 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:43.801039 140630304192512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:59:43.809061 140630304192512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:43.809332 140630304192512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:43.809541 140630304192512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:43.809874 140630304192512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:43.810063 140630304192512 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:43.810210 140630304192512 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:43.810341 140630304192512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:43.810487 140630304192512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:43.810570 140630304192512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:43.810650 140630304192512 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:43.810729 140630304192512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:43.810875 140630304192512 dqn_agent.py:283] 	 seed: 1630540783809004
I0901 23:59:43.813180 140630304192512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:43.813334 140630304192512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:59:43.813430 140630304192512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:43.813523 140630304192512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:43.813606 140630304192512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:43.813696 140630304192512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:43.813775 140630304192512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:43.813864 140630304192512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:43.813940 140630304192512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:43.846913 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:43.867434 140630304192512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:59:43.867679 140630304192512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 160.20
I0901 23:59:50.110348 140630304192512 replay_runner.py:36] Average training steps per second: 160.20
Steps executed: 203 Episode length: 8 Return: 8.0.0
I0901 23:59:51.248107 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 198.76
I0901 23:59:56.452996 140630304192512 replay_runner.py:36] Average training steps per second: 198.76
I0901 23:59:56.581720 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 2

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 200.90
I0902 00:00:01.740934 140630304192512 replay_runner.py:36] Average training steps per second: 200.90
I0902 00:00:01.872924 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.38
I0902 00:00:07.159252 140630304192512 replay_runner.py:36] Average training steps per second: 196.38
I0902 00:00:07.294083 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.81
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.49
I0902 00:00:12.633690 140630304192512 replay_runner.py:36] Average training steps per second: 194.49
I0902 00:00:12.765181 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 00:00:12.947661 140630304192512 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.64
I0902 00:00:18.007868 140630304192512 replay_runner.py:36] Average training steps per second: 197.64
I0902 00:00:18.481322 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 317 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 194.27
I0902 00:00:23.813964 140630304192512 replay_runner.py:36] Average training steps per second: 194.27
I0902 00:00:24.015392 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.30
I0902 00:00:29.404020 140630304192512 replay_runner.py:36] Average training steps per second: 192.30
I0902 00:00:29.544073 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0902 00:00:29.732097 140630304192512 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 188.49
I0902 00:00:35.037657 140630304192512 replay_runner.py:36] Average training steps per second: 188.49
I0902 00:00:35.185145 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 283 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 194.96
I0902 00:00:40.501863 140630304192512 replay_runner.py:36] Average training steps per second: 194.96
I0902 00:00:40.691314 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 10

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.44
I0902 00:00:46.278461 140630304192512 replay_runner.py:36] Average training steps per second: 185.44
I0902 00:00:46.542827 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 11

Steps executed: 300 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 190.91
I0902 00:00:51.973474 140630304192512 replay_runner.py:36] Average training steps per second: 190.91
I0902 00:00:52.184722 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 12

Steps executed: 308 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 188.64
I0902 00:00:57.683387 140630304192512 replay_runner.py:36] Average training steps per second: 188.64
I0902 00:00:57.902723 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 13

Steps executed: 129 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 192.65
I0902 00:01:03.292274 140630304192512 replay_runner.py:36] Average training steps per second: 192.65

Steps executed: 258 Episode length: 129 Return: 129.0
INFO:tensorflow:Starting iteration 14

Steps executed: 341 Episode length: 174 Return: 174.0
INFO:tensorflow:Average training steps per second: 191.11
I0902 00:01:08.904061 140630304192512 replay_runner.py:36] Average training steps per second: 191.11
I0902 00:01:09.142477 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 15

Steps executed: 306 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 192.22
I0902 00:01:14.515648 140630304192512 replay_runner.py:36] Average training steps per second: 192.22
I0902 00:01:14.728268 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 16

Steps executed: 316 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 189.15
I0902 00:01:20.208040 140630304192512 replay_runner.py:36] Average training steps per second: 189.15
I0902 00:01:20.439350 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 17

Steps executed: 370 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 199.36
I0902 00:01:25.642768 140630304192512 replay_runner.py:36] Average training steps per second: 199.36
I0902 00:01:25.888001 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.61
I0902 00:01:31.273021 140630304192512 replay_runner.py:36] Average training steps per second: 192.61
I0902 00:01:31.412413 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 00:01:31.601797 140630304192512 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.47
I0902 00:01:36.825096 140630304192512 replay_runner.py:36] Average training steps per second: 191.47
I0902 00:01:36.962212 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 00:01:37.144937 140630304192512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.35
I0902 00:01:42.344244 140630304192512 replay_runner.py:36] Average training steps per second: 192.35
I0902 00:01:42.475369 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:01:42.652163 140630304192512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 197.92
I0902 00:01:47.705069 140630304192512 replay_runner.py:36] Average training steps per second: 197.92
I0902 00:01:47.858245 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:01:48.041991 140630304192512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.63
I0902 00:01:53.128059 140630304192512 replay_runner.py:36] Average training steps per second: 196.63
I0902 00:01:53.259020 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:01:53.439024 140630304192512 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.95
I0902 00:01:58.621937 140630304192512 replay_runner.py:36] Average training steps per second: 192.95
I0902 00:01:58.763692 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 381 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.64
I0902 00:02:04.016310 140630304192512 replay_runner.py:36] Average training steps per second: 197.64
I0902 00:02:04.269443 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.30
I0902 00:02:09.756845 140630304192512 replay_runner.py:36] Average training steps per second: 188.30
I0902 00:02:09.891474 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:02:10.069343 140630304192512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.62
I0902 00:02:15.104542 140630304192512 replay_runner.py:36] Average training steps per second: 198.62
I0902 00:02:15.240987 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.53
I0902 00:02:20.613121 140630304192512 replay_runner.py:36] Average training steps per second: 192.53
I0902 00:02:20.871324 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.62
I0902 00:02:26.073894 140630304192512 replay_runner.py:36] Average training steps per second: 199.62
I0902 00:02:26.213753 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 00:02:26.409630 140630304192512 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 184.92
I0902 00:02:31.817844 140630304192512 replay_runner.py:36] Average training steps per second: 184.92

Done fixed training!Episode length: 200 Return: 200.0