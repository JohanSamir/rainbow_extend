I0902 11:21:07.096670 140481598638080 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 11:21:07.097240 140481598638080 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 11:21:07.172290 140481598638080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:07.173567 140481598638080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:07.173690 140481598638080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:07.173758 140481598638080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:07.173817 140481598638080 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:07.173928 140481598638080 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:07.173988 140481598638080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:07.174075 140481598638080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:07.174201 140481598638080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:07.174303 140481598638080 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:07.174393 140481598638080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:07.174472 140481598638080 dqn_agent.py:283] 	 seed: 1630581667172219
I0902 11:21:07.176589 140481598638080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:07.176748 140481598638080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:07.176843 140481598638080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:07.176908 140481598638080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:07.176965 140481598638080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:07.177020 140481598638080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:07.177130 140481598638080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:07.177220 140481598638080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:07.177303 140481598638080 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 11:21:08.603760 140481598638080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.967781 140481598638080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.976257 140481598638080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:21:08.983046 140481598638080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:08.983207 140481598638080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:08.983297 140481598638080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:08.983369 140481598638080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:08.983435 140481598638080 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:08.983494 140481598638080 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:08.983553 140481598638080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:08.983613 140481598638080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:08.983671 140481598638080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:08.983728 140481598638080 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:08.983784 140481598638080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:08.983841 140481598638080 dqn_agent.py:283] 	 seed: 1630581668983009
I0902 11:21:08.985612 140481598638080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:08.985729 140481598638080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:08.985828 140481598638080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:08.985899 140481598638080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:08.985964 140481598638080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:08.986025 140481598638080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:08.986091 140481598638080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:08.986212 140481598638080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:08.986274 140481598638080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:09.005391 140481598638080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:09.017909 140481598638080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:21:09.018141 140481598638080 replay_runner.py:41] Starting iteration 0
Steps executed: 315 Episode length: 168 Return: -304.13805322987088
INFO:tensorflow:Average training steps per second: 167.37
I0902 11:21:14.993047 140481598638080 replay_runner.py:36] Average training steps per second: 167.37
I0902 11:21:15.933969 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.94
INFO:tensorflow:Starting iteration 1

Steps executed: 279 Episode length: 173 Return: -331.40072696394066
INFO:tensorflow:Average training steps per second: 205.07
I0902 11:21:25.053684 140481598638080 replay_runner.py:36] Average training steps per second: 205.07
I0902 11:21:25.318909 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.50
INFO:tensorflow:Starting iteration 2

Steps executed: 128 Episode length: 128 Return: -344.39165220187886
INFO:tensorflow:Average training steps per second: 202.46

Steps executed: 248 Episode length: 120 Return: -460.61599738436096
I0902 11:21:34.786616 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.50
INFO:tensorflow:Starting iteration 3

Steps executed: 420 Episode length: 297 Return: -299.25573823303916
INFO:tensorflow:Average training steps per second: 206.38
I0902 11:21:43.941843 140481598638080 replay_runner.py:36] Average training steps per second: 206.38
I0902 11:21:44.410207 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.90
INFO:tensorflow:Starting iteration 4
I0902 11:21:48.703594 140481598638080 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 215.17

Steps executed: 1000 Episode length: 1000 Return: -101.81683789515378
I0902 11:21:56.868785 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.82
INFO:tensorflow:Starting iteration 5
I0902 11:22:01.227925 140481598638080 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 216.21

Steps executed: 705 Episode length: 705 Return: -1551.342252298303578
I0902 11:22:07.268959 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -1551.34
INFO:tensorflow:Starting iteration 6

Steps executed: 338 Episode length: 338 Return: -319.6395650711857678
INFO:tensorflow:Average training steps per second: 218.67
I0902 11:22:16.100522 140481598638080 replay_runner.py:36] Average training steps per second: 218.67
I0902 11:22:16.566855 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.64
INFO:tensorflow:Starting iteration 7
I0902 11:22:20.844041 140481598638080 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 225.59

Steps executed: 1000 Episode length: 1000 Return: -329.74291793081557
I0902 11:22:28.012804 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.74
INFO:tensorflow:Starting iteration 8
I0902 11:22:32.349930 140481598638080 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 220.70

Steps executed: 323 Episode length: 323 Return: -823.5152406617543557
I0902 11:22:37.347276 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -823.52
INFO:tensorflow:Starting iteration 9

Steps executed: 338 Episode length: 209 Return: -580.0015962801006557
INFO:tensorflow:Average training steps per second: 225.09
I0902 11:22:45.975320 140481598638080 replay_runner.py:36] Average training steps per second: 225.09
I0902 11:22:46.348815 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -627.42
INFO:tensorflow:Starting iteration 10
I0902 11:22:50.750529 140481598638080 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.40

Steps executed: 1000 Episode length: 1000 Return: -252.78131125236695
I0902 11:22:57.564530 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.78
INFO:tensorflow:Starting iteration 11
I0902 11:23:01.910607 140481598638080 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 229.38

Steps executed: 798 Episode length: 798 Return: -566.6254090410514695
I0902 11:23:08.433003 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -566.63
INFO:tensorflow:Starting iteration 12
I0902 11:23:12.821393 140481598638080 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 224.16

Steps executed: 840 Episode length: 840 Return: -129.4218680876168695
I0902 11:23:18.895851 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.42
INFO:tensorflow:Starting iteration 13
I0902 11:23:23.301481 140481598638080 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 223.67

Steps executed: 1000 Episode length: 1000 Return: -115.49480520145816
I0902 11:23:30.401781 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.49
INFO:tensorflow:Starting iteration 14
I0902 11:23:34.762181 140481598638080 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 223.01

Steps executed: 1000 Episode length: 1000 Return: -69.285088247264116
I0902 11:23:42.348577 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.29
INFO:tensorflow:Starting iteration 15
I0902 11:23:46.742091 140481598638080 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 224.81

Steps executed: 964 Episode length: 810 Return: -312.5391371738985916
I0902 11:23:52.840466 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.50
INFO:tensorflow:Starting iteration 16
I0902 11:23:56.901298 140481598638080 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 275.55

Steps executed: 1000 Episode length: 1000 Return: -36.698427968743976
I0902 11:24:02.545374 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -36.70
INFO:tensorflow:Starting iteration 17

Steps executed: 246 Episode length: 169 Return: 52.481023155895116976
INFO:tensorflow:Average training steps per second: 235.12
I0902 11:24:10.595845 140481598638080 replay_runner.py:36] Average training steps per second: 235.12
I0902 11:24:10.804121 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -25.04
INFO:tensorflow:Starting iteration 18
I0902 11:24:14.864132 140481598638080 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 221.73


Steps executed: 1010 Episode length: 883 Return: -131.111317665758976
I0902 11:24:22.349646 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.49
INFO:tensorflow:Starting iteration 19
I0902 11:24:26.712599 140481598638080 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 219.08

Steps executed: 1000 Episode length: 1000 Return: 14.0785709302356076
I0902 11:24:35.151048 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.08
INFO:tensorflow:Starting iteration 20
I0902 11:24:39.506575 140481598638080 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 223.18

Steps executed: 785 Episode length: 785 Return: -699.7997872954596076
I0902 11:24:46.673221 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -699.80
INFO:tensorflow:Starting iteration 21

Steps executed: 376 Episode length: 376 Return: -763.4414487953355076
INFO:tensorflow:Average training steps per second: 218.47
I0902 11:24:55.654954 140481598638080 replay_runner.py:36] Average training steps per second: 218.47
I0902 11:24:56.284247 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -763.44
INFO:tensorflow:Starting iteration 22
I0902 11:25:00.707226 140481598638080 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 216.58

Steps executed: 263 Episode length: 263 Return: -198.5727152859094076
I0902 11:25:05.646386 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.57
INFO:tensorflow:Starting iteration 23

Steps executed: 419 Episode length: 263 Return: 13.630665119088497076
INFO:tensorflow:Average training steps per second: 219.68
I0902 11:25:14.566701 140481598638080 replay_runner.py:36] Average training steps per second: 219.68
I0902 11:25:15.103409 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.48
INFO:tensorflow:Starting iteration 24

Steps executed: 399 Episode length: 399 Return: -3.004490959588821476
INFO:tensorflow:Average training steps per second: 215.46
I0902 11:25:24.148132 140481598638080 replay_runner.py:36] Average training steps per second: 215.46
I0902 11:25:24.886749 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -3.00
INFO:tensorflow:Starting iteration 25
I0902 11:25:29.220871 140481598638080 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 220.73

Steps executed: 1000 Episode length: 1000 Return: 64.1901372552973276
I0902 11:25:36.521841 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: 64.19
INFO:tensorflow:Starting iteration 26
I0902 11:25:40.937040 140481598638080 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 223.97


Steps executed: 1013 Episode length: 885 Return: -778.058738499124476
I0902 11:25:48.427603 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -665.75
INFO:tensorflow:Starting iteration 27
I0902 11:25:52.815428 140481598638080 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 221.73

Steps executed: 470 Episode length: 470 Return: -550.4417739003943476
I0902 11:25:58.103068 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.44
INFO:tensorflow:Starting iteration 28
I0902 11:26:02.516484 140481598638080 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 220.71

Steps executed: 395 Episode length: 395 Return: -532.3795462815473476
I0902 11:26:07.871106 140481598638080 run_experiment.py:428] Average undiscounted return per evaluation episode: -532.38
INFO:tensorflow:Starting iteration 29

Steps executed: 131 Episode length: 131 Return: 29.321423147111873476
INFO:tensorflow:Average training steps per second: 223.25

Steps executed: 811 Episode length: 680 Return: 188.90403552722222476

Done fixed training!Episode length: 680 Return: 188.90403552722222476