Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 23:31:30.799331 139650945370112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:31:30.808429 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:30.808640 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:30.808994 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:30.809255 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:30.809377 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:30.809463 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:30.809545 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:30.809655 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:30.809779 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:30.809948 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:30.810060 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:30.810178 139650945370112 dqn_agent.py:283] 	 seed: 1630625490808372
I0902 23:31:30.812392 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:30.812528 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:31:30.812618 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:30.812688 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:30.812751 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:30.812821 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:30.812909 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:30.813026 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:30.813108 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:30.849065 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:31.390792 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:31.407376 139650945370112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:31:31.426721 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:31.426941 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:31.427090 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:31.427254 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:31.427352 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:31.427490 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:31.427621 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:31.427761 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:31.427873 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:31.427988 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:31.428126 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:31.428254 139650945370112 dqn_agent.py:283] 	 seed: 1630625491426666
I0902 23:31:31.431019 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:31.431187 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:31:31.431325 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:31.431467 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:31.431582 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:31.431728 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:31.431858 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:31.431976 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:31.432112 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:31.508471 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:31.531882 139650945370112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:31:31.532176 139650945370112 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 138.55
I0902 23:31:38.750283 139650945370112 replay_runner.py:36] Average training steps per second: 138.55
I0902 23:31:39.859644 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.13
I0902 23:31:45.212492 139650945370112 replay_runner.py:36] Average training steps per second: 194.13
I0902 23:31:45.345694 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2
I0902 23:31:45.540934 139650945370112 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.90
I0902 23:31:50.698792 139650945370112 replay_runner.py:36] Average training steps per second: 193.90
I0902 23:31:50.825022 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.02
I0902 23:31:56.135087 139650945370112 replay_runner.py:36] Average training steps per second: 195.02
I0902 23:31:56.391223 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 4

Steps executed: 329 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 195.07
I0902 23:32:01.694672 139650945370112 replay_runner.py:36] Average training steps per second: 195.07
I0902 23:32:01.912930 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.58
I0902 23:32:07.241379 139650945370112 replay_runner.py:36] Average training steps per second: 194.58
I0902 23:32:07.368346 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 304 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 189.97
I0902 23:32:12.818778 139650945370112 replay_runner.py:36] Average training steps per second: 189.97
I0902 23:32:13.035894 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 7

Steps executed: 314 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 193.10
I0902 23:32:18.406359 139650945370112 replay_runner.py:36] Average training steps per second: 193.10
I0902 23:32:18.625002 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 8

Steps executed: 235 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 189.88
I0902 23:32:24.087552 139650945370112 replay_runner.py:36] Average training steps per second: 189.88
I0902 23:32:24.245833 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 9

Steps executed: 309 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 194.33
I0902 23:32:29.589931 139650945370112 replay_runner.py:36] Average training steps per second: 194.33
I0902 23:32:29.799795 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 10

Steps executed: 262 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 189.03
I0902 23:32:35.270298 139650945370112 replay_runner.py:36] Average training steps per second: 189.03
I0902 23:32:35.440933 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 11

Steps executed: 268 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 197.81
I0902 23:32:40.689704 139650945370112 replay_runner.py:36] Average training steps per second: 197.81
I0902 23:32:40.871540 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 12

Steps executed: 268 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 189.58
I0902 23:32:46.343166 139650945370112 replay_runner.py:36] Average training steps per second: 189.58
I0902 23:32:46.522584 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 194.85
I0902 23:32:51.851227 139650945370112 replay_runner.py:36] Average training steps per second: 194.85
I0902 23:32:52.015156 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 14

Steps executed: 235 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 186.77
I0902 23:32:57.562801 139650945370112 replay_runner.py:36] Average training steps per second: 186.77
I0902 23:32:57.724901 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 15

Steps executed: 271 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 191.65
I0902 23:33:03.137966 139650945370112 replay_runner.py:36] Average training steps per second: 191.65
I0902 23:33:03.313659 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.50
INFO:tensorflow:Starting iteration 16

Steps executed: 277 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 184.71
I0902 23:33:08.919091 139650945370112 replay_runner.py:36] Average training steps per second: 184.71
I0902 23:33:09.127400 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 17
I0902 23:33:09.320964 139650945370112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 188.74
I0902 23:33:14.619724 139650945370112 replay_runner.py:36] Average training steps per second: 188.74

Steps executed: 345 Episode length: 193 Return: 193.0
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.15
I0902 23:33:20.326343 139650945370112 replay_runner.py:36] Average training steps per second: 189.15
I0902 23:33:20.464874 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:33:20.656435 139650945370112 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 188.95
I0902 23:33:25.949215 139650945370112 replay_runner.py:36] Average training steps per second: 188.95
I0902 23:33:26.083008 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:33:26.268510 139650945370112 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.16
I0902 23:33:31.555464 139650945370112 replay_runner.py:36] Average training steps per second: 189.16
I0902 23:33:31.697817 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:33:31.883366 139650945370112 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 190.72
I0902 23:33:37.127156 139650945370112 replay_runner.py:36] Average training steps per second: 190.72
I0902 23:33:37.262788 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:33:37.448863 139650945370112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.49
I0902 23:33:42.564612 139650945370112 replay_runner.py:36] Average training steps per second: 195.49
I0902 23:33:42.702707 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.77
I0902 23:33:47.947340 139650945370112 replay_runner.py:36] Average training steps per second: 197.77
I0902 23:33:48.215727 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.22
I0902 23:33:53.499430 139650945370112 replay_runner.py:36] Average training steps per second: 196.22
I0902 23:33:53.631238 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:33:53.813697 139650945370112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.51
I0902 23:33:58.928843 139650945370112 replay_runner.py:36] Average training steps per second: 195.51
I0902 23:33:59.061579 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:33:59.293329 139650945370112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.37
I0902 23:34:04.360405 139650945370112 replay_runner.py:36] Average training steps per second: 197.37
I0902 23:34:04.497292 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:34:04.685894 139650945370112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 188.45
I0902 23:34:09.992797 139650945370112 replay_runner.py:36] Average training steps per second: 188.45
I0902 23:34:10.130876 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:34:10.324826 139650945370112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 192.69
I0902 23:34:15.514927 139650945370112 replay_runner.py:36] Average training steps per second: 192.69
I0902 23:34:15.652868 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:34:15.845008 139650945370112 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 194.41
I0902 23:34:20.989084 139650945370112 replay_runner.py:36] Average training steps per second: 194.41

Done fixed training!Episode length: 200 Return: 200.0