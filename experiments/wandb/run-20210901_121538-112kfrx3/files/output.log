Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0901 12:15:44.641943 139796751951872 run_experiment.py:549] Creating TrainRunner ...
I0901 12:15:44.649795 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:15:44.650030 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:15:44.650186 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:15:44.650365 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:15:44.650461 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:15:44.650627 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:15:44.650748 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:15:44.650927 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:15:44.651062 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:15:44.651151 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:15:44.651236 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:15:44.651321 139796751951872 dqn_agent.py:283] 	 seed: 1630498544649742
I0901 12:15:44.654179 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:15:44.654356 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:15:44.654504 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:15:44.654635 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:15:44.654718 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:15:44.654891 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:15:44.655035 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:15:44.655148 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:15:44.655283 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:15:44.705165 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:45.158592 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:45.173810 139796751951872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:15:45.185694 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:15:45.185883 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:15:45.186016 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:15:45.186228 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:15:45.186321 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:15:45.186604 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:15:45.186950 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:15:45.187077 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:15:45.187237 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:15:45.187360 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:15:45.187462 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:15:45.187559 139796751951872 dqn_agent.py:283] 	 seed: 1630498545185650
I0901 12:15:45.190218 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:15:45.190330 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:15:45.190404 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:15:45.190468 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:15:45.190527 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:15:45.190621 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:15:45.190765 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:15:45.190894 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:15:45.190980 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:15:45.224948 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:45.242876 139796751951872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:15:45.243077 139796751951872 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 173.05
I0901 12:15:51.022025 139796751951872 replay_runner.py:36] Average training steps per second: 173.05

Steps executed: 200 Episode length: 10 Return: 10.0
I0901 12:15:52.332421 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 1
I0901 12:15:52.522010 139796751951872 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 213.04
I0901 12:15:57.216361 139796751951872 replay_runner.py:36] Average training steps per second: 213.04
I0901 12:15:57.349838 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 52.50
INFO:tensorflow:Starting iteration 2


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.31
I0901 12:16:02.904684 139796751951872 replay_runner.py:36] Average training steps per second: 186.31
I0901 12:16:03.051412 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0901 12:16:03.242629 139796751951872 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.02
I0901 12:16:08.267641 139796751951872 replay_runner.py:36] Average training steps per second: 199.02
I0901 12:16:08.407884 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 312 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 185.34
I0901 12:16:13.994545 139796751951872 replay_runner.py:36] Average training steps per second: 185.34
I0901 12:16:14.228563 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.46
I0901 12:16:19.630511 139796751951872 replay_runner.py:36] Average training steps per second: 192.46
I0901 12:16:19.767473 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 369 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 184.73
I0901 12:16:25.376338 139796751951872 replay_runner.py:36] Average training steps per second: 184.73
I0901 12:16:25.651222 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.23
I0901 12:16:31.116186 139796751951872 replay_runner.py:36] Average training steps per second: 190.23
I0901 12:16:31.253230 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 307 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 184.24
I0901 12:16:36.877583 139796751951872 replay_runner.py:36] Average training steps per second: 184.24
I0901 12:16:37.098947 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 9

Steps executed: 156 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 193.51
I0901 12:16:42.459812 139796751951872 replay_runner.py:36] Average training steps per second: 193.51

Steps executed: 287 Episode length: 131 Return: 131.0
INFO:tensorflow:Starting iteration 10

Steps executed: 333 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 183.05
I0901 12:16:48.319391 139796751951872 replay_runner.py:36] Average training steps per second: 183.05
I0901 12:16:48.557091 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 11

Steps executed: 325 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 191.54
I0901 12:16:53.969421 139796751951872 replay_runner.py:36] Average training steps per second: 191.54
I0901 12:16:54.199840 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 183.99
I0901 12:16:59.830715 139796751951872 replay_runner.py:36] Average training steps per second: 183.99
I0901 12:16:59.976451 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 306 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 191.25
I0901 12:17:05.387150 139796751951872 replay_runner.py:36] Average training steps per second: 191.25
I0901 12:17:05.596661 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 14

Steps executed: 327 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 187.03
I0901 12:17:11.140514 139796751951872 replay_runner.py:36] Average training steps per second: 187.03
I0901 12:17:11.371587 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 15
I0901 12:17:11.564930 139796751951872 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.59

Steps executed: 338 Episode length: 162 Return: 162.0
I0901 12:17:17.085305 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 16

Steps executed: 292 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 187.44
I0901 12:17:22.610654 139796751951872 replay_runner.py:36] Average training steps per second: 187.44
I0901 12:17:22.841481 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 17

Steps executed: 357 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 190.17
I0901 12:17:28.290231 139796751951872 replay_runner.py:36] Average training steps per second: 190.17
I0901 12:17:28.520098 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.50
INFO:tensorflow:Starting iteration 18

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.41
I0901 12:17:34.101056 139796751951872 replay_runner.py:36] Average training steps per second: 185.41
I0901 12:17:34.350530 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.91
I0901 12:17:39.746717 139796751951872 replay_runner.py:36] Average training steps per second: 191.91
I0901 12:17:39.878771 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:17:40.057613 139796751951872 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 183.95
I0901 12:17:45.494220 139796751951872 replay_runner.py:36] Average training steps per second: 183.95
I0901 12:17:45.640879 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 12:17:45.838770 139796751951872 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 194.13
I0901 12:17:50.990534 139796751951872 replay_runner.py:36] Average training steps per second: 194.13
I0901 12:17:51.132388 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 12:17:51.330300 139796751951872 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 183.82
I0901 12:17:56.770743 139796751951872 replay_runner.py:36] Average training steps per second: 183.82
I0901 12:17:56.909788 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:17:57.101058 139796751951872 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 188.57
I0901 12:18:02.404555 139796751951872 replay_runner.py:36] Average training steps per second: 188.57
I0901 12:18:02.559857 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:18:02.753690 139796751951872 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 186.56
I0901 12:18:08.114581 139796751951872 replay_runner.py:36] Average training steps per second: 186.56
I0901 12:18:08.252120 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 387 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.52
I0901 12:18:13.836662 139796751951872 replay_runner.py:36] Average training steps per second: 185.52
I0901 12:18:14.138329 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.94
I0901 12:18:19.633085 139796751951872 replay_runner.py:36] Average training steps per second: 188.94
I0901 12:18:19.776326 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:18:19.977821 139796751951872 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.03
I0901 12:18:25.268545 139796751951872 replay_runner.py:36] Average training steps per second: 189.03
I0901 12:18:25.413473 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:18:25.612536 139796751951872 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 184.97
I0901 12:18:31.019263 139796751951872 replay_runner.py:36] Average training steps per second: 184.97
I0901 12:18:31.164580 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.49
I0901 12:18:36.474385 139796751951872 replay_runner.py:36] Average training steps per second: 195.49
I0901 12:18:36.606385 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00