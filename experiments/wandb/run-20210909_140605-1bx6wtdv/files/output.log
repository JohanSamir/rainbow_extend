I0909 14:06:10.877650 140155640293376 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 14:06:10.878360 140155640293376 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 14:06:10.930667 140155640293376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:10.931794 140155640293376 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:10.931853 140155640293376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:10.931920 140155640293376 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:10.931958 140155640293376 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:10.932013 140155640293376 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:10.932085 140155640293376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:10.932157 140155640293376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:10.932206 140155640293376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:10.932281 140155640293376 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:10.932525 140155640293376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:10.932612 140155640293376 dqn_agent.py:283] 	 seed: 1631196370930616
I0909 14:06:10.934161 140155640293376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:10.934307 140155640293376 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:10.934380 140155640293376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:10.934442 140155640293376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:10.934500 140155640293376 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:10.934609 140155640293376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:10.934665 140155640293376 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:10.934721 140155640293376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:10.934780 140155640293376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.170949 140155640293376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 14:06:12.375154 140155640293376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.382744 140155640293376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 14:06:12.386733 140155640293376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:12.386857 140155640293376 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:12.386932 140155640293376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:12.386983 140155640293376 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:12.387041 140155640293376 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:12.387106 140155640293376 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:12.387158 140155640293376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:12.387234 140155640293376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:12.387331 140155640293376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:12.387412 140155640293376 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:12.387481 140155640293376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:12.387535 140155640293376 dqn_agent.py:283] 	 seed: 1631196372386704
I0909 14:06:12.388861 140155640293376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:12.388970 140155640293376 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:12.389042 140155640293376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:12.389100 140155640293376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:12.389172 140155640293376 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:12.389273 140155640293376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:12.389335 140155640293376 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:12.389422 140155640293376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:12.389550 140155640293376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.408447 140155640293376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.419122 140155640293376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 14:06:12.419264 140155640293376 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 202.21
I0909 14:06:17.364810 140155640293376 replay_runner.py:36] Average training steps per second: 202.21
I0909 14:06:18.231008 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 14:06:18.323864 140155640293376 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 256.78
I0909 14:06:22.218616 140155640293376 replay_runner.py:36] Average training steps per second: 256.78
I0909 14:06:22.478105 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 14:06:22.563709 140155640293376 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 254.13
I0909 14:06:26.500324 140155640293376 replay_runner.py:36] Average training steps per second: 254.13
I0909 14:06:26.747458 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3

Steps executed: 793 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 260.62
I0909 14:06:30.677462 140155640293376 replay_runner.py:36] Average training steps per second: 260.62
I0909 14:06:31.002888 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.50
INFO:tensorflow:Starting iteration 4

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 260.07
I0909 14:06:34.947016 140155640293376 replay_runner.py:36] Average training steps per second: 260.07
I0909 14:06:35.189273 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 14:06:35.282067 140155640293376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 261.64
I0909 14:06:39.104719 140155640293376 replay_runner.py:36] Average training steps per second: 261.64
I0909 14:06:39.353188 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 14:06:39.444674 140155640293376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 254.90
I0909 14:06:43.368020 140155640293376 replay_runner.py:36] Average training steps per second: 254.90
I0909 14:06:43.634864 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 14:06:43.727489 140155640293376 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 265.23
I0909 14:06:47.498296 140155640293376 replay_runner.py:36] Average training steps per second: 265.23
I0909 14:06:47.733713 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 320 Episode length: 162 Return: -162.0
INFO:tensorflow:Average training steps per second: 255.64
I0909 14:06:51.737487 140155640293376 replay_runner.py:36] Average training steps per second: 255.64
I0909 14:06:51.863127 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.00
INFO:tensorflow:Starting iteration 9

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.16
I0909 14:06:55.738610 140155640293376 replay_runner.py:36] Average training steps per second: 264.16
I0909 14:06:56.008083 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 334 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 263.50
I0909 14:06:59.901911 140155640293376 replay_runner.py:36] Average training steps per second: 263.50
I0909 14:07:00.048406 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.33
INFO:tensorflow:Starting iteration 11

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 266.08
I0909 14:07:03.908290 140155640293376 replay_runner.py:36] Average training steps per second: 266.08
I0909 14:07:04.164722 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0909 14:07:04.257467 140155640293376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 257.19
I0909 14:07:08.145959 140155640293376 replay_runner.py:36] Average training steps per second: 257.19
I0909 14:07:08.398061 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 253.38
I0909 14:07:12.438076 140155640293376 replay_runner.py:36] Average training steps per second: 253.38
I0909 14:07:12.532977 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 14

Steps executed: 208 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 262.52
I0909 14:07:16.437159 140155640293376 replay_runner.py:36] Average training steps per second: 262.52
I0909 14:07:16.536247 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 15

Steps executed: 720 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 262.37
I0909 14:07:20.440008 140155640293376 replay_runner.py:36] Average training steps per second: 262.37
I0909 14:07:20.734931 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.00
INFO:tensorflow:Starting iteration 16
I0909 14:07:20.827746 140155640293376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 262.29
I0909 14:07:24.640971 140155640293376 replay_runner.py:36] Average training steps per second: 262.29
I0909 14:07:24.746462 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 17

Steps executed: 241 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 253.51

Steps executed: 292 Episode length: 105 Return: -105.0
I0909 14:07:28.902805 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 18
I0909 14:07:28.995126 140155640293376 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 261.92
I0909 14:07:32.813370 140155640293376 replay_runner.py:36] Average training steps per second: 261.92

Steps executed: 213 Episode length: 108 Return: -108.0
INFO:tensorflow:Starting iteration 19
I0909 14:07:33.002662 140155640293376 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 259.28
I0909 14:07:36.859998 140155640293376 replay_runner.py:36] Average training steps per second: 259.28

Steps executed: 217 Episode length: 108 Return: -108.0
INFO:tensorflow:Starting iteration 20
I0909 14:07:37.045377 140155640293376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 260.92
I0909 14:07:40.878214 140155640293376 replay_runner.py:36] Average training steps per second: 260.92

Steps executed: 211 Episode length: 105 Return: -105.0
INFO:tensorflow:Starting iteration 21

Steps executed: 115 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 261.41

Steps executed: 715 Episode length: 600 Return: -600.0
I0909 14:07:45.181553 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 22
I0909 14:07:45.278600 140155640293376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 263.81

Steps executed: 236 Episode length: 123 Return: -123.0
I0909 14:07:49.171597 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 23
I0909 14:07:49.264596 140155640293376 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 264.42
I0909 14:07:53.047050 140155640293376 replay_runner.py:36] Average training steps per second: 264.42

Steps executed: 203 Episode length: 109 Return: -109.0
INFO:tensorflow:Starting iteration 24
I0909 14:07:53.220576 140155640293376 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 257.03
I0909 14:07:57.111635 140155640293376 replay_runner.py:36] Average training steps per second: 257.03

Steps executed: 211 Episode length: 92 Return: -92.0.0
INFO:tensorflow:Starting iteration 25

Steps executed: 109 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 262.08
I0909 14:08:01.111249 140155640293376 replay_runner.py:36] Average training steps per second: 262.08

Steps executed: 216 Episode length: 107 Return: -107.0
INFO:tensorflow:Starting iteration 26

Steps executed: 212 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 264.74
I0909 14:08:05.077293 140155640293376 replay_runner.py:36] Average training steps per second: 264.74
I0909 14:08:05.170481 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 27

Steps executed: 84 Episode length: 84 Return: -84.06.0
INFO:tensorflow:Average training steps per second: 263.61
I0909 14:08:09.054091 140155640293376 replay_runner.py:36] Average training steps per second: 263.61

Steps executed: 684 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 28

Steps executed: 102 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 263.47
I0909 14:08:13.226794 140155640293376 replay_runner.py:36] Average training steps per second: 263.47
I0909 14:08:13.342112 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 29


Done fixed training!Episode length: 150 Return: -150.0
INFO:tensorflow:Average training steps per second: 288.52
I0909 14:08:16.900848 140155640293376 replay_runner.py:36] Average training steps per second: 288.52
I0909 14:08:16.979032 140155640293376 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00