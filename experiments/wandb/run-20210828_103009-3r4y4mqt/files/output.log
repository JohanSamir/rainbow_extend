Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0828 10:30:16.413825 139874013124608 run_experiment.py:549] Creating TrainRunner ...
I0828 10:30:16.423137 139874013124608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:16.423354 139874013124608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:16.423456 139874013124608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:16.423550 139874013124608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:16.423638 139874013124608 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:16.423725 139874013124608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:16.423810 139874013124608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:16.423902 139874013124608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:16.424024 139874013124608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:16.424170 139874013124608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:16.424285 139874013124608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:16.424441 139874013124608 dqn_agent.py:283] 	 seed: 1630146616423070
I0828 10:30:16.427567 139874013124608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:16.427756 139874013124608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:16.427931 139874013124608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:16.428132 139874013124608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:16.428245 139874013124608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:16.428587 139874013124608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:16.428743 139874013124608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:16.428891 139874013124608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:16.429075 139874013124608 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:16.466933 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:17.197147 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:17.209756 139874013124608 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:30:17.216902 139874013124608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:17.217175 139874013124608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:17.217441 139874013124608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:17.217638 139874013124608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:17.217850 139874013124608 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:17.217998 139874013124608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:17.218098 139874013124608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:17.218260 139874013124608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:17.218384 139874013124608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:17.218563 139874013124608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:17.218659 139874013124608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:17.218734 139874013124608 dqn_agent.py:283] 	 seed: 1630146617216852
I0828 10:30:17.221260 139874013124608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:17.221465 139874013124608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:17.221576 139874013124608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:17.221660 139874013124608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:17.221772 139874013124608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:17.221946 139874013124608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:17.222061 139874013124608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:17.222227 139874013124608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:17.222339 139874013124608 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:17.252010 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:17.270971 139874013124608 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:30:17.271198 139874013124608 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.05
I0828 10:30:23.679703 139874013124608 replay_runner.py:36] Average training steps per second: 156.05
Steps executed: 207 Episode length: 10 Return: 10.0
I0828 10:30:24.807132 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1

Steps executed: 216 Episode length: 26 Return: 26.0
INFO:tensorflow:Average training steps per second: 216.67
I0828 10:30:29.605076 139874013124608 replay_runner.py:36] Average training steps per second: 216.67
I0828 10:30:29.754157 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 27.00
INFO:tensorflow:Starting iteration 2

Steps executed: 264 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 200.02
I0828 10:30:34.940805 139874013124608 replay_runner.py:36] Average training steps per second: 200.02
I0828 10:30:35.111271 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 3

Steps executed: 255 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 204.68
I0828 10:30:40.166819 139874013124608 replay_runner.py:36] Average training steps per second: 204.68
I0828 10:30:40.339363 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 4

Steps executed: 215 Episode length: 108 Return: 108.0
INFO:tensorflow:Average training steps per second: 205.98
I0828 10:30:45.389580 139874013124608 replay_runner.py:36] Average training steps per second: 205.98
I0828 10:30:45.528094 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.50
INFO:tensorflow:Starting iteration 5

Steps executed: 224 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 196.79
I0828 10:30:50.798517 139874013124608 replay_runner.py:36] Average training steps per second: 196.79
I0828 10:30:50.942290 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 112.00
INFO:tensorflow:Starting iteration 6

Steps executed: 202 Episode length: 98 Return: 98.0.0
INFO:tensorflow:Average training steps per second: 213.24
I0828 10:30:55.817029 139874013124608 replay_runner.py:36] Average training steps per second: 213.24
I0828 10:30:55.944490 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 101.00
INFO:tensorflow:Starting iteration 7

Steps executed: 293 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 215.43
I0828 10:31:00.794461 139874013124608 replay_runner.py:36] Average training steps per second: 215.43
I0828 10:31:00.962081 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 97.67
INFO:tensorflow:Starting iteration 8
I0828 10:31:01.137443 139874013124608 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 200.88
I0828 10:31:06.115856 139874013124608 replay_runner.py:36] Average training steps per second: 200.88

Steps executed: 289 Episode length: 99 Return: 99.0.0
INFO:tensorflow:Starting iteration 9

Steps executed: 260 Episode length: 84 Return: 84.0.0
INFO:tensorflow:Average training steps per second: 213.37
I0828 10:31:11.250621 139874013124608 replay_runner.py:36] Average training steps per second: 213.37
I0828 10:31:11.423896 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 86.67
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.36
I0828 10:31:16.835600 139874013124608 replay_runner.py:36] Average training steps per second: 195.36
I0828 10:31:16.973051 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 204 Episode length: 70 Return: 70.0.0
INFO:tensorflow:Average training steps per second: 203.62
I0828 10:31:22.080852 139874013124608 replay_runner.py:36] Average training steps per second: 203.62
I0828 10:31:22.219351 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.00
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.10
I0828 10:31:27.513559 139874013124608 replay_runner.py:36] Average training steps per second: 196.10
I0828 10:31:27.645289 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0828 10:31:27.834088 139874013124608 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 201.85
I0828 10:31:32.788837 139874013124608 replay_runner.py:36] Average training steps per second: 201.85
I0828 10:31:32.932187 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0828 10:31:33.116977 139874013124608 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.41
I0828 10:31:38.132329 139874013124608 replay_runner.py:36] Average training steps per second: 199.41
I0828 10:31:38.264265 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0828 10:31:38.443134 139874013124608 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.11
I0828 10:31:43.621974 139874013124608 replay_runner.py:36] Average training steps per second: 193.11
I0828 10:31:43.766862 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 371 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.51
I0828 10:31:48.870885 139874013124608 replay_runner.py:36] Average training steps per second: 203.51
I0828 10:31:49.116417 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.91
I0828 10:31:54.389419 139874013124608 replay_runner.py:36] Average training steps per second: 196.91
I0828 10:31:54.520304 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0828 10:31:54.697355 139874013124608 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 205.12
I0828 10:31:59.573122 139874013124608 replay_runner.py:36] Average training steps per second: 205.12
I0828 10:31:59.707223 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 220 Episode length: 78 Return: 78.0.0
INFO:tensorflow:Average training steps per second: 198.11
I0828 10:32:04.941820 139874013124608 replay_runner.py:36] Average training steps per second: 198.11
I0828 10:32:05.083900 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 73.33
INFO:tensorflow:Starting iteration 20
I0828 10:32:05.276875 139874013124608 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.74

Steps executed: 339 Episode length: 167 Return: 167.0
I0828 10:32:10.601249 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.49
I0828 10:32:15.713181 139874013124608 replay_runner.py:36] Average training steps per second: 203.49
I0828 10:32:15.847391 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0828 10:32:16.043337 139874013124608 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.38
I0828 10:32:21.215042 139874013124608 replay_runner.py:36] Average training steps per second: 193.38
I0828 10:32:21.345132 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0828 10:32:21.534025 139874013124608 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 204.19
I0828 10:32:26.431653 139874013124608 replay_runner.py:36] Average training steps per second: 204.19

Steps executed: 276 Episode length: 139 Return: 139.0
INFO:tensorflow:Starting iteration 24

Steps executed: 289 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 197.41
I0828 10:32:31.879447 139874013124608 replay_runner.py:36] Average training steps per second: 197.41
I0828 10:32:32.063994 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.32
I0828 10:32:37.073238 139874013124608 replay_runner.py:36] Average training steps per second: 207.32
I0828 10:32:37.211053 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0828 10:32:37.410182 139874013124608 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.68
I0828 10:32:42.418515 139874013124608 replay_runner.py:36] Average training steps per second: 199.68
I0828 10:32:42.537116 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 227 Episode length: 54 Return: 54.0.0
INFO:tensorflow:Average training steps per second: 202.87
I0828 10:32:47.647811 139874013124608 replay_runner.py:36] Average training steps per second: 202.87
I0828 10:32:47.791816 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 56.75
INFO:tensorflow:Starting iteration 28

Steps executed: 221 Episode length: 76 Return: 76.0.0
INFO:tensorflow:Average training steps per second: 198.17
I0828 10:32:53.019527 139874013124608 replay_runner.py:36] Average training steps per second: 198.17
I0828 10:32:53.164072 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 73.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 205.27
I0828 10:32:58.229376 139874013124608 replay_runner.py:36] Average training steps per second: 205.27
I0828 10:32:58.414591 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50