I0903 00:00:22.518385 139803223304192 run_experiment.py:549] Creating TrainRunner ...
I0903 00:00:22.525682 139803223304192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:00:22.525813 139803223304192 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:00:22.525880 139803223304192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:00:22.525934 139803223304192 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:00:22.525993 139803223304192 dqn_agent.py:275] 	 update_period: 4
I0903 00:00:22.526065 139803223304192 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:00:22.526142 139803223304192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:00:22.526203 139803223304192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:00:22.526277 139803223304192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:00:22.526343 139803223304192 dqn_agent.py:280] 	 optimizer: adam
I0903 00:00:22.526419 139803223304192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:00:22.526499 139803223304192 dqn_agent.py:283] 	 seed: 1630627222525649
I0903 00:00:22.528099 139803223304192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:00:22.528209 139803223304192 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:00:22.528283 139803223304192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:00:22.528388 139803223304192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:00:22.528446 139803223304192 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:00:22.528501 139803223304192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:00:22.528570 139803223304192 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:00:22.528639 139803223304192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:00:22.528713 139803223304192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:00:22.551047 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:22.772012 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:22.780443 139803223304192 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:00:22.786168 139803223304192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:00:22.786289 139803223304192 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:00:22.786360 139803223304192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:00:22.786420 139803223304192 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:00:22.786478 139803223304192 dqn_agent.py:275] 	 update_period: 4
I0903 00:00:22.786553 139803223304192 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:00:22.786641 139803223304192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:00:22.786716 139803223304192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:00:22.786778 139803223304192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:00:22.786830 139803223304192 dqn_agent.py:280] 	 optimizer: adam
I0903 00:00:22.786890 139803223304192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:00:22.786957 139803223304192 dqn_agent.py:283] 	 seed: 1630627222786141
I0903 00:00:22.788291 139803223304192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:00:22.788406 139803223304192 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:00:22.788479 139803223304192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:00:22.788551 139803223304192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:00:22.788622 139803223304192 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:00:22.788676 139803223304192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:00:22.788744 139803223304192 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:00:22.788810 139803223304192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:00:22.788875 139803223304192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:00:22.810603 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:22.824014 139803223304192 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:00:22.824140 139803223304192 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 248.51
I0903 00:00:26.848304 139803223304192 replay_runner.py:36] Average training steps per second: 248.51
I0903 00:00:27.616223 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.51
Steps executed: 257 Episode length: 114 Return: -336.6754053567497
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 121 Return: -472.96519744962757
INFO:tensorflow:Average training steps per second: 319.55
I0903 00:00:33.882384 139803223304192 replay_runner.py:36] Average training steps per second: 319.55
I0903 00:00:33.995462 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.35
INFO:tensorflow:Starting iteration 2
I0903 00:00:37.112425 139803223304192 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 337.65

Steps executed: 252 Episode length: 252 Return: -293.27919953515743
I0903 00:00:40.274487 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.28
INFO:tensorflow:Starting iteration 3

Steps executed: 550 Episode length: 550 Return: -196.26488573778948
INFO:tensorflow:Average training steps per second: 309.53
I0903 00:00:46.766842 139803223304192 replay_runner.py:36] Average training steps per second: 309.53
I0903 00:00:47.396495 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.26
INFO:tensorflow:Starting iteration 4
I0903 00:00:50.640149 139803223304192 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 314.11

Steps executed: 1000 Episode length: 1000 Return: -117.36007065727213
I0903 00:00:55.264909 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.36
INFO:tensorflow:Starting iteration 5
I0903 00:00:58.615342 139803223304192 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 328.22

Steps executed: 1000 Episode length: 1000 Return: -118.04246153417512
I0903 00:01:02.939091 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.04
INFO:tensorflow:Starting iteration 6
I0903 00:01:06.336575 139803223304192 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 327.94

Steps executed: 900 Episode length: 900 Return: -233.8536825412324412
I0903 00:01:11.360101 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.85
INFO:tensorflow:Starting iteration 7
I0903 00:01:14.770264 139803223304192 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 323.07

Steps executed: 709 Episode length: 709 Return: -191.8142862764524412
I0903 00:01:18.666033 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.81
INFO:tensorflow:Starting iteration 8

Steps executed: 884 Episode length: 884 Return: -277.5942050104236512
INFO:tensorflow:Average training steps per second: 330.71
I0903 00:01:25.003129 139803223304192 replay_runner.py:36] Average training steps per second: 330.71
I0903 00:01:26.185039 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.59
INFO:tensorflow:Starting iteration 9
I0903 00:01:29.577347 139803223304192 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 334.30

Steps executed: 440 Episode length: 440 Return: -96.20071584515358512
I0903 00:01:32.995366 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.20
INFO:tensorflow:Starting iteration 10

Steps executed: 1000 Episode length: 1000 Return: -123.04714107695266
INFO:tensorflow:Average training steps per second: 326.36
I0903 00:01:39.403890 139803223304192 replay_runner.py:36] Average training steps per second: 326.36
I0903 00:01:40.407489 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.05
INFO:tensorflow:Starting iteration 11

Steps executed: 623 Episode length: 623 Return: -160.3257068248276266
INFO:tensorflow:Average training steps per second: 320.12
I0903 00:01:46.838241 139803223304192 replay_runner.py:36] Average training steps per second: 320.12
I0903 00:01:47.597337 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.33
INFO:tensorflow:Starting iteration 12
I0903 00:01:50.911780 139803223304192 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 330.28

Steps executed: 1000 Episode length: 1000 Return: -78.015675991516776
I0903 00:01:56.778628 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.02
INFO:tensorflow:Starting iteration 13
I0903 00:02:00.185280 139803223304192 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 351.14

Steps executed: 1000 Episode length: 1000 Return: -117.12396640131244
I0903 00:02:05.280432 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.12
INFO:tensorflow:Starting iteration 14
I0903 00:02:08.697084 139803223304192 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 355.60

Steps executed: 774 Episode length: 774 Return: -317.4582938834624244
I0903 00:02:12.844879 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.46
INFO:tensorflow:Starting iteration 15
I0903 00:02:16.225805 139803223304192 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 335.01

Steps executed: 1000 Episode length: 1000 Return: -93.007085066873864
I0903 00:02:21.069706 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.01
INFO:tensorflow:Starting iteration 16

Steps executed: 412 Episode length: 412 Return: -462.8944315034532364
INFO:tensorflow:Average training steps per second: 332.58
I0903 00:02:27.463799 139803223304192 replay_runner.py:36] Average training steps per second: 332.58
I0903 00:02:27.954820 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.89
INFO:tensorflow:Starting iteration 17

Steps executed: 249 Episode length: 249 Return: -5.040614165638033364
INFO:tensorflow:Average training steps per second: 341.84
I0903 00:02:34.236289 139803223304192 replay_runner.py:36] Average training steps per second: 341.84
I0903 00:02:34.445055 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.04
INFO:tensorflow:Starting iteration 18

Steps executed: 377 Episode length: 377 Return: -295.6290917502374364
INFO:tensorflow:Average training steps per second: 330.25
I0903 00:02:40.796314 139803223304192 replay_runner.py:36] Average training steps per second: 330.25
I0903 00:02:41.236201 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.63
INFO:tensorflow:Starting iteration 19

Steps executed: 298 Episode length: 298 Return: -180.7871637764066364
INFO:tensorflow:Average training steps per second: 327.96
I0903 00:02:47.637551 139803223304192 replay_runner.py:36] Average training steps per second: 327.96
I0903 00:02:47.909238 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.79
INFO:tensorflow:Starting iteration 20

Steps executed: 183 Episode length: 183 Return: -413.1124955341726364
INFO:tensorflow:Average training steps per second: 336.04
I0903 00:02:54.257113 139803223304192 replay_runner.py:36] Average training steps per second: 336.04

Steps executed: 354 Episode length: 171 Return: -195.0803016090186564
INFO:tensorflow:Starting iteration 21

Steps executed: 202 Episode length: 95 Return: -211.18833119558383564
INFO:tensorflow:Average training steps per second: 332.49
I0903 00:03:00.884391 139803223304192 replay_runner.py:36] Average training steps per second: 332.49
I0903 00:03:01.005217 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.81
INFO:tensorflow:Starting iteration 22

Steps executed: 307 Episode length: 173 Return: -38.64736962410477564
INFO:tensorflow:Average training steps per second: 326.07
I0903 00:03:07.427619 139803223304192 replay_runner.py:36] Average training steps per second: 326.07
I0903 00:03:07.594203 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.56
INFO:tensorflow:Starting iteration 23
I0903 00:03:10.960991 139803223304192 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 325.57

Steps executed: 1000 Episode length: 1000 Return: -111.52981656573341
I0903 00:03:15.908735 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.53
INFO:tensorflow:Starting iteration 24

Steps executed: 285 Episode length: 285 Return: -80.35880435170392341
INFO:tensorflow:Average training steps per second: 338.73
I0903 00:03:22.360600 139803223304192 replay_runner.py:36] Average training steps per second: 338.73
I0903 00:03:22.575481 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.36
INFO:tensorflow:Starting iteration 25

Steps executed: 444 Episode length: 260 Return: -89.93771664239485441
INFO:tensorflow:Average training steps per second: 323.36
I0903 00:03:29.060571 139803223304192 replay_runner.py:36] Average training steps per second: 323.36
I0903 00:03:29.334260 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.69
INFO:tensorflow:Starting iteration 26

Steps executed: 409 Episode length: 409 Return: -80.24725803291925441
INFO:tensorflow:Average training steps per second: 333.51
I0903 00:03:35.801488 139803223304192 replay_runner.py:36] Average training steps per second: 333.51
I0903 00:03:36.177635 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.25
INFO:tensorflow:Starting iteration 27

Steps executed: 284 Episode length: 189 Return: -115.3826542191399141
INFO:tensorflow:Average training steps per second: 344.26
I0903 00:03:42.477151 139803223304192 replay_runner.py:36] Average training steps per second: 344.26
I0903 00:03:42.639677 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.21
INFO:tensorflow:Starting iteration 28
I0903 00:03:46.071192 139803223304192 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 347.91

Steps executed: 211 Episode length: 211 Return: -65.66684404694325141
I0903 00:03:49.093023 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.67
INFO:tensorflow:Starting iteration 29

Steps executed: 253 Episode length: 166 Return: -6.647857619789278141
INFO:tensorflow:Average training steps per second: 327.69
I0903 00:03:55.620960 139803223304192 replay_runner.py:36] Average training steps per second: 327.69

Done fixed training!Episode length: 166 Return: -6.647857619789278141