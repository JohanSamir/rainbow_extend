Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0901 13:11:53.037049 140265790818304 run_experiment.py:549] Creating TrainRunner ...
I0901 13:11:53.043805 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:11:53.043940 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:11:53.044007 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:11:53.044077 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:11:53.044140 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 13:11:53.044194 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:11:53.044284 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:11:53.044343 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:11:53.044412 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:11:53.044567 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 13:11:53.044614 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:11:53.044682 140265790818304 dqn_agent.py:283] 	 seed: 1630501913043771
I0901 13:11:53.046737 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:11:53.046863 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:11:53.046947 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:11:53.047017 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:11:53.047079 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:11:53.047148 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:11:53.047211 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:11:53.047300 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:11:53.047380 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:11:53.148256 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:53.414957 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:53.424998 140265790818304 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:11:53.432387 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:11:53.432562 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:11:53.432651 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:11:53.432721 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:11:53.432835 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 13:11:53.432906 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:11:53.433071 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:11:53.433206 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:11:53.433327 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:11:53.433422 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 13:11:53.433522 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:11:53.433612 140265790818304 dqn_agent.py:283] 	 seed: 1630501913432350
I0901 13:11:53.435131 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:11:53.435240 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:11:53.435311 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:11:53.435373 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:11:53.435442 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:11:53.435498 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:11:53.435570 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:11:53.435639 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:11:53.435706 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:11:53.459150 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:53.473994 140265790818304 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:11:53.474218 140265790818304 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 246.57
I0901 13:11:57.530144 140265790818304 replay_runner.py:36] Average training steps per second: 246.57
I0901 13:11:58.354481 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.98
Steps executed: 294 Episode length: 141 Return: -132.1462679934367
INFO:tensorflow:Starting iteration 1

Steps executed: 79 Episode length: 79 Return: -285.400764483227937
INFO:tensorflow:Average training steps per second: 352.51

Steps executed: 205 Episode length: 126 Return: -351.6194310842807
I0901 13:12:04.710231 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.51
INFO:tensorflow:Starting iteration 2

Steps executed: 345 Episode length: 265 Return: 239.43909193523243
INFO:tensorflow:Average training steps per second: 357.39
I0901 13:12:10.887617 140265790818304 replay_runner.py:36] Average training steps per second: 357.39
I0901 13:12:11.103565 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -25.99
INFO:tensorflow:Starting iteration 3

Steps executed: 208 Episode length: 114 Return: -85.01830250862938
INFO:tensorflow:Average training steps per second: 343.77
I0901 13:12:17.216737 140265790818304 replay_runner.py:36] Average training steps per second: 343.77
I0901 13:12:17.318751 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.42
INFO:tensorflow:Starting iteration 4

Steps executed: 219 Episode length: 139 Return: -315.4741737429269
INFO:tensorflow:Average training steps per second: 346.51
I0901 13:12:23.572440 140265790818304 replay_runner.py:36] Average training steps per second: 346.51
I0901 13:12:23.670512 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.62
INFO:tensorflow:Starting iteration 5

Steps executed: 218 Episode length: 138 Return: -380.38745000752664
INFO:tensorflow:Average training steps per second: 335.15
I0901 13:12:30.062662 140265790818304 replay_runner.py:36] Average training steps per second: 335.15
I0901 13:12:30.162065 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.30
INFO:tensorflow:Starting iteration 6

Steps executed: 233 Episode length: 125 Return: -245.84223691263566
INFO:tensorflow:Average training steps per second: 330.29
I0901 13:12:36.475012 140265790818304 replay_runner.py:36] Average training steps per second: 330.29
I0901 13:12:36.583631 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.42
INFO:tensorflow:Starting iteration 7

Steps executed: 267 Episode length: 107 Return: -149.53274855177165
INFO:tensorflow:Average training steps per second: 321.05
I0901 13:12:42.965904 140265790818304 replay_runner.py:36] Average training steps per second: 321.05
I0901 13:12:43.094018 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.38
INFO:tensorflow:Starting iteration 8

Steps executed: 269 Episode length: 154 Return: -73.126952099626983
INFO:tensorflow:Average training steps per second: 320.56
I0901 13:12:49.522347 140265790818304 replay_runner.py:36] Average training steps per second: 320.56
I0901 13:12:49.676168 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.53
INFO:tensorflow:Starting iteration 9

Steps executed: 227 Episode length: 72 Return: -154.528597708619543
INFO:tensorflow:Average training steps per second: 324.51
I0901 13:12:56.129451 140265790818304 replay_runner.py:36] Average training steps per second: 324.51
I0901 13:12:56.249591 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.34
INFO:tensorflow:Starting iteration 10

Steps executed: 266 Episode length: 70 Return: -131.731712068406753
INFO:tensorflow:Average training steps per second: 321.97
I0901 13:13:02.700807 140265790818304 replay_runner.py:36] Average training steps per second: 321.97
I0901 13:13:02.849769 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.44
INFO:tensorflow:Starting iteration 11

Steps executed: 277 Episode length: 94 Return: -122.115607992081123
INFO:tensorflow:Average training steps per second: 319.97
I0901 13:13:09.312246 140265790818304 replay_runner.py:36] Average training steps per second: 319.97
I0901 13:13:09.470281 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.90
INFO:tensorflow:Starting iteration 12

Steps executed: 229 Episode length: 65 Return: -135.441187406660923
INFO:tensorflow:Average training steps per second: 320.54
I0901 13:13:15.980937 140265790818304 replay_runner.py:36] Average training steps per second: 320.54
I0901 13:13:16.105670 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.14
INFO:tensorflow:Starting iteration 13

Steps executed: 219 Episode length: 62 Return: -165.842787768231523
INFO:tensorflow:Average training steps per second: 326.97
I0901 13:13:22.552381 140265790818304 replay_runner.py:36] Average training steps per second: 326.97
I0901 13:13:22.660809 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.06
INFO:tensorflow:Starting iteration 14
I0901 13:13:26.072997 140265790818304 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 316.04

Steps executed: 254 Episode length: 133 Return: -265.87241550094967
I0901 13:13:29.394204 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.44
INFO:tensorflow:Starting iteration 15

Steps executed: 249 Episode length: 72 Return: -446.021342306941067
INFO:tensorflow:Average training steps per second: 317.58
I0901 13:13:35.861367 140265790818304 replay_runner.py:36] Average training steps per second: 317.58
I0901 13:13:35.986853 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.45
INFO:tensorflow:Starting iteration 16

Steps executed: 203 Episode length: 107 Return: -454.09288418407727
INFO:tensorflow:Average training steps per second: 319.84
I0901 13:13:42.430678 140265790818304 replay_runner.py:36] Average training steps per second: 319.84
I0901 13:13:42.546921 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -640.06
INFO:tensorflow:Starting iteration 17
I0901 13:13:45.864606 140265790818304 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 319.26
I0901 13:13:48.997248 140265790818304 replay_runner.py:36] Average training steps per second: 319.26

Steps executed: 227 Episode length: 90 Return: -291.218083903360864
INFO:tensorflow:Starting iteration 18

Steps executed: 300 Episode length: 118 Return: -408.21297976685464
INFO:tensorflow:Average training steps per second: 305.69
I0901 13:13:55.689838 140265790818304 replay_runner.py:36] Average training steps per second: 305.69
I0901 13:13:55.853929 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.98
INFO:tensorflow:Starting iteration 19

Steps executed: 293 Episode length: 102 Return: -447.11222419769774
INFO:tensorflow:Average training steps per second: 321.65
I0901 13:14:02.292271 140265790818304 replay_runner.py:36] Average training steps per second: 321.65
I0901 13:14:02.532753 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.37
INFO:tensorflow:Starting iteration 20
I0901 13:14:05.940681 140265790818304 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 325.71

Steps executed: 282 Episode length: 93 Return: -437.500036531653174
I0901 13:14:09.178668 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.28
INFO:tensorflow:Starting iteration 21

Steps executed: 225 Episode length: 91 Return: -855.423034843690764
INFO:tensorflow:Average training steps per second: 325.26
I0901 13:14:15.672209 140265790818304 replay_runner.py:36] Average training steps per second: 325.26
I0901 13:14:15.808074 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.16
INFO:tensorflow:Starting iteration 22

Steps executed: 230 Episode length: 230 Return: -768.23993734631264
INFO:tensorflow:Average training steps per second: 333.72
I0901 13:14:22.236931 140265790818304 replay_runner.py:36] Average training steps per second: 333.72
I0901 13:14:22.415844 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -768.24
INFO:tensorflow:Starting iteration 23

Steps executed: 347 Episode length: 217 Return: -918.99518720527074
INFO:tensorflow:Average training steps per second: 331.36
I0901 13:14:28.918954 140265790818304 replay_runner.py:36] Average training steps per second: 331.36
I0901 13:14:29.158303 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -678.90
INFO:tensorflow:Starting iteration 24

Steps executed: 232 Episode length: 91 Return: -315.382016917776354
INFO:tensorflow:Average training steps per second: 339.74
I0901 13:14:35.595758 140265790818304 replay_runner.py:36] Average training steps per second: 339.74
I0901 13:14:35.730129 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.56
INFO:tensorflow:Starting iteration 25

Steps executed: 214 Episode length: 116 Return: -622.06604444151664
INFO:tensorflow:Average training steps per second: 324.71
I0901 13:14:42.269927 140265790818304 replay_runner.py:36] Average training steps per second: 324.71
I0901 13:14:42.420484 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -743.63
INFO:tensorflow:Starting iteration 26

Steps executed: 212 Episode length: 53 Return: -352.185308418397774
INFO:tensorflow:Average training steps per second: 334.53
I0901 13:14:48.857480 140265790818304 replay_runner.py:36] Average training steps per second: 334.53
I0901 13:14:48.989825 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.61
INFO:tensorflow:Starting iteration 27

Steps executed: 222 Episode length: 68 Return: -479.319931815435044
INFO:tensorflow:Average training steps per second: 332.16
I0901 13:14:55.512394 140265790818304 replay_runner.py:36] Average training steps per second: 332.16
I0901 13:14:55.641411 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -569.93
INFO:tensorflow:Starting iteration 28

Steps executed: 280 Episode length: 110 Return: -336.13278639712384
INFO:tensorflow:Average training steps per second: 351.95
I0901 13:15:01.925568 140265790818304 replay_runner.py:36] Average training steps per second: 351.95
I0901 13:15:02.098900 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.80
INFO:tensorflow:Starting iteration 29

Steps executed: 234 Episode length: 124 Return: -502.97602083818697
INFO:tensorflow:Average training steps per second: 349.87
I0901 13:15:08.438746 140265790818304 replay_runner.py:36] Average training steps per second: 349.87

Done fixed training!Episode length: 124 Return: -502.97602083818697