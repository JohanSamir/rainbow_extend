Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0905 19:02:32.977303 139903596107776 run_experiment.py:549] Creating TrainRunner ...
I0905 19:02:32.986933 139903596107776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:32.987123 139903596107776 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:32.987220 139903596107776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:32.987297 139903596107776 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:32.987358 139903596107776 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:32.987562 139903596107776 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:32.987632 139903596107776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:32.987693 139903596107776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:32.987753 139903596107776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:32.987824 139903596107776 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:32.987882 139903596107776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:32.987936 139903596107776 dqn_agent.py:283] 	 seed: 1630868552986881
I0905 19:02:32.990638 139903596107776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:32.990823 139903596107776 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:32.990957 139903596107776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:32.991096 139903596107776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:32.991209 139903596107776 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:32.991357 139903596107776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:32.991520 139903596107776 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:32.991677 139903596107776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:32.991929 139903596107776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:33.037365 139903596107776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:33.371671 139903596107776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:33.385758 139903596107776 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:02:33.392344 139903596107776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:33.392581 139903596107776 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:33.392708 139903596107776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:33.392793 139903596107776 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:33.392900 139903596107776 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:33.392976 139903596107776 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:33.393081 139903596107776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:33.393171 139903596107776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:33.393404 139903596107776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:33.393520 139903596107776 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:33.393596 139903596107776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:33.393716 139903596107776 dqn_agent.py:283] 	 seed: 1630868553392288
I0905 19:02:33.396425 139903596107776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:33.396553 139903596107776 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:33.396676 139903596107776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:33.396772 139903596107776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:33.396838 139903596107776 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:33.396940 139903596107776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:33.397007 139903596107776 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:33.397072 139903596107776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:33.397189 139903596107776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:33.432899 139903596107776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:33.459045 139903596107776 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:02:33.459346 139903596107776 replay_runner.py:41] Starting iteration 0
Steps executed: 276 Episode length: 187 Return: -546.1187827814425
INFO:tensorflow:Average training steps per second: 167.99
I0905 19:02:39.412296 139903596107776 replay_runner.py:36] Average training steps per second: 167.99
I0905 19:02:40.509766 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -576.06
INFO:tensorflow:Starting iteration 1

Steps executed: 140 Episode length: 140 Return: -236.5763973439192
INFO:tensorflow:Average training steps per second: 268.47

Steps executed: 852 Episode length: 712 Return: -352.15176954066413
I0905 19:02:50.108402 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.36
INFO:tensorflow:Starting iteration 2
I0905 19:02:53.922750 139903596107776 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 272.71

Steps executed: 1000 Episode length: 1000 Return: -523.0705192516616
I0905 19:03:02.048636 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -523.07
INFO:tensorflow:Starting iteration 3

Steps executed: 97 Episode length: 97 Return: -708.40836563037336616
INFO:tensorflow:Average training steps per second: 277.04

Steps executed: 1097 Episode length: 1000 Return: -150.81866020268154
I0905 19:03:11.677332 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.61
INFO:tensorflow:Starting iteration 4

Steps executed: 346 Episode length: 346 Return: -269.7327939260998154
INFO:tensorflow:Average training steps per second: 273.73
I0905 19:03:19.166097 139903596107776 replay_runner.py:36] Average training steps per second: 273.73
I0905 19:03:19.629714 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.73
INFO:tensorflow:Starting iteration 5

Steps executed: 859 Episode length: 685 Return: -496.1237476942575154
INFO:tensorflow:Average training steps per second: 261.39
I0905 19:03:27.339519 139903596107776 replay_runner.py:36] Average training steps per second: 261.39
I0905 19:03:28.544514 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.45
INFO:tensorflow:Starting iteration 6
I0905 19:03:32.353018 139903596107776 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 260.14

Steps executed: 973 Episode length: 973 Return: -402.0761553906994154
I0905 19:03:38.478182 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.08
INFO:tensorflow:Starting iteration 7

Steps executed: 444 Episode length: 444 Return: -391.1012588183805354
INFO:tensorflow:Average training steps per second: 262.59
I0905 19:03:46.162042 139903596107776 replay_runner.py:36] Average training steps per second: 262.59
I0905 19:03:46.813114 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.10
INFO:tensorflow:Starting iteration 8

Steps executed: 320 Episode length: 320 Return: -352.0190118111406354
INFO:tensorflow:Average training steps per second: 268.84
I0905 19:03:54.389515 139903596107776 replay_runner.py:36] Average training steps per second: 268.84
I0905 19:03:54.882752 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.02
INFO:tensorflow:Starting iteration 9
I0905 19:03:58.711236 139903596107776 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 265.81

Steps executed: 657 Episode length: 657 Return: -318.6926167612054354
I0905 19:04:03.754300 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.69
INFO:tensorflow:Starting iteration 10
I0905 19:04:07.487858 139903596107776 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 273.28
I0905 19:04:11.147726 139903596107776 replay_runner.py:36] Average training steps per second: 273.28

Steps executed: 1000 Episode length: 1000 Return: -84.459724118395294
INFO:tensorflow:Starting iteration 11
I0905 19:04:16.727602 139903596107776 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 257.43
I0905 19:04:20.612446 139903596107776 replay_runner.py:36] Average training steps per second: 257.43

Steps executed: 252 Episode length: 252 Return: -183.9522746219976294
INFO:tensorflow:Starting iteration 12
I0905 19:04:24.749016 139903596107776 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 257.99
I0905 19:04:28.625561 139903596107776 replay_runner.py:36] Average training steps per second: 257.99

Steps executed: 1000 Episode length: 1000 Return: -98.110297190066964
INFO:tensorflow:Starting iteration 13
I0905 19:04:35.101182 139903596107776 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 248.78

Steps executed: 1000 Episode length: 1000 Return: -111.14264277740502
I0905 19:04:40.819961 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.14
INFO:tensorflow:Starting iteration 14
I0905 19:04:44.662746 139903596107776 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 252.85

Steps executed: 1000 Episode length: 1000 Return: -78.026844137282252
I0905 19:04:50.725410 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.03
INFO:tensorflow:Starting iteration 15

Steps executed: 356 Episode length: 202 Return: -47.18542205088867252
INFO:tensorflow:Average training steps per second: 251.21
I0905 19:04:58.506407 139903596107776 replay_runner.py:36] Average training steps per second: 251.21
I0905 19:04:58.831198 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.10
INFO:tensorflow:Starting iteration 16
I0905 19:05:02.627173 139903596107776 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 248.62

Steps executed: 1000 Episode length: 1000 Return: 33.4727097317387252
I0905 19:05:09.123651 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.47
INFO:tensorflow:Starting iteration 17
I0905 19:05:12.984106 139903596107776 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 248.33

Steps executed: 639 Episode length: 639 Return: 172.60680414125817252
I0905 19:05:18.228367 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.61
INFO:tensorflow:Starting iteration 18
I0905 19:05:22.022301 139903596107776 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 264.21

Steps executed: 1000 Episode length: 1000 Return: 15.4967574669252242
I0905 19:05:29.927590 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.50
INFO:tensorflow:Starting iteration 19

Steps executed: 382 Episode length: 382 Return: -112.2313634399339742
INFO:tensorflow:Average training steps per second: 240.03
I0905 19:05:37.743182 139903596107776 replay_runner.py:36] Average training steps per second: 240.03
I0905 19:05:38.281670 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.23
INFO:tensorflow:Starting iteration 20

Steps executed: 321 Episode length: 321 Return: -127.2167460300995142
INFO:tensorflow:Average training steps per second: 233.20
I0905 19:05:45.978547 139903596107776 replay_runner.py:36] Average training steps per second: 233.20
I0905 19:05:46.426238 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.22
INFO:tensorflow:Starting iteration 21
I0905 19:05:49.841521 139903596107776 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 231.27

Steps executed: 1000 Episode length: 1000 Return: -122.82151239704662
I0905 19:05:56.858946 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.82
INFO:tensorflow:Starting iteration 22
I0905 19:06:00.608979 139903596107776 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 247.77

Steps executed: 673 Episode length: 673 Return: -664.4459471461722662
I0905 19:06:05.940299 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -664.45
INFO:tensorflow:Starting iteration 23

Steps executed: 227 Episode length: 88 Return: -4.3902240791973672662
INFO:tensorflow:Average training steps per second: 249.32
I0905 19:06:13.598228 139903596107776 replay_runner.py:36] Average training steps per second: 249.32
I0905 19:06:13.815465 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.70
INFO:tensorflow:Starting iteration 24
I0905 19:06:17.627710 139903596107776 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 268.63

Steps executed: 1000 Episode length: 1000 Return: -74.372379362198522
I0905 19:06:24.333130 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.37
INFO:tensorflow:Starting iteration 25

Steps executed: 378 Episode length: 220 Return: -20.01182528870963922
INFO:tensorflow:Average training steps per second: 254.59
I0905 19:06:32.074751 139903596107776 replay_runner.py:36] Average training steps per second: 254.59
I0905 19:06:32.489826 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.22
INFO:tensorflow:Starting iteration 26
I0905 19:06:36.272258 139903596107776 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 289.91

Steps executed: 250 Episode length: 73 Return: -461.68397473593745922
I0905 19:06:39.959611 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -385.88
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 243 Return: -251.9162842576341922
INFO:tensorflow:Average training steps per second: 323.20
I0905 19:06:46.854050 139903596107776 replay_runner.py:36] Average training steps per second: 323.20
I0905 19:06:47.083148 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.92
INFO:tensorflow:Starting iteration 28
I0905 19:06:50.713998 139903596107776 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 329.81

Steps executed: 526 Episode length: 526 Return: 216.11461562931012922
I0905 19:06:54.390908 139903596107776 run_experiment.py:428] Average undiscounted return per evaluation episode: 216.11
INFO:tensorflow:Starting iteration 29

Steps executed: 277 Episode length: 143 Return: -435.3660109177808922
INFO:tensorflow:Average training steps per second: 335.36
I0905 19:07:00.692798 139903596107776 replay_runner.py:36] Average training steps per second: 335.36

Done fixed training!Episode length: 143 Return: -435.3660109177808922