I0902 18:17:41.548156 140613433649152 run_experiment.py:549] Creating TrainRunner ...
I0902 18:17:41.556462 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:41.556613 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:41.556819 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:41.556967 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:41.557047 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:41.557126 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:41.557239 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:41.557446 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:41.557567 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:41.557656 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:41.557734 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:41.557805 140613433649152 dqn_agent.py:283] 	 seed: 1630606661556424
I0902 18:17:41.559478 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:41.559587 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:41.559659 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:41.559721 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:41.559777 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:41.559834 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:41.559920 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:41.559996 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:41.560053 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:41.585147 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:41.829626 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:41.839034 140613433649152 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:17:41.844795 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:41.844915 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:41.845015 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:41.845074 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:41.845126 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:41.845199 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:41.845267 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:41.845361 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:41.845435 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:41.845517 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:41.845570 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:41.845641 140613433649152 dqn_agent.py:283] 	 seed: 1630606661844768
I0902 18:17:41.847037 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:41.847184 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:41.847334 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:41.847470 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:41.847552 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:41.847625 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:41.847755 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:41.847930 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:41.848046 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:41.866612 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:41.879444 140613433649152 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:17:41.879582 140613433649152 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 271.69
I0902 18:17:45.560430 140613433649152 replay_runner.py:36] Average training steps per second: 271.69
I0902 18:17:46.400935 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.79
Steps executed: 282 Episode length: 125 Return: -210.49860978897055
INFO:tensorflow:Starting iteration 1
I0902 18:17:49.714873 140613433649152 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 365.61
I0902 18:17:52.450247 140613433649152 replay_runner.py:36] Average training steps per second: 365.61

Steps executed: 348 Episode length: 150 Return: -352.25164162234853
INFO:tensorflow:Starting iteration 2
I0902 18:17:55.859123 140613433649152 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 329.21
I0902 18:17:58.896988 140613433649152 replay_runner.py:36] Average training steps per second: 329.21

Steps executed: 279 Episode length: 160 Return: -277.30374737553614
INFO:tensorflow:Starting iteration 3

Steps executed: 228 Episode length: 228 Return: -569.37014787141384
INFO:tensorflow:Average training steps per second: 330.66
I0902 18:18:05.353428 140613433649152 replay_runner.py:36] Average training steps per second: 330.66
I0902 18:18:05.534632 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -569.37
INFO:tensorflow:Starting iteration 4
I0902 18:18:08.902292 140613433649152 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 351.28

Steps executed: 1000 Episode length: 1000 Return: -172.72847343688852
I0902 18:18:14.182223 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.73
INFO:tensorflow:Starting iteration 5
I0902 18:18:17.409475 140613433649152 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 324.01
I0902 18:18:20.496069 140613433649152 replay_runner.py:36] Average training steps per second: 324.01

Steps executed: 1000 Episode length: 1000 Return: -75.996415345554622
INFO:tensorflow:Starting iteration 6
I0902 18:18:26.565685 140613433649152 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 324.79

Steps executed: 1000 Episode length: 1000 Return: -253.96196442071872
I0902 18:18:31.772580 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.96
INFO:tensorflow:Starting iteration 7
I0902 18:18:35.158018 140613433649152 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 346.49

Steps executed: 1000 Episode length: 1000 Return: -281.35555845195324
I0902 18:18:39.831351 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.36
INFO:tensorflow:Starting iteration 8
I0902 18:18:43.305210 140613433649152 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 362.11
I0902 18:18:46.067111 140613433649152 replay_runner.py:36] Average training steps per second: 362.11

Steps executed: 1000 Episode length: 1000 Return: -206.34452446615564
INFO:tensorflow:Starting iteration 9

Steps executed: 1000 Episode length: 1000 Return: -233.35690218939422
INFO:tensorflow:Average training steps per second: 374.44
I0902 18:18:53.632862 140613433649152 replay_runner.py:36] Average training steps per second: 374.44
I0902 18:18:55.356092 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.36
INFO:tensorflow:Starting iteration 10
I0902 18:18:58.902890 140613433649152 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 377.35
I0902 18:19:01.553296 140613433649152 replay_runner.py:36] Average training steps per second: 377.35

Steps executed: 1000 Episode length: 1000 Return: -165.44820656921132
INFO:tensorflow:Starting iteration 11

Steps executed: 1000 Episode length: 1000 Return: -167.39636032071992
INFO:tensorflow:Average training steps per second: 350.33
I0902 18:19:09.870841 140613433649152 replay_runner.py:36] Average training steps per second: 350.33
I0902 18:19:11.290642 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.40
INFO:tensorflow:Starting iteration 12
I0902 18:19:14.671796 140613433649152 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 340.05

Steps executed: 912 Episode length: 912 Return: -236.8011120495462992
I0902 18:19:19.000816 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.80
INFO:tensorflow:Starting iteration 13
I0902 18:19:22.413663 140613433649152 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 344.31

Steps executed: 1000 Episode length: 1000 Return: -91.255984465919212
I0902 18:19:27.368376 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.26
INFO:tensorflow:Starting iteration 14
I0902 18:19:30.759056 140613433649152 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 350.37

Steps executed: 394 Episode length: 394 Return: -70.06049915293974212
I0902 18:19:34.003078 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.06
INFO:tensorflow:Starting iteration 15

Steps executed: 216 Episode length: 63 Return: -131.48435537262338212
INFO:tensorflow:Average training steps per second: 340.81
I0902 18:19:40.301545 140613433649152 replay_runner.py:36] Average training steps per second: 340.81
I0902 18:19:40.432677 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.67
INFO:tensorflow:Starting iteration 16

Steps executed: 357 Episode length: 183 Return: -114.2731315838626912
INFO:tensorflow:Average training steps per second: 341.37
I0902 18:19:46.716922 140613433649152 replay_runner.py:36] Average training steps per second: 341.37
I0902 18:19:46.934839 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.99
INFO:tensorflow:Starting iteration 17

Steps executed: 277 Episode length: 141 Return: -88.87202434292372612
INFO:tensorflow:Average training steps per second: 342.40
I0902 18:19:53.184287 140613433649152 replay_runner.py:36] Average training steps per second: 342.40
I0902 18:19:53.338448 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.54
INFO:tensorflow:Starting iteration 18

Steps executed: 209 Episode length: 150 Return: -17.01964596908516612
INFO:tensorflow:Average training steps per second: 339.90
I0902 18:19:59.720006 140613433649152 replay_runner.py:36] Average training steps per second: 339.90
I0902 18:19:59.836902 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.54
INFO:tensorflow:Starting iteration 19

Steps executed: 230 Episode length: 94 Return: -121.42333435858637612
INFO:tensorflow:Average training steps per second: 352.98
I0902 18:20:06.154018 140613433649152 replay_runner.py:36] Average training steps per second: 352.98
I0902 18:20:06.270587 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.71
INFO:tensorflow:Starting iteration 20

Steps executed: 415 Episode length: 279 Return: -27.11625357852283612
INFO:tensorflow:Average training steps per second: 356.52
I0902 18:20:12.567125 140613433649152 replay_runner.py:36] Average training steps per second: 356.52
I0902 18:20:12.838333 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.47
INFO:tensorflow:Starting iteration 21

Steps executed: 388 Episode length: 269 Return: -35.86819962475808612
INFO:tensorflow:Average training steps per second: 350.25
I0902 18:20:19.200904 140613433649152 replay_runner.py:36] Average training steps per second: 350.25
I0902 18:20:19.502464 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.66
INFO:tensorflow:Starting iteration 22

Steps executed: 309 Episode length: 130 Return: -397.7753596022115612
INFO:tensorflow:Average training steps per second: 354.07
I0902 18:20:25.847438 140613433649152 replay_runner.py:36] Average training steps per second: 354.07
I0902 18:20:26.026464 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.82
INFO:tensorflow:Starting iteration 23

Steps executed: 284 Episode length: 284 Return: -69.11953630161025612
INFO:tensorflow:Average training steps per second: 350.51
I0902 18:20:32.349113 140613433649152 replay_runner.py:36] Average training steps per second: 350.51
I0902 18:20:32.573098 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.12
INFO:tensorflow:Starting iteration 24

Steps executed: 222 Episode length: 81 Return: -286.56147221551635612
INFO:tensorflow:Average training steps per second: 336.94
I0902 18:20:38.941879 140613433649152 replay_runner.py:36] Average training steps per second: 336.94
I0902 18:20:39.055458 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.87
INFO:tensorflow:Starting iteration 25

Steps executed: 236 Episode length: 82 Return: -747.94389076165369612
INFO:tensorflow:Average training steps per second: 337.00
I0902 18:20:45.420600 140613433649152 replay_runner.py:36] Average training steps per second: 337.00
I0902 18:20:45.534044 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.41
INFO:tensorflow:Starting iteration 26

Steps executed: 256 Episode length: 118 Return: -492.6876461573415312
INFO:tensorflow:Average training steps per second: 330.15
I0902 18:20:51.946789 140613433649152 replay_runner.py:36] Average training steps per second: 330.15
I0902 18:20:52.092320 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.52
INFO:tensorflow:Starting iteration 27

Steps executed: 490 Episode length: 368 Return: -268.3666837316471412
INFO:tensorflow:Average training steps per second: 329.21
I0902 18:20:58.512320 140613433649152 replay_runner.py:36] Average training steps per second: 329.21
I0902 18:20:58.978163 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.53
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 61 Return: -113.20980227545715412
INFO:tensorflow:Average training steps per second: 342.39
I0902 18:21:05.196987 140613433649152 replay_runner.py:36] Average training steps per second: 342.39
I0902 18:21:05.297842 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.91
INFO:tensorflow:Starting iteration 29

Steps executed: 233 Episode length: 60 Return: -472.93481863434107412
INFO:tensorflow:Average training steps per second: 335.13
I0902 18:21:11.592071 140613433649152 replay_runner.py:36] Average training steps per second: 335.13

Done fixed training!Episode length: 60 Return: -472.93481863434107412