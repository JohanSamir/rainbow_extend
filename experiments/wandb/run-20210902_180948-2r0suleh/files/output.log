I0902 18:09:55.442067 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 18:09:55.453366 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:55.453613 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:55.453716 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:55.453813 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:55.453904 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:55.453997 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:09:55.454109 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:55.454192 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:55.454267 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:55.454345 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:55.454519 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:55.454656 140016423897088 dqn_agent.py:283] 	 seed: 1630606195453307
I0902 18:09:55.457278 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:55.457486 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:09:55.457606 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:55.457704 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:55.457792 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:55.457882 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:55.457967 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:55.458079 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:55.458414 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:55.503211 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:55.924017 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:55.957987 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:09:55.969181 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:55.969427 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:55.969538 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:55.969622 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:55.969699 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:55.969832 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:09:55.969957 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:55.970275 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:55.970430 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:55.970551 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:55.970681 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:55.970771 140016423897088 dqn_agent.py:283] 	 seed: 1630606195969109
I0902 18:09:55.973375 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:55.973606 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:09:55.973744 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:55.973858 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:55.973989 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:55.974126 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:55.974363 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:55.974809 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:55.974914 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:56.007318 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:56.026649 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:09:56.026970 140016423897088 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 158.78
I0902 18:10:02.325479 140016423897088 replay_runner.py:36] Average training steps per second: 158.78
I0902 18:10:03.741523 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.94
Steps executed: 304 Episode length: 193 Return: -277.29609645374023
INFO:tensorflow:Starting iteration 1

Steps executed: 292 Episode length: 150 Return: -478.95889704594763
INFO:tensorflow:Average training steps per second: 228.94
I0902 18:10:12.430891 140016423897088 replay_runner.py:36] Average training steps per second: 228.94
I0902 18:10:12.703687 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.39
INFO:tensorflow:Starting iteration 2

Steps executed: 238 Episode length: 135 Return: -324.82120955956933
INFO:tensorflow:Average training steps per second: 224.50
I0902 18:10:21.569600 140016423897088 replay_runner.py:36] Average training steps per second: 224.50
I0902 18:10:21.802668 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.20
INFO:tensorflow:Starting iteration 3

Steps executed: 222 Episode length: 81 Return: -363.355961464569113
INFO:tensorflow:Average training steps per second: 228.21
I0902 18:10:30.589728 140016423897088 replay_runner.py:36] Average training steps per second: 228.21
I0902 18:10:30.793774 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.51
INFO:tensorflow:Starting iteration 4
I0902 18:10:35.000131 140016423897088 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 226.08

Steps executed: 376 Episode length: 253 Return: -172.55300119556384
I0902 18:10:39.823676 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.08
INFO:tensorflow:Starting iteration 5

Steps executed: 203 Episode length: 92 Return: -397.977445956921484
INFO:tensorflow:Average training steps per second: 232.34
I0902 18:10:48.372124 140016423897088 replay_runner.py:36] Average training steps per second: 232.34
I0902 18:10:48.553229 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.17
INFO:tensorflow:Starting iteration 6
I0902 18:10:52.981195 140016423897088 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 235.77
I0902 18:10:57.223047 140016423897088 replay_runner.py:36] Average training steps per second: 235.77

Steps executed: 215 Episode length: 89 Return: -342.305466784457057
INFO:tensorflow:Starting iteration 7

Steps executed: 310 Episode length: 116 Return: -247.97692417319347
INFO:tensorflow:Average training steps per second: 248.37
I0902 18:11:05.576590 140016423897088 replay_runner.py:36] Average training steps per second: 248.37
I0902 18:11:05.843038 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.54
INFO:tensorflow:Starting iteration 8

Steps executed: 209 Episode length: 126 Return: -318.79509625075567
INFO:tensorflow:Average training steps per second: 261.09
I0902 18:11:13.848283 140016423897088 replay_runner.py:36] Average training steps per second: 261.09
I0902 18:11:14.008061 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.43
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 71 Return: -268.254191781833247
INFO:tensorflow:Average training steps per second: 263.68
I0902 18:11:21.915782 140016423897088 replay_runner.py:36] Average training steps per second: 263.68
I0902 18:11:22.067802 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.91
INFO:tensorflow:Starting iteration 10

Steps executed: 205 Episode length: 79 Return: -341.378590737456767
INFO:tensorflow:Average training steps per second: 278.70
I0902 18:11:29.700750 140016423897088 replay_runner.py:36] Average training steps per second: 278.70
I0902 18:11:29.853601 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.21
INFO:tensorflow:Starting iteration 11

Steps executed: 209 Episode length: 131 Return: -432.91055960211747
INFO:tensorflow:Average training steps per second: 276.97
I0902 18:11:37.512889 140016423897088 replay_runner.py:36] Average training steps per second: 276.97
I0902 18:11:37.653055 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.33
INFO:tensorflow:Starting iteration 12

Steps executed: 254 Episode length: 138 Return: -331.57921925902457
INFO:tensorflow:Average training steps per second: 275.14
I0902 18:11:45.342102 140016423897088 replay_runner.py:36] Average training steps per second: 275.14
I0902 18:11:45.522774 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.43
INFO:tensorflow:Starting iteration 13

Steps executed: 221 Episode length: 136 Return: -351.68531186205075
INFO:tensorflow:Average training steps per second: 287.08
I0902 18:11:52.957871 140016423897088 replay_runner.py:36] Average training steps per second: 287.08
I0902 18:11:53.092923 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.58
INFO:tensorflow:Starting iteration 14

Steps executed: 236 Episode length: 142 Return: -143.87468351864645
INFO:tensorflow:Average training steps per second: 320.71
I0902 18:11:59.994070 140016423897088 replay_runner.py:36] Average training steps per second: 320.71
I0902 18:12:00.140119 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.16
INFO:tensorflow:Starting iteration 15

Steps executed: 623 Episode length: 438 Return: -158.24638890135736
INFO:tensorflow:Average training steps per second: 334.41
I0902 18:12:06.758985 140016423897088 replay_runner.py:36] Average training steps per second: 334.41
I0902 18:12:07.500270 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.27
INFO:tensorflow:Starting iteration 16

Steps executed: 303 Episode length: 142 Return: -287.71183762139793
INFO:tensorflow:Average training steps per second: 351.23
I0902 18:12:13.914033 140016423897088 replay_runner.py:36] Average training steps per second: 351.23
I0902 18:12:14.080717 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.79
INFO:tensorflow:Starting iteration 17

Steps executed: 222 Episode length: 78 Return: -299.951312203604236
INFO:tensorflow:Average training steps per second: 351.73
I0902 18:12:20.437421 140016423897088 replay_runner.py:36] Average training steps per second: 351.73
I0902 18:12:20.567014 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.97
INFO:tensorflow:Starting iteration 18

Steps executed: 206 Episode length: 113 Return: -96.335468345196136
INFO:tensorflow:Average training steps per second: 343.39
I0902 18:12:26.972911 140016423897088 replay_runner.py:36] Average training steps per second: 343.39
I0902 18:12:27.082074 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.52
INFO:tensorflow:Starting iteration 19
I0902 18:12:30.514107 140016423897088 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 343.16
I0902 18:12:33.428513 140016423897088 replay_runner.py:36] Average training steps per second: 343.16

Steps executed: 233 Episode length: 82 Return: -287.165645692532054
INFO:tensorflow:Starting iteration 20

Steps executed: 240 Episode length: 69 Return: -63.7458599451563544
INFO:tensorflow:Average training steps per second: 349.74
I0902 18:12:39.855876 140016423897088 replay_runner.py:36] Average training steps per second: 349.74
I0902 18:12:39.988051 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.02
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 268 Return: -276.28198583513813
INFO:tensorflow:Average training steps per second: 342.67
I0902 18:12:46.372640 140016423897088 replay_runner.py:36] Average training steps per second: 342.67
I0902 18:12:46.604554 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.28
INFO:tensorflow:Starting iteration 22

Steps executed: 289 Episode length: 289 Return: -537.53881371415743
INFO:tensorflow:Average training steps per second: 343.36
I0902 18:12:52.972407 140016423897088 replay_runner.py:36] Average training steps per second: 343.36
I0902 18:12:53.275759 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.54
INFO:tensorflow:Starting iteration 23
I0902 18:12:56.715568 140016423897088 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 344.41
I0902 18:12:59.619381 140016423897088 replay_runner.py:36] Average training steps per second: 344.41

Steps executed: 307 Episode length: 208 Return: -323.21733718465396
INFO:tensorflow:Starting iteration 24

Steps executed: 107 Episode length: 107 Return: -233.66048925010492
INFO:tensorflow:Average training steps per second: 332.51

Steps executed: 1066 Episode length: 959 Return: -464.1260345152899
I0902 18:13:08.444964 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.89
INFO:tensorflow:Starting iteration 25

Steps executed: 269 Episode length: 155 Return: -244.28913191909666
INFO:tensorflow:Average training steps per second: 331.63
I0902 18:13:14.800023 140016423897088 replay_runner.py:36] Average training steps per second: 331.63
I0902 18:13:14.944677 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.54
INFO:tensorflow:Starting iteration 26
I0902 18:13:18.314234 140016423897088 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 339.11

Steps executed: 722 Episode length: 722 Return: -321.51344122891266
I0902 18:13:22.557861 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.51
INFO:tensorflow:Starting iteration 27

Steps executed: 601 Episode length: 601 Return: -246.30295589776227
INFO:tensorflow:Average training steps per second: 339.67
I0902 18:13:28.922533 140016423897088 replay_runner.py:36] Average training steps per second: 339.67
I0902 18:13:29.782449 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.30
INFO:tensorflow:Starting iteration 28

Steps executed: 202 Episode length: 103 Return: -309.74005233727127
INFO:tensorflow:Average training steps per second: 339.84
I0902 18:13:36.159840 140016423897088 replay_runner.py:36] Average training steps per second: 339.84
I0902 18:13:36.271266 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.69
INFO:tensorflow:Starting iteration 29

Steps executed: 200 Episode length: 200 Return: -327.97103957760544
INFO:tensorflow:Average training steps per second: 361.59
I0902 18:13:42.474054 140016423897088 replay_runner.py:36] Average training steps per second: 361.59

Done fixed training!Episode length: 200 Return: -327.97103957760544