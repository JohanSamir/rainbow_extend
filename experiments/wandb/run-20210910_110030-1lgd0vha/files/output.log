I0910 11:00:36.284705 140630342445056 run_experiment.py:549] Creating TrainRunner ...
I0910 11:00:36.291746 140630342445056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:36.291897 140630342445056 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:36.291973 140630342445056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:36.292035 140630342445056 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:36.292092 140630342445056 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:36.292172 140630342445056 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:36.292272 140630342445056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:36.292355 140630342445056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:36.292445 140630342445056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:36.292518 140630342445056 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:36.292592 140630342445056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:36.292663 140630342445056 dqn_agent.py:283] 	 seed: 1631271636291712
I0910 11:00:36.294370 140630342445056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:36.294489 140630342445056 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:36.294567 140630342445056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:36.294629 140630342445056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:36.294688 140630342445056 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:36.294763 140630342445056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:36.294846 140630342445056 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:36.294927 140630342445056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:36.294981 140630342445056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:36.318343 140630342445056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:36.336586 140630342445056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:36.336735 140630342445056 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:36.336821 140630342445056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:36.336892 140630342445056 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:36.336974 140630342445056 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:36.337056 140630342445056 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:36.337142 140630342445056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:36.337230 140630342445056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:36.337296 140630342445056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:36.337364 140630342445056 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:36.337435 140630342445056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:36.337489 140630342445056 dqn_agent.py:283] 	 seed: 1631271636336551
I0910 11:00:36.338900 140630342445056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:36.339014 140630342445056 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:36.339097 140630342445056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:36.339157 140630342445056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:36.339213 140630342445056 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:36.339265 140630342445056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:36.339334 140630342445056 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:36.339416 140630342445056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:36.339485 140630342445056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:36.359348 140630342445056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:36.374240 140630342445056 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:00:36.374411 140630342445056 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 849737.44
I0910 11:00:36.375718 140630342445056 replay_runner.py:39] Average training steps per second: 849737.44
I0910 11:00:37.225168 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:00:37.327230 140630342445056 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 801051.18
I0910 11:00:37.328740 140630342445056 replay_runner.py:39] Average training steps per second: 801051.18
I0910 11:00:37.550307 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:00:37.602105 140630342445056 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 775287.25
I0910 11:00:37.603621 140630342445056 replay_runner.py:39] Average training steps per second: 775287.25
Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:00:37.820002 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:00:37.872406 140630342445056 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 815536.46
I0910 11:00:37.873868 140630342445056 replay_runner.py:39] Average training steps per second: 815536.46
I0910 11:00:38.094958 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:00:38.148463 140630342445056 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 844774.22
I0910 11:00:38.149872 140630342445056 replay_runner.py:39] Average training steps per second: 844774.22
I0910 11:00:38.367923 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:00:38.427764 140630342445056 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 805822.09
I0910 11:00:38.429383 140630342445056 replay_runner.py:39] Average training steps per second: 805822.09
I0910 11:00:38.616936 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:00:38.670564 140630342445056 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 824352.20
I0910 11:00:38.672000 140630342445056 replay_runner.py:39] Average training steps per second: 824352.20
I0910 11:00:38.863460 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:00:38.916007 140630342445056 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 800592.48
I0910 11:00:38.917484 140630342445056 replay_runner.py:39] Average training steps per second: 800592.48
I0910 11:00:39.103308 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:00:39.155956 140630342445056 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 735197.90
I0910 11:00:39.157565 140630342445056 replay_runner.py:39] Average training steps per second: 735197.90
I0910 11:00:39.373760 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:00:39.430507 140630342445056 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 812062.73
I0910 11:00:39.431974 140630342445056 replay_runner.py:39] Average training steps per second: 812062.73
I0910 11:00:39.610793 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:00:39.663959 140630342445056 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 765104.71
I0910 11:00:39.665492 140630342445056 replay_runner.py:39] Average training steps per second: 765104.71
I0910 11:00:39.872167 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:00:39.925755 140630342445056 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 808618.47
I0910 11:00:39.927349 140630342445056 replay_runner.py:39] Average training steps per second: 808618.47
I0910 11:00:40.118591 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:00:40.171865 140630342445056 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 729824.95
I0910 11:00:40.173469 140630342445056 replay_runner.py:39] Average training steps per second: 729824.95
I0910 11:00:40.384048 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:00:40.438679 140630342445056 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 781644.43
I0910 11:00:40.440191 140630342445056 replay_runner.py:39] Average training steps per second: 781644.43
I0910 11:00:40.633978 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:00:40.687639 140630342445056 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 837353.56
I0910 11:00:40.689062 140630342445056 replay_runner.py:39] Average training steps per second: 837353.56
I0910 11:00:40.887757 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:00:40.940557 140630342445056 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 829405.58
I0910 11:00:40.942006 140630342445056 replay_runner.py:39] Average training steps per second: 829405.58
I0910 11:00:41.119375 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:00:41.171576 140630342445056 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 828586.33
I0910 11:00:41.172996 140630342445056 replay_runner.py:39] Average training steps per second: 828586.33
I0910 11:00:41.356731 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:00:41.409482 140630342445056 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 841216.21
I0910 11:00:41.410915 140630342445056 replay_runner.py:39] Average training steps per second: 841216.21
I0910 11:00:41.582461 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:00:41.635175 140630342445056 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 802123.54
I0910 11:00:41.636645 140630342445056 replay_runner.py:39] Average training steps per second: 802123.54
I0910 11:00:41.807387 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:00:41.863599 140630342445056 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 805976.94
I0910 11:00:41.865088 140630342445056 replay_runner.py:39] Average training steps per second: 805976.94
I0910 11:00:42.037238 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:00:42.088591 140630342445056 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 813480.22
I0910 11:00:42.090020 140630342445056 replay_runner.py:39] Average training steps per second: 813480.22
I0910 11:00:42.264213 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:00:42.328233 140630342445056 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 600817.07
I0910 11:00:42.330263 140630342445056 replay_runner.py:39] Average training steps per second: 600817.07
I0910 11:00:42.533629 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:00:42.586140 140630342445056 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 821285.29
I0910 11:00:42.587578 140630342445056 replay_runner.py:39] Average training steps per second: 821285.29
I0910 11:00:42.767504 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:00:42.819320 140630342445056 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 789739.03
I0910 11:00:42.820806 140630342445056 replay_runner.py:39] Average training steps per second: 789739.03
I0910 11:00:42.992368 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:00:43.046510 140630342445056 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 848190.90
I0910 11:00:43.047902 140630342445056 replay_runner.py:39] Average training steps per second: 848190.90
I0910 11:00:43.252924 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:00:43.326669 140630342445056 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 825000.79
I0910 11:00:43.328123 140630342445056 replay_runner.py:39] Average training steps per second: 825000.79
I0910 11:00:43.505554 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:00:43.557940 140630342445056 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 825650.39
I0910 11:00:43.559360 140630342445056 replay_runner.py:39] Average training steps per second: 825650.39
I0910 11:00:43.728338 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:00:43.780043 140630342445056 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 826138.27

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:00:44.010640 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:00:44.063429 140630342445056 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 800286.97
I0910 11:00:44.064898 140630342445056 replay_runner.py:39] Average training steps per second: 800286.97
I0910 11:00:44.231552 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:00:44.281628 140630342445056 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 900451.70
I0910 11:00:44.282979 140630342445056 replay_runner.py:39] Average training steps per second: 900451.70
I0910 11:00:44.463394 140630342445056 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00