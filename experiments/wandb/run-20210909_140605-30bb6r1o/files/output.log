I0909 14:06:10.815467 139923585574912 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 14:06:10.815968 139923585574912 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 14:06:10.877998 139923585574912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:10.879352 139923585574912 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:10.879414 139923585574912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:10.879463 139923585574912 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:10.879513 139923585574912 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:10.879572 139923585574912 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:10.879617 139923585574912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:10.879781 139923585574912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:10.879847 139923585574912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:10.879908 139923585574912 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:10.879967 139923585574912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:10.880035 139923585574912 dqn_agent.py:283] 	 seed: 1631196370877922
I0909 14:06:10.881548 139923585574912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:10.881684 139923585574912 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:10.881745 139923585574912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:10.881800 139923585574912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:10.881854 139923585574912 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:10.881901 139923585574912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:10.881969 139923585574912 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:10.882036 139923585574912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:10.882086 139923585574912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.104519 139923585574912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.299915 139923585574912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in mountaincar
Training fixed agent 8, please be patient, may be a while...
I0909 14:06:12.309014 139923585574912 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 14:06:12.312901 139923585574912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:12.313024 139923585574912 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:12.313095 139923585574912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:12.313156 139923585574912 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:12.313219 139923585574912 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:12.313275 139923585574912 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:12.313346 139923585574912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:12.313421 139923585574912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:12.313486 139923585574912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:12.313538 139923585574912 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:12.313608 139923585574912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:12.313679 139923585574912 dqn_agent.py:283] 	 seed: 1631196372312873
I0909 14:06:12.315003 139923585574912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:12.315122 139923585574912 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:12.315203 139923585574912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:12.315267 139923585574912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:12.315325 139923585574912 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:12.315393 139923585574912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:12.315460 139923585574912 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:12.315524 139923585574912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:12.315577 139923585574912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.332957 139923585574912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.343463 139923585574912 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 14:06:12.343595 139923585574912 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 210.63
I0909 14:06:17.091485 139923585574912 replay_runner.py:36] Average training steps per second: 210.63
I0909 14:06:17.870372 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 14:06:17.959813 139923585574912 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 256.19
I0909 14:06:21.863974 139923585574912 replay_runner.py:36] Average training steps per second: 256.19
I0909 14:06:22.108656 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2

Steps executed: 374 Episode length: 187 Return: -187.0
INFO:tensorflow:Average training steps per second: 251.41
I0909 14:06:26.178211 139923585574912 replay_runner.py:36] Average training steps per second: 251.41
I0909 14:06:26.330496 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 3

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 261.56
I0909 14:06:30.242225 139923585574912 replay_runner.py:36] Average training steps per second: 261.56
I0909 14:06:30.496572 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 14:06:30.592805 139923585574912 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 258.91
I0909 14:06:34.455726 139923585574912 replay_runner.py:36] Average training steps per second: 258.91
I0909 14:06:34.720161 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 14:06:34.811222 139923585574912 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 250.94
I0909 14:06:38.796721 139923585574912 replay_runner.py:36] Average training steps per second: 250.94
I0909 14:06:39.039250 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 14:06:39.132691 139923585574912 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 260.88
I0909 14:06:42.966388 139923585574912 replay_runner.py:36] Average training steps per second: 260.88
I0909 14:06:43.213102 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 304 Episode length: 152 Return: -152.0
INFO:tensorflow:Average training steps per second: 261.02
I0909 14:06:47.140579 139923585574912 replay_runner.py:36] Average training steps per second: 261.02
I0909 14:06:47.274656 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.00
INFO:tensorflow:Starting iteration 8

Steps executed: 285 Episode length: 91 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 210.25
I0909 14:06:52.128637 139923585574912 replay_runner.py:36] Average training steps per second: 210.25
I0909 14:06:52.298019 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 9

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 261.38
I0909 14:06:56.219872 139923585574912 replay_runner.py:36] Average training steps per second: 261.38
I0909 14:06:56.473564 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 260.44
I0909 14:07:00.407261 139923585574912 replay_runner.py:36] Average training steps per second: 260.44
I0909 14:07:00.493822 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 11

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 255.09
I0909 14:07:04.505927 139923585574912 replay_runner.py:36] Average training steps per second: 255.09
I0909 14:07:04.762960 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 226 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 258.68
I0909 14:07:08.724466 139923585574912 replay_runner.py:36] Average training steps per second: 258.68
I0909 14:07:08.816874 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 260.29
I0909 14:07:12.752213 139923585574912 replay_runner.py:36] Average training steps per second: 260.29
I0909 14:07:12.990202 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14

Steps executed: 237 Episode length: 153 Return: -153.0
INFO:tensorflow:Average training steps per second: 259.48
I0909 14:07:16.937833 139923585574912 replay_runner.py:36] Average training steps per second: 259.48
I0909 14:07:17.044746 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 15

Steps executed: 232 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 257.67
I0909 14:07:21.024048 139923585574912 replay_runner.py:36] Average training steps per second: 257.67
I0909 14:07:21.129183 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 16

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 257.57
I0909 14:07:25.116932 139923585574912 replay_runner.py:36] Average training steps per second: 257.57
I0909 14:07:25.376911 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17

Steps executed: 205 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 253.31
I0909 14:07:29.421776 139923585574912 replay_runner.py:36] Average training steps per second: 253.31
I0909 14:07:29.508967 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.50
INFO:tensorflow:Starting iteration 18

Steps executed: 213 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 259.09
I0909 14:07:33.462411 139923585574912 replay_runner.py:36] Average training steps per second: 259.09
I0909 14:07:33.559023 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 19

Steps executed: 232 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 245.12
I0909 14:07:37.731615 139923585574912 replay_runner.py:36] Average training steps per second: 245.12
I0909 14:07:37.841139 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 20

Steps executed: 235 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 260.30
I0909 14:07:41.776190 139923585574912 replay_runner.py:36] Average training steps per second: 260.30
I0909 14:07:41.876377 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 21

Steps executed: 222 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 255.61
I0909 14:07:45.884452 139923585574912 replay_runner.py:36] Average training steps per second: 255.61
I0909 14:07:45.985908 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 22

Steps executed: 220 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 253.97
I0909 14:07:50.016513 139923585574912 replay_runner.py:36] Average training steps per second: 253.97
I0909 14:07:50.119464 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 23

Steps executed: 707 Episode length: 589 Return: -589.0
INFO:tensorflow:Average training steps per second: 255.24
I0909 14:07:54.127351 139923585574912 replay_runner.py:36] Average training steps per second: 255.24
I0909 14:07:54.420107 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.50
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 259.72
I0909 14:07:58.358476 139923585574912 replay_runner.py:36] Average training steps per second: 259.72
I0909 14:07:58.453662 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 25

Steps executed: 219 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 258.80
I0909 14:08:02.407514 139923585574912 replay_runner.py:36] Average training steps per second: 258.80
I0909 14:08:02.495801 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 26

Steps executed: 266 Episode length: 171 Return: -171.0
INFO:tensorflow:Average training steps per second: 261.58
I0909 14:08:06.407226 139923585574912 replay_runner.py:36] Average training steps per second: 261.58
I0909 14:08:06.518702 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 27

Steps executed: 292 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 258.88
I0909 14:08:10.475489 139923585574912 replay_runner.py:36] Average training steps per second: 258.88
I0909 14:08:10.598346 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 28

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 262.56
I0909 14:08:14.501345 139923585574912 replay_runner.py:36] Average training steps per second: 262.56
I0909 14:08:14.715235 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 311.08
I0909 14:08:18.014108 139923585574912 replay_runner.py:36] Average training steps per second: 311.08
I0909 14:08:18.098095 139923585574912 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50