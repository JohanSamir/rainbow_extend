Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0828 10:30:40.263215 139788988807168 run_experiment.py:549] Creating TrainRunner ...
I0828 10:30:40.273428 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:40.273654 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:40.273754 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:40.273861 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:40.273977 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:40.274129 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:40.274190 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:40.274297 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:40.274359 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:40.274538 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:40.274683 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:40.274830 139788988807168 dqn_agent.py:283] 	 seed: 1630146640273367
I0828 10:30:40.278286 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:40.278460 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:40.278637 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:40.278808 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:40.279135 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:40.279421 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:40.279632 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:40.279994 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:40.280159 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:40.319516 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.873933 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.889712 139788988807168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:30:40.899442 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:40.899773 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:40.899937 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:40.900045 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:40.900154 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:40.900212 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:40.900296 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:40.900351 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:40.900456 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:40.900536 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:40.900594 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:40.900689 139788988807168 dqn_agent.py:283] 	 seed: 1630146640899369
I0828 10:30:40.903046 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:40.903289 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:40.903452 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:40.903604 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:40.903700 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:40.903834 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:40.903966 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:40.904156 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:40.904319 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:40.937588 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.958382 139788988807168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:30:40.958670 139788988807168 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 140.34
I0828 10:30:48.084264 139788988807168 replay_runner.py:36] Average training steps per second: 140.34
I0828 10:30:49.230726 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0828 10:30:49.421942 139788988807168 replay_runner.py:41] Starting iteration 1
Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 205.29
I0828 10:30:54.293428 139788988807168 replay_runner.py:36] Average training steps per second: 205.29
I0828 10:30:54.428323 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.20
INFO:tensorflow:Starting iteration 2

Steps executed: 216 Episode length: 40 Return: 40.0
INFO:tensorflow:Average training steps per second: 194.19
I0828 10:30:59.756110 139788988807168 replay_runner.py:36] Average training steps per second: 194.19
I0828 10:30:59.877141 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 21.30
INFO:tensorflow:Starting iteration 3

Steps executed: 213 Episode length: 20 Return: 20.0
INFO:tensorflow:Average training steps per second: 210.16
I0828 10:31:04.815688 139788988807168 replay_runner.py:36] Average training steps per second: 210.16
I0828 10:31:04.963255 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.00
INFO:tensorflow:Starting iteration 4

Steps executed: 209 Episode length: 18 Return: 18.0
INFO:tensorflow:Average training steps per second: 201.81


Steps executed: 205 Episode length: 15 Return: 15.0
I0828 10:31:10.235694 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.64
INFO:tensorflow:Starting iteration 5
I0828 10:31:10.417609 139788988807168 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 195.66
I0828 10:31:15.528914 139788988807168 replay_runner.py:36] Average training steps per second: 195.66
I0828 10:31:15.675452 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.10
INFO:tensorflow:Starting iteration 6

Steps executed: 201 Episode length: 21 Return: 21.0
INFO:tensorflow:Average training steps per second: 195.98
I0828 10:31:20.971324 139788988807168 replay_runner.py:36] Average training steps per second: 195.98
I0828 10:31:21.120173 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 32.57
INFO:tensorflow:Starting iteration 7


Steps executed: 216 Episode length: 110 Return: 110.0
INFO:tensorflow:Average training steps per second: 188.38
I0828 10:31:26.626506 139788988807168 replay_runner.py:36] Average training steps per second: 188.38
I0828 10:31:26.769261 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.00
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.97
I0828 10:31:32.140457 139788988807168 replay_runner.py:36] Average training steps per second: 192.97
I0828 10:31:32.277413 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0828 10:31:32.478103 139788988807168 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 190.80
I0828 10:31:37.719684 139788988807168 replay_runner.py:36] Average training steps per second: 190.80
I0828 10:31:37.853008 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 217 Episode length: 109 Return: 109.0
INFO:tensorflow:Average training steps per second: 189.16
I0828 10:31:43.331667 139788988807168 replay_runner.py:36] Average training steps per second: 189.16
I0828 10:31:43.488201 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.50
INFO:tensorflow:Starting iteration 11

Steps executed: 273 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 195.02
I0828 10:31:48.812070 139788988807168 replay_runner.py:36] Average training steps per second: 195.02
I0828 10:31:48.994494 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 91.00
INFO:tensorflow:Starting iteration 12
I0828 10:31:49.173141 139788988807168 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 187.88

Steps executed: 285 Episode length: 97 Return: 97.0.0
I0828 10:31:54.688846 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.00
INFO:tensorflow:Starting iteration 13
I0828 10:31:54.876509 139788988807168 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.24

Steps executed: 200 Episode length: 200 Return: 200.0
I0828 10:32:00.163612 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0828 10:32:00.353972 139788988807168 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 191.94
I0828 10:32:05.564168 139788988807168 replay_runner.py:36] Average training steps per second: 191.94
I0828 10:32:05.701166 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 222 Episode length: 72 Return: 72.0.0
INFO:tensorflow:Average training steps per second: 189.45
I0828 10:32:11.163218 139788988807168 replay_runner.py:36] Average training steps per second: 189.45
I0828 10:32:11.320392 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.00
INFO:tensorflow:Starting iteration 16

Steps executed: 256 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 195.77
I0828 10:32:16.630577 139788988807168 replay_runner.py:36] Average training steps per second: 195.77
I0828 10:32:16.803702 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 17
I0828 10:32:17.003123 139788988807168 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.07

Steps executed: 236 Episode length: 123 Return: 123.0
I0828 10:32:22.452768 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 18

Steps executed: 262 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 191.96
I0828 10:32:27.840254 139788988807168 replay_runner.py:36] Average training steps per second: 191.96
I0828 10:32:28.029912 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 19

Steps executed: 221 Episode length: 102 Return: 102.0
INFO:tensorflow:Average training steps per second: 193.80
I0828 10:32:33.395351 139788988807168 replay_runner.py:36] Average training steps per second: 193.80
I0828 10:32:33.534133 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.50
INFO:tensorflow:Starting iteration 20

Steps executed: 279 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 197.94
I0828 10:32:38.772040 139788988807168 replay_runner.py:36] Average training steps per second: 197.94
I0828 10:32:38.962745 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 21

Steps executed: 208 Episode length: 109 Return: 109.0
INFO:tensorflow:Average training steps per second: 197.07
I0828 10:32:44.234136 139788988807168 replay_runner.py:36] Average training steps per second: 197.07
I0828 10:32:44.363573 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 104.00
INFO:tensorflow:Starting iteration 22

Steps executed: 221 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 198.56
I0828 10:32:49.576853 139788988807168 replay_runner.py:36] Average training steps per second: 198.56
I0828 10:32:49.736807 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.50
INFO:tensorflow:Starting iteration 23

Steps executed: 332 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 186.84
I0828 10:32:55.296966 139788988807168 replay_runner.py:36] Average training steps per second: 186.84
I0828 10:32:55.501284 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.49
I0828 10:33:00.725206 139788988807168 replay_runner.py:36] Average training steps per second: 198.49
I0828 10:33:00.865147 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 223 Episode length: 73 Return: 73.0.0
INFO:tensorflow:Average training steps per second: 195.36
I0828 10:33:06.181007 139788988807168 replay_runner.py:36] Average training steps per second: 195.36
I0828 10:33:06.337026 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.33
INFO:tensorflow:Starting iteration 26
I0828 10:33:06.517484 139788988807168 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 195.26
I0828 10:33:11.639282 139788988807168 replay_runner.py:36] Average training steps per second: 195.26
I0828 10:33:11.803797 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 46.80
INFO:tensorflow:Starting iteration 27

Steps executed: 234 Episode length: 78 Return: 78.0.0
INFO:tensorflow:Average training steps per second: 202.16
I0828 10:33:16.948720 139788988807168 replay_runner.py:36] Average training steps per second: 202.16
I0828 10:33:17.123477 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.00
INFO:tensorflow:Starting iteration 28


Steps executed: 256 Episode length: 82 Return: 82.0.0
INFO:tensorflow:Average training steps per second: 188.63
I0828 10:33:22.606518 139788988807168 replay_runner.py:36] Average training steps per second: 188.63
I0828 10:33:22.767630 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 85.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 107 Return: 107.0
INFO:tensorflow:Average training steps per second: 206.06
I0828 10:33:27.806583 139788988807168 replay_runner.py:36] Average training steps per second: 206.06
I0828 10:33:27.962736 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 112.50