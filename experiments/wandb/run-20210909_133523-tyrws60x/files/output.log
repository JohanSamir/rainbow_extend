
Loaded trained dqn in mountaincar
I0909 13:35:29.230615 140627910785024 run_experiment.py:549] Creating TrainRunner ...
I0909 13:35:29.237558 140627910785024 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:29.237703 140627910785024 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:29.237784 140627910785024 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:29.237863 140627910785024 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:29.237956 140627910785024 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:29.238026 140627910785024 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:29.238124 140627910785024 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:29.238209 140627910785024 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:29.238281 140627910785024 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:29.238339 140627910785024 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:29.238418 140627910785024 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:29.238497 140627910785024 dqn_agent.py:283] 	 seed: 1631194529237522
I0909 13:35:29.240633 140627910785024 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:29.240796 140627910785024 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:29.240931 140627910785024 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:29.241013 140627910785024 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:29.241127 140627910785024 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:29.241432 140627910785024 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:29.241545 140627910785024 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:29.241676 140627910785024 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:29.241778 140627910785024 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:35:30.512534 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:30.694709 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:30.704977 140627910785024 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:35:30.711130 140627910785024 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:30.711366 140627910785024 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:30.711548 140627910785024 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:30.711630 140627910785024 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:30.711709 140627910785024 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:30.711842 140627910785024 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:30.711956 140627910785024 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:30.712033 140627910785024 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:30.712103 140627910785024 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:30.712209 140627910785024 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:30.712356 140627910785024 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:30.712463 140627910785024 dqn_agent.py:283] 	 seed: 1631194530711086
I0909 13:35:30.713941 140627910785024 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:30.714051 140627910785024 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:30.714122 140627910785024 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:30.714184 140627910785024 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:30.714241 140627910785024 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:30.714298 140627910785024 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:30.714351 140627910785024 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:30.714422 140627910785024 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:30.714488 140627910785024 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 4, please be patient, may be a while...
I0909 13:35:30.753470 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:30.769133 140627910785024 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:35:30.769442 140627910785024 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 198.20
I0909 13:35:35.815344 140627910785024 replay_runner.py:36] Average training steps per second: 198.20
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:35:36.857221 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:35:36.947199 140627910785024 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 254.28
I0909 13:35:40.880163 140627910785024 replay_runner.py:36] Average training steps per second: 254.28
I0909 13:35:41.127969 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:35:41.217736 140627910785024 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 258.73
I0909 13:35:45.083304 140627910785024 replay_runner.py:36] Average training steps per second: 258.73
I0909 13:35:45.333133 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:35:45.425415 140627910785024 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 261.65
I0909 13:35:49.247611 140627910785024 replay_runner.py:36] Average training steps per second: 261.65
I0909 13:35:49.497078 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:35:49.593262 140627910785024 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 255.91
I0909 13:35:53.501410 140627910785024 replay_runner.py:36] Average training steps per second: 255.91
I0909 13:35:53.750268 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:35:53.839940 140627910785024 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 257.86
I0909 13:35:57.718433 140627910785024 replay_runner.py:36] Average training steps per second: 257.86
I0909 13:35:57.990240 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:35:58.077865 140627910785024 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 257.20
I0909 13:36:01.966256 140627910785024 replay_runner.py:36] Average training steps per second: 257.20
I0909 13:36:02.226568 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:36:02.318673 140627910785024 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 253.19
I0909 13:36:06.268712 140627910785024 replay_runner.py:36] Average training steps per second: 253.19
I0909 13:36:06.517107 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:36:06.606400 140627910785024 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 257.84
I0909 13:36:10.485316 140627910785024 replay_runner.py:36] Average training steps per second: 257.84
I0909 13:36:10.744655 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 249 Episode length: 165 Return: -165.0
INFO:tensorflow:Average training steps per second: 256.98
I0909 13:36:14.731781 140627910785024 replay_runner.py:36] Average training steps per second: 256.98
I0909 13:36:14.836970 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 10
I0909 13:36:14.927141 140627910785024 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 257.26
I0909 13:36:18.814711 140627910785024 replay_runner.py:36] Average training steps per second: 257.26
I0909 13:36:19.067831 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 250.85
I0909 13:36:23.147846 140627910785024 replay_runner.py:36] Average training steps per second: 250.85
I0909 13:36:23.382257 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0909 13:36:23.472564 140627910785024 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 257.52
I0909 13:36:27.356228 140627910785024 replay_runner.py:36] Average training steps per second: 257.52
I0909 13:36:27.605739 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13

Steps executed: 220 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 256.71
I0909 13:36:31.596256 140627910785024 replay_runner.py:36] Average training steps per second: 256.71
I0909 13:36:31.698178 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 14

Steps executed: 248 Episode length: 141 Return: -141.0
INFO:tensorflow:Average training steps per second: 256.17
I0909 13:36:35.693261 140627910785024 replay_runner.py:36] Average training steps per second: 256.17
I0909 13:36:35.808716 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 15

Steps executed: 217 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 253.03
I0909 13:36:39.852594 140627910785024 replay_runner.py:36] Average training steps per second: 253.03
I0909 13:36:39.948597 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 16

Steps executed: 318 Episode length: 160 Return: -160.0
INFO:tensorflow:Average training steps per second: 257.84
I0909 13:36:43.920902 140627910785024 replay_runner.py:36] Average training steps per second: 257.84
I0909 13:36:44.063714 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.00
INFO:tensorflow:Starting iteration 17

Steps executed: 313 Episode length: 160 Return: -160.0
INFO:tensorflow:Average training steps per second: 256.46
I0909 13:36:48.053105 140627910785024 replay_runner.py:36] Average training steps per second: 256.46
I0909 13:36:48.182955 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50
INFO:tensorflow:Starting iteration 18

Steps executed: 298 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 255.80
I0909 13:36:52.180570 140627910785024 replay_runner.py:36] Average training steps per second: 255.80
I0909 13:36:52.306386 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.33
INFO:tensorflow:Starting iteration 19

Steps executed: 229 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 252.84
I0909 13:36:56.350745 140627910785024 replay_runner.py:36] Average training steps per second: 252.84
I0909 13:36:56.444140 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 251.41
I0909 13:37:00.509668 140627910785024 replay_runner.py:36] Average training steps per second: 251.41
I0909 13:37:00.604186 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 21

Steps executed: 219 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 254.79
I0909 13:37:04.622622 140627910785024 replay_runner.py:36] Average training steps per second: 254.79
I0909 13:37:04.712387 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 22

Steps executed: 212 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 255.39
I0909 13:37:08.716778 140627910785024 replay_runner.py:36] Average training steps per second: 255.39
I0909 13:37:08.804772 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 23

Steps executed: 354 Episode length: 165 Return: -165.0
INFO:tensorflow:Average training steps per second: 257.79
I0909 13:37:12.776994 140627910785024 replay_runner.py:36] Average training steps per second: 257.79
I0909 13:37:12.919527 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 24

Steps executed: 210 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 255.68
I0909 13:37:16.924017 140627910785024 replay_runner.py:36] Average training steps per second: 255.68
I0909 13:37:17.016891 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 25

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 260.68
I0909 13:37:20.941751 140627910785024 replay_runner.py:36] Average training steps per second: 260.68
I0909 13:37:21.172575 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26

Steps executed: 214 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 273.54
I0909 13:37:24.913877 140627910785024 replay_runner.py:36] Average training steps per second: 273.54
I0909 13:37:24.992475 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 27

Steps executed: 334 Episode length: 168 Return: -168.0
INFO:tensorflow:Average training steps per second: 305.42
I0909 13:37:28.353947 140627910785024 replay_runner.py:36] Average training steps per second: 305.42
I0909 13:37:28.457120 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.00
INFO:tensorflow:Starting iteration 28
I0909 13:37:28.527875 140627910785024 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 322.29

Steps executed: 210 Episode length: 105 Return: -105.0
I0909 13:37:31.710178 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 91 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 286.84
I0909 13:37:35.271035 140627910785024 replay_runner.py:36] Average training steps per second: 286.84
I0909 13:37:35.350746 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50