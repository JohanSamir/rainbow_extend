Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0902 18:03:02.414618 140228977166336 run_experiment.py:549] Creating TrainRunner ...
I0902 18:03:02.425381 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:03:02.425674 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:03:02.425827 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:03:02.426011 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:03:02.426203 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 18:03:02.426498 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:03:02.426702 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:03:02.426864 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:03:02.427053 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:03:02.427159 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 18:03:02.427229 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:03:02.427286 140228977166336 dqn_agent.py:283] 	 seed: 1630605782425308
I0902 18:03:02.429863 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:03:02.430023 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:03:02.430182 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:03:02.430314 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:03:02.430443 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:03:02.430550 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:03:02.430665 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:03:02.430779 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:03:02.430881 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:03:02.468868 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:03:02.937644 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:03:02.950954 140228977166336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:03:02.959072 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:03:02.959372 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:03:02.959706 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:03:02.959867 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:03:02.960235 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 18:03:02.960580 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:03:02.960749 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:03:02.960865 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:03:02.961075 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:03:02.961232 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 18:03:02.961361 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:03:02.961506 140228977166336 dqn_agent.py:283] 	 seed: 1630605782959021
I0902 18:03:02.964638 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:03:02.964931 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:03:02.965149 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:03:02.965384 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:03:02.965505 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:03:02.965670 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:03:02.965831 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:03:02.965990 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:03:02.966302 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:03:02.997775 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:03:03.021862 140228977166336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:03:03.022213 140228977166336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 141.60
I0902 18:03:10.084881 140228977166336 replay_runner.py:36] Average training steps per second: 141.60
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:03:11.612269 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 18:03:11.859961 140228977166336 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 194.16
I0902 18:03:17.010783 140228977166336 replay_runner.py:36] Average training steps per second: 194.16
I0902 18:03:17.412120 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 18:03:17.642102 140228977166336 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 199.11
I0902 18:03:22.665100 140228977166336 replay_runner.py:36] Average training steps per second: 199.11
I0902 18:03:23.109150 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 612 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.87
I0902 18:03:28.285268 140228977166336 replay_runner.py:36] Average training steps per second: 202.87
I0902 18:03:28.785216 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.50
INFO:tensorflow:Starting iteration 4
I0902 18:03:29.022596 140228977166336 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 189.96

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:03:34.686359 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 249 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 199.62
I0902 18:03:39.933970 140228977166336 replay_runner.py:36] Average training steps per second: 199.62
I0902 18:03:40.159781 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.04
I0902 18:03:45.512808 140228977166336 replay_runner.py:36] Average training steps per second: 196.04
I0902 18:03:45.897987 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 18:03:46.140288 140228977166336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.30
I0902 18:03:51.395639 140228977166336 replay_runner.py:36] Average training steps per second: 190.30
I0902 18:03:51.832286 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 289 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 201.24
I0902 18:03:57.049276 140228977166336 replay_runner.py:36] Average training steps per second: 201.24
I0902 18:03:57.296437 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.57
I0902 18:04:02.684007 140228977166336 replay_runner.py:36] Average training steps per second: 194.57
I0902 18:04:03.091627 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 75 Episode length: 75 Return: -74.00.0
INFO:tensorflow:Average training steps per second: 195.33

Steps executed: 224 Episode length: 72 Return: -71.0.0
I0902 18:04:08.651244 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 11

Steps executed: 309 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 203.49
I0902 18:04:13.812803 140228977166336 replay_runner.py:36] Average training steps per second: 203.49
I0902 18:04:14.069980 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.18
I0902 18:04:19.516977 140228977166336 replay_runner.py:36] Average training steps per second: 192.18
I0902 18:04:19.923602 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 295 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 197.91
I0902 18:04:25.217374 140228977166336 replay_runner.py:36] Average training steps per second: 197.91
I0902 18:04:25.479796 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 14

Steps executed: 254 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 198.14
I0902 18:04:30.787657 140228977166336 replay_runner.py:36] Average training steps per second: 198.14
I0902 18:04:30.988025 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 15
I0902 18:04:31.257392 140228977166336 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.03

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:04:36.866531 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 235 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 202.38
I0902 18:04:42.059658 140228977166336 replay_runner.py:36] Average training steps per second: 202.38
I0902 18:04:42.248383 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 17

Steps executed: 486 Episode length: 320 Return: -319.0
INFO:tensorflow:Average training steps per second: 192.49
I0902 18:04:47.692943 140228977166336 replay_runner.py:36] Average training steps per second: 192.49
I0902 18:04:48.122373 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.00
INFO:tensorflow:Starting iteration 18

Steps executed: 261 Episode length: 167 Return: -166.0
INFO:tensorflow:Average training steps per second: 197.93
I0902 18:04:53.410108 140228977166336 replay_runner.py:36] Average training steps per second: 197.93
I0902 18:04:53.639635 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 19

Steps executed: 309 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 204.38
I0902 18:04:58.781614 140228977166336 replay_runner.py:36] Average training steps per second: 204.38
I0902 18:04:59.016485 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 220.78
I0902 18:05:03.909532 140228977166336 replay_runner.py:36] Average training steps per second: 220.78
I0902 18:05:04.321414 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 214 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 206.57
I0902 18:05:09.476085 140228977166336 replay_runner.py:36] Average training steps per second: 206.57
I0902 18:05:09.644494 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 22

Steps executed: 91 Episode length: 91 Return: -90.07.0
INFO:tensorflow:Average training steps per second: 212.63

Steps executed: 281 Episode length: 87 Return: -86.0.0
I0902 18:05:14.790844 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 23

Steps executed: 208 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 199.13
I0902 18:05:20.056604 140228977166336 replay_runner.py:36] Average training steps per second: 199.13
I0902 18:05:20.220914 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 24

Steps executed: 334 Episode length: 254 Return: -253.0
INFO:tensorflow:Average training steps per second: 209.57
I0902 18:05:25.226883 140228977166336 replay_runner.py:36] Average training steps per second: 209.57
I0902 18:05:25.510429 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.00
INFO:tensorflow:Starting iteration 25

Steps executed: 237 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 195.76
I0902 18:05:30.862463 140228977166336 replay_runner.py:36] Average training steps per second: 195.76
I0902 18:05:31.051343 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 198.53
I0902 18:05:36.334775 140228977166336 replay_runner.py:36] Average training steps per second: 198.53
I0902 18:05:36.507138 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 27

Steps executed: 328 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 203.03
I0902 18:05:41.680014 140228977166336 replay_runner.py:36] Average training steps per second: 203.03
I0902 18:05:41.945727 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.33
INFO:tensorflow:Starting iteration 28

Steps executed: 240 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 200.55
I0902 18:05:47.171653 140228977166336 replay_runner.py:36] Average training steps per second: 200.55
I0902 18:05:47.372625 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 29
I0902 18:05:47.613051 140228977166336 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 205.04
I0902 18:05:52.490448 140228977166336 replay_runner.py:36] Average training steps per second: 205.04

Done fixed training!Episode length: 500 Return: -500.0