Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
I0909 13:30:19.125234 139663366092800 run_experiment.py:549] Creating TrainRunner ...
I0909 13:30:19.131766 139663366092800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:30:19.131881 139663366092800 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:30:19.131931 139663366092800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:30:19.131974 139663366092800 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:30:19.132016 139663366092800 dqn_agent.py:275] 	 update_period: 4
I0909 13:30:19.132071 139663366092800 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:30:19.132128 139663366092800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:30:19.132173 139663366092800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:30:19.132219 139663366092800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:30:19.132293 139663366092800 dqn_agent.py:280] 	 optimizer: adam
I0909 13:30:19.132402 139663366092800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:30:19.132463 139663366092800 dqn_agent.py:283] 	 seed: 1631194219131733
I0909 13:30:19.134403 139663366092800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:30:19.134499 139663366092800 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:30:19.134575 139663366092800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:30:19.134638 139663366092800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:30:19.134685 139663366092800 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:30:19.134757 139663366092800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:30:19.134833 139663366092800 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:30:19.134881 139663366092800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:30:19.134927 139663366092800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:30:20.559146 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:30:20.764702 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:30:20.775416 139663366092800 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:30:20.780742 139663366092800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:30:20.780877 139663366092800 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:30:20.780940 139663366092800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:30:20.781005 139663366092800 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:30:20.781081 139663366092800 dqn_agent.py:275] 	 update_period: 4
I0909 13:30:20.781142 139663366092800 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:30:20.781242 139663366092800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:30:20.781300 139663366092800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:30:20.781372 139663366092800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:30:20.781443 139663366092800 dqn_agent.py:280] 	 optimizer: adam
I0909 13:30:20.781514 139663366092800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:30:20.781579 139663366092800 dqn_agent.py:283] 	 seed: 1631194220780713
I0909 13:30:20.783208 139663366092800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:30:20.783321 139663366092800 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:30:20.783405 139663366092800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:30:20.783473 139663366092800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:30:20.783534 139663366092800 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:30:20.783593 139663366092800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:30:20.783658 139663366092800 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:30:20.783721 139663366092800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:30:20.783778 139663366092800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:30:20.806395 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:30:20.820474 139663366092800 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:30:20.820666 139663366092800 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 294.08
I0909 13:30:24.221379 139663366092800 replay_runner.py:36] Average training steps per second: 294.08
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:30:24.854882 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1

Steps executed: 733 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 393.13
I0909 13:30:27.465277 139663366092800 replay_runner.py:36] Average training steps per second: 393.13
I0909 13:30:27.606748 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.50
INFO:tensorflow:Starting iteration 2

Steps executed: 374 Episode length: 188 Return: -188.0
INFO:tensorflow:Average training steps per second: 391.74
I0909 13:30:30.222918 139663366092800 replay_runner.py:36] Average training steps per second: 391.74
I0909 13:30:30.301109 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 3

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 396.88
I0909 13:30:32.885299 139663366092800 replay_runner.py:36] Average training steps per second: 396.88
I0909 13:30:33.006113 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4

Steps executed: 325 Episode length: 151 Return: -151.0
INFO:tensorflow:Average training steps per second: 396.04
I0909 13:30:35.595525 139663366092800 replay_runner.py:36] Average training steps per second: 396.04
I0909 13:30:35.660905 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.33
INFO:tensorflow:Starting iteration 5

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 393.90
I0909 13:30:38.264482 139663366092800 replay_runner.py:36] Average training steps per second: 393.90
I0909 13:30:38.393589 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:30:38.456817 139663366092800 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 399.96
I0909 13:30:40.957335 139663366092800 replay_runner.py:36] Average training steps per second: 399.96
I0909 13:30:41.078691 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 244 Episode length: 159 Return: -159.0
INFO:tensorflow:Average training steps per second: 400.18
I0909 13:30:43.642106 139663366092800 replay_runner.py:36] Average training steps per second: 400.18
I0909 13:30:43.691753 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 8

Steps executed: 777 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 399.80
I0909 13:30:46.255275 139663366092800 replay_runner.py:36] Average training steps per second: 399.80
I0909 13:30:46.410959 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.00
INFO:tensorflow:Starting iteration 9
I0909 13:30:46.475499 139663366092800 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 402.06

Steps executed: 244 Episode length: 157 Return: -157.0
I0909 13:30:49.013661 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 10

Steps executed: 343 Episode length: 153 Return: -153.0
INFO:tensorflow:Average training steps per second: 398.22
I0909 13:30:51.588120 139663366092800 replay_runner.py:36] Average training steps per second: 398.22
I0909 13:30:51.655808 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.33
INFO:tensorflow:Starting iteration 11

Steps executed: 691 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 404.12
I0909 13:30:54.193485 139663366092800 replay_runner.py:36] Average training steps per second: 404.12
I0909 13:30:54.334652 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.50
INFO:tensorflow:Starting iteration 12
I0909 13:30:54.399111 139663366092800 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 403.43
I0909 13:30:56.878124 139663366092800 replay_runner.py:36] Average training steps per second: 403.43
I0909 13:30:56.998667 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13


Steps executed: 232 Episode length: 146 Return: -146.0
INFO:tensorflow:Average training steps per second: 399.25
I0909 13:30:59.567146 139663366092800 replay_runner.py:36] Average training steps per second: 399.25
I0909 13:30:59.615067 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 14

Steps executed: 225 Episode length: 139 Return: -139.0
INFO:tensorflow:Average training steps per second: 402.98
I0909 13:31:02.159074 139663366092800 replay_runner.py:36] Average training steps per second: 402.98
I0909 13:31:02.205813 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 15

Steps executed: 288 Episode length: 190 Return: -190.0
INFO:tensorflow:Average training steps per second: 403.12
I0909 13:31:04.750761 139663366092800 replay_runner.py:36] Average training steps per second: 403.12
I0909 13:31:04.808527 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.00
INFO:tensorflow:Starting iteration 16

Steps executed: 212 Episode length: 127 Return: -127.0
INFO:tensorflow:Average training steps per second: 397.22
I0909 13:31:07.389149 139663366092800 replay_runner.py:36] Average training steps per second: 397.22
I0909 13:31:07.432364 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 17

Steps executed: 201 Episode length: 201 Return: -201.0
INFO:tensorflow:Average training steps per second: 397.25
I0909 13:31:10.012000 139663366092800 replay_runner.py:36] Average training steps per second: 397.25
I0909 13:31:10.054677 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 18

Steps executed: 233 Episode length: 118 Return: -118.0
INFO:tensorflow:Average training steps per second: 404.31
I0909 13:31:12.590652 139663366092800 replay_runner.py:36] Average training steps per second: 404.31
I0909 13:31:12.638536 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 19
I0909 13:31:12.704275 139663366092800 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 403.30
I0909 13:31:15.184058 139663366092800 replay_runner.py:36] Average training steps per second: 403.30

Steps executed: 209 Episode length: 120 Return: -120.0
INFO:tensorflow:Starting iteration 20

Steps executed: 234 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 403.19
I0909 13:31:17.767460 139663366092800 replay_runner.py:36] Average training steps per second: 403.19
I0909 13:31:17.814242 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 21

Steps executed: 204 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 396.06
I0909 13:31:20.402883 139663366092800 replay_runner.py:36] Average training steps per second: 396.06
I0909 13:31:20.446572 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 22

Steps executed: 300 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 395.10
I0909 13:31:23.039952 139663366092800 replay_runner.py:36] Average training steps per second: 395.10
I0909 13:31:23.100275 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 23

Steps executed: 295 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 402.00
I0909 13:31:25.651766 139663366092800 replay_runner.py:36] Average training steps per second: 402.00
I0909 13:31:25.711348 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.33
INFO:tensorflow:Starting iteration 24

Steps executed: 313 Episode length: 121 Return: -121.0
INFO:tensorflow:Average training steps per second: 404.23
I0909 13:31:28.249613 139663366092800 replay_runner.py:36] Average training steps per second: 404.23
I0909 13:31:28.312261 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.33
INFO:tensorflow:Starting iteration 25

Steps executed: 722 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 401.66
I0909 13:31:30.864856 139663366092800 replay_runner.py:36] Average training steps per second: 401.66
I0909 13:31:31.008416 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.00
INFO:tensorflow:Starting iteration 26

Steps executed: 225 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 400.85
I0909 13:31:33.566184 139663366092800 replay_runner.py:36] Average training steps per second: 400.85
I0909 13:31:33.611892 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 27

Steps executed: 201 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 399.71
I0909 13:31:36.176918 139663366092800 replay_runner.py:36] Average training steps per second: 399.71
I0909 13:31:36.217282 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 28

Steps executed: 276 Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 399.42
I0909 13:31:38.783054 139663366092800 replay_runner.py:36] Average training steps per second: 399.42
I0909 13:31:38.839542 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.00
INFO:tensorflow:Starting iteration 29
I0909 13:31:38.902399 139663366092800 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 392.10
I0909 13:31:41.452992 139663366092800 replay_runner.py:36] Average training steps per second: 392.10

Done fixed training!Episode length: 109 Return: -109.0