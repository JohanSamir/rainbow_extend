Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 23:53:42.936774 140286289131520 run_experiment.py:549] Creating TrainRunner ...
I0901 23:53:42.946359 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:53:42.946673 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:53:42.946835 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:53:42.947251 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:53:42.947423 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0901 23:53:42.947545 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:53:42.947668 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:53:42.947898 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:53:42.948013 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:53:42.948111 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:53:42.948208 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:53:42.948303 140286289131520 dqn_agent.py:283] 	 seed: 1630540422946267
I0901 23:53:42.951247 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:53:42.951452 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:53:42.951591 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:53:42.951726 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:53:42.951836 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:53:42.951933 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:53:42.952029 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:53:42.952131 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:53:42.952225 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:53:42.992452 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:43.529826 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:43.563833 140286289131520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:53:43.584677 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:53:43.584904 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:53:43.585019 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:53:43.585125 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:53:43.585224 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0901 23:53:43.585316 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:53:43.585410 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:53:43.586718 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:53:43.586851 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:53:43.586949 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:53:43.587051 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:53:43.587145 140286289131520 dqn_agent.py:283] 	 seed: 1630540423584623
I0901 23:53:43.591332 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:53:43.591528 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:53:43.591645 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:53:43.593630 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:53:43.593736 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:53:43.593836 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:53:43.593933 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:53:43.594033 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:53:43.594142 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:53:43.628646 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:43.646814 140286289131520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:53:43.647044 140286289131520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.32
I0901 23:53:50.435048 140286289131520 replay_runner.py:36] Average training steps per second: 147.32
I0901 23:53:51.609063 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0901 23:53:51.801100 140286289131520 replay_runner.py:41] Starting iteration 1
Steps executed: 204 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 195.19
I0901 23:53:56.924687 140286289131520 replay_runner.py:36] Average training steps per second: 195.19
I0901 23:53:57.054150 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.31
I0901 23:54:02.326558 140286289131520 replay_runner.py:36] Average training steps per second: 197.31
I0901 23:54:02.460549 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0901 23:54:02.643330 140286289131520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 191.43
I0901 23:54:07.867713 140286289131520 replay_runner.py:36] Average training steps per second: 191.43
I0901 23:54:08.002014 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0901 23:54:08.189464 140286289131520 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 191.44
I0901 23:54:13.413838 140286289131520 replay_runner.py:36] Average training steps per second: 191.44
I0901 23:54:13.547248 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 23:54:13.735064 140286289131520 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.21

Steps executed: 258 Episode length: 116 Return: 116.0
I0901 23:54:18.998771 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.75
I0901 23:54:24.481558 140286289131520 replay_runner.py:36] Average training steps per second: 188.75
I0901 23:54:24.605115 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0901 23:54:24.786704 140286289131520 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.52
I0901 23:54:29.928016 140286289131520 replay_runner.py:36] Average training steps per second: 194.52
I0901 23:54:30.058561 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 276 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 187.81
I0901 23:54:35.563279 140286289131520 replay_runner.py:36] Average training steps per second: 187.81
I0901 23:54:35.746593 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 9
I0901 23:54:35.934254 140286289131520 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 195.25

Steps executed: 306 Episode length: 156 Return: 156.0
I0901 23:54:41.268289 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 10

Steps executed: 293 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 188.51
I0901 23:54:46.766035 140286289131520 replay_runner.py:36] Average training steps per second: 188.51
I0901 23:54:46.937366 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 11

Steps executed: 289 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 198.44
I0901 23:54:52.171575 140286289131520 replay_runner.py:36] Average training steps per second: 198.44
I0901 23:54:52.367608 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 12

Steps executed: 229 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 187.91
I0901 23:54:57.880389 140286289131520 replay_runner.py:36] Average training steps per second: 187.91
I0901 23:54:58.024731 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 13

Steps executed: 242 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 191.44
I0901 23:55:03.434257 140286289131520 replay_runner.py:36] Average training steps per second: 191.44
I0901 23:55:03.599807 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.00
INFO:tensorflow:Starting iteration 14

Steps executed: 275 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 189.73
I0901 23:55:09.066932 140286289131520 replay_runner.py:36] Average training steps per second: 189.73
I0901 23:55:09.245106 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 15

Steps executed: 240 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 191.64
I0901 23:55:14.654556 140286289131520 replay_runner.py:36] Average training steps per second: 191.64
I0901 23:55:14.830646 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.77
I0901 23:55:20.200389 140286289131520 replay_runner.py:36] Average training steps per second: 192.77
I0901 23:55:20.324929 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:55:20.513214 140286289131520 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 186.32
I0901 23:55:25.880925 140286289131520 replay_runner.py:36] Average training steps per second: 186.32
I0901 23:55:26.019886 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:55:26.213295 140286289131520 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.35
I0901 23:55:31.385969 140286289131520 replay_runner.py:36] Average training steps per second: 193.35
I0901 23:55:31.535978 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:55:31.728965 140286289131520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 183.19
I0901 23:55:37.188299 140286289131520 replay_runner.py:36] Average training steps per second: 183.19
I0901 23:55:37.332954 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:55:37.528146 140286289131520 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.20
I0901 23:55:42.704591 140286289131520 replay_runner.py:36] Average training steps per second: 193.20
I0901 23:55:42.845318 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:55:43.039237 140286289131520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 189.55
I0901 23:55:48.315166 140286289131520 replay_runner.py:36] Average training steps per second: 189.55
I0901 23:55:48.442237 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:55:48.626610 140286289131520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 203.01
I0901 23:55:53.552746 140286289131520 replay_runner.py:36] Average training steps per second: 203.01
I0901 23:55:53.701425 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:55:53.892245 140286289131520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 187.83
I0901 23:55:59.216403 140286289131520 replay_runner.py:36] Average training steps per second: 187.83
I0901 23:55:59.340166 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.87
I0901 23:56:04.450724 140286289131520 replay_runner.py:36] Average training steps per second: 202.87
I0901 23:56:04.717001 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.63
I0901 23:56:10.145153 140286289131520 replay_runner.py:36] Average training steps per second: 190.63
I0901 23:56:10.278263 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:56:10.456781 140286289131520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.29
I0901 23:56:15.500310 140286289131520 replay_runner.py:36] Average training steps per second: 198.29
I0901 23:56:15.635001 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:56:15.836532 140286289131520 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.76
I0901 23:56:21.107301 140286289131520 replay_runner.py:36] Average training steps per second: 189.76
I0901 23:56:21.232126 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:56:21.415958 140286289131520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 197.50
I0901 23:56:26.479767 140286289131520 replay_runner.py:36] Average training steps per second: 197.50
I0901 23:56:26.611024 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.58
I0901 23:56:32.096913 140286289131520 replay_runner.py:36] Average training steps per second: 188.58
I0901 23:56:32.220745 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00