Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0902 00:02:52.049860 139639256991744 run_experiment.py:549] Creating TrainRunner ...
I0902 00:02:52.058525 139639256991744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:02:52.058708 139639256991744 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:02:52.058804 139639256991744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:02:52.058880 139639256991744 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:02:52.058979 139639256991744 dqn_agent.py:275] 	 update_period: 4
I0902 00:02:52.059081 139639256991744 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:02:52.059203 139639256991744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:02:52.059365 139639256991744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:02:52.059468 139639256991744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:02:52.059654 139639256991744 dqn_agent.py:280] 	 optimizer: adam
I0902 00:02:52.059800 139639256991744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:02:52.059923 139639256991744 dqn_agent.py:283] 	 seed: 1630540972058483
I0902 00:02:52.062973 139639256991744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:02:52.063206 139639256991744 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:02:52.063345 139639256991744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:02:52.063433 139639256991744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:02:52.063511 139639256991744 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:02:52.063582 139639256991744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:02:52.063656 139639256991744 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:02:52.063799 139639256991744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:02:52.063912 139639256991744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:02:52.097008 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:52.504691 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:52.517041 139639256991744 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:02:52.525547 139639256991744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:02:52.525825 139639256991744 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:02:52.526024 139639256991744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:02:52.526178 139639256991744 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:02:52.526269 139639256991744 dqn_agent.py:275] 	 update_period: 4
I0902 00:02:52.526400 139639256991744 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:02:52.526700 139639256991744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:02:52.526862 139639256991744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:02:52.527014 139639256991744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:02:52.527425 139639256991744 dqn_agent.py:280] 	 optimizer: adam
I0902 00:02:52.527560 139639256991744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:02:52.527665 139639256991744 dqn_agent.py:283] 	 seed: 1630540972525498
I0902 00:02:52.530102 139639256991744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:02:52.530238 139639256991744 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:02:52.530313 139639256991744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:02:52.530375 139639256991744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:02:52.530433 139639256991744 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:02:52.530679 139639256991744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:02:52.530846 139639256991744 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:02:52.530963 139639256991744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:02:52.531044 139639256991744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:02:52.600821 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:52.622226 139639256991744 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:02:52.622575 139639256991744 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.33
I0902 00:02:59.319656 139639256991744 replay_runner.py:36] Average training steps per second: 149.33
Steps executed: 263 Episode length: 263 Return: -262.0
I0902 00:03:00.570745 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.00
INFO:tensorflow:Starting iteration 1

Steps executed: 381 Episode length: 381 Return: -380.0
INFO:tensorflow:Average training steps per second: 204.12
I0902 00:03:05.706841 139639256991744 replay_runner.py:36] Average training steps per second: 204.12
I0902 00:03:06.012300 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 208.90
I0902 00:03:11.032014 139639256991744 replay_runner.py:36] Average training steps per second: 208.90
I0902 00:03:11.445557 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 00:03:11.686181 139639256991744 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.75
I0902 00:03:16.874537 139639256991744 replay_runner.py:36] Average training steps per second: 192.75
I0902 00:03:17.290794 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 00:03:17.526349 139639256991744 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 200.83
I0902 00:03:22.506086 139639256991744 replay_runner.py:36] Average training steps per second: 200.83
I0902 00:03:22.927422 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 317 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 197.12
I0902 00:03:28.249195 139639256991744 replay_runner.py:36] Average training steps per second: 197.12
I0902 00:03:28.508172 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.67
INFO:tensorflow:Starting iteration 6

Steps executed: 176 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 198.63

Steps executed: 251 Episode length: 75 Return: -74.0.0
I0902 00:03:33.991094 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.00
I0902 00:03:39.292515 139639256991744 replay_runner.py:36] Average training steps per second: 198.00
I0902 00:03:39.701675 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 00:03:39.936147 139639256991744 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.63
I0902 00:03:44.996304 139639256991744 replay_runner.py:36] Average training steps per second: 197.63
I0902 00:03:45.419246 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 349 Episode length: 167 Return: -166.0
INFO:tensorflow:Average training steps per second: 199.98
I0902 00:03:50.668972 139639256991744 replay_runner.py:36] Average training steps per second: 199.98
I0902 00:03:50.966925 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.33
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.74
I0902 00:03:56.301121 139639256991744 replay_runner.py:36] Average training steps per second: 195.74
I0902 00:03:56.712279 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 205 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 198.27
I0902 00:04:01.998935 139639256991744 replay_runner.py:36] Average training steps per second: 198.27
I0902 00:04:02.166066 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 12

Steps executed: 248 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 195.86
I0902 00:04:07.517398 139639256991744 replay_runner.py:36] Average training steps per second: 195.86
I0902 00:04:07.720144 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 13

Steps executed: 291 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 197.34
I0902 00:04:13.026050 139639256991744 replay_runner.py:36] Average training steps per second: 197.34
I0902 00:04:13.277361 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 14

Steps executed: 213 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 197.83
I0902 00:04:18.578242 139639256991744 replay_runner.py:36] Average training steps per second: 197.83
I0902 00:04:18.754300 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 15

Steps executed: 72 Episode length: 72 Return: -71.00.0
INFO:tensorflow:Average training steps per second: 204.45
I0902 00:04:23.885417 139639256991744 replay_runner.py:36] Average training steps per second: 204.45

Steps executed: 251 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Starting iteration 16

Steps executed: 325 Episode length: 325 Return: -324.0
INFO:tensorflow:Average training steps per second: 198.50
I0902 00:04:29.382918 139639256991744 replay_runner.py:36] Average training steps per second: 198.50
I0902 00:04:29.657120 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.00
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.75
I0902 00:04:35.117673 139639256991744 replay_runner.py:36] Average training steps per second: 191.75
I0902 00:04:35.529129 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 282 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 197.78
I0902 00:04:40.829600 139639256991744 replay_runner.py:36] Average training steps per second: 197.78
I0902 00:04:41.038488 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 19
I0902 00:04:41.271126 139639256991744 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 204.76

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:04:46.572243 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 231 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 202.20
I0902 00:04:51.765595 139639256991744 replay_runner.py:36] Average training steps per second: 202.20
I0902 00:04:51.947049 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 21

Steps executed: 261 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 205.91
I0902 00:04:57.039056 139639256991744 replay_runner.py:36] Average training steps per second: 205.91
I0902 00:04:57.241273 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 22

Steps executed: 82 Episode length: 82 Return: -81.00.0
INFO:tensorflow:Average training steps per second: 212.11

Steps executed: 249 Episode length: 91 Return: -90.0.0
I0902 00:05:02.388299 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 23

Steps executed: 337 Episode length: 175 Return: -174.0
INFO:tensorflow:Average training steps per second: 201.03
I0902 00:05:07.594880 139639256991744 replay_runner.py:36] Average training steps per second: 201.03
I0902 00:05:07.868104 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.33
INFO:tensorflow:Starting iteration 24

Steps executed: 268 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 199.90
I0902 00:05:13.102232 139639256991744 replay_runner.py:36] Average training steps per second: 199.90
I0902 00:05:13.334225 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 25

Steps executed: 312 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 198.50
I0902 00:05:18.603735 139639256991744 replay_runner.py:36] Average training steps per second: 198.50
I0902 00:05:18.854844 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 26

Steps executed: 260 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 200.12
I0902 00:05:24.097826 139639256991744 replay_runner.py:36] Average training steps per second: 200.12
I0902 00:05:24.321165 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 27

Steps executed: 240 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 201.05
I0902 00:05:29.542404 139639256991744 replay_runner.py:36] Average training steps per second: 201.05
I0902 00:05:29.730361 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 28

Steps executed: 216 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 199.93
I0902 00:05:34.964093 139639256991744 replay_runner.py:36] Average training steps per second: 199.93
I0902 00:05:35.144408 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.00
INFO:tensorflow:Starting iteration 29

Steps executed: 241 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 199.56

Done fixed training!Episode length: 71 Return: -70.0.0
I0902 00:05:40.592803 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33