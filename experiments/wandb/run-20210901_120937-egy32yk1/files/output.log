I0901 12:09:44.593333 140460307478528 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 12:09:44.593854 140460307478528 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 12:09:44.671007 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:44.672055 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:44.672138 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:44.672206 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:44.672261 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:44.672346 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:44.672500 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:44.672583 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:44.672661 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:44.672732 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:44.672805 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:44.672876 140460307478528 dqn_agent.py:283] 	 seed: 1630498184670952
I0901 12:09:44.674620 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:44.674780 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:44.674855 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:44.674919 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:44.674976 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:44.675048 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:44.675132 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:44.675192 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:44.675256 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.044428 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 12:09:46.410108 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.420362 140460307478528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:09:46.425636 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:46.425778 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:46.425846 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:46.425929 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:46.426024 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:46.426143 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:46.426224 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:46.426285 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:46.426382 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:46.426483 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:46.426568 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:46.426666 140460307478528 dqn_agent.py:283] 	 seed: 1630498186425605
I0901 12:09:46.428346 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:46.428464 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:46.428541 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:46.428615 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:46.428678 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:46.428738 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:46.428818 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:46.428931 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:46.429083 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.448199 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.462034 140460307478528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:09:46.462247 140460307478528 replay_runner.py:41] Starting iteration 0
Steps executed: 250 Episode length: 119 Return: -290.55243597018836
INFO:tensorflow:Average training steps per second: 171.12
I0901 12:09:52.306193 140460307478528 replay_runner.py:36] Average training steps per second: 171.12
I0901 12:09:53.329273 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.46
INFO:tensorflow:Starting iteration 1

Steps executed: 237 Episode length: 100 Return: -481.47437649645976
INFO:tensorflow:Average training steps per second: 211.05
I0901 12:10:02.297892 140460307478528 replay_runner.py:36] Average training steps per second: 211.05
I0901 12:10:02.551161 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.30
INFO:tensorflow:Starting iteration 2

Steps executed: 274 Episode length: 97 Return: -287.016894109730376
INFO:tensorflow:Average training steps per second: 208.33
I0901 12:10:11.651137 140460307478528 replay_runner.py:36] Average training steps per second: 208.33
I0901 12:10:11.879741 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.28
INFO:tensorflow:Starting iteration 3

Steps executed: 216 Episode length: 122 Return: -228.64755625515147
INFO:tensorflow:Average training steps per second: 210.59
I0901 12:10:21.031453 140460307478528 replay_runner.py:36] Average training steps per second: 210.59
I0901 12:10:21.254023 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -452.75
INFO:tensorflow:Starting iteration 4
I0901 12:10:25.552112 140460307478528 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 214.31

Steps executed: 226 Episode length: 110 Return: -182.34078704867596
I0901 12:10:30.435015 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.99
INFO:tensorflow:Starting iteration 5

Steps executed: 219 Episode length: 100 Return: -243.75710976565614
INFO:tensorflow:Average training steps per second: 211.39
I0901 12:10:39.493257 140460307478528 replay_runner.py:36] Average training steps per second: 211.39
I0901 12:10:39.714473 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.95
INFO:tensorflow:Starting iteration 6

Steps executed: 225 Episode length: 137 Return: 48.6953830838161814
INFO:tensorflow:Average training steps per second: 212.33
I0901 12:10:48.693766 140460307478528 replay_runner.py:36] Average training steps per second: 212.33
I0901 12:10:48.906562 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.14
INFO:tensorflow:Starting iteration 7

Steps executed: 308 Episode length: 110 Return: -156.60287505188534
INFO:tensorflow:Average training steps per second: 214.78
I0901 12:10:57.852072 140460307478528 replay_runner.py:36] Average training steps per second: 214.78
I0901 12:10:58.141644 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.07
INFO:tensorflow:Starting iteration 8

Steps executed: 306 Episode length: 128 Return: -246.75220873376057
INFO:tensorflow:Average training steps per second: 216.70
I0901 12:11:07.053818 140460307478528 replay_runner.py:36] Average training steps per second: 216.70
I0901 12:11:07.365032 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.03
INFO:tensorflow:Starting iteration 9

Steps executed: 214 Episode length: 214 Return: -211.55122211599587
INFO:tensorflow:Average training steps per second: 217.24
I0901 12:11:16.264777 140460307478528 replay_runner.py:36] Average training steps per second: 217.24
I0901 12:11:16.453697 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.55
INFO:tensorflow:Starting iteration 10

Steps executed: 211 Episode length: 77 Return: -141.395409031244077
INFO:tensorflow:Average training steps per second: 214.96
I0901 12:11:25.410203 140460307478528 replay_runner.py:36] Average training steps per second: 214.96
I0901 12:11:25.583596 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.80
INFO:tensorflow:Starting iteration 11
I0901 12:11:29.822058 140460307478528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 215.10

Steps executed: 244 Episode length: 122 Return: -185.97622205691647
I0901 12:11:34.678846 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.28
INFO:tensorflow:Starting iteration 12

Steps executed: 246 Episode length: 124 Return: -314.32872119968537
INFO:tensorflow:Average training steps per second: 217.49
I0901 12:11:43.546017 140460307478528 replay_runner.py:36] Average training steps per second: 217.49
I0901 12:11:43.769153 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.69
INFO:tensorflow:Starting iteration 13

Steps executed: 421 Episode length: 242 Return: -409.28499303157147
INFO:tensorflow:Average training steps per second: 217.10
I0901 12:11:52.708191 140460307478528 replay_runner.py:36] Average training steps per second: 217.10
I0901 12:11:53.166051 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.86
INFO:tensorflow:Starting iteration 14

Steps executed: 204 Episode length: 77 Return: -360.824008869307257
INFO:tensorflow:Average training steps per second: 214.94
I0901 12:12:02.111016 140460307478528 replay_runner.py:36] Average training steps per second: 214.94
I0901 12:12:02.298285 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.40
INFO:tensorflow:Starting iteration 15

Steps executed: 258 Episode length: 105 Return: -495.19750713197664
INFO:tensorflow:Average training steps per second: 212.64
I0901 12:12:11.337428 140460307478528 replay_runner.py:36] Average training steps per second: 212.64
I0901 12:12:11.563093 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.06
INFO:tensorflow:Starting iteration 16

Steps executed: 213 Episode length: 67 Return: -410.632520862622164
INFO:tensorflow:Average training steps per second: 219.66
I0901 12:12:20.387600 140460307478528 replay_runner.py:36] Average training steps per second: 219.66
I0901 12:12:20.556890 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.35
INFO:tensorflow:Starting iteration 17

Steps executed: 240 Episode length: 131 Return: -8.2373004163248424
INFO:tensorflow:Average training steps per second: 218.00
I0901 12:12:29.425780 140460307478528 replay_runner.py:36] Average training steps per second: 218.00
I0901 12:12:29.615831 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.33
INFO:tensorflow:Starting iteration 18

Steps executed: 365 Episode length: 247 Return: -114.49075551206982
INFO:tensorflow:Average training steps per second: 243.99
I0901 12:12:37.908138 140460307478528 replay_runner.py:36] Average training steps per second: 243.99
I0901 12:12:38.217884 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.72
INFO:tensorflow:Starting iteration 19

Steps executed: 330 Episode length: 164 Return: -492.53201045080882
INFO:tensorflow:Average training steps per second: 256.45
I0901 12:12:45.910211 140460307478528 replay_runner.py:36] Average training steps per second: 256.45
I0901 12:12:46.153381 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.34
INFO:tensorflow:Starting iteration 20

Steps executed: 281 Episode length: 116 Return: -609.18559520281042
INFO:tensorflow:Average training steps per second: 245.60
I0901 12:12:54.295788 140460307478528 replay_runner.py:36] Average training steps per second: 245.60
I0901 12:12:54.552574 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -583.77
INFO:tensorflow:Starting iteration 21

Steps executed: 207 Episode length: 120 Return: -548.36599930604462
INFO:tensorflow:Average training steps per second: 229.55
I0901 12:13:03.278984 140460307478528 replay_runner.py:36] Average training steps per second: 229.55
I0901 12:13:03.480981 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -627.02
INFO:tensorflow:Starting iteration 22

Steps executed: 225 Episode length: 124 Return: -378.92945349849292
INFO:tensorflow:Average training steps per second: 223.41
I0901 12:13:12.266662 140460307478528 replay_runner.py:36] Average training steps per second: 223.41
I0901 12:13:12.478375 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -553.90
INFO:tensorflow:Starting iteration 23

Steps executed: 248 Episode length: 153 Return: -320.38751151043914
INFO:tensorflow:Average training steps per second: 219.20
I0901 12:13:21.360423 140460307478528 replay_runner.py:36] Average training steps per second: 219.20
I0901 12:13:21.565934 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -501.92
INFO:tensorflow:Starting iteration 24

Steps executed: 280 Episode length: 145 Return: -54.635849321816854
INFO:tensorflow:Average training steps per second: 224.77
I0901 12:13:30.374937 140460307478528 replay_runner.py:36] Average training steps per second: 224.77
I0901 12:13:30.617067 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.17
INFO:tensorflow:Starting iteration 25

Steps executed: 212 Episode length: 212 Return: -85.775163481166354
INFO:tensorflow:Average training steps per second: 220.20
I0901 12:13:39.553197 140460307478528 replay_runner.py:36] Average training steps per second: 220.20
I0901 12:13:39.758795 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.78
INFO:tensorflow:Starting iteration 26
I0901 12:13:44.128148 140460307478528 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 222.27
I0901 12:13:48.627932 140460307478528 replay_runner.py:36] Average training steps per second: 222.27

Steps executed: 269 Episode length: 176 Return: -38.519129552461554
INFO:tensorflow:Starting iteration 27

Steps executed: 229 Episode length: 81 Return: -795.647173213708854
INFO:tensorflow:Average training steps per second: 225.21
I0901 12:13:57.697766 140460307478528 replay_runner.py:36] Average training steps per second: 225.21
I0901 12:13:57.911535 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.29
INFO:tensorflow:Starting iteration 28
I0901 12:14:02.284562 140460307478528 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 222.19

Steps executed: 215 Episode length: 140 Return: -479.17210400691744
I0901 12:14:07.003497 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.38
INFO:tensorflow:Starting iteration 29

Steps executed: 426 Episode length: 306 Return: 242.463592991837126
INFO:tensorflow:Average training steps per second: 226.26
I0901 12:14:15.769877 140460307478528 replay_runner.py:36] Average training steps per second: 226.26

Done fixed training!Episode length: 306 Return: 242.463592991837126