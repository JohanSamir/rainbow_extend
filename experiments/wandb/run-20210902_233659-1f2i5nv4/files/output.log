Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:37:05.620341 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:37:05.631341 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:37:05.631533 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:37:05.631611 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:37:05.631671 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:37:05.631727 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:37:05.631784 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:37:05.631871 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:37:05.631968 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:37:05.632049 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:37:05.632113 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:37:05.632193 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:37:05.632263 140170650351616 dqn_agent.py:283] 	 seed: 1630625825631278
I0902 23:37:05.634607 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:37:05.634799 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:37:05.634906 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:37:05.635032 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:37:05.635178 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:37:05.635316 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:37:05.635429 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:37:05.635559 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:37:05.635874 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:37:05.680981 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:06.244708 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:06.259218 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:37:06.269492 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:37:06.269993 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:37:06.270213 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:37:06.270377 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:37:06.270511 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:37:06.270629 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:37:06.270753 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:37:06.270876 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:37:06.270996 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:37:06.271254 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:37:06.271453 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:37:06.271594 140170650351616 dqn_agent.py:283] 	 seed: 1630625826269414
I0902 23:37:06.274732 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:37:06.275078 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:37:06.275227 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:37:06.275323 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:37:06.275434 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:37:06.275770 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:37:06.275947 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:37:06.276121 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:37:06.276251 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:37:06.309959 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:06.333902 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:37:06.334258 140170650351616 replay_runner.py:41] Starting iteration 0
Steps executed: 296 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 143.41
I0902 23:37:13.307502 140170650351616 replay_runner.py:36] Average training steps per second: 143.41
I0902 23:37:14.542454 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 98.67
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.53
I0902 23:37:19.895669 140170650351616 replay_runner.py:36] Average training steps per second: 193.53
I0902 23:37:20.028699 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2
I0902 23:37:20.208075 140170650351616 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 196.15
I0902 23:37:25.306400 140170650351616 replay_runner.py:36] Average training steps per second: 196.15
I0902 23:37:25.430722 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:37:25.605588 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.29
I0902 23:37:30.674681 140170650351616 replay_runner.py:36] Average training steps per second: 197.29
I0902 23:37:30.806670 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 363 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.22
I0902 23:37:35.861807 140170650351616 replay_runner.py:36] Average training steps per second: 205.22
I0902 23:37:36.085860 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.50
INFO:tensorflow:Starting iteration 5
I0902 23:37:36.264705 140170650351616 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 199.34
I0902 23:37:41.281537 140170650351616 replay_runner.py:36] Average training steps per second: 199.34

Steps executed: 176 Episode length: 176 Return: 176.0
INFO:tensorflow:Starting iteration 6

Steps executed: 343 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 196.61
I0902 23:37:46.761988 140170650351616 replay_runner.py:36] Average training steps per second: 196.61
I0902 23:37:46.883856 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.53
I0902 23:37:52.253966 140170650351616 replay_runner.py:36] Average training steps per second: 192.53
I0902 23:37:52.466795 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 8

Steps executed: 346 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 204.58
I0902 23:37:57.535056 140170650351616 replay_runner.py:36] Average training steps per second: 204.58
I0902 23:37:57.792298 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 9

Steps executed: 390 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.72
I0902 23:38:03.296112 140170650351616 replay_runner.py:36] Average training steps per second: 187.72
I0902 23:38:03.497511 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 10

Steps executed: 290 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 200.71
I0902 23:38:08.669862 140170650351616 replay_runner.py:36] Average training steps per second: 200.71
I0902 23:38:08.904094 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 11

Steps executed: 343 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 194.68
I0902 23:38:14.235335 140170650351616 replay_runner.py:36] Average training steps per second: 194.68
I0902 23:38:14.368511 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.58
I0902 23:38:19.724326 140170650351616 replay_runner.py:36] Average training steps per second: 193.58
I0902 23:38:19.863201 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0902 23:38:20.058904 140170650351616 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.60
I0902 23:38:25.224661 140170650351616 replay_runner.py:36] Average training steps per second: 193.60
I0902 23:38:25.494813 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 14

Steps executed: 396 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 189.40
I0902 23:38:30.969025 140170650351616 replay_runner.py:36] Average training steps per second: 189.40
I0902 23:38:31.171567 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 15

Steps executed: 292 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 191.63
I0902 23:38:36.579068 140170650351616 replay_runner.py:36] Average training steps per second: 191.63
I0902 23:38:36.827498 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 16

Steps executed: 323 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 187.34
I0902 23:38:42.377135 140170650351616 replay_runner.py:36] Average training steps per second: 187.34
I0902 23:38:42.591456 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 17

Steps executed: 323 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 186.82
I0902 23:38:48.135112 140170650351616 replay_runner.py:36] Average training steps per second: 186.82
I0902 23:38:48.275101 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18


Steps executed: 181 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 202.45
I0902 23:38:53.415453 140170650351616 replay_runner.py:36] Average training steps per second: 202.45

Steps executed: 381 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.66
I0902 23:38:59.289689 140170650351616 replay_runner.py:36] Average training steps per second: 185.66
I0902 23:38:59.421304 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:38:59.590853 140170650351616 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.07
I0902 23:39:04.665578 140170650351616 replay_runner.py:36] Average training steps per second: 197.07
I0902 23:39:04.808871 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:39:05.007914 140170650351616 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.71
I0902 23:39:10.015611 140170650351616 replay_runner.py:36] Average training steps per second: 199.71
I0902 23:39:10.157155 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:39:10.445979 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 186.23
I0902 23:39:15.816079 140170650351616 replay_runner.py:36] Average training steps per second: 186.23
I0902 23:39:15.967240 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:39:16.149113 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.56
I0902 23:39:21.211200 140170650351616 replay_runner.py:36] Average training steps per second: 197.56
I0902 23:39:21.350375 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:39:21.550146 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 192.91
I0902 23:39:26.734245 140170650351616 replay_runner.py:36] Average training steps per second: 192.91
I0902 23:39:26.876624 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:39:27.053731 140170650351616 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 199.58
I0902 23:39:32.064574 140170650351616 replay_runner.py:36] Average training steps per second: 199.58
I0902 23:39:32.199787 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:39:32.389756 140170650351616 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.67
I0902 23:39:37.474738 140170650351616 replay_runner.py:36] Average training steps per second: 196.67
I0902 23:39:37.611045 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:39:37.794663 140170650351616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.15
I0902 23:39:42.999229 140170650351616 replay_runner.py:36] Average training steps per second: 192.15
I0902 23:39:43.146374 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:39:43.324805 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 202.06
I0902 23:39:48.274363 140170650351616 replay_runner.py:36] Average training steps per second: 202.06
I0902 23:39:48.403473 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:39:48.591498 140170650351616 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 195.67
I0902 23:39:53.702640 140170650351616 replay_runner.py:36] Average training steps per second: 195.67

Done fixed training!Episode length: 200 Return: 200.0