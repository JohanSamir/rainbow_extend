Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0901 13:18:42.123126 139803418769408 run_experiment.py:549] Creating TrainRunner ...
I0901 13:18:42.132013 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:18:42.132170 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:18:42.132266 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:18:42.132349 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:18:42.132434 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:18:42.132511 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:18:42.132670 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:18:42.132807 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:18:42.132913 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:18:42.132988 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:18:42.133094 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:18:42.133209 139803418769408 dqn_agent.py:283] 	 seed: 1630502322131972
I0901 13:18:42.135769 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:18:42.135885 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:18:42.135958 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:18:42.136021 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:18:42.136078 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:18:42.136164 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:18:42.136230 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:18:42.136293 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:18:42.136373 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:18:42.167036 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:18:42.425606 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:18:42.436047 139803418769408 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:18:42.443614 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:18:42.443796 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:18:42.443895 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:18:42.443976 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:18:42.444077 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:18:42.444277 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:18:42.444456 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:18:42.444596 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:18:42.444683 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:18:42.444758 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:18:42.444964 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:18:42.445099 139803418769408 dqn_agent.py:283] 	 seed: 1630502322443552
I0901 13:18:42.446800 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:18:42.446923 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:18:42.446999 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:18:42.447067 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:18:42.447132 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:18:42.447199 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:18:42.447269 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:18:42.447338 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:18:42.447462 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:18:42.470591 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:18:42.487045 139803418769408 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:18:42.487202 139803418769408 replay_runner.py:41] Starting iteration 0
Steps executed: 268 Episode length: 80 Return: -157.90492686677857
INFO:tensorflow:Average training steps per second: 241.77
I0901 13:18:46.623472 139803418769408 replay_runner.py:36] Average training steps per second: 241.77
I0901 13:18:47.405639 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.86
INFO:tensorflow:Starting iteration 1
I0901 13:18:50.761714 139803418769408 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 347.20

Steps executed: 255 Episode length: 109 Return: -395.42332872524133
I0901 13:18:53.795894 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.74
INFO:tensorflow:Starting iteration 2

Steps executed: 371 Episode length: 178 Return: -386.75323213136523
INFO:tensorflow:Average training steps per second: 312.58
I0901 13:19:00.228178 139803418769408 replay_runner.py:36] Average training steps per second: 312.58
I0901 13:19:00.459541 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.97
INFO:tensorflow:Starting iteration 3

Steps executed: 220 Episode length: 134 Return: -293.29930523102917
INFO:tensorflow:Average training steps per second: 332.27
I0901 13:19:06.795945 139803418769408 replay_runner.py:36] Average training steps per second: 332.27
I0901 13:19:06.921368 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.64
INFO:tensorflow:Starting iteration 4

Steps executed: 251 Episode length: 104 Return: -64.395234541998897
INFO:tensorflow:Average training steps per second: 337.24
I0901 13:19:13.152040 139803418769408 replay_runner.py:36] Average training steps per second: 337.24
I0901 13:19:13.302623 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.15
INFO:tensorflow:Starting iteration 5

Steps executed: 262 Episode length: 91 Return: -338.632842560107497
INFO:tensorflow:Average training steps per second: 365.30
I0901 13:19:19.233537 139803418769408 replay_runner.py:36] Average training steps per second: 365.30
I0901 13:19:19.381850 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.62
INFO:tensorflow:Starting iteration 6

Steps executed: 207 Episode length: 104 Return: -150.28450142174705
INFO:tensorflow:Average training steps per second: 341.28
I0901 13:19:25.682395 139803418769408 replay_runner.py:36] Average training steps per second: 341.28
I0901 13:19:25.802980 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.08
INFO:tensorflow:Starting iteration 7

Steps executed: 982 Episode length: 886 Return: -419.76700277233105
INFO:tensorflow:Average training steps per second: 326.81
I0901 13:19:32.270096 139803418769408 replay_runner.py:36] Average training steps per second: 326.81
I0901 13:19:33.619877 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.95
INFO:tensorflow:Starting iteration 8
I0901 13:19:37.007238 139803418769408 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 330.80

Steps executed: 1000 Episode length: 1000 Return: -102.5659885660871
I0901 13:19:41.610781 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.57
INFO:tensorflow:Starting iteration 9
I0901 13:19:45.002440 139803418769408 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 350.01

Steps executed: 396 Episode length: 396 Return: -285.639182955107771
I0901 13:19:48.282821 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.64
INFO:tensorflow:Starting iteration 10

Steps executed: 267 Episode length: 73 Return: -147.0004698395868171
INFO:tensorflow:Average training steps per second: 343.80
I0901 13:19:54.661226 139803418769408 replay_runner.py:36] Average training steps per second: 343.80
I0901 13:19:54.798616 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.45
INFO:tensorflow:Starting iteration 11

Steps executed: 580 Episode length: 580 Return: -384.576738152950771
INFO:tensorflow:Average training steps per second: 336.06
I0901 13:20:01.271016 139803418769408 replay_runner.py:36] Average training steps per second: 336.06
I0901 13:20:01.983891 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.58
INFO:tensorflow:Starting iteration 12

Steps executed: 683 Episode length: 683 Return: 79.96982478276156771
INFO:tensorflow:Average training steps per second: 327.52
I0901 13:20:08.463746 139803418769408 replay_runner.py:36] Average training steps per second: 327.52
I0901 13:20:09.387262 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.97
INFO:tensorflow:Starting iteration 13

Steps executed: 303 Episode length: 116 Return: -239.420250417124121
INFO:tensorflow:Average training steps per second: 349.69
I0901 13:20:15.757700 139803418769408 replay_runner.py:36] Average training steps per second: 349.69
I0901 13:20:15.946962 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.64
INFO:tensorflow:Starting iteration 14
I0901 13:20:19.439746 139803418769408 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 351.73

Steps executed: 274 Episode length: 90 Return: -35.64889344798435771
I0901 13:20:22.440597 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.82
INFO:tensorflow:Starting iteration 15

Steps executed: 268 Episode length: 118 Return: -138.645469738704971
INFO:tensorflow:Average training steps per second: 339.62
I0901 13:20:28.883166 139803418769408 replay_runner.py:36] Average training steps per second: 339.62
I0901 13:20:29.016500 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.33
INFO:tensorflow:Starting iteration 16

Steps executed: 552 Episode length: 552 Return: -185.520796726816631
INFO:tensorflow:Average training steps per second: 324.11
I0901 13:20:35.528742 139803418769408 replay_runner.py:36] Average training steps per second: 324.11
I0901 13:20:36.263360 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.52
INFO:tensorflow:Starting iteration 17

Steps executed: 664 Episode length: 664 Return: 121.2777298766695631
INFO:tensorflow:Average training steps per second: 333.71
I0901 13:20:42.657083 139803418769408 replay_runner.py:36] Average training steps per second: 333.71
I0901 13:20:43.318162 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.28
INFO:tensorflow:Starting iteration 18

Steps executed: 574 Episode length: 516 Return: -262.409550363615041
INFO:tensorflow:Average training steps per second: 333.50
I0901 13:20:49.754757 139803418769408 replay_runner.py:36] Average training steps per second: 333.50
I0901 13:20:50.363216 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.76
INFO:tensorflow:Starting iteration 19

Steps executed: 304 Episode length: 112 Return: -47.6695093564125241
INFO:tensorflow:Average training steps per second: 333.40
I0901 13:20:56.811840 139803418769408 replay_runner.py:36] Average training steps per second: 333.40
I0901 13:20:56.958460 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.53
INFO:tensorflow:Starting iteration 20

Steps executed: 230 Episode length: 117 Return: -119.948412138548391
INFO:tensorflow:Average training steps per second: 320.05
I0901 13:21:03.473931 139803418769408 replay_runner.py:36] Average training steps per second: 320.05
I0901 13:21:03.602136 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.13
INFO:tensorflow:Starting iteration 21
I0901 13:21:06.868541 139803418769408 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 314.28
I0901 13:21:10.050761 139803418769408 replay_runner.py:36] Average training steps per second: 314.28

Steps executed: 220 Episode length: 107 Return: -14.0878556390681241
INFO:tensorflow:Starting iteration 22

Steps executed: 322 Episode length: 152 Return: -3.01714402747541041
INFO:tensorflow:Average training steps per second: 311.21
I0901 13:21:16.667076 139803418769408 replay_runner.py:36] Average training steps per second: 311.21
I0901 13:21:16.897857 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.02
INFO:tensorflow:Starting iteration 23

Steps executed: 300 Episode length: 148 Return: -28.1078058872143971
INFO:tensorflow:Average training steps per second: 322.42
I0901 13:21:23.344932 139803418769408 replay_runner.py:36] Average training steps per second: 322.42
I0901 13:21:23.530857 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.30
INFO:tensorflow:Starting iteration 24

Steps executed: 127 Episode length: 127 Return: 26.71371786417893271
INFO:tensorflow:Average training steps per second: 316.13
I0901 13:21:30.079154 139803418769408 replay_runner.py:36] Average training steps per second: 316.13

Steps executed: 221 Episode length: 94 Return: -77.22537935913414271
INFO:tensorflow:Starting iteration 25

Steps executed: 216 Episode length: 107 Return: -81.2192445607975871
INFO:tensorflow:Average training steps per second: 319.48
I0901 13:21:36.752834 139803418769408 replay_runner.py:36] Average training steps per second: 319.48
I0901 13:21:36.879593 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 26
I0901 13:21:40.287884 139803418769408 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 325.96

Steps executed: 1000 Episode length: 1000 Return: -62.07390254296148
I0901 13:21:45.325238 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.07
INFO:tensorflow:Starting iteration 27

Steps executed: 135 Episode length: 135 Return: -877.256757256011548
INFO:tensorflow:Average training steps per second: 329.88

Steps executed: 1003 Episode length: 868 Return: -786.53215610522668
I0901 13:21:53.335912 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -831.89
INFO:tensorflow:Starting iteration 28

Steps executed: 253 Episode length: 125 Return: -225.977990136609388
INFO:tensorflow:Average training steps per second: 309.21
I0901 13:21:59.955069 139803418769408 replay_runner.py:36] Average training steps per second: 309.21
I0901 13:22:00.107803 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.34
INFO:tensorflow:Starting iteration 29

Steps executed: 261 Episode length: 145 Return: -115.590694983383838
INFO:tensorflow:Average training steps per second: 308.71
I0901 13:22:06.654825 139803418769408 replay_runner.py:36] Average training steps per second: 308.71

Done fixed training!Episode length: 145 Return: -115.590694983383838