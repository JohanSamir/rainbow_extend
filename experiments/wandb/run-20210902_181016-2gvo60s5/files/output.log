Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 18:10:23.507380 139977662982144 run_experiment.py:549] Creating TrainRunner ...
I0902 18:10:23.521149 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:10:23.521507 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:10:23.521751 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:10:23.522087 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:10:23.522210 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:10:23.522290 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:10:23.522390 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:10:23.522499 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:10:23.522762 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:10:23.522873 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:10:23.523231 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:10:23.523427 139977662982144 dqn_agent.py:283] 	 seed: 1630606223521075
I0902 18:10:23.525679 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:10:23.525804 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:10:23.525894 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:10:23.525971 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:10:23.526039 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:10:23.526128 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:10:23.526227 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:10:23.526342 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:10:23.526431 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:10:23.568222 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:23.980736 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:24.014967 139977662982144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:10:24.025242 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:10:24.025501 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:10:24.025653 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:10:24.025778 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:10:24.025934 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:10:24.026061 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:10:24.026266 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:10:24.026411 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:10:24.026561 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:10:24.026685 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:10:24.026839 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:10:24.026954 139977662982144 dqn_agent.py:283] 	 seed: 1630606224025191
I0902 18:10:24.029753 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:10:24.029954 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:10:24.030081 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:10:24.030201 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:10:24.030312 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:10:24.030420 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:10:24.030526 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:10:24.030642 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:10:24.030773 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:10:24.064964 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:24.090194 139977662982144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:10:24.090477 139977662982144 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.43
I0902 18:10:30.209680 139977662982144 replay_runner.py:36] Average training steps per second: 163.43
Steps executed: 208 Episode length: 93 Return: -277.714988400525044
I0902 18:10:31.780907 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.10
INFO:tensorflow:Starting iteration 1

Steps executed: 288 Episode length: 103 Return: -200.96143972299302
INFO:tensorflow:Average training steps per second: 217.60
I0902 18:10:40.895327 139977662982144 replay_runner.py:36] Average training steps per second: 217.60
I0902 18:10:41.154451 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.33
INFO:tensorflow:Starting iteration 2

Steps executed: 313 Episode length: 171 Return: -164.65368004533525
INFO:tensorflow:Average training steps per second: 218.88
I0902 18:10:50.063961 139977662982144 replay_runner.py:36] Average training steps per second: 218.88
I0902 18:10:50.366545 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.42
INFO:tensorflow:Starting iteration 3

Steps executed: 210 Episode length: 83 Return: -500.860269233375175
INFO:tensorflow:Average training steps per second: 234.56
I0902 18:10:58.884824 139977662982144 replay_runner.py:36] Average training steps per second: 234.56
I0902 18:10:59.063517 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.96
INFO:tensorflow:Starting iteration 4

Steps executed: 225 Episode length: 106 Return: -441.85774144847256
INFO:tensorflow:Average training steps per second: 240.13
I0902 18:11:07.574382 139977662982144 replay_runner.py:36] Average training steps per second: 240.13
I0902 18:11:07.766495 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.74
INFO:tensorflow:Starting iteration 5

Steps executed: 297 Episode length: 297 Return: -269.94123755697316
INFO:tensorflow:Average training steps per second: 252.07
I0902 18:11:15.798854 139977662982144 replay_runner.py:36] Average training steps per second: 252.07
I0902 18:11:16.120942 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.94
INFO:tensorflow:Starting iteration 6

Steps executed: 345 Episode length: 193 Return: -79.828183422022596
INFO:tensorflow:Average training steps per second: 257.16
I0902 18:11:23.994936 139977662982144 replay_runner.py:36] Average training steps per second: 257.16
I0902 18:11:24.300972 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.80
INFO:tensorflow:Starting iteration 7

Steps executed: 285 Episode length: 147 Return: -201.23425378315456
INFO:tensorflow:Average training steps per second: 258.11
I0902 18:11:32.158492 139977662982144 replay_runner.py:36] Average training steps per second: 258.11
I0902 18:11:32.384349 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.80
INFO:tensorflow:Starting iteration 8

Steps executed: 229 Episode length: 81 Return: -347.812383886311176
INFO:tensorflow:Average training steps per second: 256.09
I0902 18:11:40.208841 139977662982144 replay_runner.py:36] Average training steps per second: 256.09
I0902 18:11:40.396209 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.36
INFO:tensorflow:Starting iteration 9

Steps executed: 283 Episode length: 108 Return: -552.01229016587266
INFO:tensorflow:Average training steps per second: 271.68
I0902 18:11:47.943864 139977662982144 replay_runner.py:36] Average training steps per second: 271.68
I0902 18:11:48.137136 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -476.40
INFO:tensorflow:Starting iteration 10
I0902 18:11:51.942200 139977662982144 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 288.35
I0902 18:11:55.410530 139977662982144 replay_runner.py:36] Average training steps per second: 288.35

Steps executed: 291 Episode length: 145 Return: -348.23617431312755
INFO:tensorflow:Starting iteration 11

Steps executed: 219 Episode length: 66 Return: -186.699598733163015
INFO:tensorflow:Average training steps per second: 307.02
I0902 18:12:02.411174 139977662982144 replay_runner.py:36] Average training steps per second: 307.02
I0902 18:12:02.529604 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.90
INFO:tensorflow:Starting iteration 12

Steps executed: 258 Episode length: 146 Return: -355.31019408824026
INFO:tensorflow:Average training steps per second: 317.12
I0902 18:12:09.174732 139977662982144 replay_runner.py:36] Average training steps per second: 317.12
I0902 18:12:09.336294 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.03
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 80 Return: -126.440507634981166
INFO:tensorflow:Average training steps per second: 322.09
I0902 18:12:15.879811 139977662982144 replay_runner.py:36] Average training steps per second: 322.09
I0902 18:12:16.015153 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.80
INFO:tensorflow:Starting iteration 14

Steps executed: 258 Episode length: 133 Return: -202.26774277437391
INFO:tensorflow:Average training steps per second: 331.76
I0902 18:12:22.420499 139977662982144 replay_runner.py:36] Average training steps per second: 331.76
I0902 18:12:22.567387 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.18
INFO:tensorflow:Starting iteration 15

Steps executed: 271 Episode length: 271 Return: -1387.2746735247881
INFO:tensorflow:Average training steps per second: 331.06
I0902 18:12:28.998670 139977662982144 replay_runner.py:36] Average training steps per second: 331.06
I0902 18:12:29.249101 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -1387.27
INFO:tensorflow:Starting iteration 16

Steps executed: 535 Episode length: 535 Return: -2186.9680650960381
INFO:tensorflow:Average training steps per second: 326.36
I0902 18:12:35.680102 139977662982144 replay_runner.py:36] Average training steps per second: 326.36
I0902 18:12:36.371134 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -2186.97
INFO:tensorflow:Starting iteration 17

Steps executed: 202 Episode length: 202 Return: -501.23553111193354
INFO:tensorflow:Average training steps per second: 326.90
I0902 18:12:42.798088 139977662982144 replay_runner.py:36] Average training steps per second: 326.90
I0902 18:12:42.921130 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -501.24
INFO:tensorflow:Starting iteration 18

Steps executed: 275 Episode length: 81 Return: -124.616478638566724
INFO:tensorflow:Average training steps per second: 319.59
I0902 18:12:49.425096 139977662982144 replay_runner.py:36] Average training steps per second: 319.59
I0902 18:12:49.570615 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.99
INFO:tensorflow:Starting iteration 19

Steps executed: 210 Episode length: 210 Return: -253.28824377956732
INFO:tensorflow:Average training steps per second: 333.53
I0902 18:12:55.934426 139977662982144 replay_runner.py:36] Average training steps per second: 333.53
I0902 18:12:56.071391 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.29
INFO:tensorflow:Starting iteration 20

Steps executed: 262 Episode length: 262 Return: -318.95694191356722
INFO:tensorflow:Average training steps per second: 343.35
I0902 18:13:02.393850 139977662982144 replay_runner.py:36] Average training steps per second: 343.35
I0902 18:13:02.632098 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.96
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 101 Return: -280.60773013498454
INFO:tensorflow:Average training steps per second: 355.02
I0902 18:13:08.921910 139977662982144 replay_runner.py:36] Average training steps per second: 355.02
I0902 18:13:09.028997 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.14
INFO:tensorflow:Starting iteration 22

Steps executed: 131 Episode length: 131 Return: -33.760654797630636
INFO:tensorflow:Average training steps per second: 328.02

Steps executed: 536 Episode length: 405 Return: -158.28265454802033
I0902 18:13:15.900171 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.02
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 111 Return: -245.48811679755056
INFO:tensorflow:Average training steps per second: 336.43
I0902 18:13:22.274616 139977662982144 replay_runner.py:36] Average training steps per second: 336.43
I0902 18:13:22.383193 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.82
INFO:tensorflow:Starting iteration 24

Steps executed: 294 Episode length: 109 Return: -6.4504706494584246
INFO:tensorflow:Average training steps per second: 332.94
I0902 18:13:28.839033 139977662982144 replay_runner.py:36] Average training steps per second: 332.94
I0902 18:13:28.996650 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.36
INFO:tensorflow:Starting iteration 25

Steps executed: 282 Episode length: 104 Return: -117.37968554116557
INFO:tensorflow:Average training steps per second: 339.45
I0902 18:13:35.386651 139977662982144 replay_runner.py:36] Average training steps per second: 339.45
I0902 18:13:35.548384 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.05
INFO:tensorflow:Starting iteration 26

Steps executed: 103 Episode length: 103 Return: -47.182672693157717
INFO:tensorflow:Average training steps per second: 351.46
I0902 18:13:41.814927 139977662982144 replay_runner.py:36] Average training steps per second: 351.46

Steps executed: 225 Episode length: 122 Return: -45.198583473825727
INFO:tensorflow:Starting iteration 27
I0902 18:13:45.186644 139977662982144 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 353.71
I0902 18:13:48.014171 139977662982144 replay_runner.py:36] Average training steps per second: 353.71

Steps executed: 1000 Episode length: 1000 Return: -11.898633040195087
INFO:tensorflow:Starting iteration 28
I0902 18:13:53.165995 139977662982144 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 349.49

Steps executed: 250 Episode length: 150 Return: -455.2460649229306687
I0902 18:13:56.186341 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.61
INFO:tensorflow:Starting iteration 29

Steps executed: 318 Episode length: 318 Return: -335.3740016751555787
INFO:tensorflow:Average training steps per second: 325.39
I0902 18:14:02.334233 139977662982144 replay_runner.py:36] Average training steps per second: 325.39

Done fixed training!Episode length: 318 Return: -335.3740016751555787