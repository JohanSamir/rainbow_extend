I0905 16:29:09.920286 140566129469440 run_experiment.py:549] Creating TrainRunner ...
I0905 16:29:09.927191 140566129469440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:09.927335 140566129469440 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:09.927417 140566129469440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:09.927516 140566129469440 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:09.927584 140566129469440 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:09.927694 140566129469440 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:09.927807 140566129469440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:09.927974 140566129469440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:09.928101 140566129469440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:09.928217 140566129469440 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:09.928355 140566129469440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:09.928500 140566129469440 dqn_agent.py:283] 	 seed: 1630859349927147
I0905 16:29:09.930925 140566129469440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:09.931051 140566129469440 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:09.931148 140566129469440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:09.931232 140566129469440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:09.931332 140566129469440 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:09.931414 140566129469440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:09.931522 140566129469440 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:09.931619 140566129469440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:09.931724 140566129469440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:29:11.357154 140566129469440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in cartpole
Training fixed agent 5, please be patient, may be a while...
I0905 16:29:11.703736 140566129469440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:11.712932 140566129469440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:29:11.719087 140566129469440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:11.719241 140566129469440 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:11.719324 140566129469440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:11.719395 140566129469440 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:11.719452 140566129469440 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:11.719512 140566129469440 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:11.719564 140566129469440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:11.719651 140566129469440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:11.719722 140566129469440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:11.719808 140566129469440 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:11.719883 140566129469440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:11.719940 140566129469440 dqn_agent.py:283] 	 seed: 1630859351719052
I0905 16:29:11.721418 140566129469440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:11.721538 140566129469440 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:11.721609 140566129469440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:11.721671 140566129469440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:11.721727 140566129469440 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:11.721786 140566129469440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:11.721861 140566129469440 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:11.721940 140566129469440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:11.722009 140566129469440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:29:11.745513 140566129469440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:11.759755 140566129469440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:29:11.759931 140566129469440 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 183.12
I0905 16:29:17.221216 140566129469440 replay_runner.py:36] Average training steps per second: 183.12
Steps executed: 200 Episode length: 10 Return: 10.0
I0905 16:29:18.085430 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 1

Steps executed: 280 Episode length: 100 Return: 100.0
INFO:tensorflow:Average training steps per second: 211.27
I0905 16:29:22.989731 140566129469440 replay_runner.py:36] Average training steps per second: 211.27
I0905 16:29:23.155810 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.33
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 218.51
I0905 16:29:27.944809 140566129469440 replay_runner.py:36] Average training steps per second: 218.51
I0905 16:29:28.071630 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0905 16:29:28.250341 140566129469440 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 205.62
I0905 16:29:33.114024 140566129469440 replay_runner.py:36] Average training steps per second: 205.62
I0905 16:29:33.238435 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0905 16:29:33.410899 140566129469440 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 207.50
I0905 16:29:38.230589 140566129469440 replay_runner.py:36] Average training steps per second: 207.50
I0905 16:29:38.362511 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 353 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 203.40
I0905 16:29:43.466314 140566129469440 replay_runner.py:36] Average training steps per second: 203.40
I0905 16:29:43.689996 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.16
I0905 16:29:48.726029 140566129469440 replay_runner.py:36] Average training steps per second: 206.16
I0905 16:29:48.848866 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0905 16:29:49.030699 140566129469440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 207.17
I0905 16:29:53.858424 140566129469440 replay_runner.py:36] Average training steps per second: 207.17
I0905 16:29:54.072955 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 8


Steps executed: 315 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 206.87
I0905 16:29:59.093439 140566129469440 replay_runner.py:36] Average training steps per second: 206.87
I0905 16:29:59.290241 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 9

Steps executed: 280 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 208.10
I0905 16:30:04.276990 140566129469440 replay_runner.py:36] Average training steps per second: 208.10
I0905 16:30:04.453942 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.00
INFO:tensorflow:Starting iteration 10
I0905 16:30:04.638140 140566129469440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 208.01
I0905 16:30:09.446081 140566129469440 replay_runner.py:36] Average training steps per second: 208.01
I0905 16:30:09.651256 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 11

Steps executed: 322 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 204.31
I0905 16:30:14.719617 140566129469440 replay_runner.py:36] Average training steps per second: 204.31
I0905 16:30:14.914838 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 12


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.37
I0905 16:30:19.917654 140566129469440 replay_runner.py:36] Average training steps per second: 207.37
I0905 16:30:20.048324 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0905 16:30:20.232720 140566129469440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 207.96
I0905 16:30:25.041904 140566129469440 replay_runner.py:36] Average training steps per second: 207.96
I0905 16:30:25.250057 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 14

Steps executed: 338 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 206.51
I0905 16:30:30.275768 140566129469440 replay_runner.py:36] Average training steps per second: 206.51
I0905 16:30:30.523465 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 15

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.07
I0905 16:30:35.607990 140566129469440 replay_runner.py:36] Average training steps per second: 204.07

Steps executed: 330 Episode length: 172 Return: 172.0
INFO:tensorflow:Starting iteration 16
I0905 16:30:36.012531 140566129469440 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 211.56
I0905 16:30:40.739645 140566129469440 replay_runner.py:36] Average training steps per second: 211.56
I0905 16:30:40.865873 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 212.06
I0905 16:30:45.761167 140566129469440 replay_runner.py:36] Average training steps per second: 212.06
I0905 16:30:45.890453 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 16:30:46.065805 140566129469440 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 209.23
I0905 16:30:50.845551 140566129469440 replay_runner.py:36] Average training steps per second: 209.23
I0905 16:30:50.972925 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 16:30:51.157813 140566129469440 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 209.57
I0905 16:30:55.929991 140566129469440 replay_runner.py:36] Average training steps per second: 209.57
I0905 16:30:56.054542 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 16:30:56.239448 140566129469440 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 210.23
I0905 16:31:00.996513 140566129469440 replay_runner.py:36] Average training steps per second: 210.23
I0905 16:31:01.228449 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 21

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.85
I0905 16:31:06.201874 140566129469440 replay_runner.py:36] Average training steps per second: 208.85
I0905 16:31:06.326433 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.69
I0905 16:31:11.301821 140566129469440 replay_runner.py:36] Average training steps per second: 208.69
I0905 16:31:11.468542 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 23

Steps executed: 264 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 204.23
I0905 16:31:16.543905 140566129469440 replay_runner.py:36] Average training steps per second: 204.23
I0905 16:31:16.773343 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 24

Steps executed: 381 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.19
I0905 16:31:21.810623 140566129469440 replay_runner.py:36] Average training steps per second: 206.19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 25
I0905 16:31:22.108643 140566129469440 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.10
I0905 16:31:26.984736 140566129469440 replay_runner.py:36] Average training steps per second: 205.10
I0905 16:31:27.105516 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0905 16:31:27.283199 140566129469440 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 204.77
I0905 16:31:32.167300 140566129469440 replay_runner.py:36] Average training steps per second: 204.77
I0905 16:31:32.295843 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:31:32.475957 140566129469440 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 207.51
I0905 16:31:37.295527 140566129469440 replay_runner.py:36] Average training steps per second: 207.51
I0905 16:31:37.424142 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 16:31:37.603351 140566129469440 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 210.29
I0905 16:31:42.359484 140566129469440 replay_runner.py:36] Average training steps per second: 210.29
I0905 16:31:42.476092 140566129469440 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0905 16:31:42.656274 140566129469440 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 209.59
I0905 16:31:47.428054 140566129469440 replay_runner.py:36] Average training steps per second: 209.59

Done fixed training!Episode length: 200 Return: 200.0