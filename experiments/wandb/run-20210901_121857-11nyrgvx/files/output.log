Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 12:19:04.290924 140583573075968 run_experiment.py:549] Creating TrainRunner ...
I0901 12:19:04.300606 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:04.300909 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:04.301064 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:04.301198 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:04.301378 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:04.301519 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:04.302000 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:04.302176 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:04.302309 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:04.302446 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:04.302567 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:04.303039 140583573075968 dqn_agent.py:283] 	 seed: 1630498744300525
I0901 12:19:04.306418 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:04.306635 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:04.306797 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:04.307000 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:04.307232 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:04.307470 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:04.307610 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:04.307717 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:04.307804 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:04.530740 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:04.992887 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.007247 140583573075968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:19:05.015318 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:05.015559 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:05.015697 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:05.015869 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:05.016010 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:05.016129 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:05.016242 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:05.016371 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:05.016487 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:05.016669 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:05.016786 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:05.016904 140583573075968 dqn_agent.py:283] 	 seed: 1630498745015262
I0901 12:19:05.019574 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:05.019766 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:05.019926 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:05.020095 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:05.020219 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:05.020333 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:05.020445 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:05.020617 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:05.020736 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:05.057717 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.081293 140583573075968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:19:05.081566 140583573075968 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.95
I0901 12:19:11.795556 140583573075968 replay_runner.py:36] Average training steps per second: 148.95
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:19:13.327941 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:19:13.565659 140583573075968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 198.45
I0901 12:19:18.605227 140583573075968 replay_runner.py:36] Average training steps per second: 198.45
I0901 12:19:19.020777 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:19:19.259082 140583573075968 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 194.01
I0901 12:19:24.413898 140583573075968 replay_runner.py:36] Average training steps per second: 194.01
I0901 12:19:24.861586 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:19:25.103053 140583573075968 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 206.27
I0901 12:19:29.951627 140583573075968 replay_runner.py:36] Average training steps per second: 206.27
I0901 12:19:30.375741 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:19:30.629321 140583573075968 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.87
I0901 12:19:35.709123 140583573075968 replay_runner.py:36] Average training steps per second: 196.87
I0901 12:19:36.141610 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:19:36.389738 140583573075968 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 211.59
I0901 12:19:41.116441 140583573075968 replay_runner.py:36] Average training steps per second: 211.59
I0901 12:19:41.513159 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:19:41.754312 140583573075968 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.76
I0901 12:19:46.862955 140583573075968 replay_runner.py:36] Average training steps per second: 195.76
I0901 12:19:47.305943 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:19:47.535995 140583573075968 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.25
I0901 12:19:52.580644 140583573075968 replay_runner.py:36] Average training steps per second: 198.25
I0901 12:19:52.988691 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:19:53.220989 140583573075968 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 194.22
I0901 12:19:58.370146 140583573075968 replay_runner.py:36] Average training steps per second: 194.22
I0901 12:19:58.801729 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:19:59.035709 140583573075968 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 203.96
I0901 12:20:03.939199 140583573075968 replay_runner.py:36] Average training steps per second: 203.96
I0901 12:20:04.405292 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:20:04.666805 140583573075968 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 200.85
I0901 12:20:09.645970 140583573075968 replay_runner.py:36] Average training steps per second: 200.85
I0901 12:20:10.090462 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:20:10.338214 140583573075968 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 193.69
I0901 12:20:15.501842 140583573075968 replay_runner.py:36] Average training steps per second: 193.69
I0901 12:20:15.938653 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:20:16.190328 140583573075968 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 196.39
I0901 12:20:21.283022 140583573075968 replay_runner.py:36] Average training steps per second: 196.39
I0901 12:20:21.699529 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 640 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.68
I0901 12:20:27.186527 140583573075968 replay_runner.py:36] Average training steps per second: 190.68
I0901 12:20:27.707629 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.50
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.67
I0901 12:20:33.169739 140583573075968 replay_runner.py:36] Average training steps per second: 191.67
I0901 12:20:33.608041 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 12:20:33.852503 140583573075968 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 195.40
I0901 12:20:38.970724 140583573075968 replay_runner.py:36] Average training steps per second: 195.40
I0901 12:20:39.397626 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:20:39.645019 140583573075968 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.95
I0901 12:20:44.748760 140583573075968 replay_runner.py:36] Average training steps per second: 195.95
I0901 12:20:45.197713 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 236 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 196.95
I0901 12:20:50.514315 140583573075968 replay_runner.py:36] Average training steps per second: 196.95
I0901 12:20:50.723290 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 18
I0901 12:20:50.964865 140583573075968 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 196.24
I0901 12:20:56.061141 140583573075968 replay_runner.py:36] Average training steps per second: 196.24

Steps executed: 284 Episode length: 185 Return: -184.0
INFO:tensorflow:Starting iteration 19

Steps executed: 221 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 195.30
I0901 12:21:01.689414 140583573075968 replay_runner.py:36] Average training steps per second: 195.30
I0901 12:21:01.870168 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 20

Steps executed: 230 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 194.21
I0901 12:21:07.259535 140583573075968 replay_runner.py:36] Average training steps per second: 194.21
I0901 12:21:07.468234 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 192.70
I0901 12:21:12.892466 140583573075968 replay_runner.py:36] Average training steps per second: 192.70
I0901 12:21:13.076606 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 22
I0901 12:21:13.335366 140583573075968 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.85
I0901 12:21:18.364957 140583573075968 replay_runner.py:36] Average training steps per second: 198.85

Steps executed: 248 Episode length: 138 Return: -137.0
INFO:tensorflow:Starting iteration 23

Steps executed: 284 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 194.78
I0901 12:21:23.967910 140583573075968 replay_runner.py:36] Average training steps per second: 194.78
I0901 12:21:24.214598 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 24

Steps executed: 309 Episode length: 189 Return: -188.0
INFO:tensorflow:Average training steps per second: 195.74
I0901 12:21:29.557203 140583573075968 replay_runner.py:36] Average training steps per second: 195.74
I0901 12:21:29.819323 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.50
INFO:tensorflow:Starting iteration 25

Steps executed: 232 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 195.05
I0901 12:21:35.195734 140583573075968 replay_runner.py:36] Average training steps per second: 195.05
I0901 12:21:35.389133 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 26
I0901 12:21:35.625263 140583573075968 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 202.41
I0901 12:21:40.566154 140583573075968 replay_runner.py:36] Average training steps per second: 202.41

Steps executed: 214 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Starting iteration 27

Steps executed: 213 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 208.04
I0901 12:21:45.779690 140583573075968 replay_runner.py:36] Average training steps per second: 208.04
I0901 12:21:45.977829 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 28

Steps executed: 316 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 201.26
I0901 12:21:51.170734 140583573075968 replay_runner.py:36] Average training steps per second: 201.26
I0901 12:21:51.425481 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 202.64
I0901 12:21:56.601657 140583573075968 replay_runner.py:36] Average training steps per second: 202.64
I0901 12:21:56.796185 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00