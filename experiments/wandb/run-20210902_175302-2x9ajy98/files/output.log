Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 17:53:09.439561 140643875112960 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:09.450011 140643875112960 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:09.450275 140643875112960 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:09.450431 140643875112960 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:09.450519 140643875112960 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:09.450593 140643875112960 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:09.450667 140643875112960 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:09.450766 140643875112960 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:09.450891 140643875112960 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:09.450995 140643875112960 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:09.451129 140643875112960 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:09.451216 140643875112960 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:09.451308 140643875112960 dqn_agent.py:283] 	 seed: 1630605189449961
I0902 17:53:09.453917 140643875112960 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:09.454090 140643875112960 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:09.454193 140643875112960 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:09.454279 140643875112960 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:09.454355 140643875112960 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:09.454464 140643875112960 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:09.454536 140643875112960 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:09.454587 140643875112960 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:09.454640 140643875112960 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:09.493615 140643875112960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:10.362793 140643875112960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:10.374420 140643875112960 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:10.382664 140643875112960 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:10.382934 140643875112960 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:10.383123 140643875112960 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:10.383262 140643875112960 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:10.383372 140643875112960 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:10.383446 140643875112960 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:10.383549 140643875112960 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:10.383661 140643875112960 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:10.383737 140643875112960 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:10.383846 140643875112960 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:10.383994 140643875112960 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:10.384112 140643875112960 dqn_agent.py:283] 	 seed: 1630605190382610
I0902 17:53:10.386065 140643875112960 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:10.386178 140643875112960 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:10.386244 140643875112960 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:10.386309 140643875112960 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:10.386369 140643875112960 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:10.386450 140643875112960 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:10.386530 140643875112960 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:10.386597 140643875112960 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:10.386651 140643875112960 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:10.417650 140643875112960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:10.438978 140643875112960 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:10.439176 140643875112960 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.68
I0902 17:53:16.821844 140643875112960 replay_runner.py:36] Average training steps per second: 156.68
Steps executed: 205 Episode length: 11 Return: 11.0
I0902 17:53:17.934473 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1

Steps executed: 9 Episode length: 9 Return: 9.011.0
INFO:tensorflow:Average training steps per second: 203.60
I0902 17:53:23.029098 140643875112960 replay_runner.py:36] Average training steps per second: 203.60

Steps executed: 200 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Starting iteration 2

Steps executed: 349 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 201.57
I0902 17:53:28.302848 140643875112960 replay_runner.py:36] Average training steps per second: 201.57
I0902 17:53:28.538563 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 203.59
I0902 17:53:33.643666 140643875112960 replay_runner.py:36] Average training steps per second: 203.59
I0902 17:53:33.781456 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 4

Steps executed: 207 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 207.80
I0902 17:53:38.782881 140643875112960 replay_runner.py:36] Average training steps per second: 207.80
I0902 17:53:38.916689 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.86
INFO:tensorflow:Starting iteration 5

Steps executed: 208 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 209.56
I0902 17:53:43.867150 140643875112960 replay_runner.py:36] Average training steps per second: 209.56
I0902 17:53:43.999383 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.04
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 209.03
I0902 17:53:48.962267 140643875112960 replay_runner.py:36] Average training steps per second: 209.03
I0902 17:53:49.115327 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 7

Steps executed: 205 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 200.44
I0902 17:53:54.287009 140643875112960 replay_runner.py:36] Average training steps per second: 200.44
I0902 17:53:54.441261 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 8

Steps executed: 208 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 197.32
I0902 17:53:59.694633 140643875112960 replay_runner.py:36] Average training steps per second: 197.32
I0902 17:53:59.844465 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 9

Steps executed: 203 Episode length: 8 Return: 8.0.0.0
INFO:tensorflow:Average training steps per second: 205.41
I0902 17:54:04.896764 140643875112960 replay_runner.py:36] Average training steps per second: 205.41
I0902 17:54:05.054015 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 197.41
I0902 17:54:10.343639 140643875112960 replay_runner.py:36] Average training steps per second: 197.41
I0902 17:54:10.489477 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 11

Steps executed: 207 Episode length: 9 Return: 9.0.0.0
INFO:tensorflow:Average training steps per second: 198.87
I0902 17:54:15.713848 140643875112960 replay_runner.py:36] Average training steps per second: 198.87
I0902 17:54:15.858156 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 12
I0902 17:54:16.034753 140643875112960 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 198.06
I0902 17:54:21.084032 140643875112960 replay_runner.py:36] Average training steps per second: 198.06

Steps executed: 205 Episode length: 8 Return: 8.0.0.0
INFO:tensorflow:Starting iteration 13

Steps executed: 202 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 199.78
I0902 17:54:26.420226 140643875112960 replay_runner.py:36] Average training steps per second: 199.78
I0902 17:54:26.562205 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 14

Steps executed: 238 Episode length: 44 Return: 44.0.0
INFO:tensorflow:Average training steps per second: 195.50
I0902 17:54:31.857009 140643875112960 replay_runner.py:36] Average training steps per second: 195.50
I0902 17:54:32.024353 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 34.00
INFO:tensorflow:Starting iteration 15
I0902 17:54:32.219640 140643875112960 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.84
I0902 17:54:37.249210 140643875112960 replay_runner.py:36] Average training steps per second: 198.84

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 16
I0902 17:54:37.561465 140643875112960 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.42
I0902 17:54:42.678954 140643875112960 replay_runner.py:36] Average training steps per second: 195.42
I0902 17:54:42.811546 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 377 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.68
I0902 17:54:48.032811 140643875112960 replay_runner.py:36] Average training steps per second: 198.68
I0902 17:54:48.291902 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.50
INFO:tensorflow:Starting iteration 18
I0902 17:54:48.487715 140643875112960 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 196.62

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 17:54:53.712341 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 351 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 196.27
I0902 17:54:59.003851 140643875112960 replay_runner.py:36] Average training steps per second: 196.27
I0902 17:54:59.249655 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.50
INFO:tensorflow:Starting iteration 20

Steps executed: 338 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 201.55
I0902 17:55:04.408038 140643875112960 replay_runner.py:36] Average training steps per second: 201.55
I0902 17:55:04.638987 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 21

Steps executed: 338 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 198.17
I0902 17:55:09.874947 140643875112960 replay_runner.py:36] Average training steps per second: 198.17
I0902 17:55:10.098488 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 22

Steps executed: 304 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 204.14
I0902 17:55:15.178168 140643875112960 replay_runner.py:36] Average training steps per second: 204.14
I0902 17:55:15.372117 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 23

Steps executed: 321 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 196.94
I0902 17:55:20.632197 140643875112960 replay_runner.py:36] Average training steps per second: 196.94
I0902 17:55:20.840946 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.50
INFO:tensorflow:Starting iteration 24
I0902 17:55:21.019021 140643875112960 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 204.83

Steps executed: 325 Episode length: 184 Return: 184.0
I0902 17:55:26.111968 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 25

Steps executed: 314 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 211.94
I0902 17:55:31.011470 140643875112960 replay_runner.py:36] Average training steps per second: 211.94
I0902 17:55:31.200938 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 26

Steps executed: 392 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.25
I0902 17:55:36.355849 140643875112960 replay_runner.py:36] Average training steps per second: 201.25
I0902 17:55:36.588462 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 27

Steps executed: 382 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.29
I0902 17:55:41.589166 140643875112960 replay_runner.py:36] Average training steps per second: 207.29
I0902 17:55:41.844136 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.00
INFO:tensorflow:Starting iteration 28

Steps executed: 336 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 197.33
I0902 17:55:47.104786 140643875112960 replay_runner.py:36] Average training steps per second: 197.33
I0902 17:55:47.311178 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.37
I0902 17:55:52.514307 140643875112960 replay_runner.py:36] Average training steps per second: 199.37
I0902 17:55:52.642561 140643875112960 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00