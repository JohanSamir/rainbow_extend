Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:34:04.698254 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:34:04.707732 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:04.707958 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:04.708080 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:04.708225 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:04.708330 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:04.708473 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:04.708614 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:04.708786 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:04.708929 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:04.709047 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:04.709162 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:04.709259 140170650351616 dqn_agent.py:283] 	 seed: 1630625644707676
I0902 23:34:04.712128 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:04.712295 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:04.712449 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:04.712515 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:04.712569 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:04.712619 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:04.712667 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:04.712718 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:04.712768 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:04.754587 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:05.298221 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:05.314305 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:34:05.324391 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:05.324692 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:05.324936 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:05.325184 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:05.325480 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:05.325732 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:05.325991 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:05.326227 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:05.326483 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:05.326643 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:05.326798 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:05.326941 140170650351616 dqn_agent.py:283] 	 seed: 1630625645324306
I0902 23:34:05.330181 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:05.330407 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:05.330521 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:05.330647 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:05.330834 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:05.330989 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:05.331105 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:05.331297 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:05.331382 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:05.367473 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:05.392566 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:34:05.392895 140170650351616 replay_runner.py:41] Starting iteration 0
Steps executed: 215 Episode length: 16 Return: 16.0
INFO:tensorflow:Average training steps per second: 140.26
I0902 23:34:12.522879 140170650351616 replay_runner.py:36] Average training steps per second: 140.26
I0902 23:34:13.773117 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.75
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.23
I0902 23:34:19.064200 140170650351616 replay_runner.py:36] Average training steps per second: 196.23
I0902 23:34:19.193066 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2
I0902 23:34:19.362477 140170650351616 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 197.48
I0902 23:34:24.426597 140170650351616 replay_runner.py:36] Average training steps per second: 197.48
I0902 23:34:24.559334 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:34:24.741283 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.70
I0902 23:34:29.749064 140170650351616 replay_runner.py:36] Average training steps per second: 199.70
I0902 23:34:29.880887 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 340 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 200.86
I0902 23:34:35.036374 140170650351616 replay_runner.py:36] Average training steps per second: 200.86
I0902 23:34:35.242370 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 5

Steps executed: 193 Episode length: 193 Return: 193.0
INFO:tensorflow:Average training steps per second: 204.49
I0902 23:34:40.312576 140170650351616 replay_runner.py:36] Average training steps per second: 204.49

Steps executed: 370 Episode length: 177 Return: 177.0
INFO:tensorflow:Starting iteration 6

Steps executed: 314 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 195.03
I0902 23:34:45.857566 140170650351616 replay_runner.py:36] Average training steps per second: 195.03
I0902 23:34:46.061288 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 7

Steps executed: 376 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 189.99
I0902 23:34:51.509976 140170650351616 replay_runner.py:36] Average training steps per second: 189.99
I0902 23:34:51.766637 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.84
I0902 23:34:57.041491 140170650351616 replay_runner.py:36] Average training steps per second: 196.84
I0902 23:34:57.158931 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 129 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 193.10
I0902 23:35:02.521629 140170650351616 replay_runner.py:36] Average training steps per second: 193.10

Steps executed: 266 Episode length: 137 Return: 137.0
INFO:tensorflow:Starting iteration 10

Steps executed: 261 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 199.45
I0902 23:35:07.895376 140170650351616 replay_runner.py:36] Average training steps per second: 199.45
I0902 23:35:08.069933 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 11

Steps executed: 267 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 194.08
I0902 23:35:13.400450 140170650351616 replay_runner.py:36] Average training steps per second: 194.08
I0902 23:35:13.571653 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.50
INFO:tensorflow:Starting iteration 12

Steps executed: 126 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 199.10
I0902 23:35:18.773852 140170650351616 replay_runner.py:36] Average training steps per second: 199.10

Steps executed: 246 Episode length: 120 Return: 120.0
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.74
I0902 23:35:24.390323 140170650351616 replay_runner.py:36] Average training steps per second: 189.74
I0902 23:35:24.528112 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0902 23:35:24.717235 140170650351616 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.38
I0902 23:35:29.888962 140170650351616 replay_runner.py:36] Average training steps per second: 193.38
I0902 23:35:30.024462 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 382 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.22
I0902 23:35:35.394011 140170650351616 replay_runner.py:36] Average training steps per second: 193.22
I0902 23:35:35.638374 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.00
INFO:tensorflow:Starting iteration 16
I0902 23:35:35.821111 140170650351616 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.12
I0902 23:35:40.946735 140170650351616 replay_runner.py:36] Average training steps per second: 195.12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 17
I0902 23:35:41.286042 140170650351616 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.49
I0902 23:35:46.401648 140170650351616 replay_runner.py:36] Average training steps per second: 195.49
I0902 23:35:46.528873 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:35:46.720508 140170650351616 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 186.15
I0902 23:35:52.092986 140170650351616 replay_runner.py:36] Average training steps per second: 186.15
I0902 23:35:52.234043 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:35:52.429826 140170650351616 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.50
I0902 23:35:57.652056 140170650351616 replay_runner.py:36] Average training steps per second: 191.50
I0902 23:35:57.798385 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:35:57.993469 140170650351616 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.69
I0902 23:36:03.265485 140170650351616 replay_runner.py:36] Average training steps per second: 189.69
I0902 23:36:03.400594 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:36:03.587354 140170650351616 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 184.38
I0902 23:36:09.011356 140170650351616 replay_runner.py:36] Average training steps per second: 184.38
I0902 23:36:09.145358 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:36:09.331193 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.20
I0902 23:36:14.561804 140170650351616 replay_runner.py:36] Average training steps per second: 191.20
I0902 23:36:14.692860 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:36:14.878981 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.04
I0902 23:36:20.113991 140170650351616 replay_runner.py:36] Average training steps per second: 191.04
I0902 23:36:20.241377 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:36:20.425013 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.05
I0902 23:36:25.526077 140170650351616 replay_runner.py:36] Average training steps per second: 196.05
I0902 23:36:25.666029 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:36:25.858925 140170650351616 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.78
I0902 23:36:30.941249 140170650351616 replay_runner.py:36] Average training steps per second: 196.78
I0902 23:36:31.068440 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 395 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.85
I0902 23:36:36.353991 140170650351616 replay_runner.py:36] Average training steps per second: 195.85
I0902 23:36:36.631654 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.72
I0902 23:36:42.071106 140170650351616 replay_runner.py:36] Average training steps per second: 190.72
I0902 23:36:42.201920 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:36:42.378214 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.10
I0902 23:36:47.478173 140170650351616 replay_runner.py:36] Average training steps per second: 196.10
I0902 23:36:47.619609 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.83
I0902 23:36:52.816689 140170650351616 replay_runner.py:36] Average training steps per second: 199.83
I0902 23:36:52.943246 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00