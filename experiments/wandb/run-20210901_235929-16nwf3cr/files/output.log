Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0901 23:59:35.887215 139752435963904 run_experiment.py:549] Creating TrainRunner ...
I0901 23:59:35.897900 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:35.898270 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:35.898426 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:35.898516 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:35.898631 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:35.898865 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:59:35.899018 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:35.899103 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:35.899208 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:35.899609 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:35.899786 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:35.899941 139752435963904 dqn_agent.py:283] 	 seed: 1630540775897822
I0901 23:59:35.902985 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:35.903163 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:59:35.903348 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:35.903507 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:35.903594 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:35.903702 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:35.903949 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:35.904119 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:35.904230 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:35.944121 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:36.312782 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:36.328125 139752435963904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:59:36.336016 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:36.336233 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:36.336353 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:36.336559 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:36.336704 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:36.336852 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:59:36.336987 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:36.337093 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:36.337194 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:36.337411 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:36.337530 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:36.337642 139752435963904 dqn_agent.py:283] 	 seed: 1630540776335953
I0901 23:59:36.340455 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:36.340640 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:59:36.340797 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:36.341024 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:36.341176 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:36.341277 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:36.341437 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:36.341547 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:36.341660 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:36.371587 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:36.430072 139752435963904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:59:36.430390 139752435963904 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 171.34
I0901 23:59:42.267291 139752435963904 replay_runner.py:36] Average training steps per second: 171.34
Steps executed: 333 Episode length: 153 Return: -315.0902108782932
I0901 23:59:43.570414 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.73
INFO:tensorflow:Starting iteration 1

Steps executed: 256 Episode length: 123 Return: -406.93696899959626
INFO:tensorflow:Average training steps per second: 245.52
I0901 23:59:51.737096 139752435963904 replay_runner.py:36] Average training steps per second: 245.52
I0901 23:59:51.950170 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.38
INFO:tensorflow:Starting iteration 2

Steps executed: 260 Episode length: 133 Return: -287.97072519247756
INFO:tensorflow:Average training steps per second: 240.11
I0902 00:00:00.391503 139752435963904 replay_runner.py:36] Average training steps per second: 240.11
I0902 00:00:00.616975 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.59
INFO:tensorflow:Starting iteration 3
I0902 00:00:04.863002 139752435963904 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 230.99

Steps executed: 833 Episode length: 833 Return: -441.53323472262876
I0902 00:00:10.625496 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.53
INFO:tensorflow:Starting iteration 4
I0902 00:00:15.070033 139752435963904 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 228.92

Steps executed: 278 Episode length: 278 Return: 17.5971397084889256
I0902 00:00:19.772482 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.60
INFO:tensorflow:Starting iteration 5
I0902 00:00:24.170294 139752435963904 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 230.73

Steps executed: 774 Episode length: 774 Return: -617.54015766631776
I0902 00:00:30.117457 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -617.54
INFO:tensorflow:Starting iteration 6
I0902 00:00:34.403736 139752435963904 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.14

Steps executed: 1000 Episode length: 1000 Return: -44.58023079910302
I0902 00:00:41.923326 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.58
INFO:tensorflow:Starting iteration 7
I0902 00:00:46.306448 139752435963904 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 217.89

Steps executed: 1000 Episode length: 1000 Return: -49.64731820758704
I0902 00:00:53.031341 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.65
INFO:tensorflow:Starting iteration 8
I0902 00:00:57.080394 139752435963904 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 222.54

Steps executed: 1000 Episode length: 1000 Return: -178.59669444459962
I0902 00:01:04.421339 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.60
INFO:tensorflow:Starting iteration 9
I0902 00:01:08.575776 139752435963904 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.72

Steps executed: 1000 Episode length: 1000 Return: -174.46488767511087
I0902 00:01:15.642353 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.46
INFO:tensorflow:Starting iteration 10
I0902 00:01:20.020904 139752435963904 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 231.86

Steps executed: 1000 Episode length: 1000 Return: -136.76422399359287
I0902 00:01:26.377672 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.76
INFO:tensorflow:Starting iteration 11
I0902 00:01:30.777711 139752435963904 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 223.19

Steps executed: 1000 Episode length: 1000 Return: 69.7671089082054687
I0902 00:01:38.405596 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.77
INFO:tensorflow:Starting iteration 12
I0902 00:01:42.734113 139752435963904 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 234.67

Steps executed: 1000 Episode length: 1000 Return: -96.412815075380177
I0902 00:01:50.096479 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.41
INFO:tensorflow:Starting iteration 13
I0902 00:01:54.379060 139752435963904 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 227.32

Steps executed: 1000 Episode length: 1000 Return: -123.88787715644102
I0902 00:02:01.311865 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.89
INFO:tensorflow:Starting iteration 14

Steps executed: 591 Episode length: 591 Return: -124.7877504654094302
INFO:tensorflow:Average training steps per second: 227.25
I0902 00:02:10.016546 139752435963904 replay_runner.py:36] Average training steps per second: 227.25
I0902 00:02:11.183415 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.79
INFO:tensorflow:Starting iteration 15
I0902 00:02:15.407644 139752435963904 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 222.50

Steps executed: 319 Episode length: 319 Return: -191.7314003741029302
I0902 00:02:20.310601 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.73
INFO:tensorflow:Starting iteration 16

Steps executed: 161 Episode length: 161 Return: -199.2902755019688302
INFO:tensorflow:Average training steps per second: 221.11

Steps executed: 880 Episode length: 719 Return: -520.3874887993298302
I0902 00:02:31.519746 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.84
INFO:tensorflow:Starting iteration 17

Steps executed: 319 Episode length: 171 Return: -212.3461703020908302
INFO:tensorflow:Average training steps per second: 222.60
I0902 00:02:40.198767 139752435963904 replay_runner.py:36] Average training steps per second: 222.60
I0902 00:02:40.480973 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.66
INFO:tensorflow:Starting iteration 18

Steps executed: 228 Episode length: 228 Return: -77.52215310808994302
INFO:tensorflow:Average training steps per second: 237.42
I0902 00:02:48.764553 139752435963904 replay_runner.py:36] Average training steps per second: 237.42
I0902 00:02:49.055475 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.52
INFO:tensorflow:Starting iteration 19

Steps executed: 206 Episode length: 142 Return: -173.5571560982680202
INFO:tensorflow:Average training steps per second: 238.22
I0902 00:02:57.436466 139752435963904 replay_runner.py:36] Average training steps per second: 238.22
I0902 00:02:57.613474 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.83
INFO:tensorflow:Starting iteration 20

Steps executed: 237 Episode length: 68 Return: -149.21182188422284702
INFO:tensorflow:Average training steps per second: 228.99
I0902 00:03:06.236929 139752435963904 replay_runner.py:36] Average training steps per second: 228.99
I0902 00:03:06.418057 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.37
INFO:tensorflow:Starting iteration 21

Steps executed: 283 Episode length: 122 Return: -125.7633947924352802
INFO:tensorflow:Average training steps per second: 220.00
I0902 00:03:15.259225 139752435963904 replay_runner.py:36] Average training steps per second: 220.00
I0902 00:03:15.485049 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.06
INFO:tensorflow:Starting iteration 22
I0902 00:03:19.888506 139752435963904 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 231.28

Steps executed: 312 Episode length: 128 Return: -137.3515825854662802
I0902 00:03:24.491073 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.32
INFO:tensorflow:Starting iteration 23

Steps executed: 260 Episode length: 69 Return: -175.59718096905015802
INFO:tensorflow:Average training steps per second: 226.40
I0902 00:03:33.323477 139752435963904 replay_runner.py:36] Average training steps per second: 226.40
I0902 00:03:33.550224 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.47
INFO:tensorflow:Starting iteration 24

Steps executed: 65 Episode length: 65 Return: -287.486172666886915802
INFO:tensorflow:Average training steps per second: 230.40

Steps executed: 290 Episode length: 92 Return: -718.03957909676015802
I0902 00:03:42.467260 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.45
INFO:tensorflow:Starting iteration 25

Steps executed: 218 Episode length: 87 Return: -484.39599819630575602
INFO:tensorflow:Average training steps per second: 227.44
I0902 00:03:51.190913 139752435963904 replay_runner.py:36] Average training steps per second: 227.44
I0902 00:03:51.402741 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.26
INFO:tensorflow:Starting iteration 26

Steps executed: 271 Episode length: 76 Return: -42.099149119814176502
INFO:tensorflow:Average training steps per second: 228.74
I0902 00:04:00.042660 139752435963904 replay_runner.py:36] Average training steps per second: 228.74
I0902 00:04:00.299340 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.11
INFO:tensorflow:Starting iteration 27

Steps executed: 228 Episode length: 113 Return: -57.30356203317665402
INFO:tensorflow:Average training steps per second: 229.59
I0902 00:04:08.946909 139752435963904 replay_runner.py:36] Average training steps per second: 229.59
I0902 00:04:09.168290 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.35
INFO:tensorflow:Starting iteration 28

Steps executed: 217 Episode length: 103 Return: -116.8061925208567402
INFO:tensorflow:Average training steps per second: 222.53
I0902 00:04:17.937758 139752435963904 replay_runner.py:36] Average training steps per second: 222.53
I0902 00:04:18.120123 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.54
INFO:tensorflow:Starting iteration 29

Steps executed: 471 Episode length: 340 Return: 249.66385982241796502
INFO:tensorflow:Average training steps per second: 225.86
I0902 00:04:26.965463 139752435963904 replay_runner.py:36] Average training steps per second: 225.86

Done fixed training!Episode length: 340 Return: 249.66385982241796502