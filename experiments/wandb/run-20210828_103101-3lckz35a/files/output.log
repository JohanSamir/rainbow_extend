Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0828 10:31:08.153536 140527252379648 run_experiment.py:549] Creating TrainRunner ...
I0828 10:31:08.163575 140527252379648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:31:08.163803 140527252379648 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:31:08.163919 140527252379648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:31:08.163999 140527252379648 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:31:08.164118 140527252379648 dqn_agent.py:275] 	 update_period: 4
I0828 10:31:08.164183 140527252379648 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:31:08.164292 140527252379648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:31:08.164349 140527252379648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:31:08.164619 140527252379648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:31:08.164781 140527252379648 dqn_agent.py:280] 	 optimizer: adam
I0828 10:31:08.164898 140527252379648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:31:08.164995 140527252379648 dqn_agent.py:283] 	 seed: 1630146668163523
I0828 10:31:08.167810 140527252379648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:31:08.167945 140527252379648 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:31:08.168211 140527252379648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:31:08.168551 140527252379648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:31:08.168824 140527252379648 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:31:08.169155 140527252379648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:31:08.169373 140527252379648 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:31:08.169593 140527252379648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:31:08.169750 140527252379648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:31:08.211843 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:08.949635 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:08.962131 140527252379648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:31:08.968751 140527252379648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:31:08.968955 140527252379648 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:31:08.969096 140527252379648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:31:08.969191 140527252379648 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:31:08.969274 140527252379648 dqn_agent.py:275] 	 update_period: 4
I0828 10:31:08.969358 140527252379648 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:31:08.969435 140527252379648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:31:08.969506 140527252379648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:31:08.969588 140527252379648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:31:08.969666 140527252379648 dqn_agent.py:280] 	 optimizer: adam
I0828 10:31:08.969789 140527252379648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:31:08.969870 140527252379648 dqn_agent.py:283] 	 seed: 1630146668968701
I0828 10:31:08.972077 140527252379648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:31:08.972270 140527252379648 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:31:08.972365 140527252379648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:31:08.972458 140527252379648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:31:08.972579 140527252379648 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:31:08.972731 140527252379648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:31:08.972831 140527252379648 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:31:08.972909 140527252379648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:31:08.972985 140527252379648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:31:08.999840 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:09.017692 140527252379648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:31:09.017912 140527252379648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.25
I0828 10:31:15.855679 140527252379648 replay_runner.py:36] Average training steps per second: 146.25
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:31:17.361450 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:31:17.604224 140527252379648 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.19
I0828 10:31:22.701715 140527252379648 replay_runner.py:36] Average training steps per second: 196.19
I0828 10:31:23.140884 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:31:23.378353 140527252379648 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.62
I0828 10:31:28.570266 140527252379648 replay_runner.py:36] Average training steps per second: 192.62
I0828 10:31:28.973525 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0828 10:31:29.206994 140527252379648 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 189.77
I0828 10:31:34.476785 140527252379648 replay_runner.py:36] Average training steps per second: 189.77
I0828 10:31:34.914568 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0828 10:31:35.155129 140527252379648 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.47
I0828 10:31:40.245457 140527252379648 replay_runner.py:36] Average training steps per second: 196.47
I0828 10:31:40.692623 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0828 10:31:40.954765 140527252379648 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 190.75
I0828 10:31:46.197676 140527252379648 replay_runner.py:36] Average training steps per second: 190.75
I0828 10:31:46.603903 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0828 10:31:46.857824 140527252379648 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.09
I0828 10:31:51.984188 140527252379648 replay_runner.py:36] Average training steps per second: 195.09
I0828 10:31:52.404769 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0828 10:31:52.659903 140527252379648 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 200.35
I0828 10:31:57.651785 140527252379648 replay_runner.py:36] Average training steps per second: 200.35
I0828 10:31:58.066749 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0828 10:31:58.314809 140527252379648 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.20
I0828 10:32:03.545500 140527252379648 replay_runner.py:36] Average training steps per second: 191.20
I0828 10:32:03.955481 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0828 10:32:04.189234 140527252379648 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.79
I0828 10:32:09.349885 140527252379648 replay_runner.py:36] Average training steps per second: 193.79
I0828 10:32:09.801470 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:32:10.060757 140527252379648 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 195.16
I0828 10:32:15.185314 140527252379648 replay_runner.py:36] Average training steps per second: 195.16
I0828 10:32:15.578838 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 235 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 191.02
I0828 10:32:21.055135 140527252379648 replay_runner.py:36] Average training steps per second: 191.02
I0828 10:32:21.257683 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.96
I0828 10:32:26.521427 140527252379648 replay_runner.py:36] Average training steps per second: 198.96
I0828 10:32:26.942828 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:32:27.194275 140527252379648 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 192.51
I0828 10:32:32.389318 140527252379648 replay_runner.py:36] Average training steps per second: 192.51
I0828 10:32:32.769531 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 321 Episode length: 231 Return: -230.0
INFO:tensorflow:Average training steps per second: 199.05
I0828 10:32:38.031148 140527252379648 replay_runner.py:36] Average training steps per second: 199.05
I0828 10:32:38.291564 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.50
INFO:tensorflow:Starting iteration 15
I0828 10:32:38.658106 140527252379648 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 190.44

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:32:44.304539 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:32:44.542452 140527252379648 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 201.00
I0828 10:32:49.517924 140527252379648 replay_runner.py:36] Average training steps per second: 201.00
I0828 10:32:49.953672 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:32:50.189567 140527252379648 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.27
I0828 10:32:55.311134 140527252379648 replay_runner.py:36] Average training steps per second: 195.27
I0828 10:32:55.700481 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:32:55.945543 140527252379648 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 199.85
I0828 10:33:00.949636 140527252379648 replay_runner.py:36] Average training steps per second: 199.85
I0828 10:33:01.384195 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:33:01.633356 140527252379648 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.87
I0828 10:33:06.739367 140527252379648 replay_runner.py:36] Average training steps per second: 195.87
I0828 10:33:07.143584 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:33:07.367798 140527252379648 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.89
I0828 10:33:12.552402 140527252379648 replay_runner.py:36] Average training steps per second: 192.89
I0828 10:33:12.975336 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 315 Episode length: 315 Return: -314.0
INFO:tensorflow:Average training steps per second: 212.87
I0828 10:33:17.921633 140527252379648 replay_runner.py:36] Average training steps per second: 212.87
I0828 10:33:18.184407 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.93
I0828 10:33:23.583094 140527252379648 replay_runner.py:36] Average training steps per second: 193.93
I0828 10:33:23.961722 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:33:24.195653 140527252379648 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 203.24
I0828 10:33:29.116252 140527252379648 replay_runner.py:36] Average training steps per second: 203.24
I0828 10:33:29.531725 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:33:29.769910 140527252379648 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 204.70
I0828 10:33:34.655914 140527252379648 replay_runner.py:36] Average training steps per second: 204.70
I0828 10:33:35.084488 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:33:35.317521 140527252379648 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.28
I0828 10:33:40.387001 140527252379648 replay_runner.py:36] Average training steps per second: 197.28
I0828 10:33:40.776998 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:33:41.009297 140527252379648 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 200.10
I0828 10:33:46.007176 140527252379648 replay_runner.py:36] Average training steps per second: 200.10
I0828 10:33:46.419683 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:33:46.649825 140527252379648 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 194.31
I0828 10:33:51.796631 140527252379648 replay_runner.py:36] Average training steps per second: 194.31
I0828 10:33:52.143092 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:33:52.365756 140527252379648 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.17
I0828 10:33:57.489974 140527252379648 replay_runner.py:36] Average training steps per second: 195.17
I0828 10:33:57.878774 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 205.07
I0828 10:34:02.986458 140527252379648 replay_runner.py:36] Average training steps per second: 205.07
I0828 10:34:03.411248 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00