I0902 00:20:17.373058 139929824643072 run_experiment.py:549] Creating TrainRunner ...
I0902 00:20:17.381122 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:20:17.381264 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:20:17.381333 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:20:17.381403 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:20:17.381467 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:20:17.381529 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:20:17.381627 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:20:17.381786 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:20:17.381897 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:20:17.381994 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:20:17.382089 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:20:17.382197 139929824643072 dqn_agent.py:283] 	 seed: 1630542017381083
I0902 00:20:17.384265 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:20:17.384389 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:20:17.384492 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:20:17.384605 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:20:17.384676 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:20:17.384737 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:20:17.384886 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:20:17.384985 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:20:17.385106 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:20:17.409065 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:20:17.670623 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:20:17.681204 139929824643072 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:20:17.687844 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:20:17.688027 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:20:17.688154 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:20:17.688275 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:20:17.688359 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:20:17.688470 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:20:17.688567 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:20:17.688641 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:20:17.688745 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:20:17.688913 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:20:17.689042 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:20:17.689165 139929824643072 dqn_agent.py:283] 	 seed: 1630542017687807
I0902 00:20:17.690958 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:20:17.691071 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:20:17.691172 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:20:17.691277 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:20:17.691362 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:20:17.691449 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:20:17.691533 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:20:17.691648 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:20:17.691745 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:20:17.713557 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:20:17.729275 139929824643072 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:20:17.729445 139929824643072 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
Steps executed: 208 Episode length: 208 Return: -168.17451432742968
INFO:tensorflow:Average training steps per second: 246.89
I0902 00:20:21.779964 139929824643072 replay_runner.py:36] Average training steps per second: 246.89
I0902 00:20:22.555261 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.17
INFO:tensorflow:Starting iteration 1

Steps executed: 169 Episode length: 169 Return: -508.49184173245868
INFO:tensorflow:Average training steps per second: 355.20
I0902 00:20:28.755646 139929824643072 replay_runner.py:36] Average training steps per second: 355.20

Steps executed: 394 Episode length: 225 Return: -563.93850622407338
INFO:tensorflow:Starting iteration 2
I0902 00:20:32.413726 139929824643072 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 331.70
I0902 00:20:35.428858 139929824643072 replay_runner.py:36] Average training steps per second: 331.70

Steps executed: 406 Episode length: 239 Return: -272.47723312538346
INFO:tensorflow:Starting iteration 3

Steps executed: 349 Episode length: 186 Return: -70.619550155342276
INFO:tensorflow:Average training steps per second: 335.04
I0902 00:20:42.076913 139929824643072 replay_runner.py:36] Average training steps per second: 335.04
I0902 00:20:42.277536 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.14
INFO:tensorflow:Starting iteration 4
I0902 00:20:45.491590 139929824643072 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 317.62

Steps executed: 1000 Episode length: 1000 Return: -64.74600134859259
I0902 00:20:50.229285 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.75
INFO:tensorflow:Starting iteration 5
I0902 00:20:53.492082 139929824643072 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 322.67

Steps executed: 1000 Episode length: 1000 Return: -84.63981164880855
I0902 00:20:57.821052 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.64
INFO:tensorflow:Starting iteration 6
I0902 00:21:01.050094 139929824643072 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 325.11

Steps executed: 1000 Episode length: 1000 Return: -192.75908467667838
I0902 00:21:05.720589 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.76
INFO:tensorflow:Starting iteration 7
I0902 00:21:09.012277 139929824643072 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 321.72

Steps executed: 1000 Episode length: 1000 Return: -60.342216489059568
I0902 00:21:13.778149 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.34
INFO:tensorflow:Starting iteration 8
I0902 00:21:17.098157 139929824643072 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 328.17

Steps executed: 1000 Episode length: 1000 Return: -95.421487925916548
I0902 00:21:22.283122 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.42
INFO:tensorflow:Starting iteration 9
I0902 00:21:25.680675 139929824643072 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 323.42

Steps executed: 1000 Episode length: 1000 Return: -154.53201452361841
I0902 00:21:30.697305 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.53
INFO:tensorflow:Starting iteration 10
I0902 00:21:34.198482 139929824643072 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 346.75

Steps executed: 1000 Episode length: 1000 Return: -188.41990103179611
I0902 00:21:39.415870 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.42
INFO:tensorflow:Starting iteration 11

Steps executed: 288 Episode length: 288 Return: -136.1139125069583611
INFO:tensorflow:Average training steps per second: 346.28
I0902 00:21:45.667413 139929824643072 replay_runner.py:36] Average training steps per second: 346.28
I0902 00:21:45.900548 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.11
INFO:tensorflow:Starting iteration 12
I0902 00:21:49.288781 139929824643072 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 345.52

Steps executed: 1000 Episode length: 1000 Return: -62.511971673012011
I0902 00:21:53.597616 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.51
INFO:tensorflow:Starting iteration 13

Steps executed: 844 Episode length: 844 Return: -160.6933736102636811
INFO:tensorflow:Average training steps per second: 356.50
I0902 00:21:59.856221 139929824643072 replay_runner.py:36] Average training steps per second: 356.50
I0902 00:22:01.386356 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.69
INFO:tensorflow:Starting iteration 14

Steps executed: 770 Episode length: 770 Return: -189.3649896103640311
INFO:tensorflow:Average training steps per second: 354.06
I0902 00:22:07.663801 139929824643072 replay_runner.py:36] Average training steps per second: 354.06
I0902 00:22:08.528699 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.36
INFO:tensorflow:Starting iteration 15
I0902 00:22:11.945992 139929824643072 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 344.28

Steps executed: 1000 Episode length: 1000 Return: -68.664460992493211
I0902 00:22:18.108469 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -68.66
INFO:tensorflow:Starting iteration 16
I0902 00:22:21.452448 139929824643072 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 327.79

Steps executed: 1000 Episode length: 1000 Return: -50.683621106234995
I0902 00:22:26.794842 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -50.68
INFO:tensorflow:Starting iteration 17

Steps executed: 154 Episode length: 154 Return: -13.51714158562396995
INFO:tensorflow:Average training steps per second: 336.74

Steps executed: 919 Episode length: 765 Return: -147.0362291351022995
I0902 00:22:34.816640 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.28
INFO:tensorflow:Starting iteration 18
I0902 00:22:38.185146 139929824643072 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 335.22

Steps executed: 587 Episode length: 587 Return: -71.95720597216818995
I0902 00:22:41.944410 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.96
INFO:tensorflow:Starting iteration 19

Steps executed: 231 Episode length: 51 Return: -105.62670376151475595
INFO:tensorflow:Average training steps per second: 326.97
I0902 00:22:48.305632 139929824643072 replay_runner.py:36] Average training steps per second: 326.97
I0902 00:22:48.429059 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.20
INFO:tensorflow:Starting iteration 20

Steps executed: 290 Episode length: 158 Return: -20.74020448309824595
INFO:tensorflow:Average training steps per second: 365.45
I0902 00:22:54.518267 139929824643072 replay_runner.py:36] Average training steps per second: 365.45
I0902 00:22:54.685260 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.03
INFO:tensorflow:Starting iteration 21

Steps executed: 55 Episode length: 55 Return: -121.585796753883414595
INFO:tensorflow:Average training steps per second: 366.85

Steps executed: 524 Episode length: 469 Return: -23.05287340828476895
I0902 00:23:01.605799 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.32
INFO:tensorflow:Starting iteration 22
I0902 00:23:05.138547 139929824643072 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 360.30

Steps executed: 1000 Episode length: 1000 Return: 5.36083036964636895
I0902 00:23:10.252952 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: 5.36
INFO:tensorflow:Starting iteration 23

Steps executed: 249 Episode length: 56 Return: -92.233017053680954495
INFO:tensorflow:Average training steps per second: 351.32
I0902 00:23:16.371469 139929824643072 replay_runner.py:36] Average training steps per second: 351.32
I0902 00:23:16.526032 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -51.18
INFO:tensorflow:Starting iteration 24

Steps executed: 473 Episode length: 296 Return: -350.9955255587353695
INFO:tensorflow:Average training steps per second: 354.16
I0902 00:23:22.685097 139929824643072 replay_runner.py:36] Average training steps per second: 354.16
I0902 00:23:22.978004 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.78
INFO:tensorflow:Starting iteration 25
I0902 00:23:26.353423 139929824643072 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 378.27

Steps executed: 516 Episode length: 516 Return: -52.66268494981095695
I0902 00:23:29.706528 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.66
INFO:tensorflow:Starting iteration 26
I0902 00:23:33.109181 139929824643072 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 354.98

Steps executed: 1000 Episode length: 1000 Return: -36.855618255717735
I0902 00:23:37.782638 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -36.86
INFO:tensorflow:Starting iteration 27

Steps executed: 403 Episode length: 403 Return: -341.8201608065969635
INFO:tensorflow:Average training steps per second: 337.29
I0902 00:23:43.941455 139929824643072 replay_runner.py:36] Average training steps per second: 337.29
I0902 00:23:44.367213 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.82
INFO:tensorflow:Starting iteration 28
I0902 00:23:47.603898 139929824643072 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 327.11

Steps executed: 822 Episode length: 822 Return: -538.8217483436272635
I0902 00:23:52.446133 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.82
INFO:tensorflow:Starting iteration 29
I0902 00:23:55.687951 139929824643072 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 334.11

Steps executed: 941 Episode length: 941 Return: 164.09248208153232635

Done fixed training!Episode length: 941 Return: 164.09248208153232635