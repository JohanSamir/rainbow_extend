I0909 13:30:17.470700 140252157974528 run_experiment.py:549] Creating TrainRunner ...
I0909 13:30:17.475838 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:30:17.475938 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:30:17.475996 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:30:17.476089 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:30:17.476151 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:30:17.476204 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:30:17.476262 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:30:17.476371 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:30:17.476427 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:30:17.476498 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:30:17.476566 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:30:17.476642 140252157974528 dqn_agent.py:283] 	 seed: 1631194217475810
I0909 13:30:17.478176 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:30:17.478273 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:30:17.478330 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:30:17.478378 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:30:17.478434 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:30:17.478481 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:30:17.478525 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:30:17.478568 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:30:17.478630 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:30:18.819469 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 13:30:19.012091 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:30:19.020573 140252157974528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:30:19.024583 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:30:19.024709 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:30:19.024774 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:30:19.024848 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:30:19.024899 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:30:19.024944 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:30:19.024989 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:30:19.025060 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:30:19.025115 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:30:19.025181 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:30:19.025245 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:30:19.025310 140252157974528 dqn_agent.py:283] 	 seed: 1631194219024552
I0909 13:30:19.026638 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:30:19.026773 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:30:19.026845 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:30:19.026907 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:30:19.026962 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:30:19.027032 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:30:19.027116 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:30:19.027185 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:30:19.027261 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:30:19.044469 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:30:19.055216 140252157974528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:30:19.055351 140252157974528 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 299.02
I0909 13:30:22.399953 140252157974528 replay_runner.py:36] Average training steps per second: 299.02
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:30:23.024394 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:30:23.088516 140252157974528 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 406.15
I0909 13:30:25.550897 140252157974528 replay_runner.py:36] Average training steps per second: 406.15
I0909 13:30:25.668340 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:30:25.731215 140252157974528 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 406.24
I0909 13:30:28.193075 140252157974528 replay_runner.py:36] Average training steps per second: 406.24
I0909 13:30:28.308005 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:30:28.370297 140252157974528 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 408.66
I0909 13:30:30.817547 140252157974528 replay_runner.py:36] Average training steps per second: 408.66
I0909 13:30:30.934596 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4

Steps executed: 299 Episode length: 150 Return: -150.0
INFO:tensorflow:Average training steps per second: 405.31
I0909 13:30:33.465231 140252157974528 replay_runner.py:36] Average training steps per second: 405.31
I0909 13:30:33.524238 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.50
INFO:tensorflow:Starting iteration 5

Steps executed: 344 Episode length: 154 Return: -154.0
INFO:tensorflow:Average training steps per second: 406.33
I0909 13:30:36.052875 140252157974528 replay_runner.py:36] Average training steps per second: 406.33
I0909 13:30:36.122395 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.67
INFO:tensorflow:Starting iteration 6

Steps executed: 216 Episode length: 216 Return: -216.0
INFO:tensorflow:Average training steps per second: 408.21
I0909 13:30:38.635283 140252157974528 replay_runner.py:36] Average training steps per second: 408.21
I0909 13:30:38.677737 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.00
INFO:tensorflow:Starting iteration 7
I0909 13:30:38.744251 140252157974528 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 406.03

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:30:41.328486 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 707 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 405.88
I0909 13:30:43.856474 140252157974528 replay_runner.py:36] Average training steps per second: 405.88
I0909 13:30:43.993499 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.50
INFO:tensorflow:Starting iteration 9

Steps executed: 243 Episode length: 159 Return: -159.0
INFO:tensorflow:Average training steps per second: 405.94
I0909 13:30:46.520584 140252157974528 replay_runner.py:36] Average training steps per second: 405.94
I0909 13:30:46.569373 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 10

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 406.24
I0909 13:30:49.094905 140252157974528 replay_runner.py:36] Average training steps per second: 406.24
I0909 13:30:49.211982 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:30:49.275070 140252157974528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 402.87
I0909 13:30:51.757498 140252157974528 replay_runner.py:36] Average training steps per second: 402.87
I0909 13:30:51.876322 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 244 Episode length: 149 Return: -149.0
INFO:tensorflow:Average training steps per second: 401.44
I0909 13:30:54.431607 140252157974528 replay_runner.py:36] Average training steps per second: 401.44
I0909 13:30:54.480146 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 13

Steps executed: 230 Episode length: 143 Return: -143.0
INFO:tensorflow:Average training steps per second: 403.59
I0909 13:30:57.022703 140252157974528 replay_runner.py:36] Average training steps per second: 403.59
I0909 13:30:57.068281 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 14

Steps executed: 213 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 407.73
I0909 13:30:59.583278 140252157974528 replay_runner.py:36] Average training steps per second: 407.73
I0909 13:30:59.626418 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 406.27
I0909 13:31:02.151911 140252157974528 replay_runner.py:36] Average training steps per second: 406.27
I0909 13:31:02.269002 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 218 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 404.78
I0909 13:31:04.803536 140252157974528 replay_runner.py:36] Average training steps per second: 404.78
I0909 13:31:04.847551 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 17

Steps executed: 206 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 406.99
I0909 13:31:07.370274 140252157974528 replay_runner.py:36] Average training steps per second: 406.99
I0909 13:31:07.412816 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 18

Steps executed: 321 Episode length: 177 Return: -177.0
INFO:tensorflow:Average training steps per second: 403.88
I0909 13:31:09.950912 140252157974528 replay_runner.py:36] Average training steps per second: 403.88
I0909 13:31:10.015401 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.50
INFO:tensorflow:Starting iteration 19

Steps executed: 273 Episode length: 273 Return: -273.0
INFO:tensorflow:Average training steps per second: 403.43
I0909 13:31:12.559079 140252157974528 replay_runner.py:36] Average training steps per second: 403.43
I0909 13:31:12.613942 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.00
INFO:tensorflow:Starting iteration 20

Steps executed: 211 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 403.74
I0909 13:31:15.154117 140252157974528 replay_runner.py:36] Average training steps per second: 403.74
I0909 13:31:15.196140 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 21

Steps executed: 213 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 407.04
I0909 13:31:17.715347 140252157974528 replay_runner.py:36] Average training steps per second: 407.04
I0909 13:31:17.758868 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 22

Steps executed: 212 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 403.88
I0909 13:31:20.298415 140252157974528 replay_runner.py:36] Average training steps per second: 403.88
I0909 13:31:20.339879 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 23

Steps executed: 202 Episode length: 101 Return: -101.0
INFO:tensorflow:Average training steps per second: 407.07
I0909 13:31:22.858311 140252157974528 replay_runner.py:36] Average training steps per second: 407.07
I0909 13:31:22.898920 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 24

Steps executed: 231 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 408.77
I0909 13:31:25.407106 140252157974528 replay_runner.py:36] Average training steps per second: 408.77
I0909 13:31:25.453296 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 25

Steps executed: 231 Episode length: 126 Return: -126.0
INFO:tensorflow:Average training steps per second: 404.04
I0909 13:31:27.990713 140252157974528 replay_runner.py:36] Average training steps per second: 404.04
I0909 13:31:28.036055 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 26

Steps executed: 241 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 402.44
I0909 13:31:30.582936 140252157974528 replay_runner.py:36] Average training steps per second: 402.44
I0909 13:31:30.631037 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 27

Steps executed: 214 Episode length: 214 Return: -214.0
INFO:tensorflow:Average training steps per second: 407.07
I0909 13:31:33.153291 140252157974528 replay_runner.py:36] Average training steps per second: 407.07
I0909 13:31:33.195508 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.00
INFO:tensorflow:Starting iteration 28


Steps executed: 228 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 407.43
I0909 13:31:35.712973 140252157974528 replay_runner.py:36] Average training steps per second: 407.43
I0909 13:31:35.759594 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 405.01
I0909 13:31:38.291580 140252157974528 replay_runner.py:36] Average training steps per second: 405.01
I0909 13:31:38.332919 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50