Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 23:15:16.162400 140310902786048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:15:16.174057 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:16.174334 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:16.174440 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:16.174535 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:16.174686 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:16.174986 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:16.175116 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:16.175247 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:16.175361 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:16.175465 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:16.175571 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:16.175624 140310902786048 dqn_agent.py:283] 	 seed: 1630624516173983
I0902 23:15:16.177489 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:16.177613 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:16.177683 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:16.177754 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:16.177870 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:16.178031 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:16.178334 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:16.178554 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:16.178747 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:16.211962 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:16.672351 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:16.688768 140310902786048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:15:16.697943 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:16.698209 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:16.698320 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:16.698539 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:16.698695 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:16.698816 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:16.699111 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:16.699282 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:16.699419 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:16.699577 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:16.699774 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:16.699884 140310902786048 dqn_agent.py:283] 	 seed: 1630624516697883
I0902 23:15:16.702539 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:16.702737 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:16.702868 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:16.702989 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:16.703101 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:16.703208 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:16.703313 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:16.703469 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:16.703648 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:16.732077 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:16.757323 140310902786048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:15:16.757616 140310902786048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 162.15
I0902 23:15:22.925273 140310902786048 replay_runner.py:36] Average training steps per second: 162.15
I0902 23:15:24.084224 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.22
Steps executed: 280 Episode length: 87 Return: -144.37390947045105
INFO:tensorflow:Starting iteration 1

Steps executed: 250 Episode length: 65 Return: -126.50408134425936
INFO:tensorflow:Average training steps per second: 222.23
I0902 23:15:32.978132 140310902786048 replay_runner.py:36] Average training steps per second: 222.23
I0902 23:15:33.138911 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.80
INFO:tensorflow:Starting iteration 2

Steps executed: 287 Episode length: 91 Return: -162.37580197502695
INFO:tensorflow:Average training steps per second: 225.68
I0902 23:15:41.958788 140310902786048 replay_runner.py:36] Average training steps per second: 225.68
I0902 23:15:42.127409 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.40
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 81 Return: -140.25621823720365
INFO:tensorflow:Average training steps per second: 233.43
I0902 23:15:50.619668 140310902786048 replay_runner.py:36] Average training steps per second: 233.43
I0902 23:15:50.729984 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.61
INFO:tensorflow:Starting iteration 4

Steps executed: 213 Episode length: 69 Return: -140.74841209929635
INFO:tensorflow:Average training steps per second: 253.53
I0902 23:15:58.815438 140310902786048 replay_runner.py:36] Average training steps per second: 253.53
I0902 23:15:58.928742 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.91
INFO:tensorflow:Starting iteration 5

Steps executed: 226 Episode length: 62 Return: -156.06623253893242
INFO:tensorflow:Average training steps per second: 242.81
I0902 23:16:07.188916 140310902786048 replay_runner.py:36] Average training steps per second: 242.81
I0902 23:16:07.321881 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.31
INFO:tensorflow:Starting iteration 6

Steps executed: 235 Episode length: 68 Return: -129.80684902535184
INFO:tensorflow:Average training steps per second: 228.25
I0902 23:16:15.880742 140310902786048 replay_runner.py:36] Average training steps per second: 228.25
I0902 23:16:16.031125 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.22
INFO:tensorflow:Starting iteration 7

Steps executed: 204 Episode length: 63 Return: -130.26706179304978
INFO:tensorflow:Average training steps per second: 223.61
I0902 23:16:24.849581 140310902786048 replay_runner.py:36] Average training steps per second: 223.61
I0902 23:16:24.982542 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.28
INFO:tensorflow:Starting iteration 8

Steps executed: 214 Episode length: 78 Return: -143.12093069036638
INFO:tensorflow:Average training steps per second: 219.67
I0902 23:16:33.839664 140310902786048 replay_runner.py:36] Average training steps per second: 219.67
I0902 23:16:33.978258 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.02
INFO:tensorflow:Starting iteration 9

Steps executed: 250 Episode length: 88 Return: -112.21600185534069
INFO:tensorflow:Average training steps per second: 219.43
I0902 23:16:42.904654 140310902786048 replay_runner.py:36] Average training steps per second: 219.43
I0902 23:16:43.067285 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.91
INFO:tensorflow:Starting iteration 10

Steps executed: 247 Episode length: 53 Return: -117.37715723342185
INFO:tensorflow:Average training steps per second: 219.32
I0902 23:16:51.971567 140310902786048 replay_runner.py:36] Average training steps per second: 219.32
I0902 23:16:52.129845 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.05
INFO:tensorflow:Starting iteration 11

Steps executed: 223 Episode length: 67 Return: -141.31236936276281
INFO:tensorflow:Average training steps per second: 224.50
I0902 23:17:00.845718 140310902786048 replay_runner.py:36] Average training steps per second: 224.50
I0902 23:17:00.998973 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.86
INFO:tensorflow:Starting iteration 12

Steps executed: 271 Episode length: 85 Return: -285.62492009355925
INFO:tensorflow:Average training steps per second: 221.75
I0902 23:17:09.920156 140310902786048 replay_runner.py:36] Average training steps per second: 221.75
I0902 23:17:10.096731 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.97
INFO:tensorflow:Starting iteration 13

Steps executed: 208 Episode length: 56 Return: -98.664614002560718
INFO:tensorflow:Average training steps per second: 221.81
I0902 23:17:18.964189 140310902786048 replay_runner.py:36] Average training steps per second: 221.81
I0902 23:17:19.105374 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.93
INFO:tensorflow:Starting iteration 14

Steps executed: 218 Episode length: 70 Return: -166.54161785016484
INFO:tensorflow:Average training steps per second: 221.33
I0902 23:17:27.986557 140310902786048 replay_runner.py:36] Average training steps per second: 221.33
I0902 23:17:28.134937 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.11
INFO:tensorflow:Starting iteration 15

Steps executed: 234 Episode length: 85 Return: -173.30153008356719
INFO:tensorflow:Average training steps per second: 226.90
I0902 23:17:36.947772 140310902786048 replay_runner.py:36] Average training steps per second: 226.90
I0902 23:17:37.100389 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.89
INFO:tensorflow:Starting iteration 16

Steps executed: 210 Episode length: 63 Return: -152.04168378858634
INFO:tensorflow:Average training steps per second: 219.55
I0902 23:17:46.037512 140310902786048 replay_runner.py:36] Average training steps per second: 219.55
I0902 23:17:46.174544 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.13
INFO:tensorflow:Starting iteration 17

Steps executed: 257 Episode length: 90 Return: -173.49218284784263
INFO:tensorflow:Average training steps per second: 220.67
I0902 23:17:55.109603 140310902786048 replay_runner.py:36] Average training steps per second: 220.67
I0902 23:17:55.282696 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.36
INFO:tensorflow:Starting iteration 18

Steps executed: 250 Episode length: 81 Return: -128.02875670040132
INFO:tensorflow:Average training steps per second: 224.52
I0902 23:18:03.952100 140310902786048 replay_runner.py:36] Average training steps per second: 224.52
I0902 23:18:04.115497 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.00
INFO:tensorflow:Starting iteration 19

Steps executed: 202 Episode length: 78 Return: -103.94219345325635
INFO:tensorflow:Average training steps per second: 221.71
I0902 23:18:12.949898 140310902786048 replay_runner.py:36] Average training steps per second: 221.71
I0902 23:18:13.080468 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.43
INFO:tensorflow:Starting iteration 20

Steps executed: 281 Episode length: 85 Return: -130.78874698074975
INFO:tensorflow:Average training steps per second: 221.52
I0902 23:18:21.978608 140310902786048 replay_runner.py:36] Average training steps per second: 221.52
I0902 23:18:22.172834 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.64
INFO:tensorflow:Starting iteration 21

Steps executed: 204 Episode length: 63 Return: -113.43636273349739
INFO:tensorflow:Average training steps per second: 223.56
I0902 23:18:30.981259 140310902786048 replay_runner.py:36] Average training steps per second: 223.56
I0902 23:18:31.128056 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 22

Steps executed: 283 Episode length: 88 Return: -120.64189233041279
INFO:tensorflow:Average training steps per second: 225.91
I0902 23:18:39.923257 140310902786048 replay_runner.py:36] Average training steps per second: 225.91
I0902 23:18:40.106936 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.55
INFO:tensorflow:Starting iteration 23

Steps executed: 252 Episode length: 63 Return: -164.65216095906629
INFO:tensorflow:Average training steps per second: 240.95
I0902 23:18:48.588049 140310902786048 replay_runner.py:36] Average training steps per second: 240.95
I0902 23:18:48.738590 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.53
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 71 Return: -137.98370663958232
INFO:tensorflow:Average training steps per second: 237.92
I0902 23:18:57.195098 140310902786048 replay_runner.py:36] Average training steps per second: 237.92
I0902 23:18:57.322732 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.16
INFO:tensorflow:Starting iteration 25

Steps executed: 260 Episode length: 87 Return: -157.05640561846263
INFO:tensorflow:Average training steps per second: 246.28
I0902 23:19:05.557862 140310902786048 replay_runner.py:36] Average training steps per second: 246.28
I0902 23:19:05.713511 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.76
INFO:tensorflow:Starting iteration 26

Steps executed: 268 Episode length: 70 Return: -127.30079928804586
INFO:tensorflow:Average training steps per second: 240.24
I0902 23:19:14.071534 140310902786048 replay_runner.py:36] Average training steps per second: 240.24
I0902 23:19:14.239519 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.72
INFO:tensorflow:Starting iteration 27

Steps executed: 219 Episode length: 82 Return: -121.56132893426173
INFO:tensorflow:Average training steps per second: 229.69
I0902 23:19:22.791739 140310902786048 replay_runner.py:36] Average training steps per second: 229.69
I0902 23:19:22.934247 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.87
INFO:tensorflow:Starting iteration 28

Steps executed: 258 Episode length: 69 Return: -164.08697965126868
INFO:tensorflow:Average training steps per second: 227.18
I0902 23:19:31.634073 140310902786048 replay_runner.py:36] Average training steps per second: 227.18
I0902 23:19:31.813539 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.15
INFO:tensorflow:Starting iteration 29

Steps executed: 208 Episode length: 83 Return: -158.09951497928955
INFO:tensorflow:Average training steps per second: 227.84
I0902 23:19:40.599350 140310902786048 replay_runner.py:36] Average training steps per second: 227.84

Done fixed training!Episode length: 83 Return: -158.09951497928955