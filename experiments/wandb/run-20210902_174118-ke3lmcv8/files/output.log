I0902 17:41:25.619749 140669712693248 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 17:41:25.620239 140669712693248 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 17:41:25.832103 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:25.833548 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:25.833629 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:25.833692 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:25.833747 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:25.833917 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:41:25.833979 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:25.834052 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:25.834139 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:25.834216 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:25.834283 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:25.834351 140669712693248 dqn_agent.py:283] 	 seed: 1630604485832033
I0902 17:41:25.836088 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:25.836219 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:41:25.836290 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:25.836435 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:25.836491 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:25.836589 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:25.836636 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:25.836686 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:25.836748 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:27.286055 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.124622 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.134739 140669712693248 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:41:28.138823 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:28.138973 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:28.139054 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:28.139121 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:28.139190 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:28.139250 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:41:28.139325 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:28.139412 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:28.139493 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:28.139564 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:28.139624 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:28.139695 140669712693248 dqn_agent.py:283] 	 seed: 1630604488138788
I0902 17:41:28.141479 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:28.141621 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:41:28.141699 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:28.141768 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:28.141834 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:28.141918 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:28.141995 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:28.142066 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:28.142131 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:28.168093 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.182312 140669712693248 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:41:28.182486 140669712693248 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 159.17
I0902 17:41:34.465494 140669712693248 replay_runner.py:36] Average training steps per second: 159.17
Steps executed: 200 Episode length: 21 Return: 21.0
I0902 17:41:35.302791 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.18
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 208.69
I0902 17:41:40.232723 140669712693248 replay_runner.py:36] Average training steps per second: 208.69
I0902 17:41:40.383893 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.06
INFO:tensorflow:Starting iteration 2
I0902 17:41:40.582667 140669712693248 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 191.24
I0902 17:41:45.812388 140669712693248 replay_runner.py:36] Average training steps per second: 191.24
I0902 17:41:45.947867 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.10
INFO:tensorflow:Starting iteration 3


Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 199.41
I0902 17:41:51.139143 140669712693248 replay_runner.py:36] Average training steps per second: 199.41
I0902 17:41:51.291706 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 202.93
I0902 17:41:56.419388 140669712693248 replay_runner.py:36] Average training steps per second: 202.93
I0902 17:41:56.546244 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 193.57
I0902 17:42:01.889730 140669712693248 replay_runner.py:36] Average training steps per second: 193.57
I0902 17:42:02.048554 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6

Steps executed: 202 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 207.27
I0902 17:42:07.070530 140669712693248 replay_runner.py:36] Average training steps per second: 207.27
I0902 17:42:07.211791 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 7

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.27
I0902 17:42:12.562036 140669712693248 replay_runner.py:36] Average training steps per second: 194.27
I0902 17:42:12.694583 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 8

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 202.08
I0902 17:42:17.827415 140669712693248 replay_runner.py:36] Average training steps per second: 202.08
I0902 17:42:17.970720 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 9

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 196.66
I0902 17:42:23.254924 140669712693248 replay_runner.py:36] Average training steps per second: 196.66
I0902 17:42:23.374762 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 10

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 196.72
I0902 17:42:28.637428 140669712693248 replay_runner.py:36] Average training steps per second: 196.72
I0902 17:42:28.795702 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 11

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 208.33
I0902 17:42:33.792624 140669712693248 replay_runner.py:36] Average training steps per second: 208.33
I0902 17:42:33.912094 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 12

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 190.25
I0902 17:42:39.348660 140669712693248 replay_runner.py:36] Average training steps per second: 190.25
I0902 17:42:39.479246 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 13

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 204.82
I0902 17:42:44.541455 140669712693248 replay_runner.py:36] Average training steps per second: 204.82
I0902 17:42:44.673079 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.67
INFO:tensorflow:Starting iteration 14

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.12
I0902 17:42:49.990777 140669712693248 replay_runner.py:36] Average training steps per second: 195.12
I0902 17:42:50.113720 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 15

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.80
I0902 17:42:55.323103 140669712693248 replay_runner.py:36] Average training steps per second: 198.80
I0902 17:42:55.466645 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 16

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 202.90
I0902 17:43:00.595275 140669712693248 replay_runner.py:36] Average training steps per second: 202.90
I0902 17:43:00.719599 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 17

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 190.78
I0902 17:43:06.137493 140669712693248 replay_runner.py:36] Average training steps per second: 190.78
I0902 17:43:06.270061 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 18

Steps executed: 202 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 205.68
I0902 17:43:11.325349 140669712693248 replay_runner.py:36] Average training steps per second: 205.68
I0902 17:43:11.471293 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 19

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.44
I0902 17:43:16.802057 140669712693248 replay_runner.py:36] Average training steps per second: 194.44
I0902 17:43:16.920851 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 20
I0902 17:43:17.102181 140669712693248 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 200.34
I0902 17:43:22.094115 140669712693248 replay_runner.py:36] Average training steps per second: 200.34
I0902 17:43:22.237278 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 204.99
I0902 17:43:27.324517 140669712693248 replay_runner.py:36] Average training steps per second: 204.99
I0902 17:43:27.456605 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 22

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.28
I0902 17:43:32.732285 140669712693248 replay_runner.py:36] Average training steps per second: 196.28
I0902 17:43:32.878170 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 23

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 211.57
I0902 17:43:37.797085 140669712693248 replay_runner.py:36] Average training steps per second: 211.57
I0902 17:43:37.934299 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 24

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.27
I0902 17:43:43.301293 140669712693248 replay_runner.py:36] Average training steps per second: 193.27
I0902 17:43:43.439791 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 25

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 204.27
I0902 17:43:48.512124 140669712693248 replay_runner.py:36] Average training steps per second: 204.27
I0902 17:43:48.670356 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 26

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.42
I0902 17:43:53.942135 140669712693248 replay_runner.py:36] Average training steps per second: 197.42
I0902 17:43:54.070687 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 27

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.70
I0902 17:43:59.391656 140669712693248 replay_runner.py:36] Average training steps per second: 194.70
I0902 17:43:59.532728 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 207.85
I0902 17:44:04.548580 140669712693248 replay_runner.py:36] Average training steps per second: 207.85
I0902 17:44:04.680148 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 29
I0902 17:44:04.866323 140669712693248 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 190.20

Done fixed training!Episode length: 8 Return: 8.0.0
I0902 17:44:10.267222 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36