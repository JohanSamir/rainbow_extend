Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0901 12:34:37.205863 140283033229312 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:37.215056 140283033229312 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:37.215299 140283033229312 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:37.215412 140283033229312 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:37.215556 140283033229312 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:37.215914 140283033229312 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:37.216031 140283033229312 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:37.216127 140283033229312 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:37.216248 140283033229312 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:37.216332 140283033229312 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:37.216442 140283033229312 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:37.216554 140283033229312 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:37.216641 140283033229312 dqn_agent.py:283] 	 seed: 1630499677214998
I0901 12:34:37.219752 140283033229312 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:37.219950 140283033229312 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:37.220140 140283033229312 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:37.220333 140283033229312 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:37.220429 140283033229312 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:37.220541 140283033229312 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:37.220676 140283033229312 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:37.220808 140283033229312 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:37.220918 140283033229312 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:37.265296 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:37.780731 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:37.796293 140283033229312 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:37.805357 140283033229312 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:37.805589 140283033229312 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:37.805699 140283033229312 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:37.805794 140283033229312 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:37.805885 140283033229312 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:37.805976 140283033229312 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:37.806063 140283033229312 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:37.806171 140283033229312 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:37.806301 140283033229312 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:37.806396 140283033229312 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:37.806481 140283033229312 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:37.806564 140283033229312 dqn_agent.py:283] 	 seed: 1630499677805293
I0901 12:34:37.808948 140283033229312 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:37.809130 140283033229312 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:37.809240 140283033229312 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:37.809342 140283033229312 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:37.809453 140283033229312 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:37.809545 140283033229312 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:37.809633 140283033229312 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:37.809746 140283033229312 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:37.809913 140283033229312 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:37.844073 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:37.869184 140283033229312 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:37.869506 140283033229312 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 138.65
I0901 12:34:45.082197 140283033229312 replay_runner.py:36] Average training steps per second: 138.65
I0901 12:34:46.667094 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:34:46.906805 140283033229312 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 198.20
I0901 12:34:51.952722 140283033229312 replay_runner.py:36] Average training steps per second: 198.20
I0901 12:34:52.383049 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:34:52.618701 140283033229312 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 186.87
I0901 12:34:57.970485 140283033229312 replay_runner.py:36] Average training steps per second: 186.87
I0901 12:34:58.419049 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 232 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 189.72
I0901 12:35:03.921625 140283033229312 replay_runner.py:36] Average training steps per second: 189.72
I0901 12:35:04.134969 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.35
I0901 12:35:09.809212 140283033229312 replay_runner.py:36] Average training steps per second: 184.35
I0901 12:35:10.232830 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:35:10.473192 140283033229312 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 182.74
I0901 12:35:15.945660 140283033229312 replay_runner.py:36] Average training steps per second: 182.74
I0901 12:35:16.419651 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:35:16.674430 140283033229312 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.74
I0901 12:35:21.836583 140283033229312 replay_runner.py:36] Average training steps per second: 193.74
I0901 12:35:22.312952 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 306 Episode length: 306 Return: -305.0
INFO:tensorflow:Average training steps per second: 186.89
I0901 12:35:27.915725 140283033229312 replay_runner.py:36] Average training steps per second: 186.89
I0901 12:35:28.201359 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.68
I0901 12:35:33.777117 140283033229312 replay_runner.py:36] Average training steps per second: 187.68
I0901 12:35:34.273519 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:35:34.520109 140283033229312 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 189.02
I0901 12:35:39.811077 140283033229312 replay_runner.py:36] Average training steps per second: 189.02
I0901 12:35:40.248694 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:35:40.480038 140283033229312 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 184.53
I0901 12:35:45.899753 140283033229312 replay_runner.py:36] Average training steps per second: 184.53
I0901 12:35:46.347156 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 295 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 188.86
I0901 12:35:51.893348 140283033229312 replay_runner.py:36] Average training steps per second: 188.86
I0901 12:35:52.193212 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.50
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.93
I0901 12:35:57.833402 140283033229312 replay_runner.py:36] Average training steps per second: 185.93
I0901 12:35:58.268406 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 12:35:58.516787 140283033229312 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 185.93
I0901 12:36:03.895832 140283033229312 replay_runner.py:36] Average training steps per second: 185.93
I0901 12:36:04.387161 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 12:36:04.638367 140283033229312 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 190.35
I0901 12:36:09.892302 140283033229312 replay_runner.py:36] Average training steps per second: 190.35
I0901 12:36:10.363780 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 12:36:10.620393 140283033229312 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 183.61
I0901 12:36:16.067119 140283033229312 replay_runner.py:36] Average training steps per second: 183.61
I0901 12:36:16.506634 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:36:16.753304 140283033229312 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.34
I0901 12:36:21.952908 140283033229312 replay_runner.py:36] Average training steps per second: 192.34
I0901 12:36:22.422717 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 310 Episode length: 199 Return: -198.0
INFO:tensorflow:Average training steps per second: 187.52
I0901 12:36:28.036545 140283033229312 replay_runner.py:36] Average training steps per second: 187.52
I0901 12:36:28.319859 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.00
INFO:tensorflow:Starting iteration 18

Steps executed: 532 Episode length: 437 Return: -436.0
INFO:tensorflow:Average training steps per second: 189.52
I0901 12:36:33.852711 140283033229312 replay_runner.py:36] Average training steps per second: 189.52
I0901 12:36:34.337954 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.00
INFO:tensorflow:Starting iteration 19

Steps executed: 214 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 184.56
I0901 12:36:40.009980 140283033229312 replay_runner.py:36] Average training steps per second: 184.56
I0901 12:36:40.224147 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 20

Steps executed: 283 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 188.70
I0901 12:36:45.774202 140283033229312 replay_runner.py:36] Average training steps per second: 188.70
I0901 12:36:46.038729 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 21

Steps executed: 208 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 195.28
I0901 12:36:51.413337 140283033229312 replay_runner.py:36] Average training steps per second: 195.28
I0901 12:36:51.610291 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 22

Steps executed: 182 Episode length: 182 Return: -181.0
INFO:tensorflow:Average training steps per second: 187.97

Steps executed: 300 Episode length: 118 Return: -117.0
I0901 12:36:57.447412 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.00
INFO:tensorflow:Starting iteration 23

Steps executed: 270 Episode length: 173 Return: -172.0
INFO:tensorflow:Average training steps per second: 196.01
I0901 12:37:02.792952 140283033229312 replay_runner.py:36] Average training steps per second: 196.01
I0901 12:37:03.026881 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.00
INFO:tensorflow:Starting iteration 24

Steps executed: 255 Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 196.21
I0901 12:37:08.354190 140283033229312 replay_runner.py:36] Average training steps per second: 196.21
I0901 12:37:08.599720 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.18
I0901 12:37:14.254710 140283033229312 replay_runner.py:36] Average training steps per second: 184.18
I0901 12:37:14.703726 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 193.55
I0901 12:37:20.104002 140283033229312 replay_runner.py:36] Average training steps per second: 193.55
I0901 12:37:20.290649 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 27

Steps executed: 334 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 187.74
I0901 12:37:25.865635 140283033229312 replay_runner.py:36] Average training steps per second: 187.74
I0901 12:37:26.159297 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.00
INFO:tensorflow:Starting iteration 28

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.06
I0901 12:37:31.720376 140283033229312 replay_runner.py:36] Average training steps per second: 188.06
I0901 12:37:32.160864 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Steps executed: 74 Episode length: 74 Return: -73.00.0
INFO:tensorflow:Average training steps per second: 191.21

Done fixed training!Episode length: 95 Return: -94.0.0
I0901 12:37:37.863640 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33