Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0902 00:00:00.936140 139825600018432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:00:00.948191 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:00:00.948462 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:00:00.948604 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:00:00.948710 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:00:00.948805 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:00:00.948898 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:00:00.948997 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:00:00.949085 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:00:00.949174 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:00:00.949255 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:00:00.949340 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:00:00.949425 139825600018432 dqn_agent.py:283] 	 seed: 1630540800948123
I0902 00:00:00.952333 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:00:00.952568 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:00:00.952724 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:00:00.952878 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:00:00.952979 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:00:00.953075 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:00:00.953170 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:00:00.953276 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:00:00.953366 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:00:00.992805 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:01.381253 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:01.396847 139825600018432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:00:01.405515 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:00:01.405735 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:00:01.405936 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:00:01.406172 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:00:01.406285 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:00:01.406362 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:00:01.406487 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:00:01.406563 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:00:01.406766 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:00:01.406949 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:00:01.407061 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:00:01.407166 139825600018432 dqn_agent.py:283] 	 seed: 1630540801405445
I0902 00:00:01.409883 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:00:01.410100 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:00:01.410290 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:00:01.410459 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:00:01.410579 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:00:01.410758 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:00:01.410905 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:00:01.411043 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:00:01.411170 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:00:01.477800 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:01.501396 139825600018432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:00:01.501758 139825600018432 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.28
I0902 00:00:07.516141 139825600018432 replay_runner.py:36] Average training steps per second: 166.28
Steps executed: 207 Episode length: 101 Return: -369.2545037199144
I0902 00:00:08.737165 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.28
INFO:tensorflow:Starting iteration 1
I0902 00:00:13.083448 139825600018432 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 223.37
I0902 00:00:17.561136 139825600018432 replay_runner.py:36] Average training steps per second: 223.37

Steps executed: 305 Episode length: 142 Return: -177.70952169689915
INFO:tensorflow:Starting iteration 2
I0902 00:00:22.122340 139825600018432 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 226.56

Steps executed: 247 Episode length: 247 Return: -547.02509174552325
I0902 00:00:26.839401 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -547.03
INFO:tensorflow:Starting iteration 3

Steps executed: 438 Episode length: 438 Return: -88.840999183014595
INFO:tensorflow:Average training steps per second: 222.82
I0902 00:00:35.787822 139825600018432 replay_runner.py:36] Average training steps per second: 222.82
I0902 00:00:36.515676 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.84
INFO:tensorflow:Starting iteration 4
I0902 00:00:40.892507 139825600018432 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 213.95

Steps executed: 762 Episode length: 762 Return: -306.59832700049245
I0902 00:00:47.037474 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.60
INFO:tensorflow:Starting iteration 5
I0902 00:00:51.377080 139825600018432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.36

Steps executed: 1000 Episode length: 1000 Return: -110.89130778207459
I0902 00:00:58.639445 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.89
INFO:tensorflow:Starting iteration 6
I0902 00:01:02.889350 139825600018432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 219.28

Steps executed: 1000 Episode length: 1000 Return: -62.390002654352389
I0902 00:01:11.677607 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.39
INFO:tensorflow:Starting iteration 7
I0902 00:01:16.044781 139825600018432 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 217.70

Steps executed: 1000 Episode length: 1000 Return: -100.01188301606479
I0902 00:01:23.765238 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.01
INFO:tensorflow:Starting iteration 8
I0902 00:01:28.160640 139825600018432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 223.01

Steps executed: 248 Episode length: 248 Return: -371.2545818741738479
I0902 00:01:32.953520 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.25
INFO:tensorflow:Starting iteration 9

Steps executed: 292 Episode length: 292 Return: -346.8738203399806479
INFO:tensorflow:Average training steps per second: 222.67
I0902 00:01:41.806066 139825600018432 replay_runner.py:36] Average training steps per second: 222.67
I0902 00:01:42.244387 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.87
INFO:tensorflow:Starting iteration 10
I0902 00:01:46.516251 139825600018432 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 222.67

Steps executed: 1000 Episode length: 1000 Return: -89.077894259849719
I0902 00:01:53.689308 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.08
INFO:tensorflow:Starting iteration 11

Steps executed: 483 Episode length: 306 Return: -465.8897718078571619
INFO:tensorflow:Average training steps per second: 233.29
I0902 00:02:02.341658 139825600018432 replay_runner.py:36] Average training steps per second: 233.29
I0902 00:02:02.923838 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.18
INFO:tensorflow:Starting iteration 12
I0902 00:02:07.328278 139825600018432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 216.48

Steps executed: 573 Episode length: 573 Return: -240.0889722317418619
I0902 00:02:13.179210 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.09
INFO:tensorflow:Starting iteration 13
I0902 00:02:17.547180 139825600018432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 218.59

Steps executed: 578 Episode length: 578 Return: -344.9064518300873519
I0902 00:02:23.255851 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.91
INFO:tensorflow:Starting iteration 14

Steps executed: 252 Episode length: 252 Return: -137.5883765707452819
INFO:tensorflow:Average training steps per second: 223.88
I0902 00:02:32.138835 139825600018432 replay_runner.py:36] Average training steps per second: 223.88
I0902 00:02:32.394564 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.59
INFO:tensorflow:Starting iteration 15
I0902 00:02:36.713544 139825600018432 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 224.50

Steps executed: 234 Episode length: 234 Return: 9.2737267402589652819
I0902 00:02:41.401632 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 167 Return: -176.3691209797977719
INFO:tensorflow:Average training steps per second: 228.08
I0902 00:02:49.942660 139825600018432 replay_runner.py:36] Average training steps per second: 228.08
I0902 00:02:50.169033 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.13
INFO:tensorflow:Starting iteration 17
I0902 00:02:54.449062 139825600018432 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 224.41
I0902 00:02:58.905505 139825600018432 replay_runner.py:36] Average training steps per second: 224.41

Steps executed: 307 Episode length: 159 Return: -122.1920590446476219
INFO:tensorflow:Starting iteration 18

Steps executed: 172 Episode length: 172 Return: -185.0771596429762619
INFO:tensorflow:Average training steps per second: 229.13

Steps executed: 776 Episode length: 604 Return: -343.4538955265359619
I0902 00:03:09.616773 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.27
INFO:tensorflow:Starting iteration 19

Steps executed: 320 Episode length: 129 Return: -326.7609861140034619
INFO:tensorflow:Average training steps per second: 224.17
I0902 00:03:18.501183 139825600018432 replay_runner.py:36] Average training steps per second: 224.17
I0902 00:03:18.809317 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.80
INFO:tensorflow:Starting iteration 20

Steps executed: 260 Episode length: 115 Return: -703.7350549343992619
INFO:tensorflow:Average training steps per second: 218.60
I0902 00:03:27.757380 139825600018432 replay_runner.py:36] Average training steps per second: 218.60
I0902 00:03:27.995308 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.97
INFO:tensorflow:Starting iteration 21

Steps executed: 195 Episode length: 58 Return: -241.62610575455798719
INFO:tensorflow:Average training steps per second: 216.88
I0902 00:03:36.936681 139825600018432 replay_runner.py:36] Average training steps per second: 216.88

Steps executed: 326 Episode length: 131 Return: -195.5975984083168719
INFO:tensorflow:Starting iteration 22

Steps executed: 257 Episode length: 87 Return: -179.14891258012514719
INFO:tensorflow:Average training steps per second: 221.82
I0902 00:03:46.131442 139825600018432 replay_runner.py:36] Average training steps per second: 221.82
I0902 00:03:46.340813 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.16
INFO:tensorflow:Starting iteration 23
I0902 00:03:50.758451 139825600018432 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 221.54
I0902 00:03:55.272715 139825600018432 replay_runner.py:36] Average training steps per second: 221.54

Steps executed: 254 Episode length: 139 Return: -134.0616483017769619
INFO:tensorflow:Starting iteration 24

Steps executed: 306 Episode length: 132 Return: -230.9590994912214819
INFO:tensorflow:Average training steps per second: 219.85
I0902 00:04:04.415554 139825600018432 replay_runner.py:36] Average training steps per second: 219.85
I0902 00:04:04.682572 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.37
INFO:tensorflow:Starting iteration 25

Steps executed: 312 Episode length: 127 Return: -678.4754598357774819
INFO:tensorflow:Average training steps per second: 223.39
I0902 00:04:13.559429 139825600018432 replay_runner.py:36] Average training steps per second: 223.39
I0902 00:04:13.848127 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.96
INFO:tensorflow:Starting iteration 26

Steps executed: 208 Episode length: 94 Return: -645.16081618681521419
INFO:tensorflow:Average training steps per second: 224.91
I0902 00:04:22.666795 139825600018432 replay_runner.py:36] Average training steps per second: 224.91
I0902 00:04:22.863384 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -542.24
INFO:tensorflow:Starting iteration 27

Steps executed: 227 Episode length: 71 Return: -157.35706479990492419
INFO:tensorflow:Average training steps per second: 224.48
I0902 00:04:31.717793 139825600018432 replay_runner.py:36] Average training steps per second: 224.48
I0902 00:04:31.898005 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.10
INFO:tensorflow:Starting iteration 28

Steps executed: 233 Episode length: 54 Return: -420.76534849138813419
INFO:tensorflow:Average training steps per second: 228.57
I0902 00:04:40.640621 139825600018432 replay_runner.py:36] Average training steps per second: 228.57
I0902 00:04:40.837508 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.96
INFO:tensorflow:Starting iteration 29

Steps executed: 210 Episode length: 79 Return: -703.16976374077913419
INFO:tensorflow:Average training steps per second: 221.99
I0902 00:04:49.761327 139825600018432 replay_runner.py:36] Average training steps per second: 221.99

Done fixed training!Episode length: 79 Return: -703.16976374077913419