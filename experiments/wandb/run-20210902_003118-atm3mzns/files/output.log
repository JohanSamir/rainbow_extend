I0902 00:31:24.400210 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:31:24.409666 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:31:24.409936 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:31:24.410062 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:31:24.410260 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:31:24.410397 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:31:24.410504 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:31:24.410609 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:31:24.410745 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:31:24.410853 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:31:24.410963 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:31:24.411041 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:31:24.411107 140053067847680 dqn_agent.py:283] 	 seed: 1630542684409600
I0902 00:31:24.412828 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:31:24.412945 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:31:24.413020 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:31:24.413084 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:31:24.413141 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:31:24.413217 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:31:24.413276 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:31:24.413355 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:31:24.413429 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:31:24.440921 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:24.713229 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:24.724506 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:31:24.732105 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:31:24.732278 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:31:24.732383 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:31:24.732480 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:31:24.732636 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:31:24.732744 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:31:24.732853 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:31:24.732944 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:31:24.733020 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:31:24.733091 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:31:24.733222 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:31:24.733310 140053067847680 dqn_agent.py:283] 	 seed: 1630542684732065
I0902 00:31:24.734913 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:31:24.735031 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:31:24.735119 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:31:24.735183 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:31:24.735240 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:31:24.735295 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:31:24.735360 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:31:24.735512 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:31:24.735578 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:31:24.758801 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:24.774138 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:31:24.774447 140053067847680 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 251.26
I0902 00:31:28.754559 140053067847680 replay_runner.py:36] Average training steps per second: 251.26
I0902 00:31:29.508890 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.55
Steps executed: 244 Episode length: 116 Return: -205.39223719488456
INFO:tensorflow:Starting iteration 1
I0902 00:31:32.943608 140053067847680 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 335.46

Steps executed: 329 Episode length: 158 Return: -713.96805464093776
I0902 00:31:36.136030 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -585.98
INFO:tensorflow:Starting iteration 2

Steps executed: 249 Episode length: 110 Return: -312.40829646548226
INFO:tensorflow:Average training steps per second: 335.41
I0902 00:31:42.551162 140053067847680 replay_runner.py:36] Average training steps per second: 335.41
I0902 00:31:42.686212 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.73
INFO:tensorflow:Starting iteration 3

Steps executed: 283 Episode length: 91 Return: -336.945373586600756
INFO:tensorflow:Average training steps per second: 330.26
I0902 00:31:49.094679 140053067847680 replay_runner.py:36] Average training steps per second: 330.26
I0902 00:31:49.292342 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.54
INFO:tensorflow:Starting iteration 4

Steps executed: 244 Episode length: 244 Return: -337.70768136150764
INFO:tensorflow:Average training steps per second: 341.22
I0902 00:31:55.646288 140053067847680 replay_runner.py:36] Average training steps per second: 341.22
I0902 00:31:55.857247 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.71
INFO:tensorflow:Starting iteration 5
I0902 00:31:59.341610 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 367.07

Steps executed: 398 Episode length: 398 Return: -455.24597920621085
I0902 00:32:02.518057 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.25
INFO:tensorflow:Starting iteration 6

Steps executed: 399 Episode length: 399 Return: -378.01633802577356
INFO:tensorflow:Average training steps per second: 357.88
I0902 00:32:08.801822 140053067847680 replay_runner.py:36] Average training steps per second: 357.88
I0902 00:32:09.191149 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.02
INFO:tensorflow:Starting iteration 7
I0902 00:32:12.687487 140053067847680 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 338.32

Steps executed: 738 Episode length: 738 Return: -821.98390943440986
I0902 00:32:16.390261 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -821.98
INFO:tensorflow:Starting iteration 8

Steps executed: 801 Episode length: 801 Return: -211.55577743968416
INFO:tensorflow:Average training steps per second: 320.80
I0902 00:32:22.832865 140053067847680 replay_runner.py:36] Average training steps per second: 320.80
I0902 00:32:23.722024 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.56
INFO:tensorflow:Starting iteration 9
I0902 00:32:27.120352 140053067847680 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 330.89

Steps executed: 981 Episode length: 981 Return: -344.27196994049296
I0902 00:32:32.066656 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.27
INFO:tensorflow:Starting iteration 10
I0902 00:32:35.456090 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 340.35

Steps executed: 307 Episode length: 158 Return: -177.36936597869646
I0902 00:32:38.583026 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.76
INFO:tensorflow:Starting iteration 11

Steps executed: 204 Episode length: 124 Return: -588.23749939740566
INFO:tensorflow:Average training steps per second: 334.74
I0902 00:32:44.993520 140053067847680 replay_runner.py:36] Average training steps per second: 334.74
I0902 00:32:45.124445 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.05
INFO:tensorflow:Starting iteration 12

Steps executed: 202 Episode length: 202 Return: -135.16722489559157
INFO:tensorflow:Average training steps per second: 333.96
I0902 00:32:51.477392 140053067847680 replay_runner.py:36] Average training steps per second: 333.96
I0902 00:32:51.622526 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.17
INFO:tensorflow:Starting iteration 13

Steps executed: 228 Episode length: 160 Return: -155.76586017064625
INFO:tensorflow:Average training steps per second: 341.98
I0902 00:32:57.948147 140053067847680 replay_runner.py:36] Average training steps per second: 341.98
I0902 00:32:58.079366 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.34
INFO:tensorflow:Starting iteration 14
I0902 00:33:01.566048 140053067847680 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 338.01

Steps executed: 512 Episode length: 512 Return: -505.01301782309435
I0902 00:33:05.191325 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -505.01
INFO:tensorflow:Starting iteration 15
I0902 00:33:08.605262 140053067847680 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 332.33

Steps executed: 1000 Episode length: 1000 Return: -132.86930018538123
I0902 00:33:13.236010 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.87
INFO:tensorflow:Starting iteration 16

Steps executed: 305 Episode length: 305 Return: -329.2594395510857323
INFO:tensorflow:Average training steps per second: 348.74
I0902 00:33:19.639614 140053067847680 replay_runner.py:36] Average training steps per second: 348.74
I0902 00:33:19.890689 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.26
INFO:tensorflow:Starting iteration 17

Steps executed: 245 Episode length: 158 Return: -319.6037093432520423
INFO:tensorflow:Average training steps per second: 354.59
I0902 00:33:26.251657 140053067847680 replay_runner.py:36] Average training steps per second: 354.59
I0902 00:33:26.400238 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.97
INFO:tensorflow:Starting iteration 18

Steps executed: 263 Episode length: 67 Return: -156.08541736975383423
INFO:tensorflow:Average training steps per second: 353.56
I0902 00:33:32.753161 140053067847680 replay_runner.py:36] Average training steps per second: 353.56
I0902 00:33:32.862623 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.50
INFO:tensorflow:Starting iteration 19

Steps executed: 285 Episode length: 106 Return: -219.8542104459260723
INFO:tensorflow:Average training steps per second: 347.09
I0902 00:33:39.255622 140053067847680 replay_runner.py:36] Average training steps per second: 347.09
I0902 00:33:39.395407 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.38
INFO:tensorflow:Starting iteration 20

Steps executed: 205 Episode length: 56 Return: -224.40128565586895723
INFO:tensorflow:Average training steps per second: 339.57
I0902 00:33:45.817120 140053067847680 replay_runner.py:36] Average training steps per second: 339.57
I0902 00:33:45.938315 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.31
INFO:tensorflow:Starting iteration 21
I0902 00:33:49.393678 140053067847680 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 336.37

Steps executed: 248 Episode length: 55 Return: -285.19283581915413723
I0902 00:33:52.519526 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.65
INFO:tensorflow:Starting iteration 22

Steps executed: 312 Episode length: 162 Return: -738.5783954550659723
INFO:tensorflow:Average training steps per second: 339.95
I0902 00:33:58.919697 140053067847680 replay_runner.py:36] Average training steps per second: 339.95
I0902 00:33:59.124153 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -702.46
INFO:tensorflow:Starting iteration 23

Steps executed: 316 Episode length: 119 Return: -209.7671228793889823
INFO:tensorflow:Average training steps per second: 348.39
I0902 00:34:05.409670 140053067847680 replay_runner.py:36] Average training steps per second: 348.39
I0902 00:34:05.606464 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.23
INFO:tensorflow:Starting iteration 24

Steps executed: 229 Episode length: 58 Return: -132.35335487365273823
INFO:tensorflow:Average training steps per second: 358.36
I0902 00:34:11.815986 140053067847680 replay_runner.py:36] Average training steps per second: 358.36
I0902 00:34:11.938202 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.29
INFO:tensorflow:Starting iteration 25

Steps executed: 243 Episode length: 70 Return: -190.59497182257733823
INFO:tensorflow:Average training steps per second: 346.17
I0902 00:34:18.296446 140053067847680 replay_runner.py:36] Average training steps per second: 346.17
I0902 00:34:18.422407 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.51
INFO:tensorflow:Starting iteration 26

Steps executed: 216 Episode length: 67 Return: -223.51846721392513823
INFO:tensorflow:Average training steps per second: 334.66
I0902 00:34:24.792900 140053067847680 replay_runner.py:36] Average training steps per second: 334.66
I0902 00:34:24.877699 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.15
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 55 Return: -379.91170040829525823
INFO:tensorflow:Average training steps per second: 335.24
I0902 00:34:31.122864 140053067847680 replay_runner.py:36] Average training steps per second: 335.24
I0902 00:34:31.231747 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.40
INFO:tensorflow:Starting iteration 28

Steps executed: 211 Episode length: 53 Return: -387.33541707607395823
INFO:tensorflow:Average training steps per second: 345.37
I0902 00:34:37.525565 140053067847680 replay_runner.py:36] Average training steps per second: 345.37
I0902 00:34:37.641496 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.77
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 63 Return: -155.15264820957232823
INFO:tensorflow:Average training steps per second: 341.78
I0902 00:34:43.808995 140053067847680 replay_runner.py:36] Average training steps per second: 341.78

Done fixed training!Episode length: 63 Return: -155.15264820957232823