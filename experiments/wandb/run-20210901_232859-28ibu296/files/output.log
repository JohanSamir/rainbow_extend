I0901 23:29:06.202620 139848022624256 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 23:29:06.203187 139848022624256 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 23:29:06.264913 139848022624256 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:06.266167 139848022624256 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:06.266364 139848022624256 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:06.266466 139848022624256 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:06.266527 139848022624256 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:06.266583 139848022624256 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:29:06.266636 139848022624256 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:06.266802 139848022624256 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:06.266891 139848022624256 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:06.266960 139848022624256 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:06.267014 139848022624256 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:06.267067 139848022624256 dqn_agent.py:283] 	 seed: 1630538946264853
I0901 23:29:06.269074 139848022624256 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:06.269235 139848022624256 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:29:06.269313 139848022624256 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:06.269375 139848022624256 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:06.269432 139848022624256 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:06.269504 139848022624256 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:06.269617 139848022624256 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:06.269720 139848022624256 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:06.269801 139848022624256 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
I0901 23:29:12.967233 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.452467 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.468208 139848022624256 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:29:13.561403 139848022624256 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:13.561672 139848022624256 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:13.577950 139848022624256 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:13.578130 139848022624256 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:13.578263 139848022624256 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:13.578595 139848022624256 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:29:13.578837 139848022624256 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:13.578992 139848022624256 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:13.579232 139848022624256 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:13.579318 139848022624256 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:13.579454 139848022624256 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:13.579560 139848022624256 dqn_agent.py:283] 	 seed: 1630538953561335
I0901 23:29:13.582546 139848022624256 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:13.582731 139848022624256 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:29:13.583103 139848022624256 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:13.583200 139848022624256 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:13.583587 139848022624256 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:13.583686 139848022624256 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:13.583987 139848022624256 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:13.584067 139848022624256 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:13.584335 139848022624256 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 10, please be patient, may be a while...
I0901 23:29:14.161101 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:14.312221 139848022624256 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:29:14.312623 139848022624256 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 111.09
I0901 23:29:23.316304 139848022624256 replay_runner.py:36] Average training steps per second: 111.09
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:29:24.488973 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:29:24.713641 139848022624256 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 190.22
I0901 23:29:29.971293 139848022624256 replay_runner.py:36] Average training steps per second: 190.22
I0901 23:29:30.434844 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 23:29:30.694901 139848022624256 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.35
I0901 23:29:35.949385 139848022624256 replay_runner.py:36] Average training steps per second: 190.35
I0901 23:29:36.351398 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:29:36.593820 139848022624256 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 181.67
I0901 23:29:42.098692 139848022624256 replay_runner.py:36] Average training steps per second: 181.67
I0901 23:29:42.571181 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:29:42.824115 139848022624256 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 191.93
I0901 23:29:48.035032 139848022624256 replay_runner.py:36] Average training steps per second: 191.93
I0901 23:29:48.547371 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:29:48.784766 139848022624256 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 192.37

Steps executed: 271 Episode length: 133 Return: -132.0
I0901 23:29:54.203778 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.80
I0901 23:29:59.475016 139848022624256 replay_runner.py:36] Average training steps per second: 198.80
I0901 23:29:59.958229 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 231 Episode length: 231 Return: -230.0
INFO:tensorflow:Average training steps per second: 194.95
I0901 23:30:05.350686 139848022624256 replay_runner.py:36] Average training steps per second: 194.95
I0901 23:30:05.545388 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.00
INFO:tensorflow:Starting iteration 8

Steps executed: 317 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 202.31
I0901 23:30:10.723433 139848022624256 replay_runner.py:36] Average training steps per second: 202.31
I0901 23:30:11.004188 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.67
INFO:tensorflow:Starting iteration 9

Steps executed: 246 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 191.35
I0901 23:30:16.489234 139848022624256 replay_runner.py:36] Average training steps per second: 191.35
I0901 23:30:16.670191 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 10

Steps executed: 470 Episode length: 470 Return: -469.0
INFO:tensorflow:Average training steps per second: 207.31
I0901 23:30:21.712371 139848022624256 replay_runner.py:36] Average training steps per second: 207.31
I0901 23:30:22.117410 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -469.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.39
I0901 23:30:27.599067 139848022624256 replay_runner.py:36] Average training steps per second: 191.39
I0901 23:30:28.045812 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 244 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 203.42
I0901 23:30:33.188395 139848022624256 replay_runner.py:36] Average training steps per second: 203.42
I0901 23:30:33.393220 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 198.54
I0901 23:30:38.675916 139848022624256 replay_runner.py:36] Average training steps per second: 198.54
I0901 23:30:38.847277 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 14
I0901 23:30:39.089347 139848022624256 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.49
I0901 23:30:44.102560 139848022624256 replay_runner.py:36] Average training steps per second: 199.49

Steps executed: 282 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Starting iteration 15

Steps executed: 242 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 190.26
I0901 23:30:49.825290 139848022624256 replay_runner.py:36] Average training steps per second: 190.26
I0901 23:30:50.044574 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 16

Steps executed: 257 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 200.60
I0901 23:30:55.269462 139848022624256 replay_runner.py:36] Average training steps per second: 200.60
I0901 23:30:55.481291 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 17

Steps executed: 277 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 192.57
I0901 23:31:00.902830 139848022624256 replay_runner.py:36] Average training steps per second: 192.57
I0901 23:31:01.166293 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.33
INFO:tensorflow:Starting iteration 18

Steps executed: 276 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 200.69
I0901 23:31:06.400530 139848022624256 replay_runner.py:36] Average training steps per second: 200.69
I0901 23:31:06.630071 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 19
I0901 23:31:06.876755 139848022624256 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 189.22

Steps executed: 274 Episode length: 100 Return: -99.00
I0901 23:31:12.403954 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 76 Return: -75.000
INFO:tensorflow:Average training steps per second: 198.15
I0901 23:31:17.686394 139848022624256 replay_runner.py:36] Average training steps per second: 198.15
I0901 23:31:17.885553 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 21

Steps executed: 261 Episode length: 261 Return: -260.0
INFO:tensorflow:Average training steps per second: 187.30
I0901 23:31:23.473854 139848022624256 replay_runner.py:36] Average training steps per second: 187.30
I0901 23:31:23.696155 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.00
INFO:tensorflow:Starting iteration 22

Steps executed: 266 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 200.99
I0901 23:31:28.918379 139848022624256 replay_runner.py:36] Average training steps per second: 200.99
I0901 23:31:29.149112 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 23
I0901 23:31:29.399299 139848022624256 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.71

Steps executed: 252 Episode length: 78 Return: -77.0.0
I0901 23:31:34.602384 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 24

Steps executed: 204 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 190.35
I0901 23:31:40.102647 139848022624256 replay_runner.py:36] Average training steps per second: 190.35
I0901 23:31:40.291628 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 25

Steps executed: 263 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 200.36
I0901 23:31:45.517067 139848022624256 replay_runner.py:36] Average training steps per second: 200.36
I0901 23:31:45.739005 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 26

Steps executed: 259 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 195.96
I0901 23:31:51.087420 139848022624256 replay_runner.py:36] Average training steps per second: 195.96
I0901 23:31:51.315955 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 27
I0901 23:31:51.564460 139848022624256 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 197.93

Steps executed: 255 Episode length: 72 Return: -71.0.0
I0901 23:31:56.826625 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 28

Steps executed: 220 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 196.57
I0901 23:32:02.150239 139848022624256 replay_runner.py:36] Average training steps per second: 196.57
I0901 23:32:02.338022 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 220.55
I0901 23:32:07.097170 139848022624256 replay_runner.py:36] Average training steps per second: 220.55
I0901 23:32:07.255809 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67