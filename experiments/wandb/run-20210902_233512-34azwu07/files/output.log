Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 23:35:19.363013 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:35:19.373944 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:19.374149 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:19.374340 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:19.374438 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:19.374509 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:19.374576 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:19.374676 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:19.374780 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:19.374956 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:19.375091 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:19.375212 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:19.375297 140006414895104 dqn_agent.py:283] 	 seed: 1630625719373893
I0902 23:35:19.378572 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:19.378781 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:19.378882 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:19.378947 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:19.379006 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:19.379103 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:19.379158 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:19.379334 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:19.379477 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:19.416552 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.820191 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.835637 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:35:19.845465 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:19.846348 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:19.846600 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:19.846966 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:19.847182 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:19.852542 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:19.852753 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:19.852905 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:19.853016 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:19.853110 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:19.853190 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:19.853264 140006414895104 dqn_agent.py:283] 	 seed: 1630625719845401
I0902 23:35:19.877782 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:19.877989 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:19.878080 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:19.878144 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:19.878204 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:19.878293 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:19.878418 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:19.878482 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:19.878559 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:19.912805 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.936654 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:35:19.936892 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.94
I0902 23:35:26.308975 140006414895104 replay_runner.py:36] Average training steps per second: 156.94
Steps executed: 227 Episode length: 94 Return: -429.89217516610412
I0902 23:35:27.517229 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.02
INFO:tensorflow:Starting iteration 1

Steps executed: 210 Episode length: 90 Return: -340.32499702053523
INFO:tensorflow:Average training steps per second: 225.59
I0902 23:35:36.414141 140006414895104 replay_runner.py:36] Average training steps per second: 225.59
I0902 23:35:36.595090 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.20
INFO:tensorflow:Starting iteration 2

Steps executed: 256 Episode length: 114 Return: -269.76406785695417
INFO:tensorflow:Average training steps per second: 225.75
I0902 23:35:45.466685 140006414895104 replay_runner.py:36] Average training steps per second: 225.75
I0902 23:35:45.685214 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.69
INFO:tensorflow:Starting iteration 3
I0902 23:35:50.043554 140006414895104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 215.02

Steps executed: 501 Episode length: 501 Return: -348.65962495246765
I0902 23:35:55.882134 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.66
INFO:tensorflow:Starting iteration 4
I0902 23:36:00.245042 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 222.45
I0902 23:36:04.740829 140006414895104 replay_runner.py:36] Average training steps per second: 222.45

Steps executed: 817 Episode length: 817 Return: -411.86626603774965
INFO:tensorflow:Starting iteration 5
I0902 23:36:11.528729 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 221.43

Steps executed: 981 Episode length: 981 Return: -290.33484477632765
I0902 23:36:18.711018 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.33
INFO:tensorflow:Starting iteration 6

Steps executed: 627 Episode length: 627 Return: -362.37303770273166
INFO:tensorflow:Average training steps per second: 215.54
I0902 23:36:27.764649 140006414895104 replay_runner.py:36] Average training steps per second: 215.54
I0902 23:36:29.090322 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.37
INFO:tensorflow:Starting iteration 7

Steps executed: 361 Episode length: 361 Return: -75.209560782852636
INFO:tensorflow:Average training steps per second: 224.86
I0902 23:36:37.891424 140006414895104 replay_runner.py:36] Average training steps per second: 224.86
I0902 23:36:38.403365 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.21
INFO:tensorflow:Starting iteration 8
I0902 23:36:42.687199 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 228.53

Steps executed: 937 Episode length: 937 Return: -233.03411632933966
I0902 23:36:49.320002 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.03
INFO:tensorflow:Starting iteration 9

Steps executed: 536 Episode length: 536 Return: -252.73624936058666
INFO:tensorflow:Average training steps per second: 231.13
I0902 23:36:57.923660 140006414895104 replay_runner.py:36] Average training steps per second: 231.13
I0902 23:36:59.078584 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.74
INFO:tensorflow:Starting iteration 10

Steps executed: 345 Episode length: 213 Return: -575.94075001267456
INFO:tensorflow:Average training steps per second: 223.22
I0902 23:37:07.878812 140006414895104 replay_runner.py:36] Average training steps per second: 223.22
I0902 23:37:08.239920 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -606.81
INFO:tensorflow:Starting iteration 11
I0902 23:37:12.514469 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 224.65
I0902 23:37:16.966902 140006414895104 replay_runner.py:36] Average training steps per second: 224.65

Steps executed: 316 Episode length: 316 Return: -301.65358346256246
INFO:tensorflow:Starting iteration 12
I0902 23:37:21.848821 140006414895104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 235.18
I0902 23:37:26.101492 140006414895104 replay_runner.py:36] Average training steps per second: 235.18

Steps executed: 560 Episode length: 560 Return: -272.98395707030826
INFO:tensorflow:Starting iteration 13
I0902 23:37:31.695314 140006414895104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 229.38

Steps executed: 939 Episode length: 939 Return: -139.21774132084508
I0902 23:37:38.267473 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.22
INFO:tensorflow:Starting iteration 14

Steps executed: 264 Episode length: 264 Return: -197.29479664258824
INFO:tensorflow:Average training steps per second: 232.41
I0902 23:37:46.893883 140006414895104 replay_runner.py:36] Average training steps per second: 232.41
I0902 23:37:47.166864 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.29
INFO:tensorflow:Starting iteration 15

Steps executed: 531 Episode length: 531 Return: -126.84419391247584
INFO:tensorflow:Average training steps per second: 227.20
I0902 23:37:55.975333 140006414895104 replay_runner.py:36] Average training steps per second: 227.20
I0902 23:37:56.782287 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.84
INFO:tensorflow:Starting iteration 16

Steps executed: 516 Episode length: 516 Return: -205.89692288862017
INFO:tensorflow:Average training steps per second: 219.03
I0902 23:38:05.518195 140006414895104 replay_runner.py:36] Average training steps per second: 219.03
I0902 23:38:06.494159 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.90
INFO:tensorflow:Starting iteration 17
I0902 23:38:10.848736 140006414895104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 223.66

Steps executed: 1000 Episode length: 1000 Return: -134.4157358845223
I0902 23:38:17.780853 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.42
INFO:tensorflow:Starting iteration 18
I0902 23:38:22.193893 140006414895104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 225.06

Steps executed: 541 Episode length: 541 Return: -115.628483335500163
I0902 23:38:27.888861 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.63
INFO:tensorflow:Starting iteration 19

Steps executed: 295 Episode length: 295 Return: -104.780909265252963
INFO:tensorflow:Average training steps per second: 219.96
I0902 23:38:36.848188 140006414895104 replay_runner.py:36] Average training steps per second: 219.96
I0902 23:38:37.295000 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.78
INFO:tensorflow:Starting iteration 20

Steps executed: 234 Episode length: 52 Return: -110.9160149923556363
INFO:tensorflow:Average training steps per second: 219.62
I0902 23:38:46.142212 140006414895104 replay_runner.py:36] Average training steps per second: 219.62
I0902 23:38:46.328723 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.54
INFO:tensorflow:Starting iteration 21

Steps executed: 306 Episode length: 133 Return: -71.0152029433699593
INFO:tensorflow:Average training steps per second: 225.88
I0902 23:38:55.148868 140006414895104 replay_runner.py:36] Average training steps per second: 225.88
I0902 23:38:55.417463 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.23
INFO:tensorflow:Starting iteration 22

Steps executed: 257 Episode length: 151 Return: -101.150643135543653
INFO:tensorflow:Average training steps per second: 221.00
I0902 23:39:04.367128 140006414895104 replay_runner.py:36] Average training steps per second: 221.00
I0902 23:39:04.627028 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.12
INFO:tensorflow:Starting iteration 23

Steps executed: 225 Episode length: 69 Return: -187.8190017578478453
INFO:tensorflow:Average training steps per second: 225.46
I0902 23:39:13.401791 140006414895104 replay_runner.py:36] Average training steps per second: 225.46
I0902 23:39:13.575562 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.94
INFO:tensorflow:Starting iteration 24

Steps executed: 255 Episode length: 135 Return: -412.703558798435153
INFO:tensorflow:Average training steps per second: 225.02
I0902 23:39:22.503675 140006414895104 replay_runner.py:36] Average training steps per second: 225.02
I0902 23:39:22.759034 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.69
INFO:tensorflow:Starting iteration 25

Steps executed: 275 Episode length: 139 Return: -79.4648818332924453
INFO:tensorflow:Average training steps per second: 231.16
I0902 23:39:31.542342 140006414895104 replay_runner.py:36] Average training steps per second: 231.16
I0902 23:39:31.800483 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.71
INFO:tensorflow:Starting iteration 26

Steps executed: 277 Episode length: 84 Return: -467.3421970712859753
INFO:tensorflow:Average training steps per second: 225.91
I0902 23:39:40.569274 140006414895104 replay_runner.py:36] Average training steps per second: 225.91
I0902 23:39:40.816441 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.36
INFO:tensorflow:Starting iteration 27
I0902 23:39:45.225387 140006414895104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 222.21
I0902 23:39:49.726023 140006414895104 replay_runner.py:36] Average training steps per second: 222.21

Steps executed: 275 Episode length: 113 Return: -257.895209675164273
INFO:tensorflow:Starting iteration 28

Steps executed: 299 Episode length: 136 Return: -371.388003795274273
INFO:tensorflow:Average training steps per second: 232.76
I0902 23:39:58.581081 140006414895104 replay_runner.py:36] Average training steps per second: 232.76
I0902 23:39:58.814386 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.42
INFO:tensorflow:Starting iteration 29
I0902 23:40:03.267182 140006414895104 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 221.03
I0902 23:40:07.791881 140006414895104 replay_runner.py:36] Average training steps per second: 221.03


Done fixed training!Episode length: 99 Return: -143.2282518995499273