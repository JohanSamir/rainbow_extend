Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0902 18:05:12.886527 140512094517248 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:12.896591 140512094517248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:12.896889 140512094517248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:12.897036 140512094517248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:12.897145 140512094517248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:12.897257 140512094517248 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:12.897384 140512094517248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:12.897490 140512094517248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:12.897599 140512094517248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:12.897703 140512094517248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:12.897803 140512094517248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:12.897914 140512094517248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:12.898015 140512094517248 dqn_agent.py:283] 	 seed: 1630605912896525
I0902 18:05:12.901115 140512094517248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:12.901316 140512094517248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:12.901459 140512094517248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:12.901580 140512094517248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:12.901690 140512094517248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:12.901915 140512094517248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:12.902043 140512094517248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:12.902154 140512094517248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:12.902256 140512094517248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:12.940139 140512094517248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:13.494019 140512094517248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:13.507960 140512094517248 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:13.516608 140512094517248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:13.516955 140512094517248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:13.517111 140512094517248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:13.517264 140512094517248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:13.517444 140512094517248 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:13.517640 140512094517248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:13.517771 140512094517248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:13.517902 140512094517248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:13.517994 140512094517248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:13.518102 140512094517248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:13.518180 140512094517248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:13.518259 140512094517248 dqn_agent.py:283] 	 seed: 1630605913516549
I0902 18:05:13.521134 140512094517248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:13.521454 140512094517248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:13.521593 140512094517248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:13.521742 140512094517248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:13.521867 140512094517248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:13.521994 140512094517248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:13.522114 140512094517248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:13.522237 140512094517248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:13.522394 140512094517248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:13.554256 140512094517248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:13.573780 140512094517248 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:13.573986 140512094517248 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.32
I0902 18:05:20.139471 140512094517248 replay_runner.py:36] Average training steps per second: 152.32
Steps executed: 204 Episode length: 9 Return: 9.0.0
I0902 18:05:21.244700 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0902 18:05:21.429951 140512094517248 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.54

Steps executed: 218 Episode length: 76 Return: 76.0
I0902 18:05:26.582529 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 72.67
INFO:tensorflow:Starting iteration 2

Steps executed: 326 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 193.99
I0902 18:05:31.917686 140512094517248 replay_runner.py:36] Average training steps per second: 193.99
I0902 18:05:32.121913 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 3

Steps executed: 306 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 195.21
I0902 18:05:37.427289 140512094517248 replay_runner.py:36] Average training steps per second: 195.21
I0902 18:05:37.635602 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.30
I0902 18:05:42.796488 140512094517248 replay_runner.py:36] Average training steps per second: 201.30
I0902 18:05:42.929754 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 333 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 194.45
I0902 18:05:48.264990 140512094517248 replay_runner.py:36] Average training steps per second: 194.45
I0902 18:05:48.466806 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 6

Steps executed: 292 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 200.13
I0902 18:05:53.641252 140512094517248 replay_runner.py:36] Average training steps per second: 200.13
I0902 18:05:53.838475 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 7
I0902 18:05:54.031950 140512094517248 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 208.84

Steps executed: 274 Episode length: 139 Return: 139.0
I0902 18:05:58.992034 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 8

Steps executed: 343 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 199.08
I0902 18:06:04.198192 140512094517248 replay_runner.py:36] Average training steps per second: 199.08
I0902 18:06:04.415049 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 9

Steps executed: 342 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 214.58
I0902 18:06:09.256626 140512094517248 replay_runner.py:36] Average training steps per second: 214.58
I0902 18:06:09.464605 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 10
I0902 18:06:09.642706 140512094517248 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 190.77

Steps executed: 394 Episode length: 196 Return: 196.0
I0902 18:06:15.123627 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.00
INFO:tensorflow:Starting iteration 11

Steps executed: 350 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.47
I0902 18:06:20.118424 140512094517248 replay_runner.py:36] Average training steps per second: 207.47
I0902 18:06:20.350119 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 12

Steps executed: 323 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 194.55
I0902 18:06:25.681959 140512094517248 replay_runner.py:36] Average training steps per second: 194.55
I0902 18:06:25.894508 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.46
I0902 18:06:31.189444 140512094517248 replay_runner.py:36] Average training steps per second: 195.46
I0902 18:06:31.330574 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 133 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 198.76
I0902 18:06:36.561880 140512094517248 replay_runner.py:36] Average training steps per second: 198.76
I0902 18:06:36.749532 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 15


Steps executed: 358 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 189.32
I0902 18:06:42.224288 140512094517248 replay_runner.py:36] Average training steps per second: 189.32
I0902 18:06:42.466165 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.78
I0902 18:06:47.736121 140512094517248 replay_runner.py:36] Average training steps per second: 196.78
I0902 18:06:47.882078 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 18:06:48.073198 140512094517248 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.72
I0902 18:06:53.262446 140512094517248 replay_runner.py:36] Average training steps per second: 192.72
I0902 18:06:53.404061 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 157 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 192.77

Steps executed: 296 Episode length: 139 Return: 139.0
I0902 18:06:58.995754 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 19

Steps executed: 312 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 196.19
I0902 18:07:04.291778 140512094517248 replay_runner.py:36] Average training steps per second: 196.19
I0902 18:07:04.500346 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 20

Steps executed: 344 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 188.99
I0902 18:07:09.979685 140512094517248 replay_runner.py:36] Average training steps per second: 188.99
I0902 18:07:10.201392 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.31
I0902 18:07:15.531320 140512094517248 replay_runner.py:36] Average training steps per second: 194.31
I0902 18:07:15.669765 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 324 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 201.43
I0902 18:07:20.827636 140512094517248 replay_runner.py:36] Average training steps per second: 201.43
I0902 18:07:21.061501 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 23

Steps executed: 307 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 192.13
I0902 18:07:26.458550 140512094517248 replay_runner.py:36] Average training steps per second: 192.13
I0902 18:07:26.659160 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.23
I0902 18:07:31.899813 140512094517248 replay_runner.py:36] Average training steps per second: 198.23
I0902 18:07:32.033453 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 18:07:32.210704 140512094517248 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.87
I0902 18:07:37.342822 140512094517248 replay_runner.py:36] Average training steps per second: 194.87
I0902 18:07:37.467067 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 288 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 203.25
I0902 18:07:42.562095 140512094517248 replay_runner.py:36] Average training steps per second: 203.25
I0902 18:07:42.757084 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.00
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.69
I0902 18:07:48.022973 140512094517248 replay_runner.py:36] Average training steps per second: 199.69
I0902 18:07:48.154204 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 356 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 196.33
I0902 18:07:53.425322 140512094517248 replay_runner.py:36] Average training steps per second: 196.33
I0902 18:07:53.676615 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.87
I0902 18:07:58.683916 140512094517248 replay_runner.py:36] Average training steps per second: 206.87
I0902 18:07:58.811947 140512094517248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00