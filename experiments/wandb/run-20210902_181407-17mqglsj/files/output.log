Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 18:14:13.173452 140451420674048 run_experiment.py:549] Creating TrainRunner ...
I0902 18:14:13.181748 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:13.181948 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:13.182084 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:13.182171 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:13.182255 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:13.182393 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:13.182495 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:13.182567 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:13.182675 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:13.182788 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:13.182873 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:13.182980 140451420674048 dqn_agent.py:283] 	 seed: 1630606453181697
I0902 18:14:13.184688 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:13.184798 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:13.184872 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:13.184937 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:13.184994 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:13.185094 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:13.185166 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:13.185237 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:13.185312 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:13.209205 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:13.527686 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:13.536642 140451420674048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:14:13.542593 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:13.542722 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:13.542810 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:13.542874 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:13.542932 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:13.542985 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:13.543036 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:13.543129 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:13.543198 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:13.543252 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:13.543324 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:13.543398 140451420674048 dqn_agent.py:283] 	 seed: 1630606453542559
I0902 18:14:13.544765 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:13.544908 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:13.544981 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:13.545042 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:13.545096 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:13.545148 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:13.545276 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:13.545378 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:13.545436 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:13.564261 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:13.579005 140451420674048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:14:13.579148 140451420674048 replay_runner.py:41] Starting iteration 0
Steps executed: 283 Episode length: 92 Return: -370.370040737423366
INFO:tensorflow:Average training steps per second: 247.62
I0902 18:14:17.617797 140451420674048 replay_runner.py:36] Average training steps per second: 247.62
I0902 18:14:18.433069 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.71
INFO:tensorflow:Starting iteration 1

Steps executed: 293 Episode length: 143 Return: -316.46645601363076
INFO:tensorflow:Average training steps per second: 332.05
I0902 18:14:24.886592 140451420674048 replay_runner.py:36] Average training steps per second: 332.05
I0902 18:14:25.080980 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.01
INFO:tensorflow:Starting iteration 2
I0902 18:14:28.535494 140451420674048 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 335.21
I0902 18:14:31.519120 140451420674048 replay_runner.py:36] Average training steps per second: 335.21

Steps executed: 303 Episode length: 136 Return: -365.28344945880926
INFO:tensorflow:Starting iteration 3

Steps executed: 241 Episode length: 161 Return: -468.60871895732043
INFO:tensorflow:Average training steps per second: 328.06
I0902 18:14:38.192065 140451420674048 replay_runner.py:36] Average training steps per second: 328.06
I0902 18:14:38.335644 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.63
INFO:tensorflow:Starting iteration 4

Steps executed: 254 Episode length: 111 Return: -127.54571921165706
INFO:tensorflow:Average training steps per second: 333.37
I0902 18:14:44.712186 140451420674048 replay_runner.py:36] Average training steps per second: 333.37
I0902 18:14:44.853672 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.83
INFO:tensorflow:Starting iteration 5

Steps executed: 247 Episode length: 130 Return: -206.94544613725094
INFO:tensorflow:Average training steps per second: 331.92
I0902 18:14:51.204572 140451420674048 replay_runner.py:36] Average training steps per second: 331.92
I0902 18:14:51.337278 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.46
INFO:tensorflow:Starting iteration 6
I0902 18:14:54.660423 140451420674048 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 335.33
I0902 18:14:57.642801 140451420674048 replay_runner.py:36] Average training steps per second: 335.33

Steps executed: 1000 Episode length: 1000 Return: -38.4146510987894
INFO:tensorflow:Starting iteration 7
I0902 18:15:03.034981 140451420674048 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 334.47

Steps executed: 892 Episode length: 892 Return: -254.47880082668718
I0902 18:15:07.877483 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.48
INFO:tensorflow:Starting iteration 8

Steps executed: 397 Episode length: 397 Return: -320.44365009848338
INFO:tensorflow:Average training steps per second: 308.12
I0902 18:15:14.286799 140451420674048 replay_runner.py:36] Average training steps per second: 308.12
I0902 18:15:14.714803 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.44
INFO:tensorflow:Starting iteration 9
I0902 18:15:17.906023 140451420674048 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 321.01

Steps executed: 347 Episode length: 347 Return: -94.943264870288498
I0902 18:15:21.310527 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.94
INFO:tensorflow:Starting iteration 10

Steps executed: 83 Episode length: 83 Return: -131.6351566931455298
INFO:tensorflow:Average training steps per second: 334.50

Steps executed: 1083 Episode length: 1000 Return: -187.0496049968649
I0902 18:15:29.434616 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.34
INFO:tensorflow:Starting iteration 11

Steps executed: 1000 Episode length: 1000 Return: -76.66911675972433
INFO:tensorflow:Average training steps per second: 328.15
I0902 18:15:35.684806 140451420674048 replay_runner.py:36] Average training steps per second: 328.15
I0902 18:15:36.723905 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 12
I0902 18:15:39.960181 140451420674048 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 321.89

Steps executed: 1000 Episode length: 1000 Return: -108.89633866997795
I0902 18:15:44.461518 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.90
INFO:tensorflow:Starting iteration 13
I0902 18:15:47.802468 140451420674048 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 330.20
I0902 18:15:50.831177 140451420674048 replay_runner.py:36] Average training steps per second: 330.20

Steps executed: 1000 Episode length: 1000 Return: -58.697518769505225
INFO:tensorflow:Starting iteration 14
I0902 18:15:56.751198 140451420674048 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 321.63
I0902 18:15:59.860730 140451420674048 replay_runner.py:36] Average training steps per second: 321.63

Steps executed: 1000 Episode length: 1000 Return: -178.91147350533435
INFO:tensorflow:Starting iteration 15
I0902 18:16:04.829746 140451420674048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 331.06

Steps executed: 1000 Episode length: 1000 Return: -140.33312919575755
I0902 18:16:09.939367 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.33
INFO:tensorflow:Starting iteration 16
I0902 18:16:13.356076 140451420674048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 355.29

Steps executed: 1000 Episode length: 1000 Return: -162.39430524056567
I0902 18:16:18.426645 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.39
INFO:tensorflow:Starting iteration 17
I0902 18:16:21.715442 140451420674048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 332.61

Steps executed: 1000 Episode length: 1000 Return: -249.15731605212028
I0902 18:16:27.192861 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.16
INFO:tensorflow:Starting iteration 18

Steps executed: 205 Episode length: 205 Return: -422.9509090619312028
INFO:tensorflow:Average training steps per second: 321.20
I0902 18:16:33.526653 140451420674048 replay_runner.py:36] Average training steps per second: 321.20
I0902 18:16:33.646094 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -422.95
INFO:tensorflow:Starting iteration 19
I0902 18:16:36.878590 140451420674048 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 325.48

Steps executed: 1000 Episode length: 1000 Return: -88.947890613722658
I0902 18:16:41.899325 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.95
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 228 Return: -35.11781104644456658
INFO:tensorflow:Average training steps per second: 328.35
I0902 18:16:48.341888 140451420674048 replay_runner.py:36] Average training steps per second: 328.35
I0902 18:16:48.515282 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -35.12
INFO:tensorflow:Starting iteration 21

Steps executed: 242 Episode length: 52 Return: -260.70573243039119658
INFO:tensorflow:Average training steps per second: 327.13
I0902 18:16:54.887707 140451420674048 replay_runner.py:36] Average training steps per second: 327.13
I0902 18:16:55.032754 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.90
INFO:tensorflow:Starting iteration 22
I0902 18:16:58.407680 140451420674048 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 342.03

Steps executed: 345 Episode length: 236 Return: -365.3829378243242458
I0902 18:17:01.568226 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.48
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 125 Return: -454.1402591900933358
INFO:tensorflow:Average training steps per second: 341.81
I0902 18:17:07.955106 140451420674048 replay_runner.py:36] Average training steps per second: 341.81
I0902 18:17:08.083962 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.26
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 101 Return: -418.4607270524941658
INFO:tensorflow:Average training steps per second: 335.96
I0902 18:17:14.491663 140451420674048 replay_runner.py:36] Average training steps per second: 335.96
I0902 18:17:14.630299 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.77
INFO:tensorflow:Starting iteration 25

Steps executed: 290 Episode length: 133 Return: -625.4878102039934658
INFO:tensorflow:Average training steps per second: 349.20
I0902 18:17:20.836220 140451420674048 replay_runner.py:36] Average training steps per second: 349.20
I0902 18:17:21.015896 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.82
INFO:tensorflow:Starting iteration 26
I0902 18:17:24.381973 140451420674048 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 339.08

Steps executed: 267 Episode length: 267 Return: -252.4447814826694658
I0902 18:17:27.596082 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.44
INFO:tensorflow:Starting iteration 27

Steps executed: 368 Episode length: 249 Return: -355.0392401894244558
INFO:tensorflow:Average training steps per second: 326.72
I0902 18:17:33.948843 140451420674048 replay_runner.py:36] Average training steps per second: 326.72
I0902 18:17:34.223794 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.62
INFO:tensorflow:Starting iteration 28

Steps executed: 270 Episode length: 163 Return: -357.9441769605421358
INFO:tensorflow:Average training steps per second: 352.47
I0902 18:17:40.457093 140451420674048 replay_runner.py:36] Average training steps per second: 352.47
I0902 18:17:40.609544 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.61
INFO:tensorflow:Starting iteration 29

Steps executed: 266 Episode length: 123 Return: -506.0615123980965358
INFO:tensorflow:Average training steps per second: 349.89
I0902 18:17:46.729539 140451420674048 replay_runner.py:36] Average training steps per second: 349.89

Done fixed training!Episode length: 123 Return: -506.0615123980965358