Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0902 11:23:59.885640 139798986172416 run_experiment.py:549] Creating TrainRunner ...
I0902 11:23:59.894044 139798986172416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:23:59.894286 139798986172416 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:23:59.894426 139798986172416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:23:59.894499 139798986172416 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:23:59.894618 139798986172416 dqn_agent.py:275] 	 update_period: 4
I0902 11:23:59.894808 139798986172416 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:23:59.894938 139798986172416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:23:59.895134 139798986172416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:23:59.895227 139798986172416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:23:59.895311 139798986172416 dqn_agent.py:280] 	 optimizer: adam
I0902 11:23:59.895397 139798986172416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:23:59.895490 139798986172416 dqn_agent.py:283] 	 seed: 1630581839893995
I0902 11:23:59.898006 139798986172416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:23:59.898189 139798986172416 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:23:59.898282 139798986172416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:23:59.898348 139798986172416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:23:59.898406 139798986172416 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:23:59.898481 139798986172416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:23:59.898567 139798986172416 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:23:59.898652 139798986172416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:23:59.898720 139798986172416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:00.077044 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:00.485529 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:00.496921 139798986172416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:24:00.505113 139798986172416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:00.505407 139798986172416 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:00.505641 139798986172416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:00.505910 139798986172416 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:00.506258 139798986172416 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:00.506489 139798986172416 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:00.506829 139798986172416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:00.506957 139798986172416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:00.507116 139798986172416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:00.507194 139798986172416 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:00.507269 139798986172416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:00.507333 139798986172416 dqn_agent.py:283] 	 seed: 1630581840505052
I0902 11:24:00.508877 139798986172416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:00.508990 139798986172416 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:00.509062 139798986172416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:00.509124 139798986172416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:00.509180 139798986172416 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:00.509233 139798986172416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:00.509316 139798986172416 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:00.509384 139798986172416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:00.509439 139798986172416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:00.554412 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:00.596567 139798986172416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:24:00.597194 139798986172416 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 154.18
I0902 11:24:07.083533 139798986172416 replay_runner.py:36] Average training steps per second: 154.18
I0902 11:24:08.194460 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1
I0902 11:24:08.370105 139798986172416 replay_runner.py:41] Starting iteration 1
Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 219.63
I0902 11:24:12.923789 139798986172416 replay_runner.py:36] Average training steps per second: 219.63
I0902 11:24:13.060051 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 76.67
INFO:tensorflow:Starting iteration 2

Steps executed: 230 Episode length: 78 Return: 78.0
INFO:tensorflow:Average training steps per second: 198.81
I0902 11:24:18.263718 139798986172416 replay_runner.py:36] Average training steps per second: 198.81
I0902 11:24:18.463284 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 3

Steps executed: 292 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 194.84
I0902 11:24:23.786636 139798986172416 replay_runner.py:36] Average training steps per second: 194.84
I0902 11:24:23.927165 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.86
I0902 11:24:29.304988 139798986172416 replay_runner.py:36] Average training steps per second: 192.86
I0902 11:24:29.529179 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 5

Steps executed: 313 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 191.36
I0902 11:24:34.956406 139798986172416 replay_runner.py:36] Average training steps per second: 191.36
I0902 11:24:35.097736 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.63
I0902 11:24:40.451849 139798986172416 replay_runner.py:36] Average training steps per second: 193.63
I0902 11:24:40.588876 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 278 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 195.74
I0902 11:24:45.893895 139798986172416 replay_runner.py:36] Average training steps per second: 195.74
I0902 11:24:46.094001 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 8

Steps executed: 135 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 195.36
I0902 11:24:51.406888 139798986172416 replay_runner.py:36] Average training steps per second: 195.36

Steps executed: 289 Episode length: 154 Return: 154.0
INFO:tensorflow:Starting iteration 9

Steps executed: 290 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 191.04
I0902 11:24:57.043851 139798986172416 replay_runner.py:36] Average training steps per second: 191.04
I0902 11:24:57.253246 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 10

Steps executed: 286 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 192.22
I0902 11:25:02.651323 139798986172416 replay_runner.py:36] Average training steps per second: 192.22
I0902 11:25:02.853904 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.92
I0902 11:25:08.206663 139798986172416 replay_runner.py:36] Average training steps per second: 193.92
I0902 11:25:08.336562 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12
I0902 11:25:08.525804 139798986172416 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 192.79
I0902 11:25:13.713321 139798986172416 replay_runner.py:36] Average training steps per second: 192.79
I0902 11:25:13.864504 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 304 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 194.54
I0902 11:25:19.205876 139798986172416 replay_runner.py:36] Average training steps per second: 194.54
I0902 11:25:19.409409 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 14

Steps executed: 317 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 189.68
I0902 11:25:24.877035 139798986172416 replay_runner.py:36] Average training steps per second: 189.68
I0902 11:25:25.096939 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 15

Steps executed: 374 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 196.40
I0902 11:25:30.386242 139798986172416 replay_runner.py:36] Average training steps per second: 196.40
I0902 11:25:30.641514 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 16
I0902 11:25:30.834485 139798986172416 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.04

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 11:25:36.179055 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 11:25:36.359881 139798986172416 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.85
I0902 11:25:41.545901 139798986172416 replay_runner.py:36] Average training steps per second: 192.85
I0902 11:25:41.684136 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 11:25:41.884764 139798986172416 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.02
I0902 11:25:47.066261 139798986172416 replay_runner.py:36] Average training steps per second: 193.02
I0902 11:25:47.211681 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 11:25:47.409656 139798986172416 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 192.60
I0902 11:25:52.602282 139798986172416 replay_runner.py:36] Average training steps per second: 192.60
I0902 11:25:52.742236 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 11:25:52.932927 139798986172416 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.99
I0902 11:25:58.115171 139798986172416 replay_runner.py:36] Average training steps per second: 192.99
I0902 11:25:58.250310 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 11:25:58.449019 139798986172416 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 195.28
I0902 11:26:03.570328 139798986172416 replay_runner.py:36] Average training steps per second: 195.28
I0902 11:26:03.705235 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 11:26:03.894996 139798986172416 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.39
I0902 11:26:08.987483 139798986172416 replay_runner.py:36] Average training steps per second: 196.39
I0902 11:26:09.139394 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 11:26:09.332822 139798986172416 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.81
I0902 11:26:14.388616 139798986172416 replay_runner.py:36] Average training steps per second: 197.81
I0902 11:26:14.539225 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 377 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 194.09
I0902 11:26:19.903492 139798986172416 replay_runner.py:36] Average training steps per second: 194.09
I0902 11:26:20.156384 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.50
INFO:tensorflow:Starting iteration 25

Steps executed: 367 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 194.14
I0902 11:26:25.508367 139798986172416 replay_runner.py:36] Average training steps per second: 194.14
I0902 11:26:25.765470 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.17
I0902 11:26:30.963785 139798986172416 replay_runner.py:36] Average training steps per second: 199.17
I0902 11:26:31.103589 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 11:26:31.299074 139798986172416 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 187.51
I0902 11:26:36.632845 139798986172416 replay_runner.py:36] Average training steps per second: 187.51
I0902 11:26:36.776507 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 11:26:36.972949 139798986172416 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 188.55
I0902 11:26:42.276967 139798986172416 replay_runner.py:36] Average training steps per second: 188.55
I0902 11:26:42.427445 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.33
I0902 11:26:47.833100 139798986172416 replay_runner.py:36] Average training steps per second: 191.33

Done fixed training!Episode length: 200 Return: 200.0