I0901 23:50:42.366450 139639256991744 run_experiment.py:549] Creating TrainRunner ...
I0901 23:50:42.373126 139639256991744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:42.373359 139639256991744 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:42.373460 139639256991744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:42.373550 139639256991744 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:42.373878 139639256991744 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:42.374043 139639256991744 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:42.374253 139639256991744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:42.374404 139639256991744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:42.374495 139639256991744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:42.374606 139639256991744 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:42.374762 139639256991744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:42.374852 139639256991744 dqn_agent.py:283] 	 seed: 1630540242373066
I0901 23:50:42.377479 139639256991744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:42.377634 139639256991744 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:50:42.377856 139639256991744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:42.378000 139639256991744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:42.378093 139639256991744 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:42.378189 139639256991744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:42.378262 139639256991744 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:42.378434 139639256991744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:42.378539 139639256991744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:42.410864 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:42.849014 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:42.863269 139639256991744 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:50:42.870889 139639256991744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:42.871091 139639256991744 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:42.871174 139639256991744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:42.871270 139639256991744 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:42.871335 139639256991744 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:42.871394 139639256991744 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:42.871623 139639256991744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:42.871930 139639256991744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:42.872066 139639256991744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:42.872174 139639256991744 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:42.872294 139639256991744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:42.872385 139639256991744 dqn_agent.py:283] 	 seed: 1630540242870837
I0901 23:50:42.874883 139639256991744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:42.875045 139639256991744 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:50:42.875173 139639256991744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:42.875314 139639256991744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:42.875401 139639256991744 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:42.875526 139639256991744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:42.875669 139639256991744 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:42.875782 139639256991744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:42.875985 139639256991744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:42.908717 139639256991744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:42.929204 139639256991744 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:50:42.929503 139639256991744 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 151.18
I0901 23:50:49.544869 139639256991744 replay_runner.py:36] Average training steps per second: 151.18
Steps executed: 221 Episode length: 221 Return: -220.0
I0901 23:50:50.696897 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.00
INFO:tensorflow:Starting iteration 1
I0901 23:50:50.924665 139639256991744 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 213.00

Steps executed: 348 Episode length: 165 Return: -164.0
I0901 23:50:55.905070 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.00
INFO:tensorflow:Starting iteration 2
I0901 23:50:56.142938 139639256991744 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.72
I0901 23:51:01.386854 139639256991744 replay_runner.py:36] Average training steps per second: 190.72

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 3

Steps executed: 332 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 198.01
I0901 23:51:07.062656 139639256991744 replay_runner.py:36] Average training steps per second: 198.01
I0901 23:51:07.359878 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.92
I0901 23:51:12.744083 139639256991744 replay_runner.py:36] Average training steps per second: 194.92
I0901 23:51:13.149919 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 245 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 205.93
I0901 23:51:18.230703 139639256991744 replay_runner.py:36] Average training steps per second: 205.93
I0901 23:51:18.444711 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 6
I0901 23:51:18.695189 139639256991744 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 201.25

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:51:24.197878 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 311 Episode length: 185 Return: -184.0
INFO:tensorflow:Average training steps per second: 197.09
I0901 23:51:29.505915 139639256991744 replay_runner.py:36] Average training steps per second: 197.09
I0901 23:51:29.794497 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.50
INFO:tensorflow:Starting iteration 8

Steps executed: 233 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 201.53
I0901 23:51:35.003986 139639256991744 replay_runner.py:36] Average training steps per second: 201.53
I0901 23:51:35.213917 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.39
I0901 23:51:40.548841 139639256991744 replay_runner.py:36] Average training steps per second: 196.39
I0901 23:51:40.961372 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 194.07
I0901 23:51:46.333234 139639256991744 replay_runner.py:36] Average training steps per second: 194.07
I0901 23:51:46.510522 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 11

Steps executed: 258 Episode length: 140 Return: -139.0
INFO:tensorflow:Average training steps per second: 198.28
I0901 23:51:51.800786 139639256991744 replay_runner.py:36] Average training steps per second: 198.28
I0901 23:51:52.031379 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 12

Steps executed: 253 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 199.38
I0901 23:51:57.297759 139639256991744 replay_runner.py:36] Average training steps per second: 199.38
I0901 23:51:57.544433 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 197.95
I0901 23:52:02.854690 139639256991744 replay_runner.py:36] Average training steps per second: 197.95
I0901 23:52:03.060068 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 14
I0901 23:52:03.303909 139639256991744 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 201.86

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:52:08.680679 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 337 Episode length: 173 Return: -172.0
INFO:tensorflow:Average training steps per second: 200.42
I0901 23:52:13.909006 139639256991744 replay_runner.py:36] Average training steps per second: 200.42
I0901 23:52:14.181667 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.33
INFO:tensorflow:Starting iteration 16

Steps executed: 209 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 198.47
I0901 23:52:19.446217 139639256991744 replay_runner.py:36] Average training steps per second: 198.47
I0901 23:52:19.634589 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 17

Steps executed: 256 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 203.37
I0901 23:52:24.797132 139639256991744 replay_runner.py:36] Average training steps per second: 203.37
I0901 23:52:24.990324 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 18

Steps executed: 202 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 200.20
I0901 23:52:30.201553 139639256991744 replay_runner.py:36] Average training steps per second: 200.20
I0901 23:52:30.374673 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 19

Steps executed: 235 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 195.26
I0901 23:52:35.750342 139639256991744 replay_runner.py:36] Average training steps per second: 195.26
I0901 23:52:35.936396 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 198.14
I0901 23:52:41.217851 139639256991744 replay_runner.py:36] Average training steps per second: 198.14
I0901 23:52:41.421986 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 21

Steps executed: 254 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 205.52
I0901 23:52:46.520072 139639256991744 replay_runner.py:36] Average training steps per second: 205.52
I0901 23:52:46.735327 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 22

Steps executed: 229 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 198.91
I0901 23:52:52.018098 139639256991744 replay_runner.py:36] Average training steps per second: 198.91
I0901 23:52:52.191384 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 23

Steps executed: 202 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 198.37
I0901 23:52:57.457220 139639256991744 replay_runner.py:36] Average training steps per second: 198.37
I0901 23:52:57.626246 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 24

Steps executed: 291 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 205.07
I0901 23:53:02.736788 139639256991744 replay_runner.py:36] Average training steps per second: 205.07
I0901 23:53:02.966130 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 25

Steps executed: 206 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 201.96
I0901 23:53:08.146708 139639256991744 replay_runner.py:36] Average training steps per second: 201.96
I0901 23:53:08.318617 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 26

Steps executed: 218 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 208.21
I0901 23:53:13.357383 139639256991744 replay_runner.py:36] Average training steps per second: 208.21
I0901 23:53:13.546579 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.63
I0901 23:53:18.908244 139639256991744 replay_runner.py:36] Average training steps per second: 195.63
I0901 23:53:19.289981 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0901 23:53:19.529716 139639256991744 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.33
I0901 23:53:24.623653 139639256991744 replay_runner.py:36] Average training steps per second: 196.33
I0901 23:53:25.077399 139639256991744 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 200.36
I0901 23:53:30.298144 139639256991744 replay_runner.py:36] Average training steps per second: 200.36

Done fixed training!Episode length: 71 Return: -70.0.0