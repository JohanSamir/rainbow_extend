Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0901 12:28:42.359288 139983334602752 run_experiment.py:549] Creating TrainRunner ...
I0901 12:28:42.368948 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:42.369274 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:42.369431 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:42.369551 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:42.369660 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:42.369772 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:42.369887 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:42.370054 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:42.370188 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:42.370404 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:42.370594 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:42.370736 139983334602752 dqn_agent.py:283] 	 seed: 1630499322368869
I0901 12:28:42.373707 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:42.373908 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:42.374054 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:42.374241 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:42.374370 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:42.374482 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:42.374589 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:42.374695 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:42.374842 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:42.454263 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:42.937182 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:42.951096 139983334602752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:28:42.959652 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:42.959915 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:42.960062 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:42.960154 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:42.960383 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:42.960501 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:42.960663 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:42.960751 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:42.960837 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:42.960929 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:42.961021 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:42.961132 139983334602752 dqn_agent.py:283] 	 seed: 1630499322959579
I0901 12:28:42.964435 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:42.964655 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:42.964822 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:42.965196 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:42.965353 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:42.965487 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:42.965618 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:42.965870 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:42.966023 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:43.001701 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:43.024783 139983334602752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:28:43.025231 139983334602752 replay_runner.py:41] Starting iteration 0
Steps executed: 439 Episode length: 439 Return: -438.0
INFO:tensorflow:Average training steps per second: 137.08
I0901 12:28:50.320456 139983334602752 replay_runner.py:36] Average training steps per second: 137.08
I0901 12:28:51.786325 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.45
I0901 12:28:57.269743 139983334602752 replay_runner.py:36] Average training steps per second: 191.45
I0901 12:28:57.706513 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:28:57.948541 139983334602752 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.57
I0901 12:29:03.224064 139983334602752 replay_runner.py:36] Average training steps per second: 189.57
I0901 12:29:03.648132 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:29:03.883354 139983334602752 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.88
I0901 12:29:09.068474 139983334602752 replay_runner.py:36] Average training steps per second: 192.88
I0901 12:29:09.481143 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:29:09.723883 139983334602752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 192.83
I0901 12:29:14.910136 139983334602752 replay_runner.py:36] Average training steps per second: 192.83
I0901 12:29:15.320110 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:29:15.551027 139983334602752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 188.41
I0901 12:29:20.859064 139983334602752 replay_runner.py:36] Average training steps per second: 188.41
I0901 12:29:21.300267 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 306 Episode length: 166 Return: -165.0
INFO:tensorflow:Average training steps per second: 193.93
I0901 12:29:26.703281 139983334602752 replay_runner.py:36] Average training steps per second: 193.93
I0901 12:29:26.961469 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.00
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.42
I0901 12:29:32.385745 139983334602752 replay_runner.py:36] Average training steps per second: 192.42
I0901 12:29:32.825339 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:29:33.063121 139983334602752 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.78
I0901 12:29:38.094248 139983334602752 replay_runner.py:36] Average training steps per second: 198.78

Steps executed: 251 Episode length: 251 Return: -250.0
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.16
I0901 12:29:43.663722 139983334602752 replay_runner.py:36] Average training steps per second: 196.16
I0901 12:29:44.057167 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:29:44.282845 139983334602752 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 189.56
I0901 12:29:49.558452 139983334602752 replay_runner.py:36] Average training steps per second: 189.56
I0901 12:29:49.963294 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 301 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 198.67
I0901 12:29:55.229144 139983334602752 replay_runner.py:36] Average training steps per second: 198.67
I0901 12:29:55.491429 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.33
INFO:tensorflow:Starting iteration 12

Steps executed: 222 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 194.13
I0901 12:30:00.897921 139983334602752 replay_runner.py:36] Average training steps per second: 194.13
I0901 12:30:01.082627 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 13
I0901 12:30:01.317974 139983334602752 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.66
I0901 12:30:06.429213 139983334602752 replay_runner.py:36] Average training steps per second: 195.66

Steps executed: 254 Episode length: 174 Return: -173.0
INFO:tensorflow:Starting iteration 14

Steps executed: 274 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 199.58
I0901 12:30:11.894970 139983334602752 replay_runner.py:36] Average training steps per second: 199.58
I0901 12:30:12.144138 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.26
I0901 12:30:17.499347 139983334602752 replay_runner.py:36] Average training steps per second: 195.26
I0901 12:30:17.932880 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 266 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 191.11
I0901 12:30:23.416053 139983334602752 replay_runner.py:36] Average training steps per second: 191.11
I0901 12:30:23.661394 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 193.63
I0901 12:30:29.078532 139983334602752 replay_runner.py:36] Average training steps per second: 193.63
I0901 12:30:29.273243 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 18

Steps executed: 314 Episode length: 227 Return: -226.0
INFO:tensorflow:Average training steps per second: 185.73
I0901 12:30:34.898367 139983334602752 replay_runner.py:36] Average training steps per second: 185.73
I0901 12:30:35.163734 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.00
INFO:tensorflow:Starting iteration 19
I0901 12:30:35.407046 139983334602752 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 196.38

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:30:40.938729 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0901 12:30:41.163234 139983334602752 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.59

Steps executed: 285 Episode length: 104 Return: -103.0
I0901 12:30:46.585736 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 21

Steps executed: 239 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 199.12
I0901 12:30:51.838671 139983334602752 replay_runner.py:36] Average training steps per second: 199.12
I0901 12:30:52.037350 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 22

Steps executed: 235 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 205.34
I0901 12:30:57.139210 139983334602752 replay_runner.py:36] Average training steps per second: 205.34
I0901 12:30:57.314626 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 23
I0901 12:30:57.553034 139983334602752 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 199.02

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:31:02.991875 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 12:31:03.289858 139983334602752 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 205.07
I0901 12:31:08.166507 139983334602752 replay_runner.py:36] Average training steps per second: 205.07
I0901 12:31:08.608950 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 297 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 189.90
I0901 12:31:14.111984 139983334602752 replay_runner.py:36] Average training steps per second: 189.90
I0901 12:31:14.358853 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 26

Steps executed: 215 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 193.34
I0901 12:31:19.767031 139983334602752 replay_runner.py:36] Average training steps per second: 193.34
I0901 12:31:19.950072 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 27

Steps executed: 267 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 202.09
I0901 12:31:25.139325 139983334602752 replay_runner.py:36] Average training steps per second: 202.09
I0901 12:31:25.371335 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 28

Steps executed: 86 Episode length: 86 Return: -85.00.0
INFO:tensorflow:Average training steps per second: 195.43
I0901 12:31:30.722285 139983334602752 replay_runner.py:36] Average training steps per second: 195.43

Steps executed: 250 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 200.71
I0901 12:31:36.136198 139983334602752 replay_runner.py:36] Average training steps per second: 200.71
I0901 12:31:36.307660 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50