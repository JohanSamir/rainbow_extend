Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0903 00:12:32.792111 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0903 00:12:32.799466 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:12:32.799578 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:12:32.799680 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:12:32.799756 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:12:32.799813 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:12:32.799868 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:12:32.799949 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:12:32.800048 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:12:32.800120 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:12:32.800176 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:12:32.800242 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:12:32.800319 140006414895104 dqn_agent.py:283] 	 seed: 1630627952799439
I0903 00:12:32.801990 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:12:32.802094 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:12:32.802179 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:12:32.802242 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:12:32.802315 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:12:32.802378 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:12:32.802444 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:12:32.802499 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:12:32.802551 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:12:32.825810 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:33.075873 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:33.085659 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:12:33.091759 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:12:33.091896 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:12:33.091963 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:12:33.092059 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:12:33.092121 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:12:33.092177 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:12:33.092231 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:12:33.092346 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:12:33.092433 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:12:33.092497 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:12:33.092569 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:12:33.092645 140006414895104 dqn_agent.py:283] 	 seed: 1630627953091730
I0903 00:12:33.094558 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:12:33.094717 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:12:33.094800 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:12:33.094873 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:12:33.094947 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:12:33.095020 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:12:33.095111 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:12:33.095211 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:12:33.095288 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:12:33.118010 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:33.134085 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:12:33.134231 140006414895104 replay_runner.py:41] Starting iteration 0
Steps executed: 252 Episode length: 126 Return: -172.21125635280836
INFO:tensorflow:Average training steps per second: 226.35
I0903 00:12:37.552253 140006414895104 replay_runner.py:36] Average training steps per second: 226.35
I0903 00:12:38.311537 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.90
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 77 Return: -336.912434537428456
INFO:tensorflow:Average training steps per second: 332.64
I0903 00:12:44.667368 140006414895104 replay_runner.py:36] Average training steps per second: 332.64
I0903 00:12:44.758361 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.60
INFO:tensorflow:Starting iteration 2

Steps executed: 238 Episode length: 112 Return: -571.95330395982346
INFO:tensorflow:Average training steps per second: 317.66
I0903 00:12:51.284477 140006414895104 replay_runner.py:36] Average training steps per second: 317.66
I0903 00:12:51.403145 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -561.03
INFO:tensorflow:Starting iteration 3

Steps executed: 423 Episode length: 276 Return: -383.75466612027286
INFO:tensorflow:Average training steps per second: 314.80
I0903 00:12:57.914206 140006414895104 replay_runner.py:36] Average training steps per second: 314.80
I0903 00:12:58.230296 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.22
INFO:tensorflow:Starting iteration 4

Steps executed: 343 Episode length: 246 Return: -477.84222619592543
INFO:tensorflow:Average training steps per second: 305.30
I0903 00:13:04.677351 140006414895104 replay_runner.py:36] Average training steps per second: 305.30
I0903 00:13:04.902686 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.64
INFO:tensorflow:Starting iteration 5

Steps executed: 279 Episode length: 97 Return: -172.179597626511853
INFO:tensorflow:Average training steps per second: 325.50
I0903 00:13:11.286792 140006414895104 replay_runner.py:36] Average training steps per second: 325.50
I0903 00:13:11.429631 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.99
INFO:tensorflow:Starting iteration 6

Steps executed: 464 Episode length: 464 Return: -121.80944693692653
INFO:tensorflow:Average training steps per second: 329.67
I0903 00:13:17.874582 140006414895104 replay_runner.py:36] Average training steps per second: 329.67
I0903 00:13:18.532021 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.81
INFO:tensorflow:Starting iteration 7
I0903 00:13:21.908717 140006414895104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 315.87

Steps executed: 1000 Episode length: 1000 Return: -54.360396201222386
I0903 00:13:27.284755 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.36
INFO:tensorflow:Starting iteration 8
I0903 00:13:30.632445 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 315.29

Steps executed: 1000 Episode length: 1000 Return: -126.11631780548436
I0903 00:13:35.496334 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.12
INFO:tensorflow:Starting iteration 9

Steps executed: 379 Episode length: 379 Return: -214.5949883014124336
INFO:tensorflow:Average training steps per second: 326.36
I0903 00:13:41.953580 140006414895104 replay_runner.py:36] Average training steps per second: 326.36
I0903 00:13:42.356245 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.59
INFO:tensorflow:Starting iteration 10
I0903 00:13:45.679779 140006414895104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 311.92

Steps executed: 551 Episode length: 551 Return: -397.1141675931499436
I0903 00:13:49.521207 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.11
INFO:tensorflow:Starting iteration 11
I0903 00:13:52.962787 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 329.16

Steps executed: 1000 Episode length: 1000 Return: -61.415860797350736
I0903 00:13:58.519946 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.42
INFO:tensorflow:Starting iteration 12

Steps executed: 785 Episode length: 785 Return: -372.5358471466356636
INFO:tensorflow:Average training steps per second: 321.05
I0903 00:14:05.066828 140006414895104 replay_runner.py:36] Average training steps per second: 321.05
I0903 00:14:06.271580 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.54
INFO:tensorflow:Starting iteration 13
I0903 00:14:09.604710 140006414895104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 307.99

Steps executed: 413 Episode length: 413 Return: -96.13090564591576636
I0903 00:14:13.300572 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.13
INFO:tensorflow:Starting iteration 14

Steps executed: 315 Episode length: 152 Return: -316.3403920580482636
INFO:tensorflow:Average training steps per second: 316.26
I0903 00:14:19.787533 140006414895104 replay_runner.py:36] Average training steps per second: 316.26
I0903 00:14:19.988291 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.39
INFO:tensorflow:Starting iteration 15
I0903 00:14:23.327737 140006414895104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 308.54

Steps executed: 690 Episode length: 690 Return: -638.2556981969424636
I0903 00:14:27.736498 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -638.26
INFO:tensorflow:Starting iteration 16

Steps executed: 232 Episode length: 232 Return: -246.5399158663599636
INFO:tensorflow:Average training steps per second: 300.07
I0903 00:14:34.376693 140006414895104 replay_runner.py:36] Average training steps per second: 300.07
I0903 00:14:34.571780 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.54
INFO:tensorflow:Starting iteration 17
I0903 00:14:37.872243 140006414895104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 302.72

Steps executed: 282 Episode length: 135 Return: -216.8693035088114636
I0903 00:14:41.338809 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.32
INFO:tensorflow:Starting iteration 18

Steps executed: 284 Episode length: 130 Return: -434.0651049190246336
INFO:tensorflow:Average training steps per second: 308.64
I0903 00:14:47.897480 140006414895104 replay_runner.py:36] Average training steps per second: 308.64
I0903 00:14:48.072854 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.91
INFO:tensorflow:Starting iteration 19

Steps executed: 215 Episode length: 55 Return: -111.71650792595429336
INFO:tensorflow:Average training steps per second: 311.97
I0903 00:14:54.646598 140006414895104 replay_runner.py:36] Average training steps per second: 311.97
I0903 00:14:54.754750 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.32
INFO:tensorflow:Starting iteration 20

Steps executed: 230 Episode length: 101 Return: -569.0299978285256336
INFO:tensorflow:Average training steps per second: 313.13
I0903 00:15:01.364760 140006414895104 replay_runner.py:36] Average training steps per second: 313.13
I0903 00:15:01.514896 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -605.02
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 134 Return: -98.06071134930718336
INFO:tensorflow:Average training steps per second: 310.59
I0903 00:15:08.111186 140006414895104 replay_runner.py:36] Average training steps per second: 310.59
I0903 00:15:08.250425 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.93
INFO:tensorflow:Starting iteration 22

Steps executed: 230 Episode length: 111 Return: -366.5796856084891836
INFO:tensorflow:Average training steps per second: 321.87
I0903 00:15:14.753105 140006414895104 replay_runner.py:36] Average training steps per second: 321.87
I0903 00:15:14.888564 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.15
INFO:tensorflow:Starting iteration 23

Steps executed: 276 Episode length: 179 Return: -157.8931945207946836
INFO:tensorflow:Average training steps per second: 330.05
I0903 00:15:21.300742 140006414895104 replay_runner.py:36] Average training steps per second: 330.05
I0903 00:15:21.480735 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.65
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 95 Return: -372.99543588019723736
INFO:tensorflow:Average training steps per second: 323.49
I0903 00:15:27.988189 140006414895104 replay_runner.py:36] Average training steps per second: 323.49
I0903 00:15:28.144722 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.88
INFO:tensorflow:Starting iteration 25

Steps executed: 202 Episode length: 77 Return: -298.24397439485756836
INFO:tensorflow:Average training steps per second: 327.79
I0903 00:15:34.550871 140006414895104 replay_runner.py:36] Average training steps per second: 327.79
I0903 00:15:34.642583 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.79
INFO:tensorflow:Starting iteration 26

Steps executed: 115 Episode length: 115 Return: -137.9679296870546836
INFO:tensorflow:Average training steps per second: 314.16
I0903 00:15:40.974635 140006414895104 replay_runner.py:36] Average training steps per second: 314.16

Steps executed: 226 Episode length: 111 Return: -106.8593446775476836
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 178 Return: -222.8043206815847836
INFO:tensorflow:Average training steps per second: 332.25
I0903 00:15:47.277995 140006414895104 replay_runner.py:36] Average training steps per second: 332.25
I0903 00:15:47.418537 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.83
INFO:tensorflow:Starting iteration 28

Steps executed: 220 Episode length: 65 Return: -121.31194838674816836
INFO:tensorflow:Average training steps per second: 330.34
I0903 00:15:53.851464 140006414895104 replay_runner.py:36] Average training steps per second: 330.34
I0903 00:15:53.949215 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.19
INFO:tensorflow:Starting iteration 29

Steps executed: 204 Episode length: 135 Return: -461.0372798108159836
INFO:tensorflow:Average training steps per second: 314.35
I0903 00:16:00.493303 140006414895104 replay_runner.py:36] Average training steps per second: 314.35

Done fixed training!Episode length: 135 Return: -461.0372798108159836