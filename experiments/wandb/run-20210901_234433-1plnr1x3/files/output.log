I0901 23:44:39.607368 140017123334144 run_experiment.py:549] Creating TrainRunner ...
I0901 23:44:39.616116 140017123334144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:39.616290 140017123334144 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:39.616485 140017123334144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:39.616557 140017123334144 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:39.616619 140017123334144 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:39.616673 140017123334144 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:39.616888 140017123334144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:39.617121 140017123334144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:39.617214 140017123334144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:39.617300 140017123334144 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:39.617428 140017123334144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:39.617599 140017123334144 dqn_agent.py:283] 	 seed: 1630539879616073
I0901 23:44:39.620136 140017123334144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:39.620311 140017123334144 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:44:39.620418 140017123334144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:39.620503 140017123334144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:39.620597 140017123334144 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:39.620718 140017123334144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:39.620821 140017123334144 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:39.620953 140017123334144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:39.621038 140017123334144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:39.652348 140017123334144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:40.040631 140017123334144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:40.051761 140017123334144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:44:40.059096 140017123334144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:40.059381 140017123334144 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:40.059617 140017123334144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:40.059767 140017123334144 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:40.060047 140017123334144 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:40.060366 140017123334144 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:40.060556 140017123334144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:40.060698 140017123334144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:40.060825 140017123334144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:40.060933 140017123334144 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:40.061022 140017123334144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:40.061094 140017123334144 dqn_agent.py:283] 	 seed: 1630539880059042
I0901 23:44:40.063449 140017123334144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:40.063614 140017123334144 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:44:40.063732 140017123334144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:40.063819 140017123334144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:40.063899 140017123334144 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:40.063981 140017123334144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:40.064089 140017123334144 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:40.064167 140017123334144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:40.064293 140017123334144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:40.097739 140017123334144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:40.160625 140017123334144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:44:40.160889 140017123334144 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 149.25
I0901 23:44:46.861507 140017123334144 replay_runner.py:36] Average training steps per second: 149.25
Steps executed: 320 Episode length: 163 Return: -162.0
I0901 23:44:48.160186 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.00
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 204 Return: -203.0
INFO:tensorflow:Average training steps per second: 202.12
I0901 23:44:53.399725 140017123334144 replay_runner.py:36] Average training steps per second: 202.12
I0901 23:44:53.557945 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.00
INFO:tensorflow:Starting iteration 2

Steps executed: 112 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 198.77

Steps executed: 612 Episode length: 500 Return: -500.0
I0901 23:44:59.349055 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.50
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.09
I0901 23:45:04.587751 140017123334144 replay_runner.py:36] Average training steps per second: 200.09
I0901 23:45:05.008366 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:45:05.253631 140017123334144 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.95
I0901 23:45:10.305649 140017123334144 replay_runner.py:36] Average training steps per second: 197.95
I0901 23:45:10.722996 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 594 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.55
I0901 23:45:16.027344 140017123334144 replay_runner.py:36] Average training steps per second: 197.55
I0901 23:45:16.531602 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.53
I0901 23:45:21.941621 140017123334144 replay_runner.py:36] Average training steps per second: 193.53
I0901 23:45:22.447962 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:45:22.695952 140017123334144 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.93
I0901 23:45:27.723470 140017123334144 replay_runner.py:36] Average training steps per second: 198.93
I0901 23:45:28.146712 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:45:28.389979 140017123334144 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.66
I0901 23:45:33.475244 140017123334144 replay_runner.py:36] Average training steps per second: 196.66
I0901 23:45:33.906043 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 23:45:34.134340 140017123334144 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 195.44
I0901 23:45:39.251355 140017123334144 replay_runner.py:36] Average training steps per second: 195.44
I0901 23:45:39.459942 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 10


Steps executed: 213 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 195.28
I0901 23:45:44.826812 140017123334144 replay_runner.py:36] Average training steps per second: 195.28
I0901 23:45:45.001724 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 11

Steps executed: 246 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 197.13
I0901 23:45:50.312726 140017123334144 replay_runner.py:36] Average training steps per second: 197.13
I0901 23:45:50.526250 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 12
I0901 23:45:50.770004 140017123334144 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 197.16

Steps executed: 246 Episode length: 75 Return: -74.000
I0901 23:45:56.057748 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 13

Steps executed: 168 Episode length: 92 Return: -91.000
INFO:tensorflow:Average training steps per second: 199.24

Steps executed: 248 Episode length: 80 Return: -79.000
I0901 23:46:01.537403 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 14

Steps executed: 275 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 194.30
I0901 23:46:06.913963 140017123334144 replay_runner.py:36] Average training steps per second: 194.30
I0901 23:46:07.146014 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 15

Steps executed: 250 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 194.93
I0901 23:46:12.511053 140017123334144 replay_runner.py:36] Average training steps per second: 194.93
I0901 23:46:12.722292 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.23
I0901 23:46:17.979771 140017123334144 replay_runner.py:36] Average training steps per second: 199.23
I0901 23:46:18.394585 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 217 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 194.88
I0901 23:46:23.770006 140017123334144 replay_runner.py:36] Average training steps per second: 194.88
I0901 23:46:23.946587 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.33
INFO:tensorflow:Starting iteration 18

Steps executed: 237 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 200.75
I0901 23:46:29.169826 140017123334144 replay_runner.py:36] Average training steps per second: 200.75
I0901 23:46:29.367218 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 19

Steps executed: 249 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 196.62
I0901 23:46:34.694330 140017123334144 replay_runner.py:36] Average training steps per second: 196.62
I0901 23:46:34.898993 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 20

Steps executed: 236 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 198.58
I0901 23:46:40.187285 140017123334144 replay_runner.py:36] Average training steps per second: 198.58
I0901 23:46:40.383053 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 21

Steps executed: 205 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 196.90
I0901 23:46:45.710434 140017123334144 replay_runner.py:36] Average training steps per second: 196.90
I0901 23:46:45.882661 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.42
I0901 23:46:51.141573 140017123334144 replay_runner.py:36] Average training steps per second: 199.42
I0901 23:46:51.554720 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 293 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 204.93
I0901 23:46:56.682313 140017123334144 replay_runner.py:36] Average training steps per second: 204.93
I0901 23:46:56.897523 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 24

Steps executed: 268 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 201.13
I0901 23:47:02.100800 140017123334144 replay_runner.py:36] Average training steps per second: 201.13
I0901 23:47:02.404497 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 25

Steps executed: 213 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 212.57
I0901 23:47:07.405987 140017123334144 replay_runner.py:36] Average training steps per second: 212.57
I0901 23:47:07.575311 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 26

Steps executed: 289 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 197.01
I0901 23:47:12.882500 140017123334144 replay_runner.py:36] Average training steps per second: 197.01
I0901 23:47:13.115627 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 27

Steps executed: 270 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 203.37
I0901 23:47:18.266848 140017123334144 replay_runner.py:36] Average training steps per second: 203.37
I0901 23:47:18.495670 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 28

Steps executed: 106 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 202.72
I0901 23:47:23.676734 140017123334144 replay_runner.py:36] Average training steps per second: 202.72
I0901 23:47:23.935662 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 29


Done fixed training!Episode length: 160 Return: -159.0
INFO:tensorflow:Average training steps per second: 203.28
I0901 23:47:29.101791 140017123334144 replay_runner.py:36] Average training steps per second: 203.28
I0901 23:47:29.378499 140017123334144 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.33