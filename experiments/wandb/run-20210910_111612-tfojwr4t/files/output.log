I0910 11:16:18.970577 139724165507072 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 11:16:18.971354 139724165507072 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 11:16:19.031325 139724165507072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:16:19.032663 139724165507072 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:16:19.032743 139724165507072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:16:19.032806 139724165507072 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:16:19.032863 139724165507072 dqn_agent.py:275] 	 update_period: 4
I0910 11:16:19.032953 139724165507072 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:16:19.033100 139724165507072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:16:19.033166 139724165507072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:16:19.033264 139724165507072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:16:19.033376 139724165507072 dqn_agent.py:280] 	 optimizer: adam
I0910 11:16:19.033431 139724165507072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:16:19.033536 139724165507072 dqn_agent.py:283] 	 seed: 1631272579031268
I0910 11:16:19.035401 139724165507072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:16:19.035552 139724165507072 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:16:19.035649 139724165507072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:16:19.035715 139724165507072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:16:19.035772 139724165507072 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:16:19.035826 139724165507072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:16:19.035877 139724165507072 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:16:19.035947 139724165507072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:16:19.036065 139724165507072 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
I0910 11:16:20.909867 139724165507072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:16:21.019647 139724165507072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:16:21.019855 139724165507072 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:16:21.019947 139724165507072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:16:21.020036 139724165507072 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:16:21.020099 139724165507072 dqn_agent.py:275] 	 update_period: 4
I0910 11:16:21.020186 139724165507072 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:16:21.020271 139724165507072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:16:21.020426 139724165507072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:16:21.020511 139724165507072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:16:21.020581 139724165507072 dqn_agent.py:280] 	 optimizer: adam
I0910 11:16:21.020660 139724165507072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:16:21.020734 139724165507072 dqn_agent.py:283] 	 seed: 1631272581019585
I0910 11:16:21.022458 139724165507072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:16:21.022605 139724165507072 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:16:21.022683 139724165507072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:16:21.022751 139724165507072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:16:21.022812 139724165507072 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:16:21.022878 139724165507072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:16:21.022937 139724165507072 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:16:21.023009 139724165507072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:16:21.023080 139724165507072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:16:21.046728 139724165507072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:16:21.060228 139724165507072 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:16:21.060489 139724165507072 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 701975.56
I0910 11:16:21.062074 139724165507072 replay_runner.py:39] Average training steps per second: 701975.56
Steps executed: 378 Episode length: 188 Return: -188.0
I0910 11:16:22.773928 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.00
INFO:tensorflow:Starting iteration 1
I0910 11:16:22.870738 139724165507072 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 303210.01
I0910 11:16:22.874454 139724165507072 replay_runner.py:39] Average training steps per second: 303210.01
I0910 11:16:23.454074 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.50
INFO:tensorflow:Starting iteration 2
I0910 11:16:23.590950 139724165507072 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 342643.90
I0910 11:16:23.594251 139724165507072 replay_runner.py:39] Average training steps per second: 342643.90
I0910 11:16:23.777480 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.50
INFO:tensorflow:Starting iteration 3
I0910 11:16:23.865417 139724165507072 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 339619.76
I0910 11:16:23.868833 139724165507072 replay_runner.py:39] Average training steps per second: 339619.76
I0910 11:16:23.960889 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.00
INFO:tensorflow:Starting iteration 4
I0910 11:16:24.040259 139724165507072 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 337000.16
I0910 11:16:24.043627 139724165507072 replay_runner.py:39] Average training steps per second: 337000.16
I0910 11:16:24.304261 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.00
INFO:tensorflow:Starting iteration 5
I0910 11:16:24.458935 139724165507072 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 333463.51

Steps executed: 788 Episode length: 600 Return: -600.0
I0910 11:16:24.951019 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.00
INFO:tensorflow:Starting iteration 6
I0910 11:16:25.036428 139724165507072 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 768609.86
I0910 11:16:25.037993 139724165507072 replay_runner.py:39] Average training steps per second: 768609.86
I0910 11:16:25.195522 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 7
I0910 11:16:25.251839 139724165507072 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 801816.86
I0910 11:16:25.253333 139724165507072 replay_runner.py:39] Average training steps per second: 801816.86
I0910 11:16:25.441147 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:16:25.500202 139724165507072 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 809242.52
I0910 11:16:25.501885 139724165507072 replay_runner.py:39] Average training steps per second: 809242.52
I0910 11:16:25.585407 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.00
INFO:tensorflow:Starting iteration 9
I0910 11:16:25.640994 139724165507072 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 825812.96
I0910 11:16:25.642448 139724165507072 replay_runner.py:39] Average training steps per second: 825812.96
I0910 11:16:25.768978 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.50
INFO:tensorflow:Starting iteration 10
I0910 11:16:25.825559 139724165507072 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 769738.30
I0910 11:16:25.827120 139724165507072 replay_runner.py:39] Average training steps per second: 769738.30
I0910 11:16:25.958399 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.50
INFO:tensorflow:Starting iteration 11
I0910 11:16:26.019257 139724165507072 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 709216.10
I0910 11:16:26.020927 139724165507072 replay_runner.py:39] Average training steps per second: 709216.10
I0910 11:16:26.144097 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.50
INFO:tensorflow:Starting iteration 12
I0910 11:16:26.201687 139724165507072 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 817443.77
I0910 11:16:26.203197 139724165507072 replay_runner.py:39] Average training steps per second: 817443.77

Steps executed: 190 Episode length: 190 Return: -190.0
INFO:tensorflow:Starting iteration 13
I0910 11:16:26.528458 139724165507072 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 819840.50
I0910 11:16:26.529962 139724165507072 replay_runner.py:39] Average training steps per second: 819840.50
I0910 11:16:26.659857 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.50
INFO:tensorflow:Starting iteration 14
I0910 11:16:26.715043 139724165507072 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 793024.01
I0910 11:16:26.716604 139724165507072 replay_runner.py:39] Average training steps per second: 793024.01
I0910 11:16:26.988982 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:16:27.060166 139724165507072 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 823058.08
I0910 11:16:27.061648 139724165507072 replay_runner.py:39] Average training steps per second: 823058.08
I0910 11:16:27.174859 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 16
I0910 11:16:27.252718 139724165507072 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 337271.15
I0910 11:16:27.256051 139724165507072 replay_runner.py:39] Average training steps per second: 337271.15
I0910 11:16:27.435899 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.50
INFO:tensorflow:Starting iteration 17
I0910 11:16:27.681930 139724165507072 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 772858.67
I0910 11:16:27.683537 139724165507072 replay_runner.py:39] Average training steps per second: 772858.67
I0910 11:16:27.929365 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:16:27.985076 139724165507072 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 806286.81
I0910 11:16:27.986569 139724165507072 replay_runner.py:39] Average training steps per second: 806286.81
I0910 11:16:28.111513 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.00
INFO:tensorflow:Starting iteration 19
I0910 11:16:28.169834 139724165507072 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 805976.94
I0910 11:16:28.171319 139724165507072 replay_runner.py:39] Average training steps per second: 805976.94
I0910 11:16:28.309803 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.50
INFO:tensorflow:Starting iteration 20
I0910 11:16:28.366942 139724165507072 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 749518.23

Steps executed: 188 Episode length: 188 Return: -188.0
I0910 11:16:28.575752 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.50
INFO:tensorflow:Starting iteration 21
I0910 11:16:28.644220 139724165507072 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 330494.37
I0910 11:16:28.659580 139724165507072 replay_runner.py:39] Average training steps per second: 330494.37
I0910 11:16:28.882924 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.00
INFO:tensorflow:Starting iteration 22
I0910 11:16:28.960428 139724165507072 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 819040.03
I0910 11:16:28.961898 139724165507072 replay_runner.py:39] Average training steps per second: 819040.03
I0910 11:16:29.296015 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.00
INFO:tensorflow:Starting iteration 23
I0910 11:16:29.383766 139724165507072 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 526657.96
I0910 11:16:29.386101 139724165507072 replay_runner.py:39] Average training steps per second: 526657.96
I0910 11:16:29.580169 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 24
I0910 11:16:29.650308 139724165507072 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 402794.97
I0910 11:16:29.653166 139724165507072 replay_runner.py:39] Average training steps per second: 402794.97
I0910 11:16:29.830194 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.00
INFO:tensorflow:Starting iteration 25
I0910 11:16:29.886139 139724165507072 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 807373.24
I0910 11:16:29.887620 139724165507072 replay_runner.py:39] Average training steps per second: 807373.24
I0910 11:16:30.030239 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 26
I0910 11:16:30.087312 139724165507072 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 744462.90
I0910 11:16:30.088926 139724165507072 replay_runner.py:39] Average training steps per second: 744462.90
I0910 11:16:30.237181 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 27
I0910 11:16:30.293457 139724165507072 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 816171.24

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:16:30.563418 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.00
INFO:tensorflow:Starting iteration 28
I0910 11:16:30.618850 139724165507072 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 787514.83
I0910 11:16:30.620413 139724165507072 replay_runner.py:39] Average training steps per second: 787514.83
I0910 11:16:30.746304 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.00
INFO:tensorflow:Starting iteration 29
I0910 11:16:30.879049 139724165507072 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 427728.33
I0910 11:16:30.881709 139724165507072 replay_runner.py:39] Average training steps per second: 427728.33
I0910 11:16:31.120127 139724165507072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00