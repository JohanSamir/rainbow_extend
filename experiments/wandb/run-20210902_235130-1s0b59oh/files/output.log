Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 23:51:37.039063 140099460519936 run_experiment.py:549] Creating TrainRunner ...
I0902 23:51:37.049770 140099460519936 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:37.050054 140099460519936 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:37.050250 140099460519936 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:37.050446 140099460519936 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:37.050674 140099460519936 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:37.050781 140099460519936 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:51:37.050881 140099460519936 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:37.051052 140099460519936 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:37.051222 140099460519936 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:37.051406 140099460519936 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:37.051537 140099460519936 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:37.051673 140099460519936 dqn_agent.py:283] 	 seed: 1630626697049712
I0902 23:51:37.054466 140099460519936 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:37.054683 140099460519936 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:51:37.054830 140099460519936 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:37.054942 140099460519936 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:37.055056 140099460519936 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:37.055160 140099460519936 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:37.055266 140099460519936 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:37.055358 140099460519936 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:37.055439 140099460519936 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:37.097625 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:37.500757 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:37.515534 140099460519936 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:51:37.549795 140099460519936 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:37.550107 140099460519936 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:37.550326 140099460519936 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:37.550464 140099460519936 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:37.550703 140099460519936 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:37.551046 140099460519936 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:51:37.551529 140099460519936 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:37.551892 140099460519936 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:37.552117 140099460519936 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:37.552376 140099460519936 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:37.552584 140099460519936 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:37.552851 140099460519936 dqn_agent.py:283] 	 seed: 1630626697549707
I0902 23:51:37.556115 140099460519936 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:37.556305 140099460519936 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:51:37.556469 140099460519936 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:37.556702 140099460519936 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:37.556834 140099460519936 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:37.556932 140099460519936 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:37.557026 140099460519936 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:37.557296 140099460519936 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:37.557422 140099460519936 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:37.590596 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:37.614322 140099460519936 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:51:37.614615 140099460519936 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.34
I0902 23:51:43.812793 140099460519936 replay_runner.py:36] Average training steps per second: 161.34
Steps executed: 286 Episode length: 91 Return: -391.26311507065789
I0902 23:51:45.106699 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.54
INFO:tensorflow:Starting iteration 1

Steps executed: 294 Episode length: 127 Return: -398.17565206935326
INFO:tensorflow:Average training steps per second: 222.01
I0902 23:51:53.878719 140099460519936 replay_runner.py:36] Average training steps per second: 222.01
I0902 23:51:54.132817 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.42
INFO:tensorflow:Starting iteration 2

Steps executed: 207 Episode length: 207 Return: -366.88139962586686
INFO:tensorflow:Average training steps per second: 228.62
I0902 23:52:02.766615 140099460519936 replay_runner.py:36] Average training steps per second: 228.62
I0902 23:52:02.986815 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.88
INFO:tensorflow:Starting iteration 3

Steps executed: 211 Episode length: 211 Return: -486.32413784875916
INFO:tensorflow:Average training steps per second: 231.65
I0902 23:52:11.683048 140099460519936 replay_runner.py:36] Average training steps per second: 231.65
I0902 23:52:11.892155 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.32
INFO:tensorflow:Starting iteration 4
I0902 23:52:16.307422 140099460519936 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 226.23

Steps executed: 397 Episode length: 251 Return: -504.22135045833403
I0902 23:52:21.177215 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.20
INFO:tensorflow:Starting iteration 5
I0902 23:52:25.557387 140099460519936 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.80

Steps executed: 1000 Episode length: 1000 Return: -101.00844654792922
I0902 23:52:32.005085 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.01
INFO:tensorflow:Starting iteration 6

Steps executed: 509 Episode length: 509 Return: -565.2875063062852922
INFO:tensorflow:Average training steps per second: 217.81
I0902 23:52:40.988943 140099460519936 replay_runner.py:36] Average training steps per second: 217.81
I0902 23:52:41.756240 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -565.29
INFO:tensorflow:Starting iteration 7
I0902 23:52:46.031732 140099460519936 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 226.97

Steps executed: 1000 Episode length: 1000 Return: -329.75620466351194
I0902 23:52:52.103119 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.76
INFO:tensorflow:Starting iteration 8

Steps executed: 107 Episode length: 107 Return: -173.0894901511998194
INFO:tensorflow:Average training steps per second: 228.99

Steps executed: 589 Episode length: 482 Return: -1067.029161846214594
I0902 23:53:01.831282 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -620.06
INFO:tensorflow:Starting iteration 9
I0902 23:53:06.225753 140099460519936 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 229.33

Steps executed: 1000 Episode length: 1000 Return: -72.263696644723114
I0902 23:53:14.726751 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.26
INFO:tensorflow:Starting iteration 10
I0902 23:53:19.088754 140099460519936 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 222.38

Steps executed: 682 Episode length: 682 Return: -276.7914964170650514
I0902 23:53:25.294430 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.79
INFO:tensorflow:Starting iteration 11
I0902 23:53:29.618235 140099460519936 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 216.76

Steps executed: 949 Episode length: 949 Return: -330.9804705881386514
I0902 23:53:37.457691 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.98
INFO:tensorflow:Starting iteration 12

Steps executed: 79 Episode length: 79 Return: -138.876643695979486514
INFO:tensorflow:Average training steps per second: 221.64

Steps executed: 627 Episode length: 548 Return: -295.1706514352033514
I0902 23:53:47.572697 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.02
INFO:tensorflow:Starting iteration 13

Steps executed: 231 Episode length: 58 Return: -129.24559345920636514
INFO:tensorflow:Average training steps per second: 218.62
I0902 23:53:56.361969 140099460519936 replay_runner.py:36] Average training steps per second: 218.62
I0902 23:53:56.521028 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.84
INFO:tensorflow:Starting iteration 14
I0902 23:54:00.894417 140099460519936 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 220.50

Steps executed: 1000 Episode length: 1000 Return: -10.504188092022636
I0902 23:54:07.483833 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -10.50
INFO:tensorflow:Starting iteration 15

Steps executed: 388 Episode length: 272 Return: -146.4489176431988536
INFO:tensorflow:Average training steps per second: 227.33
I0902 23:54:16.356524 140099460519936 replay_runner.py:36] Average training steps per second: 227.33
I0902 23:54:16.779175 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.22
INFO:tensorflow:Starting iteration 16

Steps executed: 691 Episode length: 691 Return: -219.2554498765354736
INFO:tensorflow:Average training steps per second: 225.74
I0902 23:54:25.648561 140099460519936 replay_runner.py:36] Average training steps per second: 225.74
I0902 23:54:27.145690 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.26
INFO:tensorflow:Starting iteration 17

Steps executed: 308 Episode length: 187 Return: -331.7777205525598436
INFO:tensorflow:Average training steps per second: 224.31
I0902 23:54:36.091261 140099460519936 replay_runner.py:36] Average training steps per second: 224.31
I0902 23:54:36.385049 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.29
INFO:tensorflow:Starting iteration 18

Steps executed: 250 Episode length: 250 Return: 16.611292685003998436
INFO:tensorflow:Average training steps per second: 231.00
I0902 23:54:45.086069 140099460519936 replay_runner.py:36] Average training steps per second: 231.00
I0902 23:54:45.414884 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.61
INFO:tensorflow:Starting iteration 19

Steps executed: 211 Episode length: 109 Return: -742.3147540327636436
INFO:tensorflow:Average training steps per second: 230.30
I0902 23:54:54.211583 140099460519936 replay_runner.py:36] Average training steps per second: 230.30
I0902 23:54:54.441852 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -792.00
INFO:tensorflow:Starting iteration 20

Steps executed: 264 Episode length: 264 Return: -675.0923177962893436
INFO:tensorflow:Average training steps per second: 235.75
I0902 23:55:02.983896 140099460519936 replay_runner.py:36] Average training steps per second: 235.75
I0902 23:55:03.328253 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -675.09
INFO:tensorflow:Starting iteration 21

Steps executed: 212 Episode length: 54 Return: -388.37832105344032436
INFO:tensorflow:Average training steps per second: 231.12
I0902 23:55:12.020759 140099460519936 replay_runner.py:36] Average training steps per second: 231.12
I0902 23:55:12.199015 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.70
INFO:tensorflow:Starting iteration 22

Steps executed: 270 Episode length: 124 Return: -323.0014350731682436
INFO:tensorflow:Average training steps per second: 230.08
I0902 23:55:20.967597 140099460519936 replay_runner.py:36] Average training steps per second: 230.08
I0902 23:55:21.224479 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.34
INFO:tensorflow:Starting iteration 23

Steps executed: 341 Episode length: 142 Return: -341.4538718386828636
INFO:tensorflow:Average training steps per second: 225.34
I0902 23:55:30.048989 140099460519936 replay_runner.py:36] Average training steps per second: 225.34
I0902 23:55:30.384158 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.25
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 76 Return: -230.57909217199813636
INFO:tensorflow:Average training steps per second: 230.37
I0902 23:55:39.022814 140099460519936 replay_runner.py:36] Average training steps per second: 230.37
I0902 23:55:39.200755 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.33
INFO:tensorflow:Starting iteration 25

Steps executed: 252 Episode length: 132 Return: -505.7330926770369536
INFO:tensorflow:Average training steps per second: 230.03
I0902 23:55:47.839377 140099460519936 replay_runner.py:36] Average training steps per second: 230.03
I0902 23:55:48.062733 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -531.94
INFO:tensorflow:Starting iteration 26

Steps executed: 260 Episode length: 139 Return: -602.6201239493868536
INFO:tensorflow:Average training steps per second: 230.39
I0902 23:55:56.741910 140099460519936 replay_runner.py:36] Average training steps per second: 230.39
I0902 23:55:56.985682 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.88
INFO:tensorflow:Starting iteration 27
I0902 23:56:01.339286 140099460519936 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 230.62
I0902 23:56:05.675820 140099460519936 replay_runner.py:36] Average training steps per second: 230.62

Steps executed: 209 Episode length: 65 Return: -222.34300078631932536
INFO:tensorflow:Starting iteration 28

Steps executed: 254 Episode length: 62 Return: -558.04911258696472536
INFO:tensorflow:Average training steps per second: 226.42
I0902 23:56:14.552624 140099460519936 replay_runner.py:36] Average training steps per second: 226.42
I0902 23:56:14.766875 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.86
INFO:tensorflow:Starting iteration 29
I0902 23:56:19.212225 140099460519936 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 228.43
I0902 23:56:23.590391 140099460519936 replay_runner.py:36] Average training steps per second: 228.43


Done fixed training!Episode length: 51 Return: -404.18945465776153536