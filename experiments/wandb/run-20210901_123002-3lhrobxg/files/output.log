Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0901 12:30:09.552969 140315766171648 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:09.564214 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:09.564582 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:09.565087 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:09.565234 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:09.565380 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:09.565581 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:09.565679 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:09.565757 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:09.565870 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:09.565975 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:09.566080 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:09.566287 140315766171648 dqn_agent.py:283] 	 seed: 1630499409564143
I0901 12:30:09.568779 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:09.568916 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:09.569009 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:09.569084 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:09.569147 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:09.569209 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:09.569307 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:09.569370 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:09.569430 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:09.774083 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:10.175390 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:10.189749 140315766171648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:10.198447 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:10.198716 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:10.198864 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:10.198983 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:10.199094 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:10.199199 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:10.199305 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:10.199661 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:10.199822 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:10.199949 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:10.200072 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:10.200191 140315766171648 dqn_agent.py:283] 	 seed: 1630499410198392
I0901 12:30:10.203103 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:10.203308 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:10.203526 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:10.203727 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:10.203871 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:10.203992 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:10.204123 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:10.204246 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:10.204402 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:10.240550 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:10.264360 140315766171648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:10.264632 140315766171648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 160.92
I0901 12:30:16.479200 140315766171648 replay_runner.py:36] Average training steps per second: 160.92
Steps executed: 287 Episode length: 111 Return: -307.55152515420343
I0901 12:30:17.757262 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.96
INFO:tensorflow:Starting iteration 1

Steps executed: 289 Episode length: 141 Return: -143.75754800949363
INFO:tensorflow:Average training steps per second: 220.48
I0901 12:30:26.713287 140315766171648 replay_runner.py:36] Average training steps per second: 220.48
I0901 12:30:26.965518 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.27
INFO:tensorflow:Starting iteration 2

Steps executed: 261 Episode length: 145 Return: -422.33551762121467
INFO:tensorflow:Average training steps per second: 217.59
I0901 12:30:35.984509 140315766171648 replay_runner.py:36] Average training steps per second: 217.59
I0901 12:30:36.242185 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.28
INFO:tensorflow:Starting iteration 3
I0901 12:30:40.602026 140315766171648 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 215.16

Steps executed: 366 Episode length: 191 Return: -163.91591371416297
I0901 12:30:45.579641 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.92
INFO:tensorflow:Starting iteration 4

Steps executed: 248 Episode length: 93 Return: -720.722401241435877
INFO:tensorflow:Average training steps per second: 230.48
I0901 12:30:54.286400 140315766171648 replay_runner.py:36] Average training steps per second: 230.48
I0901 12:30:54.492650 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.80
INFO:tensorflow:Starting iteration 5
I0901 12:30:58.783441 140315766171648 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 222.76
I0901 12:31:03.273125 140315766171648 replay_runner.py:36] Average training steps per second: 222.76

Steps executed: 200 Episode length: 121 Return: -372.74532833494607
INFO:tensorflow:Starting iteration 6

Steps executed: 209 Episode length: 88 Return: -307.843628348099392
INFO:tensorflow:Average training steps per second: 223.03
I0901 12:31:12.210325 140315766171648 replay_runner.py:36] Average training steps per second: 223.03
I0901 12:31:12.383137 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.39
INFO:tensorflow:Starting iteration 7
I0901 12:31:16.813899 140315766171648 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 218.96

Steps executed: 321 Episode length: 131 Return: -16.175591491969644
I0901 12:31:21.657685 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.53
INFO:tensorflow:Starting iteration 8

Steps executed: 247 Episode length: 158 Return: -10.901016934797568
INFO:tensorflow:Average training steps per second: 228.60
I0901 12:31:30.287698 140315766171648 replay_runner.py:36] Average training steps per second: 228.60
I0901 12:31:30.534000 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.31
INFO:tensorflow:Starting iteration 9

Steps executed: 277 Episode length: 163 Return: -23.868157418634496
INFO:tensorflow:Average training steps per second: 223.71
I0901 12:31:39.177926 140315766171648 replay_runner.py:36] Average training steps per second: 223.71
I0901 12:31:39.405684 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.58
INFO:tensorflow:Starting iteration 10

Steps executed: 228 Episode length: 142 Return: -89.785768327154066
INFO:tensorflow:Average training steps per second: 221.36
I0901 12:31:48.220190 140315766171648 replay_runner.py:36] Average training steps per second: 221.36
I0901 12:31:48.412566 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.50
INFO:tensorflow:Starting iteration 11

Steps executed: 239 Episode length: 94 Return: 19.20650835039737256
INFO:tensorflow:Average training steps per second: 216.88
I0901 12:31:57.419469 140315766171648 replay_runner.py:36] Average training steps per second: 216.88
I0901 12:31:57.576776 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.27
INFO:tensorflow:Starting iteration 12

Steps executed: 408 Episode length: 214 Return: -98.929579688544856
INFO:tensorflow:Average training steps per second: 218.57
I0901 12:32:06.506587 140315766171648 replay_runner.py:36] Average training steps per second: 218.57
I0901 12:32:06.867774 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.05
INFO:tensorflow:Starting iteration 13

Steps executed: 231 Episode length: 108 Return: -324.00577973295617
INFO:tensorflow:Average training steps per second: 213.16
I0901 12:32:15.931720 140315766171648 replay_runner.py:36] Average training steps per second: 213.16
I0901 12:32:16.128726 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.85
INFO:tensorflow:Starting iteration 14

Steps executed: 252 Episode length: 75 Return: -193.599837704768167
INFO:tensorflow:Average training steps per second: 216.29
I0901 12:32:24.995251 140315766171648 replay_runner.py:36] Average training steps per second: 216.29
I0901 12:32:25.167409 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.39
INFO:tensorflow:Starting iteration 15

Steps executed: 253 Episode length: 77 Return: -391.075197663687857
INFO:tensorflow:Average training steps per second: 215.19
I0901 12:32:34.164645 140315766171648 replay_runner.py:36] Average training steps per second: 215.19
I0901 12:32:34.345225 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.92
INFO:tensorflow:Starting iteration 16

Steps executed: 255 Episode length: 61 Return: -222.832843673387377
INFO:tensorflow:Average training steps per second: 213.55
I0901 12:32:43.425656 140315766171648 replay_runner.py:36] Average training steps per second: 213.55
I0901 12:32:43.604754 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.29
INFO:tensorflow:Starting iteration 17

Steps executed: 315 Episode length: 213 Return: -223.49918491307525
INFO:tensorflow:Average training steps per second: 212.49
I0901 12:32:52.676766 140315766171648 replay_runner.py:36] Average training steps per second: 212.49
I0901 12:32:52.952251 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.39
INFO:tensorflow:Starting iteration 18

Steps executed: 212 Episode length: 57 Return: -111.807032189030545
INFO:tensorflow:Average training steps per second: 218.87
I0901 12:33:01.917167 140315766171648 replay_runner.py:36] Average training steps per second: 218.87
I0901 12:33:02.073580 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.86
INFO:tensorflow:Starting iteration 19
I0901 12:33:06.502568 140315766171648 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 216.91

Steps executed: 491 Episode length: 491 Return: -243.32587832655415
I0901 12:33:11.945579 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.33
INFO:tensorflow:Starting iteration 20

Steps executed: 248 Episode length: 111 Return: -393.63871495512706
INFO:tensorflow:Average training steps per second: 220.39
I0901 12:33:20.889037 140315766171648 replay_runner.py:36] Average training steps per second: 220.39
I0901 12:33:21.125935 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.75
INFO:tensorflow:Starting iteration 21

Steps executed: 266 Episode length: 112 Return: -690.65840436236946
INFO:tensorflow:Average training steps per second: 217.69
I0901 12:33:30.132750 140315766171648 replay_runner.py:36] Average training steps per second: 217.69
I0901 12:33:30.402071 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -798.01
INFO:tensorflow:Starting iteration 22

Steps executed: 292 Episode length: 96 Return: -476.592099276274256
INFO:tensorflow:Average training steps per second: 221.08
I0901 12:33:39.356308 140315766171648 replay_runner.py:36] Average training steps per second: 221.08
I0901 12:33:39.560380 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.42
INFO:tensorflow:Starting iteration 23

Steps executed: 206 Episode length: 62 Return: -158.261497826311856
INFO:tensorflow:Average training steps per second: 219.65
I0901 12:33:48.539819 140315766171648 replay_runner.py:36] Average training steps per second: 219.65
I0901 12:33:48.681101 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.10
INFO:tensorflow:Starting iteration 24

Steps executed: 196 Episode length: 60 Return: -134.419897305727436
INFO:tensorflow:Average training steps per second: 223.34
I0901 12:33:57.515893 140315766171648 replay_runner.py:36] Average training steps per second: 223.34

Steps executed: 278 Episode length: 82 Return: -185.773692452801476
INFO:tensorflow:Starting iteration 25

Steps executed: 242 Episode length: 59 Return: -308.713295710214656
INFO:tensorflow:Average training steps per second: 232.76
I0901 12:34:06.191427 140315766171648 replay_runner.py:36] Average training steps per second: 232.76
I0901 12:34:06.395758 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.94
INFO:tensorflow:Starting iteration 26

Steps executed: 250 Episode length: 53 Return: -147.620718717334236
INFO:tensorflow:Average training steps per second: 216.75
I0901 12:34:15.393445 140315766171648 replay_runner.py:36] Average training steps per second: 216.75
I0901 12:34:15.573426 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.00
INFO:tensorflow:Starting iteration 27

Steps executed: 203 Episode length: 52 Return: -141.161623230198276
INFO:tensorflow:Average training steps per second: 217.82
I0901 12:34:24.555985 140315766171648 replay_runner.py:36] Average training steps per second: 217.82
I0901 12:34:24.726320 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.32
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 60 Return: 40.26088412438332476
INFO:tensorflow:Average training steps per second: 231.92
I0901 12:34:33.500475 140315766171648 replay_runner.py:36] Average training steps per second: 231.92
I0901 12:34:33.634266 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 29

Steps executed: 212 Episode length: 82 Return: -676.996169257036976
INFO:tensorflow:Average training steps per second: 215.53
I0901 12:34:42.748492 140315766171648 replay_runner.py:36] Average training steps per second: 215.53

Done fixed training!Episode length: 82 Return: -676.996169257036976