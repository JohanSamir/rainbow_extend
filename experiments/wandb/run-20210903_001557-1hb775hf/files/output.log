I0903 00:16:03.239965 140310902786048 run_experiment.py:549] Creating TrainRunner ...
I0903 00:16:03.247878 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:16:03.248008 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:16:03.248083 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:16:03.248154 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:16:03.248210 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0903 00:16:03.248296 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:16:03.248415 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:16:03.248532 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:16:03.248606 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:16:03.248715 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0903 00:16:03.248822 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:16:03.248944 140310902786048 dqn_agent.py:283] 	 seed: 1630628163247834
I0903 00:16:03.250837 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:16:03.250953 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:16:03.251129 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:16:03.251204 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:16:03.251264 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:16:03.251343 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:16:03.251432 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:16:03.251535 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:16:03.251612 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:16:03.276577 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:03.533571 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:03.543704 140310902786048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:16:03.550450 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:16:03.550598 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:16:03.550705 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:16:03.550885 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:16:03.550961 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0903 00:16:03.551053 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:16:03.551120 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:16:03.551204 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:16:03.551286 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:16:03.551366 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0903 00:16:03.551438 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:16:03.551518 140310902786048 dqn_agent.py:283] 	 seed: 1630628163550425
I0903 00:16:03.553103 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:16:03.553223 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:16:03.553303 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:16:03.553391 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:16:03.553519 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:16:03.553615 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:16:03.553747 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:16:03.553840 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:16:03.553926 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:16:03.574423 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:03.590401 140310902786048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:16:03.590550 140310902786048 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
Steps executed: 233 Episode length: 77 Return: -628.1576395478503
INFO:tensorflow:Average training steps per second: 245.63
I0903 00:16:07.661787 140310902786048 replay_runner.py:36] Average training steps per second: 245.63
I0903 00:16:08.440791 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -556.75
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 127 Return: -501.13366789208055
INFO:tensorflow:Average training steps per second: 326.33
I0903 00:16:14.881077 140310902786048 replay_runner.py:36] Average training steps per second: 326.33
I0903 00:16:15.015282 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -604.16
INFO:tensorflow:Starting iteration 2

Steps executed: 346 Episode length: 173 Return: -493.66880571331194
INFO:tensorflow:Average training steps per second: 320.88
I0903 00:16:21.528231 140310902786048 replay_runner.py:36] Average training steps per second: 320.88
I0903 00:16:21.787957 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -564.84
INFO:tensorflow:Starting iteration 3

Steps executed: 317 Episode length: 118 Return: -601.35828877113293
INFO:tensorflow:Average training steps per second: 337.58
I0903 00:16:28.133059 140310902786048 replay_runner.py:36] Average training steps per second: 337.58
I0903 00:16:28.332254 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.57
INFO:tensorflow:Starting iteration 4

Steps executed: 302 Episode length: 173 Return: -75.740069311278833
INFO:tensorflow:Average training steps per second: 336.00
I0903 00:16:34.665136 140310902786048 replay_runner.py:36] Average training steps per second: 336.00
I0903 00:16:34.860717 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.53
INFO:tensorflow:Starting iteration 5

Steps executed: 502 Episode length: 502 Return: -468.85742432444914
INFO:tensorflow:Average training steps per second: 327.83
I0903 00:16:41.263319 140310902786048 replay_runner.py:36] Average training steps per second: 327.83
I0903 00:16:42.051809 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.86
INFO:tensorflow:Starting iteration 6

Steps executed: 312 Episode length: 312 Return: -141.62574505430095
INFO:tensorflow:Average training steps per second: 321.86
I0903 00:16:48.475055 140310902786048 replay_runner.py:36] Average training steps per second: 321.86
I0903 00:16:48.800519 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.63
INFO:tensorflow:Starting iteration 7

Steps executed: 380 Episode length: 380 Return: -1068.0872434665234
INFO:tensorflow:Average training steps per second: 321.86
I0903 00:16:55.185546 140310902786048 replay_runner.py:36] Average training steps per second: 321.86
I0903 00:16:55.663346 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -1068.09
INFO:tensorflow:Starting iteration 8

Steps executed: 277 Episode length: 277 Return: -512.93474328185384
INFO:tensorflow:Average training steps per second: 327.69
I0903 00:17:02.014324 140310902786048 replay_runner.py:36] Average training steps per second: 327.69
I0903 00:17:02.249048 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -512.93
INFO:tensorflow:Starting iteration 9

Steps executed: 344 Episode length: 344 Return: -161.91871426072134
INFO:tensorflow:Average training steps per second: 325.98
I0903 00:17:08.728980 140310902786048 replay_runner.py:36] Average training steps per second: 325.98
I0903 00:17:09.030676 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.92
INFO:tensorflow:Starting iteration 10

Steps executed: 265 Episode length: 83 Return: -176.795511982536375
INFO:tensorflow:Average training steps per second: 329.89
I0903 00:17:15.456282 140310902786048 replay_runner.py:36] Average training steps per second: 329.89
I0903 00:17:15.629456 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.83
INFO:tensorflow:Starting iteration 11

Steps executed: 399 Episode length: 399 Return: -346.02679755059635
INFO:tensorflow:Average training steps per second: 329.38
I0903 00:17:22.081262 140310902786048 replay_runner.py:36] Average training steps per second: 329.38
I0903 00:17:22.523848 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.03
INFO:tensorflow:Starting iteration 12

Steps executed: 397 Episode length: 281 Return: -237.79122702589697
INFO:tensorflow:Average training steps per second: 332.39
I0903 00:17:28.865672 140310902786048 replay_runner.py:36] Average training steps per second: 332.39
I0903 00:17:29.171973 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.27
INFO:tensorflow:Starting iteration 13

Steps executed: 226 Episode length: 168 Return: -83.868112775913897
INFO:tensorflow:Average training steps per second: 337.64
I0903 00:17:35.510851 140310902786048 replay_runner.py:36] Average training steps per second: 337.64
I0903 00:17:35.645257 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.16
INFO:tensorflow:Starting iteration 14

Steps executed: 232 Episode length: 59 Return: -139.254978184388974
INFO:tensorflow:Average training steps per second: 352.76
I0903 00:17:41.891782 140310902786048 replay_runner.py:36] Average training steps per second: 352.76
I0903 00:17:42.071321 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -583.24
INFO:tensorflow:Starting iteration 15

Steps executed: 167 Episode length: 167 Return: -996.66862849544954
INFO:tensorflow:Average training steps per second: 341.86

Steps executed: 1167 Episode length: 1000 Return: -251.77541905367076
I0903 00:17:51.023269 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.22
INFO:tensorflow:Starting iteration 16
I0903 00:17:54.258820 140310902786048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 305.79

Steps executed: 235 Episode length: 95 Return: -702.90274426291147076
I0903 00:17:57.686277 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.34
INFO:tensorflow:Starting iteration 17

Steps executed: 241 Episode length: 129 Return: -177.5354075387111876
INFO:tensorflow:Average training steps per second: 315.71
I0903 00:18:04.046732 140310902786048 replay_runner.py:36] Average training steps per second: 315.71
I0903 00:18:04.195944 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.52
INFO:tensorflow:Starting iteration 18

Steps executed: 235 Episode length: 75 Return: -185.18824634974604576
INFO:tensorflow:Average training steps per second: 309.08
I0903 00:18:10.824315 140310902786048 replay_runner.py:36] Average training steps per second: 309.08
I0903 00:18:10.975280 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.32
INFO:tensorflow:Starting iteration 19

Steps executed: 215 Episode length: 110 Return: -688.7437279495329576
INFO:tensorflow:Average training steps per second: 313.07
I0903 00:18:17.393377 140310902786048 replay_runner.py:36] Average training steps per second: 313.07
I0903 00:18:17.534754 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.66
INFO:tensorflow:Starting iteration 20

Steps executed: 258 Episode length: 80 Return: 11.9163801818185826576
INFO:tensorflow:Average training steps per second: 307.65
I0903 00:18:23.998250 140310902786048 replay_runner.py:36] Average training steps per second: 307.65
I0903 00:18:24.164786 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.30
INFO:tensorflow:Starting iteration 21

Steps executed: 234 Episode length: 57 Return: -127.84620749783122576
INFO:tensorflow:Average training steps per second: 316.86
I0903 00:18:30.603678 140310902786048 replay_runner.py:36] Average training steps per second: 316.86
I0903 00:18:30.749369 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.98
INFO:tensorflow:Starting iteration 22

Steps executed: 220 Episode length: 117 Return: -651.2888952770695576
INFO:tensorflow:Average training steps per second: 309.11
I0903 00:18:37.237548 140310902786048 replay_runner.py:36] Average training steps per second: 309.11
I0903 00:18:37.396596 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -765.78
INFO:tensorflow:Starting iteration 23

Steps executed: 208 Episode length: 88 Return: -113.92252960951699576
INFO:tensorflow:Average training steps per second: 327.10
I0903 00:18:43.708511 140310902786048 replay_runner.py:36] Average training steps per second: 327.10
I0903 00:18:43.825117 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.34
INFO:tensorflow:Starting iteration 24

Steps executed: 226 Episode length: 87 Return: -769.87200584546429576
INFO:tensorflow:Average training steps per second: 333.01
I0903 00:18:50.038812 140310902786048 replay_runner.py:36] Average training steps per second: 333.01
I0903 00:18:50.184563 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.54
INFO:tensorflow:Starting iteration 25

Steps executed: 245 Episode length: 69 Return: -157.27348463319913576
INFO:tensorflow:Average training steps per second: 362.39
I0903 00:18:56.206192 140310902786048 replay_runner.py:36] Average training steps per second: 362.39
I0903 00:18:56.373510 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.07
INFO:tensorflow:Starting iteration 26

Steps executed: 247 Episode length: 57 Return: -438.82100638767333576
INFO:tensorflow:Average training steps per second: 349.83
I0903 00:19:02.605219 140310902786048 replay_runner.py:36] Average training steps per second: 349.83
I0903 00:19:02.737660 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.26
INFO:tensorflow:Starting iteration 27

Steps executed: 220 Episode length: 77 Return: -128.21235744810411576
INFO:tensorflow:Average training steps per second: 326.08
I0903 00:19:09.167185 140310902786048 replay_runner.py:36] Average training steps per second: 326.08
I0903 00:19:09.274799 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.99
INFO:tensorflow:Starting iteration 28

Steps executed: 242 Episode length: 89 Return: -516.04551619269571576
INFO:tensorflow:Average training steps per second: 325.66
I0903 00:19:15.619218 140310902786048 replay_runner.py:36] Average training steps per second: 325.66
I0903 00:19:15.771677 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -581.77
INFO:tensorflow:Starting iteration 29

Steps executed: 256 Episode length: 75 Return: -493.27952846573146576
INFO:tensorflow:Average training steps per second: 338.33
I0903 00:19:21.956139 140310902786048 replay_runner.py:36] Average training steps per second: 338.33

Done fixed training!Episode length: 75 Return: -493.27952846573146576