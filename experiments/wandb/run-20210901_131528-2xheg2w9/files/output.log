Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 13:15:34.096583 140460307478528 run_experiment.py:549] Creating TrainRunner ...
I0901 13:15:34.105484 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:34.105674 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:34.105801 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:34.105959 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:34.106078 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:34.106228 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:34.106309 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:34.106410 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:34.106598 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:34.106678 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:34.106759 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:34.106834 140460307478528 dqn_agent.py:283] 	 seed: 1630502134105437
I0901 13:15:34.109095 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:34.109243 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:34.109345 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:34.109433 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:34.109511 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:34.109618 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:34.109726 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:34.109835 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:34.109906 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:34.140972 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:34.422650 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:34.432786 140460307478528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:15:34.440109 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:34.440243 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:34.440315 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:34.440376 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:34.440431 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:34.440504 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:34.440593 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:34.440671 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:34.440736 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:34.440791 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:34.440865 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:34.440930 140460307478528 dqn_agent.py:283] 	 seed: 1630502134440080
I0901 13:15:34.442353 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:34.442468 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:34.442538 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:34.442606 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:34.442670 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:34.442726 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:34.442795 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:34.442883 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:34.442974 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:34.466397 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:34.481516 140460307478528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:15:34.481682 140460307478528 replay_runner.py:41] Starting iteration 0
Steps executed: 212 Episode length: 124 Return: -458.1189887653332
INFO:tensorflow:Average training steps per second: 248.77
I0901 13:15:38.501554 140460307478528 replay_runner.py:36] Average training steps per second: 248.77
I0901 13:15:39.189813 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.48
INFO:tensorflow:Starting iteration 1

Steps executed: 272 Episode length: 102 Return: -281.4693634970696
INFO:tensorflow:Average training steps per second: 381.17
I0901 13:15:45.194639 140460307478528 replay_runner.py:36] Average training steps per second: 381.17
I0901 13:15:45.332783 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.14
INFO:tensorflow:Starting iteration 2

Steps executed: 148 Episode length: 148 Return: -85.10435745351486
INFO:tensorflow:Average training steps per second: 345.59
I0901 13:15:51.610256 140460307478528 replay_runner.py:36] Average training steps per second: 345.59

Steps executed: 308 Episode length: 160 Return: -163.8159298485943
INFO:tensorflow:Starting iteration 3

Steps executed: 247 Episode length: 76 Return: -175.39126602685442
INFO:tensorflow:Average training steps per second: 335.00
I0901 13:15:58.140543 140460307478528 replay_runner.py:36] Average training steps per second: 335.00
I0901 13:15:58.297318 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.79
INFO:tensorflow:Starting iteration 4

Steps executed: 207 Episode length: 207 Return: -21.462097004137973
INFO:tensorflow:Average training steps per second: 343.90
I0901 13:16:04.629881 140460307478528 replay_runner.py:36] Average training steps per second: 343.90
I0901 13:16:04.754531 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -21.46
INFO:tensorflow:Starting iteration 5

Steps executed: 318 Episode length: 146 Return: -403.91092683162973
INFO:tensorflow:Average training steps per second: 363.53
I0901 13:16:10.974626 140460307478528 replay_runner.py:36] Average training steps per second: 363.53
I0901 13:16:11.152442 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.61
INFO:tensorflow:Starting iteration 6

Steps executed: 209 Episode length: 133 Return: -290.24941201014623
INFO:tensorflow:Average training steps per second: 354.90
I0901 13:16:17.450961 140460307478528 replay_runner.py:36] Average training steps per second: 354.90
I0901 13:16:17.576730 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.40
INFO:tensorflow:Starting iteration 7
I0901 13:16:21.054187 140460307478528 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 338.44

Steps executed: 264 Episode length: 97 Return: -407.058868248756653
I0901 13:16:24.186295 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.28
INFO:tensorflow:Starting iteration 8

Steps executed: 331 Episode length: 157 Return: -243.78577027123836
INFO:tensorflow:Average training steps per second: 351.43
I0901 13:16:30.518711 140460307478528 replay_runner.py:36] Average training steps per second: 351.43
I0901 13:16:30.741180 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.57
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 75 Return: -112.929961507249226
INFO:tensorflow:Average training steps per second: 352.31
I0901 13:16:37.105865 140460307478528 replay_runner.py:36] Average training steps per second: 352.31
I0901 13:16:37.226805 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.43
INFO:tensorflow:Starting iteration 10

Steps executed: 219 Episode length: 111 Return: -154.70882408911595
INFO:tensorflow:Average training steps per second: 346.52
I0901 13:16:43.612079 140460307478528 replay_runner.py:36] Average training steps per second: 346.52
I0901 13:16:43.734468 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.51
INFO:tensorflow:Starting iteration 11
I0901 13:16:47.246621 140460307478528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 353.60

Steps executed: 255 Episode length: 90 Return: -188.155766662061724
I0901 13:16:50.230539 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.41
INFO:tensorflow:Starting iteration 12

Steps executed: 263 Episode length: 82 Return: -338.307962426362054
INFO:tensorflow:Average training steps per second: 358.45
I0901 13:16:56.559090 140460307478528 replay_runner.py:36] Average training steps per second: 358.45
I0901 13:16:56.710540 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.75
INFO:tensorflow:Starting iteration 13

Steps executed: 275 Episode length: 275 Return: -386.70049220084654
INFO:tensorflow:Average training steps per second: 354.10
I0901 13:17:03.067557 140460307478528 replay_runner.py:36] Average training steps per second: 354.10
I0901 13:17:03.291050 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.70
INFO:tensorflow:Starting iteration 14

Steps executed: 255 Episode length: 88 Return: -153.850464802850724
INFO:tensorflow:Average training steps per second: 347.04
I0901 13:17:09.688787 140460307478528 replay_runner.py:36] Average training steps per second: 347.04
I0901 13:17:09.825283 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.44
INFO:tensorflow:Starting iteration 15

Steps executed: 236 Episode length: 119 Return: -315.53468306770185
INFO:tensorflow:Average training steps per second: 343.31
I0901 13:17:16.264260 140460307478528 replay_runner.py:36] Average training steps per second: 343.31
I0901 13:17:16.417934 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.37
INFO:tensorflow:Starting iteration 16

Steps executed: 291 Episode length: 97 Return: -514.871741443743585
INFO:tensorflow:Average training steps per second: 343.61
I0901 13:17:22.831788 140460307478528 replay_runner.py:36] Average training steps per second: 343.61
I0901 13:17:23.001134 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.99
INFO:tensorflow:Starting iteration 17

Steps executed: 325 Episode length: 325 Return: -168.25622614813995
INFO:tensorflow:Average training steps per second: 343.38
I0901 13:17:29.429550 140460307478528 replay_runner.py:36] Average training steps per second: 343.38
I0901 13:17:29.678241 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.26
INFO:tensorflow:Starting iteration 18

Steps executed: 440 Episode length: 244 Return: -59.755783676073335
INFO:tensorflow:Average training steps per second: 341.49
I0901 13:17:36.073389 140460307478528 replay_runner.py:36] Average training steps per second: 341.49
I0901 13:17:36.326226 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.96
INFO:tensorflow:Starting iteration 19

Steps executed: 778 Episode length: 673 Return: -263.72270232996937
INFO:tensorflow:Average training steps per second: 340.01
I0901 13:17:42.729529 140460307478528 replay_runner.py:36] Average training steps per second: 340.01
I0901 13:17:43.689720 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.02
INFO:tensorflow:Starting iteration 20
I0901 13:17:47.175063 140460307478528 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 346.91

Steps executed: 283 Episode length: 86 Return: -316.657197022171157
I0901 13:17:50.229306 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.86
INFO:tensorflow:Starting iteration 21

Steps executed: 259 Episode length: 102 Return: -352.31973690808477
INFO:tensorflow:Average training steps per second: 339.28
I0901 13:17:56.641064 140460307478528 replay_runner.py:36] Average training steps per second: 339.28
I0901 13:17:56.800713 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.32
INFO:tensorflow:Starting iteration 22

Steps executed: 240 Episode length: 52 Return: -116.332187437434857
INFO:tensorflow:Average training steps per second: 343.65
I0901 13:18:03.197751 140460307478528 replay_runner.py:36] Average training steps per second: 343.65
I0901 13:18:03.333423 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.79
INFO:tensorflow:Starting iteration 23

Steps executed: 209 Episode length: 65 Return: -295.066308651218157
INFO:tensorflow:Average training steps per second: 344.19
I0901 13:18:09.770672 140460307478528 replay_runner.py:36] Average training steps per second: 344.19
I0901 13:18:09.890242 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.33
INFO:tensorflow:Starting iteration 24
I0901 13:18:13.359981 140460307478528 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 346.01

Steps executed: 244 Episode length: 56 Return: -232.562880405185927
I0901 13:18:16.403275 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.31
INFO:tensorflow:Starting iteration 25

Steps executed: 244 Episode length: 66 Return: -223.363484153265867
INFO:tensorflow:Average training steps per second: 346.88
I0901 13:18:22.771922 140460307478528 replay_runner.py:36] Average training steps per second: 346.88
I0901 13:18:22.917786 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.10
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 63 Return: -251.316744403654677
INFO:tensorflow:Average training steps per second: 342.74
I0901 13:18:29.306830 140460307478528 replay_runner.py:36] Average training steps per second: 342.74
I0901 13:18:29.435907 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.42
INFO:tensorflow:Starting iteration 27
I0901 13:18:32.870709 140460307478528 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 351.52
I0901 13:18:35.715801 140460307478528 replay_runner.py:36] Average training steps per second: 351.52

Steps executed: 500 Episode length: 500 Return: -168.20710328095458
INFO:tensorflow:Starting iteration 28

Steps executed: 279 Episode length: 142 Return: -434.83103336428728
INFO:tensorflow:Average training steps per second: 346.53
I0901 13:18:42.649373 140460307478528 replay_runner.py:36] Average training steps per second: 346.53
I0901 13:18:42.818810 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.92
INFO:tensorflow:Starting iteration 29

Steps executed: 225 Episode length: 78 Return: -524.517790870277828
INFO:tensorflow:Average training steps per second: 370.75
I0901 13:18:48.953504 140460307478528 replay_runner.py:36] Average training steps per second: 370.75

Done fixed training!Episode length: 78 Return: -524.517790870277828