I0902 11:21:06.405647 139852214515712 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 11:21:06.406181 139852214515712 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 11:21:06.461056 139852214515712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:06.462135 139852214515712 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:06.462202 139852214515712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:06.462258 139852214515712 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:06.462312 139852214515712 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:06.462396 139852214515712 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:21:06.462448 139852214515712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:06.462501 139852214515712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:06.462553 139852214515712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:06.462602 139852214515712 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:06.462696 139852214515712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:06.462752 139852214515712 dqn_agent.py:283] 	 seed: 1630581666461003
I0902 11:21:06.464365 139852214515712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:06.464499 139852214515712 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:21:06.464557 139852214515712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:06.464648 139852214515712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:06.464710 139852214515712 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:06.464765 139852214515712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:06.464819 139852214515712 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:06.465251 139852214515712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:06.465378 139852214515712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:07.875354 139852214515712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 11:21:08.224501 139852214515712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.232531 139852214515712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:21:08.236660 139852214515712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:08.236810 139852214515712 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:08.236893 139852214515712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:08.236987 139852214515712 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:08.237046 139852214515712 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:08.237100 139852214515712 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:21:08.237154 139852214515712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:08.237239 139852214515712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:08.237296 139852214515712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:08.237359 139852214515712 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:08.237435 139852214515712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:08.237505 139852214515712 dqn_agent.py:283] 	 seed: 1630581668236625
I0902 11:21:08.239014 139852214515712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:08.239140 139852214515712 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:21:08.239213 139852214515712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:08.239291 139852214515712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:08.239352 139852214515712 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:08.239423 139852214515712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:08.239484 139852214515712 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:08.239566 139852214515712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:08.239634 139852214515712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.259941 139852214515712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.271807 139852214515712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:21:08.272005 139852214515712 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 155.94
I0902 11:21:14.684845 139852214515712 replay_runner.py:36] Average training steps per second: 155.94
I0902 11:21:15.998754 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 337 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 193.38
I0902 11:21:21.344937 139852214515712 replay_runner.py:36] Average training steps per second: 193.38
I0902 11:21:21.647733 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.50
INFO:tensorflow:Starting iteration 2

Steps executed: 285 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 192.40
I0902 11:21:27.075229 139852214515712 replay_runner.py:36] Average training steps per second: 192.40
I0902 11:21:27.297230 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 3

Steps executed: 286 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 185.20
I0902 11:21:32.923875 139852214515712 replay_runner.py:36] Average training steps per second: 185.20
I0902 11:21:33.197531 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.84
I0902 11:21:38.395751 139852214515712 replay_runner.py:36] Average training steps per second: 202.84
I0902 11:21:38.791484 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 212 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 186.28
I0902 11:21:44.401307 139852214515712 replay_runner.py:36] Average training steps per second: 186.28
I0902 11:21:44.568545 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 6
I0902 11:21:44.802384 139852214515712 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.27

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 11:21:50.259541 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 11:21:50.510607 139852214515712 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.94
I0902 11:21:55.748599 139852214515712 replay_runner.py:36] Average training steps per second: 190.94
I0902 11:21:56.154479 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 259 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 202.26
I0902 11:22:01.317968 139852214515712 replay_runner.py:36] Average training steps per second: 202.26
I0902 11:22:01.547583 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.82
I0902 11:22:07.074605 139852214515712 replay_runner.py:36] Average training steps per second: 189.82
I0902 11:22:07.489939 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 11:22:07.738743 139852214515712 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 199.74
I0902 11:22:12.745848 139852214515712 replay_runner.py:36] Average training steps per second: 199.74
I0902 11:22:13.171097 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 11:22:13.404170 139852214515712 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 198.01

Steps executed: 653 Episode length: 500 Return: -500.0
I0902 11:22:18.974699 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.00
INFO:tensorflow:Starting iteration 12
I0902 11:22:19.213819 139852214515712 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 199.05

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 11:22:24.650704 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 11:22:24.909904 139852214515712 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 196.79
I0902 11:22:29.991983 139852214515712 replay_runner.py:36] Average training steps per second: 196.79
I0902 11:22:30.387203 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 254 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 201.86
I0902 11:22:35.558590 139852214515712 replay_runner.py:36] Average training steps per second: 201.86
I0902 11:22:35.774928 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 15

Steps executed: 264 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 199.27
I0902 11:22:41.036398 139852214515712 replay_runner.py:36] Average training steps per second: 199.27
I0902 11:22:41.247193 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 16
I0902 11:22:41.476238 139852214515712 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 200.01
I0902 11:22:46.476362 139852214515712 replay_runner.py:36] Average training steps per second: 200.01
I0902 11:22:46.910997 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17


Steps executed: 242 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 200.59
I0902 11:22:52.128543 139852214515712 replay_runner.py:36] Average training steps per second: 200.59
I0902 11:22:52.322147 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 18

Steps executed: 249 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 202.22
I0902 11:22:57.517404 139852214515712 replay_runner.py:36] Average training steps per second: 202.22
I0902 11:22:57.721111 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.87
I0902 11:23:02.989725 139852214515712 replay_runner.py:36] Average training steps per second: 198.87
I0902 11:23:03.407902 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 265 Episode length: 149 Return: -148.0
INFO:tensorflow:Average training steps per second: 202.44
I0902 11:23:08.604017 139852214515712 replay_runner.py:36] Average training steps per second: 202.44
I0902 11:23:08.821667 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.50
INFO:tensorflow:Starting iteration 21
I0902 11:23:09.071023 139852214515712 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 201.76
I0902 11:23:14.028060 139852214515712 replay_runner.py:36] Average training steps per second: 201.76
I0902 11:23:14.252765 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 22


Steps executed: 228 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 199.58
I0902 11:23:19.498614 139852214515712 replay_runner.py:36] Average training steps per second: 199.58
I0902 11:23:19.685210 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00
INFO:tensorflow:Starting iteration 23

Steps executed: 268 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 196.26
I0902 11:23:25.027963 139852214515712 replay_runner.py:36] Average training steps per second: 196.26
I0902 11:23:25.255229 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 24
I0902 11:23:25.497387 139852214515712 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 202.38

Steps executed: 197 Episode length: 107 Return: -106.0
I0902 11:23:30.700136 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 25

Steps executed: 290 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 193.11
I0902 11:23:36.124774 139852214515712 replay_runner.py:36] Average training steps per second: 193.11
I0902 11:23:36.322618 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33
INFO:tensorflow:Starting iteration 26


Steps executed: 234 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 205.99
I0902 11:23:41.430916 139852214515712 replay_runner.py:36] Average training steps per second: 205.99
I0902 11:23:41.627112 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 27

Steps executed: 266 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 196.61
I0902 11:23:46.947727 139852214515712 replay_runner.py:36] Average training steps per second: 196.61
I0902 11:23:47.179670 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 28

Steps executed: 275 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 198.30
I0902 11:23:52.455074 139852214515712 replay_runner.py:36] Average training steps per second: 198.30
I0902 11:23:52.686165 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 225.02
I0902 11:23:57.373904 139852214515712 replay_runner.py:36] Average training steps per second: 225.02
I0902 11:23:57.538783 139852214515712 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33