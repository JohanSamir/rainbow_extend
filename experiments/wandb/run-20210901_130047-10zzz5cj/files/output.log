I0901 13:00:54.311470 140457859885056 run_experiment.py:549] Creating TrainRunner ...
I0901 13:00:54.322662 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:54.322964 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:54.323134 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:54.323275 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:54.323400 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:54.323530 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:54.323650 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:54.323774 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:54.323890 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:54.324016 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:54.324136 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:54.324315 140457859885056 dqn_agent.py:283] 	 seed: 1630501254322596
I0901 13:00:54.327944 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:54.328342 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:00:54.328516 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:54.328608 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:54.328685 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:54.328766 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:54.328895 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:54.329040 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:54.329116 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 13:00:56.093126 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.763156 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.780790 140457859885056 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:00:56.793102 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:56.793433 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:56.793615 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:56.793786 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:56.793917 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:56.794044 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:56.794295 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:56.794461 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:56.794584 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:56.794807 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:56.794952 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:56.795079 140457859885056 dqn_agent.py:283] 	 seed: 1630501256793040
I0901 13:00:56.798090 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:56.798339 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:00:56.798480 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:56.798603 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:56.798711 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:56.798822 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:56.799064 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:56.799255 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:56.799432 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:56.864937 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.891153 140457859885056 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:00:56.891860 140457859885056 replay_runner.py:41] Starting iteration 0
Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 137.29
I0901 13:01:04.176156 140457859885056 replay_runner.py:36] Average training steps per second: 137.29
I0901 13:01:05.465311 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 184.85
I0901 13:01:11.058047 140457859885056 replay_runner.py:36] Average training steps per second: 184.85
I0901 13:01:11.205065 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 2

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 186.80
I0901 13:01:16.752180 140457859885056 replay_runner.py:36] Average training steps per second: 186.80
I0901 13:01:16.900384 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.96
INFO:tensorflow:Starting iteration 3

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 189.37
I0901 13:01:22.388520 140457859885056 replay_runner.py:36] Average training steps per second: 189.37
I0901 13:01:22.532714 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 4

Steps executed: 142 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 189.65

Steps executed: 208 Episode length: 9 Return: 9.0.0
I0901 13:01:28.148982 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 199.01
I0901 13:01:33.370069 140457859885056 replay_runner.py:36] Average training steps per second: 199.01
I0901 13:01:33.514245 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6

Steps executed: 201 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 193.53
I0901 13:01:38.879117 140457859885056 replay_runner.py:36] Average training steps per second: 193.53
I0901 13:01:39.018268 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.17
INFO:tensorflow:Starting iteration 7

Steps executed: 229 Episode length: 39 Return: 39.0
INFO:tensorflow:Average training steps per second: 193.60
I0901 13:01:44.375517 140457859885056 replay_runner.py:36] Average training steps per second: 193.60
I0901 13:01:44.508049 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 38.17
INFO:tensorflow:Starting iteration 8

Steps executed: 236 Episode length: 80 Return: 80.0
INFO:tensorflow:Average training steps per second: 203.86
I0901 13:01:49.599097 140457859885056 replay_runner.py:36] Average training steps per second: 203.86
I0901 13:01:49.736921 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 78.67
INFO:tensorflow:Starting iteration 9

Steps executed: 378 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.03
I0901 13:01:55.075158 140457859885056 replay_runner.py:36] Average training steps per second: 194.03
I0901 13:01:55.296424 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 10

Steps executed: 327 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 202.39
I0901 13:02:00.417201 140457859885056 replay_runner.py:36] Average training steps per second: 202.39
I0901 13:02:00.621286 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.55
I0901 13:02:05.899918 140457859885056 replay_runner.py:36] Average training steps per second: 196.55
I0901 13:02:06.024768 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12
I0901 13:02:06.215929 140457859885056 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 197.04
I0901 13:02:11.291359 140457859885056 replay_runner.py:36] Average training steps per second: 197.04
I0901 13:02:11.415446 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0901 13:02:11.593627 140457859885056 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 200.83

Steps executed: 342 Episode length: 168 Return: 168.0
I0901 13:02:16.779802 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 14
I0901 13:02:16.964354 140457859885056 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 192.31
I0901 13:02:22.164818 140457859885056 replay_runner.py:36] Average training steps per second: 192.31
I0901 13:02:22.281053 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15


Steps executed: 320 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 200.76
I0901 13:02:27.454355 140457859885056 replay_runner.py:36] Average training steps per second: 200.76
I0901 13:02:27.667917 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 16

Steps executed: 267 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 198.79
I0901 13:02:32.892180 140457859885056 replay_runner.py:36] Average training steps per second: 198.79
I0901 13:02:33.048489 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.50
INFO:tensorflow:Starting iteration 17

Steps executed: 150 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 202.97

Steps executed: 292 Episode length: 142 Return: 142.0
I0901 13:02:38.351892 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 18

Steps executed: 329 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 199.70
I0901 13:02:43.556471 140457859885056 replay_runner.py:36] Average training steps per second: 199.70
I0901 13:02:43.744989 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 19

Steps executed: 281 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 197.31
I0901 13:02:48.998662 140457859885056 replay_runner.py:36] Average training steps per second: 197.31
I0901 13:02:49.173449 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.00
I0901 13:02:54.214543 140457859885056 replay_runner.py:36] Average training steps per second: 206.00
I0901 13:02:54.337788 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 340 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 202.09
I0901 13:02:59.469174 140457859885056 replay_runner.py:36] Average training steps per second: 202.09
I0901 13:02:59.663501 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 22

Steps executed: 356 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 210.02
I0901 13:03:04.593692 140457859885056 replay_runner.py:36] Average training steps per second: 210.02
I0901 13:03:04.808428 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 23

Steps executed: 358 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 213.09
I0901 13:03:09.684649 140457859885056 replay_runner.py:36] Average training steps per second: 213.09
I0901 13:03:09.876770 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 24

Steps executed: 361 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 211.56
I0901 13:03:14.780060 140457859885056 replay_runner.py:36] Average training steps per second: 211.56
I0901 13:03:14.985593 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.50
INFO:tensorflow:Starting iteration 25

Steps executed: 356 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 211.94
I0901 13:03:19.885043 140457859885056 replay_runner.py:36] Average training steps per second: 211.94
I0901 13:03:20.074938 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 26

Steps executed: 358 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 213.75
I0901 13:03:24.938891 140457859885056 replay_runner.py:36] Average training steps per second: 213.75
I0901 13:03:25.152913 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 27

Steps executed: 359 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 220.69
I0901 13:03:29.858942 140457859885056 replay_runner.py:36] Average training steps per second: 220.69
I0901 13:03:30.069365 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50
INFO:tensorflow:Starting iteration 28

Steps executed: 345 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 208.51
I0901 13:03:35.062605 140457859885056 replay_runner.py:36] Average training steps per second: 208.51
I0901 13:03:35.251161 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 212.80
I0901 13:03:40.128191 140457859885056 replay_runner.py:36] Average training steps per second: 212.80
I0901 13:03:40.245727 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00