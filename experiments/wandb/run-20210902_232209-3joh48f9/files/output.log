I0902 23:22:16.029672 140052600780800 run_experiment.py:549] Creating TrainRunner ...
I0902 23:22:16.038259 140052600780800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:16.038523 140052600780800 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:16.038688 140052600780800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:16.038836 140052600780800 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:16.038976 140052600780800 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:16.039083 140052600780800 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:16.039160 140052600780800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:16.039378 140052600780800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:16.039526 140052600780800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:16.039664 140052600780800 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:16.039962 140052600780800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:16.040151 140052600780800 dqn_agent.py:283] 	 seed: 1630624936038181
I0902 23:22:16.043017 140052600780800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:16.043193 140052600780800 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:22:16.043310 140052600780800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:16.043476 140052600780800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:16.043699 140052600780800 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:16.043804 140052600780800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:16.043912 140052600780800 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:16.044030 140052600780800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:16.044168 140052600780800 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 23:22:18.039410 140052600780800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:18.452734 140052600780800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:18.467318 140052600780800 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:22:18.473536 140052600780800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:18.473769 140052600780800 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:18.473896 140052600780800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:18.474005 140052600780800 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:18.474127 140052600780800 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:18.474357 140052600780800 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:18.474473 140052600780800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:18.474584 140052600780800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:18.474696 140052600780800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:18.474803 140052600780800 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:18.474911 140052600780800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:18.474996 140052600780800 dqn_agent.py:283] 	 seed: 1630624938473482
I0902 23:22:18.477652 140052600780800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:18.477921 140052600780800 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:22:18.478088 140052600780800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:18.478184 140052600780800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:18.478451 140052600780800 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:18.478619 140052600780800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:18.478754 140052600780800 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:18.478839 140052600780800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:18.478931 140052600780800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:22:18.511715 140052600780800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:18.534411 140052600780800 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:22:18.534795 140052600780800 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.71
I0902 23:22:25.214832 140052600780800 replay_runner.py:36] Average training steps per second: 149.71
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:22:26.609543 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:22:26.851213 140052600780800 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.20

Steps executed: 380 Episode length: 220 Return: -219.0
I0902 23:22:32.241900 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.00
INFO:tensorflow:Starting iteration 2

Steps executed: 91 Episode length: 91 Return: -90.09.0
INFO:tensorflow:Average training steps per second: 198.68
I0902 23:22:37.517712 140052600780800 replay_runner.py:36] Average training steps per second: 198.68
I0902 23:22:38.014581 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.00
INFO:tensorflow:Starting iteration 3

Steps executed: 591 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.67
I0902 23:22:43.292963 140052600780800 replay_runner.py:36] Average training steps per second: 198.67
I0902 23:22:43.717208 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.36
I0902 23:22:49.076349 140052600780800 replay_runner.py:36] Average training steps per second: 195.36
I0902 23:22:49.325061 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 5

Steps executed: 232 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 201.53
I0902 23:22:54.529042 140052600780800 replay_runner.py:36] Average training steps per second: 201.53
I0902 23:22:54.786695 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 6

Steps executed: 293 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 194.36
I0902 23:23:00.149530 140052600780800 replay_runner.py:36] Average training steps per second: 194.36
I0902 23:23:00.356873 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 7

Steps executed: 257 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 194.20

Steps executed: 226 Episode length: 97 Return: -96.0.0
I0902 23:23:05.970690 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 8
I0902 23:23:06.228128 140052600780800 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.69
I0902 23:23:11.263675 140052600780800 replay_runner.py:36] Average training steps per second: 198.69

Steps executed: 584 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 9
I0902 23:23:11.977983 140052600780800 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 192.70
I0902 23:23:17.167911 140052600780800 replay_runner.py:36] Average training steps per second: 192.70
I0902 23:23:17.587395 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.80
I0902 23:23:22.846554 140052600780800 replay_runner.py:36] Average training steps per second: 199.80
I0902 23:23:23.081253 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 11


Steps executed: 216 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 195.05
I0902 23:23:28.459706 140052600780800 replay_runner.py:36] Average training steps per second: 195.05
I0902 23:23:28.631939 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 12

Steps executed: 276 Episode length: 276 Return: -275.0
INFO:tensorflow:Average training steps per second: 194.42
I0902 23:23:34.010434 140052600780800 replay_runner.py:36] Average training steps per second: 194.42
I0902 23:23:34.257004 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.00
INFO:tensorflow:Starting iteration 13

Steps executed: 617 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.63
I0902 23:23:39.568983 140052600780800 replay_runner.py:36] Average training steps per second: 197.63
I0902 23:23:40.080575 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.07
I0902 23:23:45.592457 140052600780800 replay_runner.py:36] Average training steps per second: 190.07
I0902 23:23:45.985987 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 207 Episode length: 207 Return: -206.0
INFO:tensorflow:Average training steps per second: 194.06
I0902 23:23:51.369102 140052600780800 replay_runner.py:36] Average training steps per second: 194.06
I0902 23:23:51.560801 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.00
INFO:tensorflow:Starting iteration 16

Steps executed: 262 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 196.32
I0902 23:23:56.916554 140052600780800 replay_runner.py:36] Average training steps per second: 196.32
I0902 23:23:57.129027 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 17

Steps executed: 260 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 191.20
I0902 23:24:02.591366 140052600780800 replay_runner.py:36] Average training steps per second: 191.20
I0902 23:24:02.808381 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 18
I0902 23:24:03.060452 140052600780800 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 199.93

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:24:08.513239 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 133 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 195.82
I0902 23:24:13.875099 140052600780800 replay_runner.py:36] Average training steps per second: 195.82

Steps executed: 633 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 191.93
I0902 23:24:19.827352 140052600780800 replay_runner.py:36] Average training steps per second: 191.93
I0902 23:24:20.005558 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 21

Steps executed: 236 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 197.96
I0902 23:24:25.293145 140052600780800 replay_runner.py:36] Average training steps per second: 197.96
I0902 23:24:25.487709 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 22

Steps executed: 241 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 194.10
I0902 23:24:30.874396 140052600780800 replay_runner.py:36] Average training steps per second: 194.10
I0902 23:24:31.069055 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 23

Steps executed: 207 Episode length: 207 Return: -206.0
INFO:tensorflow:Average training steps per second: 197.91
I0902 23:24:36.358047 140052600780800 replay_runner.py:36] Average training steps per second: 197.91
I0902 23:24:36.521831 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.00
INFO:tensorflow:Starting iteration 24

Steps executed: 243 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 202.75
I0902 23:24:41.706844 140052600780800 replay_runner.py:36] Average training steps per second: 202.75
I0902 23:24:41.892950 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 215.89
I0902 23:24:46.762023 140052600780800 replay_runner.py:36] Average training steps per second: 215.89
I0902 23:24:47.162101 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 23:24:47.382987 140052600780800 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 201.86

Steps executed: 211 Episode length: 106 Return: -105.0
I0902 23:24:52.483320 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 27

Steps executed: 276 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 197.97
I0902 23:24:57.757184 140052600780800 replay_runner.py:36] Average training steps per second: 197.97
I0902 23:24:58.013902 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 28
I0902 23:24:58.248461 140052600780800 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 203.89
I0902 23:25:03.153369 140052600780800 replay_runner.py:36] Average training steps per second: 203.89
I0902 23:25:03.354892 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 29

Steps executed: 252 Episode length: 62 Return: -61.0.0
INFO:tensorflow:Average training steps per second: 202.35


Done fixed training!Episode length: 96 Return: -95.0.0
I0902 23:25:08.751523 140052600780800 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67