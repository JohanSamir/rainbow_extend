I0901 12:09:44.411778 139809518303232 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 12:09:44.412401 139809518303232 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 12:09:44.490649 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:44.491975 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:44.492151 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:44.492231 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:44.492291 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:44.492345 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:44.492488 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:44.492590 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:44.492670 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:44.492746 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:44.492822 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:44.492883 139809518303232 dqn_agent.py:283] 	 seed: 1630498184490586
I0901 12:09:44.494981 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:44.495147 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:44.495225 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:44.495289 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:44.495346 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:44.495430 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:44.495537 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:44.495593 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:44.495689 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 12:09:45.897323 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.251841 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.260042 139809518303232 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:09:46.266388 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:46.266551 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:46.266640 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:46.266707 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:46.266767 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:46.266822 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:46.266880 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:46.266973 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:46.267029 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:46.267081 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:46.267133 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:46.267185 139809518303232 dqn_agent.py:283] 	 seed: 1630498186266345
I0901 12:09:46.268839 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:46.268970 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:46.269040 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:46.269106 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:46.269165 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:46.269220 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:46.269305 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:46.269360 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:46.269412 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.287032 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.298420 139809518303232 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:09:46.298758 139809518303232 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.71
I0901 12:09:52.297655 139809518303232 replay_runner.py:36] Average training steps per second: 166.71
Steps executed: 344 Episode length: 163 Return: -211.98880500722396
I0901 12:09:53.436604 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.26
INFO:tensorflow:Starting iteration 1

Steps executed: 255 Episode length: 94 Return: -617.936621537884126
INFO:tensorflow:Average training steps per second: 204.56
I0901 12:10:02.423089 139809518303232 replay_runner.py:36] Average training steps per second: 204.56
I0901 12:10:02.703023 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.79
INFO:tensorflow:Starting iteration 2

Steps executed: 315 Episode length: 134 Return: -583.18173529130226
INFO:tensorflow:Average training steps per second: 200.21
I0901 12:10:11.613509 139809518303232 replay_runner.py:36] Average training steps per second: 200.21
I0901 12:10:11.905950 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.23
INFO:tensorflow:Starting iteration 3

Steps executed: 255 Episode length: 121 Return: -190.58011360189556
INFO:tensorflow:Average training steps per second: 208.77
I0901 12:10:20.659461 139809518303232 replay_runner.py:36] Average training steps per second: 208.77
I0901 12:10:20.920505 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.23
INFO:tensorflow:Starting iteration 4

Steps executed: 93 Episode length: 93 Return: -614.8441206603994556
INFO:tensorflow:Average training steps per second: 208.61

Steps executed: 234 Episode length: 141 Return: -437.48850476511556
I0901 12:10:30.229645 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -526.17
INFO:tensorflow:Starting iteration 5

Steps executed: 316 Episode length: 212 Return: -18.872616638470325
INFO:tensorflow:Average training steps per second: 205.04
I0901 12:10:39.337740 139809518303232 replay_runner.py:36] Average training steps per second: 205.04
I0901 12:10:39.673948 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.83
INFO:tensorflow:Starting iteration 6

Steps executed: 258 Episode length: 94 Return: -704.119668681087125
INFO:tensorflow:Average training steps per second: 211.60
I0901 12:10:48.565748 139809518303232 replay_runner.py:36] Average training steps per second: 211.60
I0901 12:10:48.816600 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.93
INFO:tensorflow:Starting iteration 7

Steps executed: 241 Episode length: 83 Return: -507.703000725812235
INFO:tensorflow:Average training steps per second: 210.84
I0901 12:10:57.620097 139809518303232 replay_runner.py:36] Average training steps per second: 210.84
I0901 12:10:57.826647 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.24
INFO:tensorflow:Starting iteration 8

Steps executed: 311 Episode length: 118 Return: -196.36735715934498
INFO:tensorflow:Average training steps per second: 207.72
I0901 12:11:06.783499 139809518303232 replay_runner.py:36] Average training steps per second: 207.72
I0901 12:11:07.153242 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.41
INFO:tensorflow:Starting iteration 9

Steps executed: 297 Episode length: 100 Return: -30.597524769247578
INFO:tensorflow:Average training steps per second: 206.38
I0901 12:11:15.860218 139809518303232 replay_runner.py:36] Average training steps per second: 206.38
I0901 12:11:16.147958 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.63
INFO:tensorflow:Starting iteration 10

Steps executed: 208 Episode length: 103 Return: -169.06274259135224
INFO:tensorflow:Average training steps per second: 206.09
I0901 12:11:25.090376 139809518303232 replay_runner.py:36] Average training steps per second: 206.09
I0901 12:11:25.284408 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.42
INFO:tensorflow:Starting iteration 11

Steps executed: 88 Episode length: 88 Return: -371.6607768735541424
INFO:tensorflow:Average training steps per second: 208.94

Steps executed: 243 Episode length: 77 Return: -573.115481936188224
I0901 12:11:34.514711 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.99
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 96 Return: -366.215549862037224
INFO:tensorflow:Average training steps per second: 207.84
I0901 12:11:43.470614 139809518303232 replay_runner.py:36] Average training steps per second: 207.84
I0901 12:11:43.681672 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.89
INFO:tensorflow:Starting iteration 13

Steps executed: 221 Episode length: 72 Return: -368.470497340002584
INFO:tensorflow:Average training steps per second: 205.26
I0901 12:11:52.828930 139809518303232 replay_runner.py:36] Average training steps per second: 205.26
I0901 12:11:53.005162 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.70
INFO:tensorflow:Starting iteration 14

Steps executed: 234 Episode length: 120 Return: -308.06357309574776
INFO:tensorflow:Average training steps per second: 203.12
I0901 12:12:02.120633 139809518303232 replay_runner.py:36] Average training steps per second: 203.12
I0901 12:12:02.318582 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.30
INFO:tensorflow:Starting iteration 15

Steps executed: 220 Episode length: 57 Return: -246.496699292514963
INFO:tensorflow:Average training steps per second: 211.94
I0901 12:12:11.346132 139809518303232 replay_runner.py:36] Average training steps per second: 211.94
I0901 12:12:11.521965 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.77
INFO:tensorflow:Starting iteration 16

Steps executed: 116 Episode length: 55 Return: -322.445940998556663
INFO:tensorflow:Average training steps per second: 209.04

Steps executed: 220 Episode length: 104 Return: -376.90035778429785
I0901 12:12:20.711824 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.59
INFO:tensorflow:Starting iteration 17

Steps executed: 204 Episode length: 85 Return: -380.663751506904565
INFO:tensorflow:Average training steps per second: 207.68
I0901 12:12:29.808559 139809518303232 replay_runner.py:36] Average training steps per second: 207.68
I0901 12:12:29.973023 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.16
INFO:tensorflow:Starting iteration 18

Steps executed: 245 Episode length: 67 Return: -480.334266453485727
INFO:tensorflow:Average training steps per second: 226.76
I0901 12:12:38.522741 139809518303232 replay_runner.py:36] Average training steps per second: 226.76
I0901 12:12:38.698890 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.04
INFO:tensorflow:Starting iteration 19
I0901 12:12:42.682917 139809518303232 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 243.92

Steps executed: 254 Episode length: 161 Return: -556.85647933247017
I0901 12:12:47.000770 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.14
INFO:tensorflow:Starting iteration 20

Steps executed: 116 Episode length: 116 Return: -273.18298285508737
INFO:tensorflow:Average training steps per second: 227.85
I0901 12:12:55.459035 139809518303232 replay_runner.py:36] Average training steps per second: 227.85

Steps executed: 1116 Episode length: 1000 Return: 10.746156566934912
INFO:tensorflow:Starting iteration 21

Steps executed: 226 Episode length: 91 Return: -155.7741665497196732
INFO:tensorflow:Average training steps per second: 215.74
I0901 12:13:07.704165 139809518303232 replay_runner.py:36] Average training steps per second: 215.74
I0901 12:13:07.895586 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.14
INFO:tensorflow:Starting iteration 22
I0901 12:13:12.261168 139809518303232 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 220.46

Steps executed: 237 Episode length: 122 Return: -230.399306368310022
I0901 12:13:17.012899 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.31
INFO:tensorflow:Starting iteration 23

Steps executed: 302 Episode length: 122 Return: -406.414288227408822
INFO:tensorflow:Average training steps per second: 222.69
I0901 12:13:25.864302 139809518303232 replay_runner.py:36] Average training steps per second: 222.69
I0901 12:13:26.129156 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.69
INFO:tensorflow:Starting iteration 24

Steps executed: 260 Episode length: 82 Return: -442.9574828920788622
INFO:tensorflow:Average training steps per second: 227.65
I0901 12:13:35.014335 139809518303232 replay_runner.py:36] Average training steps per second: 227.65
I0901 12:13:35.264731 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.35
INFO:tensorflow:Starting iteration 25

Steps executed: 314 Episode length: 130 Return: -375.856681851952542
INFO:tensorflow:Average training steps per second: 226.68
I0901 12:13:43.912862 139809518303232 replay_runner.py:36] Average training steps per second: 226.68
I0901 12:13:44.203438 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.92
INFO:tensorflow:Starting iteration 26

Steps executed: 231 Episode length: 80 Return: -553.6670485243474542
INFO:tensorflow:Average training steps per second: 215.73
I0901 12:13:53.189680 139809518303232 replay_runner.py:36] Average training steps per second: 215.73
I0901 12:13:53.388853 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.56
INFO:tensorflow:Starting iteration 27

Steps executed: 203 Episode length: 104 Return: -168.095911361226442
INFO:tensorflow:Average training steps per second: 220.84
I0901 12:14:02.155025 139809518303232 replay_runner.py:36] Average training steps per second: 220.84
I0901 12:14:02.324320 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.00
INFO:tensorflow:Starting iteration 28

Steps executed: 311 Episode length: 148 Return: -357.538925401788452
INFO:tensorflow:Average training steps per second: 226.50
I0901 12:14:11.190314 139809518303232 replay_runner.py:36] Average training steps per second: 226.50
I0901 12:14:11.510285 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -495.08
INFO:tensorflow:Starting iteration 29

Steps executed: 294 Episode length: 103 Return: -273.734951389192762
INFO:tensorflow:Average training steps per second: 228.07
I0901 12:14:20.367187 139809518303232 replay_runner.py:36] Average training steps per second: 228.07

Done fixed training!Episode length: 103 Return: -273.734951389192762