Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0901 12:40:48.718483 139683016574976 run_experiment.py:549] Creating TrainRunner ...
I0901 12:40:48.730956 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:40:48.731230 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:40:48.731356 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:40:48.731481 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:40:48.731564 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 12:40:48.731633 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:40:48.731698 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:40:48.732141 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:40:48.732392 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:40:48.732523 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 12:40:48.732600 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:40:48.732671 139683016574976 dqn_agent.py:283] 	 seed: 1630500048730883
I0901 12:40:48.735838 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:40:48.736041 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:40:48.736154 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:40:48.736248 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:40:48.736327 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:40:48.736434 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:40:48.736514 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:40:48.736665 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:40:48.736763 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:40:48.815135 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:49.217372 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:49.241795 139683016574976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:40:49.251950 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:40:49.252224 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:40:49.252426 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:40:49.252585 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:40:49.252727 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 12:40:49.252852 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:40:49.252976 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:40:49.253104 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:40:49.253353 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:40:49.253506 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 12:40:49.253803 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:40:49.253961 139683016574976 dqn_agent.py:283] 	 seed: 1630500049251893
I0901 12:40:49.257041 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:40:49.257268 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:40:49.257428 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:40:49.257555 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:40:49.257830 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:40:49.258010 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:40:49.258235 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:40:49.258390 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:40:49.258617 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:40:49.292488 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:49.315106 139683016574976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:40:49.315384 139683016574976 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.63
I0901 12:40:55.954603 139683016574976 replay_runner.py:36] Average training steps per second: 150.63
Steps executed: 282 Episode length: 102 Return: -253.2526678115014
I0901 12:40:57.193913 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.41
INFO:tensorflow:Starting iteration 1

Steps executed: 252 Episode length: 131 Return: -338.84411618156066
INFO:tensorflow:Average training steps per second: 230.18
I0901 12:41:05.970103 139683016574976 replay_runner.py:36] Average training steps per second: 230.18
I0901 12:41:06.221564 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.82
INFO:tensorflow:Starting iteration 2

Steps executed: 238 Episode length: 120 Return: -206.85770599326815
INFO:tensorflow:Average training steps per second: 225.91
I0901 12:41:15.118979 139683016574976 replay_runner.py:36] Average training steps per second: 225.91
I0901 12:41:15.339002 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.18
INFO:tensorflow:Starting iteration 3

Steps executed: 190 Episode length: 190 Return: -252.44415598832495
INFO:tensorflow:Average training steps per second: 220.47

Steps executed: 376 Episode length: 186 Return: -281.30090407999546
I0901 12:41:24.559636 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.87
INFO:tensorflow:Starting iteration 4

Steps executed: 350 Episode length: 187 Return: 82.5205576800222976
INFO:tensorflow:Average training steps per second: 219.23
I0901 12:41:33.380050 139683016574976 replay_runner.py:36] Average training steps per second: 219.23
I0901 12:41:33.713151 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.24
INFO:tensorflow:Starting iteration 5
I0901 12:41:37.910606 139683016574976 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.46

Steps executed: 315 Episode length: 127 Return: -209.34699425579493
I0901 12:41:42.776542 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.39
INFO:tensorflow:Starting iteration 6

Steps executed: 207 Episode length: 125 Return: -209.04373264076804
INFO:tensorflow:Average training steps per second: 215.94
I0901 12:41:51.858022 139683016574976 replay_runner.py:36] Average training steps per second: 215.94
I0901 12:41:52.034361 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.08
INFO:tensorflow:Starting iteration 7

Steps executed: 287 Episode length: 201 Return: -245.65821468686554
INFO:tensorflow:Average training steps per second: 213.67
I0901 12:42:01.143025 139683016574976 replay_runner.py:36] Average training steps per second: 213.67
I0901 12:42:01.428720 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.67
INFO:tensorflow:Starting iteration 8

Steps executed: 69 Episode length: 69 Return: -208.3802180914741554
INFO:tensorflow:Average training steps per second: 213.27
I0901 12:42:10.559292 139683016574976 replay_runner.py:36] Average training steps per second: 213.27

Steps executed: 217 Episode length: 67 Return: -178.536996946521754
INFO:tensorflow:Starting iteration 9

Steps executed: 231 Episode length: 93 Return: -162.961997237516396
INFO:tensorflow:Average training steps per second: 215.96
I0901 12:42:19.512722 139683016574976 replay_runner.py:36] Average training steps per second: 215.96
I0901 12:42:19.730178 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.03
INFO:tensorflow:Starting iteration 10

Steps executed: 78 Episode length: 78 Return: -342.4627888087262696
INFO:tensorflow:Average training steps per second: 218.87
I0901 12:42:28.615685 139683016574976 replay_runner.py:36] Average training steps per second: 218.87

Steps executed: 234 Episode length: 96 Return: -662.850150078699946
INFO:tensorflow:Starting iteration 11

Steps executed: 574 Episode length: 447 Return: 245.823755817867556
INFO:tensorflow:Average training steps per second: 218.73
I0901 12:42:37.839640 139683016574976 replay_runner.py:36] Average training steps per second: 218.73
I0901 12:42:38.725893 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.71
INFO:tensorflow:Starting iteration 12

Steps executed: 442 Episode length: 296 Return: -220.01962733262732
INFO:tensorflow:Average training steps per second: 215.41
I0901 12:42:47.557475 139683016574976 replay_runner.py:36] Average training steps per second: 215.41
I0901 12:42:48.029886 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.59
INFO:tensorflow:Starting iteration 13
I0901 12:42:52.494610 139683016574976 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 226.21

Steps executed: 204 Episode length: 61 Return: -222.549693868600498
I0901 12:42:57.125530 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -653.90
INFO:tensorflow:Starting iteration 14

Steps executed: 287 Episode length: 160 Return: -549.56587494861578
INFO:tensorflow:Average training steps per second: 225.04
I0901 12:43:05.983023 139683016574976 replay_runner.py:36] Average training steps per second: 225.04
I0901 12:43:06.258370 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.60
INFO:tensorflow:Starting iteration 15
I0901 12:43:10.547556 139683016574976 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 222.71

Steps executed: 284 Episode length: 128 Return: 2.34835437505620354
I0901 12:43:15.303300 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.24
INFO:tensorflow:Starting iteration 16

Steps executed: 258 Episode length: 63 Return: -325.952255734845274
INFO:tensorflow:Average training steps per second: 225.30
I0901 12:43:24.192632 139683016574976 replay_runner.py:36] Average training steps per second: 225.30
I0901 12:43:24.380445 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.68
INFO:tensorflow:Starting iteration 17

Steps executed: 312 Episode length: 113 Return: -153.51411249556827
INFO:tensorflow:Average training steps per second: 215.63
I0901 12:43:33.327858 139683016574976 replay_runner.py:36] Average training steps per second: 215.63
I0901 12:43:33.636902 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.49
INFO:tensorflow:Starting iteration 18

Steps executed: 208 Episode length: 84 Return: -43.1369064474328587
INFO:tensorflow:Average training steps per second: 215.17
I0901 12:43:42.736867 139683016574976 replay_runner.py:36] Average training steps per second: 215.17
I0901 12:43:42.888226 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.49
INFO:tensorflow:Starting iteration 19

Steps executed: 235 Episode length: 77 Return: -677.627038206339187
INFO:tensorflow:Average training steps per second: 215.90
I0901 12:43:51.968580 139683016574976 replay_runner.py:36] Average training steps per second: 215.90
I0901 12:43:52.181439 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -520.72
INFO:tensorflow:Starting iteration 20

Steps executed: 249 Episode length: 62 Return: -489.988130344561467
INFO:tensorflow:Average training steps per second: 211.48
I0901 12:44:01.332304 139683016574976 replay_runner.py:36] Average training steps per second: 211.48
I0901 12:44:01.560987 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.74
INFO:tensorflow:Starting iteration 21

Steps executed: 227 Episode length: 67 Return: -367.648928082532567
INFO:tensorflow:Average training steps per second: 220.40
I0901 12:44:10.482162 139683016574976 replay_runner.py:36] Average training steps per second: 220.40
I0901 12:44:10.681723 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.79
INFO:tensorflow:Starting iteration 22

Steps executed: 223 Episode length: 70 Return: -622.846683060822167
INFO:tensorflow:Average training steps per second: 223.16
I0901 12:44:19.552252 139683016574976 replay_runner.py:36] Average training steps per second: 223.16
I0901 12:44:19.728910 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -523.16
INFO:tensorflow:Starting iteration 23

Steps executed: 215 Episode length: 64 Return: -455.560836199312357
INFO:tensorflow:Average training steps per second: 220.52
I0901 12:44:28.604551 139683016574976 replay_runner.py:36] Average training steps per second: 220.52
I0901 12:44:28.754519 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.46
INFO:tensorflow:Starting iteration 24

Steps executed: 230 Episode length: 71 Return: -486.161314386441557
INFO:tensorflow:Average training steps per second: 212.87
I0901 12:44:37.764306 139683016574976 replay_runner.py:36] Average training steps per second: 212.87
I0901 12:44:37.978082 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -558.19
INFO:tensorflow:Starting iteration 25
I0901 12:44:42.392362 139683016574976 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 216.25

Steps executed: 262 Episode length: 64 Return: -450.011106739012637
I0901 12:44:47.257999 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.58
INFO:tensorflow:Starting iteration 26

Steps executed: 245 Episode length: 81 Return: -206.349108462999887
INFO:tensorflow:Average training steps per second: 216.77
I0901 12:44:56.169436 139683016574976 replay_runner.py:36] Average training steps per second: 216.77
I0901 12:44:56.375937 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.86
INFO:tensorflow:Starting iteration 27

Steps executed: 213 Episode length: 58 Return: -91.7484141530343357
INFO:tensorflow:Average training steps per second: 215.21
I0901 12:45:05.466347 139683016574976 replay_runner.py:36] Average training steps per second: 215.21
I0901 12:45:05.636083 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.19
INFO:tensorflow:Starting iteration 28

Steps executed: 206 Episode length: 55 Return: -449.652571334741767
INFO:tensorflow:Average training steps per second: 217.53
I0901 12:45:14.398988 139683016574976 replay_runner.py:36] Average training steps per second: 217.53
I0901 12:45:14.584172 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.46
INFO:tensorflow:Starting iteration 29

Steps executed: 206 Episode length: 60 Return: -164.334216862433727
INFO:tensorflow:Average training steps per second: 209.59
I0901 12:45:23.864029 139683016574976 replay_runner.py:36] Average training steps per second: 209.59

Done fixed training!Episode length: 60 Return: -164.334216862433727