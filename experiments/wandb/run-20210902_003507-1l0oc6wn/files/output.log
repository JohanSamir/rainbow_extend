Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 00:35:12.879046 139929824643072 run_experiment.py:549] Creating TrainRunner ...
I0902 00:35:12.887351 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:35:12.887503 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:35:12.887629 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:35:12.887694 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:35:12.887806 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:35:12.887865 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:35:12.887955 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:35:12.888007 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:35:12.888074 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:35:12.888150 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:35:12.888224 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:35:12.888292 139929824643072 dqn_agent.py:283] 	 seed: 1630542912887312
I0902 00:35:12.890022 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:35:12.890155 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:35:12.890233 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:35:12.890297 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:35:12.890360 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:35:12.890436 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:35:12.890490 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:35:12.890538 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:35:12.890584 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:35:12.918047 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:35:13.191241 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:35:13.203475 139929824643072 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:35:13.210577 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:35:13.210748 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:35:13.210848 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:35:13.210952 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:35:13.211023 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:35:13.211083 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:35:13.211137 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:35:13.211216 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:35:13.211294 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:35:13.211423 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:35:13.211570 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:35:13.211655 139929824643072 dqn_agent.py:283] 	 seed: 1630542913210536
I0902 00:35:13.213383 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:35:13.213513 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:35:13.213585 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:35:13.213648 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:35:13.213705 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:35:13.213779 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:35:13.213860 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:35:13.213918 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:35:13.213969 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:35:13.237542 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:35:13.254339 139929824643072 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:35:13.254527 139929824643072 replay_runner.py:41] Starting iteration 0
Steps executed: 279 Episode length: 136 Return: -270.3951393016213
INFO:tensorflow:Average training steps per second: 254.06
I0902 00:35:17.190753 139929824643072 replay_runner.py:36] Average training steps per second: 254.06
I0902 00:35:17.978144 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.76
INFO:tensorflow:Starting iteration 1
I0902 00:35:21.442249 139929824643072 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 356.93
I0902 00:35:24.244234 139929824643072 replay_runner.py:36] Average training steps per second: 356.93

Steps executed: 280 Episode length: 119 Return: -238.51991474988415
INFO:tensorflow:Starting iteration 2

Steps executed: 327 Episode length: 327 Return: 217.035816858163345
INFO:tensorflow:Average training steps per second: 352.01
I0902 00:35:30.692991 139929824643072 replay_runner.py:36] Average training steps per second: 352.01
I0902 00:35:30.941980 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: 217.04
INFO:tensorflow:Starting iteration 3

Steps executed: 303 Episode length: 120 Return: -306.17139364095963
INFO:tensorflow:Average training steps per second: 354.01
I0902 00:35:37.282645 139929824643072 replay_runner.py:36] Average training steps per second: 354.01
I0902 00:35:37.463575 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.71
INFO:tensorflow:Starting iteration 4

Steps executed: 340 Episode length: 201 Return: -66.192165972086565
INFO:tensorflow:Average training steps per second: 345.79
I0902 00:35:43.790890 139929824643072 replay_runner.py:36] Average training steps per second: 345.79
I0902 00:35:43.974097 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.30
INFO:tensorflow:Starting iteration 5

Steps executed: 220 Episode length: 220 Return: -582.36469496931825
INFO:tensorflow:Average training steps per second: 347.00
I0902 00:35:50.289013 139929824643072 replay_runner.py:36] Average training steps per second: 347.00
I0902 00:35:50.423587 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.36
INFO:tensorflow:Starting iteration 6

Steps executed: 346 Episode length: 236 Return: -514.98357519478185
INFO:tensorflow:Average training steps per second: 337.39
I0902 00:35:56.800731 139929824643072 replay_runner.py:36] Average training steps per second: 337.39
I0902 00:35:57.012409 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.33
INFO:tensorflow:Starting iteration 7

Steps executed: 213 Episode length: 213 Return: -479.54760147148855
INFO:tensorflow:Average training steps per second: 337.85
I0902 00:36:03.354351 139929824643072 replay_runner.py:36] Average training steps per second: 337.85
I0902 00:36:03.488687 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.55
INFO:tensorflow:Starting iteration 8

Steps executed: 220 Episode length: 220 Return: -617.54660296538495
INFO:tensorflow:Average training steps per second: 336.80
I0902 00:36:09.781302 139929824643072 replay_runner.py:36] Average training steps per second: 336.80
I0902 00:36:09.930251 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -617.55
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: -283.09122359797846
INFO:tensorflow:Average training steps per second: 335.49
I0902 00:36:16.274430 139929824643072 replay_runner.py:36] Average training steps per second: 335.49
I0902 00:36:16.415664 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.09
INFO:tensorflow:Starting iteration 10
I0902 00:36:19.840364 139929824643072 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 337.67

Steps executed: 410 Episode length: 410 Return: -246.67682883780253
I0902 00:36:23.296230 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.68
INFO:tensorflow:Starting iteration 11
I0902 00:36:26.717102 139929824643072 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 355.17

Steps executed: 1000 Episode length: 1000 Return: -481.489901792823
I0902 00:36:31.071227 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.49
INFO:tensorflow:Starting iteration 12

Steps executed: 273 Episode length: 273 Return: -218.95807033363886
INFO:tensorflow:Average training steps per second: 362.02
I0902 00:36:37.358413 139929824643072 replay_runner.py:36] Average training steps per second: 362.02
I0902 00:36:37.580996 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.96
INFO:tensorflow:Starting iteration 13

Steps executed: 860 Episode length: 762 Return: -150.38617632828252
INFO:tensorflow:Average training steps per second: 368.43
I0902 00:36:43.801352 139929824643072 replay_runner.py:36] Average training steps per second: 368.43
I0902 00:36:44.898913 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.18
INFO:tensorflow:Starting iteration 14

Steps executed: 237 Episode length: 62 Return: -506.013617083306252
INFO:tensorflow:Average training steps per second: 358.76
I0902 00:36:51.197081 139929824643072 replay_runner.py:36] Average training steps per second: 358.76
I0902 00:36:51.335031 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.02
INFO:tensorflow:Starting iteration 15

Steps executed: 231 Episode length: 84 Return: -45.5718188811368352
INFO:tensorflow:Average training steps per second: 357.23
I0902 00:36:57.644662 139929824643072 replay_runner.py:36] Average training steps per second: 357.23
I0902 00:36:57.784043 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.96
INFO:tensorflow:Starting iteration 16

Steps executed: 254 Episode length: 119 Return: -235.73086962247297
INFO:tensorflow:Average training steps per second: 359.74
I0902 00:37:04.101721 139929824643072 replay_runner.py:36] Average training steps per second: 359.74
I0902 00:37:04.229196 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.17
INFO:tensorflow:Starting iteration 17

Steps executed: 227 Episode length: 81 Return: -693.635176722317334
INFO:tensorflow:Average training steps per second: 363.86
I0902 00:37:10.478419 139929824643072 replay_runner.py:36] Average training steps per second: 363.86
I0902 00:37:10.623039 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.08
INFO:tensorflow:Starting iteration 18

Steps executed: 327 Episode length: 218 Return: -418.85012850537275
INFO:tensorflow:Average training steps per second: 363.37
I0902 00:37:16.901746 139929824643072 replay_runner.py:36] Average training steps per second: 363.37
I0902 00:37:17.125883 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.74
INFO:tensorflow:Starting iteration 19

Steps executed: 295 Episode length: 135 Return: -291.87530783186655
INFO:tensorflow:Average training steps per second: 363.12
I0902 00:37:23.395699 139929824643072 replay_runner.py:36] Average training steps per second: 363.12
I0902 00:37:23.583563 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.56
INFO:tensorflow:Starting iteration 20

Steps executed: 259 Episode length: 68 Return: -116.074789313520635
INFO:tensorflow:Average training steps per second: 352.70
I0902 00:37:29.969567 139929824643072 replay_runner.py:36] Average training steps per second: 352.70
I0902 00:37:30.085144 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.44
INFO:tensorflow:Starting iteration 21

Steps executed: 232 Episode length: 58 Return: -202.845711100787245
INFO:tensorflow:Average training steps per second: 358.38
I0902 00:37:36.297095 139929824643072 replay_runner.py:36] Average training steps per second: 358.38
I0902 00:37:36.413823 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.52
INFO:tensorflow:Starting iteration 22

Steps executed: 202 Episode length: 96 Return: -613.757465449135855
INFO:tensorflow:Average training steps per second: 362.25
I0902 00:37:42.567374 139929824643072 replay_runner.py:36] Average training steps per second: 362.25
I0902 00:37:42.672556 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.77
INFO:tensorflow:Starting iteration 23

Steps executed: 281 Episode length: 140 Return: -149.22894712740845
INFO:tensorflow:Average training steps per second: 355.81
I0902 00:37:48.952040 139929824643072 replay_runner.py:36] Average training steps per second: 355.81
I0902 00:37:49.121971 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.80
INFO:tensorflow:Starting iteration 24

Steps executed: 260 Episode length: 75 Return: -275.152516254752625
INFO:tensorflow:Average training steps per second: 352.53
I0902 00:37:55.374635 139929824643072 replay_runner.py:36] Average training steps per second: 352.53
I0902 00:37:55.499928 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.77
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 54 Return: -310.623700014584245
INFO:tensorflow:Average training steps per second: 345.11
I0902 00:38:01.701140 139929824643072 replay_runner.py:36] Average training steps per second: 345.11
I0902 00:38:01.801600 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.92
INFO:tensorflow:Starting iteration 26

Steps executed: 387 Episode length: 272 Return: -2546.0795091939826
INFO:tensorflow:Average training steps per second: 350.03
I0902 00:38:08.026144 139929824643072 replay_runner.py:36] Average training steps per second: 350.03
I0902 00:38:08.298302 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -1015.14
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 77 Return: -675.003795760258426
INFO:tensorflow:Average training steps per second: 345.10
I0902 00:38:14.520793 139929824643072 replay_runner.py:36] Average training steps per second: 345.10
I0902 00:38:14.625194 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -619.80
INFO:tensorflow:Starting iteration 28

Steps executed: 230 Episode length: 59 Return: -507.348782176643746
INFO:tensorflow:Average training steps per second: 352.39
I0902 00:38:20.569413 139929824643072 replay_runner.py:36] Average training steps per second: 352.39
I0902 00:38:20.699855 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.06
INFO:tensorflow:Starting iteration 29

Steps executed: 228 Episode length: 81 Return: -582.559549606569846
INFO:tensorflow:Average training steps per second: 357.85
I0902 00:38:26.874690 139929824643072 replay_runner.py:36] Average training steps per second: 357.85

Done fixed training!Episode length: 81 Return: -582.559549606569846