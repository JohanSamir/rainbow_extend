Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 23:35:53.848631 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:35:53.861748 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:53.862028 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:53.862144 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:53.862230 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:53.862332 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:53.862459 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:53.862583 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:53.862755 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:53.862892 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:53.863317 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:53.863536 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:53.863713 139900407642112 dqn_agent.py:283] 	 seed: 1630625753861684
I0902 23:35:53.867280 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:53.867564 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:53.867759 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:53.867928 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:53.868063 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:53.868180 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:53.868346 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:53.868601 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:53.868813 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:53.909592 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:54.298793 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:54.310858 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:35:54.319713 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:54.319960 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:54.320099 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:54.320228 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:54.320366 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:54.320700 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:54.320850 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:54.320983 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:54.321164 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:54.321290 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:54.321507 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:54.321612 139900407642112 dqn_agent.py:283] 	 seed: 1630625754319659
I0902 23:35:54.324302 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:54.324524 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:54.324690 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:54.324828 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:54.324944 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:54.325062 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:54.325321 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:54.325456 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:54.325617 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:54.394927 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:54.417903 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:35:54.418187 139900407642112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.74
I0902 23:36:00.601435 139900407642112 replay_runner.py:36] Average training steps per second: 161.74
Steps executed: 282 Episode length: 159 Return: -347.74889827258867
I0902 23:36:01.917087 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.27
INFO:tensorflow:Starting iteration 1

Steps executed: 231 Episode length: 119 Return: -627.95038908758267
INFO:tensorflow:Average training steps per second: 222.17
I0902 23:36:10.776083 139900407642112 replay_runner.py:36] Average training steps per second: 222.17
I0902 23:36:11.000105 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -678.28
INFO:tensorflow:Starting iteration 2

Steps executed: 475 Episode length: 289 Return: -284.13145881095113
INFO:tensorflow:Average training steps per second: 219.41
I0902 23:36:19.938515 139900407642112 replay_runner.py:36] Average training steps per second: 219.41
I0902 23:36:20.515634 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.15
INFO:tensorflow:Starting iteration 3

Steps executed: 263 Episode length: 139 Return: -185.65451425641402
INFO:tensorflow:Average training steps per second: 224.00
I0902 23:36:29.293215 139900407642112 replay_runner.py:36] Average training steps per second: 224.00
I0902 23:36:29.529435 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.40
INFO:tensorflow:Starting iteration 4
I0902 23:36:33.690390 139900407642112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 223.92

Steps executed: 1000 Episode length: 1000 Return: -149.93297932605245
I0902 23:36:40.678999 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.93
INFO:tensorflow:Starting iteration 5
I0902 23:36:44.731065 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 222.96

Steps executed: 1000 Episode length: 1000 Return: -93.846420805679415
I0902 23:36:51.604580 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.85
INFO:tensorflow:Starting iteration 6
I0902 23:36:55.684254 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 225.18

Steps executed: 1000 Episode length: 1000 Return: -391.65597878239915
I0902 23:37:01.868119 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.66
INFO:tensorflow:Starting iteration 7

Steps executed: 383 Episode length: 383 Return: -242.9729968702958715
INFO:tensorflow:Average training steps per second: 218.05
I0902 23:37:10.749390 139900407642112 replay_runner.py:36] Average training steps per second: 218.05
I0902 23:37:11.284131 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.97
INFO:tensorflow:Starting iteration 8

Steps executed: 277 Episode length: 277 Return: -187.8199144487534815
INFO:tensorflow:Average training steps per second: 225.94
I0902 23:37:20.160928 139900407642112 replay_runner.py:36] Average training steps per second: 225.94
I0902 23:37:20.451733 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.82
INFO:tensorflow:Starting iteration 9
I0902 23:37:24.702190 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 230.42

Steps executed: 1000 Episode length: 1000 Return: -211.00439859628216
I0902 23:37:31.996489 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.00
INFO:tensorflow:Starting iteration 10
I0902 23:37:36.245830 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 230.48

Steps executed: 1000 Episode length: 1000 Return: -253.36452827803566
I0902 23:37:42.893805 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.36
INFO:tensorflow:Starting iteration 11
I0902 23:37:47.228623 139900407642112 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 225.85

Steps executed: 926 Episode length: 926 Return: -428.6751270864646566
I0902 23:37:53.777616 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.68
INFO:tensorflow:Starting iteration 12

Steps executed: 467 Episode length: 467 Return: -238.4006476869654466
INFO:tensorflow:Average training steps per second: 224.50
I0902 23:38:02.466770 139900407642112 replay_runner.py:36] Average training steps per second: 224.50
I0902 23:38:03.282057 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.40
INFO:tensorflow:Starting iteration 13

Steps executed: 72 Episode length: 72 Return: -187.932864825023334466
INFO:tensorflow:Average training steps per second: 222.63

Steps executed: 274 Episode length: 202 Return: -174.5649445529898466
I0902 23:38:12.142446 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.25
INFO:tensorflow:Starting iteration 14

Steps executed: 299 Episode length: 124 Return: -806.4143282837102466
INFO:tensorflow:Average training steps per second: 214.56
I0902 23:38:21.003879 139900407642112 replay_runner.py:36] Average training steps per second: 214.56
I0902 23:38:21.262885 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -589.53
INFO:tensorflow:Starting iteration 15
I0902 23:38:25.507276 139900407642112 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 215.70

Steps executed: 285 Episode length: 134 Return: -456.9403580224343666
I0902 23:38:30.419311 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.72
INFO:tensorflow:Starting iteration 16

Steps executed: 300 Episode length: 115 Return: -476.4692102964678566
INFO:tensorflow:Average training steps per second: 213.39
I0902 23:38:39.392620 139900407642112 replay_runner.py:36] Average training steps per second: 213.39
I0902 23:38:39.682619 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -495.95
INFO:tensorflow:Starting iteration 17

Steps executed: 265 Episode length: 151 Return: -389.5803759933791566
INFO:tensorflow:Average training steps per second: 212.92
I0902 23:38:48.735462 139900407642112 replay_runner.py:36] Average training steps per second: 212.92
I0902 23:38:48.971200 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.74
INFO:tensorflow:Starting iteration 18
I0902 23:38:53.223139 139900407642112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 216.80
I0902 23:38:57.836184 139900407642112 replay_runner.py:36] Average training steps per second: 216.80

Steps executed: 223 Episode length: 223 Return: -462.5849088411481566
INFO:tensorflow:Starting iteration 19

Steps executed: 221 Episode length: 76 Return: -558.89995067567721566
INFO:tensorflow:Average training steps per second: 216.90
I0902 23:39:06.957175 139900407642112 replay_runner.py:36] Average training steps per second: 216.90
I0902 23:39:07.160864 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -549.33
INFO:tensorflow:Starting iteration 20
I0902 23:39:11.519484 139900407642112 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 215.88

Steps executed: 433 Episode length: 341 Return: -1546.864680302801266
I0902 23:39:16.835006 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -910.78
INFO:tensorflow:Starting iteration 21

Steps executed: 211 Episode length: 106 Return: -551.0499707627782866
INFO:tensorflow:Average training steps per second: 220.31
I0902 23:39:25.693040 139900407642112 replay_runner.py:36] Average training steps per second: 220.31
I0902 23:39:25.881143 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.10
INFO:tensorflow:Starting iteration 22
I0902 23:39:29.909728 139900407642112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 221.45

Steps executed: 227 Episode length: 57 Return: -98.458642874481859266
I0902 23:39:34.627916 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.41
INFO:tensorflow:Starting iteration 23

Steps executed: 381 Episode length: 260 Return: -497.5872878681214266
INFO:tensorflow:Average training steps per second: 221.82
I0902 23:39:43.379091 139900407642112 replay_runner.py:36] Average training steps per second: 221.82
I0902 23:39:43.872194 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.86
INFO:tensorflow:Starting iteration 24

Steps executed: 234 Episode length: 143 Return: -280.3151052342944266
INFO:tensorflow:Average training steps per second: 221.24
I0902 23:39:52.703083 139900407642112 replay_runner.py:36] Average training steps per second: 221.24
I0902 23:39:52.916068 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.89
INFO:tensorflow:Starting iteration 25

Steps executed: 298 Episode length: 111 Return: -596.3943854334357266
INFO:tensorflow:Average training steps per second: 223.44
I0902 23:40:01.604222 139900407642112 replay_runner.py:36] Average training steps per second: 223.44
I0902 23:40:01.883472 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -588.78
INFO:tensorflow:Starting iteration 26

Steps executed: 227 Episode length: 71 Return: -402.59165920671477266
INFO:tensorflow:Average training steps per second: 216.75
I0902 23:40:10.815271 139900407642112 replay_runner.py:36] Average training steps per second: 216.75
I0902 23:40:11.032880 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.71
INFO:tensorflow:Starting iteration 27

Steps executed: 278 Episode length: 99 Return: 25.3282316771508536266
INFO:tensorflow:Average training steps per second: 233.02
I0902 23:40:19.628268 139900407642112 replay_runner.py:36] Average training steps per second: 233.02
I0902 23:40:19.878005 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.34
INFO:tensorflow:Starting iteration 28

Steps executed: 293 Episode length: 104 Return: -926.2626283085322266
INFO:tensorflow:Average training steps per second: 229.89
I0902 23:40:28.566742 139900407642112 replay_runner.py:36] Average training steps per second: 229.89
I0902 23:40:28.830248 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -711.38
INFO:tensorflow:Starting iteration 29

Steps executed: 258 Episode length: 134 Return: -888.8874637796955266
INFO:tensorflow:Average training steps per second: 225.36
I0902 23:40:37.494282 139900407642112 replay_runner.py:36] Average training steps per second: 225.36

Done fixed training!Episode length: 134 Return: -888.8874637796955266