Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 23:51:13.811147 140268518520832 run_experiment.py:549] Creating TrainRunner ...
I0901 23:51:13.821032 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:51:13.821313 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:51:13.821453 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:51:13.821573 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:51:13.821686 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0901 23:51:13.821916 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:51:13.822055 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:51:13.822197 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:51:13.822313 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:51:13.822424 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0901 23:51:13.822536 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:51:13.822646 140268518520832 dqn_agent.py:283] 	 seed: 1630540273820957
I0901 23:51:13.825874 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:51:13.826158 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:51:13.826333 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:51:13.826513 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:51:13.826652 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:51:13.826780 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:51:13.826913 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:51:13.827208 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:51:13.827370 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:51:13.864711 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:51:14.279512 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:51:14.293497 140268518520832 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:51:14.322541 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:51:14.322781 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:51:14.322900 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:51:14.323213 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:51:14.323341 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0901 23:51:14.323421 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:51:14.323499 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:51:14.323572 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:51:14.323675 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:51:14.323778 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0901 23:51:14.323832 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:51:14.323906 140268518520832 dqn_agent.py:283] 	 seed: 1630540274322467
I0901 23:51:14.326183 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:51:14.326318 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:51:14.326406 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:51:14.326477 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:51:14.326553 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:51:14.326633 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:51:14.326748 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:51:14.326838 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:51:14.326920 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:51:14.361295 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:51:14.385627 140268518520832 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:51:14.385916 140268518520832 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 140.80
I0901 23:51:21.488823 140268518520832 replay_runner.py:36] Average training steps per second: 140.80
I0901 23:51:23.017357 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 377 Episode length: 377 Return: -376.0
INFO:tensorflow:Average training steps per second: 196.10
I0901 23:51:28.364112 140268518520832 replay_runner.py:36] Average training steps per second: 196.10
I0901 23:51:28.691681 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.00
INFO:tensorflow:Starting iteration 2
I0901 23:51:28.937633 140268518520832 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.62
I0901 23:51:34.211758 140268518520832 replay_runner.py:36] Average training steps per second: 189.62
I0901 23:51:34.639330 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.37
I0901 23:51:40.106217 140268518520832 replay_runner.py:36] Average training steps per second: 191.37
I0901 23:51:40.366586 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.00
INFO:tensorflow:Starting iteration 4

Steps executed: 311 Episode length: 311 Return: -310.0
INFO:tensorflow:Average training steps per second: 189.00
I0901 23:51:45.902885 140268518520832 replay_runner.py:36] Average training steps per second: 189.00
I0901 23:51:46.128028 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 5

Steps executed: 261 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 188.98

Steps executed: 237 Episode length: 120 Return: -119.0
I0901 23:51:51.879228 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 6
I0901 23:51:52.103082 140268518520832 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 189.79

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:51:57.821518 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 270 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 192.48
I0901 23:52:03.299433 140268518520832 replay_runner.py:36] Average training steps per second: 192.48
I0901 23:52:03.525543 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 8

Steps executed: 241 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 189.41
I0901 23:52:09.044360 140268518520832 replay_runner.py:36] Average training steps per second: 189.41
I0901 23:52:09.254689 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.05
I0901 23:52:14.763620 140268518520832 replay_runner.py:36] Average training steps per second: 190.05
I0901 23:52:15.171025 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 244 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 188.33
I0901 23:52:20.713086 140268518520832 replay_runner.py:36] Average training steps per second: 188.33
I0901 23:52:20.921427 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 11

Steps executed: 294 Episode length: 97 Return: -96.000
INFO:tensorflow:Average training steps per second: 193.34
I0901 23:52:26.343055 140268518520832 replay_runner.py:36] Average training steps per second: 193.34
I0901 23:52:26.580498 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 12

Steps executed: 286 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 187.55
I0901 23:52:32.145411 140268518520832 replay_runner.py:36] Average training steps per second: 187.55
I0901 23:52:32.380431 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 13

Steps executed: 85 Episode length: 85 Return: -84.00.0
INFO:tensorflow:Average training steps per second: 191.50
I0901 23:52:37.846153 140268518520832 replay_runner.py:36] Average training steps per second: 191.50

Steps executed: 282 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Starting iteration 14

Steps executed: 211 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 186.98
I0901 23:52:43.701506 140268518520832 replay_runner.py:36] Average training steps per second: 186.98
I0901 23:52:43.880908 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.25
I0901 23:52:49.250279 140268518520832 replay_runner.py:36] Average training steps per second: 195.25
I0901 23:52:49.669782 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 244 Episode length: 244 Return: -243.0
INFO:tensorflow:Average training steps per second: 200.85
I0901 23:52:54.898081 140268518520832 replay_runner.py:36] Average training steps per second: 200.85
I0901 23:52:55.110390 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.00
INFO:tensorflow:Starting iteration 17
I0901 23:52:55.385159 140268518520832 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.46
I0901 23:53:00.675202 140268518520832 replay_runner.py:36] Average training steps per second: 189.46
I0901 23:53:00.892581 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 18

Steps executed: 289 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 198.45
I0901 23:53:06.152805 140268518520832 replay_runner.py:36] Average training steps per second: 198.45
I0901 23:53:06.402740 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 19

Steps executed: 283 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 194.23

Steps executed: 288 Episode length: 92 Return: -91.0.0
I0901 23:53:12.030551 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 20

Steps executed: 284 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 186.62
I0901 23:53:17.617560 140268518520832 replay_runner.py:36] Average training steps per second: 186.62
I0901 23:53:17.868666 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 21

Steps executed: 290 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 194.60
I0901 23:53:23.251264 140268518520832 replay_runner.py:36] Average training steps per second: 194.60
I0901 23:53:23.508584 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.97
I0901 23:53:28.923557 140268518520832 replay_runner.py:36] Average training steps per second: 192.97
I0901 23:53:29.331201 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 232 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 197.43
I0901 23:53:34.625337 140268518520832 replay_runner.py:36] Average training steps per second: 197.43
I0901 23:53:34.824746 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 24
I0901 23:53:35.069187 140268518520832 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 201.31
I0901 23:53:40.037141 140268518520832 replay_runner.py:36] Average training steps per second: 201.31

Steps executed: 205 Episode length: 102 Return: -101.0
INFO:tensorflow:Starting iteration 25
I0901 23:53:40.421585 140268518520832 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.31
I0901 23:53:45.490092 140268518520832 replay_runner.py:36] Average training steps per second: 197.31
I0901 23:53:45.706084 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 26

Steps executed: 241 Episode length: 142 Return: -141.0
INFO:tensorflow:Average training steps per second: 198.07
I0901 23:53:50.984101 140268518520832 replay_runner.py:36] Average training steps per second: 198.07
I0901 23:53:51.227451 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 27

Steps executed: 284 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 197.23
I0901 23:53:56.540075 140268518520832 replay_runner.py:36] Average training steps per second: 197.23
I0901 23:53:56.718217 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 28

Steps executed: 213 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 198.92
I0901 23:54:01.978604 140268518520832 replay_runner.py:36] Average training steps per second: 198.92
I0901 23:54:02.221631 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 29

Steps executed: 281 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 193.04
I0901 23:54:07.646265 140268518520832 replay_runner.py:36] Average training steps per second: 193.04

Done fixed training!Episode length: 303 Return: -302.0