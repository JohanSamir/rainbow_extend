I0905 19:02:29.586035 139666636298240 run_experiment.py:549] Creating TrainRunner ...
I0905 19:02:29.592934 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:29.593043 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:29.593096 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:29.593165 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:29.593219 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:29.593286 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:29.593385 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:29.593452 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:29.593527 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:29.593575 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:29.593620 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:29.593690 139666636298240 dqn_agent.py:283] 	 seed: 1630868549592904
I0905 19:02:29.595624 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:29.595774 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:29.595875 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:29.595972 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:29.596059 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:29.596141 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:29.596222 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:29.596352 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:29.596460 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:29.627870 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:29.933698 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:29.950526 139666636298240 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:02:29.962745 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:29.962938 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:29.963057 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:29.963172 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:29.963270 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:29.963365 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:29.963459 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:29.963555 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:29.963649 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:29.963744 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:29.963837 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:29.963931 139666636298240 dqn_agent.py:283] 	 seed: 1630868549962700
I0905 19:02:29.966830 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:29.967015 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:29.967281 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:29.967406 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:29.967517 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:29.967622 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:29.967727 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:29.967826 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:29.967923 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:30.043566 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:30.058624 139666636298240 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:02:30.058794 139666636298240 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 202.05
I0905 19:02:35.008259 139666636298240 replay_runner.py:36] Average training steps per second: 202.05
I0905 19:02:36.042881 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.89
Steps executed: 257 Episode length: 128 Return: -375.04137931828663
INFO:tensorflow:Starting iteration 1

Steps executed: 285 Episode length: 111 Return: -294.58236239388717
INFO:tensorflow:Average training steps per second: 278.00
I0905 19:02:43.631165 139666636298240 replay_runner.py:36] Average training steps per second: 278.00
I0905 19:02:43.873087 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.60
INFO:tensorflow:Starting iteration 2

Steps executed: 108 Episode length: 108 Return: -440.99316464599717
INFO:tensorflow:Average training steps per second: 277.28

Steps executed: 1108 Episode length: 1000 Return: -140.6606546839972
I0905 19:02:54.589948 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.83
INFO:tensorflow:Starting iteration 3
I0905 19:02:58.417701 139666636298240 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 269.60

Steps executed: 1000 Episode length: 1000 Return: -131.12425951613062
I0905 19:03:04.804411 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.12
INFO:tensorflow:Starting iteration 4
I0905 19:03:08.615216 139666636298240 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 271.43

Steps executed: 977 Episode length: 977 Return: -451.7014297336004362
I0905 19:03:14.653512 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.70
INFO:tensorflow:Starting iteration 5
I0905 19:03:18.545365 139666636298240 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 265.60

Steps executed: 1000 Episode length: 1000 Return: -311.98410755639395
I0905 19:03:25.293782 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.98
INFO:tensorflow:Starting iteration 6
I0905 19:03:29.101526 139666636298240 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 283.51

Steps executed: 1000 Episode length: 1000 Return: -92.212324329768265
I0905 19:03:34.853113 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.21
INFO:tensorflow:Starting iteration 7

Steps executed: 422 Episode length: 422 Return: -335.4319521044357265
INFO:tensorflow:Average training steps per second: 272.84
I0905 19:03:42.399770 139666636298240 replay_runner.py:36] Average training steps per second: 272.84
I0905 19:03:42.894933 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.43
INFO:tensorflow:Starting iteration 8
I0905 19:03:46.874738 139666636298240 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 283.25

Steps executed: 1000 Episode length: 1000 Return: -218.52203257880527
I0905 19:03:54.216926 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.52
INFO:tensorflow:Starting iteration 9
I0905 19:03:58.105036 139666636298240 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 279.59

Steps executed: 1000 Episode length: 1000 Return: -552.39280980878297
I0905 19:04:05.170047 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -552.39
INFO:tensorflow:Starting iteration 10

Steps executed: 579 Episode length: 579 Return: -32.77237771344676297
INFO:tensorflow:Average training steps per second: 255.59
I0905 19:04:12.769620 139666636298240 replay_runner.py:36] Average training steps per second: 255.59
I0905 19:04:13.767096 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -32.77
INFO:tensorflow:Starting iteration 11
I0905 19:04:17.553067 139666636298240 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 263.86

Steps executed: 929 Episode length: 929 Return: 146.38455298428146297
I0905 19:04:23.872151 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.38
INFO:tensorflow:Starting iteration 12

Steps executed: 341 Episode length: 341 Return: -227.4244652763916397
INFO:tensorflow:Average training steps per second: 288.27
I0905 19:04:31.310274 139666636298240 replay_runner.py:36] Average training steps per second: 288.27
I0905 19:04:31.745074 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.42
INFO:tensorflow:Starting iteration 13
I0905 19:04:35.698468 139666636298240 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 257.94
I0905 19:04:39.575699 139666636298240 replay_runner.py:36] Average training steps per second: 257.94

Steps executed: 336 Episode length: 336 Return: -105.7309668228609597
INFO:tensorflow:Starting iteration 14
I0905 19:04:43.736139 139666636298240 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 258.71

Steps executed: 1000 Episode length: 1000 Return: -104.64872814974322
I0905 19:04:50.773553 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.65
INFO:tensorflow:Starting iteration 15

Steps executed: 274 Episode length: 131 Return: -20.89553325565465522
INFO:tensorflow:Average training steps per second: 250.24
I0905 19:04:58.611685 139666636298240 replay_runner.py:36] Average training steps per second: 250.24
I0905 19:04:58.855727 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -10.20
INFO:tensorflow:Starting iteration 16

Steps executed: 383 Episode length: 383 Return: 226.86611727345585522
INFO:tensorflow:Average training steps per second: 249.44
I0905 19:05:06.644517 139666636298240 replay_runner.py:36] Average training steps per second: 249.44
I0905 19:05:07.242513 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 226.87
INFO:tensorflow:Starting iteration 17

Steps executed: 259 Episode length: 138 Return: -147.8899015418547522
INFO:tensorflow:Average training steps per second: 257.17
I0905 19:05:14.927149 139666636298240 replay_runner.py:36] Average training steps per second: 257.17
I0905 19:05:15.175520 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.61
INFO:tensorflow:Starting iteration 18

Steps executed: 215 Episode length: 80 Return: -434.07029876979842422
INFO:tensorflow:Average training steps per second: 278.15
I0905 19:05:22.721009 139666636298240 replay_runner.py:36] Average training steps per second: 278.15
I0905 19:05:22.899682 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.31
INFO:tensorflow:Starting iteration 19

Steps executed: 281 Episode length: 112 Return: 32.165355381980225422
INFO:tensorflow:Average training steps per second: 280.94
I0905 19:05:30.518838 139666636298240 replay_runner.py:36] Average training steps per second: 280.94
I0905 19:05:30.721006 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -9.43
INFO:tensorflow:Starting iteration 20

Steps executed: 337 Episode length: 186 Return: 38.921410859618737622
INFO:tensorflow:Average training steps per second: 248.03
I0905 19:05:38.595634 139666636298240 replay_runner.py:36] Average training steps per second: 248.03
I0905 19:05:38.855957 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.54
INFO:tensorflow:Starting iteration 21

Steps executed: 223 Episode length: 69 Return: -310.88032117733237622
INFO:tensorflow:Average training steps per second: 239.73
I0905 19:05:46.568826 139666636298240 replay_runner.py:36] Average training steps per second: 239.73
I0905 19:05:46.752120 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.18
INFO:tensorflow:Starting iteration 22

Steps executed: 208 Episode length: 66 Return: -433.07330004719216622
INFO:tensorflow:Average training steps per second: 233.82
I0905 19:05:54.459857 139666636298240 replay_runner.py:36] Average training steps per second: 233.82
I0905 19:05:54.648990 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.95
INFO:tensorflow:Starting iteration 23

Steps executed: 77 Episode length: 77 Return: -575.674619027457816622
INFO:tensorflow:Average training steps per second: 267.80

Steps executed: 263 Episode length: 67 Return: -491.58995163074266622
I0905 19:06:02.122377 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.73
INFO:tensorflow:Starting iteration 24

Steps executed: 224 Episode length: 67 Return: -411.18523684398843622
INFO:tensorflow:Average training steps per second: 307.70
I0905 19:06:09.448953 139666636298240 replay_runner.py:36] Average training steps per second: 307.70
I0905 19:06:09.623904 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.19
INFO:tensorflow:Starting iteration 25

Steps executed: 232 Episode length: 82 Return: -494.07076017882063622
INFO:tensorflow:Average training steps per second: 284.96
I0905 19:06:17.300601 139666636298240 replay_runner.py:36] Average training steps per second: 284.96
I0905 19:06:17.467801 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -516.36
INFO:tensorflow:Starting iteration 26

Steps executed: 211 Episode length: 136 Return: -336.8800119458678622
INFO:tensorflow:Average training steps per second: 263.34
I0905 19:06:25.269293 139666636298240 replay_runner.py:36] Average training steps per second: 263.34
I0905 19:06:25.456767 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -374.04
INFO:tensorflow:Starting iteration 27

Steps executed: 294 Episode length: 139 Return: -502.1615005975563622
INFO:tensorflow:Average training steps per second: 258.09
I0905 19:06:33.126683 139666636298240 replay_runner.py:36] Average training steps per second: 258.09
I0905 19:06:33.396681 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.61
INFO:tensorflow:Starting iteration 28
I0905 19:06:37.082226 139666636298240 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 298.36

Steps executed: 1000 Episode length: 1000 Return: 79.8693205743232422
I0905 19:06:42.980693 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.87
INFO:tensorflow:Starting iteration 29

Steps executed: 411 Episode length: 411 Return: 227.98447124841052422
INFO:tensorflow:Average training steps per second: 310.54
I0905 19:06:49.757248 139666636298240 replay_runner.py:36] Average training steps per second: 310.54

Done fixed training!Episode length: 411 Return: 227.98447124841052422