Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0905 18:55:48.854316 140686369892352 run_experiment.py:549] Creating TrainRunner ...
I0905 18:55:48.864991 140686369892352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:48.865229 140686369892352 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:48.865362 140686369892352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:48.865513 140686369892352 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:48.865655 140686369892352 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:48.865751 140686369892352 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:48.865840 140686369892352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:48.865953 140686369892352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:48.866092 140686369892352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:48.866197 140686369892352 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:48.866306 140686369892352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:48.866446 140686369892352 dqn_agent.py:283] 	 seed: 1630868148864934
I0905 18:55:48.869938 140686369892352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:48.870216 140686369892352 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:48.870347 140686369892352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:48.870447 140686369892352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:48.870572 140686369892352 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:48.870648 140686369892352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:48.870719 140686369892352 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:48.870825 140686369892352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:48.870893 140686369892352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:48.929786 140686369892352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.490466 140686369892352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.506831 140686369892352 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:55:49.516066 140686369892352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:49.516353 140686369892352 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:49.516473 140686369892352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:49.516590 140686369892352 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:49.516779 140686369892352 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:49.516904 140686369892352 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:49.516977 140686369892352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:49.517329 140686369892352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:49.517728 140686369892352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:49.517907 140686369892352 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:49.518089 140686369892352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:49.518243 140686369892352 dqn_agent.py:283] 	 seed: 1630868149516004
I0905 18:55:49.520934 140686369892352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:49.521128 140686369892352 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:49.521262 140686369892352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:49.521368 140686369892352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:49.521470 140686369892352 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:49.521574 140686369892352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:49.521667 140686369892352 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:49.521749 140686369892352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:49.521827 140686369892352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:49.566679 140686369892352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.594132 140686369892352 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:55:49.594499 140686369892352 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 125.67
I0905 18:55:57.552155 140686369892352 replay_runner.py:36] Average training steps per second: 125.67
Steps executed: 201 Episode length: 8 Return: 8.0.0
I0905 18:55:59.054849 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 297 Episode length: 108 Return: 108.0
INFO:tensorflow:Average training steps per second: 169.71
I0905 18:56:05.162727 140686369892352 replay_runner.py:36] Average training steps per second: 169.71
I0905 18:56:05.432416 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 99.00
INFO:tensorflow:Starting iteration 2

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 161.93
I0905 18:56:11.821342 140686369892352 replay_runner.py:36] Average training steps per second: 161.93
I0905 18:56:12.420214 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 3

Steps executed: 313 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 159.25
I0905 18:56:18.942911 140686369892352 replay_runner.py:36] Average training steps per second: 159.25
I0905 18:56:19.434462 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 4

Steps executed: 139 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 154.12

Steps executed: 282 Episode length: 143 Return: 143.0
I0905 18:56:26.637461 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 5

Steps executed: 252 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 150.80
I0905 18:56:33.519860 140686369892352 replay_runner.py:36] Average training steps per second: 150.80
I0905 18:56:33.883445 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.00
INFO:tensorflow:Starting iteration 6

Steps executed: 126 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 158.06

Steps executed: 259 Episode length: 133 Return: 133.0
I0905 18:56:40.758038 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 7

Steps executed: 251 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 156.81
I0905 18:56:47.334694 140686369892352 replay_runner.py:36] Average training steps per second: 156.81
I0905 18:56:47.690060 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 157.42
I0905 18:56:54.277170 140686369892352 replay_runner.py:36] Average training steps per second: 157.42
I0905 18:56:54.550109 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 281 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 153.80
I0905 18:57:01.299976 140686369892352 replay_runner.py:36] Average training steps per second: 153.80
I0905 18:57:01.637849 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 10

Steps executed: 188 Episode length: 188 Return: 188.0
INFO:tensorflow:Average training steps per second: 152.37

Steps executed: 373 Episode length: 185 Return: 185.0
I0905 18:57:08.908837 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 11

Steps executed: 223 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 168.72
I0905 18:57:15.057002 140686369892352 replay_runner.py:36] Average training steps per second: 168.72
I0905 18:57:15.419019 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 111.50
INFO:tensorflow:Starting iteration 12

Steps executed: 175 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 148.32

Steps executed: 375 Episode length: 200 Return: 200.0
I0905 18:57:22.958132 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 152.83
I0905 18:57:29.740496 140686369892352 replay_runner.py:36] Average training steps per second: 152.83
I0905 18:57:29.989889 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0905 18:57:30.222243 140686369892352 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 148.20

Steps executed: 252 Episode length: 128 Return: 128.0
I0905 18:57:37.346353 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.00
INFO:tensorflow:Starting iteration 15

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 157.23
I0905 18:57:43.956077 140686369892352 replay_runner.py:36] Average training steps per second: 157.23
I0905 18:57:44.451543 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 16

Steps executed: 348 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 153.80
I0905 18:57:51.198084 140686369892352 replay_runner.py:36] Average training steps per second: 153.80
I0905 18:57:51.649216 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 17

Steps executed: 310 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 163.00
I0905 18:57:58.029853 140686369892352 replay_runner.py:36] Average training steps per second: 163.00
I0905 18:57:58.394373 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 166.76
I0905 18:58:04.588383 140686369892352 replay_runner.py:36] Average training steps per second: 166.76
I0905 18:58:04.915998 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 18:58:05.161586 140686369892352 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 153.16
I0905 18:58:11.691126 140686369892352 replay_runner.py:36] Average training steps per second: 153.16
I0905 18:58:11.992930 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 177 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 156.87
I0905 18:58:18.617253 140686369892352 replay_runner.py:36] Average training steps per second: 156.87

Steps executed: 344 Episode length: 167 Return: 167.0
INFO:tensorflow:Starting iteration 21

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 150.47
I0905 18:58:25.963794 140686369892352 replay_runner.py:36] Average training steps per second: 150.47
I0905 18:58:26.544025 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 22

Steps executed: 340 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 155.18
I0905 18:58:33.236025 140686369892352 replay_runner.py:36] Average training steps per second: 155.18
I0905 18:58:33.793518 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 152.10
I0905 18:58:40.622924 140686369892352 replay_runner.py:36] Average training steps per second: 152.10
I0905 18:58:40.970287 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0905 18:58:41.180083 140686369892352 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 163.73
I0905 18:58:47.288478 140686369892352 replay_runner.py:36] Average training steps per second: 163.73
I0905 18:58:47.635486 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0905 18:58:47.898695 140686369892352 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 148.92
I0905 18:58:54.614578 140686369892352 replay_runner.py:36] Average training steps per second: 148.92
I0905 18:58:54.944521 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 307 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 153.59
I0905 18:59:01.716026 140686369892352 replay_runner.py:36] Average training steps per second: 153.59
I0905 18:59:02.192218 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 157.38
I0905 18:59:08.792756 140686369892352 replay_runner.py:36] Average training steps per second: 157.38
I0905 18:59:09.097016 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 318 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 155.59
I0905 18:59:15.763880 140686369892352 replay_runner.py:36] Average training steps per second: 155.59
I0905 18:59:16.175340 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 158.83
I0905 18:59:22.713543 140686369892352 replay_runner.py:36] Average training steps per second: 158.83
I0905 18:59:22.903701 140686369892352 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00