Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0901 12:19:05.008855 139816666404864 run_experiment.py:549] Creating TrainRunner ...
I0901 12:19:05.018186 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:05.018438 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:05.018607 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:05.018715 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:05.018790 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:05.018866 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:05.018973 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:05.019082 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:05.019149 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:05.019211 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:05.019273 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:05.019334 139816666404864 dqn_agent.py:283] 	 seed: 1630498745018128
I0901 12:19:05.021741 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:05.021998 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:05.022201 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:05.022344 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:05.022458 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:05.022561 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:05.022657 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:05.022755 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:05.022865 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:05.244295 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.665983 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.679975 139816666404864 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:19:05.687852 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:05.688119 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:05.688334 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:05.688514 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:05.688857 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:05.689057 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:05.689293 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:05.689437 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:05.689577 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:05.689724 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:05.689847 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:05.689979 139816666404864 dqn_agent.py:283] 	 seed: 1630498745687790
I0901 12:19:05.692637 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:05.692759 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:05.692860 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:05.692953 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:05.693093 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:05.693199 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:05.693272 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:05.693344 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:05.693412 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:05.722107 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.743356 139816666404864 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:19:05.743648 139816666404864 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.87
I0901 12:19:12.462065 139816666404864 replay_runner.py:36] Average training steps per second: 148.87
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:19:14.006867 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:19:14.259864 139816666404864 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 199.34
I0901 12:19:19.276789 139816666404864 replay_runner.py:36] Average training steps per second: 199.34
I0901 12:19:19.675780 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:19:19.911893 139816666404864 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.00
I0901 12:19:25.175503 139816666404864 replay_runner.py:36] Average training steps per second: 190.00
I0901 12:19:25.598983 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:19:25.849122 139816666404864 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.33
I0901 12:19:30.866529 139816666404864 replay_runner.py:36] Average training steps per second: 199.33
I0901 12:19:31.290044 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:19:31.539726 139816666404864 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 193.49
I0901 12:19:36.708489 139816666404864 replay_runner.py:36] Average training steps per second: 193.49
I0901 12:19:37.103767 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:19:37.339917 139816666404864 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 204.77
I0901 12:19:42.223889 139816666404864 replay_runner.py:36] Average training steps per second: 204.77
I0901 12:19:42.628983 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:19:42.864872 139816666404864 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.26
I0901 12:19:47.986832 139816666404864 replay_runner.py:36] Average training steps per second: 195.26
I0901 12:19:48.397307 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:19:48.659175 139816666404864 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 197.27
I0901 12:19:53.728883 139816666404864 replay_runner.py:36] Average training steps per second: 197.27
I0901 12:19:54.144434 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:19:54.388547 139816666404864 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 193.68
I0901 12:19:59.552154 139816666404864 replay_runner.py:36] Average training steps per second: 193.68
I0901 12:19:59.947241 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:20:00.192013 139816666404864 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 201.51
I0901 12:20:05.154968 139816666404864 replay_runner.py:36] Average training steps per second: 201.51
I0901 12:20:05.570968 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:20:05.811192 139816666404864 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 191.27
I0901 12:20:11.039931 139816666404864 replay_runner.py:36] Average training steps per second: 191.27
I0901 12:20:11.448871 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:20:11.696408 139816666404864 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 188.94

Steps executed: 218 Episode length: 218 Return: -217.0
I0901 12:20:17.187934 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.00
INFO:tensorflow:Starting iteration 12

Steps executed: 284 Episode length: 138 Return: -137.0
INFO:tensorflow:Average training steps per second: 192.78
I0901 12:20:22.623067 139816666404864 replay_runner.py:36] Average training steps per second: 192.78
I0901 12:20:22.876765 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.98
I0901 12:20:28.422711 139816666404864 replay_runner.py:36] Average training steps per second: 188.98
I0901 12:20:28.823751 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 12:20:29.053080 139816666404864 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 190.93
I0901 12:20:34.290985 139816666404864 replay_runner.py:36] Average training steps per second: 190.93
I0901 12:20:34.709929 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 12:20:34.954289 139816666404864 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 196.11
I0901 12:20:40.053973 139816666404864 replay_runner.py:36] Average training steps per second: 196.11
I0901 12:20:40.460995 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:20:40.704009 139816666404864 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.65
I0901 12:20:45.895141 139816666404864 replay_runner.py:36] Average training steps per second: 192.65
I0901 12:20:46.325998 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 267 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 194.33
I0901 12:20:51.717104 139816666404864 replay_runner.py:36] Average training steps per second: 194.33
I0901 12:20:51.934322 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 18

Steps executed: 392 Episode length: 217 Return: -216.0
INFO:tensorflow:Average training steps per second: 194.75
I0901 12:20:57.307518 139816666404864 replay_runner.py:36] Average training steps per second: 194.75
I0901 12:20:57.659791 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.67
INFO:tensorflow:Starting iteration 19
I0901 12:20:57.909034 139816666404864 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 198.47

Steps executed: 218 Episode length: 218 Return: -217.0
I0901 12:21:03.135125 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.00
INFO:tensorflow:Starting iteration 20

Steps executed: 294 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 192.43
I0901 12:21:08.575630 139816666404864 replay_runner.py:36] Average training steps per second: 192.43
I0901 12:21:08.862706 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.00
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 197.36
I0901 12:21:14.184420 139816666404864 replay_runner.py:36] Average training steps per second: 197.36
I0901 12:21:14.351547 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 22

Steps executed: 298 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 193.94
I0901 12:21:19.742612 139816666404864 replay_runner.py:36] Average training steps per second: 193.94
I0901 12:21:20.013363 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.00
INFO:tensorflow:Starting iteration 23

Steps executed: 214 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 192.55
I0901 12:21:25.453254 139816666404864 replay_runner.py:36] Average training steps per second: 192.55
I0901 12:21:25.637343 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 198.69
I0901 12:21:30.915535 139816666404864 replay_runner.py:36] Average training steps per second: 198.69
I0901 12:21:31.102948 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 25

Steps executed: 274 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 194.91
I0901 12:21:36.483079 139816666404864 replay_runner.py:36] Average training steps per second: 194.91
I0901 12:21:36.703016 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 26

Steps executed: 261 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 201.64
I0901 12:21:41.897405 139816666404864 replay_runner.py:36] Average training steps per second: 201.64
I0901 12:21:42.126573 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 27
I0901 12:21:42.349070 139816666404864 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 203.47
I0901 12:21:47.264329 139816666404864 replay_runner.py:36] Average training steps per second: 203.47

Steps executed: 287 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Starting iteration 28

Steps executed: 275 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 198.88
I0901 12:21:52.761385 139816666404864 replay_runner.py:36] Average training steps per second: 198.88
I0901 12:21:52.984845 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.50
INFO:tensorflow:Starting iteration 29
I0901 12:21:53.272311 139816666404864 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 209.65
I0901 12:21:58.042649 139816666404864 replay_runner.py:36] Average training steps per second: 209.65

Done fixed training!Episode length: 104 Return: -103.0