Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 13:26:57.695921 139651903387648 run_experiment.py:549] Creating TrainRunner ...
I0909 13:26:57.704046 139651903387648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:26:57.704213 139651903387648 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:26:57.704300 139651903387648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:26:57.704418 139651903387648 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:26:57.704496 139651903387648 dqn_agent.py:275] 	 update_period: 4
I0909 13:26:57.704589 139651903387648 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:26:57.704654 139651903387648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:26:57.704983 139651903387648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:26:57.705083 139651903387648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:26:57.705183 139651903387648 dqn_agent.py:280] 	 optimizer: adam
I0909 13:26:57.705261 139651903387648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:26:57.705321 139651903387648 dqn_agent.py:283] 	 seed: 1631194017704010
I0909 13:26:57.707294 139651903387648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:26:57.707403 139651903387648 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:26:57.707480 139651903387648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:26:57.707541 139651903387648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:26:57.707597 139651903387648 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:26:57.707669 139651903387648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:26:57.707725 139651903387648 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:26:57.707802 139651903387648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:26:57.707863 139651903387648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:26:57.745211 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:57.993179 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:58.003245 139651903387648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:26:58.010763 139651903387648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:26:58.011050 139651903387648 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:26:58.011169 139651903387648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:26:58.011265 139651903387648 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:26:58.011416 139651903387648 dqn_agent.py:275] 	 update_period: 4
I0909 13:26:58.011501 139651903387648 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:26:58.011622 139651903387648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:26:58.011701 139651903387648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:26:58.011794 139651903387648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:26:58.011898 139651903387648 dqn_agent.py:280] 	 optimizer: adam
I0909 13:26:58.012009 139651903387648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:26:58.012144 139651903387648 dqn_agent.py:283] 	 seed: 1631194018010705
I0909 13:26:58.014127 139651903387648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:26:58.014246 139651903387648 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:26:58.014316 139651903387648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:26:58.014377 139651903387648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:26:58.014432 139651903387648 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:26:58.014502 139651903387648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:26:58.014560 139651903387648 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:26:58.014635 139651903387648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:26:58.014701 139651903387648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:26:58.048874 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:58.072907 139651903387648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:26:58.073202 139651903387648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 167.31
I0909 13:27:04.050254 139651903387648 replay_runner.py:36] Average training steps per second: 167.31
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:27:05.767010 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:27:05.879081 139651903387648 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 210.57
I0909 13:27:10.628534 139651903387648 replay_runner.py:36] Average training steps per second: 210.57
I0909 13:27:11.047670 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:27:11.161103 139651903387648 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 203.33
I0909 13:27:16.080042 139651903387648 replay_runner.py:36] Average training steps per second: 203.33
I0909 13:27:16.494760 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:27:16.612456 139651903387648 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 205.12
I0909 13:27:21.488130 139651903387648 replay_runner.py:36] Average training steps per second: 205.12
I0909 13:27:21.921974 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:27:22.037836 139651903387648 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 185.59
I0909 13:27:27.426509 139651903387648 replay_runner.py:36] Average training steps per second: 185.59
I0909 13:27:27.862114 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:27:27.978668 139651903387648 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 185.29
I0909 13:27:33.376245 139651903387648 replay_runner.py:36] Average training steps per second: 185.29
I0909 13:27:33.789250 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:27:33.913154 139651903387648 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 184.69
I0909 13:27:39.328139 139651903387648 replay_runner.py:36] Average training steps per second: 184.69
I0909 13:27:39.768187 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:27:39.891875 139651903387648 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.79
I0909 13:27:44.973719 139651903387648 replay_runner.py:36] Average training steps per second: 196.79
I0909 13:27:45.397076 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:27:45.522176 139651903387648 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.06
I0909 13:27:50.623072 139651903387648 replay_runner.py:36] Average training steps per second: 196.06
I0909 13:27:51.061713 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:27:51.183625 139651903387648 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 194.28
I0909 13:27:56.331243 139651903387648 replay_runner.py:36] Average training steps per second: 194.28
I0909 13:27:56.759713 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:27:56.883165 139651903387648 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 196.52
I0909 13:28:01.972284 139651903387648 replay_runner.py:36] Average training steps per second: 196.52
I0909 13:28:02.406874 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:28:02.527971 139651903387648 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.09
I0909 13:28:07.602156 139651903387648 replay_runner.py:36] Average training steps per second: 197.09
I0909 13:28:08.034352 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0909 13:28:08.155595 139651903387648 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 196.21
I0909 13:28:13.252572 139651903387648 replay_runner.py:36] Average training steps per second: 196.21
I0909 13:28:13.691727 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0909 13:28:13.814343 139651903387648 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.48
I0909 13:28:18.930247 139651903387648 replay_runner.py:36] Average training steps per second: 195.48
I0909 13:28:19.366241 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0909 13:28:19.486771 139651903387648 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 196.48
I0909 13:28:24.576591 139651903387648 replay_runner.py:36] Average training steps per second: 196.48
I0909 13:28:25.032374 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0909 13:28:25.157042 139651903387648 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 195.39
I0909 13:28:30.275697 139651903387648 replay_runner.py:36] Average training steps per second: 195.39
I0909 13:28:30.743808 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 353 Episode length: 186 Return: -186.0
INFO:tensorflow:Average training steps per second: 196.10
I0909 13:28:35.965760 139651903387648 replay_runner.py:36] Average training steps per second: 196.10
I0909 13:28:36.240604 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.50
INFO:tensorflow:Starting iteration 17

Steps executed: 250 Episode length: 139 Return: -139.0
INFO:tensorflow:Average training steps per second: 198.11
I0909 13:28:41.414832 139651903387648 replay_runner.py:36] Average training steps per second: 198.11
I0909 13:28:41.606485 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 18

Steps executed: 210 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 194.15
I0909 13:28:46.886840 139651903387648 replay_runner.py:36] Average training steps per second: 194.15
I0909 13:28:47.051259 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 19

Steps executed: 225 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 197.52
I0909 13:28:52.241292 139651903387648 replay_runner.py:36] Average training steps per second: 197.52
I0909 13:28:52.408476 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 20

Steps executed: 277 Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 197.04
I0909 13:28:57.600727 139651903387648 replay_runner.py:36] Average training steps per second: 197.04
I0909 13:28:57.803267 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.33
INFO:tensorflow:Starting iteration 21

Steps executed: 311 Episode length: 159 Return: -159.0
INFO:tensorflow:Average training steps per second: 195.94
I0909 13:29:03.031377 139651903387648 replay_runner.py:36] Average training steps per second: 195.94
I0909 13:29:03.266082 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.50
INFO:tensorflow:Starting iteration 22

Steps executed: 237 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 191.99
I0909 13:29:08.598448 139651903387648 replay_runner.py:36] Average training steps per second: 191.99
I0909 13:29:08.777631 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 23
I0909 13:29:08.910010 139651903387648 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 193.02
I0909 13:29:14.091294 139651903387648 replay_runner.py:36] Average training steps per second: 193.02

Steps executed: 232 Episode length: 121 Return: -121.0
INFO:tensorflow:Starting iteration 24

Steps executed: 224 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 195.68
I0909 13:29:19.521827 139651903387648 replay_runner.py:36] Average training steps per second: 195.68
I0909 13:29:19.688249 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 25

Steps executed: 205 Episode length: 96 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 197.00
I0909 13:29:24.889714 139651903387648 replay_runner.py:36] Average training steps per second: 197.00
I0909 13:29:25.048855 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.50
INFO:tensorflow:Starting iteration 26

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 193.11
I0909 13:29:30.345761 139651903387648 replay_runner.py:36] Average training steps per second: 193.11
I0909 13:29:30.789672 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0909 13:29:30.916775 139651903387648 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 198.44

Steps executed: 292 Episode length: 102 Return: -102.0
I0909 13:29:36.180742 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 28

Steps executed: 748 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 195.48
I0909 13:29:41.428978 139651903387648 replay_runner.py:36] Average training steps per second: 195.48
I0909 13:29:41.957330 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -374.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 210.13
I0909 13:29:46.836208 139651903387648 replay_runner.py:36] Average training steps per second: 210.13
I0909 13:29:46.981073 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50