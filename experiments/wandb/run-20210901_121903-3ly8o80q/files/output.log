Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0901 12:19:09.955165 139983334602752 run_experiment.py:549] Creating TrainRunner ...
I0901 12:19:09.964281 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:09.964555 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:09.964726 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:09.964841 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:09.965029 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:09.965132 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:09.965242 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:09.965343 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:09.965425 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:09.965502 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:09.965606 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:09.965682 139983334602752 dqn_agent.py:283] 	 seed: 1630498749964225
I0901 12:19:09.967988 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:09.968208 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:09.968364 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:09.968468 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:09.968549 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:09.968638 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:09.968762 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:09.968940 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:09.969066 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:10.170902 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:10.614828 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:10.628978 139983334602752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:19:10.637146 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:10.637590 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:10.637799 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:10.637950 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:10.638089 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:10.638265 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:10.638356 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:10.638431 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:10.638514 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:10.638584 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:10.638662 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:10.638751 139983334602752 dqn_agent.py:283] 	 seed: 1630498750637086
I0901 12:19:10.641010 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:10.641207 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:10.641363 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:10.641497 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:10.641584 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:10.641762 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:10.641894 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:10.642141 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:10.642302 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:10.673091 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:10.694264 139983334602752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:19:10.694661 139983334602752 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 140.34
I0901 12:19:17.820600 139983334602752 replay_runner.py:36] Average training steps per second: 140.34
I0901 12:19:19.239979 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:19:19.477850 139983334602752 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 184.67
I0901 12:19:24.893423 139983334602752 replay_runner.py:36] Average training steps per second: 184.67
I0901 12:19:25.307001 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:19:25.553017 139983334602752 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 197.79
I0901 12:19:30.609639 139983334602752 replay_runner.py:36] Average training steps per second: 197.79
I0901 12:19:31.025815 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:19:31.264442 139983334602752 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.12
I0901 12:19:36.416260 139983334602752 replay_runner.py:36] Average training steps per second: 194.12
I0901 12:19:36.831785 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:19:37.064025 139983334602752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 209.14
I0901 12:19:41.845878 139983334602752 replay_runner.py:36] Average training steps per second: 209.14
I0901 12:19:42.253010 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:19:42.493280 139983334602752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.61
I0901 12:19:47.767959 139983334602752 replay_runner.py:36] Average training steps per second: 189.61
I0901 12:19:48.197439 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:19:48.423290 139983334602752 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.44
I0901 12:19:53.437651 139983334602752 replay_runner.py:36] Average training steps per second: 199.44
I0901 12:19:53.866329 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:19:54.095403 139983334602752 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 189.12
I0901 12:19:59.383503 139983334602752 replay_runner.py:36] Average training steps per second: 189.12
I0901 12:19:59.794408 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:20:00.018442 139983334602752 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.50
I0901 12:20:05.057110 139983334602752 replay_runner.py:36] Average training steps per second: 198.50
I0901 12:20:05.482469 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:20:05.719848 139983334602752 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 192.18
I0901 12:20:10.923912 139983334602752 replay_runner.py:36] Average training steps per second: 192.18
I0901 12:20:11.334421 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:20:11.579193 139983334602752 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 191.67
I0901 12:20:16.797007 139983334602752 replay_runner.py:36] Average training steps per second: 191.67
I0901 12:20:17.236772 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:20:17.476709 139983334602752 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 193.56
I0901 12:20:22.643550 139983334602752 replay_runner.py:36] Average training steps per second: 193.56
I0901 12:20:23.088515 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:20:23.320350 139983334602752 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 189.78
I0901 12:20:28.590007 139983334602752 replay_runner.py:36] Average training steps per second: 189.78
I0901 12:20:28.996751 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 12:20:29.236437 139983334602752 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 189.82
I0901 12:20:34.505065 139983334602752 replay_runner.py:36] Average training steps per second: 189.82
I0901 12:20:34.934065 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 222 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 195.35
I0901 12:20:40.291553 139983334602752 replay_runner.py:36] Average training steps per second: 195.35
I0901 12:20:40.474960 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 15
I0901 12:20:40.719480 139983334602752 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 192.34

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:20:46.350653 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:20:46.588842 139983334602752 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 193.45
I0901 12:20:51.758488 139983334602752 replay_runner.py:36] Average training steps per second: 193.45
I0901 12:20:52.178852 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 12:20:52.397446 139983334602752 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.48
I0901 12:20:57.675478 139983334602752 replay_runner.py:36] Average training steps per second: 189.48
I0901 12:20:58.127699 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 12:20:58.357630 139983334602752 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.28
I0901 12:21:03.401355 139983334602752 replay_runner.py:36] Average training steps per second: 198.28
I0901 12:21:03.819538 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 213 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 195.83
I0901 12:21:09.170533 139983334602752 replay_runner.py:36] Average training steps per second: 195.83
I0901 12:21:09.361866 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 20

Steps executed: 270 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 193.96
I0901 12:21:14.765078 139983334602752 replay_runner.py:36] Average training steps per second: 193.96
I0901 12:21:14.991971 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.00
INFO:tensorflow:Starting iteration 21

Steps executed: 285 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 191.22
I0901 12:21:20.473595 139983334602752 replay_runner.py:36] Average training steps per second: 191.22
I0901 12:21:20.715774 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 22
I0901 12:21:20.958715 139983334602752 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 194.54
I0901 12:21:26.099668 139983334602752 replay_runner.py:36] Average training steps per second: 194.54

Steps executed: 232 Episode length: 149 Return: -148.0
INFO:tensorflow:Starting iteration 23

Steps executed: 248 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 195.47
I0901 12:21:31.644207 139983334602752 replay_runner.py:36] Average training steps per second: 195.47
I0901 12:21:31.856233 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 24

Steps executed: 229 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 200.90
I0901 12:21:37.077613 139983334602752 replay_runner.py:36] Average training steps per second: 200.90
I0901 12:21:37.258829 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 25
I0901 12:21:37.499310 139983334602752 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.18

Steps executed: 245 Episode length: 109 Return: -108.0
I0901 12:21:42.664765 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 26

Steps executed: 205 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 206.08
I0901 12:21:47.755378 139983334602752 replay_runner.py:36] Average training steps per second: 206.08
I0901 12:21:47.909698 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 200.99
I0901 12:21:53.118940 139983334602752 replay_runner.py:36] Average training steps per second: 200.99
I0901 12:21:53.321800 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 28
I0901 12:21:53.544306 139983334602752 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.85
I0901 12:21:58.402735 139983334602752 replay_runner.py:36] Average training steps per second: 205.85

Steps executed: 296 Episode length: 104 Return: -103.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 199.59
I0901 12:22:03.879459 139983334602752 replay_runner.py:36] Average training steps per second: 199.59
I0901 12:22:04.075864 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33