Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0902 18:09:07.744906 140665773373440 run_experiment.py:549] Creating TrainRunner ...
I0902 18:09:07.753805 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:07.754014 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:07.754114 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:07.754199 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:07.754276 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:07.754362 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:07.754437 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:07.754546 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:07.754680 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:07.754794 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:07.754888 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:07.754976 140665773373440 dqn_agent.py:283] 	 seed: 1630606147753749
I0902 18:09:07.757387 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:07.757572 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:07.757673 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:07.757773 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:07.757889 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:07.757978 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:07.758055 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:07.758199 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:07.758280 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:07.792364 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:08.205343 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:08.218549 140665773373440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:09:08.247173 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:08.247478 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:08.247632 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:08.247761 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:08.247887 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:08.248016 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:08.248134 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:08.248260 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:08.248418 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:08.248550 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:08.248666 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:08.248780 140665773373440 dqn_agent.py:283] 	 seed: 1630606148247110
I0902 18:09:08.251836 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:08.252028 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:08.252171 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:08.252330 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:08.252485 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:08.252608 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:08.252823 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:08.252985 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:08.253111 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:08.285615 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:08.308342 140665773373440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:09:08.308608 140665773373440 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.83
I0902 18:09:15.119764 140665773373440 replay_runner.py:36] Average training steps per second: 146.83
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:09:16.708555 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 371 Episode length: 184 Return: -183.0
INFO:tensorflow:Average training steps per second: 197.30
I0902 18:09:22.023156 140665773373440 replay_runner.py:36] Average training steps per second: 197.30
I0902 18:09:22.321185 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.50
INFO:tensorflow:Starting iteration 2

Steps executed: 279 Episode length: 279 Return: -278.0
INFO:tensorflow:Average training steps per second: 196.33
I0902 18:09:27.651714 140665773373440 replay_runner.py:36] Average training steps per second: 196.33
I0902 18:09:27.888498 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.00
INFO:tensorflow:Starting iteration 3

Steps executed: 259 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 195.15
I0902 18:09:33.249644 140665773373440 replay_runner.py:36] Average training steps per second: 195.15
I0902 18:09:33.467724 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 4

Steps executed: 270 Episode length: 166 Return: -165.0
INFO:tensorflow:Average training steps per second: 197.83
I0902 18:09:38.767807 140665773373440 replay_runner.py:36] Average training steps per second: 197.83
I0902 18:09:38.998501 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.35
I0902 18:09:44.269368 140665773373440 replay_runner.py:36] Average training steps per second: 198.35
I0902 18:09:44.673105 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 308 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 193.49
I0902 18:09:50.085525 140665773373440 replay_runner.py:36] Average training steps per second: 193.49
I0902 18:09:50.334144 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.00
INFO:tensorflow:Starting iteration 7
I0902 18:09:50.570985 140665773373440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 197.08

Steps executed: 390 Episode length: 390 Return: -389.0
I0902 18:09:55.978227 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.00
INFO:tensorflow:Starting iteration 8

Steps executed: 231 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 202.16
I0902 18:10:01.164229 140665773373440 replay_runner.py:36] Average training steps per second: 202.16
I0902 18:10:01.375600 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.83
I0902 18:10:06.780505 140665773373440 replay_runner.py:36] Average training steps per second: 193.83
I0902 18:10:07.175898 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 18:10:07.400080 140665773373440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 200.87
I0902 18:10:12.378825 140665773373440 replay_runner.py:36] Average training steps per second: 200.87
I0902 18:10:12.823414 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 18:10:13.051038 140665773373440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 198.93
I0902 18:10:18.078685 140665773373440 replay_runner.py:36] Average training steps per second: 198.93
I0902 18:10:18.477943 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 18:10:18.722733 140665773373440 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 196.35
I0902 18:10:23.816276 140665773373440 replay_runner.py:36] Average training steps per second: 196.35
I0902 18:10:24.233505 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 18:10:24.485401 140665773373440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.40

Steps executed: 231 Episode length: 68 Return: -67.0.0
I0902 18:10:29.724760 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.54
I0902 18:10:35.107111 140665773373440 replay_runner.py:36] Average training steps per second: 194.54
I0902 18:10:35.511960 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 18:10:35.759988 140665773373440 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 200.47
I0902 18:10:40.748664 140665773373440 replay_runner.py:36] Average training steps per second: 200.47
I0902 18:10:41.184923 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 575 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.08
I0902 18:10:46.411886 140665773373440 replay_runner.py:36] Average training steps per second: 201.08
I0902 18:10:46.874318 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.00
INFO:tensorflow:Starting iteration 17

Steps executed: 240 Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 196.52
I0902 18:10:52.195975 140665773373440 replay_runner.py:36] Average training steps per second: 196.52
I0902 18:10:52.381536 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 18
I0902 18:10:52.622858 140665773373440 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 202.86

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:10:57.950820 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 216 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 207.52
I0902 18:11:03.065075 140665773373440 replay_runner.py:36] Average training steps per second: 207.52
I0902 18:11:03.228538 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 20
I0902 18:11:03.454587 140665773373440 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 217.22

Steps executed: 606 Episode length: 500 Return: -500.0
I0902 18:11:08.520754 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 225.71
I0902 18:11:13.182415 140665773373440 replay_runner.py:36] Average training steps per second: 225.71
I0902 18:11:13.525875 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 18:11:13.749170 140665773373440 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 223.41
I0902 18:11:18.225503 140665773373440 replay_runner.py:36] Average training steps per second: 223.41
I0902 18:11:18.581615 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 249 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 234.14
I0902 18:11:23.068031 140665773373440 replay_runner.py:36] Average training steps per second: 234.14
I0902 18:11:23.246173 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 24

Steps executed: 290 Episode length: 218 Return: -217.0
INFO:tensorflow:Average training steps per second: 232.84
I0902 18:11:27.766137 140665773373440 replay_runner.py:36] Average training steps per second: 232.84
I0902 18:11:27.955471 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.00
INFO:tensorflow:Starting iteration 25

Steps executed: 287 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 231.25
I0902 18:11:32.494398 140665773373440 replay_runner.py:36] Average training steps per second: 231.25
I0902 18:11:32.694611 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 26

Steps executed: 230 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 244.08
I0902 18:11:37.011516 140665773373440 replay_runner.py:36] Average training steps per second: 244.08
I0902 18:11:37.162171 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 229.07
I0902 18:11:41.737228 140665773373440 replay_runner.py:36] Average training steps per second: 229.07
I0902 18:11:42.058335 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 208 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 250.28
I0902 18:11:46.262108 140665773373440 replay_runner.py:36] Average training steps per second: 250.28
I0902 18:11:46.404180 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 233 Return: -232.0
INFO:tensorflow:Average training steps per second: 238.88
I0902 18:11:50.801272 140665773373440 replay_runner.py:36] Average training steps per second: 238.88
I0902 18:11:51.037028 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00