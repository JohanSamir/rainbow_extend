I0902 18:17:32.689592 140182397114368 run_experiment.py:549] Creating TrainRunner ...
I0902 18:17:32.698847 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:32.698995 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:32.699071 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:32.699133 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:32.699190 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:32.699271 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:32.699324 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:32.699415 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:32.699484 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:32.699547 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:32.699622 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:32.699690 140182397114368 dqn_agent.py:283] 	 seed: 1630606652698809
I0902 18:17:32.701363 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:32.701478 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:32.701577 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:32.701642 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:32.701699 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:32.701781 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:32.701837 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:32.701930 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:32.702007 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:32.726453 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:32.991067 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:33.000829 140182397114368 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:17:33.007002 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:33.007203 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:33.007302 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:33.007385 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:33.007486 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:33.007566 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:33.007638 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:33.007754 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:33.007860 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:33.007995 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:33.008084 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:33.008172 140182397114368 dqn_agent.py:283] 	 seed: 1630606653006959
I0902 18:17:33.009986 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:33.010125 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:33.010198 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:33.010269 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:33.010327 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:33.010381 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:33.010441 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:33.010515 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:33.010572 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:33.030923 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:33.046366 140182397114368 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:17:33.046535 140182397114368 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 250.53
I0902 18:17:37.038270 140182397114368 replay_runner.py:36] Average training steps per second: 250.53
I0902 18:17:37.809806 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.00
Steps executed: 247 Episode length: 147 Return: -478.00526546130214
INFO:tensorflow:Starting iteration 1
I0902 18:17:41.088764 140182397114368 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 374.36
I0902 18:17:43.760341 140182397114368 replay_runner.py:36] Average training steps per second: 374.36

Steps executed: 276 Episode length: 152 Return: -336.48550983402793
INFO:tensorflow:Starting iteration 2
I0902 18:17:47.180280 140182397114368 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 349.20
I0902 18:17:50.044339 140182397114368 replay_runner.py:36] Average training steps per second: 349.20

Steps executed: 796 Episode length: 796 Return: -488.10034714908623
INFO:tensorflow:Starting iteration 3

Steps executed: 177 Episode length: 177 Return: -370.33777914736885
INFO:tensorflow:Average training steps per second: 339.46

Steps executed: 797 Episode length: 620 Return: -332.91346744359737
I0902 18:17:58.473983 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.63
INFO:tensorflow:Starting iteration 4
I0902 18:18:01.716163 140182397114368 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 348.77

Steps executed: 1000 Episode length: 1000 Return: -129.39402435406495
I0902 18:18:06.942244 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.39
INFO:tensorflow:Starting iteration 5
I0902 18:18:10.227276 140182397114368 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 331.26

Steps executed: 1000 Episode length: 1000 Return: -185.63033791383958
I0902 18:18:15.205948 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.63
INFO:tensorflow:Starting iteration 6
I0902 18:18:18.480185 140182397114368 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 320.31

Steps executed: 1000 Episode length: 1000 Return: -347.64106201341258
I0902 18:18:23.377905 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.64
INFO:tensorflow:Starting iteration 7
I0902 18:18:26.669822 140182397114368 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 323.85

Steps executed: 947 Episode length: 947 Return: -917.5923495563173258
I0902 18:18:31.066586 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -917.59
INFO:tensorflow:Starting iteration 8

Steps executed: 570 Episode length: 570 Return: -3061.929325297616258
INFO:tensorflow:Average training steps per second: 338.72
I0902 18:18:37.285311 140182397114368 replay_runner.py:36] Average training steps per second: 338.72
I0902 18:18:38.031694 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -3061.93
INFO:tensorflow:Starting iteration 9
I0902 18:18:41.230965 140182397114368 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 331.71

Steps executed: 549 Episode length: 549 Return: -739.0016178506323258
I0902 18:18:45.049115 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -739.00
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 216 Return: -826.1190945521923258
INFO:tensorflow:Average training steps per second: 332.51
I0902 18:18:51.284015 140182397114368 replay_runner.py:36] Average training steps per second: 332.51
I0902 18:18:51.453941 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -826.12
INFO:tensorflow:Starting iteration 11

Steps executed: 209 Episode length: 82 Return: -563.42192621913114258
INFO:tensorflow:Average training steps per second: 338.13
I0902 18:18:57.589948 140182397114368 replay_runner.py:36] Average training steps per second: 338.13
I0902 18:18:57.732190 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -599.47
INFO:tensorflow:Starting iteration 12

Steps executed: 524 Episode length: 524 Return: -507.0279544505317558
INFO:tensorflow:Average training steps per second: 353.63
I0902 18:19:03.902850 140182397114368 replay_runner.py:36] Average training steps per second: 353.63
I0902 18:19:04.516177 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.03
INFO:tensorflow:Starting iteration 13
I0902 18:19:07.906308 140182397114368 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 349.57

Steps executed: 595 Episode length: 595 Return: -367.7487766963829558
I0902 18:19:11.504646 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.75
INFO:tensorflow:Starting iteration 14

Steps executed: 212 Episode length: 212 Return: 14.508279289393139558
INFO:tensorflow:Average training steps per second: 344.38
I0902 18:19:17.772332 140182397114368 replay_runner.py:36] Average training steps per second: 344.38
I0902 18:19:17.896645 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.51
INFO:tensorflow:Starting iteration 15

Steps executed: 273 Episode length: 115 Return: -372.8164759283036558
INFO:tensorflow:Average training steps per second: 347.37
I0902 18:19:24.164559 140182397114368 replay_runner.py:36] Average training steps per second: 347.37
I0902 18:19:24.327283 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.44
INFO:tensorflow:Starting iteration 16

Steps executed: 231 Episode length: 231 Return: -535.8039562207375558
INFO:tensorflow:Average training steps per second: 345.45
I0902 18:19:30.628226 140182397114368 replay_runner.py:36] Average training steps per second: 345.45
I0902 18:19:30.790531 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.80
INFO:tensorflow:Starting iteration 17
I0902 18:19:34.204257 140182397114368 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 351.95

Steps executed: 343 Episode length: 177 Return: -223.3080637378625458
I0902 18:19:37.289214 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.36
INFO:tensorflow:Starting iteration 18

Steps executed: 235 Episode length: 87 Return: -127.50223027628695558
INFO:tensorflow:Average training steps per second: 360.80
I0902 18:19:43.508256 140182397114368 replay_runner.py:36] Average training steps per second: 360.80
I0902 18:19:43.633043 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.58
INFO:tensorflow:Starting iteration 19

Steps executed: 384 Episode length: 194 Return: -257.3490928887158658
INFO:tensorflow:Average training steps per second: 367.46
I0902 18:19:49.831024 140182397114368 replay_runner.py:36] Average training steps per second: 367.46
I0902 18:19:50.044795 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.88
INFO:tensorflow:Starting iteration 20

Steps executed: 316 Episode length: 316 Return: -309.0867527917763558
INFO:tensorflow:Average training steps per second: 346.55
I0902 18:19:56.348258 140182397114368 replay_runner.py:36] Average training steps per second: 346.55
I0902 18:19:56.603338 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.09
INFO:tensorflow:Starting iteration 21

Steps executed: 286 Episode length: 135 Return: -627.0102595865712558
INFO:tensorflow:Average training steps per second: 340.00
I0902 18:20:02.980429 140182397114368 replay_runner.py:36] Average training steps per second: 340.00
I0902 18:20:03.156397 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.26
INFO:tensorflow:Starting iteration 22

Steps executed: 268 Episode length: 166 Return: -469.1862286247038558
INFO:tensorflow:Average training steps per second: 340.47
I0902 18:20:09.467481 140182397114368 replay_runner.py:36] Average training steps per second: 340.47
I0902 18:20:09.629292 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -588.44
INFO:tensorflow:Starting iteration 23

Steps executed: 249 Episode length: 249 Return: -225.2229363101883558
INFO:tensorflow:Average training steps per second: 335.83
I0902 18:20:15.944216 140182397114368 replay_runner.py:36] Average training steps per second: 335.83
I0902 18:20:16.121014 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.22
INFO:tensorflow:Starting iteration 24

Steps executed: 152 Episode length: 152 Return: 59.014922302039083558
INFO:tensorflow:Average training steps per second: 337.26
I0902 18:20:22.462766 140182397114368 replay_runner.py:36] Average training steps per second: 337.26

Steps executed: 415 Episode length: 263 Return: -708.2729261993296558
INFO:tensorflow:Starting iteration 25

Steps executed: 367 Episode length: 367 Return: -33.53338466027958558
INFO:tensorflow:Average training steps per second: 336.98
I0902 18:20:29.144728 140182397114368 replay_runner.py:36] Average training steps per second: 336.98
I0902 18:20:29.515986 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.53
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 56 Return: -423.46629195409315558
INFO:tensorflow:Average training steps per second: 347.93
I0902 18:20:35.822994 140182397114368 replay_runner.py:36] Average training steps per second: 347.93
I0902 18:20:35.974874 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -591.20
INFO:tensorflow:Starting iteration 27

Steps executed: 204 Episode length: 67 Return: -61.880467541845374758
INFO:tensorflow:Average training steps per second: 356.22
I0902 18:20:42.242207 140182397114368 replay_runner.py:36] Average training steps per second: 356.22
I0902 18:20:42.361140 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.80
INFO:tensorflow:Starting iteration 28
I0902 18:20:45.837776 140182397114368 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 355.73
I0902 18:20:48.649122 140182397114368 replay_runner.py:36] Average training steps per second: 355.73

Steps executed: 248 Episode length: 70 Return: -199.08617439299792758
INFO:tensorflow:Starting iteration 29

Steps executed: 390 Episode length: 319 Return: -256.2666993496216758
INFO:tensorflow:Average training steps per second: 359.95
I0902 18:20:55.102968 140182397114368 replay_runner.py:36] Average training steps per second: 359.95

Done fixed training!Episode length: 319 Return: -256.2666993496216758