Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0902 11:24:10.629956 140639556196352 run_experiment.py:549] Creating TrainRunner ...
I0902 11:24:10.639521 140639556196352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:10.639764 140639556196352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:10.639867 140639556196352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:10.639976 140639556196352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:10.640146 140639556196352 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:10.640231 140639556196352 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:10.640305 140639556196352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:10.640424 140639556196352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:10.640512 140639556196352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:10.640616 140639556196352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:10.640721 140639556196352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:10.640802 140639556196352 dqn_agent.py:283] 	 seed: 1630581850639465
I0902 11:24:10.643033 140639556196352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:10.643194 140639556196352 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:24:10.643335 140639556196352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:10.643433 140639556196352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:10.643518 140639556196352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:10.643606 140639556196352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:10.643696 140639556196352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:10.643785 140639556196352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:10.643902 140639556196352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:10.790751 140639556196352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:11.237385 140639556196352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:11.249289 140639556196352 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:24:11.256301 140639556196352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:11.256503 140639556196352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:11.256598 140639556196352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:11.256722 140639556196352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:11.256883 140639556196352 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:11.256968 140639556196352 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:11.257050 140639556196352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:11.257146 140639556196352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:11.257239 140639556196352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:11.257317 140639556196352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:11.257492 140639556196352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:11.257613 140639556196352 dqn_agent.py:283] 	 seed: 1630581851256252
I0902 11:24:11.260937 140639556196352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:11.261139 140639556196352 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:24:11.261260 140639556196352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:11.261350 140639556196352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:11.261432 140639556196352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:11.261515 140639556196352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:11.261568 140639556196352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:11.261623 140639556196352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:11.261794 140639556196352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:11.306151 140639556196352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:11.333948 140639556196352 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:24:11.334326 140639556196352 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 127.88
I0902 11:24:19.154993 140639556196352 replay_runner.py:36] Average training steps per second: 127.88
I0902 11:24:20.479361 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.50
INFO:tensorflow:Starting iteration 1
I0902 11:24:20.727760 140639556196352 replay_runner.py:41] Starting iteration 1
Steps executed: 309 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 194.44
I0902 11:24:25.871198 140639556196352 replay_runner.py:36] Average training steps per second: 194.44
I0902 11:24:26.204832 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.00
INFO:tensorflow:Starting iteration 2

Steps executed: 392 Episode length: 209 Return: -208.0
INFO:tensorflow:Average training steps per second: 189.00
I0902 11:24:31.724957 140639556196352 replay_runner.py:36] Average training steps per second: 189.00
I0902 11:24:32.034891 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.00
INFO:tensorflow:Starting iteration 3

Steps executed: 360 Episode length: 163 Return: -162.0
INFO:tensorflow:Average training steps per second: 192.00
I0902 11:24:37.488770 140639556196352 replay_runner.py:36] Average training steps per second: 192.00
I0902 11:24:37.907686 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.87
I0902 11:24:43.344660 140639556196352 replay_runner.py:36] Average training steps per second: 192.87
I0902 11:24:43.760589 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 11:24:44.005760 140639556196352 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 193.13
I0902 11:24:49.184094 140639556196352 replay_runner.py:36] Average training steps per second: 193.13
I0902 11:24:49.416633 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.50
INFO:tensorflow:Starting iteration 6

Steps executed: 283 Episode length: 167 Return: -166.0
INFO:tensorflow:Average training steps per second: 189.14
I0902 11:24:54.942213 140639556196352 replay_runner.py:36] Average training steps per second: 189.14
I0902 11:24:55.156549 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 7

Steps executed: 234 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 189.43
I0902 11:25:00.728522 140639556196352 replay_runner.py:36] Average training steps per second: 189.43
I0902 11:25:00.976518 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 8


Steps executed: 250 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 189.23
I0902 11:25:06.491029 140639556196352 replay_runner.py:36] Average training steps per second: 189.23
I0902 11:25:06.697234 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 193.65
I0902 11:25:12.103726 140639556196352 replay_runner.py:36] Average training steps per second: 193.65
I0902 11:25:12.268878 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 10

Steps executed: 218 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 190.18
I0902 11:25:17.773299 140639556196352 replay_runner.py:36] Average training steps per second: 190.18
I0902 11:25:17.958062 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 11

Steps executed: 261 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 190.05
I0902 11:25:23.464449 140639556196352 replay_runner.py:36] Average training steps per second: 190.05
I0902 11:25:23.693853 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 12
I0902 11:25:23.942337 140639556196352 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 193.60
I0902 11:25:29.108437 140639556196352 replay_runner.py:36] Average training steps per second: 193.60
I0902 11:25:29.334037 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 13


Steps executed: 285 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 188.85
I0902 11:25:34.876136 140639556196352 replay_runner.py:36] Average training steps per second: 188.85
I0902 11:25:35.116484 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 14
I0902 11:25:35.367795 140639556196352 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 192.01
I0902 11:25:40.576327 140639556196352 replay_runner.py:36] Average training steps per second: 192.01
I0902 11:25:41.000560 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.88
I0902 11:25:46.465502 140639556196352 replay_runner.py:36] Average training steps per second: 191.88
I0902 11:25:46.896700 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 11:25:47.146775 140639556196352 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 191.56
I0902 11:25:52.367575 140639556196352 replay_runner.py:36] Average training steps per second: 191.56
I0902 11:25:52.793741 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 229 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 193.91
I0902 11:25:58.201254 140639556196352 replay_runner.py:36] Average training steps per second: 193.91
I0902 11:25:58.393565 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 18

Steps executed: 295 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 193.41
I0902 11:26:03.816490 140639556196352 replay_runner.py:36] Average training steps per second: 193.41
I0902 11:26:04.063865 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 19

Steps executed: 255 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 192.61
I0902 11:26:09.501765 140639556196352 replay_runner.py:36] Average training steps per second: 192.61
I0902 11:26:09.735262 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.07
I0902 11:26:15.174896 140639556196352 replay_runner.py:36] Average training steps per second: 192.07
I0902 11:26:15.587967 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 11:26:15.830487 140639556196352 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 188.66
I0902 11:26:21.131413 140639556196352 replay_runner.py:36] Average training steps per second: 188.66
I0902 11:26:21.552360 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 11:26:21.792001 140639556196352 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.99

Steps executed: 238 Episode length: 93 Return: -92.0.0
I0902 11:26:27.222306 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 23

Steps executed: 258 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 190.96
I0902 11:26:32.706232 140639556196352 replay_runner.py:36] Average training steps per second: 190.96
I0902 11:26:32.952422 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 24

Steps executed: 299 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 191.99
I0902 11:26:38.397469 140639556196352 replay_runner.py:36] Average training steps per second: 191.99
I0902 11:26:38.654957 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 25

Steps executed: 207 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 185.72
I0902 11:26:44.280732 140639556196352 replay_runner.py:36] Average training steps per second: 185.72
I0902 11:26:44.460687 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.50
INFO:tensorflow:Starting iteration 26

Steps executed: 349 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 192.54
I0902 11:26:49.900402 140639556196352 replay_runner.py:36] Average training steps per second: 192.54
I0902 11:26:50.196820 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.33
INFO:tensorflow:Starting iteration 27

Steps executed: 658 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.51
I0902 11:26:55.694561 140639556196352 replay_runner.py:36] Average training steps per second: 190.51
I0902 11:26:56.197003 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.67
INFO:tensorflow:Starting iteration 28

Steps executed: 71 Episode length: 71 Return: -70.00.0
INFO:tensorflow:Average training steps per second: 213.28
I0902 11:27:01.109722 140639556196352 replay_runner.py:36] Average training steps per second: 213.28

Steps executed: 288 Episode length: 101 Return: -100.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.55
I0902 11:27:06.510705 140639556196352 replay_runner.py:36] Average training steps per second: 202.55
I0902 11:27:07.006254 140639556196352 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.50