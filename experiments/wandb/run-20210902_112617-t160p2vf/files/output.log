Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 11:26:23.891785 140427886061568 run_experiment.py:549] Creating TrainRunner ...
I0902 11:26:23.904685 140427886061568 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:23.904981 140427886061568 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:23.905245 140427886061568 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:23.905416 140427886061568 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:23.905551 140427886061568 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:23.905697 140427886061568 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:23.905862 140427886061568 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:23.905997 140427886061568 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:23.906316 140427886061568 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:23.906536 140427886061568 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:23.906661 140427886061568 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:23.906769 140427886061568 dqn_agent.py:283] 	 seed: 1630581983904611
I0902 11:26:23.909075 140427886061568 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:23.909197 140427886061568 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:23.909332 140427886061568 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:23.909439 140427886061568 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:23.909512 140427886061568 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:23.909578 140427886061568 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:23.909655 140427886061568 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:23.909732 140427886061568 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:23.909809 140427886061568 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:24.083218 140427886061568 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.781656 140427886061568 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.797354 140427886061568 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:26:24.806824 140427886061568 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:24.807077 140427886061568 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:24.807244 140427886061568 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:24.807380 140427886061568 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:24.807507 140427886061568 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:24.807646 140427886061568 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:24.807854 140427886061568 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:24.807973 140427886061568 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:24.808064 140427886061568 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:24.808208 140427886061568 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:24.808316 140427886061568 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:24.808624 140427886061568 dqn_agent.py:283] 	 seed: 1630581984806768
I0902 11:26:24.811410 140427886061568 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:24.811608 140427886061568 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:24.811726 140427886061568 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:24.811843 140427886061568 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:24.812032 140427886061568 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:24.812164 140427886061568 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:24.812318 140427886061568 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:24.812452 140427886061568 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:24.812554 140427886061568 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:24.859895 140427886061568 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.892343 140427886061568 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:26:24.893012 140427886061568 replay_runner.py:41] Starting iteration 0
Steps executed: 161 Episode length: 161 Return: -288.9760364179324
INFO:tensorflow:Average training steps per second: 138.54
I0902 11:26:32.111625 140427886061568 replay_runner.py:36] Average training steps per second: 138.54

Steps executed: 251 Episode length: 90 Return: -245.11060362066195
INFO:tensorflow:Starting iteration 1
I0902 11:26:37.611414 140427886061568 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 217.39
I0902 11:26:42.211808 140427886061568 replay_runner.py:36] Average training steps per second: 217.39

Steps executed: 305 Episode length: 139 Return: -368.7164612318354
INFO:tensorflow:Starting iteration 2
I0902 11:26:46.705049 140427886061568 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 218.88
I0902 11:26:51.274580 140427886061568 replay_runner.py:36] Average training steps per second: 218.88

Steps executed: 250 Episode length: 250 Return: -390.42192566446863
INFO:tensorflow:Starting iteration 3
I0902 11:26:55.935530 140427886061568 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 242.41
I0902 11:27:00.061121 140427886061568 replay_runner.py:36] Average training steps per second: 242.41

Steps executed: 1000 Episode length: 1000 Return: -142.44205007961438
INFO:tensorflow:Starting iteration 4
I0902 11:27:07.812085 140427886061568 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 255.99

Steps executed: 1000 Episode length: 1000 Return: -246.34971925386745
I0902 11:27:14.314818 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.35
INFO:tensorflow:Starting iteration 5
I0902 11:27:18.388381 140427886061568 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 239.41

Steps executed: 1000 Episode length: 1000 Return: -335.01288646225065
I0902 11:27:24.910722 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.01
INFO:tensorflow:Starting iteration 6

Steps executed: 635 Episode length: 635 Return: -473.9445890557360665
INFO:tensorflow:Average training steps per second: 223.01
I0902 11:27:33.729863 140427886061568 replay_runner.py:36] Average training steps per second: 223.01
I0902 11:27:35.155469 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.94
INFO:tensorflow:Starting iteration 7

Steps executed: 676 Episode length: 676 Return: -2265.091858992405665
INFO:tensorflow:Average training steps per second: 212.91
I0902 11:27:44.173747 140427886061568 replay_runner.py:36] Average training steps per second: 212.91
I0902 11:27:45.481839 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -2265.09
INFO:tensorflow:Starting iteration 8
I0902 11:27:49.894638 140427886061568 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 227.95

Steps executed: 1000 Episode length: 1000 Return: -280.36728705266063
I0902 11:27:57.214509 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.37
INFO:tensorflow:Starting iteration 9
I0902 11:28:01.635683 140427886061568 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.11

Steps executed: 1000 Episode length: 1000 Return: -409.53870731470413
I0902 11:28:09.405866 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.54
INFO:tensorflow:Starting iteration 10
I0902 11:28:13.779637 140427886061568 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 220.79

Steps executed: 1000 Episode length: 1000 Return: -122.52013947060044
I0902 11:28:21.291025 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.52
INFO:tensorflow:Starting iteration 11
I0902 11:28:25.692480 140427886061568 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 213.51

Steps executed: 1000 Episode length: 1000 Return: -133.17397715947284
I0902 11:28:34.339447 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.17
INFO:tensorflow:Starting iteration 12
I0902 11:28:38.709021 140427886061568 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 211.65

Steps executed: 1000 Episode length: 1000 Return: -186.08443043690284
I0902 11:28:46.108162 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.08
INFO:tensorflow:Starting iteration 13
I0902 11:28:50.082969 140427886061568 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 216.35

Steps executed: 1000 Episode length: 1000 Return: -187.53920597522184
I0902 11:28:57.563429 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.54
INFO:tensorflow:Starting iteration 14
I0902 11:29:01.897925 140427886061568 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 218.42

Steps executed: 1000 Episode length: 1000 Return: -30.433696010335114
I0902 11:29:09.924079 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.43
INFO:tensorflow:Starting iteration 15
I0902 11:29:14.253767 140427886061568 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 212.28

Steps executed: 1000 Episode length: 1000 Return: -21.643391445532654
I0902 11:29:22.142489 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -21.64
INFO:tensorflow:Starting iteration 16

Steps executed: 238 Episode length: 238 Return: -76.52219094881845654
INFO:tensorflow:Average training steps per second: 209.72
I0902 11:29:31.164521 140427886061568 replay_runner.py:36] Average training steps per second: 209.72
I0902 11:29:31.421650 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.52
INFO:tensorflow:Starting iteration 17

Steps executed: 338 Episode length: 338 Return: -70.90156441469797654
INFO:tensorflow:Average training steps per second: 215.82
I0902 11:29:40.472455 140427886061568 replay_runner.py:36] Average training steps per second: 215.82
I0902 11:29:40.932326 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.90
INFO:tensorflow:Starting iteration 18

Steps executed: 321 Episode length: 165 Return: -110.3711382482537754
INFO:tensorflow:Average training steps per second: 217.71
I0902 11:29:49.829736 140427886061568 replay_runner.py:36] Average training steps per second: 217.71
I0902 11:29:50.141054 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.41
INFO:tensorflow:Starting iteration 19

Steps executed: 271 Episode length: 136 Return: -10.17433116735902854
INFO:tensorflow:Average training steps per second: 218.40
I0902 11:29:58.959824 140427886061568 replay_runner.py:36] Average training steps per second: 218.40
I0902 11:29:59.226873 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.57
INFO:tensorflow:Starting iteration 20
I0902 11:30:03.439249 140427886061568 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 236.28

Steps executed: 766 Episode length: 766 Return: -392.8461443723785854
I0902 11:30:09.429894 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.85
INFO:tensorflow:Starting iteration 21

Steps executed: 267 Episode length: 115 Return: -713.0885295280856854
INFO:tensorflow:Average training steps per second: 275.66
I0902 11:30:17.059484 140427886061568 replay_runner.py:36] Average training steps per second: 275.66
I0902 11:30:17.238510 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -593.49
INFO:tensorflow:Starting iteration 22
I0902 11:30:20.842354 140427886061568 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 320.34
I0902 11:30:23.964362 140427886061568 replay_runner.py:36] Average training steps per second: 320.34

Steps executed: 278 Episode length: 121 Return: -362.4793082674582454
INFO:tensorflow:Starting iteration 23

Steps executed: 253 Episode length: 66 Return: -95.002701229497461254
INFO:tensorflow:Average training steps per second: 337.70
I0902 11:30:30.549967 140427886061568 replay_runner.py:36] Average training steps per second: 337.70
I0902 11:30:30.671186 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.06
INFO:tensorflow:Starting iteration 24

Steps executed: 232 Episode length: 138 Return: -107.5570678254840154
INFO:tensorflow:Average training steps per second: 337.73
I0902 11:30:37.182962 140427886061568 replay_runner.py:36] Average training steps per second: 337.73
I0902 11:30:37.304837 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.87
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 130 Return: -128.7627509390571854
INFO:tensorflow:Average training steps per second: 344.84
I0902 11:30:43.690021 140427886061568 replay_runner.py:36] Average training steps per second: 344.84
I0902 11:30:43.819428 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.68
INFO:tensorflow:Starting iteration 26
I0902 11:30:47.279976 140427886061568 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 333.15
I0902 11:30:50.281958 140427886061568 replay_runner.py:36] Average training steps per second: 333.15

Steps executed: 230 Episode length: 78 Return: -94.557898712806531854
INFO:tensorflow:Starting iteration 27
I0902 11:30:53.733448 140427886061568 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 321.75

Steps executed: 1000 Episode length: 1000 Return: 46.9287202910123544
I0902 11:30:58.954342 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: 46.93
INFO:tensorflow:Starting iteration 28

Steps executed: 337 Episode length: 145 Return: -544.2537447862942544
INFO:tensorflow:Average training steps per second: 343.98
I0902 11:31:05.404197 140427886061568 replay_runner.py:36] Average training steps per second: 343.98
I0902 11:31:05.578165 140427886061568 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.95
INFO:tensorflow:Starting iteration 29

Steps executed: 83 Episode length: 83 Return: -189.113218279517942544
INFO:tensorflow:Average training steps per second: 367.73

Steps executed: 736 Episode length: 653 Return: -73.92983183759404544

Done fixed training!Episode length: 653 Return: -73.92983183759404544