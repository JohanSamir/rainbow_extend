I0902 00:38:18.716453 139752435963904 run_experiment.py:549] Creating TrainRunner ...
I0902 00:38:18.724384 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:18.724513 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:18.724596 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:18.724658 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:18.724713 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:18.724793 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:18.724890 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:18.724982 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:18.725054 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:18.725131 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:18.725228 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:18.725281 139752435963904 dqn_agent.py:283] 	 seed: 1630543098724337
I0902 00:38:18.726957 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:18.727118 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:18.727208 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:18.727279 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:18.727344 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:18.727423 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:18.727485 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:18.727586 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:18.727656 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:18.754345 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:19.007352 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:19.016422 139752435963904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:38:19.022413 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:19.022550 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:19.022638 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:19.022710 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:19.022826 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:19.022891 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:19.022969 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:19.023047 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:19.023112 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:19.023173 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:19.023239 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:19.023312 139752435963904 dqn_agent.py:283] 	 seed: 1630543099022387
I0902 00:38:19.024609 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:19.024717 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:19.024787 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:19.024878 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:19.024954 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:19.025037 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:19.025108 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:19.025185 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:19.025254 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:19.043906 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:19.057549 139752435963904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:38:19.057690 139752435963904 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
Steps executed: 292 Episode length: 107 Return: -143.62072161196738
INFO:tensorflow:Average training steps per second: 238.34
I0902 00:38:23.253541 139752435963904 replay_runner.py:36] Average training steps per second: 238.34
I0902 00:38:24.035661 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.40
INFO:tensorflow:Starting iteration 1

Steps executed: 115 Episode length: 115 Return: -183.05671858507278
INFO:tensorflow:Average training steps per second: 346.42
I0902 00:38:30.213133 139752435963904 replay_runner.py:36] Average training steps per second: 346.42

Steps executed: 213 Episode length: 98 Return: -286.473103645410338
INFO:tensorflow:Starting iteration 2
I0902 00:38:33.683571 139752435963904 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 348.00

Steps executed: 389 Episode length: 197 Return: -403.93575786097868
I0902 00:38:36.809283 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.66
INFO:tensorflow:Starting iteration 3
I0902 00:38:40.287145 139752435963904 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 355.08
I0902 00:38:43.103694 139752435963904 replay_runner.py:36] Average training steps per second: 355.08

Steps executed: 200 Episode length: 69 Return: -596.860842706579968
INFO:tensorflow:Starting iteration 4

Steps executed: 278 Episode length: 85 Return: -808.342258434161268
INFO:tensorflow:Average training steps per second: 351.89
I0902 00:38:49.537047 139752435963904 replay_runner.py:36] Average training steps per second: 351.89
I0902 00:38:49.703075 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -764.14
INFO:tensorflow:Starting iteration 5

Steps executed: 227 Episode length: 76 Return: -762.979527694103713
INFO:tensorflow:Average training steps per second: 354.48
I0902 00:38:56.003738 139752435963904 replay_runner.py:36] Average training steps per second: 354.48
I0902 00:38:56.147816 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -1157.34
INFO:tensorflow:Starting iteration 6
I0902 00:38:59.635210 139752435963904 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 346.34
I0902 00:39:02.522873 139752435963904 replay_runner.py:36] Average training steps per second: 346.34

Steps executed: 253 Episode length: 122 Return: -556.91216069529673
INFO:tensorflow:Starting iteration 7

Steps executed: 204 Episode length: 52 Return: -467.208311524893763
INFO:tensorflow:Average training steps per second: 350.84
I0902 00:39:09.026755 139752435963904 replay_runner.py:36] Average training steps per second: 350.84
I0902 00:39:09.139647 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -605.30
INFO:tensorflow:Starting iteration 8

Steps executed: 206 Episode length: 88 Return: -143.441425663032423
INFO:tensorflow:Average training steps per second: 350.60
I0902 00:39:15.456332 139752435963904 replay_runner.py:36] Average training steps per second: 350.60
I0902 00:39:15.570920 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.70
INFO:tensorflow:Starting iteration 9

Steps executed: 225 Episode length: 101 Return: -709.30346277413157
INFO:tensorflow:Average training steps per second: 344.43
I0902 00:39:21.936562 139752435963904 replay_runner.py:36] Average training steps per second: 344.43
I0902 00:39:22.071115 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -602.94
INFO:tensorflow:Starting iteration 10

Steps executed: 233 Episode length: 122 Return: -1012.1814696365586
INFO:tensorflow:Average training steps per second: 341.96
I0902 00:39:28.436703 139752435963904 replay_runner.py:36] Average training steps per second: 341.96
I0902 00:39:28.578770 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -822.64
INFO:tensorflow:Starting iteration 11

Steps executed: 249 Episode length: 64 Return: -529.889187497017986
INFO:tensorflow:Average training steps per second: 343.52
I0902 00:39:34.914022 139752435963904 replay_runner.py:36] Average training steps per second: 343.52
I0902 00:39:35.043475 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.67
INFO:tensorflow:Starting iteration 12

Steps executed: 281 Episode length: 167 Return: -1449.9097230610844
INFO:tensorflow:Average training steps per second: 343.34
I0902 00:39:41.408490 139752435963904 replay_runner.py:36] Average training steps per second: 343.34
I0902 00:39:41.575342 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -891.95
INFO:tensorflow:Starting iteration 13

Steps executed: 245 Episode length: 63 Return: -515.190286157205244
INFO:tensorflow:Average training steps per second: 341.74
I0902 00:39:47.929565 139752435963904 replay_runner.py:36] Average training steps per second: 341.74
I0902 00:39:48.083042 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -531.66
INFO:tensorflow:Starting iteration 14

Steps executed: 275 Episode length: 78 Return: -765.804615100541844
INFO:tensorflow:Average training steps per second: 340.13
I0902 00:39:54.432647 139752435963904 replay_runner.py:36] Average training steps per second: 340.13
I0902 00:39:54.585635 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -566.36
INFO:tensorflow:Starting iteration 15

Steps executed: 296 Episode length: 147 Return: -821.68410558454244
INFO:tensorflow:Average training steps per second: 333.56
I0902 00:40:00.985927 139752435963904 replay_runner.py:36] Average training steps per second: 333.56
I0902 00:40:01.173611 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -677.16
INFO:tensorflow:Starting iteration 16

Steps executed: 240 Episode length: 131 Return: -472.54590324915295
INFO:tensorflow:Average training steps per second: 331.87
I0902 00:40:07.597091 139752435963904 replay_runner.py:36] Average training steps per second: 331.87
I0902 00:40:07.759933 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.04
INFO:tensorflow:Starting iteration 17

Steps executed: 215 Episode length: 56 Return: -324.356655955959245
INFO:tensorflow:Average training steps per second: 332.82
I0902 00:40:14.184044 139752435963904 replay_runner.py:36] Average training steps per second: 332.82
I0902 00:40:14.310628 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.75
INFO:tensorflow:Starting iteration 18

Steps executed: 268 Episode length: 72 Return: -240.177205284113655
INFO:tensorflow:Average training steps per second: 335.76
I0902 00:40:20.702916 139752435963904 replay_runner.py:36] Average training steps per second: 335.76
I0902 00:40:20.833286 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.18
INFO:tensorflow:Starting iteration 19

Steps executed: 257 Episode length: 80 Return: -459.565650487435545
INFO:tensorflow:Average training steps per second: 333.43
I0902 00:40:27.233609 139752435963904 replay_runner.py:36] Average training steps per second: 333.43
I0902 00:40:27.355863 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.94
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 61 Return: -404.604002336594365
INFO:tensorflow:Average training steps per second: 327.20
I0902 00:40:33.823926 139752435963904 replay_runner.py:36] Average training steps per second: 327.20
I0902 00:40:33.957986 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.64
INFO:tensorflow:Starting iteration 21

Steps executed: 260 Episode length: 61 Return: -436.454725069211355
INFO:tensorflow:Average training steps per second: 330.02
I0902 00:40:40.370284 139752435963904 replay_runner.py:36] Average training steps per second: 330.02
I0902 00:40:40.506073 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -531.64
INFO:tensorflow:Starting iteration 22
I0902 00:40:43.886030 139752435963904 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 326.67
I0902 00:40:46.947528 139752435963904 replay_runner.py:36] Average training steps per second: 326.67

Steps executed: 217 Episode length: 82 Return: -874.306855243057355
INFO:tensorflow:Starting iteration 23

Steps executed: 205 Episode length: 79 Return: 8.320839329476044655
INFO:tensorflow:Average training steps per second: 332.13
I0902 00:40:53.459084 139752435963904 replay_runner.py:36] Average training steps per second: 332.13
I0902 00:40:53.560444 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.50
INFO:tensorflow:Starting iteration 24

Steps executed: 229 Episode length: 75 Return: -731.049366779459255
INFO:tensorflow:Average training steps per second: 329.20
I0902 00:40:59.944848 139752435963904 replay_runner.py:36] Average training steps per second: 329.20
I0902 00:41:00.070746 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -685.41
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 60 Return: -521.714257189130655
INFO:tensorflow:Average training steps per second: 328.06
I0902 00:41:06.415727 139752435963904 replay_runner.py:36] Average training steps per second: 328.06
I0902 00:41:06.549276 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -723.08
INFO:tensorflow:Starting iteration 26

Steps executed: 185 Episode length: 54 Return: -361.046836765847755
INFO:tensorflow:Average training steps per second: 330.46

Steps executed: 249 Episode length: 64 Return: -476.093894228195155
I0902 00:41:12.851707 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -469.14
INFO:tensorflow:Starting iteration 27

Steps executed: 211 Episode length: 69 Return: -660.488971721282355
INFO:tensorflow:Average training steps per second: 334.43
I0902 00:41:18.985978 139752435963904 replay_runner.py:36] Average training steps per second: 334.43
I0902 00:41:19.107850 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -672.43
INFO:tensorflow:Starting iteration 28

Steps executed: 282 Episode length: 83 Return: -753.826300133262175
INFO:tensorflow:Average training steps per second: 354.81
I0902 00:41:25.051404 139752435963904 replay_runner.py:36] Average training steps per second: 354.81
I0902 00:41:25.199657 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -793.82
INFO:tensorflow:Starting iteration 29

Steps executed: 201 Episode length: 51 Return: -450.645119117873575
INFO:tensorflow:Average training steps per second: 350.87
I0902 00:41:31.061982 139752435963904 replay_runner.py:36] Average training steps per second: 350.87

Done fixed training!Episode length: 51 Return: -450.645119117873575