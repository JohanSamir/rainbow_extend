I0905 16:21:33.404726 139967707396096 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.405241 139967707396096 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.491391 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.492763 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.492841 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.492912 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.492976 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.493030 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:33.493086 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.493139 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.493315 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.493383 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.493436 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.493487 139967707396096 dqn_agent.py:283] 	 seed: 1630858893491320
I0905 16:21:33.495459 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.495641 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:33.495753 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.495807 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.495903 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.495962 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.496016 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.496090 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.496211 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 16:21:35.089268 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.370219 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.503541 139967707396096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.508513 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.508646 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.508721 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.508780 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.508833 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.508896 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:35.508962 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.509031 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.509119 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.509191 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.509281 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.509350 139967707396096 dqn_agent.py:283] 	 seed: 1630858895508478
I0905 16:21:35.510761 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.510869 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:35.510947 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.511010 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.511068 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.511158 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.511249 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.511303 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.511370 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.528553 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.538913 139967707396096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.539072 139967707396096 replay_runner.py:41] Starting iteration 0
Steps executed: 224 Episode length: 125 Return: -159.30623149916215
INFO:tensorflow:Average training steps per second: 294.44
I0905 16:21:38.935538 139967707396096 replay_runner.py:36] Average training steps per second: 294.44
I0905 16:21:39.559388 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.25
INFO:tensorflow:Starting iteration 1

Steps executed: 289 Episode length: 97 Return: -215.647564678193365
INFO:tensorflow:Average training steps per second: 415.19
I0905 16:21:45.053019 139967707396096 replay_runner.py:36] Average training steps per second: 415.19
I0905 16:21:45.184866 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.52
INFO:tensorflow:Starting iteration 2

Steps executed: 211 Episode length: 129 Return: -294.40027576537525
INFO:tensorflow:Average training steps per second: 407.09
I0905 16:21:50.720328 139967707396096 replay_runner.py:36] Average training steps per second: 407.09
I0905 16:21:50.811026 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.06
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 123 Return: -255.20680940572925
INFO:tensorflow:Average training steps per second: 416.23
I0905 16:21:56.311553 139967707396096 replay_runner.py:36] Average training steps per second: 416.23
I0905 16:21:56.394743 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.10
INFO:tensorflow:Starting iteration 4

Steps executed: 234 Episode length: 124 Return: -29.916446023803417
INFO:tensorflow:Average training steps per second: 416.45
I0905 16:22:01.889224 139967707396096 replay_runner.py:36] Average training steps per second: 416.45
I0905 16:22:01.988504 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.63
INFO:tensorflow:Starting iteration 5

Steps executed: 272 Episode length: 115 Return: -250.17233587994346
INFO:tensorflow:Average training steps per second: 410.69
I0905 16:22:07.492534 139967707396096 replay_runner.py:36] Average training steps per second: 410.69
I0905 16:22:07.593959 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.67
INFO:tensorflow:Starting iteration 6

Steps executed: 210 Episode length: 120 Return: -171.51936714993357
INFO:tensorflow:Average training steps per second: 425.00
I0905 16:22:13.021825 139967707396096 replay_runner.py:36] Average training steps per second: 425.00
I0905 16:22:13.108694 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.59
INFO:tensorflow:Starting iteration 7

Steps executed: 209 Episode length: 68 Return: -288.096439855131357
INFO:tensorflow:Average training steps per second: 422.61
I0905 16:22:18.551925 139967707396096 replay_runner.py:36] Average training steps per second: 422.61
I0905 16:22:18.619350 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.85
INFO:tensorflow:Starting iteration 8

Steps executed: 237 Episode length: 123 Return: -173.33246648754988
INFO:tensorflow:Average training steps per second: 416.01
I0905 16:22:24.105210 139967707396096 replay_runner.py:36] Average training steps per second: 416.01
I0905 16:22:24.214277 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.70
INFO:tensorflow:Starting iteration 9

Steps executed: 226 Episode length: 138 Return: -269.07957349465073
INFO:tensorflow:Average training steps per second: 420.25
I0905 16:22:29.682619 139967707396096 replay_runner.py:36] Average training steps per second: 420.25
I0905 16:22:29.764492 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.61
INFO:tensorflow:Starting iteration 10

Steps executed: 389 Episode length: 281 Return: -269.48619352867206
INFO:tensorflow:Average training steps per second: 413.61
I0905 16:22:35.262866 139967707396096 replay_runner.py:36] Average training steps per second: 413.61
I0905 16:22:35.478485 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.48
INFO:tensorflow:Starting iteration 11

Steps executed: 220 Episode length: 52 Return: -175.759909090892546
INFO:tensorflow:Average training steps per second: 414.73
I0905 16:22:40.977844 139967707396096 replay_runner.py:36] Average training steps per second: 414.73
I0905 16:22:41.044472 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.26
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 62 Return: -182.415375637877623
INFO:tensorflow:Average training steps per second: 417.81
I0905 16:22:46.523003 139967707396096 replay_runner.py:36] Average training steps per second: 417.81
I0905 16:22:46.605411 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.53
INFO:tensorflow:Starting iteration 13

Steps executed: 363 Episode length: 363 Return: -261.40393564116766
INFO:tensorflow:Average training steps per second: 414.70
I0905 16:22:52.103389 139967707396096 replay_runner.py:36] Average training steps per second: 414.70
I0905 16:22:52.402835 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.40
INFO:tensorflow:Starting iteration 14

Steps executed: 273 Episode length: 174 Return: -323.61270518359896
INFO:tensorflow:Average training steps per second: 420.25
I0905 16:22:57.855767 139967707396096 replay_runner.py:36] Average training steps per second: 420.25
I0905 16:22:57.975709 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.09
INFO:tensorflow:Starting iteration 15

Steps executed: 443 Episode length: 356 Return: -242.17460694828986
INFO:tensorflow:Average training steps per second: 418.80
I0905 16:23:03.447947 139967707396096 replay_runner.py:36] Average training steps per second: 418.80
I0905 16:23:03.766390 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.38
INFO:tensorflow:Starting iteration 16

Steps executed: 224 Episode length: 58 Return: -67.3984822349004626
INFO:tensorflow:Average training steps per second: 445.27
I0905 16:23:09.065814 139967707396096 replay_runner.py:36] Average training steps per second: 445.27
I0905 16:23:09.135361 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.89
INFO:tensorflow:Starting iteration 17

Steps executed: 242 Episode length: 100 Return: -223.33680254167155
INFO:tensorflow:Average training steps per second: 321.52
I0905 16:23:15.171530 139967707396096 replay_runner.py:36] Average training steps per second: 321.52
I0905 16:23:15.340848 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.42
INFO:tensorflow:Starting iteration 18
I0905 16:23:18.925895 139967707396096 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 416.19

Steps executed: 1000 Episode length: 1000 Return: -44.34989033145693
I0905 16:23:23.018175 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.35
INFO:tensorflow:Starting iteration 19

Steps executed: 728 Episode length: 728 Return: -443.627533291712593
INFO:tensorflow:Average training steps per second: 421.39
I0905 16:23:28.457088 139967707396096 replay_runner.py:36] Average training steps per second: 421.39
I0905 16:23:29.011485 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.63
INFO:tensorflow:Starting iteration 20

Steps executed: 637 Episode length: 637 Return: -291.278863977827993
INFO:tensorflow:Average training steps per second: 419.87
I0905 16:23:34.480767 139967707396096 replay_runner.py:36] Average training steps per second: 419.87
I0905 16:23:35.335477 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.28
INFO:tensorflow:Starting iteration 21

Steps executed: 132 Episode length: 61 Return: -92.31433945346633993
INFO:tensorflow:Average training steps per second: 413.63

Steps executed: 1027 Episode length: 895 Return: -364.22301648786083
I0905 16:23:42.103245 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.75
INFO:tensorflow:Starting iteration 22

Steps executed: 289 Episode length: 198 Return: -295.052135676599733
INFO:tensorflow:Average training steps per second: 413.84
I0905 16:23:47.773605 139967707396096 replay_runner.py:36] Average training steps per second: 413.84
I0905 16:23:47.899410 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.15
INFO:tensorflow:Starting iteration 23

Steps executed: 281 Episode length: 281 Return: -260.429273992905563
INFO:tensorflow:Average training steps per second: 417.39
I0905 16:23:53.390454 139967707396096 replay_runner.py:36] Average training steps per second: 417.39
I0905 16:23:53.566861 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.43
INFO:tensorflow:Starting iteration 24

Steps executed: 257 Episode length: 93 Return: -39.59526076616083463
INFO:tensorflow:Average training steps per second: 420.23
I0905 16:23:59.038182 139967707396096 replay_runner.py:36] Average training steps per second: 420.23
I0905 16:23:59.139170 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -25.86
INFO:tensorflow:Starting iteration 25

Steps executed: 359 Episode length: 359 Return: -248.041949005054053
INFO:tensorflow:Average training steps per second: 418.94
I0905 16:24:04.612493 139967707396096 replay_runner.py:36] Average training steps per second: 418.94
I0905 16:24:04.861264 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.04
INFO:tensorflow:Starting iteration 26

Steps executed: 323 Episode length: 323 Return: -329.409593266573673
INFO:tensorflow:Average training steps per second: 414.66
I0905 16:24:10.366806 139967707396096 replay_runner.py:36] Average training steps per second: 414.66
I0905 16:24:10.650706 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.41
INFO:tensorflow:Starting iteration 27

Steps executed: 269 Episode length: 101 Return: -0.42852131885443613
INFO:tensorflow:Average training steps per second: 413.68
I0905 16:24:16.163359 139967707396096 replay_runner.py:36] Average training steps per second: 413.68
I0905 16:24:16.279826 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -16.33
INFO:tensorflow:Starting iteration 28

Steps executed: 215 Episode length: 111 Return: -744.732738835942113
INFO:tensorflow:Average training steps per second: 405.43
I0905 16:24:21.839485 139967707396096 replay_runner.py:36] Average training steps per second: 405.43
I0905 16:24:21.930894 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -682.16
INFO:tensorflow:Starting iteration 29
I0905 16:24:25.018768 139967707396096 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 407.40

Steps executed: 243 Episode length: 109 Return: -148.767232015503253

Done fixed training!Episode length: 109 Return: -148.767232015503253