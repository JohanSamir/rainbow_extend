Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 11:24:06.427222 139657297655808 run_experiment.py:549] Creating TrainRunner ...
I0902 11:24:06.439598 139657297655808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:06.439795 139657297655808 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:06.439882 139657297655808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:06.439950 139657297655808 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:06.440013 139657297655808 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:06.440108 139657297655808 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:06.440204 139657297655808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:06.440330 139657297655808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:06.440415 139657297655808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:06.440492 139657297655808 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:06.440576 139657297655808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:06.440636 139657297655808 dqn_agent.py:283] 	 seed: 1630581846439553
I0902 11:24:06.443912 139657297655808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:06.444146 139657297655808 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:06.444293 139657297655808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:06.444389 139657297655808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:06.444468 139657297655808 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:06.444587 139657297655808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:06.444644 139657297655808 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:06.444734 139657297655808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:06.444809 139657297655808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:06.595300 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.143555 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.157471 139657297655808 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:24:07.166177 139657297655808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:07.166373 139657297655808 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:07.166566 139657297655808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:07.166730 139657297655808 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:07.166823 139657297655808 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:07.166915 139657297655808 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:07.166997 139657297655808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:07.167081 139657297655808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:07.167154 139657297655808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:07.167224 139657297655808 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:07.167316 139657297655808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:07.167506 139657297655808 dqn_agent.py:283] 	 seed: 1630581847166096
I0902 11:24:07.170035 139657297655808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:07.170284 139657297655808 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:07.170423 139657297655808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:07.170547 139657297655808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:07.170732 139657297655808 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:07.170831 139657297655808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:07.170939 139657297655808 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:07.171034 139657297655808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:07.171117 139657297655808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:07.209999 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.239434 139657297655808 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:24:07.239658 139657297655808 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 131.60
I0902 11:24:14.838699 139657297655808 replay_runner.py:36] Average training steps per second: 131.60
I0902 11:24:15.967603 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Starting iteration 1
I0902 11:24:16.159301 139657297655808 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 191.82
I0902 11:24:21.373033 139657297655808 replay_runner.py:36] Average training steps per second: 191.82
I0902 11:24:21.544448 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.33
INFO:tensorflow:Starting iteration 2


Steps executed: 312 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 196.18
I0902 11:24:26.838509 139657297655808 replay_runner.py:36] Average training steps per second: 196.18
I0902 11:24:27.050164 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 3

Steps executed: 337 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 190.20
I0902 11:24:32.512172 139657297655808 replay_runner.py:36] Average training steps per second: 190.20
I0902 11:24:32.734746 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.50
INFO:tensorflow:Starting iteration 4

Steps executed: 147 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 190.69

Steps executed: 308 Episode length: 161 Return: 161.0
I0902 11:24:38.375229 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 5
I0902 11:24:38.556105 139657297655808 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 190.30
I0902 11:24:43.811443 139657297655808 replay_runner.py:36] Average training steps per second: 190.30
I0902 11:24:43.952960 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6


Steps executed: 368 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 190.50
I0902 11:24:49.386337 139657297655808 replay_runner.py:36] Average training steps per second: 190.50
I0902 11:24:49.626021 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 7
I0902 11:24:49.820713 139657297655808 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 187.98
I0902 11:24:55.140981 139657297655808 replay_runner.py:36] Average training steps per second: 187.98
I0902 11:24:55.349654 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 8

Steps executed: 292 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 192.51
I0902 11:25:00.741105 139657297655808 replay_runner.py:36] Average training steps per second: 192.51
I0902 11:25:00.939856 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 9

Steps executed: 295 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 192.52
I0902 11:25:06.329236 139657297655808 replay_runner.py:36] Average training steps per second: 192.52

Steps executed: 261 Episode length: 127 Return: 127.0
INFO:tensorflow:Starting iteration 10
I0902 11:25:06.695212 139657297655808 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.89
I0902 11:25:11.853221 139657297655808 replay_runner.py:36] Average training steps per second: 193.89
I0902 11:25:12.053327 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 11


Steps executed: 308 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 190.95
I0902 11:25:17.479354 139657297655808 replay_runner.py:36] Average training steps per second: 190.95
I0902 11:25:17.679702 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 12

Steps executed: 270 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 190.69
I0902 11:25:23.116938 139657297655808 replay_runner.py:36] Average training steps per second: 190.69
I0902 11:25:23.314635 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 13

Steps executed: 366 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 192.75
I0902 11:25:28.696753 139657297655808 replay_runner.py:36] Average training steps per second: 192.75
I0902 11:25:28.943210 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.27
I0902 11:25:34.368026 139657297655808 replay_runner.py:36] Average training steps per second: 191.27
I0902 11:25:34.510407 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0902 11:25:34.697630 139657297655808 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.87
I0902 11:25:39.856398 139657297655808 replay_runner.py:36] Average training steps per second: 193.87
I0902 11:25:39.996204 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 11:25:40.178390 139657297655808 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.10
I0902 11:25:45.304771 139657297655808 replay_runner.py:36] Average training steps per second: 195.10
I0902 11:25:45.550891 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.50
INFO:tensorflow:Starting iteration 17


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.31
I0902 11:25:50.941484 139657297655808 replay_runner.py:36] Average training steps per second: 192.31
I0902 11:25:51.086441 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 11:25:51.428579 139657297655808 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.73
I0902 11:25:56.590937 139657297655808 replay_runner.py:36] Average training steps per second: 193.73
I0902 11:25:56.730458 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 11:25:56.925947 139657297655808 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.87
I0902 11:26:02.031872 139657297655808 replay_runner.py:36] Average training steps per second: 195.87
I0902 11:26:02.164467 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 11:26:02.361004 139657297655808 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.08
I0902 11:26:07.513901 139657297655808 replay_runner.py:36] Average training steps per second: 194.08
I0902 11:26:07.645978 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 11:26:07.837510 139657297655808 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.56
I0902 11:26:12.925540 139657297655808 replay_runner.py:36] Average training steps per second: 196.56
I0902 11:26:13.056074 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 151 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 188.57
I0902 11:26:18.549177 139657297655808 replay_runner.py:36] Average training steps per second: 188.57

Steps executed: 297 Episode length: 146 Return: 146.0
INFO:tensorflow:Starting iteration 23

Steps executed: 334 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 195.95
I0902 11:26:24.053277 139657297655808 replay_runner.py:36] Average training steps per second: 195.95
I0902 11:26:24.277017 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.98
I0902 11:26:29.583926 139657297655808 replay_runner.py:36] Average training steps per second: 194.98
I0902 11:26:29.752791 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 11:26:29.957387 139657297655808 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 189.50
I0902 11:26:35.234935 139657297655808 replay_runner.py:36] Average training steps per second: 189.50
I0902 11:26:35.373203 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 11:26:35.548257 139657297655808 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 191.12
I0902 11:26:40.781008 139657297655808 replay_runner.py:36] Average training steps per second: 191.12
I0902 11:26:40.922472 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 395 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.37
I0902 11:26:46.410326 139657297655808 replay_runner.py:36] Average training steps per second: 189.37
I0902 11:26:46.671032 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.11
I0902 11:26:52.066018 139657297655808 replay_runner.py:36] Average training steps per second: 192.11
I0902 11:26:52.216105 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 199.52
I0902 11:26:57.429414 139657297655808 replay_runner.py:36] Average training steps per second: 199.52
I0902 11:26:57.612838 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.50