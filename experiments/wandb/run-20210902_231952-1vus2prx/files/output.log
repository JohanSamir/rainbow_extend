Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0902 23:19:59.429352 140369919707136 run_experiment.py:549] Creating TrainRunner ...
I0902 23:19:59.439411 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:59.439671 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:59.440071 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:59.440266 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:59.440488 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:59.440577 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:19:59.440746 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:59.440873 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:59.440965 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:59.441033 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:59.441227 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:59.441472 140369919707136 dqn_agent.py:283] 	 seed: 1630624799439353
I0902 23:19:59.445127 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:59.445344 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:19:59.445526 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:59.445780 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:59.445930 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:59.446023 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:59.446123 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:59.446380 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:59.446517 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:19:59.478435 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:59.830406 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:59.846031 140369919707136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:19:59.854477 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:59.854697 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:59.854800 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:59.854895 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:59.855048 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:59.855133 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:19:59.855213 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:59.855431 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:59.855557 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:59.855654 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:59.855756 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:59.855843 140369919707136 dqn_agent.py:283] 	 seed: 1630624799854424
I0902 23:19:59.858195 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:59.858404 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:19:59.858510 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:59.858644 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:59.858733 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:59.858814 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:59.858960 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:59.859037 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:59.859120 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:19:59.882708 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:59.903454 140369919707136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:19:59.903713 140369919707136 replay_runner.py:41] Starting iteration 0
Steps executed: 61 Episode length: 61 Return: -586.3031550043032
INFO:tensorflow:Average training steps per second: 165.05

Steps executed: 275 Episode length: 85 Return: -790.1174366584319
I0902 23:20:07.171281 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -602.19
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 63 Return: -603.7857424405047
INFO:tensorflow:Average training steps per second: 220.06
I0902 23:20:16.024676 140369919707136 replay_runner.py:36] Average training steps per second: 220.06
I0902 23:20:16.207829 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -653.74
INFO:tensorflow:Starting iteration 2
I0902 23:20:20.485650 140369919707136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 217.00

Steps executed: 223 Episode length: 83 Return: -872.3065748561245
I0902 23:20:25.307363 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -729.21
INFO:tensorflow:Starting iteration 3

Steps executed: 212 Episode length: 93 Return: -369.50607003490967
INFO:tensorflow:Average training steps per second: 217.16
I0902 23:20:34.180520 140369919707136 replay_runner.py:36] Average training steps per second: 217.16
I0902 23:20:34.373752 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.21
INFO:tensorflow:Starting iteration 4

Steps executed: 210 Episode length: 75 Return: -798.55466723048737
INFO:tensorflow:Average training steps per second: 215.52
I0902 23:20:43.363361 140369919707136 replay_runner.py:36] Average training steps per second: 215.52
I0902 23:20:43.554575 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -747.75
INFO:tensorflow:Starting iteration 5

Steps executed: 270 Episode length: 78 Return: -729.02626586054927
INFO:tensorflow:Average training steps per second: 216.72
I0902 23:20:52.290006 140369919707136 replay_runner.py:36] Average training steps per second: 216.72
I0902 23:20:52.531381 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -591.49
INFO:tensorflow:Starting iteration 6

Steps executed: 276 Episode length: 84 Return: -857.43829286938517
INFO:tensorflow:Average training steps per second: 214.30
I0902 23:21:01.456497 140369919707136 replay_runner.py:36] Average training steps per second: 214.30
I0902 23:21:01.707178 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -629.03
INFO:tensorflow:Starting iteration 7

Steps executed: 221 Episode length: 126 Return: -785.8127195207247
INFO:tensorflow:Average training steps per second: 216.53
I0902 23:21:10.504463 140369919707136 replay_runner.py:36] Average training steps per second: 216.53
I0902 23:21:10.722064 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -750.20
INFO:tensorflow:Starting iteration 8

Steps executed: 347 Episode length: 169 Return: -1030.4420601411036
INFO:tensorflow:Average training steps per second: 215.07
I0902 23:21:19.646493 140369919707136 replay_runner.py:36] Average training steps per second: 215.07
I0902 23:21:20.014087 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -712.34
INFO:tensorflow:Starting iteration 9
I0902 23:21:24.420477 140369919707136 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 212.56
I0902 23:21:29.125661 140369919707136 replay_runner.py:36] Average training steps per second: 212.56

Steps executed: 255 Episode length: 255 Return: -2385.7327316362236
INFO:tensorflow:Starting iteration 10

Steps executed: 267 Episode length: 267 Return: -1953.8929290917192
INFO:tensorflow:Average training steps per second: 214.93
I0902 23:21:38.188550 140369919707136 replay_runner.py:36] Average training steps per second: 214.93
I0902 23:21:38.590943 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -1953.89
INFO:tensorflow:Starting iteration 11

Steps executed: 277 Episode length: 126 Return: -571.62090221129762
INFO:tensorflow:Average training steps per second: 228.76
I0902 23:21:47.145964 140369919707136 replay_runner.py:36] Average training steps per second: 228.76
I0902 23:21:47.397047 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -839.16
INFO:tensorflow:Starting iteration 12

Steps executed: 240 Episode length: 130 Return: -901.83811445603492
INFO:tensorflow:Average training steps per second: 227.80
I0902 23:21:55.928532 140369919707136 replay_runner.py:36] Average training steps per second: 227.80
I0902 23:21:56.160063 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -776.25
INFO:tensorflow:Starting iteration 13

Steps executed: 242 Episode length: 80 Return: -547.866228285747992
INFO:tensorflow:Average training steps per second: 233.70
I0902 23:22:04.598766 140369919707136 replay_runner.py:36] Average training steps per second: 233.70
I0902 23:22:04.837946 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -577.98
INFO:tensorflow:Starting iteration 14

Steps executed: 77 Episode length: 77 Return: -433.1189899072345992
INFO:tensorflow:Average training steps per second: 229.09

Steps executed: 345 Episode length: 268 Return: -2510.0419222313744
I0902 23:22:13.790925 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -1471.58
INFO:tensorflow:Starting iteration 15

Steps executed: 309 Episode length: 145 Return: -917.43515057964055
INFO:tensorflow:Average training steps per second: 228.18
I0902 23:22:22.288087 140369919707136 replay_runner.py:36] Average training steps per second: 228.18
I0902 23:22:22.600409 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -1014.25
INFO:tensorflow:Starting iteration 16

Steps executed: 265 Episode length: 178 Return: -1127.7836565916646
INFO:tensorflow:Average training steps per second: 221.74
I0902 23:22:31.299073 140369919707136 replay_runner.py:36] Average training steps per second: 221.74
I0902 23:22:31.569733 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -858.69
INFO:tensorflow:Starting iteration 17

Steps executed: 229 Episode length: 115 Return: -676.22159863450026
INFO:tensorflow:Average training steps per second: 219.43
I0902 23:22:40.400302 140369919707136 replay_runner.py:36] Average training steps per second: 219.43
I0902 23:22:40.635807 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -743.07
INFO:tensorflow:Starting iteration 18

Steps executed: 114 Episode length: 114 Return: -607.39679825423176
INFO:tensorflow:Average training steps per second: 218.71
I0902 23:22:49.184539 140369919707136 replay_runner.py:36] Average training steps per second: 218.71

Steps executed: 206 Episode length: 92 Return: -399.138083351493976
INFO:tensorflow:Starting iteration 19

Steps executed: 247 Episode length: 107 Return: -638.66363944997666
INFO:tensorflow:Average training steps per second: 218.27
I0902 23:22:58.277091 140369919707136 replay_runner.py:36] Average training steps per second: 218.27
I0902 23:22:58.527768 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -717.73
INFO:tensorflow:Starting iteration 20
I0902 23:23:02.787221 140369919707136 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 217.49
I0902 23:23:07.386001 140369919707136 replay_runner.py:36] Average training steps per second: 217.49

Steps executed: 336 Episode length: 150 Return: -920.13802966353556
INFO:tensorflow:Starting iteration 21

Steps executed: 320 Episode length: 165 Return: -1012.7384930346791
INFO:tensorflow:Average training steps per second: 219.04
I0902 23:23:16.379044 140369919707136 replay_runner.py:36] Average training steps per second: 219.04
I0902 23:23:16.710839 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.16
INFO:tensorflow:Starting iteration 22
I0902 23:23:20.941824 140369919707136 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 215.08

Steps executed: 345 Episode length: 154 Return: -1082.7805427538542
I0902 23:23:25.956477 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -792.24
INFO:tensorflow:Starting iteration 23

Steps executed: 223 Episode length: 88 Return: -601.886693852020524
INFO:tensorflow:Average training steps per second: 216.34
I0902 23:23:34.746938 140369919707136 replay_runner.py:36] Average training steps per second: 216.34
I0902 23:23:34.983496 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -810.77
INFO:tensorflow:Starting iteration 24

Steps executed: 207 Episode length: 118 Return: -888.81405652860714
INFO:tensorflow:Average training steps per second: 214.24
I0902 23:23:43.881935 140369919707136 replay_runner.py:36] Average training steps per second: 214.24
I0902 23:23:44.095818 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -713.43
INFO:tensorflow:Starting iteration 25

Steps executed: 260 Episode length: 186 Return: -1176.3327049488114
INFO:tensorflow:Average training steps per second: 216.96
I0902 23:23:52.983125 140369919707136 replay_runner.py:36] Average training steps per second: 216.96
I0902 23:23:53.285078 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -757.61
INFO:tensorflow:Starting iteration 26

Steps executed: 273 Episode length: 93 Return: -557.342969851470664
INFO:tensorflow:Average training steps per second: 216.42
I0902 23:24:02.166828 140369919707136 replay_runner.py:36] Average training steps per second: 216.42
I0902 23:24:02.446512 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.98
INFO:tensorflow:Starting iteration 27

Steps executed: 332 Episode length: 256 Return: -2336.0224068061398
INFO:tensorflow:Average training steps per second: 219.01
I0902 23:24:11.268627 140369919707136 replay_runner.py:36] Average training steps per second: 219.01
I0902 23:24:11.686030 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -1369.13
INFO:tensorflow:Starting iteration 28

Steps executed: 284 Episode length: 88 Return: -366.761539227602358
INFO:tensorflow:Average training steps per second: 219.58
I0902 23:24:20.492598 140369919707136 replay_runner.py:36] Average training steps per second: 219.58
I0902 23:24:20.782196 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.99
INFO:tensorflow:Starting iteration 29

Steps executed: 113 Episode length: 113 Return: -528.40752890617828
INFO:tensorflow:Average training steps per second: 220.47

Steps executed: 237 Episode length: 124 Return: -776.79967540298388

Done fixed training!Episode length: 124 Return: -776.79967540298388