Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 18:14:06.846862 140284730537984 run_experiment.py:549] Creating TrainRunner ...
I0902 18:14:06.855060 140284730537984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:06.855204 140284730537984 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:06.855336 140284730537984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:06.855437 140284730537984 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:06.855503 140284730537984 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:06.855573 140284730537984 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:06.855680 140284730537984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:06.855742 140284730537984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:06.855809 140284730537984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:06.855867 140284730537984 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:06.855933 140284730537984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:06.855992 140284730537984 dqn_agent.py:283] 	 seed: 1630606446855023
I0902 18:14:06.858273 140284730537984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:06.858389 140284730537984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:06.858470 140284730537984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:06.858539 140284730537984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:06.858597 140284730537984 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:06.858673 140284730537984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:06.858782 140284730537984 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:06.858856 140284730537984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:06.858920 140284730537984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:06.883851 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:07.154603 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:07.166008 140284730537984 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:14:07.173755 140284730537984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:07.173901 140284730537984 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:07.173979 140284730537984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:07.174048 140284730537984 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:07.174105 140284730537984 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:07.174160 140284730537984 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:07.174242 140284730537984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:07.174328 140284730537984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:07.174387 140284730537984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:07.174453 140284730537984 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:07.174533 140284730537984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:07.174603 140284730537984 dqn_agent.py:283] 	 seed: 1630606447173721
I0902 18:14:07.175959 140284730537984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:07.176068 140284730537984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:07.176138 140284730537984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:07.176200 140284730537984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:07.176256 140284730537984 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:07.176337 140284730537984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:07.176394 140284730537984 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:07.176466 140284730537984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:07.176547 140284730537984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:07.198552 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:07.213394 140284730537984 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:14:07.213582 140284730537984 replay_runner.py:41] Starting iteration 0
Steps executed: 401 Episode length: 264 Return: -38.00943195381201
INFO:tensorflow:Average training steps per second: 249.36
I0902 18:14:11.224036 140284730537984 replay_runner.py:36] Average training steps per second: 249.36
I0902 18:14:12.207760 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.59
INFO:tensorflow:Starting iteration 1
I0902 18:14:15.633707 140284730537984 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 348.86

Steps executed: 471 Episode length: 286 Return: -155.95323291293013
I0902 18:14:18.825686 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.20
INFO:tensorflow:Starting iteration 2

Steps executed: 258 Episode length: 129 Return: -317.62209340475663
INFO:tensorflow:Average training steps per second: 342.28
I0902 18:14:25.201975 140284730537984 replay_runner.py:36] Average training steps per second: 342.28
I0902 18:14:25.347191 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.77
INFO:tensorflow:Starting iteration 3

Steps executed: 284 Episode length: 149 Return: -241.25377311615108
INFO:tensorflow:Average training steps per second: 340.11
I0902 18:14:31.745492 140284730537984 replay_runner.py:36] Average training steps per second: 340.11
I0902 18:14:31.910445 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.29
INFO:tensorflow:Starting iteration 4
I0902 18:14:35.371576 140284730537984 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 327.28
I0902 18:14:38.427524 140284730537984 replay_runner.py:36] Average training steps per second: 327.28

Steps executed: 236 Episode length: 236 Return: -10.398416584811386
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -224.03526601778327
INFO:tensorflow:Average training steps per second: 345.38
I0902 18:14:44.898706 140284730537984 replay_runner.py:36] Average training steps per second: 345.38
I0902 18:14:46.184434 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.04
INFO:tensorflow:Starting iteration 6
I0902 18:14:49.549292 140284730537984 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 329.34

Steps executed: 796 Episode length: 796 Return: -2906.708762552731527
I0902 18:14:53.629253 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -2906.71
INFO:tensorflow:Starting iteration 7
I0902 18:14:56.921605 140284730537984 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 331.29

Steps executed: 1000 Episode length: 1000 Return: -572.57647620031627
I0902 18:15:01.832754 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -572.58
INFO:tensorflow:Starting iteration 8
I0902 18:15:05.129693 140284730537984 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 313.61

Steps executed: 823 Episode length: 823 Return: -343.5370786353961427
I0902 18:15:09.524823 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.54
INFO:tensorflow:Starting iteration 9
I0902 18:15:12.824200 140284730537984 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 318.59

Steps executed: 1000 Episode length: 1000 Return: -153.96260295522477
I0902 18:15:17.430295 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.96
INFO:tensorflow:Starting iteration 10

Steps executed: 411 Episode length: 411 Return: -602.3924130828457477
INFO:tensorflow:Average training steps per second: 335.79
I0902 18:15:23.855242 140284730537984 replay_runner.py:36] Average training steps per second: 335.79
I0902 18:15:24.230930 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -602.39
INFO:tensorflow:Starting iteration 11
I0902 18:15:27.617298 140284730537984 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 337.10

Steps executed: 1000 Episode length: 1000 Return: -162.34231315146533
I0902 18:15:32.390501 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.34
INFO:tensorflow:Starting iteration 12
I0902 18:15:35.836913 140284730537984 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 350.53

Steps executed: 1000 Episode length: 1000 Return: -149.56520107776007
I0902 18:15:40.120332 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.57
INFO:tensorflow:Starting iteration 13
I0902 18:15:43.602990 140284730537984 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 343.84

Steps executed: 1000 Episode length: 1000 Return: -142.49849850615462
I0902 18:15:49.954371 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.50
INFO:tensorflow:Starting iteration 14
I0902 18:15:53.340527 140284730537984 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 354.33

Steps executed: 1000 Episode length: 1000 Return: -108.61380770572018
I0902 18:15:57.862802 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.61
INFO:tensorflow:Starting iteration 15
I0902 18:16:01.208781 140284730537984 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 349.91

Steps executed: 1000 Episode length: 1000 Return: -134.08756733063254
I0902 18:16:06.041362 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.09
INFO:tensorflow:Starting iteration 16
I0902 18:16:09.396369 140284730537984 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 353.85

Steps executed: 1000 Episode length: 1000 Return: -91.554520033878574
I0902 18:16:13.905177 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.55
INFO:tensorflow:Starting iteration 17
I0902 18:16:17.242240 140284730537984 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 342.33

Steps executed: 1000 Episode length: 1000 Return: -59.667148976586364
I0902 18:16:22.274840 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.67
INFO:tensorflow:Starting iteration 18
I0902 18:16:25.727016 140284730537984 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 353.65

Steps executed: 984 Episode length: 984 Return: -241.3224099789521864
I0902 18:16:29.919826 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.32
INFO:tensorflow:Starting iteration 19
I0902 18:16:33.473286 140284730537984 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 374.85

Steps executed: 1000 Episode length: 1000 Return: -84.547546434397154
I0902 18:16:38.561707 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.55
INFO:tensorflow:Starting iteration 20
I0902 18:16:41.940140 140284730537984 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 344.77

Steps executed: 758 Episode length: 758 Return: -443.8363710997377154
I0902 18:16:46.169920 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.84
INFO:tensorflow:Starting iteration 21

Steps executed: 282 Episode length: 282 Return: -270.5381683243665554
INFO:tensorflow:Average training steps per second: 355.37
I0902 18:16:52.399840 140284730537984 replay_runner.py:36] Average training steps per second: 355.37
I0902 18:16:52.636942 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.54
INFO:tensorflow:Starting iteration 22
I0902 18:16:56.105154 140284730537984 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 339.77

Steps executed: 487 Episode length: 487 Return: -102.5918774827869654
I0902 18:16:59.746738 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.59
INFO:tensorflow:Starting iteration 23

Steps executed: 367 Episode length: 367 Return: -77.92871385545664654
INFO:tensorflow:Average training steps per second: 335.51
I0902 18:17:06.117455 140284730537984 replay_runner.py:36] Average training steps per second: 335.51
I0902 18:17:06.450949 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.93
INFO:tensorflow:Starting iteration 24
I0902 18:17:09.836413 140284730537984 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 328.91

Steps executed: 1000 Episode length: 1000 Return: 1.40236898246362754
I0902 18:17:16.054638 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: 1.40
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 221 Return: -294.5228455087354754
INFO:tensorflow:Average training steps per second: 347.82
I0902 18:17:22.264083 140284730537984 replay_runner.py:36] Average training steps per second: 347.82
I0902 18:17:22.415771 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.52
INFO:tensorflow:Starting iteration 26

Steps executed: 320 Episode length: 157 Return: -38.17664920654181754
INFO:tensorflow:Average training steps per second: 348.16
I0902 18:17:28.665031 140284730537984 replay_runner.py:36] Average training steps per second: 348.16
I0902 18:17:28.856493 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.10
INFO:tensorflow:Starting iteration 27
I0902 18:17:32.170664 140284730537984 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 334.25

Steps executed: 415 Episode length: 415 Return: -481.1373122419064754
I0902 18:17:35.669967 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.14
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 237 Return: 69.038918405690854754
INFO:tensorflow:Average training steps per second: 370.63
I0902 18:17:41.788811 140284730537984 replay_runner.py:36] Average training steps per second: 370.63
I0902 18:17:41.969256 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.04
INFO:tensorflow:Starting iteration 29

Steps executed: 660 Episode length: 485 Return: -41.87181037570539454
INFO:tensorflow:Average training steps per second: 357.95
I0902 18:17:48.053524 140284730537984 replay_runner.py:36] Average training steps per second: 357.95

Done fixed training!Episode length: 485 Return: -41.87181037570539454