Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:31:28.215651 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:31:28.226146 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:28.226386 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:28.226498 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:28.226604 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:28.226717 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:28.226824 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:28.227137 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:28.227309 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:28.227427 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:28.227769 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:28.228020 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:28.228227 140320049072128 dqn_agent.py:283] 	 seed: 1630499488226072
I0901 12:31:28.232301 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:28.232561 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:28.232839 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:28.233067 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:28.233230 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:28.233377 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:28.233524 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:28.233756 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:28.233895 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:28.280873 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:28.762449 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:28.774485 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:31:28.782544 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:28.782765 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:28.782881 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:28.782997 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:28.783143 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:28.783227 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:28.783328 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:28.783412 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:28.783494 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:28.783575 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:28.783689 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:28.783786 140320049072128 dqn_agent.py:283] 	 seed: 1630499488782492
I0901 12:31:28.785915 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:28.786084 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:28.786252 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:28.786350 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:28.786435 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:28.786518 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:28.786676 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:28.786758 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:28.786846 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:28.815592 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:28.838302 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:31:28.838520 140320049072128 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.05
I0901 12:31:35.829248 140320049072128 replay_runner.py:36] Average training steps per second: 143.05
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:31:37.367079 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:31:37.601109 140320049072128 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 208.62
I0901 12:31:42.395001 140320049072128 replay_runner.py:36] Average training steps per second: 208.62
I0901 12:31:42.806900 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:31:43.043100 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 200.27
I0901 12:31:48.036806 140320049072128 replay_runner.py:36] Average training steps per second: 200.27
I0901 12:31:48.471840 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 257 Episode length: 257 Return: -256.0
INFO:tensorflow:Average training steps per second: 201.45
I0901 12:31:53.675933 140320049072128 replay_runner.py:36] Average training steps per second: 201.45
I0901 12:31:53.915671 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.44
I0901 12:31:59.232509 140320049072128 replay_runner.py:36] Average training steps per second: 197.44
I0901 12:31:59.641690 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 336 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 194.56
I0901 12:32:05.014183 140320049072128 replay_runner.py:36] Average training steps per second: 194.56
I0901 12:32:05.298977 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.70
I0901 12:32:10.584347 140320049072128 replay_runner.py:36] Average training steps per second: 198.70
I0901 12:32:11.009949 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:32:11.260895 140320049072128 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.37
I0901 12:32:16.406273 140320049072128 replay_runner.py:36] Average training steps per second: 194.37
I0901 12:32:16.784644 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 144 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 195.42

Steps executed: 242 Episode length: 98 Return: -97.0.0
I0901 12:32:22.360188 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 9

Steps executed: 279 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 198.11
I0901 12:32:27.658361 140320049072128 replay_runner.py:36] Average training steps per second: 198.11
I0901 12:32:27.888055 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 190.06
I0901 12:32:33.393160 140320049072128 replay_runner.py:36] Average training steps per second: 190.06
I0901 12:32:33.577859 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 11

Steps executed: 245 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 200.08
I0901 12:32:38.822588 140320049072128 replay_runner.py:36] Average training steps per second: 200.08
I0901 12:32:39.057731 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 12
I0901 12:32:39.308239 140320049072128 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.08

Steps executed: 270 Episode length: 71 Return: -70.0.0
I0901 12:32:44.662500 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 13
I0901 12:32:44.906504 140320049072128 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.10
I0901 12:32:50.085518 140320049072128 replay_runner.py:36] Average training steps per second: 193.10

Steps executed: 250 Episode length: 129 Return: -128.0
INFO:tensorflow:Starting iteration 14

Steps executed: 220 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 191.55
I0901 12:32:55.808055 140320049072128 replay_runner.py:36] Average training steps per second: 191.55
I0901 12:32:56.009259 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 15

Steps executed: 610 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.67
I0901 12:33:01.371398 140320049072128 replay_runner.py:36] Average training steps per second: 195.67
I0901 12:33:01.876865 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.50
INFO:tensorflow:Starting iteration 16

Steps executed: 256 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 194.25
I0901 12:33:07.268038 140320049072128 replay_runner.py:36] Average training steps per second: 194.25
I0901 12:33:07.485009 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.82
I0901 12:33:12.824569 140320049072128 replay_runner.py:36] Average training steps per second: 195.82
I0901 12:33:13.245911 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 241 Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 197.65
I0901 12:33:18.521463 140320049072128 replay_runner.py:36] Average training steps per second: 197.65
I0901 12:33:18.732760 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 19

Steps executed: 275 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 199.90
I0901 12:33:23.988384 140320049072128 replay_runner.py:36] Average training steps per second: 199.90
I0901 12:33:24.226497 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 20

Steps executed: 204 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 194.98
I0901 12:33:29.589338 140320049072128 replay_runner.py:36] Average training steps per second: 194.98
I0901 12:33:29.761104 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 21

Steps executed: 264 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 197.12
I0901 12:33:35.059861 140320049072128 replay_runner.py:36] Average training steps per second: 197.12
I0901 12:33:35.288627 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.00
INFO:tensorflow:Starting iteration 22
I0901 12:33:35.540201 140320049072128 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 200.65

Steps executed: 262 Episode length: 79 Return: -78.0.0
I0901 12:33:40.731027 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 23

Steps executed: 203 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 200.03
I0901 12:33:45.967928 140320049072128 replay_runner.py:36] Average training steps per second: 200.03
I0901 12:33:46.145564 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 24

Steps executed: 240 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 205.60
I0901 12:33:51.258047 140320049072128 replay_runner.py:36] Average training steps per second: 205.60
I0901 12:33:51.443029 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 25
I0901 12:33:51.675810 140320049072128 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.52

Steps executed: 281 Episode length: 97 Return: -96.0.0
I0901 12:33:56.886684 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 26

Steps executed: 646 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 209.46
I0901 12:34:01.889192 140320049072128 replay_runner.py:36] Average training steps per second: 209.46
I0901 12:34:02.402290 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.50
INFO:tensorflow:Starting iteration 27

Steps executed: 226 Episode length: 149 Return: -148.0
INFO:tensorflow:Average training steps per second: 194.83
I0901 12:34:07.774576 140320049072128 replay_runner.py:36] Average training steps per second: 194.83
I0901 12:34:07.965079 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 28

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.08
I0901 12:34:13.258707 140320049072128 replay_runner.py:36] Average training steps per second: 198.08
I0901 12:34:13.687489 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 196.48
I0901 12:34:19.029631 140320049072128 replay_runner.py:36] Average training steps per second: 196.48
I0901 12:34:19.199625 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50