Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 23:15:12.538392 139803223304192 run_experiment.py:549] Creating TrainRunner ...
I0902 23:15:12.548507 139803223304192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:12.548684 139803223304192 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:12.548762 139803223304192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:12.548824 139803223304192 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:12.548887 139803223304192 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:12.549032 139803223304192 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:12.549097 139803223304192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:12.549151 139803223304192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:12.549202 139803223304192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:12.549258 139803223304192 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:12.549317 139803223304192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:12.549453 139803223304192 dqn_agent.py:283] 	 seed: 1630624512548459
I0902 23:15:12.552468 139803223304192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:12.552711 139803223304192 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:12.552889 139803223304192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:12.553018 139803223304192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:12.553146 139803223304192 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:12.553301 139803223304192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:12.553403 139803223304192 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:12.553516 139803223304192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:12.553617 139803223304192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:12.586591 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:12.955207 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:12.969884 139803223304192 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:15:12.979256 139803223304192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:12.979448 139803223304192 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:12.979562 139803223304192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:12.979635 139803223304192 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:12.979768 139803223304192 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:12.979837 139803223304192 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:12.979916 139803223304192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:12.979978 139803223304192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:12.980038 139803223304192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:12.980170 139803223304192 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:12.980230 139803223304192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:12.980332 139803223304192 dqn_agent.py:283] 	 seed: 1630624512979199
I0902 23:15:12.983357 139803223304192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:12.983590 139803223304192 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:12.984200 139803223304192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:12.984482 139803223304192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:12.984649 139803223304192 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:12.984830 139803223304192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:12.984953 139803223304192 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:12.985058 139803223304192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:12.985166 139803223304192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:13.012206 139803223304192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:13.097716 139803223304192 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:15:13.098073 139803223304192 replay_runner.py:41] Starting iteration 0
Steps executed: 228 Episode length: 53 Return: -118.03088389727958
INFO:tensorflow:Average training steps per second: 173.28
I0902 23:15:18.869689 139803223304192 replay_runner.py:36] Average training steps per second: 173.28
I0902 23:15:20.078140 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.95
INFO:tensorflow:Starting iteration 1

Steps executed: 214 Episode length: 62 Return: -136.72702680190406
INFO:tensorflow:Average training steps per second: 230.97
I0902 23:15:28.705781 139803223304192 replay_runner.py:36] Average training steps per second: 230.97
I0902 23:15:28.846403 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.78
INFO:tensorflow:Starting iteration 2

Steps executed: 226 Episode length: 77 Return: -167.51153327635296
INFO:tensorflow:Average training steps per second: 227.30
I0902 23:15:37.650509 139803223304192 replay_runner.py:36] Average training steps per second: 227.30
I0902 23:15:37.807936 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.70
INFO:tensorflow:Starting iteration 3
I0902 23:15:42.175597 139803223304192 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 244.58

Steps executed: 248 Episode length: 69 Return: -133.32641984559064
I0902 23:15:46.406757 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.90
INFO:tensorflow:Starting iteration 4

Steps executed: 257 Episode length: 61 Return: -142.52471383640722
INFO:tensorflow:Average training steps per second: 242.23
I0902 23:15:54.787968 139803223304192 replay_runner.py:36] Average training steps per second: 242.23
I0902 23:15:54.930158 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.31
INFO:tensorflow:Starting iteration 5

Steps executed: 212 Episode length: 78 Return: -163.34084829266975
INFO:tensorflow:Average training steps per second: 242.81
I0902 23:16:02.971602 139803223304192 replay_runner.py:36] Average training steps per second: 242.81
I0902 23:16:03.091008 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.89
INFO:tensorflow:Starting iteration 6

Steps executed: 201 Episode length: 65 Return: -110.53944188448997
INFO:tensorflow:Average training steps per second: 243.37
I0902 23:16:11.368610 139803223304192 replay_runner.py:36] Average training steps per second: 243.37
I0902 23:16:11.495045 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.48
INFO:tensorflow:Starting iteration 7

Steps executed: 220 Episode length: 63 Return: -140.80015444495677
INFO:tensorflow:Average training steps per second: 229.05
I0902 23:16:20.081470 139803223304192 replay_runner.py:36] Average training steps per second: 229.05
I0902 23:16:20.224698 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.00
INFO:tensorflow:Starting iteration 8

Steps executed: 235 Episode length: 56 Return: -141.53230322612262
INFO:tensorflow:Average training steps per second: 222.42
I0902 23:16:29.118720 139803223304192 replay_runner.py:36] Average training steps per second: 222.42
I0902 23:16:29.265356 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.13
INFO:tensorflow:Starting iteration 9

Steps executed: 223 Episode length: 59 Return: -96.893113677132998
INFO:tensorflow:Average training steps per second: 226.04
I0902 23:16:38.077284 139803223304192 replay_runner.py:36] Average training steps per second: 226.04
I0902 23:16:38.228412 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.86
INFO:tensorflow:Starting iteration 10

Steps executed: 218 Episode length: 85 Return: -160.13353006888125
INFO:tensorflow:Average training steps per second: 226.75
I0902 23:16:46.885886 139803223304192 replay_runner.py:36] Average training steps per second: 226.75
I0902 23:16:47.024556 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.72
INFO:tensorflow:Starting iteration 11

Steps executed: 218 Episode length: 73 Return: -44.069352310078074
INFO:tensorflow:Average training steps per second: 223.20
I0902 23:16:55.619639 139803223304192 replay_runner.py:36] Average training steps per second: 223.20
I0902 23:16:55.770567 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.50
INFO:tensorflow:Starting iteration 12

Steps executed: 215 Episode length: 86 Return: -134.02174964110333
INFO:tensorflow:Average training steps per second: 224.06
I0902 23:17:04.403905 139803223304192 replay_runner.py:36] Average training steps per second: 224.06
I0902 23:17:04.534036 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.33
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 79 Return: -124.15064169478248
INFO:tensorflow:Average training steps per second: 225.66
I0902 23:17:13.385178 139803223304192 replay_runner.py:36] Average training steps per second: 225.66
I0902 23:17:13.525121 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.79
INFO:tensorflow:Starting iteration 14

Steps executed: 283 Episode length: 85 Return: -151.30789729048266
INFO:tensorflow:Average training steps per second: 223.83
I0902 23:17:22.376184 139803223304192 replay_runner.py:36] Average training steps per second: 223.83
I0902 23:17:22.581294 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.87
INFO:tensorflow:Starting iteration 15

Steps executed: 260 Episode length: 66 Return: -148.15006906720544
INFO:tensorflow:Average training steps per second: 223.85
I0902 23:17:31.394426 139803223304192 replay_runner.py:36] Average training steps per second: 223.85
I0902 23:17:31.565265 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.85
INFO:tensorflow:Starting iteration 16
I0902 23:17:35.914283 139803223304192 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 220.05
I0902 23:17:40.459066 139803223304192 replay_runner.py:36] Average training steps per second: 220.05

Steps executed: 233 Episode length: 57 Return: -130.01660554209275
INFO:tensorflow:Starting iteration 17

Steps executed: 265 Episode length: 75 Return: -159.18674544184597
INFO:tensorflow:Average training steps per second: 220.89
I0902 23:17:49.350834 139803223304192 replay_runner.py:36] Average training steps per second: 220.89
I0902 23:17:49.522737 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.30
INFO:tensorflow:Starting iteration 18

Steps executed: 213 Episode length: 86 Return: -141.33332755736643
INFO:tensorflow:Average training steps per second: 228.49
I0902 23:17:58.229101 139803223304192 replay_runner.py:36] Average training steps per second: 228.49
I0902 23:17:58.368767 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.53
INFO:tensorflow:Starting iteration 19

Steps executed: 203 Episode length: 83 Return: -124.48509824019655
INFO:tensorflow:Average training steps per second: 225.42
I0902 23:18:07.210743 139803223304192 replay_runner.py:36] Average training steps per second: 225.42
I0902 23:18:07.346099 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.42
INFO:tensorflow:Starting iteration 20

Steps executed: 213 Episode length: 67 Return: -161.78396176909927
INFO:tensorflow:Average training steps per second: 218.44
I0902 23:18:16.205177 139803223304192 replay_runner.py:36] Average training steps per second: 218.44
I0902 23:18:16.344806 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.47
INFO:tensorflow:Starting iteration 21

Steps executed: 218 Episode length: 74 Return: -131.98859761586857
INFO:tensorflow:Average training steps per second: 234.28
I0902 23:18:25.014619 139803223304192 replay_runner.py:36] Average training steps per second: 234.28
I0902 23:18:25.157503 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.79
INFO:tensorflow:Starting iteration 22

Steps executed: 211 Episode length: 54 Return: -121.00694704133645
INFO:tensorflow:Average training steps per second: 223.37
I0902 23:18:34.075169 139803223304192 replay_runner.py:36] Average training steps per second: 223.37
I0902 23:18:34.214097 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.65
INFO:tensorflow:Starting iteration 23

Steps executed: 239 Episode length: 82 Return: -129.54932945936088
INFO:tensorflow:Average training steps per second: 227.48
I0902 23:18:42.904818 139803223304192 replay_runner.py:36] Average training steps per second: 227.48
I0902 23:18:43.056133 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.20
INFO:tensorflow:Starting iteration 24

Steps executed: 264 Episode length: 87 Return: -199.84071284542243
INFO:tensorflow:Average training steps per second: 239.41
I0902 23:18:51.476673 139803223304192 replay_runner.py:36] Average training steps per second: 239.41
I0902 23:18:51.689612 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.59
INFO:tensorflow:Starting iteration 25

Steps executed: 260 Episode length: 64 Return: -135.65833847260635
INFO:tensorflow:Average training steps per second: 247.12
I0902 23:19:00.027267 139803223304192 replay_runner.py:36] Average training steps per second: 247.12
I0902 23:19:00.178597 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.99
INFO:tensorflow:Starting iteration 26

Steps executed: 263 Episode length: 81 Return: -175.29292173739722
INFO:tensorflow:Average training steps per second: 245.24
I0902 23:19:08.476337 139803223304192 replay_runner.py:36] Average training steps per second: 245.24
I0902 23:19:08.654418 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.28
INFO:tensorflow:Starting iteration 27

Steps executed: 205 Episode length: 63 Return: -117.43200605807672
INFO:tensorflow:Average training steps per second: 245.84
I0902 23:19:16.730930 139803223304192 replay_runner.py:36] Average training steps per second: 245.84
I0902 23:19:16.846448 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.51
INFO:tensorflow:Starting iteration 28

Steps executed: 270 Episode length: 75 Return: -106.40330733156375
INFO:tensorflow:Average training steps per second: 220.81
I0902 23:19:25.617785 139803223304192 replay_runner.py:36] Average training steps per second: 220.81
I0902 23:19:25.799863 139803223304192 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.97
INFO:tensorflow:Starting iteration 29

Steps executed: 221 Episode length: 87 Return: 4.47101540030763545
INFO:tensorflow:Average training steps per second: 221.01
I0902 23:19:34.535291 139803223304192 replay_runner.py:36] Average training steps per second: 221.01

Done fixed training!Episode length: 87 Return: 4.47101540030763545