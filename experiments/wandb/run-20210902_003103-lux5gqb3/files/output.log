I0902 00:31:09.415500 139752435963904 run_experiment.py:549] Creating TrainRunner ...
I0902 00:31:09.421931 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:31:09.422052 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:31:09.422161 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:31:09.422281 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:31:09.422416 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:31:09.422480 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:31:09.422534 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:31:09.422619 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:31:09.422700 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:31:09.422770 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:31:09.422846 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:31:09.422928 139752435963904 dqn_agent.py:283] 	 seed: 1630542669421893
I0902 00:31:09.424556 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:31:09.424662 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:31:09.424752 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:31:09.424806 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:31:09.424868 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:31:09.424923 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:31:09.424999 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:31:09.425075 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:31:09.425133 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:31:09.445768 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:09.673725 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:09.682369 139752435963904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:31:09.688772 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:31:09.688916 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:31:09.689022 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:31:09.689123 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:31:09.689200 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:31:09.689265 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:31:09.689337 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:31:09.689416 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:31:09.689496 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:31:09.689566 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:31:09.689638 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:31:09.689709 139752435963904 dqn_agent.py:283] 	 seed: 1630542669688745
I0902 00:31:09.691236 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:31:09.691358 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:31:09.691435 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:31:09.691504 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:31:09.691571 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:31:09.691633 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:31:09.691710 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:31:09.691790 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:31:09.691864 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:31:09.714196 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:31:09.729205 139752435963904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:31:09.729336 139752435963904 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
Steps executed: 238 Episode length: 113 Return: -344.3559190866262
INFO:tensorflow:Average training steps per second: 249.91
I0902 00:31:13.730868 139752435963904 replay_runner.py:36] Average training steps per second: 249.91
I0902 00:31:14.477783 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.24
INFO:tensorflow:Starting iteration 1

Steps executed: 318 Episode length: 122 Return: -251.71948238510276
INFO:tensorflow:Average training steps per second: 344.43
I0902 00:31:20.746172 139752435963904 replay_runner.py:36] Average training steps per second: 344.43
I0902 00:31:20.903394 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.27
INFO:tensorflow:Starting iteration 2

Steps executed: 366 Episode length: 366 Return: -297.68232904087716
INFO:tensorflow:Average training steps per second: 341.50
I0902 00:31:27.170802 139752435963904 replay_runner.py:36] Average training steps per second: 341.50
I0902 00:31:27.534041 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.68
INFO:tensorflow:Starting iteration 3

Steps executed: 204 Episode length: 204 Return: -318.81399641811186
INFO:tensorflow:Average training steps per second: 347.66
I0902 00:31:33.802667 139752435963904 replay_runner.py:36] Average training steps per second: 347.66
I0902 00:31:33.950089 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.81
INFO:tensorflow:Starting iteration 4
I0902 00:31:37.324938 139752435963904 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 339.18

Steps executed: 884 Episode length: 884 Return: -494.82680611762166
I0902 00:31:41.799617 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.83
INFO:tensorflow:Starting iteration 5
I0902 00:31:45.156884 139752435963904 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 343.94

Steps executed: 1000 Episode length: 1000 Return: -600.277930049549
I0902 00:31:50.295767 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.28
INFO:tensorflow:Starting iteration 6
I0902 00:31:53.686177 139752435963904 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 351.68

Steps executed: 1000 Episode length: 1000 Return: -258.01883200979586
I0902 00:31:58.815121 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.02
INFO:tensorflow:Starting iteration 7
I0902 00:32:02.127500 139752435963904 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 343.90

Steps executed: 1000 Episode length: 1000 Return: -204.54500266929166
I0902 00:32:06.784519 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.55
INFO:tensorflow:Starting iteration 8
I0902 00:32:09.971263 139752435963904 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 313.09

Steps executed: 1000 Episode length: 1000 Return: -95.339046416237886
I0902 00:32:15.039192 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.34
INFO:tensorflow:Starting iteration 9
I0902 00:32:18.199644 139752435963904 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 322.23

Steps executed: 726 Episode length: 726 Return: -372.4333693304988886
I0902 00:32:22.481325 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.43
INFO:tensorflow:Starting iteration 10

Steps executed: 447 Episode length: 447 Return: -248.0033660384906886
INFO:tensorflow:Average training steps per second: 333.02
I0902 00:32:28.728186 139752435963904 replay_runner.py:36] Average training steps per second: 333.02
I0902 00:32:29.189773 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.00
INFO:tensorflow:Starting iteration 11
I0902 00:32:32.566759 139752435963904 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 343.27

Steps executed: 507 Episode length: 507 Return: -49.93457586085099886
I0902 00:32:36.114970 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.93
INFO:tensorflow:Starting iteration 12
I0902 00:32:39.510146 139752435963904 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 351.67

Steps executed: 1000 Episode length: 1000 Return: -245.30900375563317
I0902 00:32:44.334155 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.31
INFO:tensorflow:Starting iteration 13

Steps executed: 285 Episode length: 133 Return: -225.1526597507630817
INFO:tensorflow:Average training steps per second: 343.30
I0902 00:32:50.631538 139752435963904 replay_runner.py:36] Average training steps per second: 343.30
I0902 00:32:50.793039 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.36
INFO:tensorflow:Starting iteration 14

Steps executed: 297 Episode length: 297 Return: -202.9817998998241817
INFO:tensorflow:Average training steps per second: 348.92
I0902 00:32:57.108375 139752435963904 replay_runner.py:36] Average training steps per second: 348.92
I0902 00:32:57.328677 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.98
INFO:tensorflow:Starting iteration 15
I0902 00:33:00.755140 139752435963904 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 345.04

Steps executed: 384 Episode length: 384 Return: -236.7496313899441817
I0902 00:33:04.008074 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.75
INFO:tensorflow:Starting iteration 16

Steps executed: 328 Episode length: 250 Return: -264.6066719164060717
INFO:tensorflow:Average training steps per second: 335.31
I0902 00:33:10.382637 139752435963904 replay_runner.py:36] Average training steps per second: 335.31
I0902 00:33:10.643479 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.16
INFO:tensorflow:Starting iteration 17

Steps executed: 256 Episode length: 107 Return: -220.1571788597655417
INFO:tensorflow:Average training steps per second: 336.17
I0902 00:33:16.994092 139752435963904 replay_runner.py:36] Average training steps per second: 336.17
I0902 00:33:17.143979 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.95
INFO:tensorflow:Starting iteration 18
I0902 00:33:20.508574 139752435963904 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 326.00
I0902 00:33:23.576637 139752435963904 replay_runner.py:36] Average training steps per second: 326.00

Steps executed: 204 Episode length: 204 Return: -369.1476614391588717
INFO:tensorflow:Starting iteration 19

Steps executed: 291 Episode length: 142 Return: -451.8893138194734417
INFO:tensorflow:Average training steps per second: 334.34
I0902 00:33:30.050991 139752435963904 replay_runner.py:36] Average training steps per second: 334.34
I0902 00:33:30.218431 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -469.29
INFO:tensorflow:Starting iteration 20

Steps executed: 574 Episode length: 574 Return: -224.4059191610007217
INFO:tensorflow:Average training steps per second: 337.40
I0902 00:33:36.533494 139752435963904 replay_runner.py:36] Average training steps per second: 337.40
I0902 00:33:37.446885 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.41
INFO:tensorflow:Starting iteration 21

Steps executed: 376 Episode length: 267 Return: -1644.929457135889217
INFO:tensorflow:Average training steps per second: 336.35
I0902 00:33:43.804023 139752435963904 replay_runner.py:36] Average training steps per second: 336.35
I0902 00:33:44.127447 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -1233.78
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 121 Return: -598.5220891382562217
INFO:tensorflow:Average training steps per second: 336.20
I0902 00:33:50.512814 139752435963904 replay_runner.py:36] Average training steps per second: 336.20
I0902 00:33:50.660268 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -591.80
INFO:tensorflow:Starting iteration 23

Steps executed: 234 Episode length: 53 Return: -94.283301092607818217
INFO:tensorflow:Average training steps per second: 341.14
I0902 00:33:56.993040 139752435963904 replay_runner.py:36] Average training steps per second: 341.14
I0902 00:33:57.156988 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.24
INFO:tensorflow:Starting iteration 24
I0902 00:34:00.582353 139752435963904 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 343.01

Steps executed: 209 Episode length: 72 Return: -97.235124721634658217
I0902 00:34:03.623246 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.99
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 71 Return: -527.26841558805968217
INFO:tensorflow:Average training steps per second: 352.47
I0902 00:34:09.883139 139752435963904 replay_runner.py:36] Average training steps per second: 352.47
I0902 00:34:10.007412 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -556.42
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 91 Return: -350.77228755364095217
INFO:tensorflow:Average training steps per second: 339.71
I0902 00:34:16.294163 139752435963904 replay_runner.py:36] Average training steps per second: 339.71
I0902 00:34:16.423753 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.44
INFO:tensorflow:Starting iteration 27

Steps executed: 235 Episode length: 183 Return: -230.4124902676842617
INFO:tensorflow:Average training steps per second: 348.75
I0902 00:34:22.656678 139752435963904 replay_runner.py:36] Average training steps per second: 348.75
I0902 00:34:22.800909 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.43
INFO:tensorflow:Starting iteration 28

Steps executed: 219 Episode length: 57 Return: -394.40064460841899617
INFO:tensorflow:Average training steps per second: 357.58
I0902 00:34:28.947229 139752435963904 replay_runner.py:36] Average training steps per second: 357.58
I0902 00:34:29.065901 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.08
INFO:tensorflow:Starting iteration 29

Steps executed: 246 Episode length: 75 Return: -183.91281756819265617
INFO:tensorflow:Average training steps per second: 359.59
I0902 00:34:35.277358 139752435963904 replay_runner.py:36] Average training steps per second: 359.59

Done fixed training!Episode length: 75 Return: -183.91281756819265617