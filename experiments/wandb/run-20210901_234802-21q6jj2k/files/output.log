Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0901 23:48:08.878075 140574080804864 run_experiment.py:549] Creating TrainRunner ...
I0901 23:48:08.888382 140574080804864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:48:08.888622 140574080804864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:48:08.888961 140574080804864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:48:08.889210 140574080804864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:48:08.889389 140574080804864 dqn_agent.py:275] 	 update_period: 4
I0901 23:48:08.889662 140574080804864 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:48:08.889808 140574080804864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:48:08.889894 140574080804864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:48:08.890033 140574080804864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:48:08.890265 140574080804864 dqn_agent.py:280] 	 optimizer: adam
I0901 23:48:08.890606 140574080804864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:48:08.890762 140574080804864 dqn_agent.py:283] 	 seed: 1630540088888327
I0901 23:48:08.893779 140574080804864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:48:08.894008 140574080804864 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:48:08.894239 140574080804864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:48:08.894456 140574080804864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:48:08.894598 140574080804864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:48:08.894765 140574080804864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:48:08.895055 140574080804864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:48:08.895212 140574080804864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:48:08.895358 140574080804864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:48:08.937383 140574080804864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:48:09.487254 140574080804864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:48:09.502847 140574080804864 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:48:09.511706 140574080804864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:48:09.512039 140574080804864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:48:09.512262 140574080804864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:48:09.512494 140574080804864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:48:09.512650 140574080804864 dqn_agent.py:275] 	 update_period: 4
I0901 23:48:09.512748 140574080804864 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:48:09.513043 140574080804864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:48:09.513306 140574080804864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:48:09.513424 140574080804864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:48:09.513592 140574080804864 dqn_agent.py:280] 	 optimizer: adam
I0901 23:48:09.513895 140574080804864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:48:09.514090 140574080804864 dqn_agent.py:283] 	 seed: 1630540089511620
I0901 23:48:09.517257 140574080804864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:48:09.517507 140574080804864 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:48:09.517666 140574080804864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:48:09.517753 140574080804864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:48:09.517871 140574080804864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:48:09.518149 140574080804864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:48:09.518325 140574080804864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:48:09.518413 140574080804864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:48:09.518556 140574080804864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:48:09.552816 140574080804864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:48:09.577588 140574080804864 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:48:09.577975 140574080804864 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.17
I0901 23:48:16.373274 140574080804864 replay_runner.py:36] Average training steps per second: 147.17
Steps executed: 201 Episode length: 10 Return: 10.0
I0901 23:48:17.587951 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.40
INFO:tensorflow:Starting iteration 1

Steps executed: 323 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 197.55
I0901 23:48:22.843247 140574080804864 replay_runner.py:36] Average training steps per second: 197.55
I0901 23:48:23.063932 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.08
I0901 23:48:28.328873 140574080804864 replay_runner.py:36] Average training steps per second: 197.08
I0901 23:48:28.468957 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 360 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.89
I0901 23:48:33.682681 140574080804864 replay_runner.py:36] Average training steps per second: 198.89
I0901 23:48:33.927198 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.78
I0901 23:48:39.149404 140574080804864 replay_runner.py:36] Average training steps per second: 198.78
I0901 23:48:39.285220 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 23:48:39.481032 140574080804864 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 200.91
I0901 23:48:44.458871 140574080804864 replay_runner.py:36] Average training steps per second: 200.91
I0901 23:48:44.589322 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 286 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 193.38
I0901 23:48:49.950529 140574080804864 replay_runner.py:36] Average training steps per second: 193.38
I0901 23:48:50.144409 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 7

Steps executed: 260 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 199.43
I0901 23:48:55.351452 140574080804864 replay_runner.py:36] Average training steps per second: 199.43
I0901 23:48:55.534915 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.00
INFO:tensorflow:Starting iteration 8
I0901 23:48:55.732107 140574080804864 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.39

Steps executed: 286 Episode length: 142 Return: 142.0
I0901 23:49:01.026328 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 9

Steps executed: 300 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 196.43
I0901 23:49:06.311890 140574080804864 replay_runner.py:36] Average training steps per second: 196.43
I0901 23:49:06.509377 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.16
I0901 23:49:11.676099 140574080804864 replay_runner.py:36] Average training steps per second: 201.16
I0901 23:49:11.812694 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11
I0901 23:49:12.000917 140574080804864 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 196.54
I0901 23:49:17.089344 140574080804864 replay_runner.py:36] Average training steps per second: 196.54
I0901 23:49:17.220840 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 290 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 204.96
I0901 23:49:22.280448 140574080804864 replay_runner.py:36] Average training steps per second: 204.96
I0901 23:49:22.470319 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.53
I0901 23:49:27.876078 140574080804864 replay_runner.py:36] Average training steps per second: 191.53
I0901 23:49:28.004624 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0901 23:49:28.189446 140574080804864 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 205.49
I0901 23:49:33.056374 140574080804864 replay_runner.py:36] Average training steps per second: 205.49
I0901 23:49:33.189124 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 23:49:33.379890 140574080804864 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 194.94
I0901 23:49:38.510070 140574080804864 replay_runner.py:36] Average training steps per second: 194.94
I0901 23:49:38.650212 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:49:38.845423 140574080804864 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 201.98
I0901 23:49:43.796886 140574080804864 replay_runner.py:36] Average training steps per second: 201.98
I0901 23:49:43.923326 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:49:44.105731 140574080804864 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.44
I0901 23:49:49.302603 140574080804864 replay_runner.py:36] Average training steps per second: 192.44
I0901 23:49:49.444391 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:49:49.625162 140574080804864 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 208.71
I0901 23:49:54.416835 140574080804864 replay_runner.py:36] Average training steps per second: 208.71
I0901 23:49:54.537295 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:49:54.719672 140574080804864 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 199.00
I0901 23:49:59.745070 140574080804864 replay_runner.py:36] Average training steps per second: 199.00
I0901 23:49:59.865984 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:50:00.136673 140574080804864 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 200.45
I0901 23:50:05.125820 140574080804864 replay_runner.py:36] Average training steps per second: 200.45
I0901 23:50:05.254213 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:50:05.431141 140574080804864 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.44
I0901 23:50:10.470846 140574080804864 replay_runner.py:36] Average training steps per second: 198.44
I0901 23:50:10.604852 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:50:10.793635 140574080804864 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 202.98
I0901 23:50:15.720983 140574080804864 replay_runner.py:36] Average training steps per second: 202.98
I0901 23:50:15.866074 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:50:16.065487 140574080804864 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.45
I0901 23:50:21.054514 140574080804864 replay_runner.py:36] Average training steps per second: 200.45
I0901 23:50:21.202821 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:50:21.393364 140574080804864 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.62
I0901 23:50:26.479644 140574080804864 replay_runner.py:36] Average training steps per second: 196.62
I0901 23:50:26.616609 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.20
I0901 23:50:31.673331 140574080804864 replay_runner.py:36] Average training steps per second: 205.20
I0901 23:50:31.902842 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.83
I0901 23:50:36.922526 140574080804864 replay_runner.py:36] Average training steps per second: 206.83
I0901 23:50:37.041479 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:50:37.219717 140574080804864 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 214.75
I0901 23:50:41.876682 140574080804864 replay_runner.py:36] Average training steps per second: 214.75
I0901 23:50:42.002811 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:50:42.175304 140574080804864 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 207.23
I0901 23:50:47.001475 140574080804864 replay_runner.py:36] Average training steps per second: 207.23
I0901 23:50:47.139975 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 209.41
I0901 23:50:52.095157 140574080804864 replay_runner.py:36] Average training steps per second: 209.41
I0901 23:50:52.224731 140574080804864 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00