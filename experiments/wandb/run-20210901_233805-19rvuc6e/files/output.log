
Loaded trained dqn in cartpole
I0901 23:38:12.637008 140156774885376 run_experiment.py:549] Creating TrainRunner ...
I0901 23:38:12.646360 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:38:12.646666 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:38:12.646929 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:38:12.647063 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:38:12.647155 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:38:12.647235 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:38:12.647351 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:38:12.647484 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:38:12.647587 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:38:12.647658 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:38:12.647729 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:38:12.647840 140156774885376 dqn_agent.py:283] 	 seed: 1630539492646291
I0901 23:38:12.649837 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:38:12.649961 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:38:12.650044 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:38:12.650135 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:38:12.650199 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:38:12.650262 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:38:12.650333 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:38:12.650417 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:38:12.650530 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:38:14.067750 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Training fixed agent 4, please be patient, may be a while...
I0901 23:38:14.570804 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:38:14.586552 140156774885376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:38:14.597225 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:38:14.597411 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:38:14.597489 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:38:14.597567 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:38:14.597668 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:38:14.597751 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:38:14.597808 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:38:14.597862 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:38:14.597975 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:38:14.598061 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:38:14.598221 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:38:14.598311 140156774885376 dqn_agent.py:283] 	 seed: 1630539494597181
I0901 23:38:14.601786 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:38:14.602031 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:38:14.602505 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:38:14.602649 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:38:14.602757 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:38:14.602854 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:38:14.602950 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:38:14.603050 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:38:14.603190 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:38:14.672914 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:38:14.694038 140156774885376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:38:14.694339 140156774885376 replay_runner.py:41] Starting iteration 0
Steps executed: 200 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 154.85
I0901 23:38:21.152879 140156774885376 replay_runner.py:36] Average training steps per second: 154.85
I0901 23:38:22.101770 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 53 Return: 53.0
INFO:tensorflow:Average training steps per second: 207.04
I0901 23:38:27.102654 140156774885376 replay_runner.py:36] Average training steps per second: 207.04
I0901 23:38:27.239500 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 54.75
INFO:tensorflow:Starting iteration 2
I0901 23:38:27.423386 140156774885376 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 205.78

Steps executed: 339 Episode length: 170 Return: 170.0
I0901 23:38:32.491633 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.99
I0901 23:38:37.778485 140156774885376 replay_runner.py:36] Average training steps per second: 195.99
I0901 23:38:37.912503 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 358 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 198.11
I0901 23:38:43.135335 140156774885376 replay_runner.py:36] Average training steps per second: 198.11
I0901 23:38:43.385179 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 5

Steps executed: 294 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 197.87
I0901 23:38:48.637418 140156774885376 replay_runner.py:36] Average training steps per second: 197.87
I0901 23:38:48.840207 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 6

Steps executed: 274 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 193.08
I0901 23:38:54.209361 140156774885376 replay_runner.py:36] Average training steps per second: 193.08
I0901 23:38:54.384605 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 7

Steps executed: 277 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 202.73
I0901 23:38:59.502203 140156774885376 replay_runner.py:36] Average training steps per second: 202.73
I0901 23:38:59.701282 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 8

Steps executed: 257 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 198.28
I0901 23:39:04.927916 140156774885376 replay_runner.py:36] Average training steps per second: 198.28
I0901 23:39:05.100495 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 9

Steps executed: 292 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 200.51
I0901 23:39:10.288648 140156774885376 replay_runner.py:36] Average training steps per second: 200.51
I0901 23:39:10.469185 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 10

Steps executed: 300 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 193.09
I0901 23:39:15.826279 140156774885376 replay_runner.py:36] Average training steps per second: 193.09
I0901 23:39:16.031537 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 11

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.17
I0901 23:39:21.083420 140156774885376 replay_runner.py:36] Average training steps per second: 205.17
I0901 23:39:21.345052 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 12
I0901 23:39:21.531482 140156774885376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 189.45

Steps executed: 259 Episode length: 129 Return: 129.0
I0901 23:39:26.987569 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 13

Steps executed: 314 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 195.35
I0901 23:39:32.302004 140156774885376 replay_runner.py:36] Average training steps per second: 195.35
I0901 23:39:32.522954 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 14

Steps executed: 281 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 189.19
I0901 23:39:37.999378 140156774885376 replay_runner.py:36] Average training steps per second: 189.19
I0901 23:39:38.180150 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.36
I0901 23:39:43.510149 140156774885376 replay_runner.py:36] Average training steps per second: 194.36
I0901 23:39:43.644173 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:39:43.839676 140156774885376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.64

Steps executed: 317 Episode length: 161 Return: 161.0
I0901 23:39:49.158954 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 17
I0901 23:39:49.352933 140156774885376 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 191.79
I0901 23:39:54.567584 140156774885376 replay_runner.py:36] Average training steps per second: 191.79
I0901 23:39:54.702360 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18


Steps executed: 390 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.39
I0901 23:39:59.862762 140156774885376 replay_runner.py:36] Average training steps per second: 201.39
I0901 23:40:00.148305 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 19

Steps executed: 296 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 187.00
I0901 23:40:05.697280 140156774885376 replay_runner.py:36] Average training steps per second: 187.00
I0901 23:40:05.920400 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.19
I0901 23:40:11.371861 140156774885376 replay_runner.py:36] Average training steps per second: 194.19
I0901 23:40:11.505065 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:40:11.696434 140156774885376 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 200.41
I0901 23:40:16.686640 140156774885376 replay_runner.py:36] Average training steps per second: 200.41
I0901 23:40:16.816708 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 373 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.10
I0901 23:40:22.291266 140156774885376 replay_runner.py:36] Average training steps per second: 189.10
I0901 23:40:22.546102 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 23

Steps executed: 376 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.74
I0901 23:40:27.873952 140156774885376 replay_runner.py:36] Average training steps per second: 194.74
I0901 23:40:28.162190 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 24

Steps executed: 364 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.36
I0901 23:40:33.545771 140156774885376 replay_runner.py:36] Average training steps per second: 192.36
I0901 23:40:33.779511 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.80
I0901 23:40:39.212680 140156774885376 replay_runner.py:36] Average training steps per second: 190.80
I0901 23:40:39.359276 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:40:39.562633 140156774885376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 193.15
I0901 23:40:44.740373 140156774885376 replay_runner.py:36] Average training steps per second: 193.15
I0901 23:40:44.873569 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:40:45.076519 140156774885376 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 187.14
I0901 23:40:50.420895 140156774885376 replay_runner.py:36] Average training steps per second: 187.14
I0901 23:40:50.554367 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:40:50.738786 140156774885376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.38
I0901 23:40:55.857266 140156774885376 replay_runner.py:36] Average training steps per second: 195.38
I0901 23:40:56.002102 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 23:40:56.232812 140156774885376 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 203.08

Done fixed training!Episode length: 200 Return: 200.0
I0901 23:41:01.288824 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00