Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0902 11:24:06.472916 140218557343744 run_experiment.py:549] Creating TrainRunner ...
I0902 11:24:06.480854 140218557343744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:06.481108 140218557343744 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:06.481223 140218557343744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:06.481311 140218557343744 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:06.481386 140218557343744 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:06.481462 140218557343744 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:06.481573 140218557343744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:06.481687 140218557343744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:06.481842 140218557343744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:06.481996 140218557343744 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:06.482095 140218557343744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:06.482197 140218557343744 dqn_agent.py:283] 	 seed: 1630581846480791
I0902 11:24:06.484885 140218557343744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:06.485108 140218557343744 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:06.485295 140218557343744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:06.485405 140218557343744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:06.485522 140218557343744 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:06.485599 140218557343744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:06.485669 140218557343744 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:06.485738 140218557343744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:06.485806 140218557343744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:06.608989 140218557343744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.186611 140218557343744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.195491 140218557343744 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:24:07.202840 140218557343744 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:07.203004 140218557343744 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:07.203131 140218557343744 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:07.203197 140218557343744 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:07.203278 140218557343744 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:07.203363 140218557343744 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:07.203536 140218557343744 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:07.203612 140218557343744 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:07.203698 140218557343744 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:07.203773 140218557343744 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:07.203872 140218557343744 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:07.203946 140218557343744 dqn_agent.py:283] 	 seed: 1630581847202803
I0902 11:24:07.205902 140218557343744 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:07.206035 140218557343744 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:07.206105 140218557343744 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:07.206187 140218557343744 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:07.206314 140218557343744 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:07.206416 140218557343744 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:07.206485 140218557343744 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:07.206569 140218557343744 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:07.206668 140218557343744 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:07.270617 140218557343744 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.308551 140218557343744 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:24:07.308845 140218557343744 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 139.82
I0902 11:24:14.461742 140218557343744 replay_runner.py:36] Average training steps per second: 139.82
I0902 11:24:15.593030 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 1
I0902 11:24:15.778843 140218557343744 replay_runner.py:41] Starting iteration 1

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.90
I0902 11:24:20.884133 140218557343744 replay_runner.py:36] Average training steps per second: 195.90
I0902 11:24:21.043092 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 2

Steps executed: 184 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 197.99

Steps executed: 378 Episode length: 194 Return: 194.0
I0902 11:24:26.575744 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.06
I0902 11:24:32.004306 140218557343744 replay_runner.py:36] Average training steps per second: 191.06
I0902 11:24:32.145673 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 381 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 192.25
I0902 11:24:37.546910 140218557343744 replay_runner.py:36] Average training steps per second: 192.25
I0902 11:24:37.818971 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 5

Steps executed: 310 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 194.81
I0902 11:24:43.149093 140218557343744 replay_runner.py:36] Average training steps per second: 194.81
I0902 11:24:43.356717 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 6
I0902 11:24:43.537774 140218557343744 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.71
I0902 11:24:48.700541 140218557343744 replay_runner.py:36] Average training steps per second: 193.71
I0902 11:24:48.907854 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 7


Steps executed: 340 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 188.42
I0902 11:24:54.406700 140218557343744 replay_runner.py:36] Average training steps per second: 188.42
I0902 11:24:54.652783 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 8

Steps executed: 255 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 194.33
I0902 11:24:59.986126 140218557343744 replay_runner.py:36] Average training steps per second: 194.33
I0902 11:25:00.164460 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 9

Steps executed: 308 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 191.52
I0902 11:25:05.582715 140218557343744 replay_runner.py:36] Average training steps per second: 191.52
I0902 11:25:05.799722 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 10

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.32
I0902 11:25:11.034638 140218557343744 replay_runner.py:36] Average training steps per second: 198.32
I0902 11:25:11.313353 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 11

Steps executed: 307 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 192.19
I0902 11:25:16.721096 140218557343744 replay_runner.py:36] Average training steps per second: 192.19
I0902 11:25:16.937180 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.78
I0902 11:25:22.279248 140218557343744 replay_runner.py:36] Average training steps per second: 194.78
I0902 11:25:22.427482 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 378 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 195.66
I0902 11:25:27.744597 140218557343744 replay_runner.py:36] Average training steps per second: 195.66
I0902 11:25:27.996028 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 14

Steps executed: 317 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 192.31
I0902 11:25:33.381960 140218557343744 replay_runner.py:36] Average training steps per second: 192.31
I0902 11:25:33.607765 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 15
I0902 11:25:33.805847 140218557343744 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 194.15
I0902 11:25:38.957139 140218557343744 replay_runner.py:36] Average training steps per second: 194.15
I0902 11:25:39.191729 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 16

Steps executed: 347 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 189.92
I0902 11:25:44.649417 140218557343744 replay_runner.py:36] Average training steps per second: 189.92
I0902 11:25:44.847833 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 17

Steps executed: 283 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 199.64
I0902 11:25:50.085987 140218557343744 replay_runner.py:36] Average training steps per second: 199.64
I0902 11:25:50.230712 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.83
I0902 11:25:55.603392 140218557343744 replay_runner.py:36] Average training steps per second: 192.83
I0902 11:25:55.737238 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 11:25:55.932617 140218557343744 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.37
I0902 11:26:01.158858 140218557343744 replay_runner.py:36] Average training steps per second: 191.37
I0902 11:26:01.299031 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 11:26:01.494337 140218557343744 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.27
I0902 11:26:06.513268 140218557343744 replay_runner.py:36] Average training steps per second: 199.27
I0902 11:26:06.657912 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 11:26:06.850577 140218557343744 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 197.47
I0902 11:26:11.915007 140218557343744 replay_runner.py:36] Average training steps per second: 197.47
I0902 11:26:12.072048 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 11:26:12.261068 140218557343744 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.30
I0902 11:26:17.382042 140218557343744 replay_runner.py:36] Average training steps per second: 195.30
I0902 11:26:17.521772 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 11:26:17.700795 140218557343744 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.29
I0902 11:26:22.821904 140218557343744 replay_runner.py:36] Average training steps per second: 195.29
I0902 11:26:22.983162 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 11:26:23.166975 140218557343744 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.62
I0902 11:26:28.227714 140218557343744 replay_runner.py:36] Average training steps per second: 197.62
I0902 11:26:28.365479 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 11:26:28.560315 140218557343744 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.07
I0902 11:26:33.687038 140218557343744 replay_runner.py:36] Average training steps per second: 195.07
I0902 11:26:33.822963 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 11:26:34.015444 140218557343744 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.52
I0902 11:26:39.156673 140218557343744 replay_runner.py:36] Average training steps per second: 194.52
I0902 11:26:39.306810 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 11:26:39.506988 140218557343744 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.25
I0902 11:26:44.791745 140218557343744 replay_runner.py:36] Average training steps per second: 189.25
I0902 11:26:44.933218 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 11:26:45.132830 140218557343744 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 192.83
I0902 11:26:50.319153 140218557343744 replay_runner.py:36] Average training steps per second: 192.83
I0902 11:26:50.457686 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.66
I0902 11:26:55.810260 140218557343744 replay_runner.py:36] Average training steps per second: 193.66
I0902 11:26:55.936022 140218557343744 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00