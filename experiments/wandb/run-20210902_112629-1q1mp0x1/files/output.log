Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 11:26:35.766472 139870285514752 run_experiment.py:549] Creating TrainRunner ...
I0902 11:26:35.778964 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:35.779248 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:35.779389 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:35.779510 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:35.779822 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:35.780086 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:35.780319 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:35.780452 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:35.780552 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:35.780677 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:35.780776 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:35.780931 139870285514752 dqn_agent.py:283] 	 seed: 1630581995778895
I0902 11:26:35.784007 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:35.784230 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:35.784371 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:35.784480 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:35.784591 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:35.784688 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:35.784794 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:35.784895 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:35.785001 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:35.956659 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:36.410590 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:36.427209 139870285514752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:26:36.437115 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:36.437381 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:36.437545 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:36.437681 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:36.437801 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:36.437910 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:36.438042 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:36.438207 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:36.438339 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:36.438524 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:36.438683 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:36.438800 139870285514752 dqn_agent.py:283] 	 seed: 1630581996437059
I0902 11:26:36.441626 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:36.441809 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:36.441955 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:36.442080 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:36.442229 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:36.442353 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:36.442821 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:36.442995 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:36.443175 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:36.492858 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:36.527995 139870285514752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:26:36.528411 139870285514752 replay_runner.py:41] Starting iteration 0
Steps executed: 308 Episode length: 150 Return: -444.3665566094299
INFO:tensorflow:Average training steps per second: 136.52
I0902 11:26:43.853889 139870285514752 replay_runner.py:36] Average training steps per second: 136.52
I0902 11:26:45.198728 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -422.47
INFO:tensorflow:Starting iteration 1

Steps executed: 223 Episode length: 124 Return: -195.2026763775651
INFO:tensorflow:Average training steps per second: 221.43
I0902 11:26:54.111427 139870285514752 replay_runner.py:36] Average training steps per second: 221.43
I0902 11:26:54.298397 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.68
INFO:tensorflow:Starting iteration 2

Steps executed: 369 Episode length: 369 Return: -200.95329964623414
INFO:tensorflow:Average training steps per second: 242.08
I0902 11:27:02.646839 139870285514752 replay_runner.py:36] Average training steps per second: 242.08
I0902 11:27:03.323100 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.95
INFO:tensorflow:Starting iteration 3
I0902 11:27:07.491461 139870285514752 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 266.55

Steps executed: 709 Episode length: 709 Return: -372.32929957698434
I0902 11:27:12.684814 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.33
INFO:tensorflow:Starting iteration 4
I0902 11:27:16.919469 139870285514752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 244.13

Steps executed: 1000 Episode length: 1000 Return: -129.85497089065655
I0902 11:27:23.105799 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.85
INFO:tensorflow:Starting iteration 5
I0902 11:27:27.410056 139870285514752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 217.51

Steps executed: 1000 Episode length: 1000 Return: -124.23471227621405
I0902 11:27:35.604012 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.23
INFO:tensorflow:Starting iteration 6

Steps executed: 92 Episode length: 92 Return: -270.789879257574171405
INFO:tensorflow:Average training steps per second: 216.45

Steps executed: 1092 Episode length: 1000 Return: -95.585143520175895
I0902 11:27:49.063928 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.19
INFO:tensorflow:Starting iteration 7
I0902 11:27:53.250273 139870285514752 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 218.45

Steps executed: 1000 Episode length: 1000 Return: -151.93159934403755
I0902 11:28:00.782151 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.93
INFO:tensorflow:Starting iteration 8
I0902 11:28:05.182549 139870285514752 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 216.10

Steps executed: 500 Episode length: 500 Return: -1295.519911780717655
I0902 11:28:10.551594 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -1295.52
INFO:tensorflow:Starting iteration 9
I0902 11:28:14.822916 139870285514752 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 221.62

Steps executed: 536 Episode length: 536 Return: -274.2851508020059455
I0902 11:28:20.111471 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.29
INFO:tensorflow:Starting iteration 10

Steps executed: 320 Episode length: 320 Return: -160.9546183771804855
INFO:tensorflow:Average training steps per second: 219.46
I0902 11:28:29.086932 139870285514752 replay_runner.py:36] Average training steps per second: 219.46
I0902 11:28:29.531611 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.95
INFO:tensorflow:Starting iteration 11

Steps executed: 351 Episode length: 351 Return: -182.5799031950877855
INFO:tensorflow:Average training steps per second: 223.84
I0902 11:28:38.266700 139870285514752 replay_runner.py:36] Average training steps per second: 223.84
I0902 11:28:38.763776 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.58
INFO:tensorflow:Starting iteration 12
I0902 11:28:43.236956 139870285514752 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 226.41

Steps executed: 1000 Episode length: 1000 Return: -129.50414613004355
I0902 11:28:51.600447 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 13

Steps executed: 284 Episode length: 284 Return: 20.582406864819973355
INFO:tensorflow:Average training steps per second: 223.80
I0902 11:29:00.421181 139870285514752 replay_runner.py:36] Average training steps per second: 223.80
I0902 11:29:00.754814 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.58
INFO:tensorflow:Starting iteration 14
I0902 11:29:05.217073 139870285514752 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 214.75
I0902 11:29:09.874443 139870285514752 replay_runner.py:36] Average training steps per second: 214.75

Steps executed: 229 Episode length: 80 Return: -205.51377634424307855
INFO:tensorflow:Starting iteration 15

Steps executed: 329 Episode length: 153 Return: -251.9528844745869855
INFO:tensorflow:Average training steps per second: 214.23
I0902 11:29:19.043697 139870285514752 replay_runner.py:36] Average training steps per second: 214.23
I0902 11:29:19.384245 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.08
INFO:tensorflow:Starting iteration 16

Steps executed: 256 Episode length: 256 Return: -453.6387676661277855
INFO:tensorflow:Average training steps per second: 216.53
I0902 11:29:28.343251 139870285514752 replay_runner.py:36] Average training steps per second: 216.53
I0902 11:29:28.683751 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.64
INFO:tensorflow:Starting iteration 17
I0902 11:29:33.037058 139870285514752 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 217.67
I0902 11:29:37.631733 139870285514752 replay_runner.py:36] Average training steps per second: 217.67

Steps executed: 406 Episode length: 406 Return: -280.5067231055606855
INFO:tensorflow:Starting iteration 18

Steps executed: 209 Episode length: 77 Return: -125.87076347349777255
INFO:tensorflow:Average training steps per second: 215.75
I0902 11:29:47.424604 139870285514752 replay_runner.py:36] Average training steps per second: 215.75
I0902 11:29:47.609760 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.86
INFO:tensorflow:Starting iteration 19

Steps executed: 283 Episode length: 164 Return: 27.469428610270043255
INFO:tensorflow:Average training steps per second: 224.51
I0902 11:29:56.475151 139870285514752 replay_runner.py:36] Average training steps per second: 224.51
I0902 11:29:56.762097 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.70
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: -461.6908029109578755
INFO:tensorflow:Average training steps per second: 246.73
I0902 11:30:05.040497 139870285514752 replay_runner.py:36] Average training steps per second: 246.73
I0902 11:30:05.279227 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.69
INFO:tensorflow:Starting iteration 21

Steps executed: 231 Episode length: 62 Return: -165.25357726590232755
INFO:tensorflow:Average training steps per second: 260.79
I0902 11:30:13.184305 139870285514752 replay_runner.py:36] Average training steps per second: 260.79
I0902 11:30:13.351689 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.23
INFO:tensorflow:Starting iteration 22

Steps executed: 336 Episode length: 170 Return: -338.1723324559163555
INFO:tensorflow:Average training steps per second: 310.36
I0902 11:30:20.407239 139870285514752 replay_runner.py:36] Average training steps per second: 310.36
I0902 11:30:20.616437 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.68
INFO:tensorflow:Starting iteration 23

Steps executed: 297 Episode length: 161 Return: -173.4082157244589555
INFO:tensorflow:Average training steps per second: 334.66
I0902 11:30:27.165380 139870285514752 replay_runner.py:36] Average training steps per second: 334.66
I0902 11:30:27.345471 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.56
INFO:tensorflow:Starting iteration 24

Steps executed: 232 Episode length: 53 Return: -114.55335636015998555
INFO:tensorflow:Average training steps per second: 326.50
I0902 11:30:33.840501 139870285514752 replay_runner.py:36] Average training steps per second: 326.50
I0902 11:30:33.950469 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.93
INFO:tensorflow:Starting iteration 25

Steps executed: 201 Episode length: 111 Return: -9.839295837705322555
INFO:tensorflow:Average training steps per second: 334.79
I0902 11:30:40.388259 139870285514752 replay_runner.py:36] Average training steps per second: 334.79
I0902 11:30:40.517315 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.09
INFO:tensorflow:Starting iteration 26

Steps executed: 275 Episode length: 79 Return: -156.51252696586383555
INFO:tensorflow:Average training steps per second: 329.82
I0902 11:30:46.942449 139870285514752 replay_runner.py:36] Average training steps per second: 329.82
I0902 11:30:47.104381 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.47
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 66 Return: -115.77439220097972555
INFO:tensorflow:Average training steps per second: 345.81
I0902 11:30:53.434220 139870285514752 replay_runner.py:36] Average training steps per second: 345.81
I0902 11:30:53.546984 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.44
INFO:tensorflow:Starting iteration 28

Steps executed: 219 Episode length: 154 Return: -195.2339574517823555
INFO:tensorflow:Average training steps per second: 384.66
I0902 11:30:59.676446 139870285514752 replay_runner.py:36] Average training steps per second: 384.66
I0902 11:30:59.794603 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.92
INFO:tensorflow:Starting iteration 29

Steps executed: 106 Episode length: 52 Return: -104.38768379728846555
INFO:tensorflow:Average training steps per second: 347.22

Steps executed: 304 Episode length: 198 Return: -426.0218164742283555

Done fixed training!Episode length: 198 Return: -426.0218164742283555