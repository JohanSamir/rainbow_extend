I0905 16:24:38.933812 139803301922816 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:38.943095 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:38.943257 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:38.943410 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:38.943510 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:38.943598 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:38.943685 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:38.943787 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:38.943890 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:38.943997 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:38.944096 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:38.944196 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:38.944304 139803301922816 dqn_agent.py:283] 	 seed: 1630859078943050
I0905 16:24:38.946651 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:38.946804 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:38.946918 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:38.947014 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:38.947103 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:38.947191 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:38.947276 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:38.947388 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:38.947494 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.395325 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0905 16:24:40.705297 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.713391 139803301922816 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:40.718635 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:40.718771 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:40.718833 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:40.718927 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:40.719037 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:40.719096 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:40.719180 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:40.719233 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:40.719317 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:40.719371 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:40.719423 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:40.719473 139803301922816 dqn_agent.py:283] 	 seed: 1630859080718586
I0905 16:24:40.721087 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:40.721201 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:40.721271 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:40.721339 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:40.721398 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:40.721476 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:40.721531 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:40.721631 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:40.721714 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.739346 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.751053 139803301922816 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:40.751184 139803301922816 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 291.85
I0905 16:24:44.177741 139803301922816 replay_runner.py:36] Average training steps per second: 291.85
Steps executed: 248 Episode length: 83 Return: -518.80069866067817
I0905 16:24:44.800093 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.96
INFO:tensorflow:Starting iteration 1

Steps executed: 311 Episode length: 138 Return: -306.71162433726477
INFO:tensorflow:Average training steps per second: 408.22
I0905 16:24:50.423572 139803301922816 replay_runner.py:36] Average training steps per second: 408.22
I0905 16:24:50.560985 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.00
INFO:tensorflow:Starting iteration 2

Steps executed: 341 Episode length: 209 Return: -27.363862080228975
INFO:tensorflow:Average training steps per second: 395.17
I0905 16:24:56.140445 139803301922816 replay_runner.py:36] Average training steps per second: 395.17
I0905 16:24:56.295569 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.57
INFO:tensorflow:Starting iteration 3

Steps executed: 331 Episode length: 151 Return: -241.33060620552597
INFO:tensorflow:Average training steps per second: 343.71
I0905 16:25:02.326734 139803301922816 replay_runner.py:36] Average training steps per second: 343.71
I0905 16:25:02.471170 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.89
INFO:tensorflow:Starting iteration 4

Steps executed: 227 Episode length: 158 Return: -324.59670976595057
INFO:tensorflow:Average training steps per second: 351.67
I0905 16:25:08.757378 139803301922816 replay_runner.py:36] Average training steps per second: 351.67
I0905 16:25:08.861161 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.13
INFO:tensorflow:Starting iteration 5

Steps executed: 214 Episode length: 214 Return: -184.37461049804222
INFO:tensorflow:Average training steps per second: 395.03
I0905 16:25:14.530656 139803301922816 replay_runner.py:36] Average training steps per second: 395.03
I0905 16:25:14.645294 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.37
INFO:tensorflow:Starting iteration 6

Steps executed: 242 Episode length: 84 Return: -426.577604036742232
INFO:tensorflow:Average training steps per second: 387.34
I0905 16:25:20.376988 139803301922816 replay_runner.py:36] Average training steps per second: 387.34
I0905 16:25:20.464102 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.61
INFO:tensorflow:Starting iteration 7

Steps executed: 381 Episode length: 240 Return: -237.70313014497992
INFO:tensorflow:Average training steps per second: 393.96
I0905 16:25:26.207531 139803301922816 replay_runner.py:36] Average training steps per second: 393.96
I0905 16:25:26.415542 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.00
INFO:tensorflow:Starting iteration 8

Steps executed: 231 Episode length: 64 Return: -228.438922336166374
INFO:tensorflow:Average training steps per second: 402.76
I0905 16:25:32.032590 139803301922816 replay_runner.py:36] Average training steps per second: 402.76
I0905 16:25:32.136996 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.33
INFO:tensorflow:Starting iteration 9

Steps executed: 369 Episode length: 369 Return: -179.56266608856384
INFO:tensorflow:Average training steps per second: 400.20
I0905 16:25:37.809455 139803301922816 replay_runner.py:36] Average training steps per second: 400.20
I0905 16:25:38.102615 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.56
INFO:tensorflow:Starting iteration 10

Steps executed: 233 Episode length: 135 Return: -198.41560862430394
INFO:tensorflow:Average training steps per second: 401.83
I0905 16:25:43.715531 139803301922816 replay_runner.py:36] Average training steps per second: 401.83
I0905 16:25:43.807110 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.07
INFO:tensorflow:Starting iteration 11

Steps executed: 329 Episode length: 140 Return: -751.96970505233324
INFO:tensorflow:Average training steps per second: 394.80
I0905 16:25:49.489446 139803301922816 replay_runner.py:36] Average training steps per second: 394.80
I0905 16:25:49.638792 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.20
INFO:tensorflow:Starting iteration 12

Steps executed: 334 Episode length: 334 Return: -133.41303242393843
INFO:tensorflow:Average training steps per second: 407.47
I0905 16:25:55.215426 139803301922816 replay_runner.py:36] Average training steps per second: 407.47
I0905 16:25:55.417903 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.41
INFO:tensorflow:Starting iteration 13

Steps executed: 248 Episode length: 63 Return: -97.2077788203594613
INFO:tensorflow:Average training steps per second: 392.72
I0905 16:26:01.134972 139803301922816 replay_runner.py:36] Average training steps per second: 392.72
I0905 16:26:01.244348 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.24
INFO:tensorflow:Starting iteration 14

Steps executed: 268 Episode length: 82 Return: -157.398543056209187
INFO:tensorflow:Average training steps per second: 406.05
I0905 16:26:06.843418 139803301922816 replay_runner.py:36] Average training steps per second: 406.05
I0905 16:26:06.972324 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.73
INFO:tensorflow:Starting iteration 15

Steps executed: 276 Episode length: 276 Return: 11.2693453732472287
INFO:tensorflow:Average training steps per second: 397.10
I0905 16:26:12.610232 139803301922816 replay_runner.py:36] Average training steps per second: 397.10
I0905 16:26:12.792448 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.27
INFO:tensorflow:Starting iteration 16

Steps executed: 305 Episode length: 305 Return: -93.275704324214267
INFO:tensorflow:Average training steps per second: 393.08
I0905 16:26:18.504540 139803301922816 replay_runner.py:36] Average training steps per second: 393.08
I0905 16:26:18.721873 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.28
INFO:tensorflow:Starting iteration 17
I0905 16:26:21.869395 139803301922816 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 406.89

Steps executed: 741 Episode length: 741 Return: -223.83639301123821
I0905 16:26:25.461033 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.84
INFO:tensorflow:Starting iteration 18

Steps executed: 132 Episode length: 132 Return: -83.235946773972021
INFO:tensorflow:Average training steps per second: 403.10
I0905 16:26:31.086548 139803301922816 replay_runner.py:36] Average training steps per second: 403.10

Steps executed: 244 Episode length: 57 Return: -133.367794133509141
INFO:tensorflow:Starting iteration 19

Steps executed: 314 Episode length: 120 Return: -299.93935378689941
INFO:tensorflow:Average training steps per second: 393.67
I0905 16:26:36.877339 139803301922816 replay_runner.py:36] Average training steps per second: 393.67
I0905 16:26:36.992002 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.87
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 70 Return: -229.730436566824381
INFO:tensorflow:Average training steps per second: 366.25
I0905 16:26:42.877707 139803301922816 replay_runner.py:36] Average training steps per second: 366.25
I0905 16:26:42.982581 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.11
INFO:tensorflow:Starting iteration 21
I0905 16:26:46.127817 139803301922816 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 360.99

Steps executed: 256 Episode length: 59 Return: -369.638937079199251
I0905 16:26:48.993437 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.34
INFO:tensorflow:Starting iteration 22

Steps executed: 209 Episode length: 59 Return: -228.481358501888961
INFO:tensorflow:Average training steps per second: 331.90
I0905 16:26:55.439761 139803301922816 replay_runner.py:36] Average training steps per second: 331.90
I0905 16:26:55.525324 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.78
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 63 Return: -375.356905145210561
INFO:tensorflow:Average training steps per second: 322.02
I0905 16:27:02.212336 139803301922816 replay_runner.py:36] Average training steps per second: 322.02
I0905 16:27:02.355401 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.88
INFO:tensorflow:Starting iteration 24

Steps executed: 217 Episode length: 106 Return: -237.27098071095711
INFO:tensorflow:Average training steps per second: 286.13
I0905 16:27:09.407014 139803301922816 replay_runner.py:36] Average training steps per second: 286.13
I0905 16:27:09.522470 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.52
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 66 Return: -262.636982594442511
INFO:tensorflow:Average training steps per second: 302.92
I0905 16:27:16.496038 139803301922816 replay_runner.py:36] Average training steps per second: 302.92
I0905 16:27:16.634448 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.48
INFO:tensorflow:Starting iteration 26

Steps executed: 243 Episode length: 60 Return: -266.727891324905981
INFO:tensorflow:Average training steps per second: 309.13
I0905 16:27:23.521097 139803301922816 replay_runner.py:36] Average training steps per second: 309.13
I0905 16:27:23.651654 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.34
INFO:tensorflow:Starting iteration 27

Steps executed: 263 Episode length: 98 Return: -449.834496075781181
INFO:tensorflow:Average training steps per second: 309.89
I0905 16:27:30.528918 139803301922816 replay_runner.py:36] Average training steps per second: 309.89
I0905 16:27:30.676126 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.20
INFO:tensorflow:Starting iteration 28

Steps executed: 298 Episode length: 102 Return: -406.97281590838471
INFO:tensorflow:Average training steps per second: 305.14
I0905 16:27:37.631073 139803301922816 replay_runner.py:36] Average training steps per second: 305.14
I0905 16:27:37.799073 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.48
INFO:tensorflow:Starting iteration 29

Steps executed: 70 Episode length: 70 Return: -227.5725651403479371
INFO:tensorflow:Average training steps per second: 308.70

Steps executed: 975 Episode length: 905 Return: -281.92890595817291

Done fixed training!Episode length: 905 Return: -281.92890595817291