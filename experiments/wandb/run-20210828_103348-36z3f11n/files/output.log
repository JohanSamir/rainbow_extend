I0828 10:33:54.976293 140088388143104 run_experiment.py:549] Creating TrainRunner ...
I0828 10:33:54.987609 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:33:54.987854 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:33:54.988037 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:33:54.988227 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:33:54.988351 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:33:54.988461 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:33:54.988620 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:33:54.988772 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:33:54.988882 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:33:54.988994 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:33:54.989099 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:33:54.989372 140088388143104 dqn_agent.py:283] 	 seed: 1630146834987547
I0828 10:33:54.992248 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:33:54.992548 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:33:54.992689 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:33:54.992779 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:33:54.992856 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:33:54.992933 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:33:54.993004 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:33:54.993072 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:33:54.993140 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:33:55.036279 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:33:55.461570 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:33:55.496536 140088388143104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:33:55.506543 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:33:55.506897 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:33:55.507143 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:33:55.507430 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:33:55.507574 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:33:55.507801 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:33:55.507962 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:33:55.508087 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:33:55.508319 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:33:55.508452 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:33:55.508592 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:33:55.508925 140088388143104 dqn_agent.py:283] 	 seed: 1630146835506495
I0828 10:33:55.511450 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:33:55.511623 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:33:55.511789 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:33:55.511928 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:33:55.512018 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:33:55.512091 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:33:55.512189 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:33:55.512429 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:33:55.512566 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:33:55.546938 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:33:55.571253 140088388143104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:33:55.571601 140088388143104 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 150.60
I0828 10:34:02.212026 140088388143104 replay_runner.py:36] Average training steps per second: 150.60
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:34:03.716643 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:34:03.959160 140088388143104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 218.36
I0828 10:34:08.539201 140088388143104 replay_runner.py:36] Average training steps per second: 218.36
I0828 10:34:08.901355 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:34:09.113522 140088388143104 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.28
I0828 10:34:14.314884 140088388143104 replay_runner.py:36] Average training steps per second: 192.28
I0828 10:34:14.726570 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 208 Episode length: 208 Return: -207.0
INFO:tensorflow:Average training steps per second: 214.23
I0828 10:34:19.631237 140088388143104 replay_runner.py:36] Average training steps per second: 214.23
I0828 10:34:19.809340 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.00
INFO:tensorflow:Starting iteration 4

Steps executed: 268 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 197.90
I0828 10:34:25.125381 140088388143104 replay_runner.py:36] Average training steps per second: 197.90
I0828 10:34:25.340404 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 5
I0828 10:34:25.569684 140088388143104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 200.72

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:34:31.034267 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0828 10:34:31.398493 140088388143104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.28
I0828 10:34:36.519686 140088388143104 replay_runner.py:36] Average training steps per second: 195.28
I0828 10:34:36.908806 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0828 10:34:37.145641 140088388143104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 195.82
I0828 10:34:42.252665 140088388143104 replay_runner.py:36] Average training steps per second: 195.82
I0828 10:34:42.691097 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0828 10:34:42.929834 140088388143104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 203.55
I0828 10:34:47.843310 140088388143104 replay_runner.py:36] Average training steps per second: 203.55
I0828 10:34:48.267671 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0828 10:34:48.518356 140088388143104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 165.14
I0828 10:34:54.574179 140088388143104 replay_runner.py:36] Average training steps per second: 165.14
I0828 10:34:54.961480 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:34:55.197191 140088388143104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 194.43
I0828 10:35:00.340827 140088388143104 replay_runner.py:36] Average training steps per second: 194.43
I0828 10:35:00.787687 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 257 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 206.68
I0828 10:35:05.875624 140088388143104 replay_runner.py:36] Average training steps per second: 206.68
I0828 10:35:06.087391 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.68
I0828 10:35:11.504354 140088388143104 replay_runner.py:36] Average training steps per second: 192.68
I0828 10:35:11.905592 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:35:12.141929 140088388143104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 199.22

Steps executed: 247 Episode length: 75 Return: -74.0.0
I0828 10:35:17.388958 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 14

Steps executed: 212 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 201.11
I0828 10:35:22.619915 140088388143104 replay_runner.py:36] Average training steps per second: 201.11
I0828 10:35:22.794475 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 15

Steps executed: 223 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 196.16
I0828 10:35:28.107732 140088388143104 replay_runner.py:36] Average training steps per second: 196.16
I0828 10:35:28.303663 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 205.05
I0828 10:35:33.422760 140088388143104 replay_runner.py:36] Average training steps per second: 205.05
I0828 10:35:33.846413 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:35:34.098601 140088388143104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.65
I0828 10:35:39.289836 140088388143104 replay_runner.py:36] Average training steps per second: 192.65
I0828 10:35:39.714625 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:35:39.946710 140088388143104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.20
I0828 10:35:45.096398 140088388143104 replay_runner.py:36] Average training steps per second: 194.20

Steps executed: 280 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 204.62
I0828 10:35:50.494688 140088388143104 replay_runner.py:36] Average training steps per second: 204.62
I0828 10:35:50.897778 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 172 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 187.92
I0828 10:35:56.462049 140088388143104 replay_runner.py:36] Average training steps per second: 187.92

Steps executed: 672 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.21
I0828 10:36:02.293654 140088388143104 replay_runner.py:36] Average training steps per second: 201.21
I0828 10:36:02.728683 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 426 Episode length: 426 Return: -425.0
INFO:tensorflow:Average training steps per second: 205.29
I0828 10:36:07.841993 140088388143104 replay_runner.py:36] Average training steps per second: 205.29
I0828 10:36:08.187013 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.00
INFO:tensorflow:Starting iteration 23

Steps executed: 246 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 197.51
I0828 10:36:13.486999 140088388143104 replay_runner.py:36] Average training steps per second: 197.51
I0828 10:36:13.688800 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 24

Steps executed: 245 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 215.06
I0828 10:36:18.581887 140088388143104 replay_runner.py:36] Average training steps per second: 215.06
I0828 10:36:18.792323 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.79
I0828 10:36:23.992446 140088388143104 replay_runner.py:36] Average training steps per second: 201.79
I0828 10:36:24.390736 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 244 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 212.08
I0828 10:36:29.335829 140088388143104 replay_runner.py:36] Average training steps per second: 212.08
I0828 10:36:29.541914 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 27

Steps executed: 205 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 211.38
I0828 10:36:34.526504 140088388143104 replay_runner.py:36] Average training steps per second: 211.38
I0828 10:36:34.685909 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 28

Steps executed: 249 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 198.81
I0828 10:36:39.948987 140088388143104 replay_runner.py:36] Average training steps per second: 198.81
I0828 10:36:40.161014 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 29

Steps executed: 153 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 207.15
I0828 10:36:45.228825 140088388143104 replay_runner.py:36] Average training steps per second: 207.15

Done fixed training!Episode length: 114 Return: -113.0