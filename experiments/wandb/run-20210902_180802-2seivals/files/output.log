Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 18:08:09.053867 140669712693248 run_experiment.py:549] Creating TrainRunner ...
I0902 18:08:09.068533 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:08:09.068916 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:08:09.069063 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:08:09.069173 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:08:09.069284 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 18:08:09.069435 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:08:09.069542 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:08:09.069772 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:08:09.069938 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:08:09.070077 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:08:09.070329 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:08:09.070465 140669712693248 dqn_agent.py:283] 	 seed: 1630606089068445
I0902 18:08:09.074473 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:08:09.074836 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:08:09.075043 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:08:09.075154 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:08:09.075233 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:08:09.075325 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:08:09.075451 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:08:09.075529 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:08:09.075606 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:08:09.122636 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:08:09.667760 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:08:09.684041 140669712693248 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:08:09.693849 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:08:09.694101 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:08:09.694247 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:08:09.694364 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:08:09.694809 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 18:08:09.695026 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:08:09.695174 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:08:09.695419 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:08:09.695560 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:08:09.695643 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:08:09.695715 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:08:09.695811 140669712693248 dqn_agent.py:283] 	 seed: 1630606089693797
I0902 18:08:09.699089 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:08:09.699304 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:08:09.699414 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:08:09.699525 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:08:09.699653 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:08:09.699738 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:08:09.699819 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:08:09.699935 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:08:09.700055 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:08:09.735821 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:08:09.758284 140669712693248 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:08:09.758969 140669712693248 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.73
I0902 18:08:16.482753 140669712693248 replay_runner.py:36] Average training steps per second: 148.73
Steps executed: 300 Episode length: 148 Return: 148.0
I0902 18:08:17.742251 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 1

Steps executed: 286 Episode length: 98 Return: 98.0.0
INFO:tensorflow:Average training steps per second: 202.44
I0902 18:08:22.938019 140669712693248 replay_runner.py:36] Average training steps per second: 202.44
I0902 18:08:23.123882 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.33
INFO:tensorflow:Starting iteration 2

Steps executed: 374 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.72
I0902 18:08:28.269890 140669712693248 replay_runner.py:36] Average training steps per second: 201.72
I0902 18:08:28.525364 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.07
I0902 18:08:33.780350 140669712693248 replay_runner.py:36] Average training steps per second: 197.07
I0902 18:08:33.919385 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 318 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 196.32
I0902 18:08:39.205672 140669712693248 replay_runner.py:36] Average training steps per second: 196.32
I0902 18:08:39.418216 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.58
I0902 18:08:44.641569 140669712693248 replay_runner.py:36] Average training steps per second: 198.58
I0902 18:08:44.783494 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 289 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 202.14
I0902 18:08:49.928194 140669712693248 replay_runner.py:36] Average training steps per second: 202.14
I0902 18:08:50.113829 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.27
I0902 18:08:55.321825 140669712693248 replay_runner.py:36] Average training steps per second: 199.27
I0902 18:08:55.453783 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 305 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 209.96
I0902 18:09:00.413126 140669712693248 replay_runner.py:36] Average training steps per second: 209.96
I0902 18:09:00.608281 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.50
INFO:tensorflow:Starting iteration 9

Steps executed: 263 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 195.99
I0902 18:09:05.891759 140669712693248 replay_runner.py:36] Average training steps per second: 195.99
I0902 18:09:06.059262 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.50
INFO:tensorflow:Starting iteration 10

Steps executed: 140 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 207.28

Steps executed: 274 Episode length: 134 Return: 134.0
I0902 18:09:11.246199 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 11

Steps executed: 318 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 202.00
I0902 18:09:16.387533 140669712693248 replay_runner.py:36] Average training steps per second: 202.00
I0902 18:09:16.600115 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 12

Steps executed: 346 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.55
I0902 18:09:21.891155 140669712693248 replay_runner.py:36] Average training steps per second: 195.55
I0902 18:09:22.126307 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.39
I0902 18:09:27.355963 140669712693248 replay_runner.py:36] Average training steps per second: 198.39
I0902 18:09:27.493262 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0902 18:09:27.670713 140669712693248 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.99
I0902 18:09:32.826294 140669712693248 replay_runner.py:36] Average training steps per second: 193.99
I0902 18:09:33.010382 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 15


Steps executed: 348 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 199.34
I0902 18:09:38.219525 140669712693248 replay_runner.py:36] Average training steps per second: 199.34
I0902 18:09:38.459499 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 16

Steps executed: 311 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 201.31
I0902 18:09:43.606879 140669712693248 replay_runner.py:36] Average training steps per second: 201.31
I0902 18:09:43.813264 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.50
INFO:tensorflow:Starting iteration 17
I0902 18:09:44.004889 140669712693248 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.97
I0902 18:09:49.006189 140669712693248 replay_runner.py:36] Average training steps per second: 199.97
I0902 18:09:49.194939 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.50
INFO:tensorflow:Starting iteration 18


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.38
I0902 18:09:54.385080 140669712693248 replay_runner.py:36] Average training steps per second: 200.38
I0902 18:09:54.513352 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 18:09:54.703387 140669712693248 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 201.90
I0902 18:09:59.656775 140669712693248 replay_runner.py:36] Average training steps per second: 201.90
I0902 18:09:59.799755 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 18:09:59.986465 140669712693248 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.71
I0902 18:10:05.122543 140669712693248 replay_runner.py:36] Average training steps per second: 194.71
I0902 18:10:05.304065 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 18:10:05.495225 140669712693248 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.77
I0902 18:10:10.526553 140669712693248 replay_runner.py:36] Average training steps per second: 198.77
I0902 18:10:10.655766 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 18:10:10.839363 140669712693248 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.76
I0902 18:10:15.948096 140669712693248 replay_runner.py:36] Average training steps per second: 195.76
I0902 18:10:16.075321 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 18:10:16.261294 140669712693248 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.21
I0902 18:10:21.332301 140669712693248 replay_runner.py:36] Average training steps per second: 197.21
I0902 18:10:21.475013 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 18:10:21.662840 140669712693248 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 201.05
I0902 18:10:26.636974 140669712693248 replay_runner.py:36] Average training steps per second: 201.05
I0902 18:10:26.767896 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 369 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.00
I0902 18:10:32.017829 140669712693248 replay_runner.py:36] Average training steps per second: 198.00
I0902 18:10:32.263562 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 26
I0902 18:10:32.461397 140669712693248 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 203.59

Steps executed: 397 Episode length: 200 Return: 200.0
I0902 18:10:37.634048 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.90
I0902 18:10:42.955387 140669712693248 replay_runner.py:36] Average training steps per second: 194.90
I0902 18:10:43.092198 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 364 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 203.57
I0902 18:10:48.197497 140669712693248 replay_runner.py:36] Average training steps per second: 203.57
I0902 18:10:48.440695 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.42
I0902 18:10:53.620657 140669712693248 replay_runner.py:36] Average training steps per second: 200.42
I0902 18:10:53.750370 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00