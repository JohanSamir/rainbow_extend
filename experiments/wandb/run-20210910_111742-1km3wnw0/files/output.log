I0910 11:17:48.207512 140336719366144 run_experiment.py:549] Creating TrainRunner ...
I0910 11:17:48.216894 140336719366144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:17:48.217106 140336719366144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:17:48.217298 140336719366144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:17:48.217507 140336719366144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:17:48.217685 140336719366144 dqn_agent.py:275] 	 update_period: 4
I0910 11:17:48.217848 140336719366144 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:17:48.217996 140336719366144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:17:48.218155 140336719366144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:17:48.218312 140336719366144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:17:48.218456 140336719366144 dqn_agent.py:280] 	 optimizer: adam
I0910 11:17:48.218608 140336719366144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:17:48.218767 140336719366144 dqn_agent.py:283] 	 seed: 1631272668216840
I0910 11:17:48.221334 140336719366144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:17:48.221510 140336719366144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:17:48.221824 140336719366144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:17:48.222023 140336719366144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:17:48.222169 140336719366144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:17:48.222295 140336719366144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:17:48.222390 140336719366144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:17:48.222525 140336719366144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:17:48.222665 140336719366144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:17:49.710305 140336719366144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
Steps executed: 791 Episode length: 600 Return: -600.0
I0910 11:17:49.743343 140336719366144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:17:49.743515 140336719366144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:17:49.743598 140336719366144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:17:49.743661 140336719366144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:17:49.743718 140336719366144 dqn_agent.py:275] 	 update_period: 4
I0910 11:17:49.743800 140336719366144 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:17:49.743905 140336719366144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:17:49.743994 140336719366144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:17:49.744111 140336719366144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:17:49.744194 140336719366144 dqn_agent.py:280] 	 optimizer: adam
I0910 11:17:49.744277 140336719366144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:17:49.744384 140336719366144 dqn_agent.py:283] 	 seed: 1631272669743299
I0910 11:17:49.746251 140336719366144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:17:49.746387 140336719366144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:17:49.746463 140336719366144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:17:49.746532 140336719366144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:17:49.746595 140336719366144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:17:49.746679 140336719366144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:17:49.746787 140336719366144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:17:49.746883 140336719366144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:17:49.746964 140336719366144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:17:49.774265 140336719366144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:17:49.792058 140336719366144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:17:49.792270 140336719366144 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 723280.57
I0910 11:17:49.793831 140336719366144 replay_runner.py:39] Average training steps per second: 723280.57
I0910 11:17:50.750526 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 1
I0910 11:17:50.799313 140336719366144 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 411246.59
I0910 11:17:50.802079 140336719366144 replay_runner.py:39] Average training steps per second: 411246.59
I0910 11:17:50.926123 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 2
I0910 11:17:50.965265 140336719366144 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 434552.84
I0910 11:17:50.967891 140336719366144 replay_runner.py:39] Average training steps per second: 434552.84
I0910 11:17:51.167900 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.50
INFO:tensorflow:Starting iteration 3
I0910 11:17:51.200132 140336719366144 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 746849.00
I0910 11:17:51.201760 140336719366144 replay_runner.py:39] Average training steps per second: 746849.00
I0910 11:17:51.565023 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.50
INFO:tensorflow:Starting iteration 4
I0910 11:17:51.592715 140336719366144 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 783250.05

Steps executed: 361 Episode length: 180 Return: -180.0
I0910 11:17:52.010471 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:17:52.039873 140336719366144 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 755186.17
I0910 11:17:52.041458 140336719366144 replay_runner.py:39] Average training steps per second: 755186.17
I0910 11:17:52.148134 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.00
INFO:tensorflow:Starting iteration 6
I0910 11:17:52.175998 140336719366144 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 748982.86
I0910 11:17:52.177556 140336719366144 replay_runner.py:39] Average training steps per second: 748982.86
I0910 11:17:52.324797 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.50
INFO:tensorflow:Starting iteration 7
I0910 11:17:52.360748 140336719366144 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 595105.56
I0910 11:17:52.362756 140336719366144 replay_runner.py:39] Average training steps per second: 595105.56
I0910 11:17:52.542381 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.50
INFO:tensorflow:Starting iteration 8
I0910 11:17:52.571452 140336719366144 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 777298.74
I0910 11:17:52.572982 140336719366144 replay_runner.py:39] Average training steps per second: 777298.74
I0910 11:17:52.690328 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.50
INFO:tensorflow:Starting iteration 9
I0910 11:17:52.722031 140336719366144 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 770020.93
I0910 11:17:52.723592 140336719366144 replay_runner.py:39] Average training steps per second: 770020.93
I0910 11:17:52.832837 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.00
INFO:tensorflow:Starting iteration 10
I0910 11:17:52.873023 140336719366144 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 339454.84
I0910 11:17:52.876343 140336719366144 replay_runner.py:39] Average training steps per second: 339454.84
I0910 11:17:53.235482 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.50
INFO:tensorflow:Starting iteration 11
I0910 11:17:53.286174 140336719366144 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 364468.54
I0910 11:17:53.289276 140336719366144 replay_runner.py:39] Average training steps per second: 364468.54
I0910 11:17:53.442645 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.50
INFO:tensorflow:Starting iteration 12
I0910 11:17:53.478629 140336719366144 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 334180.86
I0910 11:17:53.481998 140336719366144 replay_runner.py:39] Average training steps per second: 334180.86
I0910 11:17:53.777282 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:17:53.808976 140336719366144 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 341583.52

Steps executed: 191 Episode length: 191 Return: -191.0
I0910 11:17:54.098198 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.00
INFO:tensorflow:Starting iteration 14
I0910 11:17:54.129316 140336719366144 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 678580.17
I0910 11:17:54.131042 140336719366144 replay_runner.py:39] Average training steps per second: 678580.17
I0910 11:17:54.298336 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 15
I0910 11:17:54.328210 140336719366144 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 712589.87
I0910 11:17:54.329872 140336719366144 replay_runner.py:39] Average training steps per second: 712589.87
I0910 11:17:54.559067 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:17:54.589914 140336719366144 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 674325.40
I0910 11:17:54.591690 140336719366144 replay_runner.py:39] Average training steps per second: 674325.40
I0910 11:17:54.760795 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.50
INFO:tensorflow:Starting iteration 17
I0910 11:17:54.789685 140336719366144 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 788996.24
I0910 11:17:54.791204 140336719366144 replay_runner.py:39] Average training steps per second: 788996.24
I0910 11:17:55.010366 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:17:55.044095 140336719366144 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 788551.23
I0910 11:17:55.045875 140336719366144 replay_runner.py:39] Average training steps per second: 788551.23
I0910 11:17:55.308275 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:17:55.337115 140336719366144 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 781062.20
I0910 11:17:55.338648 140336719366144 replay_runner.py:39] Average training steps per second: 781062.20
I0910 11:17:55.480330 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.00
INFO:tensorflow:Starting iteration 20
I0910 11:17:55.511034 140336719366144 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 340889.47
I0910 11:17:55.514386 140336719366144 replay_runner.py:39] Average training steps per second: 340889.47
I0910 11:17:55.740689 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.50
INFO:tensorflow:Starting iteration 21
I0910 11:17:55.769053 140336719366144 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 783396.34
I0910 11:17:55.770566 140336719366144 replay_runner.py:39] Average training steps per second: 783396.34

Steps executed: 180 Episode length: 180 Return: -180.0
INFO:tensorflow:Starting iteration 22
I0910 11:17:56.066925 140336719366144 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 751667.38
I0910 11:17:56.068507 140336719366144 replay_runner.py:39] Average training steps per second: 751667.38
I0910 11:17:56.241228 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.00
INFO:tensorflow:Starting iteration 23
I0910 11:17:56.292511 140336719366144 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 374658.69
I0910 11:17:56.295527 140336719366144 replay_runner.py:39] Average training steps per second: 374658.69
I0910 11:17:56.455983 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.50
INFO:tensorflow:Starting iteration 24
I0910 11:17:56.491473 140336719366144 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 755458.21
I0910 11:17:56.493038 140336719366144 replay_runner.py:39] Average training steps per second: 755458.21
I0910 11:17:56.700364 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:17:56.731152 140336719366144 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 719434.65
I0910 11:17:56.732830 140336719366144 replay_runner.py:39] Average training steps per second: 719434.65
I0910 11:17:57.015637 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.50
INFO:tensorflow:Starting iteration 26
I0910 11:17:57.044653 140336719366144 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 758463.65
I0910 11:17:57.046219 140336719366144 replay_runner.py:39] Average training steps per second: 758463.65
I0910 11:17:57.203600 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.50
INFO:tensorflow:Starting iteration 27
I0910 11:17:57.232346 140336719366144 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 783250.05
I0910 11:17:57.233875 140336719366144 replay_runner.py:39] Average training steps per second: 783250.05
I0910 11:17:57.428173 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:17:57.458054 140336719366144 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 781207.67
I0910 11:17:57.459569 140336719366144 replay_runner.py:39] Average training steps per second: 781207.67
I0910 11:17:57.588486 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.00
INFO:tensorflow:Starting iteration 29
I0910 11:17:57.618361 140336719366144 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 738954.19
I0910 11:17:57.619976 140336719366144 replay_runner.py:39] Average training steps per second: 738954.19

Done fixed training!Episode length: 182 Return: -182.0