Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 23:35:24.320109 140268994136064 run_experiment.py:549] Creating TrainRunner ...
I0901 23:35:24.340202 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:24.340487 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:24.340680 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:24.340813 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:24.340936 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:24.341052 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:24.341217 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:24.341330 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:24.341418 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:24.341522 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:24.341778 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:24.341875 140268994136064 dqn_agent.py:283] 	 seed: 1630539324340119
I0901 23:35:24.343967 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:24.344121 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:35:24.344295 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:24.344649 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:24.344844 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:24.344939 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:24.345053 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:24.345147 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:24.345270 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:24.376428 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:24.753780 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:24.767149 140268994136064 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:35:24.773846 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:24.774019 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:24.774094 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:24.774176 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:24.774234 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:24.774288 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:24.774371 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:24.774428 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:24.774482 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:24.774554 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:24.774685 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:24.774849 140268994136064 dqn_agent.py:283] 	 seed: 1630539324773803
I0901 23:35:24.777481 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:24.777654 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:35:24.777754 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:24.777840 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:24.777980 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:24.778203 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:24.778598 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:24.778789 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:24.779236 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:24.845860 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:24.867147 140268994136064 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:35:24.867382 140268994136064 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.52
I0901 23:35:31.555890 140268994136064 replay_runner.py:36] Average training steps per second: 149.52
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:35:32.949687 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:35:33.184619 140268994136064 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 193.23
I0901 23:35:38.360060 140268994136064 replay_runner.py:36] Average training steps per second: 193.23
I0901 23:35:38.763559 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 23:35:39.001515 140268994136064 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 197.82
I0901 23:35:44.057014 140268994136064 replay_runner.py:36] Average training steps per second: 197.82
I0901 23:35:44.506712 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:35:44.753172 140268994136064 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.32
I0901 23:35:49.821605 140268994136064 replay_runner.py:36] Average training steps per second: 197.32
I0901 23:35:50.240853 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:35:50.480650 140268994136064 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 195.08
I0901 23:35:55.607136 140268994136064 replay_runner.py:36] Average training steps per second: 195.08
I0901 23:35:56.023366 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:35:56.267362 140268994136064 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 200.80
I0901 23:36:01.248098 140268994136064 replay_runner.py:36] Average training steps per second: 200.80
I0901 23:36:01.690780 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 23:36:01.920994 140268994136064 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.04
I0901 23:36:07.048466 140268994136064 replay_runner.py:36] Average training steps per second: 195.04
I0901 23:36:07.446602 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:36:07.683334 140268994136064 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 197.54
I0901 23:36:12.745932 140268994136064 replay_runner.py:36] Average training steps per second: 197.54
I0901 23:36:13.186233 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:36:13.426602 140268994136064 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 200.38
I0901 23:36:18.417738 140268994136064 replay_runner.py:36] Average training steps per second: 200.38
I0901 23:36:18.832067 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 23:36:19.085063 140268994136064 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.53
I0901 23:36:24.174322 140268994136064 replay_runner.py:36] Average training steps per second: 196.53
I0901 23:36:24.582070 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 23:36:24.813082 140268994136064 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.08
I0901 23:36:29.992621 140268994136064 replay_runner.py:36] Average training steps per second: 193.08
I0901 23:36:30.413964 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 23:36:30.648553 140268994136064 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.08
I0901 23:36:35.723201 140268994136064 replay_runner.py:36] Average training steps per second: 197.08
I0901 23:36:36.131173 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 23:36:36.373800 140268994136064 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 192.82
I0901 23:36:41.560770 140268994136064 replay_runner.py:36] Average training steps per second: 192.82
I0901 23:36:41.970446 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 23:36:42.210082 140268994136064 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 196.02
I0901 23:36:47.311941 140268994136064 replay_runner.py:36] Average training steps per second: 196.02
I0901 23:36:47.749141 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 23:36:47.997389 140268994136064 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.48
I0901 23:36:53.010958 140268994136064 replay_runner.py:36] Average training steps per second: 199.48
I0901 23:36:53.415512 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 23:36:53.662447 140268994136064 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.62
I0901 23:36:58.936537 140268994136064 replay_runner.py:36] Average training steps per second: 189.62
I0901 23:36:59.351590 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 23:36:59.594551 140268994136064 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.44
I0901 23:37:04.660259 140268994136064 replay_runner.py:36] Average training steps per second: 197.44
I0901 23:37:05.129481 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 23:37:05.381272 140268994136064 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.27
I0901 23:37:10.503043 140268994136064 replay_runner.py:36] Average training steps per second: 195.27
I0901 23:37:10.907672 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 23:37:11.140420 140268994136064 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.50
I0901 23:37:16.309029 140268994136064 replay_runner.py:36] Average training steps per second: 193.50
I0901 23:37:16.708139 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0901 23:37:16.955330 140268994136064 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 199.78
I0901 23:37:21.961462 140268994136064 replay_runner.py:36] Average training steps per second: 199.78
I0901 23:37:22.384555 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0901 23:37:22.624323 140268994136064 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.40
I0901 23:37:27.768946 140268994136064 replay_runner.py:36] Average training steps per second: 194.40
I0901 23:37:28.166223 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0901 23:37:28.405805 140268994136064 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.87
I0901 23:37:33.591325 140268994136064 replay_runner.py:36] Average training steps per second: 192.87
I0901 23:37:34.007781 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 23:37:34.229327 140268994136064 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 203.09
I0901 23:37:39.153606 140268994136064 replay_runner.py:36] Average training steps per second: 203.09
I0901 23:37:39.557020 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 23:37:39.796257 140268994136064 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.62
I0901 23:37:44.988116 140268994136064 replay_runner.py:36] Average training steps per second: 192.62
I0901 23:37:45.399212 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 23:37:45.629486 140268994136064 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.54
I0901 23:37:50.718057 140268994136064 replay_runner.py:36] Average training steps per second: 196.54
I0901 23:37:51.155998 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0901 23:37:51.406815 140268994136064 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 199.79
I0901 23:37:56.412544 140268994136064 replay_runner.py:36] Average training steps per second: 199.79
I0901 23:37:56.808458 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 23:37:57.042793 140268994136064 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.71
I0901 23:38:02.050377 140268994136064 replay_runner.py:36] Average training steps per second: 199.71
I0901 23:38:02.442488 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0901 23:38:02.684377 140268994136064 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 200.35
I0901 23:38:07.676011 140268994136064 replay_runner.py:36] Average training steps per second: 200.35
I0901 23:38:08.075232 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0901 23:38:08.319814 140268994136064 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 209.21
I0901 23:38:13.099940 140268994136064 replay_runner.py:36] Average training steps per second: 209.21
I0901 23:38:13.475721 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29
I0901 23:38:13.703822 140268994136064 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 201.12

Done fixed training!Episode length: 500 Return: -500.0
I0901 23:38:19.046237 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00