Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0902 23:35:26.815542 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0902 23:35:26.826457 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:26.826653 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:26.826735 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:26.826802 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:26.826858 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:26.826916 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:26.827007 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:26.827097 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:26.827181 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:26.827322 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:26.827437 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:26.827535 139926926592000 dqn_agent.py:283] 	 seed: 1630625726826403
I0902 23:35:26.831674 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:26.831967 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:26.832126 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:26.832250 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:26.832385 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:26.832503 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:26.832610 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:26.832713 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:26.832813 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:26.868415 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:27.262404 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:27.276792 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:35:27.286991 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:27.287201 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:27.287301 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:27.287381 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:27.287459 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:27.287539 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:27.287620 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:27.287701 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:27.287791 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:27.287871 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:27.287951 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:27.288030 139926926592000 dqn_agent.py:283] 	 seed: 1630625727286939
I0902 23:35:27.289677 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:27.289831 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:27.289926 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:27.290009 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:27.290159 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:27.290250 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:27.290500 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:27.290680 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:27.291169 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:27.359789 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:27.380364 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:35:27.380563 139926926592000 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 162.60
I0902 23:35:33.530773 139926926592000 replay_runner.py:36] Average training steps per second: 162.60
Steps executed: 204 Episode length: 115 Return: -166.13992717758538
I0902 23:35:34.727488 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.20
INFO:tensorflow:Starting iteration 1

Steps executed: 286 Episode length: 174 Return: -444.64246824706197
INFO:tensorflow:Average training steps per second: 223.36
I0902 23:35:43.436140 139926926592000 replay_runner.py:36] Average training steps per second: 223.36
I0902 23:35:43.695240 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.67
INFO:tensorflow:Starting iteration 2

Steps executed: 356 Episode length: 183 Return: -272.47230715836673
INFO:tensorflow:Average training steps per second: 214.35
I0902 23:35:52.754930 139926926592000 replay_runner.py:36] Average training steps per second: 214.35
I0902 23:35:53.118320 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.42
INFO:tensorflow:Starting iteration 3

Steps executed: 296 Episode length: 142 Return: -226.78406489295526
INFO:tensorflow:Average training steps per second: 216.40
I0902 23:36:01.848301 139926926592000 replay_runner.py:36] Average training steps per second: 216.40
I0902 23:36:02.114422 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.09
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -64.045311124385596
INFO:tensorflow:Average training steps per second: 214.88
I0902 23:36:11.104108 139926926592000 replay_runner.py:36] Average training steps per second: 214.88
I0902 23:36:12.085469 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.05
INFO:tensorflow:Starting iteration 5

Steps executed: 634 Episode length: 634 Return: -222.61575030970084
INFO:tensorflow:Average training steps per second: 218.78
I0902 23:36:21.034898 139926926592000 replay_runner.py:36] Average training steps per second: 218.78
I0902 23:36:21.977749 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.62
INFO:tensorflow:Starting iteration 6
I0902 23:36:26.355202 139926926592000 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.01

Steps executed: 1000 Episode length: 1000 Return: -162.81048105762827
I0902 23:36:33.047391 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.81
INFO:tensorflow:Starting iteration 7

Steps executed: 358 Episode length: 358 Return: -265.7955671803349627
INFO:tensorflow:Average training steps per second: 220.53
I0902 23:36:41.724827 139926926592000 replay_runner.py:36] Average training steps per second: 220.53
I0902 23:36:42.201845 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.80
INFO:tensorflow:Starting iteration 8
I0902 23:36:46.485575 139926926592000 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 218.18

Steps executed: 977 Episode length: 977 Return: -438.7426200416404627
I0902 23:36:52.883441 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.74
INFO:tensorflow:Starting iteration 9
I0902 23:36:57.129582 139926926592000 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 221.66

Steps executed: 880 Episode length: 880 Return: -515.8322012461726627
I0902 23:37:03.379216 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.83
INFO:tensorflow:Starting iteration 10
I0902 23:37:07.686430 139926926592000 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 218.37

Steps executed: 1000 Episode length: 1000 Return: -282.06462718029127
I0902 23:37:14.610414 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.06
INFO:tensorflow:Starting iteration 11
I0902 23:37:18.937744 139926926592000 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 227.01

Steps executed: 1000 Episode length: 1000 Return: -228.56254039915277
I0902 23:37:26.576404 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.56
INFO:tensorflow:Starting iteration 12
I0902 23:37:30.910404 139926926592000 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 221.02

Steps executed: 1000 Episode length: 1000 Return: 26.1198670698348967
I0902 23:37:37.545927 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.12
INFO:tensorflow:Starting iteration 13
I0902 23:37:41.869564 139926926592000 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 228.66

Steps executed: 1000 Episode length: 1000 Return: 38.9286739568271267
I0902 23:37:49.501617 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 38.93
INFO:tensorflow:Starting iteration 14

Steps executed: 284 Episode length: 169 Return: -155.1636448075070767
INFO:tensorflow:Average training steps per second: 227.38
I0902 23:37:58.171662 139926926592000 replay_runner.py:36] Average training steps per second: 227.38
I0902 23:37:58.399433 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.43
INFO:tensorflow:Starting iteration 15

Steps executed: 587 Episode length: 587 Return: -66.09426454098843767
INFO:tensorflow:Average training steps per second: 221.39
I0902 23:38:07.375105 139926926592000 replay_runner.py:36] Average training steps per second: 221.39
I0902 23:38:08.758632 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -66.09
INFO:tensorflow:Starting iteration 16
I0902 23:38:13.146257 139926926592000 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 224.90

Steps executed: 1000 Episode length: 1000 Return: -30.306439241558747
I0902 23:38:21.416132 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.31
INFO:tensorflow:Starting iteration 17
I0902 23:38:25.713283 139926926592000 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 215.04

Steps executed: 594 Episode length: 594 Return: -163.6904755475996747
I0902 23:38:31.500144 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.69
INFO:tensorflow:Starting iteration 18

Steps executed: 236 Episode length: 236 Return: -362.4931500913456747
INFO:tensorflow:Average training steps per second: 212.76
I0902 23:38:40.545205 139926926592000 replay_runner.py:36] Average training steps per second: 212.76
I0902 23:38:40.793422 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.49
INFO:tensorflow:Starting iteration 19

Steps executed: 312 Episode length: 312 Return: -278.9906278497439747
INFO:tensorflow:Average training steps per second: 210.85
I0902 23:38:49.759050 139926926592000 replay_runner.py:36] Average training steps per second: 210.85
I0902 23:38:50.142675 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.99
INFO:tensorflow:Starting iteration 20

Steps executed: 307 Episode length: 185 Return: -166.0430692329280847
INFO:tensorflow:Average training steps per second: 214.06
I0902 23:38:59.079047 139926926592000 replay_runner.py:36] Average training steps per second: 214.06
I0902 23:38:59.351130 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.23
INFO:tensorflow:Starting iteration 21
I0902 23:39:03.676765 139926926592000 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 212.50

Steps executed: 656 Episode length: 656 Return: 201.84850249604790847
I0902 23:39:09.736044 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 201.85
INFO:tensorflow:Starting iteration 22

Steps executed: 216 Episode length: 72 Return: -158.72056237972552647
INFO:tensorflow:Average training steps per second: 217.86
I0902 23:39:18.706475 139926926592000 replay_runner.py:36] Average training steps per second: 217.86
I0902 23:39:18.868128 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.34
INFO:tensorflow:Starting iteration 23

Steps executed: 235 Episode length: 90 Return: -373.41396186435591447
INFO:tensorflow:Average training steps per second: 218.34
I0902 23:39:27.789144 139926926592000 replay_runner.py:36] Average training steps per second: 218.34
I0902 23:39:27.997231 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.63
INFO:tensorflow:Starting iteration 24

Steps executed: 217 Episode length: 217 Return: -89.71587509801188447
INFO:tensorflow:Average training steps per second: 217.94
I0902 23:39:36.902659 139926926592000 replay_runner.py:36] Average training steps per second: 217.94
I0902 23:39:37.126794 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.72
INFO:tensorflow:Starting iteration 25

Steps executed: 320 Episode length: 175 Return: -367.3798624352847247
INFO:tensorflow:Average training steps per second: 220.01
I0902 23:39:46.009287 139926926592000 replay_runner.py:36] Average training steps per second: 220.01
I0902 23:39:46.274201 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.12
INFO:tensorflow:Starting iteration 26

Steps executed: 287 Episode length: 139 Return: -93.20905059589202647
INFO:tensorflow:Average training steps per second: 227.37
I0902 23:39:55.006056 139926926592000 replay_runner.py:36] Average training steps per second: 227.37
I0902 23:39:55.255712 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.78
INFO:tensorflow:Starting iteration 27

Steps executed: 204 Episode length: 71 Return: -277.11943924532513547
INFO:tensorflow:Average training steps per second: 224.80
I0902 23:40:04.014946 139926926592000 replay_runner.py:36] Average training steps per second: 224.80
I0902 23:40:04.191359 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.24
INFO:tensorflow:Starting iteration 28

Steps executed: 137 Episode length: 137 Return: -498.2499026498223547
INFO:tensorflow:Average training steps per second: 215.52

Steps executed: 323 Episode length: 186 Return: -389.6843405519737547
I0902 23:40:13.586522 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.97
INFO:tensorflow:Starting iteration 29

Steps executed: 232 Episode length: 78 Return: -474.04205699556024547
INFO:tensorflow:Average training steps per second: 221.17
I0902 23:40:22.345303 139926926592000 replay_runner.py:36] Average training steps per second: 221.17

Done fixed training!Episode length: 78 Return: -474.04205699556024547