I0910 11:21:15.564773 140376570230784 run_experiment.py:549] Creating TrainRunner ...
I0910 11:21:15.571103 140376570230784 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:15.571236 140376570230784 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:15.571296 140376570230784 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:15.571355 140376570230784 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:15.571407 140376570230784 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:15.571462 140376570230784 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:15.571512 140376570230784 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:15.571593 140376570230784 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:15.571697 140376570230784 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:15.571763 140376570230784 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:15.571817 140376570230784 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:15.571887 140376570230784 dqn_agent.py:283] 	 seed: 1631272875571070
I0910 11:21:15.573614 140376570230784 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:15.573726 140376570230784 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:15.573788 140376570230784 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:15.573843 140376570230784 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:15.573898 140376570230784 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:15.573950 140376570230784 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:15.574048 140376570230784 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:15.574126 140376570230784 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:15.574216 140376570230784 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:15.600467 140376570230784 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:15.619967 140376570230784 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:15.620129 140376570230784 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:15.620188 140376570230784 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:15.620280 140376570230784 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:15.620390 140376570230784 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:15.620540 140376570230784 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:15.620596 140376570230784 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:15.620650 140376570230784 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:15.620701 140376570230784 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:15.620791 140376570230784 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:15.620869 140376570230784 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:15.620940 140376570230784 dqn_agent.py:283] 	 seed: 1631272875619927
I0910 11:21:15.622408 140376570230784 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:15.622537 140376570230784 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:15.622608 140376570230784 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:15.622670 140376570230784 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:15.622740 140376570230784 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:15.622828 140376570230784 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:15.622904 140376570230784 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:15.622979 140376570230784 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:15.623038 140376570230784 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:15.644951 140376570230784 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:15.664709 140376570230784 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:21:15.665228 140376570230784 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 360335.40
I0910 11:21:15.668245 140376570230784 replay_runner.py:39] Average training steps per second: 360335.40
I0910 11:21:16.631572 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:21:16.742489 140376570230784 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 376779.02
I0910 11:21:16.745706 140376570230784 replay_runner.py:39] Average training steps per second: 376779.02
I0910 11:21:16.942960 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:21:17.013216 140376570230784 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 765523.64
I0910 11:21:17.014769 140376570230784 replay_runner.py:39] Average training steps per second: 765523.64
Loaded trained dqn in mountaincar
Training fixed agent 3, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:21:17.249008 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:21:17.360182 140376570230784 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 806441.84
I0910 11:21:17.361694 140376570230784 replay_runner.py:39] Average training steps per second: 806441.84
I0910 11:21:17.527693 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:21:17.610695 140376570230784 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 889000.42
I0910 11:21:17.612021 140376570230784 replay_runner.py:39] Average training steps per second: 889000.42
I0910 11:21:17.778694 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:21:17.841063 140376570230784 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 804276.89
I0910 11:21:17.842572 140376570230784 replay_runner.py:39] Average training steps per second: 804276.89
I0910 11:21:18.062893 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:21:18.132711 140376570230784 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 860017.22
I0910 11:21:18.134113 140376570230784 replay_runner.py:39] Average training steps per second: 860017.22
I0910 11:21:18.367466 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:21:18.440071 140376570230784 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 831543.22
I0910 11:21:18.441577 140376570230784 replay_runner.py:39] Average training steps per second: 831543.22
I0910 11:21:18.677501 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:21:18.762153 140376570230784 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 623873.87
I0910 11:21:18.764146 140376570230784 replay_runner.py:39] Average training steps per second: 623873.87
I0910 11:21:18.963942 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:21:19.050473 140376570230784 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 602370.24
I0910 11:21:19.052427 140376570230784 replay_runner.py:39] Average training steps per second: 602370.24
I0910 11:21:19.267978 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:21:19.338310 140376570230784 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 802276.97
I0910 11:21:19.339807 140376570230784 replay_runner.py:39] Average training steps per second: 802276.97
I0910 11:21:19.513975 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:21:19.591873 140376570230784 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 768187.55
I0910 11:21:19.593431 140376570230784 replay_runner.py:39] Average training steps per second: 768187.55
I0910 11:21:19.795893 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:21:19.862913 140376570230784 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 820642.54
I0910 11:21:19.864364 140376570230784 replay_runner.py:39] Average training steps per second: 820642.54
I0910 11:21:20.082268 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:21:20.153592 140376570230784 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 810336.94
I0910 11:21:20.155066 140376570230784 replay_runner.py:39] Average training steps per second: 810336.94
I0910 11:21:20.349098 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:21:20.416567 140376570230784 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 814269.85
I0910 11:21:20.418014 140376570230784 replay_runner.py:39] Average training steps per second: 814269.85
I0910 11:21:20.622826 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:21:20.718038 140376570230784 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 574247.54
I0910 11:21:20.720087 140376570230784 replay_runner.py:39] Average training steps per second: 574247.54
I0910 11:21:20.941792 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:21:21.026690 140376570230784 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 600215.23
I0910 11:21:21.028668 140376570230784 replay_runner.py:39] Average training steps per second: 600215.23
I0910 11:21:21.247449 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:21:21.318375 140376570230784 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 733783.07
I0910 11:21:21.320010 140376570230784 replay_runner.py:39] Average training steps per second: 733783.07
I0910 11:21:21.494856 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:21:21.561655 140376570230784 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 809398.69
I0910 11:21:21.563115 140376570230784 replay_runner.py:39] Average training steps per second: 809398.69
I0910 11:21:21.769708 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:21:21.843760 140376570230784 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 822090.16
I0910 11:21:21.845211 140376570230784 replay_runner.py:39] Average training steps per second: 822090.16
I0910 11:21:22.029797 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:21:22.251890 140376570230784 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 850771.60
I0910 11:21:22.253290 140376570230784 replay_runner.py:39] Average training steps per second: 850771.60
I0910 11:21:22.438123 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:21:22.523420 140376570230784 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 782081.67
I0910 11:21:22.525085 140376570230784 replay_runner.py:39] Average training steps per second: 782081.67
I0910 11:21:22.730523 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:21:22.804820 140376570230784 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 812219.98
I0910 11:21:22.806279 140376570230784 replay_runner.py:39] Average training steps per second: 812219.98
I0910 11:21:22.997391 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:21:23.067865 140376570230784 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 754506.93
I0910 11:21:23.069430 140376570230784 replay_runner.py:39] Average training steps per second: 754506.93
I0910 11:21:23.284224 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:21:23.375686 140376570230784 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 411448.30
I0910 11:21:23.378447 140376570230784 replay_runner.py:39] Average training steps per second: 411448.30
I0910 11:21:23.582327 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:21:23.650928 140376570230784 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 815377.92
I0910 11:21:23.652383 140376570230784 replay_runner.py:39] Average training steps per second: 815377.92
I0910 11:21:23.893209 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:21:23.962720 140376570230784 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 741829.50
I0910 11:21:23.964302 140376570230784 replay_runner.py:39] Average training steps per second: 741829.50
I0910 11:21:24.170544 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:21:24.238602 140376570230784 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 831873.07
I0910 11:21:24.240017 140376570230784 replay_runner.py:39] Average training steps per second: 831873.07
I0910 11:21:24.440405 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:21:24.511504 140376570230784 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 826626.72
I0910 11:21:24.512958 140376570230784 replay_runner.py:39] Average training steps per second: 826626.72
I0910 11:21:24.711782 140376570230784 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:21:24.781543 140376570230784 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 790185.38
I0910 11:21:24.783061 140376570230784 replay_runner.py:39] Average training steps per second: 790185.38

Done fixed training!Episode length: 600 Return: -600.0