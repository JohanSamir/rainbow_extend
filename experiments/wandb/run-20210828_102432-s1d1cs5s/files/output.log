Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0828 10:24:39.083714 139788988807168 run_experiment.py:549] Creating TrainRunner ...
I0828 10:24:39.093485 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:39.093669 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:39.093755 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:39.093824 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:39.093881 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:39.093961 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:39.094052 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:39.094131 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:39.094206 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:39.094290 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:39.094365 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:39.094438 139788988807168 dqn_agent.py:283] 	 seed: 1630146279093441
I0828 10:24:39.096211 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:39.096344 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:24:39.096422 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:39.096485 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:39.096600 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:39.096717 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:39.096920 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:39.097016 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:39.097093 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:39.129851 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:39.559924 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:39.589295 139788988807168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:24:39.599246 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:39.599475 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:39.599586 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:39.599682 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:39.599778 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:39.599899 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:39.599988 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:39.600084 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:39.600275 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:39.600378 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:39.600468 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:39.600554 139788988807168 dqn_agent.py:283] 	 seed: 1630146279599190
I0828 10:24:39.602962 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:39.603128 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:24:39.603259 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:39.603382 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:39.603482 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:39.603664 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:39.603780 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:39.603880 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:39.603968 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:39.633493 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:39.653883 139788988807168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:24:39.654162 139788988807168 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.50
I0828 10:24:45.846672 139788988807168 replay_runner.py:36] Average training steps per second: 161.50
Steps executed: 202 Episode length: 18 Return: 18.0
I0828 10:24:46.998037 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.36
INFO:tensorflow:Starting iteration 1
I0828 10:24:47.175852 139788988807168 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 204.58
I0828 10:24:52.064539 139788988807168 replay_runner.py:36] Average training steps per second: 204.58
I0828 10:24:52.189515 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.53
INFO:tensorflow:Starting iteration 2

Steps executed: 203 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 193.38
I0828 10:24:57.546898 139788988807168 replay_runner.py:36] Average training steps per second: 193.38
I0828 10:24:57.688184 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3


Steps executed: 241 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 193.63
I0828 10:25:03.047877 139788988807168 replay_runner.py:36] Average training steps per second: 193.63
I0828 10:25:03.212729 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.50
INFO:tensorflow:Starting iteration 4

Steps executed: 300 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 188.80
I0828 10:25:08.696336 139788988807168 replay_runner.py:36] Average training steps per second: 188.80
I0828 10:25:08.886319 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 5

Steps executed: 301 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 195.01
I0828 10:25:14.208391 139788988807168 replay_runner.py:36] Average training steps per second: 195.01
I0828 10:25:14.417348 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 100.33
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.90
I0828 10:25:19.910650 139788988807168 replay_runner.py:36] Average training steps per second: 188.90
I0828 10:25:20.047542 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 386 Episode length: 194 Return: 194.0
INFO:tensorflow:Average training steps per second: 189.86
I0828 10:25:25.511711 139788988807168 replay_runner.py:36] Average training steps per second: 189.86
I0828 10:25:25.775924 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00
INFO:tensorflow:Starting iteration 8

Steps executed: 227 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 192.41
I0828 10:25:31.159213 139788988807168 replay_runner.py:36] Average training steps per second: 192.41
I0828 10:25:31.323266 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.81
I0828 10:25:36.799917 139788988807168 replay_runner.py:36] Average training steps per second: 188.81
I0828 10:25:36.937458 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0828 10:25:37.128044 139788988807168 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 190.47
I0828 10:25:42.378873 139788988807168 replay_runner.py:36] Average training steps per second: 190.47
I0828 10:25:42.511440 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11
I0828 10:25:42.705727 139788988807168 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 193.16
I0828 10:25:47.882998 139788988807168 replay_runner.py:36] Average training steps per second: 193.16
I0828 10:25:48.020744 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 201 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 190.33
I0828 10:25:53.467837 139788988807168 replay_runner.py:36] Average training steps per second: 190.33
I0828 10:25:53.608472 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.17
INFO:tensorflow:Starting iteration 13

Steps executed: 208 Episode length: 13 Return: 13.0.0
INFO:tensorflow:Average training steps per second: 190.70
I0828 10:25:59.045624 139788988807168 replay_runner.py:36] Average training steps per second: 190.70
I0828 10:25:59.188248 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.00
INFO:tensorflow:Starting iteration 14

Steps executed: 208 Episode length: 18 Return: 18.0.0
INFO:tensorflow:Average training steps per second: 191.48
I0828 10:26:04.607244 139788988807168 replay_runner.py:36] Average training steps per second: 191.48
I0828 10:26:04.753928 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.91
INFO:tensorflow:Starting iteration 15

Steps executed: 214 Episode length: 19 Return: 19.0.0
INFO:tensorflow:Average training steps per second: 189.25
I0828 10:26:10.227599 139788988807168 replay_runner.py:36] Average training steps per second: 189.25
I0828 10:26:10.376828 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.83
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.57
I0828 10:26:15.817344 139788988807168 replay_runner.py:36] Average training steps per second: 190.57
I0828 10:26:15.953436 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 277 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 190.17
I0828 10:26:21.402646 139788988807168 replay_runner.py:36] Average training steps per second: 190.17
I0828 10:26:21.587347 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.33
I0828 10:26:26.816132 139788988807168 replay_runner.py:36] Average training steps per second: 198.33
I0828 10:26:26.955542 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 205 Episode length: 99 Return: 99.0.0
INFO:tensorflow:Average training steps per second: 191.48
I0828 10:26:32.358048 139788988807168 replay_runner.py:36] Average training steps per second: 191.48
I0828 10:26:32.500247 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 102.50
INFO:tensorflow:Starting iteration 20

Steps executed: 284 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 193.44
I0828 10:26:37.857609 139788988807168 replay_runner.py:36] Average training steps per second: 193.44
I0828 10:26:38.059794 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.09
I0828 10:26:43.415346 139788988807168 replay_runner.py:36] Average training steps per second: 194.09
I0828 10:26:43.545232 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 235 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 190.60
I0828 10:26:48.983299 139788988807168 replay_runner.py:36] Average training steps per second: 190.60
I0828 10:26:49.143481 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 23

Steps executed: 224 Episode length: 29 Return: 29.0.0
INFO:tensorflow:Average training steps per second: 191.47
I0828 10:26:54.565475 139788988807168 replay_runner.py:36] Average training steps per second: 191.47
I0828 10:26:54.715407 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 24.89
INFO:tensorflow:Starting iteration 24

Steps executed: 285 Episode length: 95 Return: 95.0.0
INFO:tensorflow:Average training steps per second: 193.36
I0828 10:27:00.088566 139788988807168 replay_runner.py:36] Average training steps per second: 193.36
I0828 10:27:00.269345 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.00
INFO:tensorflow:Starting iteration 25

Steps executed: 263 Episode length: 87 Return: 87.0.0
INFO:tensorflow:Average training steps per second: 194.54
I0828 10:27:05.595773 139788988807168 replay_runner.py:36] Average training steps per second: 194.54
I0828 10:27:05.770095 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.67
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.24
I0828 10:27:11.101021 139788988807168 replay_runner.py:36] Average training steps per second: 194.24
I0828 10:27:11.241483 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 102 Return: 102.0
INFO:tensorflow:Average training steps per second: 195.44
I0828 10:27:16.545233 139788988807168 replay_runner.py:36] Average training steps per second: 195.44
I0828 10:27:16.681800 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 101.00
INFO:tensorflow:Starting iteration 28
I0828 10:27:16.863039 139788988807168 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 207.32

Steps executed: 229 Episode length: 119 Return: 119.0
I0828 10:27:21.839286 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 29

Steps executed: 199 Episode length: 199 Return: 199.0
INFO:tensorflow:Average training steps per second: 199.55
I0828 10:27:27.037606 139788988807168 replay_runner.py:36] Average training steps per second: 199.55

Done fixed training!Episode length: 200 Return: 200.0