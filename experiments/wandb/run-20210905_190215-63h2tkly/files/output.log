Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0905 19:02:21.283299 139914690385920 run_experiment.py:549] Creating TrainRunner ...
I0905 19:02:21.290415 139914690385920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:21.290535 139914690385920 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:21.290596 139914690385920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:21.290673 139914690385920 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:21.290729 139914690385920 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:21.290784 139914690385920 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:21.290852 139914690385920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:21.290920 139914690385920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:21.291012 139914690385920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:21.291079 139914690385920 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:21.291143 139914690385920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:21.291216 139914690385920 dqn_agent.py:283] 	 seed: 1630868541290385
I0905 19:02:21.293141 139914690385920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:21.293258 139914690385920 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:21.293339 139914690385920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:21.293406 139914690385920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:21.293468 139914690385920 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:21.293546 139914690385920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:21.293623 139914690385920 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:21.293706 139914690385920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:21.293777 139914690385920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:21.330798 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:21.572905 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:21.580896 139914690385920 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:02:21.586629 139914690385920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:21.586766 139914690385920 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:21.586873 139914690385920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:21.586941 139914690385920 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:21.587014 139914690385920 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:21.587076 139914690385920 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:21.587159 139914690385920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:21.587246 139914690385920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:21.587323 139914690385920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:21.587404 139914690385920 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:21.587496 139914690385920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:21.587568 139914690385920 dqn_agent.py:283] 	 seed: 1630868541586601
I0905 19:02:21.589361 139914690385920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:21.589492 139914690385920 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:21.589572 139914690385920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:21.589641 139914690385920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:21.589704 139914690385920 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:21.589768 139914690385920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:21.589873 139914690385920 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:21.589958 139914690385920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:21.590030 139914690385920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:21.619252 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:21.636751 139914690385920 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:02:21.636897 139914690385920 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 199.26
I0905 19:02:26.655668 139914690385920 replay_runner.py:36] Average training steps per second: 199.26
Steps executed: 316 Episode length: 180 Return: -560.0538488926943
I0905 19:02:27.859699 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.91
INFO:tensorflow:Starting iteration 1

Steps executed: 168 Episode length: 168 Return: -246.43352255656032
INFO:tensorflow:Average training steps per second: 285.00

Steps executed: 316 Episode length: 148 Return: -437.71100950448505
I0905 19:02:34.986728 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.07
INFO:tensorflow:Starting iteration 2
I0905 19:02:38.925974 139914690385920 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 285.57

Steps executed: 448 Episode length: 448 Return: -86.895763370115065
I0905 19:02:43.277114 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.90
INFO:tensorflow:Starting iteration 3
I0905 19:02:47.196639 139914690385920 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 275.35

Steps executed: 1000 Episode length: 1000 Return: -216.7423640734018
I0905 19:02:53.404711 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.74
INFO:tensorflow:Starting iteration 4
I0905 19:02:57.355605 139914690385920 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 280.96

Steps executed: 856 Episode length: 856 Return: -330.897345016845518
I0905 19:03:02.603543 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.90
INFO:tensorflow:Starting iteration 5

Steps executed: 532 Episode length: 532 Return: -327.577952082814518
INFO:tensorflow:Average training steps per second: 279.11
I0905 19:03:09.975100 139914690385920 replay_runner.py:36] Average training steps per second: 279.11
I0905 19:03:11.035593 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.58
INFO:tensorflow:Starting iteration 6
I0905 19:03:14.874584 139914690385920 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 278.57

Steps executed: 592 Episode length: 592 Return: -383.887718220988758
I0905 19:03:19.638464 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.89
INFO:tensorflow:Starting iteration 7
I0905 19:03:23.533829 139914690385920 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 267.04

Steps executed: 394 Episode length: 394 Return: -370.599277911244558
I0905 19:03:27.931662 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.60
INFO:tensorflow:Starting iteration 8

Steps executed: 1000 Episode length: 1000 Return: -229.9198396471248
INFO:tensorflow:Average training steps per second: 266.17
I0905 19:03:35.410750 139914690385920 replay_runner.py:36] Average training steps per second: 266.17
I0905 19:03:36.963043 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.92
INFO:tensorflow:Starting iteration 9

Steps executed: 447 Episode length: 447 Return: -242.671899001197648
INFO:tensorflow:Average training steps per second: 274.68
I0905 19:03:44.433953 139914690385920 replay_runner.py:36] Average training steps per second: 274.68
I0905 19:03:45.334956 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.67
INFO:tensorflow:Starting iteration 10
I0905 19:03:49.252488 139914690385920 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 283.94

Steps executed: 1000 Episode length: 1000 Return: -95.53427162033033
I0905 19:03:55.235825 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.53
INFO:tensorflow:Starting iteration 11
I0905 19:03:59.041525 139914690385920 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 266.08

Steps executed: 1000 Episode length: 1000 Return: -160.36297028695438
I0905 19:04:05.028692 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.36
INFO:tensorflow:Starting iteration 12
I0905 19:04:08.717668 139914690385920 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 265.00
I0905 19:04:12.491513 139914690385920 replay_runner.py:36] Average training steps per second: 265.00

Steps executed: 1000 Episode length: 1000 Return: -37.425997301773538
INFO:tensorflow:Starting iteration 13
I0905 19:04:19.448542 139914690385920 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 275.57

Steps executed: 1000 Episode length: 1000 Return: -61.062376970273476
I0905 19:04:26.541316 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.06
INFO:tensorflow:Starting iteration 14

Steps executed: 363 Episode length: 179 Return: -121.7837964050037776
INFO:tensorflow:Average training steps per second: 289.91
I0905 19:04:33.841192 139914690385920 replay_runner.py:36] Average training steps per second: 289.91
I0905 19:04:34.189171 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.28
INFO:tensorflow:Starting iteration 15

Steps executed: 295 Episode length: 158 Return: -125.0949244892709176
INFO:tensorflow:Average training steps per second: 286.78
I0905 19:04:41.938889 139914690385920 replay_runner.py:36] Average training steps per second: 286.78
I0905 19:04:42.195711 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.70
INFO:tensorflow:Starting iteration 16

Steps executed: 203 Episode length: 203 Return: -90.83920995078829176
INFO:tensorflow:Average training steps per second: 262.41
I0905 19:04:49.939057 139914690385920 replay_runner.py:36] Average training steps per second: 262.41
I0905 19:04:50.117367 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.84
INFO:tensorflow:Starting iteration 17
I0905 19:04:53.916883 139914690385920 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 260.04

Steps executed: 1000 Episode length: 1000 Return: -125.62833541540192
I0905 19:04:59.980414 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.63
INFO:tensorflow:Starting iteration 18

Steps executed: 216 Episode length: 216 Return: -282.6779299782298192
INFO:tensorflow:Average training steps per second: 254.06
I0905 19:05:07.769047 139914690385920 replay_runner.py:36] Average training steps per second: 254.06
I0905 19:05:07.985480 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.68
INFO:tensorflow:Starting iteration 19

Steps executed: 301 Episode length: 111 Return: 9.7880523826109857192
INFO:tensorflow:Average training steps per second: 261.43
I0905 19:05:15.614407 139914690385920 replay_runner.py:36] Average training steps per second: 261.43
I0905 19:05:15.924702 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.40
INFO:tensorflow:Starting iteration 20

Steps executed: 271 Episode length: 144 Return: -11.88612193016487692
INFO:tensorflow:Average training steps per second: 288.43
I0905 19:05:23.322639 139914690385920 replay_runner.py:36] Average training steps per second: 288.43
I0905 19:05:23.551703 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -37.12
INFO:tensorflow:Starting iteration 21
I0905 19:05:27.649587 139914690385920 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 306.16

Steps executed: 596 Episode length: 596 Return: -32.53583420778001692
I0905 19:05:31.839553 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -32.54
INFO:tensorflow:Starting iteration 22
I0905 19:05:35.985660 139914690385920 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 284.26

Steps executed: 545 Episode length: 545 Return: -2.746050705862572392
I0905 19:05:40.235918 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.75
INFO:tensorflow:Starting iteration 23

Steps executed: 335 Episode length: 167 Return: -507.5474157818736392
INFO:tensorflow:Average training steps per second: 277.71
I0905 19:05:47.858749 139914690385920 replay_runner.py:36] Average training steps per second: 277.71
I0905 19:05:48.094883 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.67
INFO:tensorflow:Starting iteration 24

Steps executed: 263 Episode length: 164 Return: -132.6902085180836392
INFO:tensorflow:Average training steps per second: 255.37
I0905 19:05:55.784265 139914690385920 replay_runner.py:36] Average training steps per second: 255.37
I0905 19:05:55.972064 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 25
I0905 19:05:59.533451 139914690385920 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 255.70

Steps executed: 1000 Episode length: 1000 Return: -22.333886008866692
I0905 19:06:05.915734 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.33
INFO:tensorflow:Starting iteration 26
I0905 19:06:09.579227 139914690385920 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 255.15

Steps executed: 1000 Episode length: 1000 Return: -80.865558751341142
I0905 19:06:16.650660 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.87
INFO:tensorflow:Starting iteration 27
I0905 19:06:20.533037 139914690385920 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 260.37

Steps executed: 1000 Episode length: 1000 Return: -48.295632538580016
I0905 19:06:26.510264 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -48.30
INFO:tensorflow:Starting iteration 28

Steps executed: 267 Episode length: 79 Return: -236.89368326902485416
INFO:tensorflow:Average training steps per second: 269.60
I0905 19:06:34.184637 139914690385920 replay_runner.py:36] Average training steps per second: 269.60
I0905 19:06:34.370923 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.41
INFO:tensorflow:Starting iteration 29
I0905 19:06:38.099951 139914690385920 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 296.19

Steps executed: 1000 Episode length: 1000 Return: 112.800448271890536

Done fixed training! Episode length: 1000 Return: 112.800448271890536