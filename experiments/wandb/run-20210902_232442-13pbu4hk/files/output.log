I0902 23:24:49.088129 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0902 23:24:49.100109 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:49.100419 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:49.100606 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:49.100755 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:49.100936 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:49.101053 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:49.101159 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:49.101233 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:49.101394 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:49.101766 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:49.101918 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:49.102045 139819819333632 dqn_agent.py:283] 	 seed: 1630625089100035
I0902 23:24:49.105180 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:49.105354 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:49.105467 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:49.105621 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:49.105706 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:49.105845 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:49.105926 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:49.106015 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:49.106094 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:50.520570 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 23:24:50.869673 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:50.884081 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:24:50.892166 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:50.892423 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:50.892637 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:50.892729 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:50.892867 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:50.892979 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:50.893125 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:50.893240 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:50.893566 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:50.893699 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:50.893805 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:50.893889 139819819333632 dqn_agent.py:283] 	 seed: 1630625090892114
I0902 23:24:50.896536 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:50.896770 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:50.896952 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:50.897073 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:50.897249 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:50.897381 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:50.897493 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:50.897758 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:50.897934 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:50.941345 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:50.975756 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:24:50.976027 139819819333632 replay_runner.py:41] Starting iteration 0
Steps executed: 201 Episode length: 201 Return: -291.4857927259266
INFO:tensorflow:Average training steps per second: 158.89
I0902 23:24:57.270213 139819819333632 replay_runner.py:36] Average training steps per second: 158.89
I0902 23:24:58.487143 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.49
INFO:tensorflow:Starting iteration 1

Steps executed: 261 Episode length: 99 Return: -246.491406231412402
INFO:tensorflow:Average training steps per second: 224.26
I0902 23:25:07.231919 139819819333632 replay_runner.py:36] Average training steps per second: 224.26
I0902 23:25:07.456056 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.19
INFO:tensorflow:Starting iteration 2

Steps executed: 460 Episode length: 280 Return: -57.320186853120692
INFO:tensorflow:Average training steps per second: 225.68
I0902 23:25:16.134414 139819819333632 replay_runner.py:36] Average training steps per second: 225.68
I0902 23:25:16.605262 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.19
INFO:tensorflow:Starting iteration 3

Steps executed: 261 Episode length: 261 Return: -138.31332722576767
INFO:tensorflow:Average training steps per second: 231.72
I0902 23:25:25.239698 139819819333632 replay_runner.py:36] Average training steps per second: 231.72
I0902 23:25:25.522343 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.31
INFO:tensorflow:Starting iteration 4
I0902 23:25:29.642555 139819819333632 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 221.88

Steps executed: 1000 Episode length: 1000 Return: -118.53884396488776
I0902 23:25:37.544806 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.54
INFO:tensorflow:Starting iteration 5
I0902 23:25:41.666874 139819819333632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.54

Steps executed: 1000 Episode length: 1000 Return: -196.74919184143346
I0902 23:25:49.352389 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.75
INFO:tensorflow:Starting iteration 6
I0902 23:25:53.527716 139819819333632 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.72

Steps executed: 1000 Episode length: 1000 Return: -331.55344685635866
I0902 23:26:00.019757 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.55
INFO:tensorflow:Starting iteration 7
I0902 23:26:04.304516 139819819333632 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 223.35

Steps executed: 1000 Episode length: 1000 Return: -163.86365144064197
I0902 23:26:12.193736 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.86
INFO:tensorflow:Starting iteration 8
I0902 23:26:16.497357 139819819333632 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 218.80

Steps executed: 1000 Episode length: 1000 Return: -185.76184926121613
I0902 23:26:24.140422 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.76
INFO:tensorflow:Starting iteration 9
I0902 23:26:28.375797 139819819333632 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 222.29

Steps executed: 891 Episode length: 891 Return: -366.2853751171909413
I0902 23:26:35.460403 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.29
INFO:tensorflow:Starting iteration 10
I0902 23:26:39.779953 139819819333632 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 218.41

Steps executed: 1000 Episode length: 1000 Return: -134.65516429073213
I0902 23:26:47.040649 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.66
INFO:tensorflow:Starting iteration 11

Steps executed: 141 Episode length: 84 Return: -243.08396692310802213
INFO:tensorflow:Average training steps per second: 218.43

Steps executed: 1141 Episode length: 1000 Return: -130.58247146702493
I0902 23:26:59.292802 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.12
INFO:tensorflow:Starting iteration 12

Steps executed: 525 Episode length: 525 Return: -129.4674772910912693
INFO:tensorflow:Average training steps per second: 217.45
I0902 23:27:08.162373 139819819333632 replay_runner.py:36] Average training steps per second: 217.45
I0902 23:27:09.247742 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.47
INFO:tensorflow:Starting iteration 13

Steps executed: 578 Episode length: 512 Return: -105.2249881894374493
INFO:tensorflow:Average training steps per second: 220.78
I0902 23:27:18.107062 139819819333632 replay_runner.py:36] Average training steps per second: 220.78
I0902 23:27:19.137964 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.53
INFO:tensorflow:Starting iteration 14

Steps executed: 354 Episode length: 162 Return: -126.5434805485248553
INFO:tensorflow:Average training steps per second: 223.52
I0902 23:27:27.974584 139819819333632 replay_runner.py:36] Average training steps per second: 223.52
I0902 23:27:28.306566 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.26
INFO:tensorflow:Starting iteration 15
I0902 23:27:32.699234 139819819333632 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 229.43

Steps executed: 486 Episode length: 486 Return: 227.74371468147138553
I0902 23:27:37.824491 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 227.74
INFO:tensorflow:Starting iteration 16

Steps executed: 264 Episode length: 135 Return: -388.9038488588557553
INFO:tensorflow:Average training steps per second: 235.76
I0902 23:27:46.421628 139819819333632 replay_runner.py:36] Average training steps per second: 235.76
I0902 23:27:46.676789 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.26
INFO:tensorflow:Starting iteration 17
I0902 23:27:50.885497 139819819333632 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 233.57
I0902 23:27:55.167463 139819819333632 replay_runner.py:36] Average training steps per second: 233.57

Steps executed: 367 Episode length: 210 Return: -400.9390833211633753
INFO:tensorflow:Starting iteration 18

Steps executed: 481 Episode length: 299 Return: -246.8404325906454653
INFO:tensorflow:Average training steps per second: 231.91
I0902 23:28:04.187952 139819819333632 replay_runner.py:36] Average training steps per second: 231.91
I0902 23:28:04.773742 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.58
INFO:tensorflow:Starting iteration 19

Steps executed: 464 Episode length: 464 Return: -76.29936915571311653
INFO:tensorflow:Average training steps per second: 225.48
I0902 23:28:13.509610 139819819333632 replay_runner.py:36] Average training steps per second: 225.48
I0902 23:28:14.303767 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.30
INFO:tensorflow:Starting iteration 20
I0902 23:28:18.568725 139819819333632 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 226.36
I0902 23:28:22.986821 139819819333632 replay_runner.py:36] Average training steps per second: 226.36

Steps executed: 272 Episode length: 272 Return: -56.37523296950768653
INFO:tensorflow:Starting iteration 21

Steps executed: 280 Episode length: 137 Return: -4.814121757044091553
INFO:tensorflow:Average training steps per second: 232.63
I0902 23:28:31.853273 139819819333632 replay_runner.py:36] Average training steps per second: 232.63
I0902 23:28:32.108285 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -3.97
INFO:tensorflow:Starting iteration 22

Steps executed: 335 Episode length: 142 Return: -419.0776684819354553
INFO:tensorflow:Average training steps per second: 232.90
I0902 23:28:40.748229 139819819333632 replay_runner.py:36] Average training steps per second: 232.90
I0902 23:28:41.086688 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.10
INFO:tensorflow:Starting iteration 23

Steps executed: 215 Episode length: 104 Return: -369.3523514446235453
INFO:tensorflow:Average training steps per second: 230.98
I0902 23:28:49.841424 139819819333632 replay_runner.py:36] Average training steps per second: 230.98
I0902 23:28:50.046567 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.43
INFO:tensorflow:Starting iteration 24
I0902 23:28:54.424357 139819819333632 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 229.85

Steps executed: 617 Episode length: 617 Return: -24.84100378474399453
I0902 23:28:59.898755 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.84
INFO:tensorflow:Starting iteration 25
I0902 23:29:04.317136 139819819333632 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 228.64

Steps executed: 661 Episode length: 661 Return: 187.85803084040487453
I0902 23:29:10.249894 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.86
INFO:tensorflow:Starting iteration 26

Steps executed: 152 Episode length: 152 Return: -89.90837391953457453
INFO:tensorflow:Average training steps per second: 217.68

Steps executed: 415 Episode length: 263 Return: -201.4436456497681453
I0902 23:29:19.777935 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.68
INFO:tensorflow:Starting iteration 27

Steps executed: 327 Episode length: 153 Return: -443.1283367099287653
INFO:tensorflow:Average training steps per second: 222.47
I0902 23:29:28.618527 139819819333632 replay_runner.py:36] Average training steps per second: 222.47
I0902 23:29:28.945914 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.54
INFO:tensorflow:Starting iteration 28
I0902 23:29:33.183215 139819819333632 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 220.52

Steps executed: 310 Episode length: 310 Return: -514.7963107397479653
I0902 23:29:38.167660 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.80
INFO:tensorflow:Starting iteration 29

Steps executed: 250 Episode length: 76 Return: -479.88641633121654653
INFO:tensorflow:Average training steps per second: 227.00
I0902 23:29:46.970011 139819819333632 replay_runner.py:36] Average training steps per second: 227.00

Done fixed training!Episode length: 76 Return: -479.88641633121654653