Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 17:56:49.597990 139702310836224 run_experiment.py:549] Creating TrainRunner ...
I0902 17:56:49.609464 139702310836224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:49.609709 139702310836224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:49.609839 139702310836224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:49.609942 139702310836224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:49.610040 139702310836224 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:49.610148 139702310836224 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:49.610229 139702310836224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:49.610309 139702310836224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:49.610388 139702310836224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:49.610467 139702310836224 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:49.610551 139702310836224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:49.610630 139702310836224 dqn_agent.py:283] 	 seed: 1630605409609315
I0902 17:56:49.613202 139702310836224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:49.613459 139702310836224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:49.613649 139702310836224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:49.613798 139702310836224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:49.613927 139702310836224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:49.614030 139702310836224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:49.614144 139702310836224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:49.614262 139702310836224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:49.614574 139702310836224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:49.660712 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:50.078798 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:50.112358 139702310836224 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:56:50.120207 139702310836224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:50.120407 139702310836224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:50.120492 139702310836224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:50.120561 139702310836224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:50.120616 139702310836224 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:50.120670 139702310836224 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:50.120778 139702310836224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:50.120841 139702310836224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:50.120934 139702310836224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:50.121077 139702310836224 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:50.121203 139702310836224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:50.121281 139702310836224 dqn_agent.py:283] 	 seed: 1630605410120167
I0902 17:56:50.123636 139702310836224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:50.123792 139702310836224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:50.123904 139702310836224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:50.124010 139702310836224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:50.124089 139702310836224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:50.124206 139702310836224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:50.124269 139702310836224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:50.124375 139702310836224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:50.124456 139702310836224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:50.156526 139702310836224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:50.177844 139702310836224 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:56:50.178063 139702310836224 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.84
I0902 17:56:56.896696 139702310836224 replay_runner.py:36] Average training steps per second: 148.84
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:56:58.324348 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:56:58.590928 139702310836224 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.51
I0902 17:57:03.680094 139702310836224 replay_runner.py:36] Average training steps per second: 196.51
I0902 17:57:04.074978 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:57:04.311405 139702310836224 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 201.54
I0902 17:57:09.273736 139702310836224 replay_runner.py:36] Average training steps per second: 201.54
I0902 17:57:09.692089 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:57:09.939300 139702310836224 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 198.56
I0902 17:57:14.975827 139702310836224 replay_runner.py:36] Average training steps per second: 198.56
I0902 17:57:15.378022 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 284 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 198.25
I0902 17:57:20.655200 139702310836224 replay_runner.py:36] Average training steps per second: 198.25
I0902 17:57:20.901021 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.67
I0902 17:57:26.203948 139702310836224 replay_runner.py:36] Average training steps per second: 197.67
I0902 17:57:26.620953 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:57:26.862951 139702310836224 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.07
I0902 17:57:31.990006 139702310836224 replay_runner.py:36] Average training steps per second: 195.07
I0902 17:57:32.397913 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:57:32.639044 139702310836224 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.22
I0902 17:57:37.788375 139702310836224 replay_runner.py:36] Average training steps per second: 194.22
I0902 17:57:38.225692 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:57:38.461189 139702310836224 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.87

Steps executed: 588 Episode length: 500 Return: -500.0
I0902 17:57:44.022014 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.50
INFO:tensorflow:Starting iteration 9
I0902 17:57:44.254909 139702310836224 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 198.71

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:57:49.698660 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:57:49.939704 139702310836224 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 198.21
I0902 17:57:54.985536 139702310836224 replay_runner.py:36] Average training steps per second: 198.21
I0902 17:57:55.411211 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:57:55.663114 139702310836224 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.98
I0902 17:58:00.714745 139702310836224 replay_runner.py:36] Average training steps per second: 197.98
I0902 17:58:01.126167 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:58:01.368939 139702310836224 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.97
I0902 17:58:06.472542 139702310836224 replay_runner.py:36] Average training steps per second: 195.97
I0902 17:58:06.891482 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 386 Episode length: 188 Return: -187.0
INFO:tensorflow:Average training steps per second: 197.63
I0902 17:58:12.192051 139702310836224 replay_runner.py:36] Average training steps per second: 197.63
I0902 17:58:12.499242 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.00
INFO:tensorflow:Starting iteration 14
I0902 17:58:12.749613 139702310836224 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 194.50

Steps executed: 660 Episode length: 500 Return: -500.0
I0902 17:58:18.430484 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.50
INFO:tensorflow:Starting iteration 15

Steps executed: 402 Episode length: 255 Return: -254.0
INFO:tensorflow:Average training steps per second: 196.92
I0902 17:58:23.754467 139702310836224 replay_runner.py:36] Average training steps per second: 196.92
I0902 17:58:24.089332 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.00
INFO:tensorflow:Starting iteration 16
I0902 17:58:24.341185 139702310836224 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 199.47

Steps executed: 622 Episode length: 500 Return: -500.0
I0902 17:58:29.851893 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.50
INFO:tensorflow:Starting iteration 17

Steps executed: 234 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 200.38
I0902 17:58:35.087292 139702310836224 replay_runner.py:36] Average training steps per second: 200.38
I0902 17:58:35.285369 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 18

Steps executed: 232 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 201.80
I0902 17:58:40.484601 139702310836224 replay_runner.py:36] Average training steps per second: 201.80
I0902 17:58:40.678598 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 19

Steps executed: 240 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 193.47
I0902 17:58:46.087347 139702310836224 replay_runner.py:36] Average training steps per second: 193.47
I0902 17:58:46.288838 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 20
I0902 17:58:46.531972 139702310836224 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.30

Steps executed: 323 Episode length: 131 Return: -130.0
I0902 17:58:51.820627 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.67
INFO:tensorflow:Starting iteration 21

Steps executed: 301 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 202.87
I0902 17:58:56.993126 139702310836224 replay_runner.py:36] Average training steps per second: 202.87
I0902 17:58:57.229103 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.33
INFO:tensorflow:Starting iteration 22

Steps executed: 236 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 200.42
I0902 17:59:02.455199 139702310836224 replay_runner.py:36] Average training steps per second: 200.42
I0902 17:59:02.645113 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 23

Steps executed: 251 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 212.55
I0902 17:59:07.579583 139702310836224 replay_runner.py:36] Average training steps per second: 212.55
I0902 17:59:07.797492 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 24

Steps executed: 219 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 197.19
I0902 17:59:13.123990 139702310836224 replay_runner.py:36] Average training steps per second: 197.19
I0902 17:59:13.290294 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 25

Steps executed: 267 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 207.55
I0902 17:59:18.333632 139702310836224 replay_runner.py:36] Average training steps per second: 207.55
I0902 17:59:18.555700 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 26

Steps executed: 196 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 203.20
I0902 17:59:23.772404 139702310836224 replay_runner.py:36] Average training steps per second: 203.20

Steps executed: 306 Episode length: 110 Return: -109.0
INFO:tensorflow:Starting iteration 27

Steps executed: 284 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 202.23
I0902 17:59:29.204611 139702310836224 replay_runner.py:36] Average training steps per second: 202.23
I0902 17:59:29.435564 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 28

Steps executed: 207 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 204.68
I0902 17:59:34.576300 139702310836224 replay_runner.py:36] Average training steps per second: 204.68
I0902 17:59:34.738055 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.50
INFO:tensorflow:Starting iteration 29
I0902 17:59:34.977839 139702310836224 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 195.88

Done fixed training!Episode length: 133 Return: -132.0
I0902 17:59:40.280095 139702310836224 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00