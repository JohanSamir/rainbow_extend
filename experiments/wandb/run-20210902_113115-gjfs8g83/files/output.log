Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 11:31:21.034873 139870285514752 run_experiment.py:549] Creating TrainRunner ...
I0902 11:31:21.041910 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:21.042033 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:21.042105 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:21.042184 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:21.042240 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:21.042316 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:21.042379 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:21.042444 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:21.042515 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:21.042571 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:21.042763 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:21.042855 139870285514752 dqn_agent.py:283] 	 seed: 1630582281041879
I0902 11:31:21.044947 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:21.045059 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:21.045136 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:21.045217 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:21.045411 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:21.045508 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:21.045619 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:21.045717 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:21.045808 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:21.194617 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:21.451953 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:21.460983 139870285514752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:31:21.467135 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:21.467297 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:21.467395 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:21.467466 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:21.467530 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:21.467592 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:21.467689 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:21.467766 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:21.467828 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:21.467895 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:21.467977 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:21.468062 139870285514752 dqn_agent.py:283] 	 seed: 1630582281467099
I0902 11:31:21.470218 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:21.470337 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:21.470411 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:21.470474 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:21.470554 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:21.470662 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:21.470737 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:21.470860 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:21.470966 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:21.502881 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:21.520153 139870285514752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:31:21.520321 139870285514752 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 219.03
I0902 11:31:26.086049 139870285514752 replay_runner.py:36] Average training steps per second: 219.03
Steps executed: 256 Episode length: 256 Return: -147.67096076098642
I0902 11:31:27.104199 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.67
INFO:tensorflow:Starting iteration 1
I0902 11:31:30.517122 139870285514752 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 347.33
I0902 11:31:33.396512 139870285514752 replay_runner.py:36] Average training steps per second: 347.33

Steps executed: 210 Episode length: 210 Return: -185.36629324681354
INFO:tensorflow:Starting iteration 2
I0902 11:31:36.968701 139870285514752 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 342.94

Steps executed: 1000 Episode length: 1000 Return: -58.055855157990145
I0902 11:31:42.658801 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.06
INFO:tensorflow:Starting iteration 3

Steps executed: 234 Episode length: 234 Return: -228.9223457580386345
INFO:tensorflow:Average training steps per second: 338.43
I0902 11:31:49.020236 139870285514752 replay_runner.py:36] Average training steps per second: 338.43
I0902 11:31:49.220402 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.92
INFO:tensorflow:Starting iteration 4
I0902 11:31:52.635956 139870285514752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 348.74

Steps executed: 1000 Episode length: 1000 Return: -105.47237874486048
I0902 11:31:57.383068 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.47
INFO:tensorflow:Starting iteration 5
I0902 11:32:00.867086 139870285514752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 364.16

Steps executed: 756 Episode length: 756 Return: -293.6835168335019048
I0902 11:32:05.114838 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.68
INFO:tensorflow:Starting iteration 6
I0902 11:32:08.573091 139870285514752 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 357.86

Steps executed: 798 Episode length: 798 Return: -289.4655055369765048
I0902 11:32:13.014367 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.47
INFO:tensorflow:Starting iteration 7

Steps executed: 241 Episode length: 119 Return: -303.8883238722133048
INFO:tensorflow:Average training steps per second: 343.87
I0902 11:32:19.338639 139870285514752 replay_runner.py:36] Average training steps per second: 343.87
I0902 11:32:19.499981 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.32
INFO:tensorflow:Starting iteration 8

Steps executed: 516 Episode length: 516 Return: -215.2453978667846948
INFO:tensorflow:Average training steps per second: 344.25
I0902 11:32:25.813568 139870285514752 replay_runner.py:36] Average training steps per second: 344.25
I0902 11:32:26.451900 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.25
INFO:tensorflow:Starting iteration 9
I0902 11:32:29.836811 139870285514752 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 352.40

Steps executed: 449 Episode length: 449 Return: -210.8224580865364748
I0902 11:32:33.195816 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.82
INFO:tensorflow:Starting iteration 10
I0902 11:32:36.533421 139870285514752 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 323.88

Steps executed: 1000 Episode length: 1000 Return: -726.75147055714518
I0902 11:32:41.133868 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -726.75
INFO:tensorflow:Starting iteration 11
I0902 11:32:44.428774 139870285514752 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 335.64

Steps executed: 1000 Episode length: 1000 Return: -212.87189781222943
I0902 11:32:49.586267 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.87
INFO:tensorflow:Starting iteration 12

Steps executed: 612 Episode length: 612 Return: -164.8045285911714543
INFO:tensorflow:Average training steps per second: 338.48
I0902 11:32:55.921302 139870285514752 replay_runner.py:36] Average training steps per second: 338.48
I0902 11:32:56.610265 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.80
INFO:tensorflow:Starting iteration 13
I0902 11:32:59.983494 139870285514752 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 323.96

Steps executed: 1000 Episode length: 1000 Return: -204.94121040563482
I0902 11:33:04.738434 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.94
INFO:tensorflow:Starting iteration 14
I0902 11:33:08.063426 139870285514752 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 311.82

Steps executed: 213 Episode length: 213 Return: -171.9826362588811482
I0902 11:33:11.441501 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.98
INFO:tensorflow:Starting iteration 15
I0902 11:33:14.655881 139870285514752 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 327.98

Steps executed: 1000 Episode length: 1000 Return: 113.630154140257562
I0902 11:33:19.435971 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.63
INFO:tensorflow:Starting iteration 16

Steps executed: 415 Episode length: 415 Return: -236.2639427084184362
INFO:tensorflow:Average training steps per second: 315.25
I0902 11:33:25.922295 139870285514752 replay_runner.py:36] Average training steps per second: 315.25
I0902 11:33:26.332297 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.26
INFO:tensorflow:Starting iteration 17
I0902 11:33:29.575201 139870285514752 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 316.81

Steps executed: 800 Episode length: 800 Return: -487.3653591008127362
I0902 11:33:33.874060 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.37
INFO:tensorflow:Starting iteration 18

Steps executed: 294 Episode length: 294 Return: -23.64807990653381362
INFO:tensorflow:Average training steps per second: 313.82
I0902 11:33:40.321206 139870285514752 replay_runner.py:36] Average training steps per second: 313.82
I0902 11:33:40.580730 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -23.65
INFO:tensorflow:Starting iteration 19
I0902 11:33:43.893014 139870285514752 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 321.86

Steps executed: 1000 Episode length: 1000 Return: -216.10183299273993
I0902 11:33:49.836018 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.10
INFO:tensorflow:Starting iteration 20

Steps executed: 314 Episode length: 314 Return: -6.184503480335067993
INFO:tensorflow:Average training steps per second: 325.32
I0902 11:33:56.300338 139870285514752 replay_runner.py:36] Average training steps per second: 325.32
I0902 11:33:56.615457 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -6.18
INFO:tensorflow:Starting iteration 21
I0902 11:33:59.960087 139870285514752 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 317.34

Steps executed: 490 Episode length: 490 Return: -279.6479299317035993
I0902 11:34:03.793014 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.65
INFO:tensorflow:Starting iteration 22

Steps executed: 547 Episode length: 547 Return: -529.9804017209611993
INFO:tensorflow:Average training steps per second: 336.04
I0902 11:34:10.166144 139870285514752 replay_runner.py:36] Average training steps per second: 336.04
I0902 11:34:11.017861 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.98
INFO:tensorflow:Starting iteration 23
I0902 11:34:14.448115 139870285514752 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 359.07

Steps executed: 1000 Episode length: 1000 Return: -39.397792276758893
I0902 11:34:18.798690 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -39.40
INFO:tensorflow:Starting iteration 24
I0902 11:34:22.209081 139870285514752 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 348.17

Steps executed: 513 Episode length: 357 Return: -484.4470555206614893
I0902 11:34:25.532286 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.63
INFO:tensorflow:Starting iteration 25
I0902 11:34:29.015440 139870285514752 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 356.83
I0902 11:34:31.818152 139870285514752 replay_runner.py:36] Average training steps per second: 356.83

Steps executed: 1000 Episode length: 1000 Return: -94.710428121727523
INFO:tensorflow:Starting iteration 26

Steps executed: 1000 Episode length: 1000 Return: -273.19542213879923
INFO:tensorflow:Average training steps per second: 319.08
I0902 11:34:41.450080 139870285514752 replay_runner.py:36] Average training steps per second: 319.08
I0902 11:34:42.971426 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.20
INFO:tensorflow:Starting iteration 27
I0902 11:34:46.119809 139870285514752 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 314.31

Steps executed: 705 Episode length: 705 Return: 178.63249008010274923
I0902 11:34:50.177513 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.63
INFO:tensorflow:Starting iteration 28

Steps executed: 210 Episode length: 210 Return: -1.975268295920969323
INFO:tensorflow:Average training steps per second: 326.50
I0902 11:34:56.459336 139870285514752 replay_runner.py:36] Average training steps per second: 326.50
I0902 11:34:56.599668 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -1.98
INFO:tensorflow:Starting iteration 29

Steps executed: 435 Episode length: 435 Return: 23.420286785583627323
INFO:tensorflow:Average training steps per second: 339.25
I0902 11:35:02.759924 139870285514752 replay_runner.py:36] Average training steps per second: 339.25

Done fixed training!Episode length: 435 Return: 23.420286785583627323