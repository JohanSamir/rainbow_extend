Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 12:30:49.726361 139809518303232 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:49.737727 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:49.737972 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:49.738236 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:49.738575 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:49.738937 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:49.739076 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:49.739274 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:49.739431 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:49.739678 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:49.739839 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:49.740048 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:49.740184 139809518303232 dqn_agent.py:283] 	 seed: 1630499449737662
I0901 12:30:49.743849 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:49.744138 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:49.744324 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:49.744468 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:49.744676 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:49.744854 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:49.745082 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:49.745247 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:49.745402 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:49.951956 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:50.365887 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:50.379799 139809518303232 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:50.390646 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:50.390872 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:50.390983 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:50.391147 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:50.391292 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:50.391416 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:50.391546 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:50.391752 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:50.391854 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:50.392030 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:50.392172 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:50.392287 139809518303232 dqn_agent.py:283] 	 seed: 1630499450390588
I0901 12:30:50.394956 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:50.395128 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:50.395236 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:50.395390 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:50.395512 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:50.395622 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:50.395734 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:50.395949 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:50.396095 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:50.432505 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:50.456209 139809518303232 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:50.456578 139809518303232 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.03
I0901 12:30:56.553541 139809518303232 replay_runner.py:36] Average training steps per second: 164.03
Steps executed: 254 Episode length: 96 Return: -448.5287770679071
I0901 12:30:57.781470 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.19
INFO:tensorflow:Starting iteration 1

Steps executed: 255 Episode length: 121 Return: -388.55814001369683
INFO:tensorflow:Average training steps per second: 229.18
I0901 12:31:06.455259 139809518303232 replay_runner.py:36] Average training steps per second: 229.18
I0901 12:31:06.688374 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.55
INFO:tensorflow:Starting iteration 2

Steps executed: 232 Episode length: 110 Return: -278.93153634900833
INFO:tensorflow:Average training steps per second: 217.32
I0901 12:31:15.697710 139809518303232 replay_runner.py:36] Average training steps per second: 217.32
I0901 12:31:15.891967 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.56
INFO:tensorflow:Starting iteration 3

Steps executed: 240 Episode length: 124 Return: -140.92480198080252
INFO:tensorflow:Average training steps per second: 228.65
I0901 12:31:24.669817 139809518303232 replay_runner.py:36] Average training steps per second: 228.65
I0901 12:31:24.872856 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.37
INFO:tensorflow:Starting iteration 4
I0901 12:31:29.231157 139809518303232 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 233.43

Steps executed: 216 Episode length: 125 Return: -196.46823209862197
I0901 12:31:33.709653 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.45
INFO:tensorflow:Starting iteration 5

Steps executed: 272 Episode length: 135 Return: 15.3637456476543464
INFO:tensorflow:Average training steps per second: 224.93
I0901 12:31:42.473847 139809518303232 replay_runner.py:36] Average training steps per second: 224.93
I0901 12:31:42.724098 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -47.31
INFO:tensorflow:Starting iteration 6
I0901 12:31:47.207333 139809518303232 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 227.81

Steps executed: 277 Episode length: 106 Return: -270.91072267280356
I0901 12:31:51.830224 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.87
INFO:tensorflow:Starting iteration 7

Steps executed: 373 Episode length: 277 Return: 180.372116919204076
INFO:tensorflow:Average training steps per second: 221.89
I0901 12:32:00.739379 139809518303232 replay_runner.py:36] Average training steps per second: 221.89
I0901 12:32:01.149707 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.12
INFO:tensorflow:Starting iteration 8

Steps executed: 257 Episode length: 132 Return: -54.466967279417436
INFO:tensorflow:Average training steps per second: 220.64
I0901 12:32:09.989357 139809518303232 replay_runner.py:36] Average training steps per second: 220.64
I0901 12:32:10.222480 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.41
INFO:tensorflow:Starting iteration 9

Steps executed: 362 Episode length: 362 Return: -423.31324048739106
INFO:tensorflow:Average training steps per second: 226.82
I0901 12:32:19.101603 139809518303232 replay_runner.py:36] Average training steps per second: 226.82
I0901 12:32:19.585311 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.31
INFO:tensorflow:Starting iteration 10

Steps executed: 275 Episode length: 139 Return: -322.29967739410563
INFO:tensorflow:Average training steps per second: 223.75
I0901 12:32:28.459020 139809518303232 replay_runner.py:36] Average training steps per second: 223.75
I0901 12:32:28.744693 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.24
INFO:tensorflow:Starting iteration 11

Steps executed: 197 Episode length: 103 Return: 34.1099854798903863
INFO:tensorflow:Average training steps per second: 224.14
I0901 12:32:37.667494 139809518303232 replay_runner.py:36] Average training steps per second: 224.14

Steps executed: 277 Episode length: 80 Return: -241.524200427773683
INFO:tensorflow:Starting iteration 12

Steps executed: 306 Episode length: 112 Return: -252.66493266869974
INFO:tensorflow:Average training steps per second: 220.28
I0901 12:32:46.824373 139809518303232 replay_runner.py:36] Average training steps per second: 220.28
I0901 12:32:47.116938 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.66
INFO:tensorflow:Starting iteration 13

Steps executed: 287 Episode length: 102 Return: -502.67367649722434
INFO:tensorflow:Average training steps per second: 218.44
I0901 12:32:56.170041 139809518303232 replay_runner.py:36] Average training steps per second: 218.44
I0901 12:32:56.395894 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.60
INFO:tensorflow:Starting iteration 14

Steps executed: 250 Episode length: 87 Return: -405.092025934259944
INFO:tensorflow:Average training steps per second: 221.82
I0901 12:33:05.192840 139809518303232 replay_runner.py:36] Average training steps per second: 221.82
I0901 12:33:05.387123 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.63
INFO:tensorflow:Starting iteration 15

Steps executed: 210 Episode length: 131 Return: -47.320919558573365
INFO:tensorflow:Average training steps per second: 220.32
I0901 12:33:14.406145 139809518303232 replay_runner.py:36] Average training steps per second: 220.32
I0901 12:33:14.595419 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.82
INFO:tensorflow:Starting iteration 16
I0901 12:33:19.072236 139809518303232 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 220.71
I0901 12:33:23.603414 139809518303232 replay_runner.py:36] Average training steps per second: 220.71

Steps executed: 216 Episode length: 67 Return: -129.294232183533535
INFO:tensorflow:Starting iteration 17

Steps executed: 264 Episode length: 65 Return: -248.972604773970775
INFO:tensorflow:Average training steps per second: 220.35
I0901 12:33:32.604699 139809518303232 replay_runner.py:36] Average training steps per second: 220.35
I0901 12:33:32.803515 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.04
INFO:tensorflow:Starting iteration 18
I0901 12:33:37.274677 139809518303232 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 226.34

Steps executed: 216 Episode length: 67 Return: -301.351156181388985
I0901 12:33:41.886875 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.45
INFO:tensorflow:Starting iteration 19

Steps executed: 231 Episode length: 231 Return: -537.59371525927255
INFO:tensorflow:Average training steps per second: 217.80
I0901 12:33:50.875938 139809518303232 replay_runner.py:36] Average training steps per second: 217.80
I0901 12:33:51.154370 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.59
INFO:tensorflow:Starting iteration 20

Steps executed: 371 Episode length: 261 Return: -389.77781488314423
INFO:tensorflow:Average training steps per second: 226.23
I0901 12:33:59.978017 139809518303232 replay_runner.py:36] Average training steps per second: 226.23
I0901 12:34:00.363672 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.97
INFO:tensorflow:Starting iteration 21

Steps executed: 321 Episode length: 141 Return: -666.80527366386753
INFO:tensorflow:Average training steps per second: 223.72
I0901 12:34:09.085868 139809518303232 replay_runner.py:36] Average training steps per second: 223.72
I0901 12:34:09.437900 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -683.53
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 132 Return: -376.09232128170224
INFO:tensorflow:Average training steps per second: 217.23
I0901 12:34:18.450839 139809518303232 replay_runner.py:36] Average training steps per second: 217.23
I0901 12:34:18.708506 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.97
INFO:tensorflow:Starting iteration 23

Steps executed: 82 Episode length: 82 Return: -145.7292430050205824
INFO:tensorflow:Average training steps per second: 215.59

Steps executed: 206 Episode length: 124 Return: -203.86192786020797
I0901 12:34:27.990072 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.80
INFO:tensorflow:Starting iteration 24

Steps executed: 265 Episode length: 85 Return: -613.731349460973997
INFO:tensorflow:Average training steps per second: 225.01
I0901 12:34:36.750304 139809518303232 replay_runner.py:36] Average training steps per second: 225.01
I0901 12:34:37.004336 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -638.54
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 165 Return: -229.00955119472857
INFO:tensorflow:Average training steps per second: 218.06
I0901 12:34:46.146149 139809518303232 replay_runner.py:36] Average training steps per second: 218.06
I0901 12:34:46.364274 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.44
INFO:tensorflow:Starting iteration 26

Steps executed: 225 Episode length: 78 Return: -460.080328743652177
INFO:tensorflow:Average training steps per second: 208.55
I0901 12:34:55.477709 139809518303232 replay_runner.py:36] Average training steps per second: 208.55
I0901 12:34:55.664391 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.99
INFO:tensorflow:Starting iteration 27

Steps executed: 323 Episode length: 162 Return: -352.02273310128177
INFO:tensorflow:Average training steps per second: 214.02
I0901 12:35:04.624037 139809518303232 replay_runner.py:36] Average training steps per second: 214.02
I0901 12:35:04.993321 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.41
INFO:tensorflow:Starting iteration 28
I0901 12:35:09.405972 139809518303232 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 209.43

Steps executed: 293 Episode length: 149 Return: -237.21991139256347
I0901 12:35:14.462662 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.93
INFO:tensorflow:Starting iteration 29

Steps executed: 315 Episode length: 249 Return: -751.51086367386267
INFO:tensorflow:Average training steps per second: 210.96
I0901 12:35:23.232374 139809518303232 replay_runner.py:36] Average training steps per second: 210.96

Done fixed training!Episode length: 249 Return: -751.51086367386267