I0901 13:22:36.963533 140265790818304 run_experiment.py:549] Creating TrainRunner ...
I0901 13:22:36.971853 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:36.972016 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:36.972100 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:36.972173 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:36.972235 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:36.972363 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:36.972473 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:36.972562 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:36.972636 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:36.972720 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:36.972795 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:36.972868 140265790818304 dqn_agent.py:283] 	 seed: 1630502556971811
I0901 13:22:36.974677 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:36.974823 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:36.974910 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:36.974989 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:36.975053 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:36.975120 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:36.975198 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:36.975287 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:36.975361 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:37.092031 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:37.349938 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:37.359457 140265790818304 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:22:37.366492 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:37.366659 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:37.366756 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:37.366837 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:37.366953 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:37.367031 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:37.367114 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:37.367180 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:37.367257 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:37.367327 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:37.367405 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:37.367465 140265790818304 dqn_agent.py:283] 	 seed: 1630502557366453
I0901 13:22:37.368860 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:37.368983 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:37.369055 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:37.369116 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:37.369173 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:37.369230 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:37.369304 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:37.369379 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:37.369432 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:37.393363 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:37.409393 140265790818304 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:22:37.409584 140265790818304 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 220.33
I0901 13:22:41.948874 140265790818304 replay_runner.py:36] Average training steps per second: 220.33
Steps executed: 258 Episode length: 132 Return: -245.84460465245297
I0901 13:22:42.650742 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.37
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 112 Return: -226.42863941036666
INFO:tensorflow:Average training steps per second: 339.11
I0901 13:22:48.917455 140265790818304 replay_runner.py:36] Average training steps per second: 339.11
I0901 13:22:49.030972 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.20
INFO:tensorflow:Starting iteration 2

Steps executed: 317 Episode length: 149 Return: -399.76771605113637
INFO:tensorflow:Average training steps per second: 328.85
I0901 13:22:55.375461 140265790818304 replay_runner.py:36] Average training steps per second: 328.85
I0901 13:22:55.561387 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.50
INFO:tensorflow:Starting iteration 3

Steps executed: 254 Episode length: 120 Return: -430.33062537088966
INFO:tensorflow:Average training steps per second: 332.14
I0901 13:23:01.903503 140265790818304 replay_runner.py:36] Average training steps per second: 332.14
I0901 13:23:02.031325 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.51
INFO:tensorflow:Starting iteration 4

Steps executed: 321 Episode length: 146 Return: -281.05800691116247
INFO:tensorflow:Average training steps per second: 316.43
I0901 13:23:08.476945 140265790818304 replay_runner.py:36] Average training steps per second: 316.43
I0901 13:23:08.641608 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.72
INFO:tensorflow:Starting iteration 5

Steps executed: 227 Episode length: 111 Return: -218.76915179042945
INFO:tensorflow:Average training steps per second: 301.97
I0901 13:23:15.310585 140265790818304 replay_runner.py:36] Average training steps per second: 301.97
I0901 13:23:15.440831 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.58
INFO:tensorflow:Starting iteration 6

Steps executed: 247 Episode length: 164 Return: -181.22600065222435
INFO:tensorflow:Average training steps per second: 313.15
I0901 13:23:22.000323 140265790818304 replay_runner.py:36] Average training steps per second: 313.15
I0901 13:23:22.151833 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.17
INFO:tensorflow:Starting iteration 7

Steps executed: 261 Episode length: 108 Return: -279.91062346889754
INFO:tensorflow:Average training steps per second: 317.73
I0901 13:23:28.713505 140265790818304 replay_runner.py:36] Average training steps per second: 317.73
I0901 13:23:28.866618 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.00
INFO:tensorflow:Starting iteration 8

Steps executed: 305 Episode length: 209 Return: -102.12601769944013
INFO:tensorflow:Average training steps per second: 317.56
I0901 13:23:35.397991 140265790818304 replay_runner.py:36] Average training steps per second: 317.56
I0901 13:23:35.652738 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 9

Steps executed: 276 Episode length: 96 Return: 25.39748469259879553
INFO:tensorflow:Average training steps per second: 320.07
I0901 13:23:42.160213 140265790818304 replay_runner.py:36] Average training steps per second: 320.07
I0901 13:23:42.326983 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -48.72
INFO:tensorflow:Starting iteration 10

Steps executed: 148 Episode length: 68 Return: -6.97479505138652253
INFO:tensorflow:Average training steps per second: 331.65

Steps executed: 450 Episode length: 302 Return: -1265.1037306049573
I0901 13:23:49.216012 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.00
INFO:tensorflow:Starting iteration 11

Steps executed: 864 Episode length: 676 Return: -161.31541252354663
INFO:tensorflow:Average training steps per second: 330.02
I0901 13:23:55.728157 140265790818304 replay_runner.py:36] Average training steps per second: 330.02
I0901 13:23:56.767382 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.10
INFO:tensorflow:Starting iteration 12

Steps executed: 379 Episode length: 379 Return: -500.02617602754657
INFO:tensorflow:Average training steps per second: 314.75
I0901 13:24:03.392591 140265790818304 replay_runner.py:36] Average training steps per second: 314.75
I0901 13:24:03.807792 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.03
INFO:tensorflow:Starting iteration 13

Steps executed: 205 Episode length: 84 Return: -120.966693814279817
INFO:tensorflow:Average training steps per second: 316.82
I0901 13:24:10.388474 140265790818304 replay_runner.py:36] Average training steps per second: 316.82
I0901 13:24:10.479117 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.07
INFO:tensorflow:Starting iteration 14

Steps executed: 237 Episode length: 65 Return: -367.008881238675117
INFO:tensorflow:Average training steps per second: 328.65
I0901 13:24:16.955425 140265790818304 replay_runner.py:36] Average training steps per second: 328.65
I0901 13:24:17.113896 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.77
INFO:tensorflow:Starting iteration 15

Steps executed: 234 Episode length: 147 Return: -523.85957377188457
INFO:tensorflow:Average training steps per second: 332.36
I0901 13:24:23.616930 140265790818304 replay_runner.py:36] Average training steps per second: 332.36
I0901 13:24:23.780824 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.07
INFO:tensorflow:Starting iteration 16

Steps executed: 253 Episode length: 253 Return: -446.54950311490046
INFO:tensorflow:Average training steps per second: 338.26
I0901 13:24:30.276186 140265790818304 replay_runner.py:36] Average training steps per second: 338.26
I0901 13:24:30.496379 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.55
INFO:tensorflow:Starting iteration 17

Steps executed: 236 Episode length: 115 Return: -465.49059445025944
INFO:tensorflow:Average training steps per second: 343.80
I0901 13:24:37.008396 140265790818304 replay_runner.py:36] Average training steps per second: 343.80
I0901 13:24:37.156486 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.30
INFO:tensorflow:Starting iteration 18

Steps executed: 211 Episode length: 80 Return: -226.903240984443334
INFO:tensorflow:Average training steps per second: 344.66
I0901 13:24:43.686735 140265790818304 replay_runner.py:36] Average training steps per second: 344.66
I0901 13:24:43.802397 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.55
INFO:tensorflow:Starting iteration 19

Steps executed: 279 Episode length: 112 Return: -712.27289917709853
INFO:tensorflow:Average training steps per second: 340.67
I0901 13:24:50.326630 140265790818304 replay_runner.py:36] Average training steps per second: 340.67
I0901 13:24:50.483468 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.40
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 114 Return: -1049.7926438903169
INFO:tensorflow:Average training steps per second: 318.57
I0901 13:24:57.165004 140265790818304 replay_runner.py:36] Average training steps per second: 318.57
I0901 13:24:57.312787 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.39
INFO:tensorflow:Starting iteration 21

Steps executed: 250 Episode length: 58 Return: -222.057905300582569
INFO:tensorflow:Average training steps per second: 328.85
I0901 13:25:03.904163 140265790818304 replay_runner.py:36] Average training steps per second: 328.85
I0901 13:25:04.051366 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.08
INFO:tensorflow:Starting iteration 22

Steps executed: 251 Episode length: 60 Return: -86.8391290598753289
INFO:tensorflow:Average training steps per second: 329.71
I0901 13:25:10.630181 140265790818304 replay_runner.py:36] Average training steps per second: 329.71
I0901 13:25:10.791748 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.49
INFO:tensorflow:Starting iteration 23

Steps executed: 292 Episode length: 108 Return: -401.13693006754573
INFO:tensorflow:Average training steps per second: 325.56
I0901 13:25:17.383373 140265790818304 replay_runner.py:36] Average training steps per second: 325.56
I0901 13:25:17.561447 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.55
INFO:tensorflow:Starting iteration 24

Steps executed: 226 Episode length: 66 Return: -185.695917641570643
INFO:tensorflow:Average training steps per second: 322.89
I0901 13:25:24.154710 140265790818304 replay_runner.py:36] Average training steps per second: 322.89
I0901 13:25:24.292214 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.44
INFO:tensorflow:Starting iteration 25

Steps executed: 256 Episode length: 103 Return: -662.29167518669423
INFO:tensorflow:Average training steps per second: 322.63
I0901 13:25:30.911695 140265790818304 replay_runner.py:36] Average training steps per second: 322.63
I0901 13:25:31.068067 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.71
INFO:tensorflow:Starting iteration 26

Steps executed: 251 Episode length: 88 Return: -495.532646674184333
INFO:tensorflow:Average training steps per second: 318.22
I0901 13:25:37.673363 140265790818304 replay_runner.py:36] Average training steps per second: 318.22
I0901 13:25:37.825690 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.77
INFO:tensorflow:Starting iteration 27

Steps executed: 287 Episode length: 96 Return: -271.102100656931953
INFO:tensorflow:Average training steps per second: 307.71
I0901 13:25:44.508730 140265790818304 replay_runner.py:36] Average training steps per second: 307.71
I0901 13:25:44.678044 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.57
INFO:tensorflow:Starting iteration 28
I0901 13:25:48.148447 140265790818304 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 312.72

Steps executed: 241 Episode length: 94 Return: -506.522467036842673
I0901 13:25:51.503512 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.57
INFO:tensorflow:Starting iteration 29

Steps executed: 272 Episode length: 107 Return: -466.41585059203513
INFO:tensorflow:Average training steps per second: 314.85
I0901 13:25:57.993751 140265790818304 replay_runner.py:36] Average training steps per second: 314.85

Done fixed training!Episode length: 107 Return: -466.41585059203513