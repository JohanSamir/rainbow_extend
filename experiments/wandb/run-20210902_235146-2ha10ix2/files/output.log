Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0902 23:51:52.698811 139766973487104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:51:52.709282 139766973487104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:52.709511 139766973487104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:52.709612 139766973487104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:52.709696 139766973487104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:52.709807 139766973487104 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:52.709919 139766973487104 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:51:52.710037 139766973487104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:52.710116 139766973487104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:52.710181 139766973487104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:52.710265 139766973487104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:52.710357 139766973487104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:52.710479 139766973487104 dqn_agent.py:283] 	 seed: 1630626712709197
I0902 23:51:52.714207 139766973487104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:52.714472 139766973487104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:51:52.714632 139766973487104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:52.714791 139766973487104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:52.714875 139766973487104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:52.714975 139766973487104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:52.715244 139766973487104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:52.715361 139766973487104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:52.715593 139766973487104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:52.756146 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:53.292982 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:53.308740 139766973487104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:51:53.319613 139766973487104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:53.319934 139766973487104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:53.320267 139766973487104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:53.320474 139766973487104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:53.320637 139766973487104 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:53.320774 139766973487104 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:51:53.320879 139766973487104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:53.320988 139766973487104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:53.321129 139766973487104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:53.321218 139766973487104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:53.321289 139766973487104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:53.321357 139766973487104 dqn_agent.py:283] 	 seed: 1630626713319547
I0902 23:51:53.323890 139766973487104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:53.324094 139766973487104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:51:53.324342 139766973487104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:53.324505 139766973487104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:53.324637 139766973487104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:53.324757 139766973487104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:53.324890 139766973487104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:53.325007 139766973487104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:53.325119 139766973487104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:53.357600 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:53.380237 139766973487104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:51:53.380710 139766973487104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 141.28
I0902 23:52:00.459289 139766973487104 replay_runner.py:36] Average training steps per second: 141.28
Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:52:01.656241 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 1

Steps executed: 276 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 201.12
I0902 23:52:06.818340 139766973487104 replay_runner.py:36] Average training steps per second: 201.12
I0902 23:52:06.998438 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 2

Steps executed: 208 Episode length: 26 Return: 26.0.0
INFO:tensorflow:Average training steps per second: 200.80
I0902 23:52:12.158079 139766973487104 replay_runner.py:36] Average training steps per second: 200.80
I0902 23:52:12.295114 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 34.67
INFO:tensorflow:Starting iteration 3

Steps executed: 217 Episode length: 114 Return: 114.0
INFO:tensorflow:Average training steps per second: 191.94
I0902 23:52:17.688790 139766973487104 replay_runner.py:36] Average training steps per second: 191.94
I0902 23:52:17.831978 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.50
INFO:tensorflow:Starting iteration 4

Steps executed: 220 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 200.16
I0902 23:52:23.008755 139766973487104 replay_runner.py:36] Average training steps per second: 200.16
I0902 23:52:23.157462 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.00
INFO:tensorflow:Starting iteration 5
I0902 23:52:23.338213 139766973487104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.10

Steps executed: 308 Episode length: 157 Return: 157.0
I0902 23:52:28.851752 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 6

Steps executed: 303 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 204.19
I0902 23:52:33.937254 139766973487104 replay_runner.py:36] Average training steps per second: 204.19
I0902 23:52:34.145161 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 7

Steps executed: 331 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 194.42
I0902 23:52:39.479611 139766973487104 replay_runner.py:36] Average training steps per second: 194.42
I0902 23:52:39.701355 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 8

Steps executed: 326 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 204.28
I0902 23:52:44.891432 139766973487104 replay_runner.py:36] Average training steps per second: 204.28
I0902 23:52:45.112412 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 9

Steps executed: 147 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 202.36
I0902 23:52:50.243944 139766973487104 replay_runner.py:36] Average training steps per second: 202.36

Steps executed: 293 Episode length: 146 Return: 146.0
INFO:tensorflow:Starting iteration 10

Steps executed: 287 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 207.40
I0902 23:52:55.433451 139766973487104 replay_runner.py:36] Average training steps per second: 207.40
I0902 23:52:55.621782 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.50
INFO:tensorflow:Starting iteration 11

Steps executed: 268 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 203.55
I0902 23:53:00.727504 139766973487104 replay_runner.py:36] Average training steps per second: 203.55
I0902 23:53:00.919165 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 12

Steps executed: 271 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 197.11
I0902 23:53:06.171125 139766973487104 replay_runner.py:36] Average training steps per second: 197.11
I0902 23:53:06.353133 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.50
INFO:tensorflow:Starting iteration 13

Steps executed: 292 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 200.16
I0902 23:53:11.542099 139766973487104 replay_runner.py:36] Average training steps per second: 200.16
I0902 23:53:11.743132 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.47
I0902 23:53:16.997324 139766973487104 replay_runner.py:36] Average training steps per second: 197.47
I0902 23:53:17.137157 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 255 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 200.21
I0902 23:53:22.316556 139766973487104 replay_runner.py:36] Average training steps per second: 200.21
I0902 23:53:22.495230 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.20
I0902 23:53:27.706563 139766973487104 replay_runner.py:36] Average training steps per second: 199.20
I0902 23:53:27.843721 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 339 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.78
I0902 23:53:33.190254 139766973487104 replay_runner.py:36] Average training steps per second: 193.78
I0902 23:53:33.432202 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.18
I0902 23:53:38.629975 139766973487104 replay_runner.py:36] Average training steps per second: 199.18
I0902 23:53:38.760903 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 367 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 190.71
I0902 23:53:44.191081 139766973487104 replay_runner.py:36] Average training steps per second: 190.71
I0902 23:53:44.446009 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.69
I0902 23:53:49.628289 139766973487104 replay_runner.py:36] Average training steps per second: 200.69
I0902 23:53:49.769500 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:53:49.959816 139766973487104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 184.65
I0902 23:53:55.375914 139766973487104 replay_runner.py:36] Average training steps per second: 184.65
I0902 23:53:55.513792 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:53:55.701750 139766973487104 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.99
I0902 23:54:00.804593 139766973487104 replay_runner.py:36] Average training steps per second: 195.99
I0902 23:54:00.948676 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:54:01.146466 139766973487104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.27
I0902 23:54:06.216228 139766973487104 replay_runner.py:36] Average training steps per second: 197.27
I0902 23:54:06.355253 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:54:06.570311 139766973487104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 192.65
I0902 23:54:11.761544 139766973487104 replay_runner.py:36] Average training steps per second: 192.65
I0902 23:54:11.897714 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:54:12.080535 139766973487104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.55
I0902 23:54:17.042447 139766973487104 replay_runner.py:36] Average training steps per second: 201.55
I0902 23:54:17.180485 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:54:17.367373 139766973487104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.09
I0902 23:54:22.520004 139766973487104 replay_runner.py:36] Average training steps per second: 194.09
I0902 23:54:22.657016 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:54:22.835948 139766973487104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.73
I0902 23:54:27.919325 139766973487104 replay_runner.py:36] Average training steps per second: 196.73
I0902 23:54:28.066333 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:54:28.260227 139766973487104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 192.84
I0902 23:54:33.446287 139766973487104 replay_runner.py:36] Average training steps per second: 192.84
I0902 23:54:33.593877 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.54
I0902 23:54:39.159778 139766973487104 replay_runner.py:36] Average training steps per second: 190.54
I0902 23:54:39.427395 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00