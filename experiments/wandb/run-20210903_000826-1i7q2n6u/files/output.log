Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0903 00:08:32.505481 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0903 00:08:32.514536 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:08:32.514699 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:08:32.514819 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:08:32.514929 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:08:32.515021 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:08:32.515110 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:08:32.515174 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:08:32.515232 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:08:32.515307 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:08:32.515364 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:08:32.515420 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:08:32.515496 139819819333632 dqn_agent.py:283] 	 seed: 1630627712514495
I0903 00:08:32.517691 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:08:32.517837 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:08:32.517925 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:08:32.517998 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:08:32.518061 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:08:32.518125 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:08:32.518200 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:08:32.518289 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:08:32.518379 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:08:32.546033 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:32.820688 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:32.830942 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:08:32.837620 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:08:32.837796 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:08:32.837877 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:08:32.837946 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:08:32.838008 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:08:32.838089 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:08:32.838195 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:08:32.838265 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:08:32.838352 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:08:32.838424 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:08:32.838504 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:08:32.838586 139819819333632 dqn_agent.py:283] 	 seed: 1630627712837584
I0903 00:08:32.841147 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:08:32.841320 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:08:32.841416 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:08:32.841501 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:08:32.841606 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:08:32.841822 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:08:32.841921 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:08:32.841995 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:08:32.842103 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:08:32.864413 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:32.880054 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:08:32.880247 139819819333632 replay_runner.py:41] Starting iteration 0
Steps executed: 267 Episode length: 148 Return: -374.78882070649587
INFO:tensorflow:Average training steps per second: 270.53
I0903 00:08:36.576874 139819819333632 replay_runner.py:36] Average training steps per second: 270.53
I0903 00:08:37.378372 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.63
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 93 Return: -445.199218723634548
INFO:tensorflow:Average training steps per second: 358.38
I0903 00:08:43.714770 139819819333632 replay_runner.py:36] Average training steps per second: 358.38
I0903 00:08:43.816395 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.57
INFO:tensorflow:Starting iteration 2

Steps executed: 269 Episode length: 145 Return: -82.507797336309556
INFO:tensorflow:Average training steps per second: 347.88
I0903 00:08:50.247150 139819819333632 replay_runner.py:36] Average training steps per second: 347.88
I0903 00:08:50.385257 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.47
INFO:tensorflow:Starting iteration 3

Steps executed: 265 Episode length: 127 Return: -676.22857240324826
INFO:tensorflow:Average training steps per second: 346.70
I0903 00:08:56.774277 139819819333632 replay_runner.py:36] Average training steps per second: 346.70
I0903 00:08:56.914507 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -595.64
INFO:tensorflow:Starting iteration 4
I0903 00:09:00.118742 139819819333632 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 316.74

Steps executed: 1000 Episode length: 1000 Return: -42.57728657873121
I0903 00:09:05.762081 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.58
INFO:tensorflow:Starting iteration 5
I0903 00:09:09.238766 139819819333632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 336.64

Steps executed: 1000 Episode length: 1000 Return: -9.405426005664559
I0903 00:09:14.434497 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -9.41
INFO:tensorflow:Starting iteration 6
I0903 00:09:17.896363 139819819333632 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 340.24

Steps executed: 1000 Episode length: 1000 Return: -220.18595896725546
I0903 00:09:22.610598 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.19
INFO:tensorflow:Starting iteration 7

Steps executed: 569 Episode length: 569 Return: 284.77726507841794546
INFO:tensorflow:Average training steps per second: 357.16
I0903 00:09:28.871113 139819819333632 replay_runner.py:36] Average training steps per second: 357.16
I0903 00:09:29.401521 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 284.78
INFO:tensorflow:Starting iteration 8
I0903 00:09:32.916265 139819819333632 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 355.44

Steps executed: 1000 Episode length: 1000 Return: -70.590021212334596
I0903 00:09:37.109008 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.59
INFO:tensorflow:Starting iteration 9

Steps executed: 230 Episode length: 230 Return: -129.4860075111179596
INFO:tensorflow:Average training steps per second: 362.30
I0903 00:09:43.373605 139819819333632 replay_runner.py:36] Average training steps per second: 362.30
I0903 00:09:43.510792 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.49
INFO:tensorflow:Starting iteration 10
I0903 00:09:47.030022 139819819333632 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 346.89

Steps executed: 1000 Episode length: 1000 Return: -82.556356654079016
I0903 00:09:52.774293 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.56
INFO:tensorflow:Starting iteration 11
I0903 00:09:56.292006 139819819333632 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 343.35

Steps executed: 1000 Episode length: 1000 Return: -319.28083659912746
I0903 00:10:01.312726 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.28
INFO:tensorflow:Starting iteration 12
I0903 00:10:04.646760 139819819333632 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 334.62

Steps executed: 759 Episode length: 759 Return: -444.8819106005876746
I0903 00:10:08.927892 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.88
INFO:tensorflow:Starting iteration 13

Steps executed: 294 Episode length: 294 Return: -244.1470334441062346
INFO:tensorflow:Average training steps per second: 325.77
I0903 00:10:15.348357 139819819333632 replay_runner.py:36] Average training steps per second: 325.77
I0903 00:10:15.655323 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.15
INFO:tensorflow:Starting iteration 14
I0903 00:10:19.061647 139819819333632 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 330.71

Steps executed: 1000 Episode length: 1000 Return: -197.78416807923315
I0903 00:10:24.895758 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.78
INFO:tensorflow:Starting iteration 15

Steps executed: 246 Episode length: 65 Return: -123.82448253402893715
INFO:tensorflow:Average training steps per second: 340.54
I0903 00:10:31.269893 139819819333632 replay_runner.py:36] Average training steps per second: 340.54
I0903 00:10:31.375382 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.59
INFO:tensorflow:Starting iteration 16

Steps executed: 216 Episode length: 125 Return: -712.8206201128279715
INFO:tensorflow:Average training steps per second: 323.74
I0903 00:10:37.853185 139819819333632 replay_runner.py:36] Average training steps per second: 323.74
I0903 00:10:37.986502 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -657.56
INFO:tensorflow:Starting iteration 17

Steps executed: 243 Episode length: 243 Return: -751.6320903504003715
INFO:tensorflow:Average training steps per second: 302.55
I0903 00:10:44.471780 139819819333632 replay_runner.py:36] Average training steps per second: 302.55
I0903 00:10:44.651535 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -751.63
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 234 Return: -517.3176062820644715
INFO:tensorflow:Average training steps per second: 300.39
I0903 00:10:51.103467 139819819333632 replay_runner.py:36] Average training steps per second: 300.39
I0903 00:10:51.263728 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.32
INFO:tensorflow:Starting iteration 19

Steps executed: 471 Episode length: 471 Return: -165.2436149966788415
INFO:tensorflow:Average training steps per second: 309.75
I0903 00:10:57.599356 139819819333632 replay_runner.py:36] Average training steps per second: 309.75
I0903 00:10:58.143812 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.24
INFO:tensorflow:Starting iteration 20
I0903 00:11:01.319606 139819819333632 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 309.22
I0903 00:11:04.553883 139819819333632 replay_runner.py:36] Average training steps per second: 309.22

Steps executed: 206 Episode length: 206 Return: -597.5361302446491415
INFO:tensorflow:Starting iteration 21

Steps executed: 221 Episode length: 221 Return: -568.4343731362081415
INFO:tensorflow:Average training steps per second: 311.09
I0903 00:11:11.179257 139819819333632 replay_runner.py:36] Average training steps per second: 311.09
I0903 00:11:11.332667 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.43
INFO:tensorflow:Starting iteration 22

Steps executed: 282 Episode length: 180 Return: -123.5146052857677415
INFO:tensorflow:Average training steps per second: 310.01
I0903 00:11:17.808303 139819819333632 replay_runner.py:36] Average training steps per second: 310.01
I0903 00:11:17.991095 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.71
INFO:tensorflow:Starting iteration 23

Steps executed: 206 Episode length: 149 Return: -97.17371892453902415
INFO:tensorflow:Average training steps per second: 313.97
I0903 00:11:24.389041 139819819333632 replay_runner.py:36] Average training steps per second: 313.97
I0903 00:11:24.514049 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.34
INFO:tensorflow:Starting iteration 24

Steps executed: 250 Episode length: 61 Return: -139.75396314874487415
INFO:tensorflow:Average training steps per second: 314.37
I0903 00:11:30.940301 139819819333632 replay_runner.py:36] Average training steps per second: 314.37
I0903 00:11:31.063438 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.67
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 123 Return: -140.6626396450893415
INFO:tensorflow:Average training steps per second: 320.13
I0903 00:11:37.453651 139819819333632 replay_runner.py:36] Average training steps per second: 320.13
I0903 00:11:37.611250 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.66
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 117 Return: -171.6810207399783515
INFO:tensorflow:Average training steps per second: 327.18
I0903 00:11:43.884305 139819819333632 replay_runner.py:36] Average training steps per second: 327.18
I0903 00:11:44.017998 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -522.57
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 155 Return: -1189.066228088969915
INFO:tensorflow:Average training steps per second: 317.33
I0903 00:11:50.416472 139819819333632 replay_runner.py:36] Average training steps per second: 317.33
I0903 00:11:50.550496 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -654.10
INFO:tensorflow:Starting iteration 28

Steps executed: 178 Episode length: 53 Return: -135.71163056524193915
INFO:tensorflow:Average training steps per second: 343.45

Steps executed: 315 Episode length: 137 Return: -286.5620250416508915
I0903 00:11:56.919050 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.49
INFO:tensorflow:Starting iteration 29

Steps executed: 230 Episode length: 124 Return: -19.32410735624086915
INFO:tensorflow:Average training steps per second: 333.78
I0903 00:12:03.134449 139819819333632 replay_runner.py:36] Average training steps per second: 333.78

Done fixed training!Episode length: 124 Return: -19.32410735624086915