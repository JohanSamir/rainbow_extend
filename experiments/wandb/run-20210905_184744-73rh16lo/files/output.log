I0905 18:47:51.221443 139852794812416 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.222042 139852794812416 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.298871 139852794812416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.300230 139852794812416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.300328 139852794812416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.300429 139852794812416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.300489 139852794812416 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.300543 139852794812416 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:51.300762 139852794812416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.300829 139852794812416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.300884 139852794812416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.300935 139852794812416 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.300985 139852794812416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.301036 139852794812416 dqn_agent.py:283] 	 seed: 1630867671298804
I0905 18:47:51.303019 139852794812416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.303192 139852794812416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:51.303265 139852794812416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.303327 139852794812416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.303392 139852794812416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.303473 139852794812416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.303575 139852794812416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.303675 139852794812416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.303752 139852794812416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.451917 139852794812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 18:47:52.776470 139852794812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.802052 139852794812416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:52.808331 139852794812416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:52.808536 139852794812416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:52.808616 139852794812416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:52.808681 139852794812416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:52.808737 139852794812416 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:52.808789 139852794812416 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:52.808841 139852794812416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:52.808893 139852794812416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:52.808945 139852794812416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:52.808996 139852794812416 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:52.809046 139852794812416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:52.809097 139852794812416 dqn_agent.py:283] 	 seed: 1630867672808266
I0905 18:47:52.810794 139852794812416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:52.810923 139852794812416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:52.810995 139852794812416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:52.811058 139852794812416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:52.811116 139852794812416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:52.811178 139852794812416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:52.811233 139852794812416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:52.811285 139852794812416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:52.811336 139852794812416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.826705 139852794812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.836114 139852794812416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:52.836370 139852794812416 replay_runner.py:41] Starting iteration 0
Steps executed: 254 Episode length: 147 Return: -184.40019993107245
INFO:tensorflow:Average training steps per second: 310.09
I0905 18:47:56.061525 139852794812416 replay_runner.py:36] Average training steps per second: 310.09
I0905 18:47:56.715880 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.24
INFO:tensorflow:Starting iteration 1

Steps executed: 343 Episode length: 217 Return: -59.596725301246153
INFO:tensorflow:Average training steps per second: 402.70
I0905 18:48:02.289153 139852794812416 replay_runner.py:36] Average training steps per second: 402.70
I0905 18:48:02.464986 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.93
INFO:tensorflow:Starting iteration 2

Steps executed: 243 Episode length: 243 Return: -444.37996377327733
INFO:tensorflow:Average training steps per second: 379.88
I0905 18:48:08.362016 139852794812416 replay_runner.py:36] Average training steps per second: 379.88
I0905 18:48:08.512128 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.38
INFO:tensorflow:Starting iteration 3

Steps executed: 265 Episode length: 109 Return: -281.92929402249604
INFO:tensorflow:Average training steps per second: 415.90
I0905 18:48:14.052620 139852794812416 replay_runner.py:36] Average training steps per second: 415.90
I0905 18:48:14.184465 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.58
INFO:tensorflow:Starting iteration 4

Steps executed: 258 Episode length: 139 Return: -357.12136797699563
INFO:tensorflow:Average training steps per second: 409.52
I0905 18:48:19.721313 139852794812416 replay_runner.py:36] Average training steps per second: 409.52
I0905 18:48:19.828918 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.69
INFO:tensorflow:Starting iteration 5

Steps executed: 286 Episode length: 135 Return: -264.08826559980233
INFO:tensorflow:Average training steps per second: 418.60
I0905 18:48:25.304200 139852794812416 replay_runner.py:36] Average training steps per second: 418.60
I0905 18:48:25.426561 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.30
INFO:tensorflow:Starting iteration 6

Steps executed: 282 Episode length: 128 Return: -267.45437513716067
INFO:tensorflow:Average training steps per second: 405.00
I0905 18:48:30.984721 139852794812416 replay_runner.py:36] Average training steps per second: 405.00
I0905 18:48:31.107392 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.15
INFO:tensorflow:Starting iteration 7

Steps executed: 351 Episode length: 160 Return: -253.19455734407103
INFO:tensorflow:Average training steps per second: 410.19
I0905 18:48:36.621405 139852794812416 replay_runner.py:36] Average training steps per second: 410.19
I0905 18:48:36.788958 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.43
INFO:tensorflow:Starting iteration 8

Steps executed: 269 Episode length: 100 Return: -267.39381608487534
INFO:tensorflow:Average training steps per second: 410.04
I0905 18:48:42.306932 139852794812416 replay_runner.py:36] Average training steps per second: 410.04
I0905 18:48:42.439414 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.59
INFO:tensorflow:Starting iteration 9

Steps executed: 244 Episode length: 244 Return: -571.12873040871074
INFO:tensorflow:Average training steps per second: 409.23
I0905 18:48:47.969932 139852794812416 replay_runner.py:36] Average training steps per second: 409.23
I0905 18:48:48.104720 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.13
INFO:tensorflow:Starting iteration 10

Steps executed: 248 Episode length: 124 Return: -27.814045124666734
INFO:tensorflow:Average training steps per second: 406.47
I0905 18:48:53.649243 139852794812416 replay_runner.py:36] Average training steps per second: 406.47
I0905 18:48:53.769932 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.28
INFO:tensorflow:Starting iteration 11

Steps executed: 439 Episode length: 345 Return: -651.46124749954664
INFO:tensorflow:Average training steps per second: 404.12
I0905 18:48:59.315935 139852794812416 replay_runner.py:36] Average training steps per second: 404.12
I0905 18:48:59.638643 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.82
INFO:tensorflow:Starting iteration 12

Steps executed: 335 Episode length: 335 Return: -436.93761693924233
INFO:tensorflow:Average training steps per second: 411.24
I0905 18:49:05.155260 139852794812416 replay_runner.py:36] Average training steps per second: 411.24
I0905 18:49:05.419210 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.94
INFO:tensorflow:Starting iteration 13

Steps executed: 344 Episode length: 217 Return: -352.60560301094973
INFO:tensorflow:Average training steps per second: 410.11
I0905 18:49:10.940920 139852794812416 replay_runner.py:36] Average training steps per second: 410.11
I0905 18:49:11.121850 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.19
INFO:tensorflow:Starting iteration 14

Steps executed: 233 Episode length: 114 Return: -39.745968602097457
INFO:tensorflow:Average training steps per second: 415.95
I0905 18:49:16.609912 139852794812416 replay_runner.py:36] Average training steps per second: 415.95
I0905 18:49:16.707744 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.33
INFO:tensorflow:Starting iteration 15

Steps executed: 346 Episode length: 198 Return: -295.48228575131257
INFO:tensorflow:Average training steps per second: 418.49
I0905 18:49:22.158092 139852794812416 replay_runner.py:36] Average training steps per second: 418.49
I0905 18:49:22.327698 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.07
INFO:tensorflow:Starting iteration 16

Steps executed: 288 Episode length: 105 Return: -125.62781837910967
INFO:tensorflow:Average training steps per second: 425.56
I0905 18:49:27.642051 139852794812416 replay_runner.py:36] Average training steps per second: 425.56
I0905 18:49:27.760764 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.11
INFO:tensorflow:Starting iteration 17

Steps executed: 201 Episode length: 65 Return: -225.239367520514437
INFO:tensorflow:Average training steps per second: 292.01
I0905 18:49:34.578777 139852794812416 replay_runner.py:36] Average training steps per second: 292.01
I0905 18:49:34.718247 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.63
INFO:tensorflow:Starting iteration 18

Steps executed: 276 Episode length: 276 Return: -54.528844404109726
INFO:tensorflow:Average training steps per second: 266.73
I0905 18:49:41.931592 139852794812416 replay_runner.py:36] Average training steps per second: 266.73
I0905 18:49:42.191301 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.53
INFO:tensorflow:Starting iteration 19

Steps executed: 234 Episode length: 103 Return: -508.29728343841946
INFO:tensorflow:Average training steps per second: 239.16
I0905 18:49:50.451889 139852794812416 replay_runner.py:36] Average training steps per second: 239.16
I0905 18:49:50.627968 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -504.87
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 73 Return: -510.069227234910673
INFO:tensorflow:Average training steps per second: 234.44
I0905 18:49:59.101024 139852794812416 replay_runner.py:36] Average training steps per second: 234.44
I0905 18:49:59.270814 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.86
INFO:tensorflow:Starting iteration 21

Steps executed: 229 Episode length: 113 Return: -469.35371160578893
INFO:tensorflow:Average training steps per second: 240.39
I0905 18:50:07.633991 139852794812416 replay_runner.py:36] Average training steps per second: 240.39
I0905 18:50:07.813381 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -572.19
INFO:tensorflow:Starting iteration 22

Steps executed: 230 Episode length: 53 Return: -473.927704214535543
INFO:tensorflow:Average training steps per second: 240.29
I0905 18:50:16.223441 139852794812416 replay_runner.py:36] Average training steps per second: 240.29
I0905 18:50:16.383350 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.19
INFO:tensorflow:Starting iteration 23

Steps executed: 235 Episode length: 71 Return: -578.249485638274653
INFO:tensorflow:Average training steps per second: 237.53
I0905 18:50:24.872849 139852794812416 replay_runner.py:36] Average training steps per second: 237.53
I0905 18:50:25.049792 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.84
INFO:tensorflow:Starting iteration 24
I0905 18:50:29.326443 139852794812416 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 240.36
I0905 18:50:33.487699 139852794812416 replay_runner.py:36] Average training steps per second: 240.36

Steps executed: 248 Episode length: 61 Return: -369.025817966024825
INFO:tensorflow:Starting iteration 25

Steps executed: 242 Episode length: 85 Return: -442.383427740904225
INFO:tensorflow:Average training steps per second: 246.14
I0905 18:50:42.007334 139852794812416 replay_runner.py:36] Average training steps per second: 246.14
I0905 18:50:42.186358 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.82
INFO:tensorflow:Starting iteration 26

Steps executed: 274 Episode length: 83 Return: -863.389303270091325
INFO:tensorflow:Average training steps per second: 244.41
I0905 18:50:50.512767 139852794812416 replay_runner.py:36] Average training steps per second: 244.41
I0905 18:50:50.717091 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -597.18
INFO:tensorflow:Starting iteration 27

Steps executed: 88 Episode length: 88 Return: -652.0836684639789325
INFO:tensorflow:Average training steps per second: 241.18
I0905 18:50:59.124406 139852794812416 replay_runner.py:36] Average training steps per second: 241.18

Steps executed: 209 Episode length: 121 Return: -652.79581089124875
INFO:tensorflow:Starting iteration 28

Steps executed: 258 Episode length: 73 Return: -398.157843719502575
INFO:tensorflow:Average training steps per second: 239.65
I0905 18:51:07.723522 139852794812416 replay_runner.py:36] Average training steps per second: 239.65
I0905 18:51:07.886986 139852794812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.24
INFO:tensorflow:Starting iteration 29

Steps executed: 225 Episode length: 78 Return: -319.380715866585975
INFO:tensorflow:Average training steps per second: 243.17
I0905 18:51:16.226949 139852794812416 replay_runner.py:36] Average training steps per second: 243.17

Done fixed training!Episode length: 78 Return: -319.380715866585975