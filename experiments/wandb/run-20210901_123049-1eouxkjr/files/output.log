Loaded trained dqn in cartpole
Training fixed agent 5, please be patient, may be a while...
I0901 12:30:56.396745 140038269478912 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:56.405203 140038269478912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:56.405404 140038269478912 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:56.405495 140038269478912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:56.405566 140038269478912 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:56.405650 140038269478912 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:56.405811 140038269478912 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:30:56.405945 140038269478912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:56.406025 140038269478912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:56.406096 140038269478912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:56.406211 140038269478912 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:56.406342 140038269478912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:56.406426 140038269478912 dqn_agent.py:283] 	 seed: 1630499456405153
I0901 12:30:56.409657 140038269478912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:56.409977 140038269478912 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:30:56.410175 140038269478912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:56.410529 140038269478912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:56.410675 140038269478912 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:56.410813 140038269478912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:56.410940 140038269478912 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:56.411047 140038269478912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:56.411127 140038269478912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:56.451361 140038269478912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:57.032496 140038269478912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:57.044469 140038269478912 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:57.054235 140038269478912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:57.054475 140038269478912 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:57.054573 140038269478912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:57.054655 140038269478912 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:57.054942 140038269478912 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:57.055066 140038269478912 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:30:57.055141 140038269478912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:57.055214 140038269478912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:57.055284 140038269478912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:57.055354 140038269478912 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:57.055447 140038269478912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:57.055562 140038269478912 dqn_agent.py:283] 	 seed: 1630499457054169
I0901 12:30:57.057946 140038269478912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:57.058194 140038269478912 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:30:57.058305 140038269478912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:57.058389 140038269478912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:57.058468 140038269478912 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:57.058698 140038269478912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:57.058964 140038269478912 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:57.059058 140038269478912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:57.059131 140038269478912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:57.091176 140038269478912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:57.110336 140038269478912 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:57.110532 140038269478912 replay_runner.py:41] Starting iteration 0
Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 140.11
I0901 12:31:04.248062 140038269478912 replay_runner.py:36] Average training steps per second: 140.11
I0901 12:31:05.325270 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 1

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.21
I0901 12:31:10.638785 140038269478912 replay_runner.py:36] Average training steps per second: 195.21
I0901 12:31:10.782369 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 2

Steps executed: 203 Episode length: 15 Return: 15.0
INFO:tensorflow:Average training steps per second: 196.94
I0901 12:31:16.045316 140038269478912 replay_runner.py:36] Average training steps per second: 196.94
I0901 12:31:16.192116 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.62
INFO:tensorflow:Starting iteration 3

Steps executed: 334 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.61
I0901 12:31:21.574213 140038269478912 replay_runner.py:36] Average training steps per second: 192.61
I0901 12:31:21.809161 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 4

Steps executed: 259 Episode length: 71 Return: 71.0.0
INFO:tensorflow:Average training steps per second: 205.91
I0901 12:31:26.847734 140038269478912 replay_runner.py:36] Average training steps per second: 205.91
I0901 12:31:27.048471 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 64.75
INFO:tensorflow:Starting iteration 5

Steps executed: 173 Episode length: 73 Return: 73.0.0
INFO:tensorflow:Average training steps per second: 199.51

Steps executed: 268 Episode length: 95 Return: 95.0.0
I0901 12:31:32.420755 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 89.33
INFO:tensorflow:Starting iteration 6

Steps executed: 272 Episode length: 109 Return: 109.0
INFO:tensorflow:Average training steps per second: 195.91
I0901 12:31:37.704823 140038269478912 replay_runner.py:36] Average training steps per second: 195.91
I0901 12:31:37.879086 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.67
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.66
I0901 12:31:42.996359 140038269478912 replay_runner.py:36] Average training steps per second: 202.66
I0901 12:31:43.136387 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0901 12:31:43.306228 140038269478912 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.83
I0901 12:31:48.387090 140038269478912 replay_runner.py:36] Average training steps per second: 196.83

Steps executed: 254 Episode length: 104 Return: 104.0
INFO:tensorflow:Starting iteration 9

Steps executed: 248 Episode length: 83 Return: 83.0.0
INFO:tensorflow:Average training steps per second: 199.52
I0901 12:31:53.764155 140038269478912 replay_runner.py:36] Average training steps per second: 199.52
I0901 12:31:53.950279 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 82.67
INFO:tensorflow:Starting iteration 10

Steps executed: 228 Episode length: 72 Return: 72.0.0
INFO:tensorflow:Average training steps per second: 192.67
I0901 12:31:59.337653 140038269478912 replay_runner.py:36] Average training steps per second: 192.67
I0901 12:31:59.492928 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 76.00
INFO:tensorflow:Starting iteration 11

Steps executed: 321 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 191.91
I0901 12:32:04.904299 140038269478912 replay_runner.py:36] Average training steps per second: 191.91
I0901 12:32:05.131361 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.50
INFO:tensorflow:Starting iteration 12

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.18
I0901 12:32:10.356466 140038269478912 replay_runner.py:36] Average training steps per second: 198.18
I0901 12:32:10.628354 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 13

Steps executed: 141 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 190.68
I0901 12:32:16.065426 140038269478912 replay_runner.py:36] Average training steps per second: 190.68

Steps executed: 307 Episode length: 166 Return: 166.0
INFO:tensorflow:Starting iteration 14

Steps executed: 298 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 196.68
I0901 12:32:21.541959 140038269478912 replay_runner.py:36] Average training steps per second: 196.68
I0901 12:32:21.758062 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 15

Steps executed: 295 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 195.07
I0901 12:32:27.087374 140038269478912 replay_runner.py:36] Average training steps per second: 195.07
I0901 12:32:27.279212 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 16

Steps executed: 286 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 192.13
I0901 12:32:32.655948 140038269478912 replay_runner.py:36] Average training steps per second: 192.13
I0901 12:32:32.859544 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 17

Steps executed: 283 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 196.49
I0901 12:32:38.148041 140038269478912 replay_runner.py:36] Average training steps per second: 196.49
I0901 12:32:38.343930 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.10
I0901 12:32:43.761346 140038269478912 replay_runner.py:36] Average training steps per second: 191.10
I0901 12:32:43.893522 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:32:44.084077 140038269478912 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 190.56
I0901 12:32:49.332172 140038269478912 replay_runner.py:36] Average training steps per second: 190.56
I0901 12:32:49.484575 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:32:49.689882 140038269478912 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 200.85

Steps executed: 398 Episode length: 199 Return: 199.0
I0901 12:32:54.943563 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.87
I0901 12:33:00.377938 140038269478912 replay_runner.py:36] Average training steps per second: 190.87
I0901 12:33:00.525657 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 12:33:00.714689 140038269478912 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 200.05
I0901 12:33:05.713728 140038269478912 replay_runner.py:36] Average training steps per second: 200.05
I0901 12:33:05.858889 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:33:06.050413 140038269478912 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 190.53
I0901 12:33:11.299258 140038269478912 replay_runner.py:36] Average training steps per second: 190.53
I0901 12:33:11.430819 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:33:11.603721 140038269478912 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 191.77
I0901 12:33:16.818775 140038269478912 replay_runner.py:36] Average training steps per second: 191.77
I0901 12:33:16.971066 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 378 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 192.76
I0901 12:33:22.333087 140038269478912 replay_runner.py:36] Average training steps per second: 192.76
I0901 12:33:22.581283 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.36
I0901 12:33:27.946092 140038269478912 replay_runner.py:36] Average training steps per second: 193.36
I0901 12:33:28.085200 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:33:28.282026 140038269478912 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 201.18
I0901 12:33:33.253359 140038269478912 replay_runner.py:36] Average training steps per second: 201.18
I0901 12:33:33.391772 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:33:33.585029 140038269478912 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.13
I0901 12:33:38.763453 140038269478912 replay_runner.py:36] Average training steps per second: 193.13
I0901 12:33:38.895851 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.44
I0901 12:33:44.073733 140038269478912 replay_runner.py:36] Average training steps per second: 200.44
I0901 12:33:44.228607 140038269478912 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00