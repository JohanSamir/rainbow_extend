Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 17:47:38.069095 140123653724160 run_experiment.py:549] Creating TrainRunner ...
I0902 17:47:38.079372 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:47:38.079822 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:47:38.080051 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:47:38.080183 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:47:38.080418 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 17:47:38.080682 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:47:38.080797 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:47:38.080898 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:47:38.080976 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:47:38.081047 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 17:47:38.081123 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:47:38.081182 140123653724160 dqn_agent.py:283] 	 seed: 1630604858079294
I0902 17:47:38.083965 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:47:38.084218 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:47:38.084378 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:47:38.084580 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:47:38.084688 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:47:38.084824 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:47:38.084936 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:47:38.085061 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:47:38.085162 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:47:38.124294 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:38.591124 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:38.604494 140123653724160 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:47:38.611938 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:47:38.612169 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:47:38.612384 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:47:38.612511 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:47:38.612600 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 17:47:38.612685 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:47:38.612766 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:47:38.612849 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:47:38.612931 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:47:38.613021 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 17:47:38.613128 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:47:38.613212 140123653724160 dqn_agent.py:283] 	 seed: 1630604858611892
I0902 17:47:38.615909 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:47:38.616082 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:47:38.616224 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:47:38.616329 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:47:38.616421 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:47:38.616510 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:47:38.616653 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:47:38.616736 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:47:38.616831 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:47:38.646305 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:38.667065 140123653724160 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:47:38.667671 140123653724160 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.18
I0902 17:47:45.555830 140123653724160 replay_runner.py:36] Average training steps per second: 145.18
I0902 17:47:47.106899 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:47:47.354929 140123653724160 replay_runner.py:41] Starting iteration 1
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 208.72
I0902 17:47:52.146650 140123653724160 replay_runner.py:36] Average training steps per second: 208.72
I0902 17:47:52.547142 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:47:52.787014 140123653724160 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.77
I0902 17:47:57.975053 140123653724160 replay_runner.py:36] Average training steps per second: 192.77
I0902 17:47:58.385288 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:47:58.631227 140123653724160 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 202.69
I0902 17:48:03.565407 140123653724160 replay_runner.py:36] Average training steps per second: 202.69
I0902 17:48:03.987707 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:48:04.228713 140123653724160 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 198.71
I0902 17:48:09.261700 140123653724160 replay_runner.py:36] Average training steps per second: 198.71
I0902 17:48:09.649464 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:48:09.877072 140123653724160 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 193.39
I0902 17:48:15.048383 140123653724160 replay_runner.py:36] Average training steps per second: 193.39
I0902 17:48:15.470610 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:48:15.713564 140123653724160 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 197.45
I0902 17:48:20.778592 140123653724160 replay_runner.py:36] Average training steps per second: 197.45
I0902 17:48:21.171874 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:48:21.414185 140123653724160 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 192.89
I0902 17:48:26.598846 140123653724160 replay_runner.py:36] Average training steps per second: 192.89
I0902 17:48:26.984368 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:48:27.225617 140123653724160 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.13
I0902 17:48:32.273604 140123653724160 replay_runner.py:36] Average training steps per second: 198.13
I0902 17:48:32.672648 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:48:32.920901 140123653724160 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 198.08
I0902 17:48:37.969634 140123653724160 replay_runner.py:36] Average training steps per second: 198.08
I0902 17:48:38.355679 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:48:38.595550 140123653724160 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.87
I0902 17:48:43.754093 140123653724160 replay_runner.py:36] Average training steps per second: 193.87
I0902 17:48:44.156486 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:48:44.404525 140123653724160 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 201.71
I0902 17:48:49.362918 140123653724160 replay_runner.py:36] Average training steps per second: 201.71
I0902 17:48:49.782214 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:48:50.018218 140123653724160 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.28
I0902 17:48:55.139301 140123653724160 replay_runner.py:36] Average training steps per second: 195.28
I0902 17:48:55.544979 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:48:55.784557 140123653724160 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.70
I0902 17:49:00.921124 140123653724160 replay_runner.py:36] Average training steps per second: 194.70
I0902 17:49:01.334470 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:49:01.549497 140123653724160 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 202.19
I0902 17:49:06.496056 140123653724160 replay_runner.py:36] Average training steps per second: 202.19
I0902 17:49:06.922083 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:49:07.170193 140123653724160 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.82
I0902 17:49:12.330287 140123653724160 replay_runner.py:36] Average training steps per second: 193.82
I0902 17:49:12.752941 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:49:12.997929 140123653724160 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 198.41
I0902 17:49:18.038511 140123653724160 replay_runner.py:36] Average training steps per second: 198.41
I0902 17:49:18.477037 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:49:18.728771 140123653724160 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.96
I0902 17:49:23.832361 140123653724160 replay_runner.py:36] Average training steps per second: 195.96
I0902 17:49:24.254305 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:49:24.502489 140123653724160 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 196.27
I0902 17:49:29.597947 140123653724160 replay_runner.py:36] Average training steps per second: 196.27
I0902 17:49:30.009320 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:49:30.251308 140123653724160 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 196.32
I0902 17:49:35.345527 140123653724160 replay_runner.py:36] Average training steps per second: 196.32
I0902 17:49:35.758214 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:49:36.005818 140123653724160 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 198.02
I0902 17:49:41.056599 140123653724160 replay_runner.py:36] Average training steps per second: 198.02
I0902 17:49:41.465462 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:49:41.706062 140123653724160 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 197.17
I0902 17:49:46.778707 140123653724160 replay_runner.py:36] Average training steps per second: 197.17
I0902 17:49:47.196401 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 650 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.97
I0902 17:49:52.520855 140123653724160 replay_runner.py:36] Average training steps per second: 196.97
I0902 17:49:53.071717 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.50
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.79
I0902 17:49:58.561981 140123653724160 replay_runner.py:36] Average training steps per second: 190.79
I0902 17:49:58.975214 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:49:59.214352 140123653724160 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 198.22

Steps executed: 242 Episode length: 111 Return: -110.0
I0902 17:50:04.455018 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 219.70
I0902 17:50:09.248756 140123653724160 replay_runner.py:36] Average training steps per second: 219.70
I0902 17:50:09.609615 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:50:09.825699 140123653724160 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 209.34
I0902 17:50:14.603164 140123653724160 replay_runner.py:36] Average training steps per second: 209.34
I0902 17:50:14.996025 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 306 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 202.38
I0902 17:50:20.168894 140123653724160 replay_runner.py:36] Average training steps per second: 202.38
I0902 17:50:20.409236 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 28

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.28
I0902 17:50:25.555514 140123653724160 replay_runner.py:36] Average training steps per second: 203.28
I0902 17:50:25.965491 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.53
I0902 17:50:31.134886 140123653724160 replay_runner.py:36] Average training steps per second: 202.53
I0902 17:50:31.546927 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00