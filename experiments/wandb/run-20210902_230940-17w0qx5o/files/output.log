I0902 23:09:47.396786 139650945370112 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.397360 139650945370112 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.460785 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.462092 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.462189 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.462257 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.462315 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.462370 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:47.462426 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.462478 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.462531 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.462636 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.462788 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.462855 139650945370112 dqn_agent.py:283] 	 seed: 1630624187460714
I0902 23:09:47.464810 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.464971 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:47.465049 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.465114 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.465201 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.465263 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.465318 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.465427 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.465541 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.795711 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 23:09:53.995587 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.065288 139650945370112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:54.119089 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:54.119310 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:54.127858 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:54.128004 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:54.129347 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:54.129444 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:54.130426 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:54.130522 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:54.130616 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:54.131927 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:54.132022 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:54.132111 139650945370112 dqn_agent.py:283] 	 seed: 1630624194119029
I0902 23:09:54.135630 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:54.135779 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:54.135887 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:54.146293 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:54.146716 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:54.147009 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:54.147232 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:54.147457 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:54.147676 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.537537 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.610497 139650945370112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:54.610915 139650945370112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 110.42
I0902 23:10:03.667620 139650945370112 replay_runner.py:36] Average training steps per second: 110.42
I0902 23:10:04.460861 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0902 23:10:04.622157 139650945370112 replay_runner.py:41] Starting iteration 1
Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 187.78
I0902 23:10:09.948330 139650945370112 replay_runner.py:36] Average training steps per second: 187.78
I0902 23:10:10.126232 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.71
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 183.79
I0902 23:10:15.767702 139650945370112 replay_runner.py:36] Average training steps per second: 183.79
I0902 23:10:15.909198 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.10
INFO:tensorflow:Starting iteration 3


Steps executed: 378 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 181.59
I0902 23:10:21.602701 139650945370112 replay_runner.py:36] Average training steps per second: 181.59
I0902 23:10:21.902032 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 4
I0902 23:10:22.108706 139650945370112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.61
I0902 23:10:27.169612 139650945370112 replay_runner.py:36] Average training steps per second: 197.61
I0902 23:10:27.313352 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 179.70
I0902 23:10:33.079391 139650945370112 replay_runner.py:36] Average training steps per second: 179.70
I0902 23:10:33.205161 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:10:33.386670 139650945370112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.84
I0902 23:10:38.391308 139650945370112 replay_runner.py:36] Average training steps per second: 199.84
I0902 23:10:38.615588 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 7

Steps executed: 340 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 180.56
I0902 23:10:44.354862 139650945370112 replay_runner.py:36] Average training steps per second: 180.56
I0902 23:10:44.569531 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 8

Steps executed: 331 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 194.92
I0902 23:10:49.891922 139650945370112 replay_runner.py:36] Average training steps per second: 194.92
I0902 23:10:50.094785 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 9

Steps executed: 298 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 188.46
I0902 23:10:55.585773 139650945370112 replay_runner.py:36] Average training steps per second: 188.46
I0902 23:10:55.767110 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 10

Steps executed: 281 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 194.88
I0902 23:11:01.094136 139650945370112 replay_runner.py:36] Average training steps per second: 194.88
I0902 23:11:01.354086 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 11

Steps executed: 385 Episode length: 193 Return: 193.0
INFO:tensorflow:Average training steps per second: 187.72
I0902 23:11:06.884654 139650945370112 replay_runner.py:36] Average training steps per second: 187.72
I0902 23:11:07.121584 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 12

Steps executed: 376 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 196.49
I0902 23:11:12.405643 139650945370112 replay_runner.py:36] Average training steps per second: 196.49
I0902 23:11:12.638703 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 13

Steps executed: 325 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 188.60
I0902 23:11:18.141965 139650945370112 replay_runner.py:36] Average training steps per second: 188.60
I0902 23:11:18.359966 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 14

Steps executed: 328 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 195.89
I0902 23:11:23.649027 139650945370112 replay_runner.py:36] Average training steps per second: 195.89
I0902 23:11:23.889919 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 15


Steps executed: 365 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.21
I0902 23:11:29.371217 139650945370112 replay_runner.py:36] Average training steps per second: 189.21
I0902 23:11:29.604254 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.92
I0902 23:11:35.085057 139650945370112 replay_runner.py:36] Average training steps per second: 188.92
I0902 23:11:35.216660 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:11:35.416804 139650945370112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.37
I0902 23:11:40.615659 139650945370112 replay_runner.py:36] Average training steps per second: 192.37
I0902 23:11:40.744849 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:11:40.944795 139650945370112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 190.81
I0902 23:11:46.186518 139650945370112 replay_runner.py:36] Average training steps per second: 190.81
I0902 23:11:46.322130 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19


Steps executed: 346 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 192.42
I0902 23:11:51.721405 139650945370112 replay_runner.py:36] Average training steps per second: 192.42
I0902 23:11:51.941773 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 20
I0902 23:11:52.138800 139650945370112 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 188.96
I0902 23:11:57.431692 139650945370112 replay_runner.py:36] Average training steps per second: 188.96

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 21

Steps executed: 366 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 195.34
I0902 23:12:02.894904 139650945370112 replay_runner.py:36] Average training steps per second: 195.34
I0902 23:12:03.130053 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 22
I0902 23:12:03.321591 139650945370112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 186.65
I0902 23:12:08.679920 139650945370112 replay_runner.py:36] Average training steps per second: 186.65
I0902 23:12:08.826426 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.18
I0902 23:12:14.152520 139650945370112 replay_runner.py:36] Average training steps per second: 195.18
I0902 23:12:14.409892 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 24


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.03
I0902 23:12:19.921450 139650945370112 replay_runner.py:36] Average training steps per second: 188.03
I0902 23:12:20.054543 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:12:20.249825 139650945370112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 198.59
I0902 23:12:25.285820 139650945370112 replay_runner.py:36] Average training steps per second: 198.59
I0902 23:12:25.422482 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:12:25.609484 139650945370112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 190.63
I0902 23:12:30.855581 139650945370112 replay_runner.py:36] Average training steps per second: 190.63
I0902 23:12:30.998742 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:12:31.200139 139650945370112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 194.37
I0902 23:12:36.345357 139650945370112 replay_runner.py:36] Average training steps per second: 194.37
I0902 23:12:36.479483 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:12:36.666592 139650945370112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 192.00
I0902 23:12:41.875250 139650945370112 replay_runner.py:36] Average training steps per second: 192.00
I0902 23:12:42.014482 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 215.18
I0902 23:12:46.853543 139650945370112 replay_runner.py:36] Average training steps per second: 215.18
I0902 23:12:46.959326 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00