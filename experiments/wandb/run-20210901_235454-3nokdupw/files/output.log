Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 23:55:00.533994 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0901 23:55:00.544204 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:55:00.544456 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:55:00.544571 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:55:00.544671 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:55:00.544810 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:55:00.544903 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:55:00.545063 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:55:00.545172 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:55:00.545272 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:55:00.545405 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:55:00.545501 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:55:00.545619 139965167532032 dqn_agent.py:283] 	 seed: 1630540500544130
I0901 23:55:00.548700 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:55:00.548937 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:55:00.549285 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:55:00.549455 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:55:00.549567 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:55:00.549879 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:55:00.550004 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:55:00.550165 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:55:00.550288 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:55:00.589203 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:55:00.991475 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:55:01.007094 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:55:01.015312 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:55:01.015602 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:55:01.015747 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:55:01.015842 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:55:01.015967 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:55:01.016144 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:55:01.016329 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:55:01.016466 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:55:01.016607 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:55:01.016751 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:55:01.016895 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:55:01.017006 139965167532032 dqn_agent.py:283] 	 seed: 1630540501015253
I0901 23:55:01.051543 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:55:01.051793 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:55:01.051913 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:55:01.052005 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:55:01.052088 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:55:01.052167 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:55:01.052290 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:55:01.052428 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:55:01.052555 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:55:01.084930 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:55:01.108696 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:55:01.109064 139965167532032 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.68
I0901 23:55:07.294268 139965167532032 replay_runner.py:36] Average training steps per second: 161.68
Steps executed: 214 Episode length: 132 Return: -413.399075091877
I0901 23:55:08.461162 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.84
INFO:tensorflow:Starting iteration 1

Steps executed: 289 Episode length: 155 Return: -260.32452403861714
INFO:tensorflow:Average training steps per second: 224.59
I0901 23:55:17.336118 139965167532032 replay_runner.py:36] Average training steps per second: 224.59
I0901 23:55:17.590038 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.13
INFO:tensorflow:Starting iteration 2

Steps executed: 247 Episode length: 109 Return: -380.06274973847957
INFO:tensorflow:Average training steps per second: 217.59
I0901 23:55:26.528346 139965167532032 replay_runner.py:36] Average training steps per second: 217.59
I0901 23:55:26.740938 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.22
INFO:tensorflow:Starting iteration 3
I0901 23:55:31.085427 139965167532032 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 218.94

Steps executed: 516 Episode length: 516 Return: -88.452986577242257
I0901 23:55:37.018666 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.45
INFO:tensorflow:Starting iteration 4
I0901 23:55:41.474788 139965167532032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 227.94

Steps executed: 853 Episode length: 853 Return: -465.96854479725067
I0901 23:55:49.114530 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.97
INFO:tensorflow:Starting iteration 5

Steps executed: 295 Episode length: 295 Return: -55.229064206451647
INFO:tensorflow:Average training steps per second: 222.78
I0901 23:55:57.882535 139965167532032 replay_runner.py:36] Average training steps per second: 222.78
I0901 23:55:58.198999 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -55.23
INFO:tensorflow:Starting iteration 6

Steps executed: 297 Episode length: 166 Return: -91.287888173990534
INFO:tensorflow:Average training steps per second: 232.50
I0901 23:56:06.718678 139965167532032 replay_runner.py:36] Average training steps per second: 232.50
I0901 23:56:06.993901 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.68
INFO:tensorflow:Starting iteration 7
I0901 23:56:11.345873 139965167532032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 233.03

Steps executed: 1000 Episode length: 1000 Return: -125.17710458801939
I0901 23:56:17.944141 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.18
INFO:tensorflow:Starting iteration 8
I0901 23:56:22.299966 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 227.28

Steps executed: 1000 Episode length: 1000 Return: -72.547315409242979
I0901 23:56:31.346055 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.55
INFO:tensorflow:Starting iteration 9
I0901 23:56:35.526511 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 233.35

Steps executed: 1000 Episode length: 1000 Return: -232.04513749713029
I0901 23:56:41.791441 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.05
INFO:tensorflow:Starting iteration 10
I0901 23:56:45.930776 139965167532032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 236.11
I0901 23:56:50.166700 139965167532032 replay_runner.py:36] Average training steps per second: 236.11

Steps executed: 1000 Episode length: 1000 Return: -265.94093886936649
INFO:tensorflow:Starting iteration 11

Steps executed: 662 Episode length: 662 Return: -308.4628844849226649
INFO:tensorflow:Average training steps per second: 228.52
I0901 23:57:01.394494 139965167532032 replay_runner.py:36] Average training steps per second: 228.52
I0901 23:57:02.626835 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.46
INFO:tensorflow:Starting iteration 12

Steps executed: 530 Episode length: 347 Return: -109.4107273775978449
INFO:tensorflow:Average training steps per second: 226.19
I0901 23:57:11.361858 139965167532032 replay_runner.py:36] Average training steps per second: 226.19
I0901 23:57:12.063950 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.04
INFO:tensorflow:Starting iteration 13
I0901 23:57:16.392279 139965167532032 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 229.65

Steps executed: 1000 Episode length: 1000 Return: -109.79944276888759
I0901 23:57:24.782151 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.80
INFO:tensorflow:Starting iteration 14

Steps executed: 228 Episode length: 228 Return: 25.912219690227068759
INFO:tensorflow:Average training steps per second: 222.52
I0901 23:57:33.573601 139965167532032 replay_runner.py:36] Average training steps per second: 222.52
I0901 23:57:33.843031 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.91
INFO:tensorflow:Starting iteration 15

Steps executed: 212 Episode length: 212 Return: -80.77079143827166759
INFO:tensorflow:Average training steps per second: 229.80
I0901 23:57:42.604104 139965167532032 replay_runner.py:36] Average training steps per second: 229.80
I0901 23:57:42.827034 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.77
INFO:tensorflow:Starting iteration 16

Steps executed: 300 Episode length: 160 Return: -71.11955938610353159
INFO:tensorflow:Average training steps per second: 228.69
I0901 23:57:51.533751 139965167532032 replay_runner.py:36] Average training steps per second: 228.69
I0901 23:57:51.806949 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.55
INFO:tensorflow:Starting iteration 17

Steps executed: 259 Episode length: 259 Return: -42.70123972766853159
INFO:tensorflow:Average training steps per second: 223.89
I0901 23:58:00.671918 139965167532032 replay_runner.py:36] Average training steps per second: 223.89
I0901 23:58:00.992269 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.70
INFO:tensorflow:Starting iteration 18

Steps executed: 313 Episode length: 180 Return: -371.4955618332183359
INFO:tensorflow:Average training steps per second: 223.87
I0901 23:58:09.852429 139965167532032 replay_runner.py:36] Average training steps per second: 223.87
I0901 23:58:10.125169 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.82
INFO:tensorflow:Starting iteration 19

Steps executed: 118 Episode length: 55 Return: -141.15344478018693359
INFO:tensorflow:Average training steps per second: 224.07
I0901 23:58:18.932867 139965167532032 replay_runner.py:36] Average training steps per second: 224.07

Steps executed: 233 Episode length: 115 Return: -103.8797153248796159
INFO:tensorflow:Starting iteration 20

Steps executed: 298 Episode length: 100 Return: -172.0643819911797259
INFO:tensorflow:Average training steps per second: 223.72
I0901 23:58:27.998933 139965167532032 replay_runner.py:36] Average training steps per second: 223.72
I0901 23:58:28.254787 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.65
INFO:tensorflow:Starting iteration 21
I0901 23:58:32.630255 139965167532032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 223.89

Steps executed: 301 Episode length: 301 Return: -125.3364754656356959
I0901 23:58:37.540591 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.34
INFO:tensorflow:Starting iteration 22

Steps executed: 215 Episode length: 215 Return: -100.1459813943862559
INFO:tensorflow:Average training steps per second: 232.41
I0901 23:58:46.292847 139965167532032 replay_runner.py:36] Average training steps per second: 232.41
I0901 23:58:46.523277 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.15
INFO:tensorflow:Starting iteration 23
I0901 23:58:50.929701 139965167532032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.34

Steps executed: 1000 Episode length: 1000 Return: 99.1761213511621459
I0901 23:58:57.689349 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 99.18
INFO:tensorflow:Starting iteration 24

Steps executed: 257 Episode length: 130 Return: -160.8670195168718459
INFO:tensorflow:Average training steps per second: 229.41
I0901 23:59:06.321379 139965167532032 replay_runner.py:36] Average training steps per second: 229.41
I0901 23:59:06.551897 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.13
INFO:tensorflow:Starting iteration 25
I0901 23:59:10.822658 139965167532032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 224.82
I0901 23:59:15.271060 139965167532032 replay_runner.py:36] Average training steps per second: 224.82

Steps executed: 205 Episode length: 53 Return: -86.692027234689222459
INFO:tensorflow:Starting iteration 26

Steps executed: 334 Episode length: 155 Return: -107.9914063348325459
INFO:tensorflow:Average training steps per second: 223.66
I0901 23:59:24.265327 139965167532032 replay_runner.py:36] Average training steps per second: 223.66
I0901 23:59:24.540574 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.68
INFO:tensorflow:Starting iteration 27
I0901 23:59:28.734438 139965167532032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 224.92

Steps executed: 347 Episode length: 222 Return: -191.7803502911777759
I0901 23:59:33.551386 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.93
INFO:tensorflow:Starting iteration 28

Steps executed: 242 Episode length: 54 Return: -92.151906475503351759
INFO:tensorflow:Average training steps per second: 231.05
I0901 23:59:42.148996 139965167532032 replay_runner.py:36] Average training steps per second: 231.05
I0901 23:59:42.366194 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.42
INFO:tensorflow:Starting iteration 29

Steps executed: 228 Episode length: 133 Return: -372.9939756134212759
INFO:tensorflow:Average training steps per second: 252.65
I0901 23:59:50.373240 139965167532032 replay_runner.py:36] Average training steps per second: 252.65

Done fixed training!Episode length: 133 Return: -372.9939756134212759