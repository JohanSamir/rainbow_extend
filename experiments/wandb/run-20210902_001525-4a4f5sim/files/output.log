I0902 00:15:32.411622 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:15:32.422979 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:32.423166 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:32.423261 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:32.423322 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:32.423548 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:32.423626 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:32.423750 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:32.423811 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:32.423868 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:32.423946 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:32.424014 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:32.424079 139644712736768 dqn_agent.py:283] 	 seed: 1630541732422930
I0902 00:15:32.426293 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:32.426554 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:32.426738 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:32.426889 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:32.427046 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:32.427214 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:32.427359 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:32.427473 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:32.427634 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:32.463839 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:32.822220 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:32.835998 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:15:32.845272 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:32.845524 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:32.845735 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:32.845847 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:32.845917 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:32.845996 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:32.846098 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:32.846261 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:32.846346 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:32.846608 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:32.846764 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:32.846890 139644712736768 dqn_agent.py:283] 	 seed: 1630541732845222
I0902 00:15:32.848914 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:32.849066 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:32.849160 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:32.849244 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:32.849319 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:32.849392 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:32.849476 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:32.849567 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:32.849657 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:32.880170 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:32.926566 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:15:32.926998 139644712736768 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 165.01
I0902 00:15:38.992841 139644712736768 replay_runner.py:36] Average training steps per second: 165.01
I0902 00:15:40.280350 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.80
Steps executed: 304 Episode length: 167 Return: -430.48578135820452
INFO:tensorflow:Starting iteration 1

Steps executed: 248 Episode length: 94 Return: -128.277422227121955
INFO:tensorflow:Average training steps per second: 224.20
I0902 00:15:49.000212 139644712736768 replay_runner.py:36] Average training steps per second: 224.20
I0902 00:15:49.219675 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.34
INFO:tensorflow:Starting iteration 2
I0902 00:15:53.608174 139644712736768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 223.63

Steps executed: 276 Episode length: 276 Return: -83.627971077443455
I0902 00:15:58.429440 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.63
INFO:tensorflow:Starting iteration 3

Steps executed: 218 Episode length: 218 Return: -58.827363270333185
INFO:tensorflow:Average training steps per second: 225.14
I0902 00:16:07.098439 139644712736768 replay_runner.py:36] Average training steps per second: 225.14
I0902 00:16:07.353302 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.83
INFO:tensorflow:Starting iteration 4
I0902 00:16:11.508054 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 221.24

Steps executed: 1000 Episode length: 1000 Return: -97.55706431161374
I0902 00:16:18.832422 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.56
INFO:tensorflow:Starting iteration 5
I0902 00:16:23.108417 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 217.11
I0902 00:16:27.714724 139644712736768 replay_runner.py:36] Average training steps per second: 217.11

Steps executed: 1000 Episode length: 1000 Return: -185.22527016992495
INFO:tensorflow:Starting iteration 6
I0902 00:16:34.529646 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.84

Steps executed: 755 Episode length: 755 Return: -280.6775370948352495
I0902 00:16:40.839132 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.68
INFO:tensorflow:Starting iteration 7
I0902 00:16:44.932934 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 230.53

Steps executed: 1000 Episode length: 1000 Return: -199.61091059554655
I0902 00:16:51.780817 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.61
INFO:tensorflow:Starting iteration 8
I0902 00:16:55.876750 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 237.27
I0902 00:17:00.091768 139644712736768 replay_runner.py:36] Average training steps per second: 237.27

Steps executed: 332 Episode length: 332 Return: -542.3059631537034655
INFO:tensorflow:Starting iteration 9
I0902 00:17:04.553911 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 241.46

Steps executed: 1000 Episode length: 1000 Return: -152.66608658602428
I0902 00:17:11.387709 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.67
INFO:tensorflow:Starting iteration 10
I0902 00:17:15.450324 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 242.38

Steps executed: 1000 Episode length: 1000 Return: -197.59145301375108
I0902 00:17:23.674459 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.59
INFO:tensorflow:Starting iteration 11
I0902 00:17:27.718969 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 250.57

Steps executed: 1000 Episode length: 1000 Return: -94.961822658691698
I0902 00:17:33.776979 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.96
INFO:tensorflow:Starting iteration 12

Steps executed: 379 Episode length: 379 Return: -464.7908420201444598
INFO:tensorflow:Average training steps per second: 258.62
I0902 00:17:41.785555 139644712736768 replay_runner.py:36] Average training steps per second: 258.62
I0902 00:17:42.269264 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.79
INFO:tensorflow:Starting iteration 13

Steps executed: 145 Episode length: 145 Return: -178.4261930943641298
INFO:tensorflow:Average training steps per second: 270.72
I0902 00:17:50.096587 139644712736768 replay_runner.py:36] Average training steps per second: 270.72

Steps executed: 525 Episode length: 380 Return: -268.4490454993031298
INFO:tensorflow:Starting iteration 14

Steps executed: 260 Episode length: 118 Return: -559.5924514768126398
INFO:tensorflow:Average training steps per second: 291.54
I0902 00:17:58.103661 139644712736768 replay_runner.py:36] Average training steps per second: 291.54
I0902 00:17:58.287390 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -506.52
INFO:tensorflow:Starting iteration 15
I0902 00:18:01.978904 139644712736768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 302.30

Steps executed: 1000 Episode length: 1000 Return: -142.27848526800628
I0902 00:18:07.251641 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.28
INFO:tensorflow:Starting iteration 16
I0902 00:18:10.842280 139644712736768 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 305.80

Steps executed: 667 Episode length: 667 Return: -112.3225169798020928
I0902 00:18:15.338006 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.32
INFO:tensorflow:Starting iteration 17

Steps executed: 261 Episode length: 119 Return: -40.24939643435151928
INFO:tensorflow:Average training steps per second: 310.78
I0902 00:18:22.023584 139644712736768 replay_runner.py:36] Average training steps per second: 310.78
I0902 00:18:22.190472 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -476.95
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 234 Return: -378.5560321914315428
INFO:tensorflow:Average training steps per second: 309.61
I0902 00:18:28.724358 139644712736768 replay_runner.py:36] Average training steps per second: 309.61
I0902 00:18:28.882542 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.56
INFO:tensorflow:Starting iteration 19

Steps executed: 447 Episode length: 248 Return: -524.6552497227035628
INFO:tensorflow:Average training steps per second: 306.63
I0902 00:18:35.388223 139644712736768 replay_runner.py:36] Average training steps per second: 306.63
I0902 00:18:35.754876 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.83
INFO:tensorflow:Starting iteration 20

Steps executed: 272 Episode length: 91 Return: -135.99668979583382628
INFO:tensorflow:Average training steps per second: 305.26
I0902 00:18:42.295468 139644712736768 replay_runner.py:36] Average training steps per second: 305.26
I0902 00:18:42.413718 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.08
INFO:tensorflow:Starting iteration 21
I0902 00:18:45.470993 139644712736768 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 307.91

Steps executed: 325 Episode length: 144 Return: -67.27513405807221628
I0902 00:18:48.931934 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.08
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 53 Return: -135.99961626198393628
INFO:tensorflow:Average training steps per second: 311.48
I0902 00:18:55.204752 139644712736768 replay_runner.py:36] Average training steps per second: 311.48
I0902 00:18:55.344368 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.92
INFO:tensorflow:Starting iteration 23

Steps executed: 288 Episode length: 124 Return: -390.3196040954713628
INFO:tensorflow:Average training steps per second: 318.11
I0902 00:19:01.586015 139644712736768 replay_runner.py:36] Average training steps per second: 318.11
I0902 00:19:01.771701 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.58
INFO:tensorflow:Starting iteration 24

Steps executed: 274 Episode length: 274 Return: -228.6764992424468228
INFO:tensorflow:Average training steps per second: 316.07
I0902 00:19:08.061652 139644712736768 replay_runner.py:36] Average training steps per second: 316.07
I0902 00:19:08.295608 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.68
INFO:tensorflow:Starting iteration 25

Steps executed: 344 Episode length: 190 Return: -444.7515342681273228
INFO:tensorflow:Average training steps per second: 318.78
I0902 00:19:14.548977 139644712736768 replay_runner.py:36] Average training steps per second: 318.78
I0902 00:19:14.807846 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.19
INFO:tensorflow:Starting iteration 26

Steps executed: 148 Episode length: 148 Return: -762.1118815815607228
INFO:tensorflow:Average training steps per second: 346.26
I0902 00:19:20.769615 139644712736768 replay_runner.py:36] Average training steps per second: 346.26

Steps executed: 287 Episode length: 139 Return: -551.0759574374144228
INFO:tensorflow:Starting iteration 27
I0902 00:19:23.957129 139644712736768 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 339.94

Steps executed: 269 Episode length: 89 Return: -723.97617612573013228
I0902 00:19:27.037585 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -575.32
INFO:tensorflow:Starting iteration 28

Steps executed: 383 Episode length: 217 Return: -820.0219586909706228
INFO:tensorflow:Average training steps per second: 340.93
I0902 00:19:33.191842 139644712736768 replay_runner.py:36] Average training steps per second: 340.93
I0902 00:19:33.458599 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -603.06
INFO:tensorflow:Starting iteration 29

Steps executed: 317 Episode length: 181 Return: -246.7536778022179428
INFO:tensorflow:Average training steps per second: 349.45
I0902 00:19:39.691223 139644712736768 replay_runner.py:36] Average training steps per second: 349.45

Done fixed training!Episode length: 181 Return: -246.7536778022179428