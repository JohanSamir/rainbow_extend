Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
Steps executed: 317 Episode length: 202 Return: -202.0
I0910 11:00:13.683044 140347353020416 run_experiment.py:549] Creating TrainRunner ...
I0910 11:00:13.688353 140347353020416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:13.688469 140347353020416 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:13.688527 140347353020416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:13.688580 140347353020416 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:13.688630 140347353020416 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:13.688679 140347353020416 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:13.688749 140347353020416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:13.688822 140347353020416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:13.688926 140347353020416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:13.689002 140347353020416 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:13.689072 140347353020416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:13.689139 140347353020416 dqn_agent.py:283] 	 seed: 1631271613688323
I0910 11:00:13.690669 140347353020416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:13.690782 140347353020416 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:13.690855 140347353020416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:13.690915 140347353020416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:13.690970 140347353020416 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:13.691039 140347353020416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:13.691098 140347353020416 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:13.691199 140347353020416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:13.691266 140347353020416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:13.718178 140347353020416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:13.737217 140347353020416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:13.737357 140347353020416 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:13.737475 140347353020416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:13.737535 140347353020416 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:13.737594 140347353020416 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:13.737661 140347353020416 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:13.737758 140347353020416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:13.737840 140347353020416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:13.737902 140347353020416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:13.737981 140347353020416 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:13.738042 140347353020416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:13.738117 140347353020416 dqn_agent.py:283] 	 seed: 1631271613737184
I0910 11:00:13.739530 140347353020416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:13.739655 140347353020416 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:13.739725 140347353020416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:13.739782 140347353020416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:13.739842 140347353020416 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:13.739906 140347353020416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:13.739969 140347353020416 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:13.740044 140347353020416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:13.740120 140347353020416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:13.761914 140347353020416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:13.777647 140347353020416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:00:13.777812 140347353020416 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 832698.83
I0910 11:00:13.779282 140347353020416 replay_runner.py:39] Average training steps per second: 832698.83
I0910 11:00:14.664786 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.00
INFO:tensorflow:Starting iteration 1
I0910 11:00:14.703080 140347353020416 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 832698.83
I0910 11:00:14.704548 140347353020416 replay_runner.py:39] Average training steps per second: 832698.83
I0910 11:00:14.785685 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 2
I0910 11:00:14.817896 140347353020416 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 742223.32
I0910 11:00:14.819493 140347353020416 replay_runner.py:39] Average training steps per second: 742223.32
I0910 11:00:14.889981 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.00
INFO:tensorflow:Starting iteration 3
I0910 11:00:14.923402 140347353020416 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 698468.61
I0910 11:00:14.925073 140347353020416 replay_runner.py:39] Average training steps per second: 698468.61
I0910 11:00:14.994509 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 4
I0910 11:00:15.026149 140347353020416 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 808930.38
I0910 11:00:15.027639 140347353020416 replay_runner.py:39] Average training steps per second: 808930.38

Steps executed: 116 Episode length: 116 Return: -116.0
INFO:tensorflow:Starting iteration 5
I0910 11:00:15.249096 140347353020416 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 878204.36
I0910 11:00:15.250585 140347353020416 replay_runner.py:39] Average training steps per second: 878204.36
I0910 11:00:15.351956 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.00
INFO:tensorflow:Starting iteration 6
I0910 11:00:15.385338 140347353020416 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 802584.00
I0910 11:00:15.386808 140347353020416 replay_runner.py:39] Average training steps per second: 802584.00
I0910 11:00:15.453048 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 7
I0910 11:00:15.483630 140347353020416 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 823866.43
I0910 11:00:15.485052 140347353020416 replay_runner.py:39] Average training steps per second: 823866.43
I0910 11:00:15.551878 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 8
I0910 11:00:15.582817 140347353020416 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 792275.03
I0910 11:00:15.584290 140347353020416 replay_runner.py:39] Average training steps per second: 792275.03
I0910 11:00:15.646668 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 9
I0910 11:00:15.695893 140347353020416 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 653929.53
I0910 11:00:15.697675 140347353020416 replay_runner.py:39] Average training steps per second: 653929.53
I0910 11:00:15.824417 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.00
INFO:tensorflow:Starting iteration 10
I0910 11:00:15.855363 140347353020416 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 824514.25
I0910 11:00:15.856776 140347353020416 replay_runner.py:39] Average training steps per second: 824514.25
I0910 11:00:15.919996 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 11
I0910 11:00:15.953626 140347353020416 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 845455.35
I0910 11:00:15.955032 140347353020416 replay_runner.py:39] Average training steps per second: 845455.35
I0910 11:00:16.044914 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 12
I0910 11:00:16.077257 140347353020416 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 750860.01
I0910 11:00:16.078881 140347353020416 replay_runner.py:39] Average training steps per second: 750860.01
I0910 11:00:16.140499 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.00
INFO:tensorflow:Starting iteration 13
I0910 11:00:16.171427 140347353020416 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 688946.12
I0910 11:00:16.173112 140347353020416 replay_runner.py:39] Average training steps per second: 688946.12
I0910 11:00:16.274597 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.50
INFO:tensorflow:Starting iteration 14
I0910 11:00:16.306105 140347353020416 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 857029.83
I0910 11:00:16.307472 140347353020416 replay_runner.py:39] Average training steps per second: 857029.83
I0910 11:00:16.523285 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.00
INFO:tensorflow:Starting iteration 15
I0910 11:00:16.555424 140347353020416 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 745389.02
I0910 11:00:16.557007 140347353020416 replay_runner.py:39] Average training steps per second: 745389.02
I0910 11:00:16.645775 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.00
INFO:tensorflow:Starting iteration 16
I0910 11:00:16.678637 140347353020416 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 793173.98
I0910 11:00:16.680125 140347353020416 replay_runner.py:39] Average training steps per second: 793173.98
I0910 11:00:16.923485 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.00
INFO:tensorflow:Starting iteration 17
I0910 11:00:16.955145 140347353020416 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 819680.28
I0910 11:00:16.956618 140347353020416 replay_runner.py:39] Average training steps per second: 819680.28
I0910 11:00:17.024551 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 18
I0910 11:00:17.061002 140347353020416 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 809867.54
I0910 11:00:17.062454 140347353020416 replay_runner.py:39] Average training steps per second: 809867.54
I0910 11:00:17.130806 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 19
I0910 11:00:17.167155 140347353020416 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 558495.87
I0910 11:00:17.169244 140347353020416 replay_runner.py:39] Average training steps per second: 558495.87
I0910 11:00:17.273234 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 20
I0910 11:00:17.313666 140347353020416 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 589999.16
I0910 11:00:17.315634 140347353020416 replay_runner.py:39] Average training steps per second: 589999.16
I0910 11:00:17.419423 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.50
INFO:tensorflow:Starting iteration 21
I0910 11:00:17.457463 140347353020416 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 569646.07
I0910 11:00:17.459538 140347353020416 replay_runner.py:39] Average training steps per second: 569646.07
I0910 11:00:17.553459 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 22
I0910 11:00:17.585144 140347353020416 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 807995.38
I0910 11:00:17.586605 140347353020416 replay_runner.py:39] Average training steps per second: 807995.38
I0910 11:00:17.659345 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 23
I0910 11:00:17.692744 140347353020416 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 793474.08
I0910 11:00:17.694247 140347353020416 replay_runner.py:39] Average training steps per second: 793474.08
I0910 11:00:17.788694 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 24
I0910 11:00:17.819980 140347353020416 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 801663.61
I0910 11:00:17.821453 140347353020416 replay_runner.py:39] Average training steps per second: 801663.61
I0910 11:00:17.894574 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 25
I0910 11:00:17.933992 140347353020416 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 407016.40
I0910 11:00:17.936740 140347353020416 replay_runner.py:39] Average training steps per second: 407016.40
I0910 11:00:18.003591 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 26
I0910 11:00:18.036864 140347353020416 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 826463.84
I0910 11:00:18.038282 140347353020416 replay_runner.py:39] Average training steps per second: 826463.84
I0910 11:00:18.108468 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 27
I0910 11:00:18.140432 140347353020416 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 750188.52
I0910 11:00:18.141991 140347353020416 replay_runner.py:39] Average training steps per second: 750188.52
I0910 11:00:18.214698 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 28
I0910 11:00:18.250317 140347353020416 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 698003.66
I0910 11:00:18.251976 140347353020416 replay_runner.py:39] Average training steps per second: 698003.66
I0910 11:00:18.489193 140347353020416 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.50
INFO:tensorflow:Starting iteration 29
I0910 11:00:18.520583 140347353020416 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 816330.09
I0910 11:00:18.522069 140347353020416 replay_runner.py:39] Average training steps per second: 816330.09

Done fixed training!Episode length: 203 Return: -203.0