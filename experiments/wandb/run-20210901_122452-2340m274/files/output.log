Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0901 12:24:59.796010 140196630247424 run_experiment.py:549] Creating TrainRunner ...
I0901 12:24:59.805985 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:24:59.806306 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:24:59.806423 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:24:59.806829 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:24:59.806977 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:24:59.807051 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:24:59.807174 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:24:59.807289 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:24:59.807526 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:24:59.807645 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:24:59.807861 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:24:59.808002 140196630247424 dqn_agent.py:283] 	 seed: 1630499099805904
I0901 12:24:59.810859 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:24:59.810985 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:24:59.811064 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:24:59.811129 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:24:59.811189 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:24:59.811271 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:24:59.811330 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:24:59.811381 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:24:59.811432 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:24:59.875787 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:00.432703 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:00.447131 140196630247424 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:25:00.456818 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:25:00.457098 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:25:00.457240 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:25:00.457375 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:25:00.457490 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:25:00.457601 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:25:00.457813 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:25:00.458019 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:25:00.458192 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:25:00.458313 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:25:00.458428 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:25:00.458542 140196630247424 dqn_agent.py:283] 	 seed: 1630499100456749
I0901 12:25:00.461617 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:25:00.461809 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:25:00.461966 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:25:00.462087 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:25:00.462275 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:25:00.462434 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:25:00.462586 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:25:00.462700 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:25:00.462807 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:25:00.499730 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:00.522561 140196630247424 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:25:00.522857 140196630247424 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.34
I0901 12:25:07.219500 140196630247424 replay_runner.py:36] Average training steps per second: 149.34
I0901 12:25:08.321624 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0901 12:25:08.540148 140196630247424 replay_runner.py:41] Starting iteration 1

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.27
I0901 12:25:13.714726 140196630247424 replay_runner.py:36] Average training steps per second: 193.27
I0901 12:25:13.842379 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.96
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 204.19
I0901 12:25:18.920367 140196630247424 replay_runner.py:36] Average training steps per second: 204.19
I0901 12:25:19.069556 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.76
INFO:tensorflow:Starting iteration 3

Steps executed: 272 Episode length: 96 Return: 96.0
INFO:tensorflow:Average training steps per second: 195.31
I0901 12:25:24.387125 140196630247424 replay_runner.py:36] Average training steps per second: 195.31
I0901 12:25:24.600460 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.67
INFO:tensorflow:Starting iteration 4

Steps executed: 275 Episode length: 85 Return: 85.0.0
INFO:tensorflow:Average training steps per second: 195.68
I0901 12:25:29.900915 140196630247424 replay_runner.py:36] Average training steps per second: 195.68
I0901 12:25:30.087964 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 91.67
INFO:tensorflow:Starting iteration 5
I0901 12:25:30.281941 140196630247424 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 188.00

Steps executed: 287 Episode length: 90 Return: 90.0.0
I0901 12:25:35.801168 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.67
INFO:tensorflow:Starting iteration 6

Steps executed: 313 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 193.74
I0901 12:25:41.153089 140196630247424 replay_runner.py:36] Average training steps per second: 193.74
I0901 12:25:41.373311 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 7

Steps executed: 214 Episode length: 81 Return: 81.0.0
INFO:tensorflow:Average training steps per second: 189.90
I0901 12:25:46.838796 140196630247424 replay_runner.py:36] Average training steps per second: 189.90
I0901 12:25:46.997716 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 71.33
INFO:tensorflow:Starting iteration 8

Steps executed: 252 Episode length: 59 Return: 59.0.0
INFO:tensorflow:Average training steps per second: 189.28
I0901 12:25:52.485291 140196630247424 replay_runner.py:36] Average training steps per second: 189.28
I0901 12:25:52.664005 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 63.00
INFO:tensorflow:Starting iteration 9

Steps executed: 212 Episode length: 65 Return: 65.0.0
INFO:tensorflow:Average training steps per second: 186.14
I0901 12:25:58.233960 140196630247424 replay_runner.py:36] Average training steps per second: 186.14
I0901 12:25:58.382067 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.67
INFO:tensorflow:Starting iteration 10

Steps executed: 231 Episode length: 68 Return: 68.0.0
INFO:tensorflow:Average training steps per second: 182.51
I0901 12:26:04.067638 140196630247424 replay_runner.py:36] Average training steps per second: 182.51
I0901 12:26:04.245030 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 77.00
INFO:tensorflow:Starting iteration 11
I0901 12:26:04.432764 140196630247424 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 185.52

Steps executed: 261 Episode length: 82 Return: 82.0.0
I0901 12:26:10.002138 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.00
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.42
I0901 12:26:15.559319 140196630247424 replay_runner.py:36] Average training steps per second: 186.42
I0901 12:26:15.706236 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0901 12:26:15.891085 140196630247424 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.73
I0901 12:26:21.053627 140196630247424 replay_runner.py:36] Average training steps per second: 193.73
I0901 12:26:21.204867 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 313 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 190.15
I0901 12:26:26.669734 140196630247424 replay_runner.py:36] Average training steps per second: 190.15
I0901 12:26:26.892668 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 15

Steps executed: 327 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 185.73
I0901 12:26:32.461838 140196630247424 replay_runner.py:36] Average training steps per second: 185.73
I0901 12:26:32.707087 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 16

Steps executed: 255 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 186.87
I0901 12:26:38.255542 140196630247424 replay_runner.py:36] Average training steps per second: 186.87
I0901 12:26:38.447555 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 17

Steps executed: 149 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 188.65
I0901 12:26:43.946146 140196630247424 replay_runner.py:36] Average training steps per second: 188.65

Steps executed: 319 Episode length: 170 Return: 170.0
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.48
I0901 12:26:49.674542 140196630247424 replay_runner.py:36] Average training steps per second: 188.48
I0901 12:26:49.821029 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:26:50.007185 140196630247424 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 169.55
I0901 12:26:55.905420 140196630247424 replay_runner.py:36] Average training steps per second: 169.55
I0901 12:26:56.045775 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 337 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 190.88
I0901 12:27:01.483316 140196630247424 replay_runner.py:36] Average training steps per second: 190.88
I0901 12:27:01.723659 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.10
I0901 12:27:07.186422 140196630247424 replay_runner.py:36] Average training steps per second: 190.10
I0901 12:27:07.334433 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 371 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 191.46
I0901 12:27:12.735897 140196630247424 replay_runner.py:36] Average training steps per second: 191.46
I0901 12:27:12.997534 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.50
INFO:tensorflow:Starting iteration 23

Steps executed: 366 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 189.00
I0901 12:27:18.491238 140196630247424 replay_runner.py:36] Average training steps per second: 189.00
I0901 12:27:18.756100 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.18
I0901 12:27:24.387035 140196630247424 replay_runner.py:36] Average training steps per second: 184.18
I0901 12:27:24.527967 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 12:27:24.700336 140196630247424 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 190.49
I0901 12:27:29.950310 140196630247424 replay_runner.py:36] Average training steps per second: 190.49
I0901 12:27:30.092528 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 382 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 196.01
I0901 12:27:35.366677 140196630247424 replay_runner.py:36] Average training steps per second: 196.01
I0901 12:27:35.645788 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.00
INFO:tensorflow:Starting iteration 27

Steps executed: 384 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.03
I0901 12:27:41.109871 140196630247424 replay_runner.py:36] Average training steps per second: 190.03
I0901 12:27:41.391613 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.51
I0901 12:27:46.884504 140196630247424 replay_runner.py:36] Average training steps per second: 188.51
I0901 12:27:47.024144 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 12:27:47.222950 140196630247424 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 198.95

Done fixed training!Episode length: 200 Return: 200.0
I0901 12:27:52.382098 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00