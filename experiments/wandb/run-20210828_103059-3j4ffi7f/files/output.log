Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0828 10:31:05.598579 140591351420928 run_experiment.py:549] Creating TrainRunner ...
I0828 10:31:05.609627 140591351420928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:31:05.609883 140591351420928 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:31:05.610055 140591351420928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:31:05.610185 140591351420928 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:31:05.610421 140591351420928 dqn_agent.py:275] 	 update_period: 4
I0828 10:31:05.610583 140591351420928 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:31:05.610718 140591351420928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:31:05.610826 140591351420928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:31:05.610934 140591351420928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:31:05.611038 140591351420928 dqn_agent.py:280] 	 optimizer: adam
I0828 10:31:05.611142 140591351420928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:31:05.611242 140591351420928 dqn_agent.py:283] 	 seed: 1630146665609567
I0828 10:31:05.614250 140591351420928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:31:05.614614 140591351420928 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:31:05.614829 140591351420928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:31:05.614971 140591351420928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:31:05.615143 140591351420928 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:31:05.615341 140591351420928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:31:05.615472 140591351420928 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:31:05.615654 140591351420928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:31:05.615786 140591351420928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:31:05.665511 140591351420928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:06.419902 140591351420928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:06.436719 140591351420928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:31:06.445243 140591351420928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:31:06.445556 140591351420928 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:31:06.445760 140591351420928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:31:06.445897 140591351420928 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:31:06.446221 140591351420928 dqn_agent.py:275] 	 update_period: 4
I0828 10:31:06.446386 140591351420928 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:31:06.446498 140591351420928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:31:06.446620 140591351420928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:31:06.446696 140591351420928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:31:06.446800 140591351420928 dqn_agent.py:280] 	 optimizer: adam
I0828 10:31:06.446856 140591351420928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:31:06.446923 140591351420928 dqn_agent.py:283] 	 seed: 1630146666445160
I0828 10:31:06.449978 140591351420928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:31:06.450186 140591351420928 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:31:06.450328 140591351420928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:31:06.450472 140591351420928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:31:06.450651 140591351420928 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:31:06.450723 140591351420928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:31:06.450786 140591351420928 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:31:06.450865 140591351420928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:31:06.450994 140591351420928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:31:06.491214 140591351420928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:31:06.515147 140591351420928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:31:06.515515 140591351420928 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.28
I0828 10:31:13.259963 140591351420928 replay_runner.py:36] Average training steps per second: 148.28
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:31:14.806163 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:31:15.054712 140591351420928 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.00
I0828 10:31:20.156999 140591351420928 replay_runner.py:36] Average training steps per second: 196.00
I0828 10:31:20.549818 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:31:20.787148 140591351420928 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.86
I0828 10:31:25.972856 140591351420928 replay_runner.py:36] Average training steps per second: 192.86
I0828 10:31:26.410360 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 349 Episode length: 155 Return: -154.0
INFO:tensorflow:Average training steps per second: 197.75
I0828 10:31:31.707556 140591351420928 replay_runner.py:36] Average training steps per second: 197.75
I0828 10:31:32.010922 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.50
INFO:tensorflow:Starting iteration 4
I0828 10:31:32.259695 140591351420928 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 189.66

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:31:37.938782 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 227 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 187.54
I0828 10:31:43.512790 140591351420928 replay_runner.py:36] Average training steps per second: 187.54
I0828 10:31:43.712601 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 6
I0828 10:31:43.954183 140591351420928 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 197.81

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:31:49.432143 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0828 10:31:49.679781 140591351420928 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.81
I0828 10:31:54.920940 140591351420928 replay_runner.py:36] Average training steps per second: 190.81
I0828 10:31:55.328855 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 261 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 195.26
I0828 10:32:00.685927 140591351420928 replay_runner.py:36] Average training steps per second: 195.26
I0828 10:32:00.908791 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.40
I0828 10:32:06.256347 140591351420928 replay_runner.py:36] Average training steps per second: 195.40
I0828 10:32:06.664283 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:32:06.902971 140591351420928 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 189.30
I0828 10:32:12.186071 140591351420928 replay_runner.py:36] Average training steps per second: 189.30
I0828 10:32:12.601376 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:32:12.841436 140591351420928 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 195.77
I0828 10:32:17.949969 140591351420928 replay_runner.py:36] Average training steps per second: 195.77
I0828 10:32:18.389204 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 684 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.16
I0828 10:32:23.874050 140591351420928 replay_runner.py:36] Average training steps per second: 191.16
I0828 10:32:24.407638 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.50
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.85
I0828 10:32:29.909940 140591351420928 replay_runner.py:36] Average training steps per second: 189.85
I0828 10:32:30.332870 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:32:30.565658 140591351420928 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 204.34
I0828 10:32:35.459956 140591351420928 replay_runner.py:36] Average training steps per second: 204.34
I0828 10:32:35.863116 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:32:36.111294 140591351420928 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 195.74
I0828 10:32:41.220577 140591351420928 replay_runner.py:36] Average training steps per second: 195.74
I0828 10:32:41.609978 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:32:41.846910 140591351420928 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 198.70
I0828 10:32:46.880085 140591351420928 replay_runner.py:36] Average training steps per second: 198.70
I0828 10:32:47.254003 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 222 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 193.16
I0828 10:32:52.662594 140591351420928 replay_runner.py:36] Average training steps per second: 193.16
I0828 10:32:52.895739 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 18

Steps executed: 287 Episode length: 287 Return: -286.0
INFO:tensorflow:Average training steps per second: 195.99
I0828 10:32:58.242656 140591351420928 replay_runner.py:36] Average training steps per second: 195.99
I0828 10:32:58.477874 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.00
INFO:tensorflow:Starting iteration 19
I0828 10:32:58.715254 140591351420928 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 194.13

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:33:04.274083 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:33:04.518226 140591351420928 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.52
I0828 10:33:09.530828 140591351420928 replay_runner.py:36] Average training steps per second: 199.52
I0828 10:33:09.980707 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:33:10.225997 140591351420928 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.34
I0828 10:33:15.319607 140591351420928 replay_runner.py:36] Average training steps per second: 196.34
I0828 10:33:15.691623 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:33:15.914368 140591351420928 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 205.29
I0828 10:33:20.785868 140591351420928 replay_runner.py:36] Average training steps per second: 205.29
I0828 10:33:21.221272 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:33:21.473442 140591351420928 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 202.19
I0828 10:33:26.419683 140591351420928 replay_runner.py:36] Average training steps per second: 202.19
I0828 10:33:26.790654 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:33:27.016412 140591351420928 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 200.10
I0828 10:33:32.014314 140591351420928 replay_runner.py:36] Average training steps per second: 200.10
I0828 10:33:32.392902 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:33:32.621047 140591351420928 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.23
I0828 10:33:37.743626 140591351420928 replay_runner.py:36] Average training steps per second: 195.23
I0828 10:33:38.151424 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:33:38.393664 140591351420928 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 206.57
I0828 10:33:43.235096 140591351420928 replay_runner.py:36] Average training steps per second: 206.57
I0828 10:33:43.634008 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:33:43.864557 140591351420928 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.71
I0828 10:33:49.053980 140591351420928 replay_runner.py:36] Average training steps per second: 192.71
I0828 10:33:49.447487 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:33:49.687811 140591351420928 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 200.81
I0828 10:33:54.668097 140591351420928 replay_runner.py:36] Average training steps per second: 200.81
I0828 10:33:55.072625 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.30
I0828 10:34:00.287075 140591351420928 replay_runner.py:36] Average training steps per second: 201.30
I0828 10:34:00.665603 140591351420928 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00