Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 00:38:07.448693 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:38:07.456704 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:07.456834 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:07.456907 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:07.456967 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:07.457023 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:07.457099 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:07.457201 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:07.457289 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:07.457359 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:07.457435 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:07.457511 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:07.457582 139965167532032 dqn_agent.py:283] 	 seed: 1630543087456670
I0902 00:38:07.459322 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:07.459437 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:07.459521 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:07.459584 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:07.459653 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:07.459720 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:07.459785 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:07.459859 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:07.459925 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:07.484527 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:07.732765 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:07.740804 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:38:07.746421 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:07.746553 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:07.746633 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:07.746694 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:07.746751 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:07.746901 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:07.746980 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:07.747129 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:07.747227 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:07.747299 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:07.747385 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:07.747473 139965167532032 dqn_agent.py:283] 	 seed: 1630543087746393
I0902 00:38:07.749607 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:07.749728 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:07.749806 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:07.749877 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:07.749942 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:07.750027 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:07.750125 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:07.750185 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:07.750256 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:07.769891 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:07.785901 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:38:07.786043 139965167532032 replay_runner.py:41] Starting iteration 0
Steps executed: 333 Episode length: 146 Return: -122.31413367990037
INFO:tensorflow:Average training steps per second: 242.72
I0902 00:38:11.906180 139965167532032 replay_runner.py:36] Average training steps per second: 242.72
I0902 00:38:12.841378 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.61
INFO:tensorflow:Starting iteration 1
I0902 00:38:16.076167 139965167532032 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 353.98

Steps executed: 235 Episode length: 235 Return: -169.22057976052474
I0902 00:38:19.063716 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.22
INFO:tensorflow:Starting iteration 2

Steps executed: 213 Episode length: 98 Return: -246.514409629663724
INFO:tensorflow:Average training steps per second: 323.42
I0902 00:38:25.472871 139965167532032 replay_runner.py:36] Average training steps per second: 323.42
I0902 00:38:25.611835 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.02
INFO:tensorflow:Starting iteration 3

Steps executed: 213 Episode length: 71 Return: -590.721949676902224
INFO:tensorflow:Average training steps per second: 325.84
I0902 00:38:31.983669 139965167532032 replay_runner.py:36] Average training steps per second: 325.84
I0902 00:38:32.122052 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -635.28
INFO:tensorflow:Starting iteration 4

Steps executed: 215 Episode length: 92 Return: -178.220072423747724
INFO:tensorflow:Average training steps per second: 325.12
I0902 00:38:38.486958 139965167532032 replay_runner.py:36] Average training steps per second: 325.12
I0902 00:38:38.617947 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.49
INFO:tensorflow:Starting iteration 5

Steps executed: 229 Episode length: 54 Return: -301.575854445652124
INFO:tensorflow:Average training steps per second: 327.79
I0902 00:38:45.017687 139965167532032 replay_runner.py:36] Average training steps per second: 327.79
I0902 00:38:45.153434 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -492.28
INFO:tensorflow:Starting iteration 6

Steps executed: 207 Episode length: 85 Return: -814.069344723391724
INFO:tensorflow:Average training steps per second: 335.47
I0902 00:38:51.573413 139965167532032 replay_runner.py:36] Average training steps per second: 335.47
I0902 00:38:51.703783 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -576.60
INFO:tensorflow:Starting iteration 7

Steps executed: 227 Episode length: 59 Return: -630.706274667988524
INFO:tensorflow:Average training steps per second: 343.51
I0902 00:38:58.032043 139965167532032 replay_runner.py:36] Average training steps per second: 343.51
I0902 00:38:58.170448 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.30
INFO:tensorflow:Starting iteration 8

Steps executed: 224 Episode length: 85 Return: -721.683139092357224
INFO:tensorflow:Average training steps per second: 337.15
I0902 00:39:04.579041 139965167532032 replay_runner.py:36] Average training steps per second: 337.15
I0902 00:39:04.708497 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -699.46
INFO:tensorflow:Starting iteration 9

Steps executed: 267 Episode length: 80 Return: -736.658625952777424
INFO:tensorflow:Average training steps per second: 335.15
I0902 00:39:11.119619 139965167532032 replay_runner.py:36] Average training steps per second: 335.15
I0902 00:39:11.280411 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -652.85
INFO:tensorflow:Starting iteration 10

Steps executed: 245 Episode length: 66 Return: -643.135492536059464
INFO:tensorflow:Average training steps per second: 342.60
I0902 00:39:17.621146 139965167532032 replay_runner.py:36] Average training steps per second: 342.60
I0902 00:39:17.766271 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.90
INFO:tensorflow:Starting iteration 11

Steps executed: 318 Episode length: 318 Return: -1026.9625121600774
INFO:tensorflow:Average training steps per second: 341.94
I0902 00:39:24.148546 139965167532032 replay_runner.py:36] Average training steps per second: 341.94
I0902 00:39:24.424877 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -1026.96
INFO:tensorflow:Starting iteration 12

Steps executed: 273 Episode length: 85 Return: -360.243831996435743
INFO:tensorflow:Average training steps per second: 342.55
I0902 00:39:30.806445 139965167532032 replay_runner.py:36] Average training steps per second: 342.55
I0902 00:39:30.969238 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.94
INFO:tensorflow:Starting iteration 13

Steps executed: 162 Episode length: 162 Return: -701.14868531137843
INFO:tensorflow:Average training steps per second: 346.26
I0902 00:39:37.303786 139965167532032 replay_runner.py:36] Average training steps per second: 346.26

Steps executed: 338 Episode length: 176 Return: -393.73360985599174
INFO:tensorflow:Starting iteration 14

Steps executed: 201 Episode length: 110 Return: -516.78944718951974
INFO:tensorflow:Average training steps per second: 346.49
I0902 00:39:43.885749 139965167532032 replay_runner.py:36] Average training steps per second: 346.49
I0902 00:39:44.011911 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.00
INFO:tensorflow:Starting iteration 15

Steps executed: 296 Episode length: 120 Return: -146.06637330734324
INFO:tensorflow:Average training steps per second: 349.20
I0902 00:39:50.349588 139965167532032 replay_runner.py:36] Average training steps per second: 349.20
I0902 00:39:50.504475 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.07
INFO:tensorflow:Starting iteration 16

Steps executed: 277 Episode length: 80 Return: -249.675804421347974
INFO:tensorflow:Average training steps per second: 349.59
I0902 00:39:56.846061 139965167532032 replay_runner.py:36] Average training steps per second: 349.59
I0902 00:39:57.018306 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.55
INFO:tensorflow:Starting iteration 17

Steps executed: 314 Episode length: 251 Return: -850.26809136785764
INFO:tensorflow:Average training steps per second: 351.88
I0902 00:40:03.373769 139965167532032 replay_runner.py:36] Average training steps per second: 351.88
I0902 00:40:03.605779 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -532.60
INFO:tensorflow:Starting iteration 18

Steps executed: 215 Episode length: 74 Return: -577.211647685238364
INFO:tensorflow:Average training steps per second: 337.55
I0902 00:40:10.077625 139965167532032 replay_runner.py:36] Average training steps per second: 337.55
I0902 00:40:10.190489 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.17
INFO:tensorflow:Starting iteration 19

Steps executed: 216 Episode length: 78 Return: -708.055663209151154
INFO:tensorflow:Average training steps per second: 344.35
I0902 00:40:16.601575 139965167532032 replay_runner.py:36] Average training steps per second: 344.35
I0902 00:40:16.709017 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.89
INFO:tensorflow:Starting iteration 20

Steps executed: 247 Episode length: 88 Return: -387.613310482822954
INFO:tensorflow:Average training steps per second: 348.28
I0902 00:40:23.084355 139965167532032 replay_runner.py:36] Average training steps per second: 348.28
I0902 00:40:23.219587 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.35
INFO:tensorflow:Starting iteration 21

Steps executed: 204 Episode length: 61 Return: -400.602472354055644
INFO:tensorflow:Average training steps per second: 348.34
I0902 00:40:29.590153 139965167532032 replay_runner.py:36] Average training steps per second: 348.34
I0902 00:40:29.690518 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.17
INFO:tensorflow:Starting iteration 22

Steps executed: 243 Episode length: 62 Return: -340.497619616671734
INFO:tensorflow:Average training steps per second: 347.97
I0902 00:40:36.038538 139965167532032 replay_runner.py:36] Average training steps per second: 347.97
I0902 00:40:36.149993 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.92
INFO:tensorflow:Starting iteration 23

Steps executed: 218 Episode length: 84 Return: -437.549541697163224
INFO:tensorflow:Average training steps per second: 347.72
I0902 00:40:42.510987 139965167532032 replay_runner.py:36] Average training steps per second: 347.72
I0902 00:40:42.617287 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.56
INFO:tensorflow:Starting iteration 24

Steps executed: 212 Episode length: 71 Return: -357.632179612034524
INFO:tensorflow:Average training steps per second: 343.79
I0902 00:40:48.977540 139965167532032 replay_runner.py:36] Average training steps per second: 343.79
I0902 00:40:49.073324 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.66
INFO:tensorflow:Starting iteration 25
I0902 00:40:52.529963 139965167532032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 341.78
I0902 00:40:55.456222 139965167532032 replay_runner.py:36] Average training steps per second: 341.78

Steps executed: 206 Episode length: 61 Return: -460.411864151513424
INFO:tensorflow:Starting iteration 26

Steps executed: 242 Episode length: 53 Return: -345.855722446139574
INFO:tensorflow:Average training steps per second: 351.07
I0902 00:41:01.833168 139965167532032 replay_runner.py:36] Average training steps per second: 351.07
I0902 00:41:01.959882 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.56
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 64 Return: -612.257772548580174
INFO:tensorflow:Average training steps per second: 361.81
I0902 00:41:08.104244 139965167532032 replay_runner.py:36] Average training steps per second: 361.81
I0902 00:41:08.208279 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -493.83
INFO:tensorflow:Starting iteration 28

Steps executed: 241 Episode length: 54 Return: -365.391177844559934
INFO:tensorflow:Average training steps per second: 352.53
I0902 00:41:14.337981 139965167532032 replay_runner.py:36] Average training steps per second: 352.53
I0902 00:41:14.443934 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.12
INFO:tensorflow:Starting iteration 29

Steps executed: 254 Episode length: 55 Return: -93.1705791848950634
INFO:tensorflow:Average training steps per second: 353.11
I0902 00:41:20.586254 139965167532032 replay_runner.py:36] Average training steps per second: 353.11

Done fixed training!Episode length: 55 Return: -93.1705791848950634