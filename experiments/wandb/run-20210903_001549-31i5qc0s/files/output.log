Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0903 00:15:55.457205 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0903 00:15:55.465527 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:15:55.465656 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:15:55.465732 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:15:55.465790 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:15:55.465852 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:15:55.465929 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:15:55.466023 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:15:55.466089 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:15:55.466154 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:15:55.466237 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:15:55.466310 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:15:55.466376 139819819333632 dqn_agent.py:283] 	 seed: 1630628155465493
I0903 00:15:55.468877 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:15:55.469034 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:15:55.469172 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:15:55.469463 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:15:55.469615 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:15:55.469766 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:15:55.469851 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:15:55.469940 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:15:55.470034 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:15:55.495703 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:55.752991 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:55.762286 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:15:55.769239 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:15:55.769384 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:15:55.769477 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:15:55.769549 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:15:55.769610 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:15:55.769740 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:15:55.769837 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:15:55.769942 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:15:55.770017 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:15:55.770078 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:15:55.770150 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:15:55.770215 139819819333632 dqn_agent.py:283] 	 seed: 1630628155769206
I0903 00:15:55.771798 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:15:55.771925 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:15:55.772006 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:15:55.772074 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:15:55.772138 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:15:55.772201 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:15:55.772262 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:15:55.772347 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:15:55.772422 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:15:55.793876 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:55.811200 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:15:55.811403 139819819333632 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 242.80
I0903 00:15:59.930203 139819819333632 replay_runner.py:36] Average training steps per second: 242.80
I0903 00:16:00.799671 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.78
Steps executed: 313 Episode length: 123 Return: -391.2435460506878
INFO:tensorflow:Starting iteration 1

Steps executed: 260 Episode length: 71 Return: -360.90594736488483
INFO:tensorflow:Average training steps per second: 337.40
I0903 00:16:07.108983 139819819333632 replay_runner.py:36] Average training steps per second: 337.40
I0903 00:16:07.241843 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.89
INFO:tensorflow:Starting iteration 2
I0903 00:16:10.660051 139819819333632 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 351.96
I0903 00:16:13.501580 139819819333632 replay_runner.py:36] Average training steps per second: 351.96

Steps executed: 447 Episode length: 447 Return: -344.0278137278228
INFO:tensorflow:Starting iteration 3

Steps executed: 238 Episode length: 112 Return: -291.45997167704763
INFO:tensorflow:Average training steps per second: 336.05
I0903 00:16:20.477454 139819819333632 replay_runner.py:36] Average training steps per second: 336.05
I0903 00:16:20.617742 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.54
INFO:tensorflow:Starting iteration 4

Steps executed: 196 Episode length: 93 Return: -324.858078766270385
INFO:tensorflow:Average training steps per second: 352.73

Steps executed: 882 Episode length: 686 Return: -411.20990780466786
I0903 00:16:28.648277 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.23
INFO:tensorflow:Starting iteration 5
I0903 00:16:32.002503 139819819333632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 322.43

Steps executed: 1000 Episode length: 1000 Return: -201.69873171470138
I0903 00:16:37.408746 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.70
INFO:tensorflow:Starting iteration 6

Steps executed: 710 Episode length: 710 Return: -387.4199659170302138
INFO:tensorflow:Average training steps per second: 355.39
I0903 00:16:43.717954 139819819333632 replay_runner.py:36] Average training steps per second: 355.39
I0903 00:16:44.630131 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.42
INFO:tensorflow:Starting iteration 7

Steps executed: 140 Episode length: 140 Return: -351.0413924187924138
INFO:tensorflow:Average training steps per second: 357.32
I0903 00:16:50.955000 139819819333632 replay_runner.py:36] Average training steps per second: 357.32

Steps executed: 467 Episode length: 327 Return: -428.1410004797812138
INFO:tensorflow:Starting iteration 8

Steps executed: 460 Episode length: 460 Return: -562.9175077204923138
INFO:tensorflow:Average training steps per second: 345.97
I0903 00:16:57.656559 139819819333632 replay_runner.py:36] Average training steps per second: 345.97
I0903 00:16:58.116535 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -562.92
INFO:tensorflow:Starting iteration 9

Steps executed: 251 Episode length: 56 Return: -193.92892815004123138
INFO:tensorflow:Average training steps per second: 339.18
I0903 00:17:04.496929 139819819333632 replay_runner.py:36] Average training steps per second: 339.18
I0903 00:17:04.627976 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.65
INFO:tensorflow:Starting iteration 10
I0903 00:17:08.107805 139819819333632 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 335.83

Steps executed: 1000 Episode length: 1000 Return: -302.65437150579968
I0903 00:17:13.106621 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.65
INFO:tensorflow:Starting iteration 11
I0903 00:17:16.624161 139819819333632 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 349.18

Steps executed: 574 Episode length: 574 Return: -435.2814916886425968
I0903 00:17:20.452446 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.28
INFO:tensorflow:Starting iteration 12
I0903 00:17:23.966480 139819819333632 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 360.29

Steps executed: 924 Episode length: 924 Return: -3003.695632339790368
I0903 00:17:28.105955 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -3003.70
INFO:tensorflow:Starting iteration 13

Steps executed: 59 Episode length: 59 Return: -181.935136626631490368
INFO:tensorflow:Average training steps per second: 352.07

Steps executed: 1059 Episode length: 1000 Return: -145.29557800075327
I0903 00:17:36.564806 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.62
INFO:tensorflow:Starting iteration 14

Steps executed: 189 Episode length: 189 Return: 40.514415475006535327
INFO:tensorflow:Average training steps per second: 327.04
I0903 00:17:42.905772 139819819333632 replay_runner.py:36] Average training steps per second: 327.04

Steps executed: 715 Episode length: 526 Return: -680.2215434053775327
INFO:tensorflow:Starting iteration 15

Steps executed: 308 Episode length: 138 Return: -515.2675748569825327
INFO:tensorflow:Average training steps per second: 313.47
I0903 00:17:50.097934 139819819333632 replay_runner.py:36] Average training steps per second: 313.47
I0903 00:17:50.291474 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.96
INFO:tensorflow:Starting iteration 16

Steps executed: 159 Episode length: 67 Return: -134.99793228016375327
INFO:tensorflow:Average training steps per second: 313.56

Steps executed: 1159 Episode length: 1000 Return: -313.40980024517313
I0903 00:17:59.127812 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.87
INFO:tensorflow:Starting iteration 17

Steps executed: 215 Episode length: 215 Return: -235.6874149847257613
INFO:tensorflow:Average training steps per second: 328.13
I0903 00:18:05.521515 139819819333632 replay_runner.py:36] Average training steps per second: 328.13
I0903 00:18:05.641745 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.69
INFO:tensorflow:Starting iteration 18

Steps executed: 278 Episode length: 79 Return: -179.85398868326058613
INFO:tensorflow:Average training steps per second: 311.24
I0903 00:18:12.144347 139819819333632 replay_runner.py:36] Average training steps per second: 311.24
I0903 00:18:12.276353 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.62
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 58 Return: -266.36629313533712913
INFO:tensorflow:Average training steps per second: 316.95
I0903 00:18:18.702326 139819819333632 replay_runner.py:36] Average training steps per second: 316.95
I0903 00:18:18.802381 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.94
INFO:tensorflow:Starting iteration 20

Steps executed: 244 Episode length: 54 Return: -183.05647564350443913
INFO:tensorflow:Average training steps per second: 311.99
I0903 00:18:25.208906 139819819333632 replay_runner.py:36] Average training steps per second: 311.99
I0903 00:18:25.359606 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.64
INFO:tensorflow:Starting iteration 21

Steps executed: 82 Episode length: 82 Return: -568.116714284909243913
INFO:tensorflow:Average training steps per second: 308.14
I0903 00:18:31.799749 139819819333632 replay_runner.py:36] Average training steps per second: 308.14

Steps executed: 267 Episode length: 101 Return: -421.9880358938748913
INFO:tensorflow:Starting iteration 22

Steps executed: 168 Episode length: 168 Return: -115.9961477583978313
INFO:tensorflow:Average training steps per second: 310.60
I0903 00:18:38.346562 139819819333632 replay_runner.py:36] Average training steps per second: 310.60

Steps executed: 873 Episode length: 705 Return: -425.6423579557489313
INFO:tensorflow:Starting iteration 23
I0903 00:18:42.874194 139819819333632 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 326.09
I0903 00:18:45.941063 139819819333632 replay_runner.py:36] Average training steps per second: 326.09

Steps executed: 206 Episode length: 148 Return: -77.85753546106093313
INFO:tensorflow:Starting iteration 24

Steps executed: 255 Episode length: 135 Return: -687.1583094672956713
INFO:tensorflow:Average training steps per second: 315.82
I0903 00:18:52.400569 139819819333632 replay_runner.py:36] Average training steps per second: 315.82
I0903 00:18:52.527581 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.92
INFO:tensorflow:Starting iteration 25

Steps executed: 264 Episode length: 91 Return: -475.92482096409947713
INFO:tensorflow:Average training steps per second: 320.80
I0903 00:18:58.737884 139819819333632 replay_runner.py:36] Average training steps per second: 320.80
I0903 00:18:58.881852 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.58
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 102 Return: -479.4074959380814713
INFO:tensorflow:Average training steps per second: 336.87
I0903 00:19:05.086938 139819819333632 replay_runner.py:36] Average training steps per second: 336.87
I0903 00:19:05.203326 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.58
INFO:tensorflow:Starting iteration 27
I0903 00:19:08.534459 139819819333632 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 331.47
I0903 00:19:11.551577 139819819333632 replay_runner.py:36] Average training steps per second: 331.47

Steps executed: 202 Episode length: 202 Return: -133.6680987337567213
INFO:tensorflow:Starting iteration 28

Steps executed: 285 Episode length: 103 Return: -344.3329410160387213
INFO:tensorflow:Average training steps per second: 335.25
I0903 00:19:17.864517 139819819333632 replay_runner.py:36] Average training steps per second: 335.25
I0903 00:19:17.990538 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.14
INFO:tensorflow:Starting iteration 29

Steps executed: 322 Episode length: 147 Return: -204.0099926840326213
INFO:tensorflow:Average training steps per second: 323.26
I0903 00:19:24.296251 139819819333632 replay_runner.py:36] Average training steps per second: 323.26

Done fixed training!Episode length: 147 Return: -204.0099926840326213