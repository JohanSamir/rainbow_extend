I0909 13:35:18.446537 140252157974528 run_experiment.py:549] Creating TrainRunner ...
I0909 13:35:18.453946 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:18.454101 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:18.454222 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:18.454335 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:18.454442 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:18.454546 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:18.454678 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:18.454848 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:18.454968 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:18.455073 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:18.455178 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:18.455315 140252157974528 dqn_agent.py:283] 	 seed: 1631194518453904
I0909 13:35:18.457923 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:18.458054 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:18.458160 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:18.458259 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:18.458351 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:18.458439 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:18.458525 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:18.458631 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:18.458754 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:35:19.494369 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:19.648599 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:19.656669 140252157974528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:35:19.661228 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:19.661348 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:19.661413 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:19.661515 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:19.661573 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:19.661631 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:19.661722 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:19.661798 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:19.661871 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:19.661934 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:19.662002 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:19.662075 140252157974528 dqn_agent.py:283] 	 seed: 1631194519661203
I0909 13:35:19.663435 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:19.663562 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:19.663647 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:19.663714 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:19.663777 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:19.663833 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:19.663904 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:19.663973 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:19.664035 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:35:19.681858 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:19.693493 140252157974528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:35:19.693614 140252157974528 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 251.20
I0909 13:35:23.674637 140252157974528 replay_runner.py:36] Average training steps per second: 251.20
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:35:24.528188 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:35:24.616397 140252157974528 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 275.14
I0909 13:35:28.251316 140252157974528 replay_runner.py:36] Average training steps per second: 275.14
I0909 13:35:28.455976 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:35:28.535262 140252157974528 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 279.28
I0909 13:35:32.116162 140252157974528 replay_runner.py:36] Average training steps per second: 279.28
I0909 13:35:32.349975 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:35:32.437092 140252157974528 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 263.95
I0909 13:35:36.226036 140252157974528 replay_runner.py:36] Average training steps per second: 263.95
I0909 13:35:36.440860 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:35:36.525502 140252157974528 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 264.87
I0909 13:35:40.301487 140252157974528 replay_runner.py:36] Average training steps per second: 264.87
I0909 13:35:40.559245 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5

Steps executed: 704 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 267.64
I0909 13:35:44.384075 140252157974528 replay_runner.py:36] Average training steps per second: 267.64
I0909 13:35:44.667174 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.00
INFO:tensorflow:Starting iteration 6

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 271.14
I0909 13:35:48.446735 140252157974528 replay_runner.py:36] Average training steps per second: 271.14
I0909 13:35:48.698019 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:35:48.793503 140252157974528 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 267.72
I0909 13:35:52.529162 140252157974528 replay_runner.py:36] Average training steps per second: 267.72
I0909 13:35:52.789517 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:35:52.878476 140252157974528 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 271.12
I0909 13:35:56.567213 140252157974528 replay_runner.py:36] Average training steps per second: 271.12
I0909 13:35:56.816837 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:35:56.907299 140252157974528 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 264.96
I0909 13:36:00.681840 140252157974528 replay_runner.py:36] Average training steps per second: 264.96
I0909 13:36:00.920093 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 210 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 272.31
I0909 13:36:04.682654 140252157974528 replay_runner.py:36] Average training steps per second: 272.31
I0909 13:36:04.765151 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 11
I0909 13:36:04.854711 140252157974528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 266.34

Steps executed: 325 Episode length: 159 Return: -159.0
I0909 13:36:08.750165 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.50
INFO:tensorflow:Starting iteration 12
I0909 13:36:08.841036 140252157974528 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 270.30
I0909 13:36:12.540981 140252157974528 replay_runner.py:36] Average training steps per second: 270.30

Steps executed: 261 Episode length: 175 Return: -175.0
INFO:tensorflow:Starting iteration 13

Steps executed: 253 Episode length: 162 Return: -162.0
INFO:tensorflow:Average training steps per second: 271.42
I0909 13:36:16.418539 140252157974528 replay_runner.py:36] Average training steps per second: 271.42
I0909 13:36:16.529603 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 14

Steps executed: 294 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 266.40
I0909 13:36:20.374899 140252157974528 replay_runner.py:36] Average training steps per second: 266.40
I0909 13:36:20.499721 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 15

Steps executed: 214 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 270.55
I0909 13:36:24.285854 140252157974528 replay_runner.py:36] Average training steps per second: 270.55
I0909 13:36:24.377672 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 16

Steps executed: 206 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 264.22
I0909 13:36:28.252941 140252157974528 replay_runner.py:36] Average training steps per second: 264.22
I0909 13:36:28.338591 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 17

Steps executed: 223 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 261.40
I0909 13:36:32.263460 140252157974528 replay_runner.py:36] Average training steps per second: 261.40
I0909 13:36:32.357285 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 264.68
I0909 13:36:36.228958 140252157974528 replay_runner.py:36] Average training steps per second: 264.68
I0909 13:36:36.337626 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 19

Steps executed: 213 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 260.55
I0909 13:36:40.265974 140252157974528 replay_runner.py:36] Average training steps per second: 260.55
I0909 13:36:40.356373 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 20

Steps executed: 276 Episode length: 85 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 269.92
I0909 13:36:44.160227 140252157974528 replay_runner.py:36] Average training steps per second: 269.92
I0909 13:36:44.272075 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 21

Steps executed: 220 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 266.49
I0909 13:36:48.116292 140252157974528 replay_runner.py:36] Average training steps per second: 266.49
I0909 13:36:48.208333 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 22

Steps executed: 238 Episode length: 94 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 266.15
I0909 13:36:52.054666 140252157974528 replay_runner.py:36] Average training steps per second: 266.15
I0909 13:36:52.155042 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 23

Steps executed: 295 Episode length: 295 Return: -295.0
INFO:tensorflow:Average training steps per second: 261.82
I0909 13:36:56.066002 140252157974528 replay_runner.py:36] Average training steps per second: 261.82
I0909 13:36:56.186240 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.00
INFO:tensorflow:Starting iteration 24

Steps executed: 248 Episode length: 140 Return: -140.0
INFO:tensorflow:Average training steps per second: 258.94
I0909 13:37:00.138580 140252157974528 replay_runner.py:36] Average training steps per second: 258.94
I0909 13:37:00.244587 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 261.30
I0909 13:37:04.164339 140252157974528 replay_runner.py:36] Average training steps per second: 261.30
I0909 13:37:04.250064 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 26

Steps executed: 215 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 264.87
I0909 13:37:08.111637 140252157974528 replay_runner.py:36] Average training steps per second: 264.87
I0909 13:37:08.199327 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 27

Steps executed: 224 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 269.02
I0909 13:37:12.002384 140252157974528 replay_runner.py:36] Average training steps per second: 269.02
I0909 13:37:12.098384 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 28

Steps executed: 373 Episode length: 185 Return: -185.0
INFO:tensorflow:Average training steps per second: 264.29
I0909 13:37:15.967905 140252157974528 replay_runner.py:36] Average training steps per second: 264.29
I0909 13:37:16.127283 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 264.83
I0909 13:37:19.989035 140252157974528 replay_runner.py:36] Average training steps per second: 264.83
I0909 13:37:20.088507 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50