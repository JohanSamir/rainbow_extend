I0901 13:26:04.068455 139803418769408 run_experiment.py:549] Creating TrainRunner ...
I0901 13:26:04.076306 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:26:04.076442 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:26:04.076521 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:26:04.076582 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:26:04.076637 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:26:04.076721 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:26:04.076874 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:26:04.076960 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:26:04.077030 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:26:04.077110 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:26:04.077182 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:26:04.077250 139803418769408 dqn_agent.py:283] 	 seed: 1630502764076267
I0901 13:26:04.079225 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:26:04.079341 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:26:04.079437 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:26:04.079517 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:26:04.079612 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:26:04.079702 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:26:04.079802 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:26:04.079893 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:26:04.079946 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:26:05.201064 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:05.500154 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:05.510179 139803418769408 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:26:05.516748 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:26:05.516959 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:26:05.517078 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:26:05.517188 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:26:05.517270 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:26:05.517339 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:26:05.517450 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:26:05.517565 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:26:05.517639 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:26:05.517735 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:26:05.517809 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:26:05.517909 139803418769408 dqn_agent.py:283] 	 seed: 1630502765516715
I0901 13:26:05.519591 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:26:05.519709 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:26:05.519786 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:26:05.519856 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:26:05.519925 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:26:05.519993 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:26:05.520093 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:26:05.520193 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:26:05.520293 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:26:05.541232 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:05.555863 139803418769408 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:26:05.556024 139803418769408 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 249.17
I0901 13:26:09.569538 139803418769408 replay_runner.py:36] Average training steps per second: 249.17
Steps executed: 254 Episode length: 94 Return: -622.213722458670493
I0901 13:26:10.459347 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.65
INFO:tensorflow:Starting iteration 1

Steps executed: 273 Episode length: 169 Return: -72.613137631638283
INFO:tensorflow:Average training steps per second: 328.49
I0901 13:26:16.817636 139803418769408 replay_runner.py:36] Average training steps per second: 328.49
I0901 13:26:16.980377 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.30
INFO:tensorflow:Starting iteration 2

Steps executed: 249 Episode length: 120 Return: -135.37158580375352
INFO:tensorflow:Average training steps per second: 355.50
I0901 13:26:23.043423 139803418769408 replay_runner.py:36] Average training steps per second: 355.50
I0901 13:26:23.175820 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.11
INFO:tensorflow:Starting iteration 3

Steps executed: 304 Episode length: 183 Return: -261.02001644977252
INFO:tensorflow:Average training steps per second: 343.76
I0901 13:26:29.346826 139803418769408 replay_runner.py:36] Average training steps per second: 343.76
I0901 13:26:29.515993 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.11
INFO:tensorflow:Starting iteration 4

Steps executed: 253 Episode length: 253 Return: -74.575436284505462
INFO:tensorflow:Average training steps per second: 350.98
I0901 13:26:35.405341 139803418769408 replay_runner.py:36] Average training steps per second: 350.98
I0901 13:26:35.670783 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.58
INFO:tensorflow:Starting iteration 5

Steps executed: 342 Episode length: 145 Return: -309.14898936032872
INFO:tensorflow:Average training steps per second: 392.34
I0901 13:26:41.480639 139803418769408 replay_runner.py:36] Average training steps per second: 392.34
I0901 13:26:41.636594 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.64
INFO:tensorflow:Starting iteration 6

Steps executed: 309 Episode length: 197 Return: -288.39938171838116
INFO:tensorflow:Average training steps per second: 356.91
I0901 13:26:47.698572 139803418769408 replay_runner.py:36] Average training steps per second: 356.91
I0901 13:26:47.865852 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.65
INFO:tensorflow:Starting iteration 7
I0901 13:26:51.092042 139803418769408 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 369.53

Steps executed: 459 Episode length: 267 Return: -320.22021770920157
I0901 13:26:54.091327 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.35
INFO:tensorflow:Starting iteration 8

Steps executed: 201 Episode length: 111 Return: -324.02794075024257
INFO:tensorflow:Average training steps per second: 380.82
I0901 13:27:00.029429 139803418769408 replay_runner.py:36] Average training steps per second: 380.82
I0901 13:27:00.123478 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.57
INFO:tensorflow:Starting iteration 9
I0901 13:27:03.470681 139803418769408 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 402.12

Steps executed: 212 Episode length: 212 Return: -224.45164702511318
I0901 13:27:06.108386 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.45
INFO:tensorflow:Starting iteration 10
I0901 13:27:09.387115 139803418769408 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 378.05

Steps executed: 239 Episode length: 89 Return: -329.141277583634498
I0901 13:27:12.122488 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.87
INFO:tensorflow:Starting iteration 11
I0901 13:27:15.434262 139803418769408 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 389.80

Steps executed: 226 Episode length: 84 Return: -207.265049743614728
I0901 13:27:18.118347 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.38
INFO:tensorflow:Starting iteration 12

Steps executed: 146 Episode length: 66 Return: -287.813688088455328
INFO:tensorflow:Average training steps per second: 391.37

Steps executed: 272 Episode length: 126 Return: -393.98853811628718
I0901 13:27:24.128375 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.81
INFO:tensorflow:Starting iteration 13

Steps executed: 184 Episode length: 107 Return: -281.25622996717348
INFO:tensorflow:Average training steps per second: 389.71
I0901 13:27:30.025767 139803418769408 replay_runner.py:36] Average training steps per second: 389.71

Steps executed: 236 Episode length: 52 Return: -136.221640991355948
INFO:tensorflow:Starting iteration 14

Steps executed: 67 Episode length: 67 Return: -153.2231239215044948
INFO:tensorflow:Average training steps per second: 390.48
I0901 13:27:36.067868 139803418769408 replay_runner.py:36] Average training steps per second: 390.48

Steps executed: 231 Episode length: 164 Return: -208.79232602596494
INFO:tensorflow:Starting iteration 15

Steps executed: 194 Episode length: 194 Return: -145.68237909297844
INFO:tensorflow:Average training steps per second: 387.66

Steps executed: 437 Episode length: 243 Return: -127.98547231965816
I0901 13:27:42.348642 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.83
INFO:tensorflow:Starting iteration 16
I0901 13:27:45.693676 139803418769408 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 394.39

Steps executed: 262 Episode length: 138 Return: -408.54766518207447
I0901 13:27:48.344533 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.81
INFO:tensorflow:Starting iteration 17
I0901 13:27:51.675958 139803418769408 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 391.48

Steps executed: 550 Episode length: 476 Return: 223.001955305356357
I0901 13:27:54.658813 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: 53.80
INFO:tensorflow:Starting iteration 18

Steps executed: 207 Episode length: 69 Return: -138.304578505624367
INFO:tensorflow:Average training steps per second: 382.20
I0901 13:28:00.638415 139803418769408 replay_runner.py:36] Average training steps per second: 382.20
I0901 13:28:00.712512 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.48
INFO:tensorflow:Starting iteration 19

Steps executed: 232 Episode length: 53 Return: -82.1397952280977405
INFO:tensorflow:Average training steps per second: 378.29
I0901 13:28:06.682758 139803418769408 replay_runner.py:36] Average training steps per second: 378.29
I0901 13:28:06.806371 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.12
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 67 Return: -153.266962625072185
INFO:tensorflow:Average training steps per second: 382.41
I0901 13:28:12.722875 139803418769408 replay_runner.py:36] Average training steps per second: 382.41
I0901 13:28:12.816098 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.59
INFO:tensorflow:Starting iteration 21

Steps executed: 301 Episode length: 126 Return: -298.52693269354646
INFO:tensorflow:Average training steps per second: 392.41
I0901 13:28:18.660927 139803418769408 replay_runner.py:36] Average training steps per second: 392.41
I0901 13:28:18.810973 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.98
INFO:tensorflow:Starting iteration 22

Steps executed: 233 Episode length: 108 Return: -254.95231590605871
INFO:tensorflow:Average training steps per second: 388.80
I0901 13:28:24.700267 139803418769408 replay_runner.py:36] Average training steps per second: 388.80
I0901 13:28:24.789371 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.74
INFO:tensorflow:Starting iteration 23

Steps executed: 264 Episode length: 89 Return: -280.288332046877141
INFO:tensorflow:Average training steps per second: 382.65
I0901 13:28:30.712374 139803418769408 replay_runner.py:36] Average training steps per second: 382.65
I0901 13:28:30.864516 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.92
INFO:tensorflow:Starting iteration 24

Steps executed: 287 Episode length: 91 Return: 34.10840736393354721
INFO:tensorflow:Average training steps per second: 383.88
I0901 13:28:36.798362 139803418769408 replay_runner.py:36] Average training steps per second: 383.88
I0901 13:28:36.932322 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.18
INFO:tensorflow:Starting iteration 25

Steps executed: 240 Episode length: 85 Return: -120.557732241018021
INFO:tensorflow:Average training steps per second: 388.41
I0901 13:28:42.808284 139803418769408 replay_runner.py:36] Average training steps per second: 388.41
I0901 13:28:42.896819 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.17
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 57 Return: -205.943784058554851
INFO:tensorflow:Average training steps per second: 389.45
I0901 13:28:48.759629 139803418769408 replay_runner.py:36] Average training steps per second: 389.45
I0901 13:28:48.845149 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.75
INFO:tensorflow:Starting iteration 27

Steps executed: 619 Episode length: 468 Return: -107.57978362959929
INFO:tensorflow:Average training steps per second: 394.83
I0901 13:28:54.761201 139803418769408 replay_runner.py:36] Average training steps per second: 394.83
I0901 13:28:55.480547 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.51
INFO:tensorflow:Starting iteration 28

Steps executed: 297 Episode length: 121 Return: -452.45231646730747
INFO:tensorflow:Average training steps per second: 379.03
I0901 13:29:01.432259 139803418769408 replay_runner.py:36] Average training steps per second: 379.03
I0901 13:29:01.585928 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -658.24
INFO:tensorflow:Starting iteration 29

Steps executed: 276 Episode length: 141 Return: -1040.9990805791347
INFO:tensorflow:Average training steps per second: 388.55
I0901 13:29:07.445131 139803418769408 replay_runner.py:36] Average training steps per second: 388.55

Done fixed training!Episode length: 141 Return: -1040.9990805791347