Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 11:31:31.499129 140636568012800 run_experiment.py:549] Creating TrainRunner ...
I0902 11:31:31.507387 140636568012800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:31.507524 140636568012800 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:31.507606 140636568012800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:31.507673 140636568012800 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:31.507734 140636568012800 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:31.507828 140636568012800 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:31.507886 140636568012800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:31.507979 140636568012800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:31.508089 140636568012800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:31.508162 140636568012800 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:31.508259 140636568012800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:31.508345 140636568012800 dqn_agent.py:283] 	 seed: 1630582291507348
I0902 11:31:31.510267 140636568012800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:31.510388 140636568012800 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:31.510472 140636568012800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:31.510546 140636568012800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:31.510610 140636568012800 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:31.510671 140636568012800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:31.510803 140636568012800 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:31.510879 140636568012800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:31.510963 140636568012800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:31.679252 140636568012800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:31.941240 140636568012800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:31.949857 140636568012800 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:31:31.956809 140636568012800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:31.956937 140636568012800 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:31.957004 140636568012800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:31.957064 140636568012800 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:31.957126 140636568012800 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:31.957192 140636568012800 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:31.957294 140636568012800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:31.957375 140636568012800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:31.957438 140636568012800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:31.957492 140636568012800 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:31.957552 140636568012800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:31.957631 140636568012800 dqn_agent.py:283] 	 seed: 1630582291956781
I0902 11:31:31.959714 140636568012800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:31.959963 140636568012800 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:31.960079 140636568012800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:31.960220 140636568012800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:31.960309 140636568012800 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:31.960384 140636568012800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:31.960462 140636568012800 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:31.960534 140636568012800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:31.960667 140636568012800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:32.016410 140636568012800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:32.037566 140636568012800 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:31:32.037754 140636568012800 replay_runner.py:41] Starting iteration 0
Steps executed: 326 Episode length: 140 Return: -21.12011757043112
INFO:tensorflow:Average training steps per second: 195.33
I0902 11:31:37.157647 140636568012800 replay_runner.py:36] Average training steps per second: 195.33
I0902 11:31:38.246418 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.30
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 64 Return: -128.390853893805834
INFO:tensorflow:Average training steps per second: 340.51
I0902 11:31:44.589759 140636568012800 replay_runner.py:36] Average training steps per second: 340.51
I0902 11:31:44.717358 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.89
INFO:tensorflow:Starting iteration 2
I0902 11:31:48.097615 140636568012800 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 319.29

Steps executed: 1000 Episode length: 1000 Return: -135.4308594676297
I0902 11:31:53.869197 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.43
INFO:tensorflow:Starting iteration 3
I0902 11:31:57.294377 140636568012800 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 329.42

Steps executed: 867 Episode length: 867 Return: -353.665181673029457
I0902 11:32:01.932421 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.67
INFO:tensorflow:Starting iteration 4
I0902 11:32:05.338255 140636568012800 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 341.30

Steps executed: 1000 Episode length: 1000 Return: -141.72454210085746
I0902 11:32:10.017714 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.72
INFO:tensorflow:Starting iteration 5
I0902 11:32:13.482638 140636568012800 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 352.79

Steps executed: 1000 Episode length: 1000 Return: -154.42593817388092
I0902 11:32:17.907852 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.43
INFO:tensorflow:Starting iteration 6

Steps executed: 233 Episode length: 233 Return: -571.1334373777136092
INFO:tensorflow:Average training steps per second: 353.55
I0902 11:32:24.227498 140636568012800 replay_runner.py:36] Average training steps per second: 353.55
I0902 11:32:24.429510 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.13
INFO:tensorflow:Starting iteration 7
I0902 11:32:27.860110 140636568012800 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 345.74

Steps executed: 1000 Episode length: 1000 Return: -84.406544765736972
I0902 11:32:33.492748 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.41
INFO:tensorflow:Starting iteration 8

Steps executed: 305 Episode length: 144 Return: -196.0214120250622672
INFO:tensorflow:Average training steps per second: 327.17
I0902 11:32:39.876364 140636568012800 replay_runner.py:36] Average training steps per second: 327.17
I0902 11:32:40.091485 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.82
INFO:tensorflow:Starting iteration 9

Steps executed: 248 Episode length: 135 Return: -122.8480255381096672
INFO:tensorflow:Average training steps per second: 342.08
I0902 11:32:46.349120 140636568012800 replay_runner.py:36] Average training steps per second: 342.08
I0902 11:32:46.514811 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 10
I0902 11:32:50.013394 140636568012800 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 354.75

Steps executed: 1000 Episode length: 1000 Return: -146.15332438322687
I0902 11:32:54.878463 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.15
INFO:tensorflow:Starting iteration 11

Steps executed: 143 Episode length: 143 Return: -105.4208878644663487
INFO:tensorflow:Average training steps per second: 340.06

Steps executed: 452 Episode length: 309 Return: -169.3754542125119587
I0902 11:33:01.642398 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.40
INFO:tensorflow:Starting iteration 12

Steps executed: 842 Episode length: 842 Return: -129.5632869181008987
INFO:tensorflow:Average training steps per second: 363.19
I0902 11:33:07.832934 140636568012800 replay_runner.py:36] Average training steps per second: 363.19
I0902 11:33:09.155086 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.56
INFO:tensorflow:Starting iteration 13

Steps executed: 355 Episode length: 171 Return: -199.3162944445230787
INFO:tensorflow:Average training steps per second: 370.43
I0902 11:33:15.307883 140636568012800 replay_runner.py:36] Average training steps per second: 370.43
I0902 11:33:15.543508 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.68
INFO:tensorflow:Starting iteration 14

Steps executed: 350 Episode length: 350 Return: -196.0568182679703987
INFO:tensorflow:Average training steps per second: 362.54
I0902 11:33:21.811655 140636568012800 replay_runner.py:36] Average training steps per second: 362.54
I0902 11:33:22.088746 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.06
INFO:tensorflow:Starting iteration 15

Steps executed: 452 Episode length: 452 Return: -232.3389073025985987
INFO:tensorflow:Average training steps per second: 367.19
I0902 11:33:28.402161 140636568012800 replay_runner.py:36] Average training steps per second: 367.19
I0902 11:33:29.104227 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.34
INFO:tensorflow:Starting iteration 16

Steps executed: 209 Episode length: 209 Return: -40.94499708307958587
INFO:tensorflow:Average training steps per second: 348.66
I0902 11:33:35.510059 140636568012800 replay_runner.py:36] Average training steps per second: 348.66
I0902 11:33:35.644484 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.94
INFO:tensorflow:Starting iteration 17

Steps executed: 387 Episode length: 387 Return: -249.8203904759645587
INFO:tensorflow:Average training steps per second: 343.54
I0902 11:33:41.990164 140636568012800 replay_runner.py:36] Average training steps per second: 343.54
I0902 11:33:42.405989 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.82
INFO:tensorflow:Starting iteration 18
I0902 11:33:45.852549 140636568012800 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 339.81

Steps executed: 939 Episode length: 939 Return: -94.47612209659736587
I0902 11:33:50.010222 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.48
INFO:tensorflow:Starting iteration 19
I0902 11:33:53.414575 140636568012800 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 333.36

Steps executed: 834 Episode length: 834 Return: -284.2301909014985387
I0902 11:33:57.943780 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.23
INFO:tensorflow:Starting iteration 20
I0902 11:34:01.403923 140636568012800 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 331.86

Steps executed: 1000 Episode length: 1000 Return: -135.41184743116337
I0902 11:34:06.657475 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.41
INFO:tensorflow:Starting iteration 21

Steps executed: 278 Episode length: 278 Return: -246.6561946250339537
INFO:tensorflow:Average training steps per second: 331.44
I0902 11:34:13.124075 140636568012800 replay_runner.py:36] Average training steps per second: 331.44
I0902 11:34:13.344381 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.66
INFO:tensorflow:Starting iteration 22
I0902 11:34:16.671602 140636568012800 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 326.90

Steps executed: 680 Episode length: 680 Return: -379.9286700522798537
I0902 11:34:20.912122 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.93
INFO:tensorflow:Starting iteration 23
I0902 11:34:24.232236 140636568012800 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 319.51
I0902 11:34:27.362378 140636568012800 replay_runner.py:36] Average training steps per second: 319.51

Steps executed: 227 Episode length: 227 Return: -162.7657717061882537
INFO:tensorflow:Starting iteration 24
I0902 11:34:30.828439 140636568012800 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 338.92
I0902 11:34:33.779288 140636568012800 replay_runner.py:36] Average training steps per second: 338.92

Steps executed: 1000 Episode length: 1000 Return: 14.6725604382916477
INFO:tensorflow:Starting iteration 25
I0902 11:34:38.606036 140636568012800 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 318.32

Steps executed: 268 Episode length: 268 Return: -298.0618142195843377
I0902 11:34:42.019160 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.06
INFO:tensorflow:Starting iteration 26

Steps executed: 213 Episode length: 213 Return: 17.566812007678753377
INFO:tensorflow:Average training steps per second: 317.94
I0902 11:34:48.283277 140636568012800 replay_runner.py:36] Average training steps per second: 317.94
I0902 11:34:48.469456 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.57
INFO:tensorflow:Starting iteration 27

Steps executed: 352 Episode length: 352 Return: 259.39198820640933377
INFO:tensorflow:Average training steps per second: 349.56
I0902 11:34:54.487811 140636568012800 replay_runner.py:36] Average training steps per second: 349.56
I0902 11:34:54.902195 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: 259.39
INFO:tensorflow:Starting iteration 28
I0902 11:34:58.219003 140636568012800 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 360.13

Steps executed: 1000 Episode length: 1000 Return: 87.8995952186528277
I0902 11:35:02.951175 140636568012800 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.90
INFO:tensorflow:Starting iteration 29
I0902 11:35:06.064007 140636568012800 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 336.00

Steps executed: 1000 Episode length: 1000 Return: 94.2624758136860777

Done fixed training! Episode length: 1000 Return: 94.2624758136860777