I0905 16:21:32.858485 140078442928128 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:32.858981 140078442928128 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:32.916919 140078442928128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:32.918063 140078442928128 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:32.918133 140078442928128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:32.918191 140078442928128 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:32.918258 140078442928128 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:32.918313 140078442928128 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:21:32.918368 140078442928128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:32.918468 140078442928128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:32.918526 140078442928128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:32.918578 140078442928128 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:32.918712 140078442928128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:32.918788 140078442928128 dqn_agent.py:283] 	 seed: 1630858892916862
I0905 16:21:32.920527 140078442928128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:32.920666 140078442928128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:21:32.920758 140078442928128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:32.920827 140078442928128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:32.920883 140078442928128 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:32.920935 140078442928128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:32.921005 140078442928128 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:32.921058 140078442928128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:32.921149 140078442928128 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0905 16:21:34.626774 140078442928128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:34.953687 140078442928128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.050028 140078442928128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.054584 140078442928128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.054727 140078442928128 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.054815 140078442928128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.054876 140078442928128 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.054929 140078442928128 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.054987 140078442928128 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:21:35.055082 140078442928128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.055222 140078442928128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.055283 140078442928128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.055334 140078442928128 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.055383 140078442928128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.055433 140078442928128 dqn_agent.py:283] 	 seed: 1630858895054551
I0905 16:21:35.056963 140078442928128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.057077 140078442928128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:21:35.057152 140078442928128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.057215 140078442928128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.057282 140078442928128 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.057335 140078442928128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.057387 140078442928128 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.057471 140078442928128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.057534 140078442928128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.080416 140078442928128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.094826 140078442928128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.095035 140078442928128 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 261.30
I0905 16:21:38.922227 140078442928128 replay_runner.py:36] Average training steps per second: 261.30
I0905 16:21:39.657854 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 16:21:39.817196 140078442928128 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 367.03
I0905 16:21:42.542136 140078442928128 replay_runner.py:36] Average training steps per second: 367.03
I0905 16:21:42.738633 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 307 Episode length: 172 Return: -171.0
INFO:tensorflow:Average training steps per second: 365.35
I0905 16:21:45.638036 140078442928128 replay_runner.py:36] Average training steps per second: 365.35
I0905 16:21:45.745641 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 370.96
I0905 16:21:48.600650 140078442928128 replay_runner.py:36] Average training steps per second: 370.96
I0905 16:21:48.786307 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0905 16:21:48.944820 140078442928128 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 366.47
I0905 16:21:51.673830 140078442928128 replay_runner.py:36] Average training steps per second: 366.47
I0905 16:21:51.842474 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 615 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 371.44
I0905 16:21:54.691779 140078442928128 replay_runner.py:36] Average training steps per second: 371.44
I0905 16:21:54.908599 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.00
INFO:tensorflow:Starting iteration 6

Steps executed: 208 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 369.66
I0905 16:21:57.773590 140078442928128 replay_runner.py:36] Average training steps per second: 369.66
I0905 16:21:57.845189 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 7

Steps executed: 575 Episode length: 453 Return: -452.0
INFO:tensorflow:Average training steps per second: 365.07
I0905 16:22:00.741395 140078442928128 replay_runner.py:36] Average training steps per second: 365.07
I0905 16:22:00.940661 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.50
INFO:tensorflow:Starting iteration 8

Steps executed: 329 Episode length: 221 Return: -220.0
INFO:tensorflow:Average training steps per second: 368.84
I0905 16:22:03.814841 140078442928128 replay_runner.py:36] Average training steps per second: 368.84
I0905 16:22:03.928601 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.50
INFO:tensorflow:Starting iteration 9

Steps executed: 255 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 369.62
I0905 16:22:06.790497 140078442928128 replay_runner.py:36] Average training steps per second: 369.62
I0905 16:22:06.885701 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 10

Steps executed: 256 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 374.09
I0905 16:22:09.717393 140078442928128 replay_runner.py:36] Average training steps per second: 374.09
I0905 16:22:09.803736 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 11

Steps executed: 254 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 375.32
I0905 16:22:12.624214 140078442928128 replay_runner.py:36] Average training steps per second: 375.32
I0905 16:22:12.712326 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 12

Steps executed: 263 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 373.01
I0905 16:22:15.555146 140078442928128 replay_runner.py:36] Average training steps per second: 373.01
I0905 16:22:15.644060 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 375.34
I0905 16:22:18.465149 140078442928128 replay_runner.py:36] Average training steps per second: 375.34
I0905 16:22:18.633197 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 289 Episode length: 289 Return: -288.0
INFO:tensorflow:Average training steps per second: 377.49
I0905 16:22:21.440356 140078442928128 replay_runner.py:36] Average training steps per second: 377.49
I0905 16:22:21.538930 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.00
INFO:tensorflow:Starting iteration 15

Steps executed: 252 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 373.34
I0905 16:22:24.375582 140078442928128 replay_runner.py:36] Average training steps per second: 373.34
I0905 16:22:24.467532 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 16

Steps executed: 253 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 377.82
I0905 16:22:27.270121 140078442928128 replay_runner.py:36] Average training steps per second: 377.82
I0905 16:22:27.355296 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 17

Steps executed: 274 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 373.47
I0905 16:22:30.189634 140078442928128 replay_runner.py:36] Average training steps per second: 373.47
I0905 16:22:30.280903 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 18

Steps executed: 259 Episode length: 259 Return: -258.0
INFO:tensorflow:Average training steps per second: 376.11
I0905 16:22:33.099374 140078442928128 replay_runner.py:36] Average training steps per second: 376.11
I0905 16:22:33.187978 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.00
INFO:tensorflow:Starting iteration 19

Steps executed: 320 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 373.88
I0905 16:22:36.019723 140078442928128 replay_runner.py:36] Average training steps per second: 373.88
I0905 16:22:36.128881 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.67
INFO:tensorflow:Starting iteration 20
I0905 16:22:36.284960 140078442928128 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 371.88
I0905 16:22:38.974284 140078442928128 replay_runner.py:36] Average training steps per second: 371.88

Steps executed: 228 Episode length: 132 Return: -131.0
INFO:tensorflow:Starting iteration 21

Steps executed: 260 Episode length: 138 Return: -137.0
INFO:tensorflow:Average training steps per second: 371.52
I0905 16:22:41.898883 140078442928128 replay_runner.py:36] Average training steps per second: 371.52
I0905 16:22:41.988553 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.00
INFO:tensorflow:Starting iteration 22

Steps executed: 262 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 372.33
I0905 16:22:44.832111 140078442928128 replay_runner.py:36] Average training steps per second: 372.33
I0905 16:22:44.922365 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 23

Steps executed: 302 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 373.01
I0905 16:22:47.761551 140078442928128 replay_runner.py:36] Average training steps per second: 373.01
I0905 16:22:47.863301 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 24

Steps executed: 240 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 374.38
I0905 16:22:50.691586 140078442928128 replay_runner.py:36] Average training steps per second: 374.38
I0905 16:22:50.779852 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 25

Steps executed: 231 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 373.88
I0905 16:22:53.612200 140078442928128 replay_runner.py:36] Average training steps per second: 373.88
I0905 16:22:53.694239 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 26

Steps executed: 249 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 374.29
I0905 16:22:56.524224 140078442928128 replay_runner.py:36] Average training steps per second: 374.29
I0905 16:22:56.610671 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 27

Steps executed: 285 Episode length: 184 Return: -183.0
INFO:tensorflow:Average training steps per second: 367.57
I0905 16:22:59.488468 140078442928128 replay_runner.py:36] Average training steps per second: 367.57
I0905 16:22:59.587105 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 28

Steps executed: 280 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 369.80
I0905 16:23:02.450788 140078442928128 replay_runner.py:36] Average training steps per second: 369.80
I0905 16:23:02.546166 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 371.50
I0905 16:23:05.399626 140078442928128 replay_runner.py:36] Average training steps per second: 371.50
I0905 16:23:05.510373 140078442928128 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.50