Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 23:40:25.203415 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:25.215100 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:25.215340 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:25.215475 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:25.215604 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:25.215672 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:25.215737 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:25.216062 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:25.216229 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:25.216470 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:25.216627 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:25.216821 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:25.216989 140006414895104 dqn_agent.py:283] 	 seed: 1630626025215040
I0902 23:40:25.220358 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:25.220596 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:25.220731 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:25.220864 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:25.221008 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:25.221151 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:25.221302 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:25.221423 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:25.221531 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:25.261711 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:25.668700 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:25.685730 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:25.719838 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:25.720115 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:25.720298 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:25.720535 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:25.720863 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:25.721089 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:25.721333 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:25.721600 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:25.721860 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:25.722079 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:25.722262 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:25.722687 140006414895104 dqn_agent.py:283] 	 seed: 1630626025719774
I0902 23:40:25.725456 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:25.725726 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:25.725942 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:25.726149 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:25.726347 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:25.726545 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:25.726752 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:25.726939 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:25.727127 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:25.781681 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:25.815197 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:25.815549 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.46
I0902 23:40:31.859854 140006414895104 replay_runner.py:36] Average training steps per second: 165.46
Steps executed: 276 Episode length: 276 Return: -165.71262902411655
I0902 23:40:33.154118 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.71
INFO:tensorflow:Starting iteration 1

Steps executed: 285 Episode length: 133 Return: -364.28249734466545
INFO:tensorflow:Average training steps per second: 237.90
I0902 23:40:41.874351 140006414895104 replay_runner.py:36] Average training steps per second: 237.90
I0902 23:40:42.145964 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.12
INFO:tensorflow:Starting iteration 2

Steps executed: 516 Episode length: 385 Return: -500.96320959512246
INFO:tensorflow:Average training steps per second: 223.74
I0902 23:40:51.209676 140006414895104 replay_runner.py:36] Average training steps per second: 223.74
I0902 23:40:51.936379 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.46
INFO:tensorflow:Starting iteration 3
I0902 23:40:56.264874 140006414895104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 216.68

Steps executed: 743 Episode length: 743 Return: -153.86404820171046
I0902 23:41:02.938600 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.86
INFO:tensorflow:Starting iteration 4
I0902 23:41:07.279196 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 219.28

Steps executed: 1000 Episode length: 1000 Return: -31.807774065698933
I0902 23:41:14.217802 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -31.81
INFO:tensorflow:Starting iteration 5
I0902 23:41:18.513640 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 220.23

Steps executed: 1000 Episode length: 1000 Return: -56.633258927385463
I0902 23:41:26.825136 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.63
INFO:tensorflow:Starting iteration 6

Steps executed: 169 Episode length: 169 Return: -503.7105718245668463
INFO:tensorflow:Average training steps per second: 211.31

Steps executed: 1169 Episode length: 1000 Return: -84.858704534648033
I0902 23:41:39.417575 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.28
INFO:tensorflow:Starting iteration 7
I0902 23:41:43.718461 140006414895104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 216.28

Steps executed: 728 Episode length: 728 Return: -303.7573271446428033
I0902 23:41:50.241503 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.76
INFO:tensorflow:Starting iteration 8
I0902 23:41:54.492115 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 214.54

Steps executed: 1000 Episode length: 1000 Return: -265.55183433226813
I0902 23:42:01.579797 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.55
INFO:tensorflow:Starting iteration 9

Steps executed: 286 Episode length: 286 Return: -496.5471493524258313
INFO:tensorflow:Average training steps per second: 222.74
I0902 23:42:10.460842 140006414895104 replay_runner.py:36] Average training steps per second: 222.74
I0902 23:42:10.882853 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.55
INFO:tensorflow:Starting iteration 10

Steps executed: 323 Episode length: 323 Return: -321.8702255991358313
INFO:tensorflow:Average training steps per second: 216.65
I0902 23:42:19.964521 140006414895104 replay_runner.py:36] Average training steps per second: 216.65
I0902 23:42:20.411718 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.87
INFO:tensorflow:Starting iteration 11

Steps executed: 159 Episode length: 159 Return: -622.2174940997007313
INFO:tensorflow:Average training steps per second: 220.06
I0902 23:42:29.176177 140006414895104 replay_runner.py:36] Average training steps per second: 220.06

Steps executed: 315 Episode length: 156 Return: -621.8870996893467313
INFO:tensorflow:Starting iteration 12
I0902 23:42:33.916159 140006414895104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 230.75

Steps executed: 1000 Episode length: 1000 Return: -72.937393545143313
I0902 23:42:42.095112 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.94
INFO:tensorflow:Starting iteration 13
I0902 23:42:46.377863 140006414895104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 221.71

Steps executed: 462 Episode length: 462 Return: -415.8407397279778513
I0902 23:42:51.750685 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.84
INFO:tensorflow:Starting iteration 14

Steps executed: 262 Episode length: 65 Return: -358.95412645724778513
INFO:tensorflow:Average training steps per second: 220.91
I0902 23:43:00.523237 140006414895104 replay_runner.py:36] Average training steps per second: 220.91
I0902 23:43:00.780227 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.70
INFO:tensorflow:Starting iteration 15
I0902 23:43:05.109291 140006414895104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 226.56
I0902 23:43:09.523699 140006414895104 replay_runner.py:36] Average training steps per second: 226.56

Steps executed: 1000 Episode length: 1000 Return: -92.962603986910613
INFO:tensorflow:Starting iteration 16
I0902 23:43:17.387282 140006414895104 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 218.28

Steps executed: 1000 Episode length: 1000 Return: -129.50954173790632
I0902 23:43:26.571656 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.51
INFO:tensorflow:Starting iteration 17
I0902 23:43:30.904544 140006414895104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 225.01

Steps executed: 1000 Episode length: 1000 Return: -77.300936900190172
I0902 23:43:38.830951 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.30
INFO:tensorflow:Starting iteration 18
I0902 23:43:43.207336 140006414895104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 228.13

Steps executed: 1000 Episode length: 1000 Return: -146.87080352989622
I0902 23:43:52.131282 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.87
INFO:tensorflow:Starting iteration 19

Steps executed: 297 Episode length: 297 Return: -423.6801580625393622
INFO:tensorflow:Average training steps per second: 226.49
I0902 23:44:00.799480 140006414895104 replay_runner.py:36] Average training steps per second: 226.49
I0902 23:44:01.247195 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.68
INFO:tensorflow:Starting iteration 20

Steps executed: 236 Episode length: 85 Return: -350.47499124417213622
INFO:tensorflow:Average training steps per second: 222.15
I0902 23:44:10.156126 140006414895104 replay_runner.py:36] Average training steps per second: 222.15
I0902 23:44:10.371929 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.95
INFO:tensorflow:Starting iteration 21

Steps executed: 221 Episode length: 137 Return: -236.3411830414312622
INFO:tensorflow:Average training steps per second: 223.36
I0902 23:44:19.247474 140006414895104 replay_runner.py:36] Average training steps per second: 223.36
I0902 23:44:19.451007 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.17
INFO:tensorflow:Starting iteration 22

Steps executed: 221 Episode length: 69 Return: -113.94237834407546622
INFO:tensorflow:Average training steps per second: 217.43
I0902 23:44:28.362919 140006414895104 replay_runner.py:36] Average training steps per second: 217.43
I0902 23:44:28.581476 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.04
INFO:tensorflow:Starting iteration 23
I0902 23:44:32.993965 140006414895104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.17
I0902 23:44:37.495517 140006414895104 replay_runner.py:36] Average training steps per second: 222.17

Steps executed: 262 Episode length: 105 Return: -526.8059618452479622
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 122 Return: 12.943294836507963622
INFO:tensorflow:Average training steps per second: 219.47
I0902 23:44:46.658755 140006414895104 replay_runner.py:36] Average training steps per second: 219.47
I0902 23:44:46.930551 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.26
INFO:tensorflow:Starting iteration 25

Steps executed: 295 Episode length: 113 Return: -525.2942745781944622
INFO:tensorflow:Average training steps per second: 222.32
I0902 23:44:55.946623 140006414895104 replay_runner.py:36] Average training steps per second: 222.32
I0902 23:44:56.214596 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -666.96
INFO:tensorflow:Starting iteration 26

Steps executed: 215 Episode length: 93 Return: -533.00711907173244622
INFO:tensorflow:Average training steps per second: 217.44
I0902 23:45:05.253932 140006414895104 replay_runner.py:36] Average training steps per second: 217.44
I0902 23:45:05.434363 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.49
INFO:tensorflow:Starting iteration 27

Steps executed: 256 Episode length: 122 Return: -723.9323037102888622
INFO:tensorflow:Average training steps per second: 218.31
I0902 23:45:14.383480 140006414895104 replay_runner.py:36] Average training steps per second: 218.31
I0902 23:45:14.630173 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -715.82
INFO:tensorflow:Starting iteration 28
I0902 23:45:18.993402 140006414895104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 221.83
I0902 23:45:23.501722 140006414895104 replay_runner.py:36] Average training steps per second: 221.83

Steps executed: 332 Episode length: 146 Return: -233.4487771975052522
INFO:tensorflow:Starting iteration 29

Steps executed: 256 Episode length: 86 Return: -836.87086526331936522
INFO:tensorflow:Average training steps per second: 219.77
I0902 23:45:32.616357 140006414895104 replay_runner.py:36] Average training steps per second: 219.77

Done fixed training!Episode length: 86 Return: -836.87086526331936522