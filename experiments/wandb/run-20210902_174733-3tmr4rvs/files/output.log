Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0902 17:47:39.470210 140668698150912 run_experiment.py:549] Creating TrainRunner ...
I0902 17:47:39.479876 140668698150912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:47:39.480133 140668698150912 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:47:39.480268 140668698150912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:47:39.480391 140668698150912 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:47:39.480491 140668698150912 dqn_agent.py:275] 	 update_period: 4
I0902 17:47:39.480594 140668698150912 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:47:39.480720 140668698150912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:47:39.480833 140668698150912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:47:39.481019 140668698150912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:47:39.481138 140668698150912 dqn_agent.py:280] 	 optimizer: adam
I0902 17:47:39.481262 140668698150912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:47:39.481370 140668698150912 dqn_agent.py:283] 	 seed: 1630604859479811
I0902 17:47:39.484582 140668698150912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:47:39.484794 140668698150912 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:47:39.484933 140668698150912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:47:39.485082 140668698150912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:47:39.485208 140668698150912 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:47:39.485325 140668698150912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:47:39.485432 140668698150912 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:47:39.485594 140668698150912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:47:39.485726 140668698150912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:47:39.526404 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:40.003944 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:40.021056 140668698150912 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:47:40.030212 140668698150912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:47:40.030506 140668698150912 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:47:40.030657 140668698150912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:47:40.030749 140668698150912 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:47:40.030823 140668698150912 dqn_agent.py:275] 	 update_period: 4
I0902 17:47:40.030918 140668698150912 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:47:40.031139 140668698150912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:47:40.031290 140668698150912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:47:40.031422 140668698150912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:47:40.031548 140668698150912 dqn_agent.py:280] 	 optimizer: adam
I0902 17:47:40.031631 140668698150912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:47:40.031723 140668698150912 dqn_agent.py:283] 	 seed: 1630604860030166
I0902 17:47:40.034553 140668698150912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:47:40.034736 140668698150912 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:47:40.034865 140668698150912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:47:40.034973 140668698150912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:47:40.035091 140668698150912 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:47:40.035232 140668698150912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:47:40.035392 140668698150912 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:47:40.035504 140668698150912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:47:40.035831 140668698150912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:47:40.066604 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:47:40.094800 140668698150912 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:47:40.095218 140668698150912 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 143.39
I0902 17:47:47.069488 140668698150912 replay_runner.py:36] Average training steps per second: 143.39
I0902 17:47:48.607119 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:47:48.854275 140668698150912 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.82
I0902 17:47:53.935510 140668698150912 replay_runner.py:36] Average training steps per second: 196.82
I0902 17:47:54.342170 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:47:54.586673 140668698150912 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.36
I0902 17:47:59.758620 140668698150912 replay_runner.py:36] Average training steps per second: 193.36
I0902 17:48:00.164473 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:48:00.399459 140668698150912 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.72
I0902 17:48:05.457373 140668698150912 replay_runner.py:36] Average training steps per second: 197.72
I0902 17:48:05.876992 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:48:06.121887 140668698150912 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.43
I0902 17:48:11.213279 140668698150912 replay_runner.py:36] Average training steps per second: 196.43
I0902 17:48:11.640046 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:48:11.890568 140668698150912 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 191.22
I0902 17:48:17.120664 140668698150912 replay_runner.py:36] Average training steps per second: 191.22
I0902 17:48:17.537895 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:48:17.777086 140668698150912 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 194.86
I0902 17:48:22.909656 140668698150912 replay_runner.py:36] Average training steps per second: 194.86
I0902 17:48:23.334910 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:48:23.571263 140668698150912 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.20
I0902 17:48:28.721079 140668698150912 replay_runner.py:36] Average training steps per second: 194.20
I0902 17:48:29.123175 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:48:29.358019 140668698150912 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.66
I0902 17:48:34.576041 140668698150912 replay_runner.py:36] Average training steps per second: 191.66
I0902 17:48:34.991266 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:48:35.215151 140668698150912 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.07
I0902 17:48:40.316005 140668698150912 replay_runner.py:36] Average training steps per second: 196.07
I0902 17:48:40.745885 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:48:40.995475 140668698150912 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.38
I0902 17:48:46.166877 140668698150912 replay_runner.py:36] Average training steps per second: 193.38
I0902 17:48:46.567810 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:48:46.802602 140668698150912 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 195.19
I0902 17:48:51.926071 140668698150912 replay_runner.py:36] Average training steps per second: 195.19
I0902 17:48:52.353994 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:48:52.602007 140668698150912 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.91
I0902 17:48:57.706935 140668698150912 replay_runner.py:36] Average training steps per second: 195.91
I0902 17:48:58.123974 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:48:58.372939 140668698150912 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.52
I0902 17:49:03.514502 140668698150912 replay_runner.py:36] Average training steps per second: 194.52
I0902 17:49:03.930861 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:49:04.179414 140668698150912 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.67
I0902 17:49:09.343578 140668698150912 replay_runner.py:36] Average training steps per second: 193.67
I0902 17:49:09.775205 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:49:10.023855 140668698150912 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 194.27
I0902 17:49:15.171612 140668698150912 replay_runner.py:36] Average training steps per second: 194.27
I0902 17:49:15.600422 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:49:15.850937 140668698150912 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 186.87
I0902 17:49:21.202576 140668698150912 replay_runner.py:36] Average training steps per second: 186.87
I0902 17:49:21.625145 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:49:21.869896 140668698150912 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 193.28
I0902 17:49:27.044226 140668698150912 replay_runner.py:36] Average training steps per second: 193.28
I0902 17:49:27.469045 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:49:27.705218 140668698150912 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.26
I0902 17:49:32.827271 140668698150912 replay_runner.py:36] Average training steps per second: 195.26
I0902 17:49:33.232772 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:49:33.479008 140668698150912 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.28
I0902 17:49:38.653100 140668698150912 replay_runner.py:36] Average training steps per second: 193.28
I0902 17:49:39.047615 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:49:39.289826 140668698150912 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.39
I0902 17:49:44.356272 140668698150912 replay_runner.py:36] Average training steps per second: 197.39
I0902 17:49:44.768141 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:49:45.014828 140668698150912 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 191.33
I0902 17:49:50.241697 140668698150912 replay_runner.py:36] Average training steps per second: 191.33
I0902 17:49:50.643956 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 17:49:50.883393 140668698150912 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.58
I0902 17:49:56.103761 140668698150912 replay_runner.py:36] Average training steps per second: 191.58
I0902 17:49:56.530001 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 17:49:56.773385 140668698150912 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 197.41
I0902 17:50:01.839278 140668698150912 replay_runner.py:36] Average training steps per second: 197.41
I0902 17:50:02.241943 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 315 Episode length: 315 Return: -314.0
INFO:tensorflow:Average training steps per second: 205.83
I0902 17:50:07.348387 140668698150912 replay_runner.py:36] Average training steps per second: 205.83
I0902 17:50:07.582393 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 217.59
I0902 17:50:12.406963 140668698150912 replay_runner.py:36] Average training steps per second: 217.59
I0902 17:50:12.778224 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:50:13.012713 140668698150912 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 205.56

Steps executed: 256 Episode length: 126 Return: -125.0
I0902 17:50:18.069997 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 218 Return: -217.0
INFO:tensorflow:Average training steps per second: 198.73
I0902 17:50:23.476589 140668698150912 replay_runner.py:36] Average training steps per second: 198.73
I0902 17:50:23.652265 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.00
INFO:tensorflow:Starting iteration 28

Steps executed: 676 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.11
I0902 17:50:28.864859 140668698150912 replay_runner.py:36] Average training steps per second: 201.11
I0902 17:50:29.387845 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 210.76
I0902 17:50:34.367178 140668698150912 replay_runner.py:36] Average training steps per second: 210.76
I0902 17:50:34.550649 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50