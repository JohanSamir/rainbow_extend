I0902 00:23:48.505703 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:48.514720 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:48.515009 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:48.515130 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:48.515214 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:48.515289 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:48.515361 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:48.515456 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:48.515566 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:48.515666 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:48.515733 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:48.515825 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:48.515899 139644712736768 dqn_agent.py:283] 	 seed: 1630542228514666
I0902 00:23:48.518129 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:48.518268 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:48.518352 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:48.518421 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:48.518483 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:48.518565 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:48.518657 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:48.518731 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:48.518809 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:48.547921 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:48.805574 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:48.814414 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:48.822607 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:48.822810 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:48.822941 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:48.823054 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:48.823162 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:48.823275 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:48.823467 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:48.823589 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:48.823700 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:48.823827 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:48.823955 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:48.824064 139644712736768 dqn_agent.py:283] 	 seed: 1630542228822565
I0902 00:23:48.826627 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:48.826793 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:48.826938 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:48.827049 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:48.827162 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:48.827271 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:48.827405 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:48.827538 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:48.827644 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:48.858649 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:48.881082 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:48.881332 139644712736768 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 235.87
I0902 00:23:53.121160 139644712736768 replay_runner.py:36] Average training steps per second: 235.87
I0902 00:23:53.899961 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.23
Steps executed: 240 Episode length: 135 Return: -454.46825676360163
INFO:tensorflow:Starting iteration 1

Steps executed: 397 Episode length: 230 Return: -392.15342409714384
INFO:tensorflow:Average training steps per second: 313.72
I0902 00:24:00.288578 139644712736768 replay_runner.py:36] Average training steps per second: 313.72
I0902 00:24:00.565771 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.57
INFO:tensorflow:Starting iteration 2
I0902 00:24:03.655621 139644712736768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 341.34
I0902 00:24:06.585473 139644712736768 replay_runner.py:36] Average training steps per second: 341.34

Steps executed: 246 Episode length: 132 Return: 32.8890120537109374
INFO:tensorflow:Starting iteration 3
I0902 00:24:10.074251 139644712736768 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 340.39
I0902 00:24:13.012373 139644712736768 replay_runner.py:36] Average training steps per second: 340.39

Steps executed: 586 Episode length: 586 Return: -203.94671807591243
INFO:tensorflow:Starting iteration 4
I0902 00:24:17.028627 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 328.63

Steps executed: 1000 Episode length: 1000 Return: -110.51907569010103
I0902 00:24:21.541339 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.52
INFO:tensorflow:Starting iteration 5

Steps executed: 371 Episode length: 371 Return: -204.7208790894271703
INFO:tensorflow:Average training steps per second: 336.74
I0902 00:24:27.818393 139644712736768 replay_runner.py:36] Average training steps per second: 336.74
I0902 00:24:28.191844 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.72
INFO:tensorflow:Starting iteration 6

Steps executed: 1000 Episode length: 1000 Return: -224.33791863575618
INFO:tensorflow:Average training steps per second: 357.49
I0902 00:24:34.386797 139644712736768 replay_runner.py:36] Average training steps per second: 357.49
I0902 00:24:36.161710 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.34
INFO:tensorflow:Starting iteration 7
I0902 00:24:39.600871 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 372.17

Steps executed: 666 Episode length: 666 Return: -387.9790845560387618
I0902 00:24:43.515496 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.98
INFO:tensorflow:Starting iteration 8
I0902 00:24:46.981212 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 356.56

Steps executed: 1000 Episode length: 1000 Return: -117.06784358421167
I0902 00:24:51.154089 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.07
INFO:tensorflow:Starting iteration 9
I0902 00:24:54.660163 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 355.44

Steps executed: 1000 Episode length: 1000 Return: -150.19754441762694
I0902 00:25:00.004807 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.20
INFO:tensorflow:Starting iteration 10
I0902 00:25:03.473459 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 360.24

Steps executed: 344 Episode length: 344 Return: -256.6650909876033694
I0902 00:25:06.559110 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.67
INFO:tensorflow:Starting iteration 11
I0902 00:25:10.003414 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 334.30

Steps executed: 1000 Episode length: 1000 Return: -160.92951135593833
I0902 00:25:14.820973 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.93
INFO:tensorflow:Starting iteration 12
I0902 00:25:18.236042 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 337.95

Steps executed: 1000 Episode length: 1000 Return: -98.565031665728213
I0902 00:25:23.545869 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.57
INFO:tensorflow:Starting iteration 13

Steps executed: 215 Episode length: 215 Return: -132.0400680250003213
INFO:tensorflow:Average training steps per second: 354.53
I0902 00:25:29.828431 139644712736768 replay_runner.py:36] Average training steps per second: 354.53
I0902 00:25:29.971404 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.04
INFO:tensorflow:Starting iteration 14
I0902 00:25:33.511370 139644712736768 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 365.02

Steps executed: 755 Episode length: 755 Return: -221.2127154683837213
I0902 00:25:37.301964 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.21
INFO:tensorflow:Starting iteration 15

Steps executed: 303 Episode length: 303 Return: -206.1153356131836713
INFO:tensorflow:Average training steps per second: 377.73
I0902 00:25:43.540679 139644712736768 replay_runner.py:36] Average training steps per second: 377.73
I0902 00:25:43.783505 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.12
INFO:tensorflow:Starting iteration 16

Steps executed: 363 Episode length: 250 Return: -116.1154403999688213
INFO:tensorflow:Average training steps per second: 367.33
I0902 00:25:50.074280 139644712736768 replay_runner.py:36] Average training steps per second: 367.33
I0902 00:25:50.307771 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.20
INFO:tensorflow:Starting iteration 17
I0902 00:25:53.783517 139644712736768 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 346.04

Steps executed: 448 Episode length: 448 Return: -50.41673002825145213
I0902 00:25:57.179384 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -50.42
INFO:tensorflow:Starting iteration 18

Steps executed: 255 Episode length: 99 Return: -428.34820016954944213
INFO:tensorflow:Average training steps per second: 339.74
I0902 00:26:03.568022 139644712736768 replay_runner.py:36] Average training steps per second: 339.74
I0902 00:26:03.706655 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.34
INFO:tensorflow:Starting iteration 19

Steps executed: 190 Episode length: 72 Return: -142.41682443143938513
INFO:tensorflow:Average training steps per second: 339.14

Steps executed: 678 Episode length: 488 Return: -4.361223914107427513
I0902 00:26:10.828285 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.73
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 57 Return: -61.326490152267236513
INFO:tensorflow:Average training steps per second: 344.78
I0902 00:26:17.234613 139644712736768 replay_runner.py:36] Average training steps per second: 344.78
I0902 00:26:17.352525 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.12
INFO:tensorflow:Starting iteration 21

Steps executed: 211 Episode length: 211 Return: 41.871681900983536513
INFO:tensorflow:Average training steps per second: 349.05
I0902 00:26:23.717557 139644712736768 replay_runner.py:36] Average training steps per second: 349.05
I0902 00:26:23.875917 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 41.87
INFO:tensorflow:Starting iteration 22
I0902 00:26:27.295149 139644712736768 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 329.98

Steps executed: 627 Episode length: 627 Return: -26.94972601441790513
I0902 00:26:31.072333 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.95
INFO:tensorflow:Starting iteration 23

Steps executed: 247 Episode length: 57 Return: -154.18015227215614513
INFO:tensorflow:Average training steps per second: 330.36
I0902 00:26:37.547700 139644712736768 replay_runner.py:36] Average training steps per second: 330.36
I0902 00:26:37.663985 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.45
INFO:tensorflow:Starting iteration 24

Steps executed: 423 Episode length: 230 Return: -31.68083399970139513
INFO:tensorflow:Average training steps per second: 323.25
I0902 00:26:44.148628 139644712736768 replay_runner.py:36] Average training steps per second: 323.25
I0902 00:26:44.438722 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -55.91
INFO:tensorflow:Starting iteration 25
I0902 00:26:47.786226 139644712736768 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 323.89

Steps executed: 1000 Episode length: 1000 Return: -6.8157044887881123
I0902 00:26:52.928854 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -6.82
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 154 Return: -135.1938513094840523
INFO:tensorflow:Average training steps per second: 342.71
I0902 00:26:59.187939 139644712736768 replay_runner.py:36] Average training steps per second: 342.71
I0902 00:26:59.305511 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.58
INFO:tensorflow:Starting iteration 27

Steps executed: 280 Episode length: 146 Return: -55.30091330988205523
INFO:tensorflow:Average training steps per second: 355.82
I0902 00:27:05.349945 139644712736768 replay_runner.py:36] Average training steps per second: 355.82
I0902 00:27:05.524315 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.91
INFO:tensorflow:Starting iteration 28

Steps executed: 309 Episode length: 184 Return: -69.30768568751571523
INFO:tensorflow:Average training steps per second: 363.55
I0902 00:27:11.650103 139644712736768 replay_runner.py:36] Average training steps per second: 363.55
I0902 00:27:11.833997 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.99
INFO:tensorflow:Starting iteration 29

Steps executed: 421 Episode length: 421 Return: -430.0747587570471523
INFO:tensorflow:Average training steps per second: 354.28
I0902 00:27:18.040229 139644712736768 replay_runner.py:36] Average training steps per second: 354.28

Done fixed training!Episode length: 421 Return: -430.0747587570471523