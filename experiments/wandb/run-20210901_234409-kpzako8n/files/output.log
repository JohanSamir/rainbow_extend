Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 23:44:15.560117 140156774885376 run_experiment.py:549] Creating TrainRunner ...
I0901 23:44:15.570386 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:15.570672 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:15.570899 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:15.571036 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:15.571159 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:15.571263 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:15.571349 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:15.571440 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:15.571521 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:15.571600 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:15.571691 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:15.571787 140156774885376 dqn_agent.py:283] 	 seed: 1630539855570325
I0901 23:44:15.574105 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:15.574313 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:15.574452 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:15.574549 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:15.574630 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:15.574699 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:15.574785 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:15.574850 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:15.574961 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:15.614067 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:16.120843 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:16.137647 140156774885376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:44:16.147329 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:16.147572 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:16.147716 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:16.147843 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:16.148114 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:16.148347 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:16.148485 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:16.148615 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:16.148756 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:16.148885 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:16.149003 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:16.149128 140156774885376 dqn_agent.py:283] 	 seed: 1630539856147267
I0901 23:44:16.152184 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:16.152397 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:16.152538 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:16.152686 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:16.152823 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:16.152999 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:16.153133 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:16.153257 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:16.153379 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:16.191203 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:16.214006 140156774885376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:44:16.214381 140156774885376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.46
I0901 23:44:22.861462 140156774885376 replay_runner.py:36] Average training steps per second: 150.46
Steps executed: 205 Episode length: 10 Return: 10.0
I0901 23:44:24.076296 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1
I0901 23:44:24.268671 140156774885376 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 203.64

Steps executed: 354 Episode length: 183 Return: 183.0
I0901 23:44:29.388075 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.25
I0901 23:44:34.405689 140156774885376 replay_runner.py:36] Average training steps per second: 206.25
I0901 23:44:34.534867 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 271 Episode length: 87 Return: 87.0.0
INFO:tensorflow:Average training steps per second: 206.22
I0901 23:44:39.564483 140156774885376 replay_runner.py:36] Average training steps per second: 206.22
I0901 23:44:39.719902 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.33
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.17
I0901 23:44:44.743238 140156774885376 replay_runner.py:36] Average training steps per second: 206.17
I0901 23:44:44.871822 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 23:44:45.057263 140156774885376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 198.19
I0901 23:44:50.103398 140156774885376 replay_runner.py:36] Average training steps per second: 198.19
I0901 23:44:50.229976 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0901 23:44:50.407166 140156774885376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.73

Steps executed: 396 Episode length: 200 Return: 200.0
I0901 23:44:55.761426 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 7

Steps executed: 376 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 199.11
I0901 23:45:00.977962 140156774885376 replay_runner.py:36] Average training steps per second: 199.11
I0901 23:45:01.227444 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 8

Steps executed: 322 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 197.61
I0901 23:45:06.476717 140156774885376 replay_runner.py:36] Average training steps per second: 197.61
I0901 23:45:06.701932 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 9

Steps executed: 261 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 195.84
I0901 23:45:11.994375 140156774885376 replay_runner.py:36] Average training steps per second: 195.84
I0901 23:45:12.185800 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.53
I0901 23:45:17.488483 140156774885376 replay_runner.py:36] Average training steps per second: 195.53
I0901 23:45:17.631136 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 279 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 193.22
I0901 23:45:23.000358 140156774885376 replay_runner.py:36] Average training steps per second: 193.22
I0901 23:45:23.186094 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 12

Steps executed: 315 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 196.39
I0901 23:45:28.471400 140156774885376 replay_runner.py:36] Average training steps per second: 196.39
I0901 23:45:28.678578 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 13

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.49
I0901 23:45:33.879124 140156774885376 replay_runner.py:36] Average training steps per second: 199.49
I0901 23:45:34.144202 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 14
I0901 23:45:34.332203 140156774885376 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.21
I0901 23:45:39.508471 140156774885376 replay_runner.py:36] Average training steps per second: 193.21
I0901 23:45:39.655475 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.50
I0901 23:45:45.016221 140156774885376 replay_runner.py:36] Average training steps per second: 193.50
I0901 23:45:45.151874 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 297 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 192.87
I0901 23:45:50.522909 140156774885376 replay_runner.py:36] Average training steps per second: 192.87
I0901 23:45:50.722077 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.05
I0901 23:45:56.017467 140156774885376 replay_runner.py:36] Average training steps per second: 196.05
I0901 23:45:56.159075 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 133 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 196.06

Steps executed: 278 Episode length: 145 Return: 145.0
I0901 23:46:01.652890 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 19

Steps executed: 388 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 194.52
I0901 23:46:06.985873 140156774885376 replay_runner.py:36] Average training steps per second: 194.52
I0901 23:46:07.245740 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 20

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.89
I0901 23:46:12.525748 140156774885376 replay_runner.py:36] Average training steps per second: 195.89
I0901 23:46:12.790696 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.64
I0901 23:46:18.090613 140156774885376 replay_runner.py:36] Average training steps per second: 195.64
I0901 23:46:18.230059 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:46:18.419749 140156774885376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.45
I0901 23:46:23.643627 140156774885376 replay_runner.py:36] Average training steps per second: 191.45
I0901 23:46:23.786574 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:46:23.981764 140156774885376 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.29
I0901 23:46:29.102868 140156774885376 replay_runner.py:36] Average training steps per second: 195.29
I0901 23:46:29.236562 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:46:29.426861 140156774885376 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 195.97
I0901 23:46:34.530063 140156774885376 replay_runner.py:36] Average training steps per second: 195.97
I0901 23:46:34.665430 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:46:34.851017 140156774885376 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.72
I0901 23:46:39.909132 140156774885376 replay_runner.py:36] Average training steps per second: 197.72
I0901 23:46:40.043777 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:46:40.237754 140156774885376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.08
I0901 23:46:45.390659 140156774885376 replay_runner.py:36] Average training steps per second: 194.08
I0901 23:46:45.528990 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:46:45.707860 140156774885376 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.77
I0901 23:46:50.790361 140156774885376 replay_runner.py:36] Average training steps per second: 196.77
I0901 23:46:50.923647 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:46:51.114047 140156774885376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 201.05
I0901 23:46:56.088357 140156774885376 replay_runner.py:36] Average training steps per second: 201.05
I0901 23:46:56.218843 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 163 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 196.18
I0901 23:47:01.500396 140156774885376 replay_runner.py:36] Average training steps per second: 196.18

Done fixed training!Episode length: 190 Return: 190.0