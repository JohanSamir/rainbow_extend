Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 18:05:25.958481 140451420674048 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:25.971572 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:25.971841 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:25.972014 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:25.972120 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:25.972197 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:25.972291 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:25.972527 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:25.972803 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:25.972975 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:25.973083 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:25.973181 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:25.973282 140451420674048 dqn_agent.py:283] 	 seed: 1630605925971496
I0902 18:05:25.975671 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:25.975924 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:25.976094 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:25.976239 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:25.976356 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:25.976479 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:25.976610 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:25.976765 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:25.976961 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:26.017190 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:26.484684 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:26.500576 140451420674048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:26.511210 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:26.511476 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:26.511598 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:26.511701 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:26.511805 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:26.511986 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:26.512126 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:26.512233 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:26.512384 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:26.512461 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:26.512572 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:26.512805 140451420674048 dqn_agent.py:283] 	 seed: 1630605926511135
I0902 18:05:26.514519 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:26.514639 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:26.514708 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:26.514772 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:26.514828 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:26.514897 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:26.514968 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:26.515038 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:26.515100 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:26.547299 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:26.574436 140451420674048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:26.574738 140451420674048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.19
I0902 18:05:32.592368 140451420674048 replay_runner.py:36] Average training steps per second: 166.19
Steps executed: 254 Episode length: 88 Return: -111.88169914026538
I0902 18:05:33.761247 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.92
INFO:tensorflow:Starting iteration 1

Steps executed: 323 Episode length: 208 Return: -107.5159336236897
INFO:tensorflow:Average training steps per second: 229.03
I0902 18:05:42.569774 140451420674048 replay_runner.py:36] Average training steps per second: 229.03
I0902 18:05:42.861773 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.30
INFO:tensorflow:Starting iteration 2

Steps executed: 106 Episode length: 106 Return: -238.3777215230135
INFO:tensorflow:Average training steps per second: 234.44
I0902 18:05:51.507917 140451420674048 replay_runner.py:36] Average training steps per second: 234.44

Steps executed: 209 Episode length: 103 Return: -431.44796243771975
INFO:tensorflow:Starting iteration 3

Steps executed: 230 Episode length: 230 Return: -144.33703261658223
INFO:tensorflow:Average training steps per second: 235.37
I0902 18:06:00.494838 140451420674048 replay_runner.py:36] Average training steps per second: 235.37
I0902 18:06:00.706951 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.34
INFO:tensorflow:Starting iteration 4

Steps executed: 231 Episode length: 85 Return: -384.754360490722833
INFO:tensorflow:Average training steps per second: 233.79
I0902 18:06:09.313556 140451420674048 replay_runner.py:36] Average training steps per second: 233.79
I0902 18:06:09.507696 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.42
INFO:tensorflow:Starting iteration 5

Steps executed: 209 Episode length: 100 Return: -653.85361044820774
INFO:tensorflow:Average training steps per second: 231.53
I0902 18:06:18.157644 140451420674048 replay_runner.py:36] Average training steps per second: 231.53
I0902 18:06:18.317209 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.11
INFO:tensorflow:Starting iteration 6

Steps executed: 278 Episode length: 190 Return: -179.81925192851125
INFO:tensorflow:Average training steps per second: 228.46
I0902 18:06:27.039285 140451420674048 replay_runner.py:36] Average training steps per second: 228.46
I0902 18:06:27.284714 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.35
INFO:tensorflow:Starting iteration 7

Steps executed: 222 Episode length: 103 Return: -227.97184764178034
INFO:tensorflow:Average training steps per second: 224.51
I0902 18:06:36.100822 140451420674048 replay_runner.py:36] Average training steps per second: 224.51
I0902 18:06:36.300770 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.84
INFO:tensorflow:Starting iteration 8

Steps executed: 395 Episode length: 196 Return: -303.67770506499794
INFO:tensorflow:Average training steps per second: 218.28
I0902 18:06:45.334419 140451420674048 replay_runner.py:36] Average training steps per second: 218.28
I0902 18:06:45.694597 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -526.12
INFO:tensorflow:Starting iteration 9

Steps executed: 321 Episode length: 160 Return: -694.64967083407564
INFO:tensorflow:Average training steps per second: 220.97
I0902 18:06:54.591970 140451420674048 replay_runner.py:36] Average training steps per second: 220.97
I0902 18:06:54.898748 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -652.31
INFO:tensorflow:Starting iteration 10

Steps executed: 218 Episode length: 92 Return: -726.333028659553467
INFO:tensorflow:Average training steps per second: 225.38
I0902 18:07:03.819369 140451420674048 replay_runner.py:36] Average training steps per second: 225.38
I0902 18:07:04.010480 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.16
INFO:tensorflow:Starting iteration 11

Steps executed: 313 Episode length: 114 Return: -174.99961506357698
INFO:tensorflow:Average training steps per second: 222.04
I0902 18:07:12.922874 140451420674048 replay_runner.py:36] Average training steps per second: 222.04
I0902 18:07:13.174603 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.30
INFO:tensorflow:Starting iteration 12
I0902 18:07:17.568644 140451420674048 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 222.29

Steps executed: 275 Episode length: 141 Return: -378.61931441172438
I0902 18:07:22.314881 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.96
INFO:tensorflow:Starting iteration 13

Steps executed: 276 Episode length: 180 Return: -404.08230254518348
INFO:tensorflow:Average training steps per second: 224.39
I0902 18:07:31.180255 140451420674048 replay_runner.py:36] Average training steps per second: 224.39
I0902 18:07:31.427112 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.00
INFO:tensorflow:Starting iteration 14

Steps executed: 224 Episode length: 108 Return: -393.18767576791055
INFO:tensorflow:Average training steps per second: 223.47
I0902 18:07:40.343285 140451420674048 replay_runner.py:36] Average training steps per second: 223.47
I0902 18:07:40.528440 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.06
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 129 Return: -396.66612835741455
INFO:tensorflow:Average training steps per second: 227.32
I0902 18:07:49.360483 140451420674048 replay_runner.py:36] Average training steps per second: 227.32
I0902 18:07:49.562730 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -546.78
INFO:tensorflow:Starting iteration 16
I0902 18:07:53.963315 140451420674048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 230.72

Steps executed: 276 Episode length: 86 Return: -613.847970799892345
I0902 18:07:58.536937 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.08
INFO:tensorflow:Starting iteration 17

Steps executed: 116 Episode length: 116 Return: -287.83502840016475
INFO:tensorflow:Average training steps per second: 219.27
I0902 18:08:07.338890 140451420674048 replay_runner.py:36] Average training steps per second: 219.27

Steps executed: 469 Episode length: 353 Return: 123.076554791517615
INFO:tensorflow:Starting iteration 18

Steps executed: 320 Episode length: 154 Return: -118.97226207415075
INFO:tensorflow:Average training steps per second: 225.64
I0902 18:08:16.523425 140451420674048 replay_runner.py:36] Average training steps per second: 225.64
I0902 18:08:16.804669 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.26
INFO:tensorflow:Starting iteration 19

Steps executed: 278 Episode length: 141 Return: -307.28193587095795
INFO:tensorflow:Average training steps per second: 226.93
I0902 18:08:25.507638 140451420674048 replay_runner.py:36] Average training steps per second: 226.93
I0902 18:08:25.750844 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.39
INFO:tensorflow:Starting iteration 20

Steps executed: 311 Episode length: 131 Return: -141.19414205285577
INFO:tensorflow:Average training steps per second: 219.22
I0902 18:08:34.659680 140451420674048 replay_runner.py:36] Average training steps per second: 219.22
I0902 18:08:34.925105 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.68
INFO:tensorflow:Starting iteration 21

Steps executed: 239 Episode length: 101 Return: -410.06622531444017
INFO:tensorflow:Average training steps per second: 222.98
I0902 18:08:43.717875 140451420674048 replay_runner.py:36] Average training steps per second: 222.98
I0902 18:08:43.940299 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.31
INFO:tensorflow:Starting iteration 22
I0902 18:08:48.272334 140451420674048 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 228.04

Steps executed: 221 Episode length: 128 Return: -411.69067684375857
I0902 18:08:52.914452 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.63
INFO:tensorflow:Starting iteration 23

Steps executed: 286 Episode length: 127 Return: -232.32420760282987
INFO:tensorflow:Average training steps per second: 239.27
I0902 18:09:01.445156 140451420674048 replay_runner.py:36] Average training steps per second: 239.27
I0902 18:09:01.696442 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.70
INFO:tensorflow:Starting iteration 24

Steps executed: 250 Episode length: 85 Return: -530.936004772409387
INFO:tensorflow:Average training steps per second: 232.33
I0902 18:09:10.452801 140451420674048 replay_runner.py:36] Average training steps per second: 232.33
I0902 18:09:10.644588 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.15
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 123 Return: -478.17009346258465
INFO:tensorflow:Average training steps per second: 217.51
I0902 18:09:19.626518 140451420674048 replay_runner.py:36] Average training steps per second: 217.51
I0902 18:09:19.838754 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.54
INFO:tensorflow:Starting iteration 26

Steps executed: 248 Episode length: 128 Return: -490.13650713610955
INFO:tensorflow:Average training steps per second: 219.22
I0902 18:09:28.744796 140451420674048 replay_runner.py:36] Average training steps per second: 219.22
I0902 18:09:28.973246 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.81
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 104 Return: -211.02883483187665
INFO:tensorflow:Average training steps per second: 226.80
I0902 18:09:37.749058 140451420674048 replay_runner.py:36] Average training steps per second: 226.80
I0902 18:09:37.928290 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.66
INFO:tensorflow:Starting iteration 28

Steps executed: 294 Episode length: 98 Return: -284.780552101990855
INFO:tensorflow:Average training steps per second: 224.37
I0902 18:09:46.764852 140451420674048 replay_runner.py:36] Average training steps per second: 224.37
I0902 18:09:47.023616 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.04
INFO:tensorflow:Starting iteration 29

Steps executed: 259 Episode length: 83 Return: -504.201993467297037
INFO:tensorflow:Average training steps per second: 215.53
I0902 18:09:55.971665 140451420674048 replay_runner.py:36] Average training steps per second: 215.53

Done fixed training!Episode length: 83 Return: -504.201993467297037