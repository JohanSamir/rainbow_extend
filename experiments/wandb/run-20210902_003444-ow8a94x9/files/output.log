I0902 00:34:50.016269 139752435963904 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:50.024533 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:50.024670 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:50.024782 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:50.024842 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:50.024918 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:50.024974 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:50.025074 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:50.025133 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:50.025199 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:50.025338 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:50.025462 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:50.025554 139752435963904 dqn_agent.py:283] 	 seed: 1630542890024498
I0902 00:34:50.027904 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:50.028068 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:50.028189 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:50.028307 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:50.028376 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:50.028428 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:50.028499 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:50.028590 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:50.028667 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:50.053143 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:50.284592 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:50.293790 139752435963904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:50.300537 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:50.300684 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:50.300753 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:50.300819 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:50.300878 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:50.300934 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:50.300987 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:50.301039 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:50.301127 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:50.301239 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:50.301299 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:50.301377 139752435963904 dqn_agent.py:283] 	 seed: 1630542890300506
I0902 00:34:50.302863 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:50.302981 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:50.303052 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:50.303115 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:50.303172 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:50.303265 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:50.303334 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:50.303389 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:50.303467 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:50.321121 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:50.335726 139752435963904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:50.335885 139752435963904 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 249.13
I0902 00:34:54.349932 139752435963904 replay_runner.py:36] Average training steps per second: 249.13
I0902 00:34:55.102895 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.84
Steps executed: 209 Episode length: 88 Return: -366.40187269998034
INFO:tensorflow:Starting iteration 1

Steps executed: 216 Episode length: 122 Return: -243.7951632374481
INFO:tensorflow:Average training steps per second: 333.27
I0902 00:35:01.466296 139752435963904 replay_runner.py:36] Average training steps per second: 333.27
I0902 00:35:01.580183 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.55
INFO:tensorflow:Starting iteration 2

Steps executed: 321 Episode length: 138 Return: -379.00922836573625
INFO:tensorflow:Average training steps per second: 334.30
I0902 00:35:07.812312 139752435963904 replay_runner.py:36] Average training steps per second: 334.30
I0902 00:35:07.981986 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.69
INFO:tensorflow:Starting iteration 3

Steps executed: 235 Episode length: 117 Return: -271.53859333888015
INFO:tensorflow:Average training steps per second: 336.03
I0902 00:35:14.266225 139752435963904 replay_runner.py:36] Average training steps per second: 336.03
I0902 00:35:14.397733 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.04
INFO:tensorflow:Starting iteration 4

Steps executed: 358 Episode length: 163 Return: -571.57896747277215
INFO:tensorflow:Average training steps per second: 325.16
I0902 00:35:20.832639 139752435963904 replay_runner.py:36] Average training steps per second: 325.16
I0902 00:35:21.070973 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.86
INFO:tensorflow:Starting iteration 5

Steps executed: 289 Episode length: 190 Return: -508.20127217567256
INFO:tensorflow:Average training steps per second: 342.51
I0902 00:35:27.354262 139752435963904 replay_runner.py:36] Average training steps per second: 342.51
I0902 00:35:27.545391 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.48
INFO:tensorflow:Starting iteration 6

Steps executed: 343 Episode length: 162 Return: -663.83022881994746
INFO:tensorflow:Average training steps per second: 335.30
I0902 00:35:33.937565 139752435963904 replay_runner.py:36] Average training steps per second: 335.30
I0902 00:35:34.150382 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.25
INFO:tensorflow:Starting iteration 7

Steps executed: 481 Episode length: 345 Return: -1070.0641019960444
INFO:tensorflow:Average training steps per second: 349.90
I0902 00:35:40.379904 139752435963904 replay_runner.py:36] Average training steps per second: 349.90
I0902 00:35:40.763638 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -875.57
INFO:tensorflow:Starting iteration 8

Steps executed: 425 Episode length: 231 Return: -174.52491782724184
INFO:tensorflow:Average training steps per second: 349.36
I0902 00:35:47.039125 139752435963904 replay_runner.py:36] Average training steps per second: 349.36
I0902 00:35:47.351296 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.80
INFO:tensorflow:Starting iteration 9

Steps executed: 390 Episode length: 210 Return: -389.50152559807164
INFO:tensorflow:Average training steps per second: 357.19
I0902 00:35:53.515075 139752435963904 replay_runner.py:36] Average training steps per second: 357.19
I0902 00:35:53.835632 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.87
INFO:tensorflow:Starting iteration 10

Steps executed: 355 Episode length: 355 Return: -124.18076228298781
INFO:tensorflow:Average training steps per second: 359.75
I0902 00:36:00.080991 139752435963904 replay_runner.py:36] Average training steps per second: 359.75
I0902 00:36:00.452253 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.18
INFO:tensorflow:Starting iteration 11

Steps executed: 448 Episode length: 286 Return: -1087.2250168456922
INFO:tensorflow:Average training steps per second: 357.10
I0902 00:36:06.716767 139752435963904 replay_runner.py:36] Average training steps per second: 357.10
I0902 00:36:07.049043 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -820.68
INFO:tensorflow:Starting iteration 12

Steps executed: 395 Episode length: 288 Return: -180.68911611499468
INFO:tensorflow:Average training steps per second: 354.88
I0902 00:36:13.353935 139752435963904 replay_runner.py:36] Average training steps per second: 354.88
I0902 00:36:13.657537 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.11
INFO:tensorflow:Starting iteration 13

Steps executed: 216 Episode length: 53 Return: -118.479739987161938
INFO:tensorflow:Average training steps per second: 351.05
I0902 00:36:19.950270 139752435963904 replay_runner.py:36] Average training steps per second: 351.05
I0902 00:36:20.083722 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.65
INFO:tensorflow:Starting iteration 14

Steps executed: 250 Episode length: 84 Return: -456.450361657515774
INFO:tensorflow:Average training steps per second: 348.89
I0902 00:36:26.374310 139752435963904 replay_runner.py:36] Average training steps per second: 348.89
I0902 00:36:26.532747 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.61
INFO:tensorflow:Starting iteration 15

Steps executed: 244 Episode length: 170 Return: -902.28144253394424
INFO:tensorflow:Average training steps per second: 343.48
I0902 00:36:32.819423 139752435963904 replay_runner.py:36] Average training steps per second: 343.48
I0902 00:36:32.986846 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.17
INFO:tensorflow:Starting iteration 16
I0902 00:36:36.433193 139752435963904 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 346.15

Steps executed: 1000 Episode length: 1000 Return: -373.9561689614868
I0902 00:36:40.713610 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.96
INFO:tensorflow:Starting iteration 17

Steps executed: 293 Episode length: 188 Return: -325.167011419457378
INFO:tensorflow:Average training steps per second: 337.05
I0902 00:36:47.016925 139752435963904 replay_runner.py:36] Average training steps per second: 337.05
I0902 00:36:47.204298 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.54
INFO:tensorflow:Starting iteration 18

Steps executed: 243 Episode length: 56 Return: -119.1453058209121678
INFO:tensorflow:Average training steps per second: 328.96
I0902 00:36:53.584052 139752435963904 replay_runner.py:36] Average training steps per second: 328.96
I0902 00:36:53.702210 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.95
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 61 Return: -268.4698698814397678
INFO:tensorflow:Average training steps per second: 331.38
I0902 00:37:00.123878 139752435963904 replay_runner.py:36] Average training steps per second: 331.38
I0902 00:37:00.276690 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.95
INFO:tensorflow:Starting iteration 20

Steps executed: 266 Episode length: 143 Return: -545.788100858696978
INFO:tensorflow:Average training steps per second: 334.85
I0902 00:37:06.648930 139752435963904 replay_runner.py:36] Average training steps per second: 334.85
I0902 00:37:06.813021 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.31
INFO:tensorflow:Starting iteration 21

Steps executed: 269 Episode length: 78 Return: -309.9243420715884378
INFO:tensorflow:Average training steps per second: 331.21
I0902 00:37:13.200254 139752435963904 replay_runner.py:36] Average training steps per second: 331.21
I0902 00:37:13.344388 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.78
INFO:tensorflow:Starting iteration 22

Steps executed: 255 Episode length: 66 Return: -422.9626659286174878
INFO:tensorflow:Average training steps per second: 332.25
I0902 00:37:19.734079 139752435963904 replay_runner.py:36] Average training steps per second: 332.25
I0902 00:37:19.878197 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.13
INFO:tensorflow:Starting iteration 23

Steps executed: 222 Episode length: 78 Return: -167.3076352329213378
INFO:tensorflow:Average training steps per second: 338.63
I0902 00:37:26.218085 139752435963904 replay_runner.py:36] Average training steps per second: 338.63
I0902 00:37:26.339466 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.84
INFO:tensorflow:Starting iteration 24

Steps executed: 248 Episode length: 67 Return: -665.5319705572105478
INFO:tensorflow:Average training steps per second: 344.47
I0902 00:37:32.636919 139752435963904 replay_runner.py:36] Average training steps per second: 344.47
I0902 00:37:32.779863 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.90
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 50 Return: -434.3918275613986678
INFO:tensorflow:Average training steps per second: 352.02
I0902 00:37:38.977377 139752435963904 replay_runner.py:36] Average training steps per second: 352.02
I0902 00:37:39.115700 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.05
INFO:tensorflow:Starting iteration 26

Steps executed: 204 Episode length: 61 Return: -529.4384568530038678
INFO:tensorflow:Average training steps per second: 347.16
I0902 00:37:45.333464 139752435963904 replay_runner.py:36] Average training steps per second: 347.16
I0902 00:37:45.449632 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -621.99
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 77 Return: -824.7252876442572678
INFO:tensorflow:Average training steps per second: 357.03
I0902 00:37:51.648907 139752435963904 replay_runner.py:36] Average training steps per second: 357.03
I0902 00:37:51.782383 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -739.39
INFO:tensorflow:Starting iteration 28

Steps executed: 223 Episode length: 62 Return: -567.1061665083886678
INFO:tensorflow:Average training steps per second: 370.73
I0902 00:37:57.912992 139752435963904 replay_runner.py:36] Average training steps per second: 370.73
I0902 00:37:58.042449 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -663.53
INFO:tensorflow:Starting iteration 29
I0902 00:38:01.513613 139752435963904 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 360.76

Steps executed: 238 Episode length: 72 Return: -587.4866123869692478

Done fixed training!Episode length: 72 Return: -587.4866123869692478