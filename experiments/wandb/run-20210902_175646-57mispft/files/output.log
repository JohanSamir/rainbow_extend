Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0902 17:56:52.680040 140665773373440 run_experiment.py:549] Creating TrainRunner ...
I0902 17:56:52.689769 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:52.690048 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:52.690170 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:52.690253 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:52.690362 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:52.690498 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:52.690762 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:52.690998 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:52.691111 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:52.691469 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:52.691617 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:52.691751 140665773373440 dqn_agent.py:283] 	 seed: 1630605412689710
I0902 17:56:52.695243 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:52.695440 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:52.695622 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:52.695729 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:52.695820 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:52.695939 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:52.696121 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:52.696381 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:52.696529 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:52.735019 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:53.195466 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:53.210776 140665773373440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:56:53.220917 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:53.221183 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:53.221384 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:53.221540 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:53.222268 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:53.222502 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:53.222687 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:53.222827 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:53.223007 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:53.223165 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:53.223308 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:53.223633 140665773373440 dqn_agent.py:283] 	 seed: 1630605413220845
I0902 17:56:53.226540 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:53.226794 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:53.227058 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:53.227167 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:53.227250 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:53.227350 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:53.227449 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:53.227591 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:53.227700 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:53.264501 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:53.291878 140665773373440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:56:53.292198 140665773373440 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.59
I0902 17:56:59.933186 140665773373440 replay_runner.py:36] Average training steps per second: 150.59
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:57:01.479078 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:57:01.724381 140665773373440 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.81
I0902 17:57:06.704751 140665773373440 replay_runner.py:36] Average training steps per second: 200.81
I0902 17:57:07.100753 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:57:07.327652 140665773373440 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 198.65
I0902 17:57:12.362276 140665773373440 replay_runner.py:36] Average training steps per second: 198.65
I0902 17:57:12.780630 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:57:13.036935 140665773373440 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 201.42
I0902 17:57:18.002307 140665773373440 replay_runner.py:36] Average training steps per second: 201.42
I0902 17:57:18.416049 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:57:18.669123 140665773373440 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 198.86
I0902 17:57:23.698210 140665773373440 replay_runner.py:36] Average training steps per second: 198.86
I0902 17:57:24.118002 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 235 Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 198.65
I0902 17:57:29.376146 140665773373440 replay_runner.py:36] Average training steps per second: 198.65
I0902 17:57:29.572578 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.88
I0902 17:57:34.983198 140665773373440 replay_runner.py:36] Average training steps per second: 193.88
I0902 17:57:35.398945 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:57:35.645722 140665773373440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.33
I0902 17:57:40.791812 140665773373440 replay_runner.py:36] Average training steps per second: 194.33
I0902 17:57:41.206014 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:57:41.449770 140665773373440 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.18

Steps executed: 297 Episode length: 124 Return: -123.0
I0902 17:57:46.778333 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.26
I0902 17:57:52.134663 140665773373440 replay_runner.py:36] Average training steps per second: 196.26
I0902 17:57:52.564479 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:57:52.816985 140665773373440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 195.66
I0902 17:57:57.928184 140665773373440 replay_runner.py:36] Average training steps per second: 195.66
I0902 17:57:58.351307 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:57:58.600101 140665773373440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 201.11
I0902 17:58:03.572924 140665773373440 replay_runner.py:36] Average training steps per second: 201.11
I0902 17:58:03.978705 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 325 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 194.90
I0902 17:58:09.354891 140665773373440 replay_runner.py:36] Average training steps per second: 194.90
I0902 17:58:09.628908 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.50
INFO:tensorflow:Starting iteration 13
I0902 17:58:09.868614 140665773373440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 200.29

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:58:15.306957 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:58:15.560500 140665773373440 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.72
I0902 17:58:20.722849 140665773373440 replay_runner.py:36] Average training steps per second: 193.72
I0902 17:58:21.127436 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 414 Episode length: 414 Return: -413.0
INFO:tensorflow:Average training steps per second: 197.13
I0902 17:58:26.450042 140665773373440 replay_runner.py:36] Average training steps per second: 197.13
I0902 17:58:26.790642 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.00
INFO:tensorflow:Starting iteration 16

Steps executed: 699 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.12
I0902 17:58:32.033120 140665773373440 replay_runner.py:36] Average training steps per second: 200.12
I0902 17:58:32.603095 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.33
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.21
I0902 17:58:37.888789 140665773373440 replay_runner.py:36] Average training steps per second: 198.21
I0902 17:58:38.307157 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 309 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 204.03
I0902 17:58:43.456006 140665773373440 replay_runner.py:36] Average training steps per second: 204.03
I0902 17:58:43.726159 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 19

Steps executed: 283 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 199.23
I0902 17:58:48.993731 140665773373440 replay_runner.py:36] Average training steps per second: 199.23
I0902 17:58:49.218990 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 20

Steps executed: 79 Episode length: 79 Return: -78.00.0
INFO:tensorflow:Average training steps per second: 197.75
I0902 17:58:54.516936 140665773373440 replay_runner.py:36] Average training steps per second: 197.75

Steps executed: 282 Episode length: 110 Return: -109.0
INFO:tensorflow:Starting iteration 21

Steps executed: 245 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 200.87
I0902 17:58:59.953667 140665773373440 replay_runner.py:36] Average training steps per second: 200.87
I0902 17:59:00.167434 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 210.15
I0902 17:59:05.172270 140665773373440 replay_runner.py:36] Average training steps per second: 210.15
I0902 17:59:05.351036 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 23

Steps executed: 222 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 209.77
I0902 17:59:10.340867 140665773373440 replay_runner.py:36] Average training steps per second: 209.77
I0902 17:59:10.527011 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 24

Steps executed: 258 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 207.75
I0902 17:59:15.586293 140665773373440 replay_runner.py:36] Average training steps per second: 207.75
I0902 17:59:15.777390 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 25
I0902 17:59:16.064560 140665773373440 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 200.08

Steps executed: 271 Episode length: 101 Return: -100.0
I0902 17:59:21.277406 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 26

Steps executed: 260 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 207.86
I0902 17:59:26.397903 140665773373440 replay_runner.py:36] Average training steps per second: 207.86
I0902 17:59:26.611780 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 198.02
I0902 17:59:31.903295 140665773373440 replay_runner.py:36] Average training steps per second: 198.02
I0902 17:59:32.062947 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 28

Steps executed: 405 Episode length: 405 Return: -404.0
INFO:tensorflow:Average training steps per second: 196.27
I0902 17:59:37.395261 140665773373440 replay_runner.py:36] Average training steps per second: 196.27
I0902 17:59:37.763460 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.00
INFO:tensorflow:Starting iteration 29
I0902 17:59:38.022069 140665773373440 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 201.31
I0902 17:59:42.989940 140665773373440 replay_runner.py:36] Average training steps per second: 201.31

Done fixed training!Episode length: 93 Return: -92.0.0