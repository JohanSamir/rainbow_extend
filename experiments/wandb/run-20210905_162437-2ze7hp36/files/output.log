
Loaded trained dqn in lunarlander
I0905 16:24:42.623486 140202555004928 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:42.631575 140202555004928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:42.631709 140202555004928 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:42.631788 140202555004928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:42.631850 140202555004928 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:42.631904 140202555004928 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:42.631981 140202555004928 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:42.632070 140202555004928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:42.632128 140202555004928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:42.632196 140202555004928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:42.632272 140202555004928 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:42.632361 140202555004928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:42.632450 140202555004928 dqn_agent.py:283] 	 seed: 1630859082631539
I0905 16:24:42.634028 140202555004928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:42.634149 140202555004928 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:42.634221 140202555004928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:42.634306 140202555004928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:42.634365 140202555004928 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:42.634418 140202555004928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:42.634482 140202555004928 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:42.634573 140202555004928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:42.634648 140202555004928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:43.767249 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:44.084818 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:44.093334 140202555004928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:44.099614 140202555004928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:44.099751 140202555004928 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:44.099825 140202555004928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:44.099899 140202555004928 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:44.099963 140202555004928 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:44.100034 140202555004928 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:44.100110 140202555004928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:44.100195 140202555004928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:44.100253 140202555004928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:44.100331 140202555004928 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:44.100436 140202555004928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:44.100509 140202555004928 dqn_agent.py:283] 	 seed: 1630859084099579
I0905 16:24:44.101990 140202555004928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:44.102112 140202555004928 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:44.102183 140202555004928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:44.102248 140202555004928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:44.102307 140202555004928 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:44.102382 140202555004928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:44.102466 140202555004928 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:44.102524 140202555004928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:44.102587 140202555004928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:44.121676 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Training fixed agent 3, please be patient, may be a while...
I0905 16:24:44.146026 140202555004928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:44.146200 140202555004928 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 282.73
I0905 16:24:47.683282 140202555004928 replay_runner.py:36] Average training steps per second: 282.73
Steps executed: 344 Episode length: 260 Return: -52.622943854510495
I0905 16:24:48.426779 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.04
INFO:tensorflow:Starting iteration 1

Steps executed: 230 Episode length: 107 Return: -283.20140057879685
INFO:tensorflow:Average training steps per second: 435.38
I0905 16:24:53.805940 140202555004928 replay_runner.py:36] Average training steps per second: 435.38
I0905 16:24:53.898268 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.99
INFO:tensorflow:Starting iteration 2

Steps executed: 282 Episode length: 122 Return: -475.86829981350495
INFO:tensorflow:Average training steps per second: 354.87
I0905 16:24:59.823549 140202555004928 replay_runner.py:36] Average training steps per second: 354.87
I0905 16:24:59.977722 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.99
INFO:tensorflow:Starting iteration 3

Steps executed: 272 Episode length: 153 Return: -302.65518476804743
INFO:tensorflow:Average training steps per second: 333.12
I0905 16:25:06.421712 140202555004928 replay_runner.py:36] Average training steps per second: 333.12
I0905 16:25:06.537029 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.72
INFO:tensorflow:Starting iteration 4
I0905 16:25:09.775848 140202555004928 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 407.85

Steps executed: 250 Episode length: 55 Return: -406.540462580627933
I0905 16:25:12.325605 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.47
INFO:tensorflow:Starting iteration 5

Steps executed: 301 Episode length: 130 Return: -290.29034095705987
INFO:tensorflow:Average training steps per second: 414.16
I0905 16:25:17.867789 140202555004928 replay_runner.py:36] Average training steps per second: 414.16
I0905 16:25:17.990326 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.68
INFO:tensorflow:Starting iteration 6

Steps executed: 279 Episode length: 82 Return: -279.437159576862173
INFO:tensorflow:Average training steps per second: 416.51
I0905 16:25:23.529238 140202555004928 replay_runner.py:36] Average training steps per second: 416.51
I0905 16:25:23.637341 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.50
INFO:tensorflow:Starting iteration 7

Steps executed: 403 Episode length: 256 Return: -723.17884956429553
INFO:tensorflow:Average training steps per second: 403.83
I0905 16:25:29.238235 140202555004928 replay_runner.py:36] Average training steps per second: 403.83
I0905 16:25:29.478738 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.61
INFO:tensorflow:Starting iteration 8

Steps executed: 470 Episode length: 470 Return: -3119.2087473887455
INFO:tensorflow:Average training steps per second: 409.59
I0905 16:25:35.043865 140202555004928 replay_runner.py:36] Average training steps per second: 409.59
I0905 16:25:35.571254 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -3119.21
INFO:tensorflow:Starting iteration 9

Steps executed: 338 Episode length: 159 Return: -627.73090542529135
INFO:tensorflow:Average training steps per second: 403.94
I0905 16:25:41.227814 140202555004928 replay_runner.py:36] Average training steps per second: 403.94
I0905 16:25:41.419120 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -742.84
INFO:tensorflow:Starting iteration 10

Steps executed: 203 Episode length: 85 Return: -82.8566783360335595
INFO:tensorflow:Average training steps per second: 399.39
I0905 16:25:47.053193 140202555004928 replay_runner.py:36] Average training steps per second: 399.39
I0905 16:25:47.125379 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.11
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: -913.08983456859295
INFO:tensorflow:Average training steps per second: 408.45
I0905 16:25:52.710477 140202555004928 replay_runner.py:36] Average training steps per second: 408.45
I0905 16:25:52.840854 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -913.09
INFO:tensorflow:Starting iteration 12

Steps executed: 112 Episode length: 112 Return: -125.71203496064479
INFO:tensorflow:Average training steps per second: 405.78
I0905 16:25:58.406291 140202555004928 replay_runner.py:36] Average training steps per second: 405.78

Steps executed: 239 Episode length: 127 Return: -848.27505869242369
INFO:tensorflow:Starting iteration 13

Steps executed: 306 Episode length: 113 Return: -293.57086371343396
INFO:tensorflow:Average training steps per second: 401.99
I0905 16:26:04.209834 140202555004928 replay_runner.py:36] Average training steps per second: 401.99
I0905 16:26:04.331852 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.71
INFO:tensorflow:Starting iteration 14

Steps executed: 384 Episode length: 384 Return: 13.7192472314195026
INFO:tensorflow:Average training steps per second: 407.03
I0905 16:26:09.923816 140202555004928 replay_runner.py:36] Average training steps per second: 407.03
I0905 16:26:10.251223 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.72
INFO:tensorflow:Starting iteration 15

Steps executed: 400 Episode length: 294 Return: -112.42856214605584
INFO:tensorflow:Average training steps per second: 407.61
I0905 16:26:15.887035 140202555004928 replay_runner.py:36] Average training steps per second: 407.61
I0905 16:26:16.164774 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.01
INFO:tensorflow:Starting iteration 16

Steps executed: 218 Episode length: 110 Return: -472.49423522182406
INFO:tensorflow:Average training steps per second: 400.96
I0905 16:26:21.813400 140202555004928 replay_runner.py:36] Average training steps per second: 400.96
I0905 16:26:21.908473 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.46
INFO:tensorflow:Starting iteration 17

Steps executed: 305 Episode length: 139 Return: -169.11832888647616
INFO:tensorflow:Average training steps per second: 412.51
I0905 16:26:27.499677 140202555004928 replay_runner.py:36] Average training steps per second: 412.51
I0905 16:26:27.646594 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.31
INFO:tensorflow:Starting iteration 18

Steps executed: 223 Episode length: 85 Return: -214.068731293690646
INFO:tensorflow:Average training steps per second: 409.09
I0905 16:26:33.253941 140202555004928 replay_runner.py:36] Average training steps per second: 409.09
I0905 16:26:33.351388 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.72
INFO:tensorflow:Starting iteration 19

Steps executed: 364 Episode length: 187 Return: -80.347018650905116
INFO:tensorflow:Average training steps per second: 403.15
I0905 16:26:39.034305 140202555004928 replay_runner.py:36] Average training steps per second: 403.15
I0905 16:26:39.204536 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.97
INFO:tensorflow:Starting iteration 20
I0905 16:26:42.347102 140202555004928 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 400.64

Steps executed: 440 Episode length: 440 Return: -82.931844606215156
I0905 16:26:45.300221 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.93
INFO:tensorflow:Starting iteration 21

Steps executed: 459 Episode length: 459 Return: -107.51170064314681
INFO:tensorflow:Average training steps per second: 362.03
I0905 16:26:51.376769 140202555004928 replay_runner.py:36] Average training steps per second: 362.03
I0905 16:26:51.913151 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.51
INFO:tensorflow:Starting iteration 22

Steps executed: 219 Episode length: 61 Return: -108.596042499218531
INFO:tensorflow:Average training steps per second: 319.91
I0905 16:26:58.547509 140202555004928 replay_runner.py:36] Average training steps per second: 319.91
I0905 16:26:58.655885 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.03
INFO:tensorflow:Starting iteration 23

Steps executed: 343 Episode length: 192 Return: -302.26051533567454
INFO:tensorflow:Average training steps per second: 323.62
I0905 16:27:05.223887 140202555004928 replay_runner.py:36] Average training steps per second: 323.62
I0905 16:27:05.461191 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.29
INFO:tensorflow:Starting iteration 24

Steps executed: 77 Episode length: 77 Return: -310.4389340141372654
INFO:tensorflow:Average training steps per second: 318.44

Steps executed: 736 Episode length: 659 Return: -64.891711691752824
I0905 16:27:13.303020 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.67
INFO:tensorflow:Starting iteration 25

Steps executed: 329 Episode length: 329 Return: -7.3898661727320724
INFO:tensorflow:Average training steps per second: 312.59
I0905 16:27:20.223787 140202555004928 replay_runner.py:36] Average training steps per second: 312.59
I0905 16:27:20.584040 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -7.39
INFO:tensorflow:Starting iteration 26

Steps executed: 296 Episode length: 186 Return: -336.00249188627004
INFO:tensorflow:Average training steps per second: 317.11
I0905 16:27:27.425917 140202555004928 replay_runner.py:36] Average training steps per second: 317.11
I0905 16:27:27.627811 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -527.83
INFO:tensorflow:Starting iteration 27
I0905 16:27:31.303401 140202555004928 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 311.97

Steps executed: 340 Episode length: 340 Return: -325.06688779906974
I0905 16:27:34.865261 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.07
INFO:tensorflow:Starting iteration 28

Steps executed: 300 Episode length: 224 Return: -319.80561313031264
INFO:tensorflow:Average training steps per second: 310.72
I0905 16:27:41.797611 140202555004928 replay_runner.py:36] Average training steps per second: 310.72
I0905 16:27:42.036801 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.52
INFO:tensorflow:Starting iteration 29

Steps executed: 477 Episode length: 326 Return: -239.05167830822776
INFO:tensorflow:Average training steps per second: 314.20
I0905 16:27:48.910426 140202555004928 replay_runner.py:36] Average training steps per second: 314.20

Done fixed training!Episode length: 326 Return: -239.05167830822776