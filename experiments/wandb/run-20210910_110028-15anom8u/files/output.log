I0910 11:00:34.376823 140186230077440 run_experiment.py:549] Creating TrainRunner ...
I0910 11:00:34.386934 140186230077440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:34.387120 140186230077440 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:34.387235 140186230077440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:34.387337 140186230077440 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:34.387468 140186230077440 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:34.387574 140186230077440 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:34.387670 140186230077440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:34.387767 140186230077440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:34.387966 140186230077440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:34.388073 140186230077440 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:34.388175 140186230077440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:34.388269 140186230077440 dqn_agent.py:283] 	 seed: 1631271634386875
I0910 11:00:34.391009 140186230077440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:34.391172 140186230077440 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:34.391302 140186230077440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:34.391413 140186230077440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:34.391516 140186230077440 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:34.391613 140186230077440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:34.391733 140186230077440 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:34.391875 140186230077440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:34.391984 140186230077440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:34.429611 140186230077440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:34.462645 140186230077440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:00:34.462860 140186230077440 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:00:34.463033 140186230077440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:00:34.463163 140186230077440 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:00:34.463275 140186230077440 dqn_agent.py:275] 	 update_period: 4
I0910 11:00:34.463462 140186230077440 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:00:34.463647 140186230077440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:00:34.463772 140186230077440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:00:34.463886 140186230077440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:00:34.464050 140186230077440 dqn_agent.py:280] 	 optimizer: adam
I0910 11:00:34.464209 140186230077440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:00:34.464349 140186230077440 dqn_agent.py:283] 	 seed: 1631271634462594
I0910 11:00:34.467053 140186230077440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:00:34.467227 140186230077440 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:00:34.467349 140186230077440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:00:34.467466 140186230077440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:00:34.467604 140186230077440 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:00:34.467780 140186230077440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:00:34.467949 140186230077440 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:00:34.468066 140186230077440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:00:34.468172 140186230077440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:00:34.503632 140186230077440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:00:34.528762 140186230077440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:00:34.529019 140186230077440 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 348161.70
I0910 11:00:34.532116 140186230077440 replay_runner.py:39] Average training steps per second: 348161.70
I0910 11:00:35.371169 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 1
I0910 11:00:35.448750 140186230077440 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 796185.27
I0910 11:00:35.450235 140186230077440 replay_runner.py:39] Average training steps per second: 796185.27
I0910 11:00:35.523843 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 2
I0910 11:00:35.597282 140186230077440 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 773999.63
I0910 11:00:35.598818 140186230077440 replay_runner.py:39] Average training steps per second: 773999.63
I0910 11:00:35.670038 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 3
I0910 11:00:35.743456 140186230077440 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 765383.94
I0910 11:00:35.744983 140186230077440 replay_runner.py:39] Average training steps per second: 765383.94
I0910 11:00:35.829354 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
Steps executed: 257 Episode length: 130 Return: -130.0
INFO:tensorflow:Starting iteration 4
I0910 11:00:35.907765 140186230077440 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 724780.37
I0910 11:00:35.909545 140186230077440 replay_runner.py:39] Average training steps per second: 724780.37
I0910 11:00:35.994136 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 5
I0910 11:00:36.073134 140186230077440 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 703034.53
I0910 11:00:36.074807 140186230077440 replay_runner.py:39] Average training steps per second: 703034.53
I0910 11:00:36.259639 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:00:36.335832 140186230077440 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 772147.28
I0910 11:00:36.337363 140186230077440 replay_runner.py:39] Average training steps per second: 772147.28
I0910 11:00:36.465343 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 7
I0910 11:00:36.543233 140186230077440 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 716607.55
I0910 11:00:36.544907 140186230077440 replay_runner.py:39] Average training steps per second: 716607.55
I0910 11:00:36.634194 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 8
I0910 11:00:36.717263 140186230077440 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 747381.33
I0910 11:00:36.718837 140186230077440 replay_runner.py:39] Average training steps per second: 747381.33
I0910 11:00:36.994071 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.50
INFO:tensorflow:Starting iteration 9
I0910 11:00:37.068000 140186230077440 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 793774.41
I0910 11:00:37.069483 140186230077440 replay_runner.py:39] Average training steps per second: 793774.41
I0910 11:00:37.158108 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 10
I0910 11:00:37.341816 140186230077440 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 802276.97
I0910 11:00:37.343296 140186230077440 replay_runner.py:39] Average training steps per second: 802276.97
I0910 11:00:37.435627 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 11
I0910 11:00:37.513593 140186230077440 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 805976.94
I0910 11:00:37.515084 140186230077440 replay_runner.py:39] Average training steps per second: 805976.94
I0910 11:00:37.601054 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.00
INFO:tensorflow:Starting iteration 12
I0910 11:00:37.683187 140186230077440 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 781062.20
I0910 11:00:37.684705 140186230077440 replay_runner.py:39] Average training steps per second: 781062.20
I0910 11:00:37.775787 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 13
I0910 11:00:37.855040 140186230077440 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 767344.31


Steps executed: 257 Episode length: 129 Return: -129.0
I0910 11:00:37.957257 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 14
I0910 11:00:38.051448 140186230077440 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 711743.42
I0910 11:00:38.053126 140186230077440 replay_runner.py:39] Average training steps per second: 711743.42
I0910 11:00:38.137608 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 15
I0910 11:00:38.213252 140186230077440 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 735713.73
I0910 11:00:38.214867 140186230077440 replay_runner.py:39] Average training steps per second: 735713.73
I0910 11:00:38.304030 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 16
I0910 11:00:38.381141 140186230077440 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 790632.23
I0910 11:00:38.382648 140186230077440 replay_runner.py:39] Average training steps per second: 790632.23
I0910 11:00:38.508913 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 17
I0910 11:00:38.597713 140186230077440 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 773571.38
I0910 11:00:38.599223 140186230077440 replay_runner.py:39] Average training steps per second: 773571.38
I0910 11:00:38.674324 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 18
I0910 11:00:38.767336 140186230077440 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 579563.91
I0910 11:00:38.769457 140186230077440 replay_runner.py:39] Average training steps per second: 579563.91
I0910 11:00:38.864588 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 19
I0910 11:00:38.948496 140186230077440 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 585142.86
I0910 11:00:38.950494 140186230077440 replay_runner.py:39] Average training steps per second: 585142.86
I0910 11:00:39.040146 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 20
I0910 11:00:39.117697 140186230077440 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 793774.41
I0910 11:00:39.119179 140186230077440 replay_runner.py:39] Average training steps per second: 793774.41
I0910 11:00:39.194509 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 21
I0910 11:00:39.269231 140186230077440 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 783250.05
I0910 11:00:39.270839 140186230077440 replay_runner.py:39] Average training steps per second: 783250.05
I0910 11:00:39.368750 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.00
INFO:tensorflow:Starting iteration 22
I0910 11:00:39.448738 140186230077440 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 788551.23
I0910 11:00:39.450230 140186230077440 replay_runner.py:39] Average training steps per second: 788551.23
I0910 11:00:39.524464 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 23
I0910 11:00:39.598490 140186230077440 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 801051.18
I0910 11:00:39.599949 140186230077440 replay_runner.py:39] Average training steps per second: 801051.18
I0910 11:00:39.676938 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 24
I0910 11:00:39.752970 140186230077440 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 784715.43
I0910 11:00:39.754467 140186230077440 replay_runner.py:39] Average training steps per second: 784715.43

Done fixed training!Episode length: 119 Return: -119.0
INFO:tensorflow:Starting iteration 25
I0910 11:00:40.014427 140186230077440 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 775000.74
I0910 11:00:40.015948 140186230077440 replay_runner.py:39] Average training steps per second: 775000.74
I0910 11:00:40.090909 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 26
I0910 11:00:40.166834 140186230077440 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 769597.06
I0910 11:00:40.168361 140186230077440 replay_runner.py:39] Average training steps per second: 769597.06
I0910 11:00:40.349316 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:00:40.424267 140186230077440 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 771011.76
I0910 11:00:40.425848 140186230077440 replay_runner.py:39] Average training steps per second: 771011.76
I0910 11:00:40.524580 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 28
I0910 11:00:40.599094 140186230077440 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 766783.18
I0910 11:00:40.600649 140186230077440 replay_runner.py:39] Average training steps per second: 766783.18
I0910 11:00:40.682686 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 29
I0910 11:00:40.757002 140186230077440 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 807062.54
I0910 11:00:40.758457 140186230077440 replay_runner.py:39] Average training steps per second: 807062.54
I0910 11:00:40.835824 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00