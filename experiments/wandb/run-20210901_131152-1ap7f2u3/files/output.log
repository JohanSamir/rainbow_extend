I0901 13:11:58.455046 140298343233536 run_experiment.py:549] Creating TrainRunner ...
I0901 13:11:58.462891 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:11:58.463027 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:11:58.463103 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:11:58.463161 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:11:58.463226 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:11:58.463282 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:11:58.463336 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:11:58.463433 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:11:58.463536 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:11:58.463620 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:11:58.463691 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:11:58.463767 140298343233536 dqn_agent.py:283] 	 seed: 1630501918462859
I0901 13:11:58.465479 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:11:58.465594 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:11:58.465673 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:11:58.465737 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:11:58.465796 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:11:58.465870 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:11:58.465933 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:11:58.465985 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:11:58.466076 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:11:58.569330 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:58.823754 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:58.832154 140298343233536 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:11:58.837817 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:11:58.837943 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:11:58.838055 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:11:58.838170 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:11:58.838323 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:11:58.838406 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:11:58.838496 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:11:58.838583 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:11:58.838672 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:11:58.838753 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:11:58.838835 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:11:58.838917 140298343233536 dqn_agent.py:283] 	 seed: 1630501918837793
I0901 13:11:58.840713 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:11:58.840827 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:11:58.840940 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:11:58.841026 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:11:58.841106 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:11:58.841189 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:11:58.841272 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:11:58.841353 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:11:58.841475 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:11:58.863015 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:11:58.879110 140298343233536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:11:58.879282 140298343233536 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 248.19
I0901 13:12:02.908627 140298343233536 replay_runner.py:36] Average training steps per second: 248.19
I0901 13:12:03.690611 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.36
Steps executed: 209 Episode length: 209 Return: -53.3600039972492
INFO:tensorflow:Starting iteration 1

Steps executed: 134 Episode length: 134 Return: -133.5106057473342
INFO:tensorflow:Average training steps per second: 342.25

Steps executed: 262 Episode length: 128 Return: -346.36339760109956
I0901 13:12:10.115697 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.94
INFO:tensorflow:Starting iteration 2

Steps executed: 247 Episode length: 139 Return: -256.72661670612896
INFO:tensorflow:Average training steps per second: 338.31
I0901 13:12:16.201808 140298343233536 replay_runner.py:36] Average training steps per second: 338.31
I0901 13:12:16.355716 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.51
INFO:tensorflow:Starting iteration 3

Steps executed: 316 Episode length: 195 Return: -95.810978864843536
INFO:tensorflow:Average training steps per second: 327.02
I0901 13:12:22.760468 140298343233536 replay_runner.py:36] Average training steps per second: 327.02
I0901 13:12:22.937066 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.76
INFO:tensorflow:Starting iteration 4

Steps executed: 260 Episode length: 84 Return: -391.397661793195556
INFO:tensorflow:Average training steps per second: 317.09
I0901 13:12:29.408013 140298343233536 replay_runner.py:36] Average training steps per second: 317.09
I0901 13:12:29.538045 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.76
INFO:tensorflow:Starting iteration 5

Steps executed: 256 Episode length: 95 Return: -149.855960903012718
INFO:tensorflow:Average training steps per second: 321.58
I0901 13:12:35.853610 140298343233536 replay_runner.py:36] Average training steps per second: 321.58
I0901 13:12:35.983904 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.76
INFO:tensorflow:Starting iteration 6

Steps executed: 241 Episode length: 125 Return: -280.60586071820438
INFO:tensorflow:Average training steps per second: 313.89
I0901 13:12:42.354109 140298343233536 replay_runner.py:36] Average training steps per second: 313.89
I0901 13:12:42.486760 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.66
INFO:tensorflow:Starting iteration 7

Steps executed: 226 Episode length: 123 Return: -275.86669177388455
INFO:tensorflow:Average training steps per second: 315.57
I0901 13:12:48.865873 140298343233536 replay_runner.py:36] Average training steps per second: 315.57
I0901 13:12:49.003503 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.62
INFO:tensorflow:Starting iteration 8

Steps executed: 258 Episode length: 136 Return: -242.07179084232064
INFO:tensorflow:Average training steps per second: 315.54
I0901 13:12:55.481526 140298343233536 replay_runner.py:36] Average training steps per second: 315.54
I0901 13:12:55.636079 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.41
INFO:tensorflow:Starting iteration 9

Steps executed: 286 Episode length: 104 Return: -190.69364994004263
INFO:tensorflow:Average training steps per second: 313.16
I0901 13:13:02.153680 140298343233536 replay_runner.py:36] Average training steps per second: 313.16
I0901 13:13:02.316533 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.79
INFO:tensorflow:Starting iteration 10

Steps executed: 260 Episode length: 80 Return: -431.592412343267373
INFO:tensorflow:Average training steps per second: 316.17
I0901 13:13:08.799413 140298343233536 replay_runner.py:36] Average training steps per second: 316.17
I0901 13:13:08.929731 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.73
INFO:tensorflow:Starting iteration 11

Steps executed: 247 Episode length: 86 Return: -321.287940388554863
INFO:tensorflow:Average training steps per second: 315.62
I0901 13:13:15.447165 140298343233536 replay_runner.py:36] Average training steps per second: 315.62
I0901 13:13:15.616702 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.62
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 119 Return: -459.85199734519763
INFO:tensorflow:Average training steps per second: 319.88
I0901 13:13:22.123155 140298343233536 replay_runner.py:36] Average training steps per second: 319.88
I0901 13:13:22.243557 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.50
INFO:tensorflow:Starting iteration 13

Steps executed: 325 Episode length: 143 Return: -298.78337208640723
INFO:tensorflow:Average training steps per second: 315.99
I0901 13:13:28.785942 140298343233536 replay_runner.py:36] Average training steps per second: 315.99
I0901 13:13:28.985448 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.63
INFO:tensorflow:Starting iteration 14

Steps executed: 251 Episode length: 151 Return: -412.20627387419216
INFO:tensorflow:Average training steps per second: 315.77
I0901 13:13:35.457758 140298343233536 replay_runner.py:36] Average training steps per second: 315.77
I0901 13:13:35.603814 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.35
INFO:tensorflow:Starting iteration 15

Steps executed: 282 Episode length: 92 Return: -287.457302983971786
INFO:tensorflow:Average training steps per second: 310.85
I0901 13:13:42.111222 140298343233536 replay_runner.py:36] Average training steps per second: 310.85
I0901 13:13:42.262829 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.20
INFO:tensorflow:Starting iteration 16

Steps executed: 656 Episode length: 509 Return: 165.796664776987486
INFO:tensorflow:Average training steps per second: 299.86
I0901 13:13:48.897870 140298343233536 replay_runner.py:36] Average training steps per second: 299.86
I0901 13:13:49.662696 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.90
INFO:tensorflow:Starting iteration 17

Steps executed: 206 Episode length: 109 Return: -500.30159171709486
INFO:tensorflow:Average training steps per second: 322.47
I0901 13:13:56.135401 140298343233536 replay_runner.py:36] Average training steps per second: 322.47
I0901 13:13:56.237226 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.70
INFO:tensorflow:Starting iteration 18

Steps executed: 232 Episode length: 232 Return: -201.42439319031166
INFO:tensorflow:Average training steps per second: 314.16
I0901 13:14:02.764587 140298343233536 replay_runner.py:36] Average training steps per second: 314.16
I0901 13:14:02.927395 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.42
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 239 Return: -136.99482884690713
INFO:tensorflow:Average training steps per second: 327.25
I0901 13:14:09.413113 140298343233536 replay_runner.py:36] Average training steps per second: 327.25
I0901 13:14:09.594451 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.99
INFO:tensorflow:Starting iteration 20

Steps executed: 217 Episode length: 111 Return: -360.80317944992825
INFO:tensorflow:Average training steps per second: 328.86
I0901 13:14:16.050122 140298343233536 replay_runner.py:36] Average training steps per second: 328.86
I0901 13:14:16.194153 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.73
INFO:tensorflow:Starting iteration 21

Steps executed: 312 Episode length: 128 Return: -474.77122563950025
INFO:tensorflow:Average training steps per second: 333.77
I0901 13:14:22.615712 140298343233536 replay_runner.py:36] Average training steps per second: 333.77
I0901 13:14:22.800853 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.68
INFO:tensorflow:Starting iteration 22

Steps executed: 254 Episode length: 84 Return: -671.241925345238235
INFO:tensorflow:Average training steps per second: 338.65
I0901 13:14:29.256333 140298343233536 replay_runner.py:36] Average training steps per second: 338.65
I0901 13:14:29.397820 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -513.86
INFO:tensorflow:Starting iteration 23

Steps executed: 234 Episode length: 90 Return: -345.050408405157235
INFO:tensorflow:Average training steps per second: 336.01
I0901 13:14:35.874636 140298343233536 replay_runner.py:36] Average training steps per second: 336.01
I0901 13:14:36.000426 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.80
INFO:tensorflow:Starting iteration 24

Steps executed: 100 Episode length: 100 Return: -901.74537090547965
INFO:tensorflow:Average training steps per second: 325.51

Steps executed: 203 Episode length: 51 Return: -254.407410487499655
I0901 13:14:42.643407 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.62
INFO:tensorflow:Starting iteration 25

Steps executed: 296 Episode length: 192 Return: -405.58857227948655
INFO:tensorflow:Average training steps per second: 333.47
I0901 13:14:49.090992 140298343233536 replay_runner.py:36] Average training steps per second: 333.47
I0901 13:14:49.257788 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.95
INFO:tensorflow:Starting iteration 26

Steps executed: 290 Episode length: 122 Return: -363.59636602812606
INFO:tensorflow:Average training steps per second: 330.30
I0901 13:14:55.729541 140298343233536 replay_runner.py:36] Average training steps per second: 330.30
I0901 13:14:55.886787 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.32
INFO:tensorflow:Starting iteration 27

Steps executed: 210 Episode length: 56 Return: -414.423521445716236
INFO:tensorflow:Average training steps per second: 352.35
I0901 13:15:02.157716 140298343233536 replay_runner.py:36] Average training steps per second: 352.35
I0901 13:15:02.288952 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -495.26
INFO:tensorflow:Starting iteration 28

Steps executed: 238 Episode length: 148 Return: -981.52762690653236
INFO:tensorflow:Average training steps per second: 334.71
I0901 13:15:08.797760 140298343233536 replay_runner.py:36] Average training steps per second: 334.71
I0901 13:15:08.943025 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.33
INFO:tensorflow:Starting iteration 29

Steps executed: 252 Episode length: 59 Return: -402.265259291362666
INFO:tensorflow:Average training steps per second: 347.46
I0901 13:15:15.238061 140298343233536 replay_runner.py:36] Average training steps per second: 347.46

Done fixed training!Episode length: 59 Return: -402.265259291362666