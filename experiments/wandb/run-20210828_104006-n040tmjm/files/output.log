Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0828 10:40:13.057706 140432173811712 run_experiment.py:549] Creating TrainRunner ...
I0828 10:40:13.080487 140432173811712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:40:13.080754 140432173811712 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:40:13.080951 140432173811712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:40:13.081115 140432173811712 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:40:13.081267 140432173811712 dqn_agent.py:275] 	 update_period: 4
I0828 10:40:13.081404 140432173811712 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:40:13.081544 140432173811712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:40:13.081687 140432173811712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:40:13.081821 140432173811712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:40:13.081959 140432173811712 dqn_agent.py:280] 	 optimizer: adam
I0828 10:40:13.082102 140432173811712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:40:13.082264 140432173811712 dqn_agent.py:283] 	 seed: 1630147213080420
I0828 10:40:13.085347 140432173811712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:40:13.085634 140432173811712 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:40:13.085879 140432173811712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:40:13.086125 140432173811712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:40:13.086347 140432173811712 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:40:13.086567 140432173811712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:40:13.087134 140432173811712 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:40:13.087416 140432173811712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:40:13.087641 140432173811712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:40:13.122965 140432173811712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:40:13.586626 140432173811712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:40:13.603134 140432173811712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:40:13.613454 140432173811712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:40:13.613797 140432173811712 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:40:13.614002 140432173811712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:40:13.614140 140432173811712 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:40:13.614254 140432173811712 dqn_agent.py:275] 	 update_period: 4
I0828 10:40:13.614356 140432173811712 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:40:13.614454 140432173811712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:40:13.614569 140432173811712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:40:13.614669 140432173811712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:40:13.614799 140432173811712 dqn_agent.py:280] 	 optimizer: adam
I0828 10:40:13.614908 140432173811712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:40:13.615002 140432173811712 dqn_agent.py:283] 	 seed: 1630147213613385
I0828 10:40:13.617772 140432173811712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:40:13.617938 140432173811712 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:40:13.618061 140432173811712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:40:13.618206 140432173811712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:40:13.618350 140432173811712 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:40:13.618605 140432173811712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:40:13.618721 140432173811712 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:40:13.618825 140432173811712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:40:13.618931 140432173811712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:40:13.653288 140432173811712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:40:13.677508 140432173811712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:40:13.677834 140432173811712 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.65
I0828 10:40:20.543951 140432173811712 replay_runner.py:36] Average training steps per second: 145.65
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:40:22.040166 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 307 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 206.54
I0828 10:40:27.115471 140432173811712 replay_runner.py:36] Average training steps per second: 206.54
I0828 10:40:27.354689 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 2
I0828 10:40:27.602261 140432173811712 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 203.67

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:40:32.918654 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0828 10:40:33.156735 140432173811712 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.49
I0828 10:40:38.246547 140432173811712 replay_runner.py:36] Average training steps per second: 196.49
I0828 10:40:38.684433 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0828 10:40:38.931587 140432173811712 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 195.74
I0828 10:40:44.041111 140432173811712 replay_runner.py:36] Average training steps per second: 195.74
I0828 10:40:44.452984 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0828 10:40:44.696080 140432173811712 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.35
I0828 10:40:49.977699 140432173811712 replay_runner.py:36] Average training steps per second: 189.35
I0828 10:40:50.410847 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 229 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 197.95
I0828 10:40:55.700889 140432173811712 replay_runner.py:36] Average training steps per second: 197.95
I0828 10:40:55.900262 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 7

Steps executed: 245 Episode length: 245 Return: -244.0
INFO:tensorflow:Average training steps per second: 197.08
I0828 10:41:01.222786 140432173811712 replay_runner.py:36] Average training steps per second: 197.08
I0828 10:41:01.422991 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.00
INFO:tensorflow:Starting iteration 8

Steps executed: 353 Episode length: 192 Return: -191.0
INFO:tensorflow:Average training steps per second: 194.74
I0828 10:41:06.779968 140432173811712 replay_runner.py:36] Average training steps per second: 194.74
I0828 10:41:07.092475 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.50
INFO:tensorflow:Starting iteration 9

Steps executed: 255 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 197.06
I0828 10:41:12.442374 140432173811712 replay_runner.py:36] Average training steps per second: 197.06
I0828 10:41:12.658134 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 10

Steps executed: 237 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 192.80
I0828 10:41:18.088974 140432173811712 replay_runner.py:36] Average training steps per second: 192.80
I0828 10:41:18.295257 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 11

Steps executed: 390 Episode length: 196 Return: -195.0
INFO:tensorflow:Average training steps per second: 195.28
I0828 10:41:23.646728 140432173811712 replay_runner.py:36] Average training steps per second: 195.28
I0828 10:41:23.969481 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.00
INFO:tensorflow:Starting iteration 12
I0828 10:41:24.209582 140432173811712 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.41

Steps executed: 288 Episode length: 148 Return: -147.0
I0828 10:41:29.563076 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.00
INFO:tensorflow:Starting iteration 13
I0828 10:41:29.800779 140432173811712 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 192.87
I0828 10:41:34.986074 140432173811712 replay_runner.py:36] Average training steps per second: 192.87

Steps executed: 260 Episode length: 124 Return: -123.0
INFO:tensorflow:Starting iteration 14

Steps executed: 218 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 196.70
I0828 10:41:40.635155 140432173811712 replay_runner.py:36] Average training steps per second: 196.70
I0828 10:41:40.821737 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 15

Steps executed: 233 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 196.78
I0828 10:41:46.152451 140432173811712 replay_runner.py:36] Average training steps per second: 196.78
I0828 10:41:46.343547 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 16

Steps executed: 294 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 198.85
I0828 10:41:51.609990 140432173811712 replay_runner.py:36] Average training steps per second: 198.85
I0828 10:41:51.838787 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 17
I0828 10:41:52.081992 140432173811712 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 203.79

Steps executed: 279 Episode length: 198 Return: -197.0
I0828 10:41:57.218643 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 18

Steps executed: 329 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 198.96
I0828 10:42:02.481484 140432173811712 replay_runner.py:36] Average training steps per second: 198.96
I0828 10:42:02.761017 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.67
INFO:tensorflow:Starting iteration 19

Steps executed: 299 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 199.22
I0828 10:42:08.023697 140432173811712 replay_runner.py:36] Average training steps per second: 199.22
I0828 10:42:08.259524 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 20

Steps executed: 289 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 203.48
I0828 10:42:13.413662 140432173811712 replay_runner.py:36] Average training steps per second: 203.48
I0828 10:42:13.639219 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.50
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 201.40
I0828 10:42:18.832174 140432173811712 replay_runner.py:36] Average training steps per second: 201.40
I0828 10:42:19.020140 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 22

Steps executed: 208 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 215.45
I0828 10:42:23.962997 140432173811712 replay_runner.py:36] Average training steps per second: 215.45
I0828 10:42:24.125460 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 23

Steps executed: 109 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 204.95

Steps executed: 278 Episode length: 90 Return: -89.0.0
I0828 10:42:29.465895 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 24

Steps executed: 211 Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 209.10
I0828 10:42:34.491683 140432173811712 replay_runner.py:36] Average training steps per second: 209.10
I0828 10:42:34.663093 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 199.57
I0828 10:42:39.912943 140432173811712 replay_runner.py:36] Average training steps per second: 199.57
I0828 10:42:40.099441 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 26

Steps executed: 287 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 209.91
I0828 10:42:45.098052 140432173811712 replay_runner.py:36] Average training steps per second: 209.91
I0828 10:42:45.337775 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 27

Steps executed: 224 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 201.15
I0828 10:42:50.557487 140432173811712 replay_runner.py:36] Average training steps per second: 201.15
I0828 10:42:50.732545 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 28

Steps executed: 208 Episode length: 208 Return: -207.0
INFO:tensorflow:Average training steps per second: 204.91
I0828 10:42:55.851548 140432173811712 replay_runner.py:36] Average training steps per second: 204.91
I0828 10:42:56.027825 140432173811712 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.00
INFO:tensorflow:Starting iteration 29
I0828 10:42:56.268133 140432173811712 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 200.55
I0828 10:43:01.254876 140432173811712 replay_runner.py:36] Average training steps per second: 200.55

Done fixed training!Episode length: 358 Return: -357.0