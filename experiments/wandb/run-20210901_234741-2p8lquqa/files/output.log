Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0901 23:47:47.972623 139848022624256 run_experiment.py:549] Creating TrainRunner ...
I0901 23:47:47.983009 139848022624256 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:47:47.983276 139848022624256 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:47:47.983453 139848022624256 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:47:47.983635 139848022624256 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:47:47.983756 139848022624256 dqn_agent.py:275] 	 update_period: 4
I0901 23:47:47.983876 139848022624256 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:47:47.984009 139848022624256 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:47:47.984257 139848022624256 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:47:47.984382 139848022624256 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:47:47.984451 139848022624256 dqn_agent.py:280] 	 optimizer: adam
I0901 23:47:47.984511 139848022624256 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:47:47.984566 139848022624256 dqn_agent.py:283] 	 seed: 1630540067982947
I0901 23:47:47.988051 139848022624256 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:47:47.988320 139848022624256 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:47:47.988549 139848022624256 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:47:47.988752 139848022624256 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:47:47.988889 139848022624256 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:47:47.989024 139848022624256 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:47:47.989155 139848022624256 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:47:47.989346 139848022624256 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:47:47.989511 139848022624256 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:47:48.033388 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:48.485370 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:48.501975 139848022624256 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:47:48.512083 139848022624256 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:47:48.512369 139848022624256 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:47:48.512519 139848022624256 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:47:48.512639 139848022624256 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:47:48.512751 139848022624256 dqn_agent.py:275] 	 update_period: 4
I0901 23:47:48.512868 139848022624256 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:47:48.512977 139848022624256 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:47:48.513086 139848022624256 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:47:48.513195 139848022624256 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:47:48.513340 139848022624256 dqn_agent.py:280] 	 optimizer: adam
I0901 23:47:48.513541 139848022624256 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:47:48.513663 139848022624256 dqn_agent.py:283] 	 seed: 1630540068512019
I0901 23:47:48.516982 139848022624256 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:47:48.517198 139848022624256 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:47:48.517329 139848022624256 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:47:48.517491 139848022624256 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:47:48.517610 139848022624256 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:47:48.517720 139848022624256 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:47:48.517823 139848022624256 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:47:48.517945 139848022624256 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:47:48.518141 139848022624256 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:47:48.553163 139848022624256 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:48.577309 139848022624256 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:47:48.577588 139848022624256 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.64
I0901 23:47:55.539841 139848022624256 replay_runner.py:36] Average training steps per second: 143.64
Steps executed: 329 Episode length: 329 Return: -328.0
I0901 23:47:56.928400 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.00
INFO:tensorflow:Starting iteration 1

Steps executed: 433 Episode length: 433 Return: -432.0
INFO:tensorflow:Average training steps per second: 205.15
I0901 23:48:02.030199 139848022624256 replay_runner.py:36] Average training steps per second: 205.15
I0901 23:48:02.395558 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.15
I0901 23:48:07.929789 139848022624256 replay_runner.py:36] Average training steps per second: 189.15
I0901 23:48:08.330836 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:48:08.569252 139848022624256 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.23
I0901 23:48:13.564183 139848022624256 replay_runner.py:36] Average training steps per second: 200.23
I0901 23:48:13.984014 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 230 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 195.58
I0901 23:48:19.319182 139848022624256 replay_runner.py:36] Average training steps per second: 195.58
I0901 23:48:19.508761 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 5

Steps executed: 247 Episode length: 247 Return: -246.0
INFO:tensorflow:Average training steps per second: 193.86
I0901 23:48:24.907879 139848022624256 replay_runner.py:36] Average training steps per second: 193.86
I0901 23:48:25.116102 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.76
I0901 23:48:30.467538 139848022624256 replay_runner.py:36] Average training steps per second: 195.76
I0901 23:48:30.897966 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:48:31.142556 139848022624256 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.85
I0901 23:48:36.222904 139848022624256 replay_runner.py:36] Average training steps per second: 196.85
I0901 23:48:36.652406 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 275 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 196.30
I0901 23:48:41.989318 139848022624256 replay_runner.py:36] Average training steps per second: 196.30
I0901 23:48:42.217816 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 9
I0901 23:48:42.457886 139848022624256 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.31
I0901 23:48:47.552381 139848022624256 replay_runner.py:36] Average training steps per second: 196.31

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 10

Steps executed: 258 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 196.33
I0901 23:48:53.338881 139848022624256 replay_runner.py:36] Average training steps per second: 196.33
I0901 23:48:53.554944 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 11

Steps executed: 267 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 197.61
I0901 23:48:58.860891 139848022624256 replay_runner.py:36] Average training steps per second: 197.61
I0901 23:48:59.086188 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 197.67
I0901 23:49:04.392667 139848022624256 replay_runner.py:36] Average training steps per second: 197.67
I0901 23:49:04.590310 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 13

Steps executed: 259 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 201.22
I0901 23:49:09.812012 139848022624256 replay_runner.py:36] Average training steps per second: 201.22
I0901 23:49:10.029754 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 194.45
I0901 23:49:15.416416 139848022624256 replay_runner.py:36] Average training steps per second: 194.45
I0901 23:49:15.623069 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 15

Steps executed: 225 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 201.73
I0901 23:49:20.875813 139848022624256 replay_runner.py:36] Average training steps per second: 201.73
I0901 23:49:21.057492 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 16

Steps executed: 261 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 198.42
I0901 23:49:26.326854 139848022624256 replay_runner.py:36] Average training steps per second: 198.42
I0901 23:49:26.550460 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 17
I0901 23:49:26.765852 139848022624256 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.77
I0901 23:49:31.772033 139848022624256 replay_runner.py:36] Average training steps per second: 199.77

Steps executed: 251 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.75
I0901 23:49:37.300639 139848022624256 replay_runner.py:36] Average training steps per second: 196.75
I0901 23:49:37.734416 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 249 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 200.54
I0901 23:49:42.968175 139848022624256 replay_runner.py:36] Average training steps per second: 200.54
I0901 23:49:43.181807 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 20

Steps executed: 261 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 195.32
I0901 23:49:48.535250 139848022624256 replay_runner.py:36] Average training steps per second: 195.32
I0901 23:49:48.764753 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 21
I0901 23:49:49.016663 139848022624256 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 201.47
I0901 23:49:53.980781 139848022624256 replay_runner.py:36] Average training steps per second: 201.47

Steps executed: 204 Episode length: 113 Return: -112.0
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.02
I0901 23:49:59.400428 139848022624256 replay_runner.py:36] Average training steps per second: 199.02
I0901 23:49:59.795648 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 211 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 201.87
I0901 23:50:04.984678 139848022624256 replay_runner.py:36] Average training steps per second: 201.87
I0901 23:50:05.178564 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 24

Steps executed: 273 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 195.36
I0901 23:50:10.543484 139848022624256 replay_runner.py:36] Average training steps per second: 195.36
I0901 23:50:10.787484 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 25

Steps executed: 164 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 200.25
I0901 23:50:16.009917 139848022624256 replay_runner.py:36] Average training steps per second: 200.25

Steps executed: 268 Episode length: 104 Return: -103.0
INFO:tensorflow:Starting iteration 26

Steps executed: 226 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 202.29
I0901 23:50:21.583363 139848022624256 replay_runner.py:36] Average training steps per second: 202.29
I0901 23:50:21.777513 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33
INFO:tensorflow:Starting iteration 27

Steps executed: 302 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 197.93
I0901 23:50:27.065291 139848022624256 replay_runner.py:36] Average training steps per second: 197.93
I0901 23:50:27.321463 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 28

Steps executed: 268 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 205.79
I0901 23:50:32.418469 139848022624256 replay_runner.py:36] Average training steps per second: 205.79
I0901 23:50:32.627511 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 207.20
I0901 23:50:37.675126 139848022624256 replay_runner.py:36] Average training steps per second: 207.20
I0901 23:50:37.885439 139848022624256 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33