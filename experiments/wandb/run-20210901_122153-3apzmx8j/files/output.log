Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0901 12:22:00.322649 140162147342336 run_experiment.py:549] Creating TrainRunner ...
I0901 12:22:00.331482 140162147342336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:00.331799 140162147342336 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:00.331959 140162147342336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:00.332072 140162147342336 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:00.332190 140162147342336 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:00.332304 140162147342336 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:00.332524 140162147342336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:00.332663 140162147342336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:00.332800 140162147342336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:00.332929 140162147342336 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:00.333042 140162147342336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:00.333162 140162147342336 dqn_agent.py:283] 	 seed: 1630498920331411
I0901 12:22:00.336056 140162147342336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:00.336303 140162147342336 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:22:00.336435 140162147342336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:00.336531 140162147342336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:00.336650 140162147342336 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:00.336780 140162147342336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:00.336911 140162147342336 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:00.337075 140162147342336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:00.337253 140162147342336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:00.543091 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:01.451624 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:01.466619 140162147342336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:22:01.475150 140162147342336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:01.475403 140162147342336 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:01.475607 140162147342336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:01.475708 140162147342336 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:01.475786 140162147342336 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:01.475858 140162147342336 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:01.475934 140162147342336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:01.476057 140162147342336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:01.476275 140162147342336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:01.476367 140162147342336 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:01.476452 140162147342336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:01.476673 140162147342336 dqn_agent.py:283] 	 seed: 1630498921475071
I0901 12:22:01.479507 140162147342336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:01.479676 140162147342336 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:22:01.479777 140162147342336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:01.479952 140162147342336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:01.480057 140162147342336 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:01.480176 140162147342336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:01.480326 140162147342336 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:01.480468 140162147342336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:01.480691 140162147342336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:01.517224 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:01.543335 140162147342336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:22:01.543577 140162147342336 replay_runner.py:41] Starting iteration 0
Steps executed: 210 Episode length: 14 Return: 14.0
INFO:tensorflow:Average training steps per second: 146.81
I0901 12:22:08.355308 140162147342336 replay_runner.py:36] Average training steps per second: 146.81
I0901 12:22:09.515909 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.00
INFO:tensorflow:Starting iteration 1
I0901 12:22:09.691388 140162147342336 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 188.17
I0901 12:22:15.006002 140162147342336 replay_runner.py:36] Average training steps per second: 188.17
I0901 12:22:15.145419 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 2

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 190.70
I0901 12:22:20.569973 140162147342336 replay_runner.py:36] Average training steps per second: 190.70
I0901 12:22:20.737250 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 3

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.41
I0901 12:22:26.105740 140162147342336 replay_runner.py:36] Average training steps per second: 193.41
I0901 12:22:26.255935 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 4


Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 181.19
I0901 12:22:31.968573 140162147342336 replay_runner.py:36] Average training steps per second: 181.19
I0901 12:22:32.130211 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 191.53
I0901 12:22:37.556607 140162147342336 replay_runner.py:36] Average training steps per second: 191.53
I0901 12:22:37.712905 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6

Steps executed: 206 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 184.37
I0901 12:22:43.324599 140162147342336 replay_runner.py:36] Average training steps per second: 184.37
I0901 12:22:43.481392 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 7
I0901 12:22:43.686427 140162147342336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.33
I0901 12:22:48.832687 140162147342336 replay_runner.py:36] Average training steps per second: 194.33
I0901 12:22:48.975824 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 8

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 187.66
I0901 12:22:54.493699 140162147342336 replay_runner.py:36] Average training steps per second: 187.66
I0901 12:22:54.653050 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.35
INFO:tensorflow:Starting iteration 9

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 192.54
I0901 12:23:00.045789 140162147342336 replay_runner.py:36] Average training steps per second: 192.54

Steps executed: 241 Episode length: 65 Return: 65.0
INFO:tensorflow:Starting iteration 10
I0901 12:23:00.414356 140162147342336 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 187.89
I0901 12:23:05.736912 140162147342336 replay_runner.py:36] Average training steps per second: 187.89
I0901 12:23:05.925523 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.33
INFO:tensorflow:Starting iteration 11

Steps executed: 262 Episode length: 87 Return: 87.0
INFO:tensorflow:Average training steps per second: 192.28
I0901 12:23:11.326106 140162147342336 replay_runner.py:36] Average training steps per second: 192.28
I0901 12:23:11.490846 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.00
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 86 Return: 86.0
INFO:tensorflow:Average training steps per second: 187.65
I0901 12:23:17.005765 140162147342336 replay_runner.py:36] Average training steps per second: 187.65
I0901 12:23:17.162955 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 54.25
INFO:tensorflow:Starting iteration 13

Steps executed: 217 Episode length: 61 Return: 61.0
INFO:tensorflow:Average training steps per second: 190.76
I0901 12:23:22.599513 140162147342336 replay_runner.py:36] Average training steps per second: 190.76
I0901 12:23:22.751874 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.33
INFO:tensorflow:Starting iteration 14

Steps executed: 211 Episode length: 75 Return: 75.0
INFO:tensorflow:Average training steps per second: 187.65
I0901 12:23:28.275300 140162147342336 replay_runner.py:36] Average training steps per second: 187.65

Steps executed: 219 Episode length: 37 Return: 37.0
INFO:tensorflow:Starting iteration 15
I0901 12:23:28.622419 140162147342336 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.35
I0901 12:23:33.904059 140162147342336 replay_runner.py:36] Average training steps per second: 189.35
I0901 12:23:34.063589 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.00
INFO:tensorflow:Starting iteration 16

Steps executed: 225 Episode length: 46 Return: 46.0
INFO:tensorflow:Average training steps per second: 184.18
I0901 12:23:39.687330 140162147342336 replay_runner.py:36] Average training steps per second: 184.18
I0901 12:23:39.831605 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.83
INFO:tensorflow:Starting iteration 17

Steps executed: 203 Episode length: 35 Return: 35.0
INFO:tensorflow:Average training steps per second: 186.72
I0901 12:23:45.379364 140162147342336 replay_runner.py:36] Average training steps per second: 186.72
I0901 12:23:45.548620 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 36.83
INFO:tensorflow:Starting iteration 18

Steps executed: 221 Episode length: 37 Return: 37.0
INFO:tensorflow:Average training steps per second: 190.65
I0901 12:23:50.993473 140162147342336 replay_runner.py:36] Average training steps per second: 190.65
I0901 12:23:51.140706 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 30.00
INFO:tensorflow:Starting iteration 19

Steps executed: 210 Episode length: 31 Return: 31.0
INFO:tensorflow:Average training steps per second: 182.36
I0901 12:23:56.816212 140162147342336 replay_runner.py:36] Average training steps per second: 182.36
I0901 12:23:56.984759 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.00
INFO:tensorflow:Starting iteration 20

Steps executed: 235 Episode length: 52 Return: 52.0
INFO:tensorflow:Average training steps per second: 191.45
I0901 12:24:02.400021 140162147342336 replay_runner.py:36] Average training steps per second: 191.45
I0901 12:24:02.551759 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.00
INFO:tensorflow:Starting iteration 21

Steps executed: 215 Episode length: 44 Return: 44.0
INFO:tensorflow:Average training steps per second: 184.31
I0901 12:24:08.170951 140162147342336 replay_runner.py:36] Average training steps per second: 184.31

Steps executed: 247 Episode length: 49 Return: 49.0
INFO:tensorflow:Starting iteration 22
I0901 12:24:08.520602 140162147342336 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 184.90
I0901 12:24:13.929333 140162147342336 replay_runner.py:36] Average training steps per second: 184.90
I0901 12:24:14.099234 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.60
INFO:tensorflow:Starting iteration 23

Steps executed: 228 Episode length: 46 Return: 46.0
INFO:tensorflow:Average training steps per second: 189.55
I0901 12:24:19.574200 140162147342336 replay_runner.py:36] Average training steps per second: 189.55
I0901 12:24:19.735245 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 36.83
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 31 Return: 31.0
INFO:tensorflow:Average training steps per second: 186.75
I0901 12:24:25.283078 140162147342336 replay_runner.py:36] Average training steps per second: 186.75
I0901 12:24:25.428108 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.33
INFO:tensorflow:Starting iteration 25

Steps executed: 211 Episode length: 62 Return: 62.0
INFO:tensorflow:Average training steps per second: 190.81
I0901 12:24:30.863750 140162147342336 replay_runner.py:36] Average training steps per second: 190.81
I0901 12:24:31.020694 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.00
INFO:tensorflow:Starting iteration 26

Steps executed: 215 Episode length: 44 Return: 44.0
INFO:tensorflow:Average training steps per second: 190.76
I0901 12:24:36.445373 140162147342336 replay_runner.py:36] Average training steps per second: 190.76

Steps executed: 213 Episode length: 55 Return: 55.0
INFO:tensorflow:Starting iteration 27
I0901 12:24:36.796378 140162147342336 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 188.75
I0901 12:24:42.094804 140162147342336 replay_runner.py:36] Average training steps per second: 188.75
I0901 12:24:42.268473 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.60
INFO:tensorflow:Starting iteration 28

Steps executed: 238 Episode length: 44 Return: 44.0
INFO:tensorflow:Average training steps per second: 205.14
I0901 12:24:47.329499 140162147342336 replay_runner.py:36] Average training steps per second: 205.14
I0901 12:24:47.491181 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 57.25
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 66 Return: 66.0
INFO:tensorflow:Average training steps per second: 193.97


Done fixed training!Episode length: 80 Return: 80.0
I0901 12:24:52.980078 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 83.00