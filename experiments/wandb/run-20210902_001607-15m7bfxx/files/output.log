Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0902 00:16:13.691896 140268518520832 run_experiment.py:549] Creating TrainRunner ...
I0902 00:16:13.703481 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:16:13.703870 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:16:13.704134 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:16:13.704250 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:16:13.704326 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0902 00:16:13.704427 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:16:13.704480 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:16:13.704763 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:16:13.704900 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:16:13.705003 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0902 00:16:13.705121 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:16:13.705221 140268518520832 dqn_agent.py:283] 	 seed: 1630541773703385
I0902 00:16:13.708786 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:16:13.708962 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:16:13.709098 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:16:13.709223 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:16:13.709311 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:16:13.709495 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:16:13.709574 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:16:13.709627 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:16:13.709721 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:16:13.752043 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:16:14.225220 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:16:14.240082 140268518520832 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:16:14.250688 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:16:14.250931 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:16:14.251115 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:16:14.251274 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:16:14.251359 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0902 00:16:14.251442 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:16:14.251546 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:16:14.251777 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:16:14.251907 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:16:14.252036 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0902 00:16:14.252206 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:16:14.252416 140268518520832 dqn_agent.py:283] 	 seed: 1630541774250632
I0902 00:16:14.255254 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:16:14.255465 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:16:14.255632 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:16:14.255791 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:16:14.255877 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:16:14.255987 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:16:14.256122 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:16:14.256275 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:16:14.256580 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:16:14.291987 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:16:14.318052 140268518520832 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:16:14.318430 140268518520832 replay_runner.py:41] Starting iteration 0
Steps executed: 243 Episode length: 243 Return: -242.0
INFO:tensorflow:Average training steps per second: 139.11
I0902 00:16:21.507179 140268518520832 replay_runner.py:36] Average training steps per second: 139.11
I0902 00:16:22.798779 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.00
INFO:tensorflow:Starting iteration 1

Steps executed: 435 Episode length: 435 Return: -434.0
INFO:tensorflow:Average training steps per second: 189.60
I0902 00:16:28.312942 140268518520832 replay_runner.py:36] Average training steps per second: 189.60
I0902 00:16:28.677996 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.00
INFO:tensorflow:Starting iteration 2
I0902 00:16:28.921190 140268518520832 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 201.36
I0902 00:16:33.887961 140268518520832 replay_runner.py:36] Average training steps per second: 201.36
I0902 00:16:34.126137 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.00
INFO:tensorflow:Starting iteration 3


Steps executed: 215 Episode length: 215 Return: -214.0
INFO:tensorflow:Average training steps per second: 194.04
I0902 00:16:39.506161 140268518520832 replay_runner.py:36] Average training steps per second: 194.04
I0902 00:16:39.674315 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 210.69
I0902 00:16:44.655355 140268518520832 replay_runner.py:36] Average training steps per second: 210.69
I0902 00:16:45.024978 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 00:16:45.258034 140268518520832 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 199.43
I0902 00:16:50.272657 140268518520832 replay_runner.py:36] Average training steps per second: 199.43
I0902 00:16:50.667783 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 00:16:50.897499 140268518520832 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 211.87

Steps executed: 212 Episode length: 118 Return: -117.0
I0902 00:16:55.784175 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 7

Steps executed: 294 Episode length: 294 Return: -293.0
INFO:tensorflow:Average training steps per second: 207.35
I0902 00:17:00.844685 140268518520832 replay_runner.py:36] Average training steps per second: 207.35
I0902 00:17:01.061536 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.00
INFO:tensorflow:Starting iteration 8

Steps executed: 336 Episode length: 169 Return: -168.0
INFO:tensorflow:Average training steps per second: 219.03
I0902 00:17:05.858949 140268518520832 replay_runner.py:36] Average training steps per second: 219.03
I0902 00:17:06.114516 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.00
INFO:tensorflow:Starting iteration 9

Steps executed: 366 Episode length: 193 Return: -192.0
INFO:tensorflow:Average training steps per second: 215.10
I0902 00:17:10.993399 140268518520832 replay_runner.py:36] Average training steps per second: 215.10
I0902 00:17:11.270725 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 10

Steps executed: 305 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 216.16
I0902 00:17:16.125328 140268518520832 replay_runner.py:36] Average training steps per second: 216.16
I0902 00:17:16.356555 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 11

Steps executed: 257 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 209.78
I0902 00:17:21.347632 140268518520832 replay_runner.py:36] Average training steps per second: 209.78
I0902 00:17:21.532156 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 12

Steps executed: 233 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 222.65
I0902 00:17:26.245796 140268518520832 replay_runner.py:36] Average training steps per second: 222.65
I0902 00:17:26.418662 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 212.47
I0902 00:17:31.344895 140268518520832 replay_runner.py:36] Average training steps per second: 212.47
I0902 00:17:31.697817 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 213 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 221.20
I0902 00:17:36.427644 140268518520832 replay_runner.py:36] Average training steps per second: 221.20
I0902 00:17:36.587479 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 15

Steps executed: 302 Episode length: 302 Return: -301.0
INFO:tensorflow:Average training steps per second: 221.41
I0902 00:17:41.334396 140268518520832 replay_runner.py:36] Average training steps per second: 221.41
I0902 00:17:41.546918 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.00
INFO:tensorflow:Starting iteration 16

Steps executed: 284 Episode length: 284 Return: -283.0
INFO:tensorflow:Average training steps per second: 216.00
I0902 00:17:46.398619 140268518520832 replay_runner.py:36] Average training steps per second: 216.00
I0902 00:17:46.603841 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.00
INFO:tensorflow:Starting iteration 17

Steps executed: 302 Episode length: 302 Return: -301.0
INFO:tensorflow:Average training steps per second: 235.52
I0902 00:17:51.067483 140268518520832 replay_runner.py:36] Average training steps per second: 235.52
I0902 00:17:51.269125 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.00
INFO:tensorflow:Starting iteration 18

Steps executed: 220 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 237.35
I0902 00:17:55.687904 140268518520832 replay_runner.py:36] Average training steps per second: 237.35
I0902 00:17:55.817321 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 19
I0902 00:17:56.015737 140268518520832 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 255.00

Steps executed: 246 Episode length: 134 Return: -133.0
I0902 00:18:00.098454 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 20
I0902 00:18:00.302845 140268518520832 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 263.17

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:18:04.385458 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 327 Episode length: 190 Return: -189.0
INFO:tensorflow:Average training steps per second: 256.33
I0902 00:18:08.478473 140268518520832 replay_runner.py:36] Average training steps per second: 256.33
I0902 00:18:08.658795 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.50
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 265.32
I0902 00:18:12.622459 140268518520832 replay_runner.py:36] Average training steps per second: 265.32
I0902 00:18:12.919862 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 289 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 269.88
I0902 00:18:16.821896 140268518520832 replay_runner.py:36] Average training steps per second: 269.88
I0902 00:18:16.964857 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.50
INFO:tensorflow:Starting iteration 24

Steps executed: 248 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 277.23
I0902 00:18:20.748384 140268518520832 replay_runner.py:36] Average training steps per second: 277.23
I0902 00:18:20.895689 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 296.50
I0902 00:18:24.464558 140268518520832 replay_runner.py:36] Average training steps per second: 296.50
I0902 00:18:24.726356 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 287 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 260.92
I0902 00:18:28.742662 140268518520832 replay_runner.py:36] Average training steps per second: 260.92
I0902 00:18:28.892442 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.50
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 306.44
I0902 00:18:32.340554 140268518520832 replay_runner.py:36] Average training steps per second: 306.44
I0902 00:18:32.619396 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 231 Episode length: 231 Return: -230.0
INFO:tensorflow:Average training steps per second: 264.43
I0902 00:18:36.588883 140268518520832 replay_runner.py:36] Average training steps per second: 264.43
I0902 00:18:36.694916 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 320 Return: -319.0
INFO:tensorflow:Average training steps per second: 287.73
I0902 00:18:40.333003 140268518520832 replay_runner.py:36] Average training steps per second: 287.73
I0902 00:18:40.633500 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.00