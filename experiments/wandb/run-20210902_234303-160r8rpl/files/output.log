Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:43:09.964266 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:43:09.976624 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:43:09.976886 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:43:09.976987 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:43:09.977068 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:43:09.977124 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:43:09.977228 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:43:09.977330 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:43:09.977600 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:43:09.977706 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:43:09.977775 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:43:09.977885 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:43:09.977995 140170650351616 dqn_agent.py:283] 	 seed: 1630626189976565
I0902 23:43:09.981988 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:43:09.982291 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:43:09.982419 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:43:09.982500 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:43:09.982571 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:43:09.982704 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:43:09.982857 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:43:09.982978 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:43:09.983093 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:43:10.027049 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:43:10.597883 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:43:10.611790 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:43:10.623389 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:43:10.623682 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:43:10.623888 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:43:10.624268 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:43:10.624414 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:43:10.624582 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:43:10.624691 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:43:10.625079 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:43:10.625197 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:43:10.625355 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:43:10.625506 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:43:10.625653 140170650351616 dqn_agent.py:283] 	 seed: 1630626190623340
I0902 23:43:10.627894 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:43:10.628013 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:43:10.628089 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:43:10.628151 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:43:10.628208 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:43:10.628283 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:43:10.628359 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:43:10.628442 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:43:10.628510 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:43:10.667280 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:43:10.693022 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:43:10.693271 140170650351616 replay_runner.py:41] Starting iteration 0
Steps executed: 206 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 142.69
I0902 23:43:17.701719 140170650351616 replay_runner.py:36] Average training steps per second: 142.69
I0902 23:43:18.955888 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 188.18
I0902 23:43:24.462222 140170650351616 replay_runner.py:36] Average training steps per second: 188.18
I0902 23:43:24.598544 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.28
INFO:tensorflow:Starting iteration 2

Steps executed: 390 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.91
I0902 23:43:30.054028 140170650351616 replay_runner.py:36] Average training steps per second: 189.91
I0902 23:43:30.318767 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 3
I0902 23:43:30.510224 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.31

Steps executed: 354 Episode length: 172 Return: 172.0
I0902 23:43:35.804749 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.59
I0902 23:43:41.074308 140170650351616 replay_runner.py:36] Average training steps per second: 196.59
I0902 23:43:41.216565 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:43:41.403616 140170650351616 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.86
I0902 23:43:46.458096 140170650351616 replay_runner.py:36] Average training steps per second: 197.86
I0902 23:43:46.601193 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 312 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 191.83
I0902 23:43:51.999082 140170650351616 replay_runner.py:36] Average training steps per second: 191.83
I0902 23:43:52.208696 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 7

Steps executed: 391 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 195.61
I0902 23:43:57.506339 140170650351616 replay_runner.py:36] Average training steps per second: 195.61
I0902 23:43:57.764295 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.50
INFO:tensorflow:Starting iteration 8

Steps executed: 276 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 194.00
I0902 23:44:03.100428 140170650351616 replay_runner.py:36] Average training steps per second: 194.00
I0902 23:44:03.284034 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 9

Steps executed: 311 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 190.78
I0902 23:44:08.704921 140170650351616 replay_runner.py:36] Average training steps per second: 190.78
I0902 23:44:08.936256 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.50
INFO:tensorflow:Starting iteration 10

Steps executed: 313 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 191.12
I0902 23:44:14.371805 140170650351616 replay_runner.py:36] Average training steps per second: 191.12
I0902 23:44:14.579661 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.43
I0902 23:44:19.943318 140170650351616 replay_runner.py:36] Average training steps per second: 193.43
I0902 23:44:20.073946 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 336 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 192.67
I0902 23:44:25.444909 140170650351616 replay_runner.py:36] Average training steps per second: 192.67
I0902 23:44:25.674885 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 13

Steps executed: 296 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 191.63
I0902 23:44:31.088755 140170650351616 replay_runner.py:36] Average training steps per second: 191.63
I0902 23:44:31.310204 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 14

Steps executed: 330 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 190.92
I0902 23:44:36.744737 140170650351616 replay_runner.py:36] Average training steps per second: 190.92
I0902 23:44:36.970628 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.72
I0902 23:44:42.373795 140170650351616 replay_runner.py:36] Average training steps per second: 191.72
I0902 23:44:42.507577 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:44:42.695670 140170650351616 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 191.93
I0902 23:44:47.906407 140170650351616 replay_runner.py:36] Average training steps per second: 191.93
I0902 23:44:48.039732 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:44:48.221234 140170650351616 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.49
I0902 23:44:53.499239 140170650351616 replay_runner.py:36] Average training steps per second: 189.49
I0902 23:44:53.642230 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:44:53.828420 140170650351616 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 189.76
I0902 23:44:59.098642 140170650351616 replay_runner.py:36] Average training steps per second: 189.76
I0902 23:44:59.242839 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:44:59.438109 140170650351616 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 188.78
I0902 23:45:04.735583 140170650351616 replay_runner.py:36] Average training steps per second: 188.78
I0902 23:45:04.880822 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:45:05.081078 140170650351616 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 190.61
I0902 23:45:10.327797 140170650351616 replay_runner.py:36] Average training steps per second: 190.61
I0902 23:45:10.471274 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:45:10.670868 140170650351616 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 194.61
I0902 23:45:15.809831 140170650351616 replay_runner.py:36] Average training steps per second: 194.61
I0902 23:45:15.947109 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:45:16.135456 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 189.98
I0902 23:45:21.399621 140170650351616 replay_runner.py:36] Average training steps per second: 189.98
I0902 23:45:21.544082 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:45:21.737550 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.71
I0902 23:45:26.847615 140170650351616 replay_runner.py:36] Average training steps per second: 195.71
I0902 23:45:26.981071 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:45:27.162915 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 193.47
I0902 23:45:32.332016 140170650351616 replay_runner.py:36] Average training steps per second: 193.47
I0902 23:45:32.476215 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:45:32.669615 140170650351616 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.28
I0902 23:45:37.764898 140170650351616 replay_runner.py:36] Average training steps per second: 196.28
I0902 23:45:37.895202 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.78
I0902 23:45:42.970516 140170650351616 replay_runner.py:36] Average training steps per second: 204.78
I0902 23:45:43.220438 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.60
I0902 23:45:48.581714 140170650351616 replay_runner.py:36] Average training steps per second: 193.60
I0902 23:45:48.722841 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 353 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.51
I0902 23:45:53.748051 140170650351616 replay_runner.py:36] Average training steps per second: 206.51
I0902 23:45:53.972002 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.12
I0902 23:45:59.223110 140170650351616 replay_runner.py:36] Average training steps per second: 197.12
I0902 23:45:59.459981 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00