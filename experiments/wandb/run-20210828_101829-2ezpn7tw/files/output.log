I0828 10:18:36.567215 139874013124608 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:36.567778 139874013124608 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:36.625430 139874013124608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:36.626701 139874013124608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:36.626780 139874013124608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:36.626847 139874013124608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:36.626903 139874013124608 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:36.626956 139874013124608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:36.627138 139874013124608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:36.627210 139874013124608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:36.627286 139874013124608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:36.627379 139874013124608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:36.627441 139874013124608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:36.627501 139874013124608 dqn_agent.py:283] 	 seed: 1630145916625366
I0828 10:18:36.629179 139874013124608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:36.629319 139874013124608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:36.629391 139874013124608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:36.629452 139874013124608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:36.629535 139874013124608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:36.629593 139874013124608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:36.629685 139874013124608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:36.629760 139874013124608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:36.629829 139874013124608 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0828 10:18:38.116260 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.493065 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.501439 139874013124608 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.505747 139874013124608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.505896 139874013124608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.505998 139874013124608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.506075 139874013124608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.506194 139874013124608 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.506279 139874013124608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:38.506400 139874013124608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.506489 139874013124608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.506547 139874013124608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.506630 139874013124608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.506709 139874013124608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.506787 139874013124608 dqn_agent.py:283] 	 seed: 1630145918505711
I0828 10:18:38.508308 139874013124608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.508431 139874013124608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:38.508501 139874013124608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.508563 139874013124608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.508645 139874013124608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.508723 139874013124608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.508809 139874013124608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.508903 139874013124608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.508997 139874013124608 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.528812 139874013124608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.558823 139874013124608 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.559040 139874013124608 replay_runner.py:41] Starting iteration 0
Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 157.92
I0828 10:18:44.891464 139874013124608 replay_runner.py:36] Average training steps per second: 157.92
I0828 10:18:45.818564 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 23 Return: 23.0
INFO:tensorflow:Average training steps per second: 214.24
I0828 10:18:50.621592 139874013124608 replay_runner.py:36] Average training steps per second: 214.24
I0828 10:18:50.780312 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.20
INFO:tensorflow:Starting iteration 2
I0828 10:18:50.982812 139874013124608 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.25

Steps executed: 323 Episode length: 173 Return: 173.0
I0828 10:18:56.384420 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.66
I0828 10:19:01.579452 139874013124608 replay_runner.py:36] Average training steps per second: 199.66
I0828 10:19:01.728699 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 230 Episode length: 107 Return: 107.0
INFO:tensorflow:Average training steps per second: 202.98
I0828 10:19:06.854343 139874013124608 replay_runner.py:36] Average training steps per second: 202.98
I0828 10:19:07.000549 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.00
INFO:tensorflow:Starting iteration 5
I0828 10:19:07.174910 139874013124608 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.41

Steps executed: 231 Episode length: 119 Return: 119.0
I0828 10:19:12.436464 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.50
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 211.17
I0828 10:19:17.357751 139874013124608 replay_runner.py:36] Average training steps per second: 211.17
I0828 10:19:17.498440 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 253 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 193.79
I0828 10:19:22.859335 139874013124608 replay_runner.py:36] Average training steps per second: 193.79
I0828 10:19:23.031511 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.50
INFO:tensorflow:Starting iteration 8

Steps executed: 299 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.22
I0828 10:19:28.018649 139874013124608 replay_runner.py:36] Average training steps per second: 208.22
I0828 10:19:28.246313 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 9

Steps executed: 251 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 202.53
I0828 10:19:33.369236 139874013124608 replay_runner.py:36] Average training steps per second: 202.53
I0828 10:19:33.529395 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.19
I0828 10:19:38.846430 139874013124608 replay_runner.py:36] Average training steps per second: 195.19
I0828 10:19:38.990247 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11
I0828 10:19:39.201547 139874013124608 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 210.35
I0828 10:19:43.956108 139874013124608 replay_runner.py:36] Average training steps per second: 210.35
I0828 10:19:44.084129 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 273 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.63
I0828 10:19:49.433695 139874013124608 replay_runner.py:36] Average training steps per second: 193.63
I0828 10:19:49.603806 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 13
I0828 10:19:49.785879 139874013124608 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 200.70

Steps executed: 200 Episode length: 200 Return: 200.0
I0828 10:19:54.918921 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0828 10:19:55.117935 139874013124608 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 196.79
I0828 10:20:00.200278 139874013124608 replay_runner.py:36] Average training steps per second: 196.79
I0828 10:20:00.313914 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0828 10:20:00.498390 139874013124608 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.72
I0828 10:20:05.531063 139874013124608 replay_runner.py:36] Average training steps per second: 198.72
I0828 10:20:05.680322 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0828 10:20:05.868427 139874013124608 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 203.17

Steps executed: 229 Episode length: 77 Return: 77.0.0
I0828 10:20:10.942903 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 76.33
INFO:tensorflow:Starting iteration 17

Steps executed: 153 Episode length: 79 Return: 79.0.0
INFO:tensorflow:Average training steps per second: 191.51
I0828 10:20:16.348499 139874013124608 replay_runner.py:36] Average training steps per second: 191.51
I0828 10:20:16.491379 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 73.67
INFO:tensorflow:Starting iteration 18


Steps executed: 237 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 212.80
I0828 10:20:21.359972 139874013124608 replay_runner.py:36] Average training steps per second: 212.80
I0828 10:20:21.519635 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 19
I0828 10:20:21.722473 139874013124608 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 197.60
I0828 10:20:26.783830 139874013124608 replay_runner.py:36] Average training steps per second: 197.60

Steps executed: 341 Episode length: 179 Return: 179.0
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.89
I0828 10:20:32.052347 139874013124608 replay_runner.py:36] Average training steps per second: 204.89
I0828 10:20:32.202106 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0828 10:20:32.399640 139874013124608 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 206.21
I0828 10:20:37.249363 139874013124608 replay_runner.py:36] Average training steps per second: 206.21
I0828 10:20:37.374729 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0828 10:20:37.556515 139874013124608 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.44
I0828 10:20:42.647561 139874013124608 replay_runner.py:36] Average training steps per second: 196.44
I0828 10:20:42.789401 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 212 Episode length: 33 Return: 33.0.0
INFO:tensorflow:Average training steps per second: 213.11
I0828 10:20:47.682137 139874013124608 replay_runner.py:36] Average training steps per second: 213.11
I0828 10:20:47.829778 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 35.33
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.81
I0828 10:20:53.191488 139874013124608 replay_runner.py:36] Average training steps per second: 193.81
I0828 10:20:53.329120 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 304 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 207.49
I0828 10:20:58.334576 139874013124608 replay_runner.py:36] Average training steps per second: 207.49
I0828 10:20:58.544807 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.74
I0828 10:21:03.673085 139874013124608 replay_runner.py:36] Average training steps per second: 202.74
I0828 10:21:03.791250 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0828 10:21:03.977941 139874013124608 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 202.84
I0828 10:21:08.908313 139874013124608 replay_runner.py:36] Average training steps per second: 202.84
I0828 10:21:09.053947 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0828 10:21:09.251780 139874013124608 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 207.37
I0828 10:21:14.074630 139874013124608 replay_runner.py:36] Average training steps per second: 207.37
I0828 10:21:14.204460 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.15
I0828 10:21:19.545400 139874013124608 replay_runner.py:36] Average training steps per second: 194.15
I0828 10:21:19.682410 139874013124608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00