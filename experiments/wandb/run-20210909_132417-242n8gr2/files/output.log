Loaded trained dqn in mountaincar
Training fixed agent 8, please be patient, may be a while...
I0909 13:24:23.128847 140019479689216 run_experiment.py:549] Creating TrainRunner ...
I0909 13:24:23.135549 140019479689216 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:23.135716 140019479689216 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:23.135792 140019479689216 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:23.135872 140019479689216 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:23.136002 140019479689216 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:23.136084 140019479689216 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:23.136173 140019479689216 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:23.136235 140019479689216 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:23.136347 140019479689216 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:23.136416 140019479689216 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:23.136501 140019479689216 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:23.136569 140019479689216 dqn_agent.py:283] 	 seed: 1631193863135509
I0909 13:24:23.139369 140019479689216 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:23.139584 140019479689216 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:23.139717 140019479689216 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:23.139818 140019479689216 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:23.139982 140019479689216 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:23.140072 140019479689216 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:23.140395 140019479689216 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:23.140545 140019479689216 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:23.140689 140019479689216 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:23.177293 140019479689216 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:23.382861 140019479689216 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:23.395834 140019479689216 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:24:23.403197 140019479689216 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:23.403365 140019479689216 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:23.403449 140019479689216 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:23.403512 140019479689216 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:23.403569 140019479689216 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:23.403652 140019479689216 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:23.403714 140019479689216 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:23.403830 140019479689216 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:23.403964 140019479689216 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:23.404028 140019479689216 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:23.404082 140019479689216 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:23.404142 140019479689216 dqn_agent.py:283] 	 seed: 1631193863403158
I0909 13:24:23.405716 140019479689216 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:23.405850 140019479689216 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:23.405977 140019479689216 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:23.406041 140019479689216 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:23.406097 140019479689216 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:23.406159 140019479689216 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:23.406212 140019479689216 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:23.406263 140019479689216 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:23.406315 140019479689216 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:23.436385 140019479689216 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:23.456040 140019479689216 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:24:23.456296 140019479689216 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 169.73
I0909 13:24:29.348407 140019479689216 replay_runner.py:36] Average training steps per second: 169.73
I0909 13:24:30.625982 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:24:30.743603 140019479689216 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.33
I0909 13:24:35.181869 140019479689216 replay_runner.py:36] Average training steps per second: 225.33
I0909 13:24:35.545903 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:24:35.647466 140019479689216 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 224.83
I0909 13:24:40.095651 140019479689216 replay_runner.py:36] Average training steps per second: 224.83
I0909 13:24:40.425982 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:24:40.532851 140019479689216 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 220.83
I0909 13:24:45.061665 140019479689216 replay_runner.py:36] Average training steps per second: 220.83
I0909 13:24:45.408374 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:24:45.520405 140019479689216 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 222.11
I0909 13:24:50.023007 140019479689216 replay_runner.py:36] Average training steps per second: 222.11
I0909 13:24:50.389045 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:24:50.503411 140019479689216 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.65
I0909 13:24:54.975341 140019479689216 replay_runner.py:36] Average training steps per second: 223.65
I0909 13:24:55.312516 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:24:55.421836 140019479689216 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.68
I0909 13:24:59.833794 140019479689216 replay_runner.py:36] Average training steps per second: 226.68
I0909 13:25:00.154006 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:25:00.258992 140019479689216 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 228.39
I0909 13:25:04.637844 140019479689216 replay_runner.py:36] Average training steps per second: 228.39
I0909 13:25:04.980571 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:25:05.085094 140019479689216 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 223.43
I0909 13:25:09.561033 140019479689216 replay_runner.py:36] Average training steps per second: 223.43
I0909 13:25:09.897485 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 236 Episode length: 141 Return: -141.0
INFO:tensorflow:Average training steps per second: 224.48
I0909 13:25:14.461213 140019479689216 replay_runner.py:36] Average training steps per second: 224.48
I0909 13:25:14.601392 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 10

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 223.33
I0909 13:25:19.181097 140019479689216 replay_runner.py:36] Average training steps per second: 223.33
I0909 13:25:19.503856 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 688 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 224.63
I0909 13:25:24.064866 140019479689216 replay_runner.py:36] Average training steps per second: 224.63
I0909 13:25:24.452878 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.00
INFO:tensorflow:Starting iteration 12

Steps executed: 150 Episode length: 150 Return: -150.0
INFO:tensorflow:Average training steps per second: 223.87

Steps executed: 750 Episode length: 600 Return: -600.0
I0909 13:25:29.447487 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.00
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 222.10
I0909 13:25:34.054806 140019479689216 replay_runner.py:36] Average training steps per second: 222.10
I0909 13:25:34.407402 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14

Steps executed: 221 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 223.48
I0909 13:25:38.996845 140019479689216 replay_runner.py:36] Average training steps per second: 223.48
I0909 13:25:39.124598 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 222.22
I0909 13:25:43.733090 140019479689216 replay_runner.py:36] Average training steps per second: 222.22
I0909 13:25:43.861493 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 16

Steps executed: 711 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 219.06
I0909 13:25:48.528090 140019479689216 replay_runner.py:36] Average training steps per second: 219.06
I0909 13:25:48.939744 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.50
INFO:tensorflow:Starting iteration 17
I0909 13:25:49.053513 140019479689216 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 224.72

Steps executed: 244 Episode length: 90 Return: -90.0.0
I0909 13:25:53.640718 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 18

Steps executed: 477 Episode length: 477 Return: -477.0
INFO:tensorflow:Average training steps per second: 223.38
I0909 13:25:58.218320 140019479689216 replay_runner.py:36] Average training steps per second: 223.38
I0909 13:25:58.478730 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -477.00
INFO:tensorflow:Starting iteration 19
I0909 13:25:58.588682 140019479689216 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 220.32

Steps executed: 214 Episode length: 117 Return: -117.0
I0909 13:26:03.245574 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 20

Steps executed: 300 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 222.09
I0909 13:26:07.854073 140019479689216 replay_runner.py:36] Average training steps per second: 222.09
I0909 13:26:08.031796 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 21

Steps executed: 242 Episode length: 130 Return: -130.0
INFO:tensorflow:Average training steps per second: 217.13
I0909 13:26:12.748810 140019479689216 replay_runner.py:36] Average training steps per second: 217.13
I0909 13:26:12.897800 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 22

Steps executed: 223 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 219.13
I0909 13:26:17.572768 140019479689216 replay_runner.py:36] Average training steps per second: 219.13
I0909 13:26:17.716190 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 23

Steps executed: 220 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 224.75
I0909 13:26:22.282442 140019479689216 replay_runner.py:36] Average training steps per second: 224.75
I0909 13:26:22.417335 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 24

Steps executed: 690 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 223.91
I0909 13:26:26.993437 140019479689216 replay_runner.py:36] Average training steps per second: 223.91
I0909 13:26:27.394488 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.00
INFO:tensorflow:Starting iteration 25

Steps executed: 262 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 220.88
I0909 13:26:32.026420 140019479689216 replay_runner.py:36] Average training steps per second: 220.88
I0909 13:26:32.180536 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.00
INFO:tensorflow:Starting iteration 26

Steps executed: 252 Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 223.44
I0909 13:26:36.766686 140019479689216 replay_runner.py:36] Average training steps per second: 223.44
I0909 13:26:36.914999 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 27

Steps executed: 99 Episode length: 99 Return: -99.00.0
INFO:tensorflow:Average training steps per second: 220.51

Steps executed: 498 Episode length: 302 Return: -302.0
I0909 13:26:41.868586 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.00
INFO:tensorflow:Starting iteration 28

Steps executed: 256 Episode length: 98 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 232.35
I0909 13:26:46.290049 140019479689216 replay_runner.py:36] Average training steps per second: 232.35
I0909 13:26:46.409498 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 291.54
I0909 13:26:49.927876 140019479689216 replay_runner.py:36] Average training steps per second: 291.54
I0909 13:26:50.024800 140019479689216 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67