I0902 23:09:47.164824 139633860089856 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.165369 139633860089856 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.225978 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.227133 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.227222 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.227288 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.227387 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.227458 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:47.227720 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.227867 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.227941 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.228007 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.228067 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.228131 139633860089856 dqn_agent.py:283] 	 seed: 1630624187225919
I0902 23:09:47.230131 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.230272 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:47.230351 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.230419 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.230477 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.230548 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.230655 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.230736 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.230816 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.568550 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:52.998758 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.007198 139633860089856 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.012535 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 23:09:53.012673 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.012769 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.012850 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.012925 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.013004 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:53.013108 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:53.013219 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.013314 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.013394 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.013487 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.013590 139633860089856 dqn_agent.py:283] 	 seed: 1630624193012505
I0902 23:09:53.015119 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:53.015244 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:53.015337 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:53.015422 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:53.015506 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:53.015598 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:53.015676 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:53.015760 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:53.015841 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.074853 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.194489 139633860089856 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:54.194785 139633860089856 replay_runner.py:41] Starting iteration 0
Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 111.11
I0902 23:10:03.194870 139633860089856 replay_runner.py:36] Average training steps per second: 111.11
I0902 23:10:04.175970 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 225 Episode length: 42 Return: 42.0
INFO:tensorflow:Average training steps per second: 199.79
I0902 23:10:09.317377 139633860089856 replay_runner.py:36] Average training steps per second: 199.79
I0902 23:10:09.512925 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.00
INFO:tensorflow:Starting iteration 2

Steps executed: 284 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 182.51
I0902 23:10:15.187595 139633860089856 replay_runner.py:36] Average training steps per second: 182.51
I0902 23:10:15.370504 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 3
I0902 23:10:15.551933 139633860089856 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 190.10
I0902 23:10:20.812936 139633860089856 replay_runner.py:36] Average training steps per second: 190.10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 4
I0902 23:10:21.180999 139633860089856 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.98
I0902 23:10:26.232632 139633860089856 replay_runner.py:36] Average training steps per second: 197.98
I0902 23:10:26.363004 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 386 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 184.62
I0902 23:10:31.975878 139633860089856 replay_runner.py:36] Average training steps per second: 184.62
I0902 23:10:32.249902 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00
INFO:tensorflow:Starting iteration 6

Steps executed: 320 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 202.94
I0902 23:10:37.376208 139633860089856 replay_runner.py:36] Average training steps per second: 202.94
I0902 23:10:37.592578 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 7
I0902 23:10:37.788568 139633860089856 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 185.63

Steps executed: 336 Episode length: 189 Return: 189.0
I0902 23:10:43.417039 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 8

Steps executed: 331 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 203.52
I0902 23:10:48.526381 139633860089856 replay_runner.py:36] Average training steps per second: 203.52
I0902 23:10:48.757292 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 9

Steps executed: 318 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 189.84
I0902 23:10:54.220988 139633860089856 replay_runner.py:36] Average training steps per second: 189.84
I0902 23:10:54.436483 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 10

Steps executed: 326 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 203.54
I0902 23:10:59.551157 139633860089856 replay_runner.py:36] Average training steps per second: 203.54
I0902 23:10:59.788914 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 11

Steps executed: 136 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 191.05
I0902 23:11:05.219139 139633860089856 replay_runner.py:36] Average training steps per second: 191.05

Steps executed: 288 Episode length: 152 Return: 152.0
INFO:tensorflow:Starting iteration 12

Steps executed: 296 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 201.40
I0902 23:11:10.584437 139633860089856 replay_runner.py:36] Average training steps per second: 201.40
I0902 23:11:10.782768 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 13

Steps executed: 328 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 193.24
I0902 23:11:16.151817 139633860089856 replay_runner.py:36] Average training steps per second: 193.24
I0902 23:11:16.375634 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 14

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.79
I0902 23:11:21.597562 139633860089856 replay_runner.py:36] Average training steps per second: 198.79
I0902 23:11:21.860560 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.50
INFO:tensorflow:Starting iteration 15

Steps executed: 317 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 191.04
I0902 23:11:27.295366 139633860089856 replay_runner.py:36] Average training steps per second: 191.04
I0902 23:11:27.516769 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.37
I0902 23:11:32.742691 139633860089856 replay_runner.py:36] Average training steps per second: 198.37
I0902 23:11:32.885147 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.17
I0902 23:11:38.209285 139633860089856 replay_runner.py:36] Average training steps per second: 195.17
I0902 23:11:38.448485 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.20
I0902 23:11:43.638289 139633860089856 replay_runner.py:36] Average training steps per second: 200.20
I0902 23:11:43.772692 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 146 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 192.26
I0902 23:11:49.171746 139633860089856 replay_runner.py:36] Average training steps per second: 192.26

Steps executed: 286 Episode length: 140 Return: 140.0
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.00
I0902 23:11:54.572787 139633860089856 replay_runner.py:36] Average training steps per second: 199.00
I0902 23:11:54.714712 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:11:54.914449 139633860089856 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.25
I0902 23:12:00.116713 139633860089856 replay_runner.py:36] Average training steps per second: 192.25
I0902 23:12:00.245449 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:12:00.435469 139633860089856 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 199.94

Steps executed: 319 Episode length: 156 Return: 156.0
I0902 23:12:05.649821 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.87
I0902 23:12:11.052514 139633860089856 replay_runner.py:36] Average training steps per second: 191.87
I0902 23:12:11.183486 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:12:11.379085 139633860089856 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 203.98
I0902 23:12:16.282388 139633860089856 replay_runner.py:36] Average training steps per second: 203.98
I0902 23:12:16.417773 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 367 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.87
I0902 23:12:21.750247 139633860089856 replay_runner.py:36] Average training steps per second: 194.87
I0902 23:12:21.997080 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.70
I0902 23:12:27.073769 139633860089856 replay_runner.py:36] Average training steps per second: 204.70
I0902 23:12:27.216356 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:12:27.413676 139633860089856 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.59
I0902 23:12:32.606625 139633860089856 replay_runner.py:36] Average training steps per second: 192.59
I0902 23:12:32.746796 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 301 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 199.72
I0902 23:12:37.939834 139633860089856 replay_runner.py:36] Average training steps per second: 199.72
I0902 23:12:38.149904 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 29

Steps executed: 384 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 196.34

Done fixed training!Episode length: 187 Return: 187.0
I0902 23:12:43.684810 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00