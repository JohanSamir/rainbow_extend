Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 00:19:55.594338 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:19:55.604291 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:55.604485 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:55.604595 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:55.604707 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:55.604797 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:55.604882 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:55.604983 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:55.605092 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:55.605226 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:55.605376 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:55.605512 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:55.605628 139644712736768 dqn_agent.py:283] 	 seed: 1630541995604245
I0902 00:19:55.608570 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:55.608737 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:55.608901 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:55.609026 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:55.609144 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:55.609254 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:55.609358 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:55.609493 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:55.609603 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:55.645144 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:55.951584 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:55.961524 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:19:55.968388 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:55.968544 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:55.968626 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:55.968693 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:55.968760 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:55.968827 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:55.968911 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:55.969009 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:55.969085 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:55.969158 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:55.969233 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:55.969316 139644712736768 dqn_agent.py:283] 	 seed: 1630541995968346
I0902 00:19:55.970921 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:55.971050 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:55.971129 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:55.971199 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:55.971272 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:55.971336 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:55.971414 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:55.971488 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:55.971563 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:55.992880 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:56.008206 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:19:56.008419 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 250.19
I0902 00:20:00.005588 139644712736768 replay_runner.py:36] Average training steps per second: 250.19
I0902 00:20:00.840111 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.25
Steps executed: 302 Episode length: 165 Return: -196.1358831775953
INFO:tensorflow:Starting iteration 1
I0902 00:20:04.265843 139644712736768 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 350.57

Steps executed: 350 Episode length: 156 Return: -532.84945186950656
I0902 00:20:07.335592 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.70
INFO:tensorflow:Starting iteration 2

Steps executed: 266 Episode length: 150 Return: -150.05502257495142
INFO:tensorflow:Average training steps per second: 331.04
I0902 00:20:13.656480 139644712736768 replay_runner.py:36] Average training steps per second: 331.04
I0902 00:20:13.804521 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.94
INFO:tensorflow:Starting iteration 3

Steps executed: 607 Episode length: 429 Return: -86.422667363695942
INFO:tensorflow:Average training steps per second: 342.13
I0902 00:20:20.062686 139644712736768 replay_runner.py:36] Average training steps per second: 342.13
I0902 00:20:20.806137 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.56
INFO:tensorflow:Starting iteration 4
I0902 00:20:24.199073 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 354.54

Steps executed: 1000 Episode length: 1000 Return: -158.00399667554427
I0902 00:20:29.122965 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 5

Steps executed: 666 Episode length: 666 Return: -223.6739101629610827
INFO:tensorflow:Average training steps per second: 343.43
I0902 00:20:35.415646 139644712736768 replay_runner.py:36] Average training steps per second: 343.43
I0902 00:20:36.176822 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.67
INFO:tensorflow:Starting iteration 6
I0902 00:20:39.564408 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 346.74

Steps executed: 1000 Episode length: 1000 Return: -172.80067618112477
I0902 00:20:44.308722 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.80
INFO:tensorflow:Starting iteration 7
I0902 00:20:47.850227 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 363.41

Steps executed: 1000 Episode length: 1000 Return: -129.47203839693938
I0902 00:20:52.257928 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.47
INFO:tensorflow:Starting iteration 8
I0902 00:20:55.773322 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 369.74

Steps executed: 1000 Episode length: 1000 Return: -95.880236714877338
I0902 00:20:59.762550 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.88
INFO:tensorflow:Starting iteration 9

Steps executed: 667 Episode length: 667 Return: -373.4223725821769338
INFO:tensorflow:Average training steps per second: 346.05
I0902 00:21:06.071003 139644712736768 replay_runner.py:36] Average training steps per second: 346.05
I0902 00:21:06.835933 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.42
INFO:tensorflow:Starting iteration 10
I0902 00:21:10.210685 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 342.32

Steps executed: 992 Episode length: 992 Return: -383.5298394576214538
I0902 00:21:14.663306 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.53
INFO:tensorflow:Starting iteration 11
I0902 00:21:18.119902 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 339.63

Steps executed: 653 Episode length: 653 Return: -362.9932063843592738
I0902 00:21:21.897730 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.99
INFO:tensorflow:Starting iteration 12
I0902 00:21:25.200520 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 317.89

Steps executed: 1000 Episode length: 1000 Return: -67.104199466100628
I0902 00:21:30.701935 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.10
INFO:tensorflow:Starting iteration 13
I0902 00:21:34.223015 139644712736768 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 354.38

Steps executed: 1000 Episode length: 1000 Return: -127.88739877144353
I0902 00:21:39.112732 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.89
INFO:tensorflow:Starting iteration 14
I0902 00:21:42.505003 139644712736768 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 346.67

Steps executed: 1000 Episode length: 1000 Return: -159.45259948033183
I0902 00:21:47.562519 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.45
INFO:tensorflow:Starting iteration 15
I0902 00:21:50.944934 139644712736768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 346.85
I0902 00:21:53.828299 139644712736768 replay_runner.py:36] Average training steps per second: 346.85

Steps executed: 1000 Episode length: 1000 Return: -67.712780026709743
INFO:tensorflow:Starting iteration 16

Steps executed: 547 Episode length: 547 Return: -58.59709999069415743
INFO:tensorflow:Average training steps per second: 344.59
I0902 00:22:02.105338 139644712736768 replay_runner.py:36] Average training steps per second: 344.59
I0902 00:22:02.859616 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.60
INFO:tensorflow:Starting iteration 17

Steps executed: 282 Episode length: 142 Return: -81.11904770744616543
INFO:tensorflow:Average training steps per second: 335.48
I0902 00:22:09.168173 139644712736768 replay_runner.py:36] Average training steps per second: 335.48
I0902 00:22:09.344258 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.07
INFO:tensorflow:Starting iteration 18

Steps executed: 1000 Episode length: 1000 Return: -55.153457164523473
INFO:tensorflow:Average training steps per second: 331.83
I0902 00:22:15.730521 139644712736768 replay_runner.py:36] Average training steps per second: 331.83
I0902 00:22:17.628735 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -55.15
INFO:tensorflow:Starting iteration 19

Steps executed: 321 Episode length: 163 Return: 22.506349157555405473
INFO:tensorflow:Average training steps per second: 331.17
I0902 00:22:23.966450 139644712736768 replay_runner.py:36] Average training steps per second: 331.17
I0902 00:22:24.181638 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 31.98
INFO:tensorflow:Starting iteration 20

Steps executed: 412 Episode length: 412 Return: -240.3358873588376473
INFO:tensorflow:Average training steps per second: 341.15
I0902 00:22:30.480150 139644712736768 replay_runner.py:36] Average training steps per second: 341.15
I0902 00:22:31.022743 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.34
INFO:tensorflow:Starting iteration 21
I0902 00:22:34.418224 139644712736768 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 339.74

Steps executed: 938 Episode length: 938 Return: -400.3295054485388473
I0902 00:22:39.388433 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.33
INFO:tensorflow:Starting iteration 22
I0902 00:22:42.853410 139644712736768 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 369.47
I0902 00:22:45.560321 139644712736768 replay_runner.py:36] Average training steps per second: 369.47

Steps executed: 212 Episode length: 212 Return: 13.978208425363931473
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 135 Return: -35.92528274096871473
INFO:tensorflow:Average training steps per second: 361.26
I0902 00:22:52.014568 139644712736768 replay_runner.py:36] Average training steps per second: 361.26
I0902 00:22:52.121401 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.23
INFO:tensorflow:Starting iteration 24

Steps executed: 667 Episode length: 667 Return: -874.2801545613045473
INFO:tensorflow:Average training steps per second: 324.85
I0902 00:22:58.569075 139644712736768 replay_runner.py:36] Average training steps per second: 324.85
I0902 00:22:59.497277 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -874.28
INFO:tensorflow:Starting iteration 25

Steps executed: 457 Episode length: 457 Return: -46.76947889301886473
INFO:tensorflow:Average training steps per second: 324.49
I0902 00:23:05.915268 139644712736768 replay_runner.py:36] Average training steps per second: 324.49
I0902 00:23:06.555114 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.77
INFO:tensorflow:Starting iteration 26

Steps executed: 661 Episode length: 661 Return: -79.60518779052973473
INFO:tensorflow:Average training steps per second: 364.18
I0902 00:23:12.550156 139644712736768 replay_runner.py:36] Average training steps per second: 364.18
I0902 00:23:13.509214 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.61
INFO:tensorflow:Starting iteration 27

Steps executed: 118 Episode length: 56 Return: -142.66996235813548473
INFO:tensorflow:Average training steps per second: 370.45
I0902 00:23:19.601516 139644712736768 replay_runner.py:36] Average training steps per second: 370.45

Steps executed: 355 Episode length: 237 Return: -69.04063283982201473
INFO:tensorflow:Starting iteration 28
I0902 00:23:23.159542 139644712736768 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 350.42

Steps executed: 363 Episode length: 363 Return: -30.42565358294041373
I0902 00:23:26.378598 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.43
INFO:tensorflow:Starting iteration 29

Steps executed: 359 Episode length: 197 Return: 24.039683109573062373
INFO:tensorflow:Average training steps per second: 344.85
I0902 00:23:32.517945 139644712736768 replay_runner.py:36] Average training steps per second: 344.85

Done fixed training!Episode length: 197 Return: 24.039683109573062373