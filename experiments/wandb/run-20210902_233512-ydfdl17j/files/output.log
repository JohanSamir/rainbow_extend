Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 23:35:18.903849 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0902 23:35:18.914759 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:18.914941 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:18.915023 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:18.915090 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:18.915146 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:18.915433 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:18.915674 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:18.915846 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:18.915982 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:18.916101 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:18.916435 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:18.916756 139735608805376 dqn_agent.py:283] 	 seed: 1630625718914709
I0902 23:35:18.920027 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:18.920191 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:18.920291 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:18.920395 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:18.920476 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:18.920561 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:18.920614 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:18.920665 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:18.920757 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:18.953180 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.328915 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.343971 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:35:19.351961 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:35:19.352143 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:35:19.352297 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:35:19.352417 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:35:19.352518 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:35:19.352689 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:35:19.352824 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:35:19.352931 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:35:19.353060 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:35:19.353194 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:35:19.353321 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:35:19.353420 139735608805376 dqn_agent.py:283] 	 seed: 1630625719351914
I0902 23:35:19.356849 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:35:19.357095 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:35:19.357210 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:35:19.357338 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:35:19.357482 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:35:19.357596 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:35:19.357709 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:35:19.357793 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:35:19.357940 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:35:19.399832 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:35:19.443866 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:35:19.444181 139735608805376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.28
I0902 23:35:25.644996 139735608805376 replay_runner.py:36] Average training steps per second: 161.28
Steps executed: 241 Episode length: 117 Return: -226.3789981116802
I0902 23:35:26.827902 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.91
INFO:tensorflow:Starting iteration 1

Steps executed: 428 Episode length: 271 Return: -170.53735253495333
INFO:tensorflow:Average training steps per second: 224.09
I0902 23:35:35.633828 139735608805376 replay_runner.py:36] Average training steps per second: 224.09
I0902 23:35:36.092651 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.29
INFO:tensorflow:Starting iteration 2

Steps executed: 278 Episode length: 132 Return: -266.06753101326993
INFO:tensorflow:Average training steps per second: 223.35
I0902 23:35:44.943072 139735608805376 replay_runner.py:36] Average training steps per second: 223.35
I0902 23:35:45.179633 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.11
INFO:tensorflow:Starting iteration 3

Steps executed: 269 Episode length: 165 Return: -151.07090161679253
INFO:tensorflow:Average training steps per second: 211.51
I0902 23:35:54.338933 139735608805376 replay_runner.py:36] Average training steps per second: 211.51
I0902 23:35:54.605981 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.49
INFO:tensorflow:Starting iteration 4
I0902 23:35:58.962276 139735608805376 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 221.83

Steps executed: 1000 Episode length: 1000 Return: -111.36929369254553
I0902 23:36:05.755036 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.37
INFO:tensorflow:Starting iteration 5
I0902 23:36:10.202197 139735608805376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 227.29


Steps executed: 1145 Episode length: 1000 Return: -30.747773765462778
I0902 23:36:17.461433 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -39.99
INFO:tensorflow:Starting iteration 6
I0902 23:36:21.693660 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.97

Steps executed: 1000 Episode length: 1000 Return: -33.252183279339924
I0902 23:36:30.308568 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.25
INFO:tensorflow:Starting iteration 7

Steps executed: 143 Episode length: 143 Return: -345.1898506295289624
INFO:tensorflow:Average training steps per second: 217.22

Steps executed: 1050 Episode length: 907 Return: -573.851497412373624
I0902 23:36:41.257507 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.52
INFO:tensorflow:Starting iteration 8
I0902 23:36:45.525254 139735608805376 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 223.34

Steps executed: 1000 Episode length: 1000 Return: -187.83626954017614
I0902 23:36:52.910747 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.84
INFO:tensorflow:Starting iteration 9

Steps executed: 253 Episode length: 128 Return: -505.8793275496122814
INFO:tensorflow:Average training steps per second: 225.28
I0902 23:37:01.543034 139735608805376 replay_runner.py:36] Average training steps per second: 225.28
I0902 23:37:01.765273 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.74
INFO:tensorflow:Starting iteration 10
I0902 23:37:06.027278 139735608805376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 219.13

Steps executed: 572 Episode length: 572 Return: -257.1942366429163814
I0902 23:37:11.635714 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.19
INFO:tensorflow:Starting iteration 11
I0902 23:37:15.992429 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 223.66

Steps executed: 1000 Episode length: 1000 Return: -103.68417168044621
I0902 23:37:22.478799 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.68
INFO:tensorflow:Starting iteration 12
I0902 23:37:26.615963 139735608805376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 230.89

Steps executed: 653 Episode length: 653 Return: -116.1803009575329521
I0902 23:37:32.036031 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.18
INFO:tensorflow:Starting iteration 13
I0902 23:37:36.227715 139735608805376 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 226.70

Steps executed: 1000 Episode length: 1000 Return: -158.71764803541626
I0902 23:37:43.553521 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.72
INFO:tensorflow:Starting iteration 14

Steps executed: 463 Episode length: 299 Return: -450.0291991482082526
INFO:tensorflow:Average training steps per second: 223.88
I0902 23:37:52.408935 139735608805376 replay_runner.py:36] Average training steps per second: 223.88
I0902 23:37:52.910187 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.67
INFO:tensorflow:Starting iteration 15

Steps executed: 242 Episode length: 242 Return: -176.2712873585561526
INFO:tensorflow:Average training steps per second: 225.11
I0902 23:38:01.531893 139735608805376 replay_runner.py:36] Average training steps per second: 225.11
I0902 23:38:01.784430 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.27
INFO:tensorflow:Starting iteration 16

Steps executed: 211 Episode length: 211 Return: -335.6960727364634526
INFO:tensorflow:Average training steps per second: 223.91
I0902 23:38:10.600880 139735608805376 replay_runner.py:36] Average training steps per second: 223.91
I0902 23:38:10.826002 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.70
INFO:tensorflow:Starting iteration 17

Steps executed: 431 Episode length: 306 Return: -473.4226153383793626
INFO:tensorflow:Average training steps per second: 222.76
I0902 23:38:19.665481 139735608805376 replay_runner.py:36] Average training steps per second: 222.76
I0902 23:38:20.248610 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.17
INFO:tensorflow:Starting iteration 18

Steps executed: 343 Episode length: 172 Return: -141.4310710135719626
INFO:tensorflow:Average training steps per second: 216.45
I0902 23:38:29.134503 139735608805376 replay_runner.py:36] Average training steps per second: 216.45
I0902 23:38:29.493230 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.72
INFO:tensorflow:Starting iteration 19

Steps executed: 390 Episode length: 193 Return: -25.66505787807659526
INFO:tensorflow:Average training steps per second: 212.39
I0902 23:38:38.521862 139735608805376 replay_runner.py:36] Average training steps per second: 212.39
I0902 23:38:38.955922 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.01
INFO:tensorflow:Starting iteration 20

Steps executed: 378 Episode length: 378 Return: 15.120818221588507526
INFO:tensorflow:Average training steps per second: 214.78
I0902 23:38:47.982082 139735608805376 replay_runner.py:36] Average training steps per second: 214.78
I0902 23:38:48.979587 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.12
INFO:tensorflow:Starting iteration 21

Steps executed: 339 Episode length: 339 Return: -262.1811122911152626
INFO:tensorflow:Average training steps per second: 216.50
I0902 23:38:57.848087 139735608805376 replay_runner.py:36] Average training steps per second: 216.50
I0902 23:38:58.316658 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.18
INFO:tensorflow:Starting iteration 22

Steps executed: 150 Episode length: 150 Return: -104.3263226337958726
INFO:tensorflow:Average training steps per second: 214.73

Steps executed: 468 Episode length: 318 Return: -661.6259785191363726
I0902 23:39:07.714338 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.98
INFO:tensorflow:Starting iteration 23

Steps executed: 355 Episode length: 194 Return: -296.2032236933111426
INFO:tensorflow:Average training steps per second: 214.34
I0902 23:39:16.408631 139735608805376 replay_runner.py:36] Average training steps per second: 214.34
I0902 23:39:16.780323 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.29
INFO:tensorflow:Starting iteration 24

Steps executed: 317 Episode length: 150 Return: -164.7336562956202826
INFO:tensorflow:Average training steps per second: 219.73
I0902 23:39:25.549160 139735608805376 replay_runner.py:36] Average training steps per second: 219.73
I0902 23:39:25.834084 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.44
INFO:tensorflow:Starting iteration 25

Steps executed: 308 Episode length: 209 Return: -35.64108143172318826
INFO:tensorflow:Average training steps per second: 217.50
I0902 23:39:34.621937 139735608805376 replay_runner.py:36] Average training steps per second: 217.50
I0902 23:39:34.948981 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.95
INFO:tensorflow:Starting iteration 26

Steps executed: 352 Episode length: 204 Return: -204.3475317819407526
INFO:tensorflow:Average training steps per second: 216.11
I0902 23:39:43.890565 139735608805376 replay_runner.py:36] Average training steps per second: 216.11
I0902 23:39:44.226037 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.57
INFO:tensorflow:Starting iteration 27

Steps executed: 112 Episode length: 112 Return: -213.4651282650967826
INFO:tensorflow:Average training steps per second: 221.73
I0902 23:39:52.978571 139735608805376 replay_runner.py:36] Average training steps per second: 221.73

Steps executed: 321 Episode length: 209 Return: -203.8331871491703326
INFO:tensorflow:Starting iteration 28

Steps executed: 273 Episode length: 148 Return: -420.6923508183836326
INFO:tensorflow:Average training steps per second: 220.33
I0902 23:40:02.049380 139735608805376 replay_runner.py:36] Average training steps per second: 220.33
I0902 23:40:02.283605 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.00
INFO:tensorflow:Starting iteration 29
I0902 23:40:06.595306 139735608805376 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 214.62

Steps executed: 353 Episode length: 280 Return: -480.2130173573476726

Done fixed training!Episode length: 280 Return: -480.2130173573476726