Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 18:05:56.577966 140634740336640 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:56.587928 140634740336640 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:56.588230 140634740336640 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:56.588392 140634740336640 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:56.588485 140634740336640 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:56.588742 140634740336640 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:56.588840 140634740336640 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:56.588896 140634740336640 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:56.588975 140634740336640 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:56.589029 140634740336640 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:56.589080 140634740336640 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:56.589131 140634740336640 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:56.589194 140634740336640 dqn_agent.py:283] 	 seed: 1630605956587855
I0902 18:05:56.591816 140634740336640 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:56.592018 140634740336640 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:05:56.592178 140634740336640 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:56.592292 140634740336640 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:56.592416 140634740336640 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:56.592531 140634740336640 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:56.592642 140634740336640 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:56.592744 140634740336640 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:56.592867 140634740336640 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:56.634919 140634740336640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:57.056558 140634740336640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:57.090718 140634740336640 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:57.100082 140634740336640 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:57.100355 140634740336640 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:57.100494 140634740336640 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:57.100650 140634740336640 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:57.100788 140634740336640 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:57.100913 140634740336640 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:57.100992 140634740336640 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:57.101299 140634740336640 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:57.101499 140634740336640 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:57.101648 140634740336640 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:57.101871 140634740336640 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:57.102233 140634740336640 dqn_agent.py:283] 	 seed: 1630605957100020
I0902 18:05:57.104538 140634740336640 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:57.104686 140634740336640 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:05:57.104817 140634740336640 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:57.105002 140634740336640 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:57.105109 140634740336640 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:57.105185 140634740336640 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:57.105296 140634740336640 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:57.105373 140634740336640 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:57.105496 140634740336640 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:57.135724 140634740336640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:57.156088 140634740336640 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:57.156334 140634740336640 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.80
I0902 18:06:03.744413 140634740336640 replay_runner.py:36] Average training steps per second: 151.80
Steps executed: 307 Episode length: 124 Return: -123.0
I0902 18:06:05.062351 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 1
I0902 18:06:05.296113 140634740336640 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 212.04

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:06:10.423123 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 18:06:10.666905 140634740336640 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 200.47
I0902 18:06:15.655787 140634740336640 replay_runner.py:36] Average training steps per second: 200.47
I0902 18:06:15.967938 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.67
INFO:tensorflow:Starting iteration 3

Steps executed: 419 Episode length: 224 Return: -223.0
INFO:tensorflow:Average training steps per second: 201.88
I0902 18:06:21.156379 140634740336640 replay_runner.py:36] Average training steps per second: 201.88
I0902 18:06:21.581412 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.02
I0902 18:06:26.828279 140634740336640 replay_runner.py:36] Average training steps per second: 200.02
I0902 18:06:27.043000 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 5

Steps executed: 269 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 194.25
I0902 18:06:32.421751 140634740336640 replay_runner.py:36] Average training steps per second: 194.25
I0902 18:06:32.655358 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.00
INFO:tensorflow:Starting iteration 6

Steps executed: 276 Episode length: 139 Return: -138.0
INFO:tensorflow:Average training steps per second: 199.62
I0902 18:06:37.912724 140634740336640 replay_runner.py:36] Average training steps per second: 199.62

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 7
I0902 18:06:38.605545 140634740336640 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.32
I0902 18:06:43.860145 140634740336640 replay_runner.py:36] Average training steps per second: 190.32
I0902 18:06:44.259160 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 209 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 192.00
I0902 18:06:49.706309 140634740336640 replay_runner.py:36] Average training steps per second: 192.00
I0902 18:06:49.884378 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.39
I0902 18:06:55.177214 140634740336640 replay_runner.py:36] Average training steps per second: 197.39
I0902 18:06:55.574544 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 622 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.07
I0902 18:07:01.131556 140634740336640 replay_runner.py:36] Average training steps per second: 188.07
I0902 18:07:01.623074 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.50
INFO:tensorflow:Starting iteration 11

Steps executed: 202 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 196.47
I0902 18:07:06.959470 140634740336640 replay_runner.py:36] Average training steps per second: 196.47
I0902 18:07:07.136724 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 12

Steps executed: 94 Episode length: 94 Return: -93.00.0
INFO:tensorflow:Average training steps per second: 192.68
I0902 18:07:12.577756 140634740336640 replay_runner.py:36] Average training steps per second: 192.68

Steps executed: 269 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Starting iteration 13

Steps executed: 267 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 196.40
I0902 18:07:18.121019 140634740336640 replay_runner.py:36] Average training steps per second: 196.40
I0902 18:07:18.354417 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 14

Steps executed: 260 Episode length: 98 Return: -97.000
INFO:tensorflow:Average training steps per second: 197.58
I0902 18:07:23.656023 140634740336640 replay_runner.py:36] Average training steps per second: 197.58
I0902 18:07:23.881710 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 15

Steps executed: 231 Episode length: 77 Return: -76.000
INFO:tensorflow:Average training steps per second: 195.64
I0902 18:07:29.241475 140634740336640 replay_runner.py:36] Average training steps per second: 195.64
I0902 18:07:29.427608 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 16


Steps executed: 228 Episode length: 75 Return: -74.000
INFO:tensorflow:Average training steps per second: 195.60
I0902 18:07:34.775394 140634740336640 replay_runner.py:36] Average training steps per second: 195.60
I0902 18:07:34.964949 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00
INFO:tensorflow:Starting iteration 17
I0902 18:07:35.207560 140634740336640 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 198.84
I0902 18:07:40.237158 140634740336640 replay_runner.py:36] Average training steps per second: 198.84

Steps executed: 227 Episode length: 111 Return: -110.0
INFO:tensorflow:Starting iteration 18

Steps executed: 257 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 193.43
I0902 18:07:45.807801 140634740336640 replay_runner.py:36] Average training steps per second: 193.43
I0902 18:07:46.014438 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 75 Return: -74.000
INFO:tensorflow:Average training steps per second: 199.79
I0902 18:07:51.238793 140634740336640 replay_runner.py:36] Average training steps per second: 199.79
I0902 18:07:51.430894 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 20

Steps executed: 204 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 192.88
I0902 18:07:56.855582 140634740336640 replay_runner.py:36] Average training steps per second: 192.88
I0902 18:07:57.010826 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 209.71
I0902 18:08:02.004716 140634740336640 replay_runner.py:36] Average training steps per second: 209.71
I0902 18:08:02.395895 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 244 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 191.80
I0902 18:08:07.843452 140634740336640 replay_runner.py:36] Average training steps per second: 191.80
I0902 18:08:08.025259 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 23
I0902 18:08:08.263695 140634740336640 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 205.19
I0902 18:08:13.137746 140634740336640 replay_runner.py:36] Average training steps per second: 205.19
I0902 18:08:13.316863 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.67
INFO:tensorflow:Starting iteration 24

Steps executed: 230 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 200.64
I0902 18:08:18.533917 140634740336640 replay_runner.py:36] Average training steps per second: 200.64
I0902 18:08:18.732380 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00

Steps executed: 252 Episode length: 70 Return: -69.0.0

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.47
I0902 18:08:24.058026 140634740336640 replay_runner.py:36] Average training steps per second: 196.47
I0902 18:08:24.438442 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 223 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 199.31
I0902 18:08:29.694916 140634740336640 replay_runner.py:36] Average training steps per second: 199.31
I0902 18:08:29.871479 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 27
I0902 18:08:30.105371 140634740336640 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 197.14
I0902 18:08:35.178181 140634740336640 replay_runner.py:36] Average training steps per second: 197.14
I0902 18:08:35.357902 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 28


Steps executed: 270 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 199.82
I0902 18:08:40.601587 140634740336640 replay_runner.py:36] Average training steps per second: 199.82
I0902 18:08:40.824674 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 196.61
I0902 18:08:46.157663 140634740336640 replay_runner.py:36] Average training steps per second: 196.61
I0902 18:08:46.386274 140634740336640 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33