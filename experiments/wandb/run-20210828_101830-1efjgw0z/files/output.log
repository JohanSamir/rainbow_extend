
Loaded trained dqn in lunarlander
I0828 10:18:37.061931 139825303013376 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:37.062541 139825303013376 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:37.134323 139825303013376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:37.135591 139825303013376 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:37.135677 139825303013376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:37.135751 139825303013376 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:37.135809 139825303013376 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:37.135895 139825303013376 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:37.135949 139825303013376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:37.136030 139825303013376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:37.136088 139825303013376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:37.136156 139825303013376 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:37.136231 139825303013376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:37.136283 139825303013376 dqn_agent.py:283] 	 seed: 1630145917134243
I0828 10:18:37.138098 139825303013376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:37.138273 139825303013376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:37.138360 139825303013376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:37.138439 139825303013376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:37.138498 139825303013376 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:37.138567 139825303013376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:37.138624 139825303013376 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:37.138720 139825303013376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:37.138792 139825303013376 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 5, please be patient, may be a while...
I0828 10:18:38.635647 139825303013376 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.975214 139825303013376 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.983807 139825303013376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.990148 139825303013376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.990297 139825303013376 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.990376 139825303013376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.990437 139825303013376 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.990492 139825303013376 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.990569 139825303013376 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:38.990655 139825303013376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.990750 139825303013376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.990828 139825303013376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.990905 139825303013376 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.990969 139825303013376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.991044 139825303013376 dqn_agent.py:283] 	 seed: 1630145918990096
I0828 10:18:38.992538 139825303013376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.992652 139825303013376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:38.992723 139825303013376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.992786 139825303013376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.992851 139825303013376 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.992924 139825303013376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.992997 139825303013376 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.993089 139825303013376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.993160 139825303013376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:39.010915 139825303013376 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:39.022647 139825303013376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:39.022844 139825303013376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 168.61
I0828 10:18:44.954234 139825303013376 replay_runner.py:36] Average training steps per second: 168.61
Steps executed: 253 Episode length: 73 Return: -674.3370338723777
I0828 10:18:45.890166 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -503.09
INFO:tensorflow:Starting iteration 1

Steps executed: 211 Episode length: 114 Return: -13.082118991441533
INFO:tensorflow:Average training steps per second: 211.13
I0828 10:18:54.895624 139825303013376 replay_runner.py:36] Average training steps per second: 211.13
I0828 10:18:55.079120 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.95
INFO:tensorflow:Starting iteration 2

Steps executed: 265 Episode length: 68 Return: -127.469209183215243
INFO:tensorflow:Average training steps per second: 209.71
I0828 10:19:04.170619 139825303013376 replay_runner.py:36] Average training steps per second: 209.71
I0828 10:19:04.417876 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.30
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 61 Return: -132.782482414576753
INFO:tensorflow:Average training steps per second: 214.77
I0828 10:19:13.300189 139825303013376 replay_runner.py:36] Average training steps per second: 214.77
I0828 10:19:13.472470 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.74
INFO:tensorflow:Starting iteration 4

Steps executed: 245 Episode length: 51 Return: -117.417314568966453
INFO:tensorflow:Average training steps per second: 213.33
I0828 10:19:22.451895 139825303013376 replay_runner.py:36] Average training steps per second: 213.33
I0828 10:19:22.615699 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.03
INFO:tensorflow:Starting iteration 5

Steps executed: 241 Episode length: 53 Return: -81.7558259706788483
INFO:tensorflow:Average training steps per second: 213.03
I0828 10:19:31.582032 139825303013376 replay_runner.py:36] Average training steps per second: 213.03
I0828 10:19:31.730169 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.33
INFO:tensorflow:Starting iteration 6

Steps executed: 124 Episode length: 124 Return: -292.36159325269473
INFO:tensorflow:Average training steps per second: 211.20

Steps executed: 272 Episode length: 148 Return: -592.15929320567153
I0828 10:19:40.899786 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.26
INFO:tensorflow:Starting iteration 7

Steps executed: 202 Episode length: 91 Return: -81.7916886957647853
INFO:tensorflow:Average training steps per second: 216.31
I0828 10:19:49.802196 139825303013376 replay_runner.py:36] Average training steps per second: 216.31
I0828 10:19:49.930583 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.15
INFO:tensorflow:Starting iteration 8

Steps executed: 68 Episode length: 68 Return: -541.3869817082989853
INFO:tensorflow:Average training steps per second: 215.43

Steps executed: 229 Episode length: 53 Return: -307.483917612065063
I0828 10:19:58.983242 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.99
INFO:tensorflow:Starting iteration 9

Steps executed: 222 Episode length: 69 Return: -239.509053718930563
INFO:tensorflow:Average training steps per second: 214.19
I0828 10:20:07.790739 139825303013376 replay_runner.py:36] Average training steps per second: 214.19
I0828 10:20:07.973189 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.59
INFO:tensorflow:Starting iteration 10

Steps executed: 153 Episode length: 63 Return: -603.771037006324463
INFO:tensorflow:Average training steps per second: 215.71
I0828 10:20:16.814245 139825303013376 replay_runner.py:36] Average training steps per second: 215.71

Steps executed: 222 Episode length: 69 Return: -479.036991092954463
INFO:tensorflow:Starting iteration 11

Steps executed: 229 Episode length: 71 Return: -493.280727636815873
INFO:tensorflow:Average training steps per second: 215.59
I0828 10:20:25.780035 139825303013376 replay_runner.py:36] Average training steps per second: 215.59
I0828 10:20:25.989319 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -700.64
INFO:tensorflow:Starting iteration 12
I0828 10:20:30.253342 139825303013376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 214.56

Steps executed: 263 Episode length: 121 Return: -806.12043979590343
I0828 10:20:35.167148 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -731.66
INFO:tensorflow:Starting iteration 13

Steps executed: 351 Episode length: 175 Return: -1478.4642406423746
INFO:tensorflow:Average training steps per second: 218.15
I0828 10:20:44.060056 139825303013376 replay_runner.py:36] Average training steps per second: 218.15
I0828 10:20:44.423303 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -1311.39
INFO:tensorflow:Starting iteration 14

Steps executed: 273 Episode length: 87 Return: -504.877645014108986
INFO:tensorflow:Average training steps per second: 216.67
I0828 10:20:53.380198 139825303013376 replay_runner.py:36] Average training steps per second: 216.67
I0828 10:20:53.658337 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -800.22
INFO:tensorflow:Starting iteration 15

Steps executed: 241 Episode length: 69 Return: -597.102715004182386
INFO:tensorflow:Average training steps per second: 222.41
I0828 10:21:02.427379 139825303013376 replay_runner.py:36] Average training steps per second: 222.41
I0828 10:21:02.624505 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.38
INFO:tensorflow:Starting iteration 16

Steps executed: 230 Episode length: 107 Return: -447.25515068527926
INFO:tensorflow:Average training steps per second: 220.43
I0828 10:21:11.401092 139825303013376 replay_runner.py:36] Average training steps per second: 220.43
I0828 10:21:11.579930 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.45
INFO:tensorflow:Starting iteration 17

Steps executed: 289 Episode length: 166 Return: -243.57451531575182
INFO:tensorflow:Average training steps per second: 220.81
I0828 10:21:20.360293 139825303013376 replay_runner.py:36] Average training steps per second: 220.81
I0828 10:21:20.608989 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -518.97
INFO:tensorflow:Starting iteration 18

Steps executed: 242 Episode length: 86 Return: -480.188861588912742
INFO:tensorflow:Average training steps per second: 237.49
I0828 10:21:29.051545 139825303013376 replay_runner.py:36] Average training steps per second: 237.49
I0828 10:21:29.187855 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.75
INFO:tensorflow:Starting iteration 19

Steps executed: 279 Episode length: 93 Return: -717.662089382461162
INFO:tensorflow:Average training steps per second: 265.23
I0828 10:21:36.865365 139825303013376 replay_runner.py:36] Average training steps per second: 265.23
I0828 10:21:37.051353 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -602.71
INFO:tensorflow:Starting iteration 20

Steps executed: 94 Episode length: 94 Return: -479.6635377624220462
INFO:tensorflow:Average training steps per second: 242.35

Steps executed: 264 Episode length: 170 Return: -1157.9308634148162
I0828 10:21:45.512198 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -818.80
INFO:tensorflow:Starting iteration 21

Steps executed: 275 Episode length: 167 Return: -1110.9446509471322
INFO:tensorflow:Average training steps per second: 225.47
I0828 10:21:54.151942 139825303013376 replay_runner.py:36] Average training steps per second: 225.47
I0828 10:21:54.444164 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -942.79
INFO:tensorflow:Starting iteration 22

Steps executed: 209 Episode length: 61 Return: -391.852770676020132
INFO:tensorflow:Average training steps per second: 220.85
I0828 10:22:03.250109 139825303013376 replay_runner.py:36] Average training steps per second: 220.85
I0828 10:22:03.422826 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.94
INFO:tensorflow:Starting iteration 23

Steps executed: 282 Episode length: 106 Return: -439.25239348615486
INFO:tensorflow:Average training steps per second: 223.16
I0828 10:22:12.196620 139825303013376 replay_runner.py:36] Average training steps per second: 223.16
I0828 10:22:12.455324 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.86
INFO:tensorflow:Starting iteration 24

Steps executed: 219 Episode length: 59 Return: -452.061497671515756
INFO:tensorflow:Average training steps per second: 224.26
I0828 10:22:21.136252 139825303013376 replay_runner.py:36] Average training steps per second: 224.26
I0828 10:22:21.345712 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.77
INFO:tensorflow:Starting iteration 25

Steps executed: 278 Episode length: 95 Return: -627.708139517313856
INFO:tensorflow:Average training steps per second: 223.82
I0828 10:22:30.052084 139825303013376 replay_runner.py:36] Average training steps per second: 223.82
I0828 10:22:30.312056 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -566.43
INFO:tensorflow:Starting iteration 26
I0828 10:22:34.581619 139825303013376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 221.32
I0828 10:22:39.101011 139825303013376 replay_runner.py:36] Average training steps per second: 221.32

Steps executed: 207 Episode length: 69 Return: -145.620538493849326
INFO:tensorflow:Starting iteration 27

Steps executed: 269 Episode length: 70 Return: -697.485716874781726
INFO:tensorflow:Average training steps per second: 220.60
I0828 10:22:48.062708 139825303013376 replay_runner.py:36] Average training steps per second: 220.60
I0828 10:22:48.299479 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -639.75
INFO:tensorflow:Starting iteration 28
I0828 10:22:52.620974 139825303013376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 217.49

Steps executed: 428 Episode length: 248 Return: -2215.2682906146297
I0828 10:22:57.682712 139825303013376 run_experiment.py:428] Average undiscounted return per evaluation episode: -1032.95
INFO:tensorflow:Starting iteration 29

Steps executed: 205 Episode length: 75 Return: -120.912650046640667
INFO:tensorflow:Average training steps per second: 220.92
I0828 10:23:06.499553 139825303013376 replay_runner.py:36] Average training steps per second: 220.92

Done fixed training!Episode length: 75 Return: -120.912650046640667