Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 23:34:50.640404 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0901 23:34:50.652869 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:34:50.653131 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:34:50.653287 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:34:50.653415 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:34:50.653532 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:34:50.653651 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:34:50.653761 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:34:50.653879 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:34:50.653986 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:34:50.654151 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:34:50.654279 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:34:50.654482 139965167532032 dqn_agent.py:283] 	 seed: 1630539290652805
I0901 23:34:50.657776 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:34:50.657976 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:34:50.658151 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:34:50.658290 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:34:50.658408 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:34:50.658516 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:34:50.658637 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:34:50.658746 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:34:50.658849 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:34:50.696794 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:34:51.108672 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:34:51.123445 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:34:51.155445 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:34:51.155734 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:34:51.155906 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:34:51.156031 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:34:51.156145 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:34:51.156257 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:34:51.156515 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:34:51.156652 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:34:51.156816 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:34:51.156948 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:34:51.157061 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:34:51.157167 139965167532032 dqn_agent.py:283] 	 seed: 1630539291155387
I0901 23:34:51.160363 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:34:51.160554 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:34:51.160683 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:34:51.160799 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:34:51.160908 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:34:51.161014 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:34:51.161127 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:34:51.161232 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:34:51.161387 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:34:51.191311 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:34:51.218099 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:34:51.218479 139965167532032 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 167.37
I0901 23:34:57.193839 139965167532032 replay_runner.py:36] Average training steps per second: 167.37
Steps executed: 236 Episode length: 103 Return: -683.6184251146265
I0901 23:34:58.385896 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.40
INFO:tensorflow:Starting iteration 1

Steps executed: 275 Episode length: 87 Return: -144.75206895030573
INFO:tensorflow:Average training steps per second: 241.76
I0901 23:35:06.792840 139965167532032 replay_runner.py:36] Average training steps per second: 241.76
I0901 23:35:06.961176 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.90
INFO:tensorflow:Starting iteration 2

Steps executed: 207 Episode length: 90 Return: -170.53581683588484
INFO:tensorflow:Average training steps per second: 269.31
I0901 23:35:14.929582 139965167532032 replay_runner.py:36] Average training steps per second: 269.31
I0901 23:35:15.035861 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.01
INFO:tensorflow:Starting iteration 3

Steps executed: 279 Episode length: 87 Return: -120.77124849904018
INFO:tensorflow:Average training steps per second: 241.56
I0901 23:35:23.320645 139965167532032 replay_runner.py:36] Average training steps per second: 241.56
I0901 23:35:23.477690 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.41
INFO:tensorflow:Starting iteration 4

Steps executed: 231 Episode length: 63 Return: -133.29080894926417
INFO:tensorflow:Average training steps per second: 236.58
I0901 23:35:31.936019 139965167532032 replay_runner.py:36] Average training steps per second: 236.58
I0901 23:35:32.083451 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.27
INFO:tensorflow:Starting iteration 5

Steps executed: 219 Episode length: 50 Return: -131.78874524421155
INFO:tensorflow:Average training steps per second: 218.23
I0901 23:35:41.068439 139965167532032 replay_runner.py:36] Average training steps per second: 218.23
I0901 23:35:41.212526 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.26
INFO:tensorflow:Starting iteration 6

Steps executed: 228 Episode length: 84 Return: -180.31918729311676
INFO:tensorflow:Average training steps per second: 229.42
I0901 23:35:50.020996 139965167532032 replay_runner.py:36] Average training steps per second: 229.42
I0901 23:35:50.167881 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.63
INFO:tensorflow:Starting iteration 7

Steps executed: 233 Episode length: 80 Return: -171.91380461756487
INFO:tensorflow:Average training steps per second: 232.82
I0901 23:35:59.002415 139965167532032 replay_runner.py:36] Average training steps per second: 232.82
I0901 23:35:59.150189 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.31
INFO:tensorflow:Starting iteration 8

Steps executed: 242 Episode length: 67 Return: -140.24550136692642
INFO:tensorflow:Average training steps per second: 231.28
I0901 23:36:07.861866 139965167532032 replay_runner.py:36] Average training steps per second: 231.28
I0901 23:36:08.007278 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.65
INFO:tensorflow:Starting iteration 9

Steps executed: 251 Episode length: 80 Return: 6.25182743554592107
INFO:tensorflow:Average training steps per second: 228.12
I0901 23:36:16.819092 139965167532032 replay_runner.py:36] Average training steps per second: 228.12
I0901 23:36:16.982358 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.60
INFO:tensorflow:Starting iteration 10

Steps executed: 220 Episode length: 56 Return: -119.11283260796023
INFO:tensorflow:Average training steps per second: 230.91
I0901 23:36:25.739395 139965167532032 replay_runner.py:36] Average training steps per second: 230.91
I0901 23:36:25.886016 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.93
INFO:tensorflow:Starting iteration 11
I0901 23:36:30.209778 139965167532032 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 225.06
I0901 23:36:34.653466 139965167532032 replay_runner.py:36] Average training steps per second: 225.06

Steps executed: 222 Episode length: 91 Return: -95.576933955443625
INFO:tensorflow:Starting iteration 12

Steps executed: 274 Episode length: 82 Return: -154.73978731157416
INFO:tensorflow:Average training steps per second: 228.64
I0901 23:36:43.431181 139965167532032 replay_runner.py:36] Average training steps per second: 228.64
I0901 23:36:43.611357 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.13
INFO:tensorflow:Starting iteration 13

Steps executed: 215 Episode length: 61 Return: -109.30826801837244
INFO:tensorflow:Average training steps per second: 227.04
I0901 23:36:52.473373 139965167532032 replay_runner.py:36] Average training steps per second: 227.04
I0901 23:36:52.609997 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.95
INFO:tensorflow:Starting iteration 14

Steps executed: 206 Episode length: 55 Return: -128.47570686231109
INFO:tensorflow:Average training steps per second: 225.97
I0901 23:37:01.426935 139965167532032 replay_runner.py:36] Average training steps per second: 225.97
I0901 23:37:01.562087 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.08
INFO:tensorflow:Starting iteration 15

Steps executed: 204 Episode length: 66 Return: -124.04002863743557
INFO:tensorflow:Average training steps per second: 229.57
I0901 23:37:10.377180 139965167532032 replay_runner.py:36] Average training steps per second: 229.57
I0901 23:37:10.503088 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.18
INFO:tensorflow:Starting iteration 16

Steps executed: 211 Episode length: 78 Return: -150.97372976695233
INFO:tensorflow:Average training steps per second: 230.01
I0901 23:37:19.272230 139965167532032 replay_runner.py:36] Average training steps per second: 230.01
I0901 23:37:19.398085 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.47
INFO:tensorflow:Starting iteration 17

Steps executed: 201 Episode length: 86 Return: -158.011179464049275
INFO:tensorflow:Average training steps per second: 229.48
I0901 23:37:28.143215 139965167532032 replay_runner.py:36] Average training steps per second: 229.48
I0901 23:37:28.268159 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.52
INFO:tensorflow:Starting iteration 18

Steps executed: 218 Episode length: 87 Return: -128.359426474747445
INFO:tensorflow:Average training steps per second: 227.56
I0901 23:37:37.103887 139965167532032 replay_runner.py:36] Average training steps per second: 227.56
I0901 23:37:37.244364 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.49
INFO:tensorflow:Starting iteration 19

Steps executed: 214 Episode length: 61 Return: -138.871637683728355
INFO:tensorflow:Average training steps per second: 230.29
I0901 23:37:46.014646 139965167532032 replay_runner.py:36] Average training steps per second: 230.29
I0901 23:37:46.156267 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.35
INFO:tensorflow:Starting iteration 20

Steps executed: 238 Episode length: 78 Return: -117.558001818860365
INFO:tensorflow:Average training steps per second: 228.12
I0901 23:37:55.007431 139965167532032 replay_runner.py:36] Average training steps per second: 228.12
I0901 23:37:55.159909 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.16
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 86 Return: -125.959305082737875
INFO:tensorflow:Average training steps per second: 240.93
I0901 23:38:03.527828 139965167532032 replay_runner.py:36] Average training steps per second: 240.93
I0901 23:38:03.683558 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.94
INFO:tensorflow:Starting iteration 22

Steps executed: 208 Episode length: 61 Return: -151.261688250995465
INFO:tensorflow:Average training steps per second: 234.64
I0901 23:38:12.304542 139965167532032 replay_runner.py:36] Average training steps per second: 234.64
I0901 23:38:12.417366 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.08
INFO:tensorflow:Starting iteration 23
I0901 23:38:16.650474 139965167532032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 239.17

Steps executed: 209 Episode length: 62 Return: -156.474129249813025
I0901 23:38:20.949712 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.40
INFO:tensorflow:Starting iteration 24

Steps executed: 265 Episode length: 67 Return: -160.210759934855335
INFO:tensorflow:Average training steps per second: 237.22
I0901 23:38:29.397733 139965167532032 replay_runner.py:36] Average training steps per second: 237.22
I0901 23:38:29.535629 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.75
INFO:tensorflow:Starting iteration 25

Steps executed: 239 Episode length: 64 Return: -140.870401276538935
INFO:tensorflow:Average training steps per second: 227.75
I0901 23:38:38.025812 139965167532032 replay_runner.py:36] Average training steps per second: 227.75
I0901 23:38:38.160994 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 26
I0901 23:38:42.498070 139965167532032 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 224.67

Steps executed: 206 Episode length: 64 Return: -140.838405079895935
I0901 23:38:47.074224 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.36
INFO:tensorflow:Starting iteration 27

Steps executed: 250 Episode length: 62 Return: -81.5949925993425365
INFO:tensorflow:Average training steps per second: 228.49
I0901 23:38:55.831546 139965167532032 replay_runner.py:36] Average training steps per second: 228.49
I0901 23:38:56.000335 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.34
INFO:tensorflow:Starting iteration 28

Steps executed: 202 Episode length: 75 Return: -169.688796173698025
INFO:tensorflow:Average training steps per second: 231.47
I0901 23:39:04.760562 139965167532032 replay_runner.py:36] Average training steps per second: 231.47
I0901 23:39:04.885644 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.09
INFO:tensorflow:Starting iteration 29

Steps executed: 264 Episode length: 66 Return: -138.381058335207775
INFO:tensorflow:Average training steps per second: 233.98
I0901 23:39:13.552862 139965167532032 replay_runner.py:36] Average training steps per second: 233.98

Done fixed training!Episode length: 66 Return: -138.381058335207775