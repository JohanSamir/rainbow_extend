Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 00:34:35.496549 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:35.504261 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:35.504399 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:35.504481 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:35.504550 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:35.504612 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:35.504698 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:35.504763 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:35.504859 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:35.504929 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:35.505036 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:35.505097 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:35.505189 139965167532032 dqn_agent.py:283] 	 seed: 1630542875504226
I0902 00:34:35.507266 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:35.507388 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:35.507498 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:35.507562 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:35.507620 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:35.507709 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:35.507829 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:35.507923 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:35.508006 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:35.532465 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:35.795941 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:35.806068 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:35.812238 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:35.812387 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:35.812481 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:35.812542 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:35.812598 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:35.812675 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:35.812742 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:35.812937 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:35.813007 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:35.813061 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:35.813134 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:35.813220 139965167532032 dqn_agent.py:283] 	 seed: 1630542875812204
I0902 00:34:35.815191 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:35.815308 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:35.815381 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:35.815478 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:35.815643 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:35.815773 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:35.815940 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:35.816021 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:35.816110 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:35.837734 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:35.853626 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:35.853834 139965167532032 replay_runner.py:41] Starting iteration 0
Steps executed: 512 Episode length: 318 Return: -117.78906807434404
INFO:tensorflow:Average training steps per second: 263.92
I0902 00:34:39.643167 139965167532032 replay_runner.py:36] Average training steps per second: 263.92
I0902 00:34:40.596780 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.40
INFO:tensorflow:Starting iteration 1

Steps executed: 284 Episode length: 115 Return: -405.77867868419604
INFO:tensorflow:Average training steps per second: 354.53
I0902 00:34:46.768542 139965167532032 replay_runner.py:36] Average training steps per second: 354.53
I0902 00:34:46.919270 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.72
INFO:tensorflow:Starting iteration 2

Steps executed: 428 Episode length: 264 Return: -426.27826198628713
INFO:tensorflow:Average training steps per second: 337.55
I0902 00:34:53.231541 139965167532032 replay_runner.py:36] Average training steps per second: 337.55
I0902 00:34:53.543018 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.49
INFO:tensorflow:Starting iteration 3

Steps executed: 256 Episode length: 163 Return: -655.92414059840713
INFO:tensorflow:Average training steps per second: 345.07
I0902 00:34:59.803642 139965167532032 replay_runner.py:36] Average training steps per second: 345.07
I0902 00:34:59.959681 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -554.49
INFO:tensorflow:Starting iteration 4

Steps executed: 247 Episode length: 74 Return: -572.606883091781193
INFO:tensorflow:Average training steps per second: 343.46
I0902 00:35:06.243683 139965167532032 replay_runner.py:36] Average training steps per second: 343.46
I0902 00:35:06.385787 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.53
INFO:tensorflow:Starting iteration 5

Steps executed: 313 Episode length: 206 Return: -176.22383996109667
INFO:tensorflow:Average training steps per second: 338.47
I0902 00:35:12.798460 139965167532032 replay_runner.py:36] Average training steps per second: 338.47
I0902 00:35:13.030171 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.74
INFO:tensorflow:Starting iteration 6
I0902 00:35:16.481451 139965167532032 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 351.20

Steps executed: 309 Episode length: 309 Return: -234.12415183159933
I0902 00:35:19.610675 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.12
INFO:tensorflow:Starting iteration 7

Steps executed: 496 Episode length: 496 Return: -337.38054353901236
INFO:tensorflow:Average training steps per second: 348.30
I0902 00:35:25.921086 139965167532032 replay_runner.py:36] Average training steps per second: 348.30
I0902 00:35:26.621261 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.38
INFO:tensorflow:Starting iteration 8
I0902 00:35:30.053488 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 349.34

Steps executed: 585 Episode length: 585 Return: -206.02781904512736
I0902 00:35:33.746324 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.03
INFO:tensorflow:Starting iteration 9
I0902 00:35:37.128561 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 351.45

Steps executed: 941 Episode length: 941 Return: -449.36863919307226
I0902 00:35:41.839642 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.37
INFO:tensorflow:Starting iteration 10

Steps executed: 245 Episode length: 88 Return: -440.324891860282733
INFO:tensorflow:Average training steps per second: 320.40
I0902 00:35:48.246088 139965167532032 replay_runner.py:36] Average training steps per second: 320.40
I0902 00:35:48.385472 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.68
INFO:tensorflow:Starting iteration 11

Steps executed: 316 Episode length: 125 Return: -84.633632058369643
INFO:tensorflow:Average training steps per second: 325.01
I0902 00:35:54.716191 139965167532032 replay_runner.py:36] Average training steps per second: 325.01
I0902 00:35:54.921224 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.63
INFO:tensorflow:Starting iteration 12

Steps executed: 337 Episode length: 202 Return: -672.62649325514366
INFO:tensorflow:Average training steps per second: 337.72
I0902 00:36:01.225805 139965167532032 replay_runner.py:36] Average training steps per second: 337.72
I0902 00:36:01.446575 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.76
INFO:tensorflow:Starting iteration 13

Steps executed: 618 Episode length: 618 Return: -292.86869704879575
INFO:tensorflow:Average training steps per second: 345.91
I0902 00:36:07.694379 139965167532032 replay_runner.py:36] Average training steps per second: 345.91
I0902 00:36:08.652624 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.87
INFO:tensorflow:Starting iteration 14

Steps executed: 227 Episode length: 140 Return: -118.19360526732571
INFO:tensorflow:Average training steps per second: 342.37
I0902 00:36:14.961140 139965167532032 replay_runner.py:36] Average training steps per second: 342.37
I0902 00:36:15.115339 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.42
INFO:tensorflow:Starting iteration 15

Steps executed: 327 Episode length: 183 Return: -464.29537075398474
INFO:tensorflow:Average training steps per second: 339.93
I0902 00:36:21.464241 139965167532032 replay_runner.py:36] Average training steps per second: 339.93
I0902 00:36:21.672104 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -457.48
INFO:tensorflow:Starting iteration 16

Steps executed: 430 Episode length: 304 Return: -216.77418873510962
INFO:tensorflow:Average training steps per second: 334.79
I0902 00:36:28.047095 139965167532032 replay_runner.py:36] Average training steps per second: 334.79
I0902 00:36:28.406805 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.54
INFO:tensorflow:Starting iteration 17

Steps executed: 229 Episode length: 81 Return: -379.299919362509562
INFO:tensorflow:Average training steps per second: 328.40
I0902 00:36:34.793422 139965167532032 replay_runner.py:36] Average training steps per second: 328.40
I0902 00:36:34.923296 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.75
INFO:tensorflow:Starting iteration 18
I0902 00:36:38.323332 139965167532032 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 332.00
I0902 00:36:41.335692 139965167532032 replay_runner.py:36] Average training steps per second: 332.00

Steps executed: 221 Episode length: 85 Return: -421.632425258557132
INFO:tensorflow:Starting iteration 19
I0902 00:36:44.757889 139965167532032 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 326.57

Steps executed: 311 Episode length: 130 Return: -1067.6942412049418
I0902 00:36:48.015565 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -734.72
INFO:tensorflow:Starting iteration 20

Steps executed: 250 Episode length: 55 Return: -265.185740954640118
INFO:tensorflow:Average training steps per second: 325.83
I0902 00:36:54.432574 139965167532032 replay_runner.py:36] Average training steps per second: 325.83
I0902 00:36:54.571065 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.29
INFO:tensorflow:Starting iteration 21

Steps executed: 241 Episode length: 86 Return: -50.3390284722323418
INFO:tensorflow:Average training steps per second: 325.51
I0902 00:37:01.016603 139965167532032 replay_runner.py:36] Average training steps per second: 325.51
I0902 00:37:01.146381 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.07
INFO:tensorflow:Starting iteration 22
I0902 00:37:04.530677 139965167532032 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 330.08
I0902 00:37:07.560711 139965167532032 replay_runner.py:36] Average training steps per second: 330.08

Steps executed: 235 Episode length: 89 Return: -688.772853523233418
INFO:tensorflow:Starting iteration 23

Steps executed: 246 Episode length: 85 Return: -719.087495737288468
INFO:tensorflow:Average training steps per second: 329.13
I0902 00:37:14.105576 139965167532032 replay_runner.py:36] Average training steps per second: 329.13
I0902 00:37:14.242035 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -594.51
INFO:tensorflow:Starting iteration 24

Steps executed: 213 Episode length: 68 Return: -668.006594045053678
INFO:tensorflow:Average training steps per second: 327.63
I0902 00:37:20.664346 139965167532032 replay_runner.py:36] Average training steps per second: 327.63
I0902 00:37:20.795566 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -632.66
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 58 Return: -412.264990826869348
INFO:tensorflow:Average training steps per second: 336.62
I0902 00:37:27.156565 139965167532032 replay_runner.py:36] Average training steps per second: 336.62
I0902 00:37:27.307668 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.60
INFO:tensorflow:Starting iteration 26

Steps executed: 204 Episode length: 68 Return: -526.090489125451348
INFO:tensorflow:Average training steps per second: 348.93
I0902 00:37:33.559423 139965167532032 replay_runner.py:36] Average training steps per second: 348.93
I0902 00:37:33.675729 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.14
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 52 Return: -329.651934055655158
INFO:tensorflow:Average training steps per second: 347.93
I0902 00:37:39.967776 139965167532032 replay_runner.py:36] Average training steps per second: 347.93
I0902 00:37:40.086279 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.89
INFO:tensorflow:Starting iteration 28

Steps executed: 273 Episode length: 74 Return: -727.396421957615558
INFO:tensorflow:Average training steps per second: 338.35
I0902 00:37:46.401254 139965167532032 replay_runner.py:36] Average training steps per second: 338.35
I0902 00:37:46.555711 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -639.73
INFO:tensorflow:Starting iteration 29

Steps executed: 266 Episode length: 73 Return: -514.994645970624258
INFO:tensorflow:Average training steps per second: 346.53
I0902 00:37:52.825942 139965167532032 replay_runner.py:36] Average training steps per second: 346.53

Done fixed training!Episode length: 73 Return: -514.994645970624258