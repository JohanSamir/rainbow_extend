Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 00:15:04.473554 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:15:04.483190 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:04.483430 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:04.483533 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:04.483643 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:04.483805 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:04.483925 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:04.484005 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:04.484104 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:04.484222 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:04.484345 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:04.484451 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:04.484548 139965167532032 dqn_agent.py:283] 	 seed: 1630541704483115
I0902 00:15:04.487834 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:04.488024 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:04.488115 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:04.488185 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:04.488266 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:04.488443 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:04.488646 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:04.488766 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:04.488868 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:04.522828 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:04.863001 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:04.877592 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:15:04.887888 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:04.888123 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:04.888270 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:04.888384 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:04.888495 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:04.888634 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:04.888974 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:04.889281 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:04.889457 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:04.889590 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:04.889738 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:04.889902 139965167532032 dqn_agent.py:283] 	 seed: 1630541704887825
I0902 00:15:04.892393 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:04.892511 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:04.892586 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:04.892651 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:04.892716 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:04.892799 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:04.892860 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:04.892952 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:04.893023 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:04.921452 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:04.950259 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:15:04.950655 139965167532032 replay_runner.py:41] Starting iteration 0
Steps executed: 211 Episode length: 119 Return: -580.1394721173845
INFO:tensorflow:Average training steps per second: 178.22
I0902 00:15:10.561951 139965167532032 replay_runner.py:36] Average training steps per second: 178.22
I0902 00:15:11.697268 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.93
INFO:tensorflow:Starting iteration 1
I0902 00:15:16.022713 139965167532032 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 234.91
I0902 00:15:20.280150 139965167532032 replay_runner.py:36] Average training steps per second: 234.91

Steps executed: 232 Episode length: 109 Return: -357.30467161788204
INFO:tensorflow:Starting iteration 2

Steps executed: 279 Episode length: 153 Return: -492.75508466815694
INFO:tensorflow:Average training steps per second: 227.74
I0902 00:15:29.051284 139965167532032 replay_runner.py:36] Average training steps per second: 227.74
I0902 00:15:29.304153 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.23
INFO:tensorflow:Starting iteration 3
I0902 00:15:33.569026 139965167532032 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 224.40

Steps executed: 604 Episode length: 604 Return: -299.91131975481034
I0902 00:15:39.067488 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.91
INFO:tensorflow:Starting iteration 4
I0902 00:15:43.481581 139965167532032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 227.29

Steps executed: 1000 Episode length: 1000 Return: -37.168830149872576
I0902 00:15:51.108756 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -37.17
INFO:tensorflow:Starting iteration 5
I0902 00:15:55.523109 139965167532032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 229.20

Steps executed: 1000 Episode length: 1000 Return: -44.491128171324546
I0902 00:16:02.919834 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.49
INFO:tensorflow:Starting iteration 6
I0902 00:16:07.263140 139965167532032 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 231.32

Steps executed: 1000 Episode length: 1000 Return: -11.889471763377195
I0902 00:16:15.472162 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -11.89
INFO:tensorflow:Starting iteration 7
I0902 00:16:19.843177 139965167532032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 227.40

Steps executed: 487 Episode length: 487 Return: -431.1311196193228195
I0902 00:16:24.981402 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.13
INFO:tensorflow:Starting iteration 8
I0902 00:16:29.254293 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 238.97

Steps executed: 592 Episode length: 592 Return: -430.4414558503241195
I0902 00:16:34.682516 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.44
INFO:tensorflow:Starting iteration 9

Steps executed: 698 Episode length: 698 Return: -367.2025723425492195
INFO:tensorflow:Average training steps per second: 245.00
I0902 00:16:43.156229 139965167532032 replay_runner.py:36] Average training steps per second: 245.00
I0902 00:16:44.299877 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.20
INFO:tensorflow:Starting iteration 10
I0902 00:16:48.581114 139965167532032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 245.19

Steps executed: 1000 Episode length: 1000 Return: -93.590376089210625
I0902 00:16:55.074414 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.59
INFO:tensorflow:Starting iteration 11
I0902 00:16:59.245536 139965167532032 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 253.75

Steps executed: 1000 Episode length: 1000 Return: -157.86548340307145
I0902 00:17:06.159361 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.87
INFO:tensorflow:Starting iteration 12

Steps executed: 331 Episode length: 135 Return: -137.3552904456185545
INFO:tensorflow:Average training steps per second: 252.20
I0902 00:17:14.235685 139965167532032 replay_runner.py:36] Average training steps per second: 252.20
I0902 00:17:14.482193 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.86
INFO:tensorflow:Starting iteration 13

Steps executed: 435 Episode length: 435 Return: -54.89096034065373445
INFO:tensorflow:Average training steps per second: 252.18
I0902 00:17:22.601444 139965167532032 replay_runner.py:36] Average training steps per second: 252.18
I0902 00:17:23.204344 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.89
INFO:tensorflow:Starting iteration 14

Steps executed: 459 Episode length: 459 Return: -293.1104296563306745
INFO:tensorflow:Average training steps per second: 250.16
I0902 00:17:31.292895 139965167532032 replay_runner.py:36] Average training steps per second: 250.16
I0902 00:17:31.945964 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.11
INFO:tensorflow:Starting iteration 15

Steps executed: 303 Episode length: 154 Return: -37.00610186876956645
INFO:tensorflow:Average training steps per second: 258.70
I0902 00:17:39.798321 139965167532032 replay_runner.py:36] Average training steps per second: 258.70
I0902 00:17:40.028956 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.66
INFO:tensorflow:Starting iteration 16

Steps executed: 252 Episode length: 102 Return: -520.4466359603266645
INFO:tensorflow:Average training steps per second: 256.57
I0902 00:17:47.945993 139965167532032 replay_runner.py:36] Average training steps per second: 256.57
I0902 00:17:48.129660 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.42
INFO:tensorflow:Starting iteration 17

Steps executed: 205 Episode length: 51 Return: -92.939272904167246645
INFO:tensorflow:Average training steps per second: 278.24
I0902 00:17:55.635318 139965167532032 replay_runner.py:36] Average training steps per second: 278.24
I0902 00:17:55.744754 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.75
INFO:tensorflow:Starting iteration 18
I0902 00:17:59.450050 139965167532032 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 305.62

Steps executed: 525 Episode length: 376 Return: -286.4392791293747645
I0902 00:18:03.235443 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.35
INFO:tensorflow:Starting iteration 19

Steps executed: 237 Episode length: 93 Return: -355.86362434965326645
INFO:tensorflow:Average training steps per second: 305.59
I0902 00:18:10.157286 139965167532032 replay_runner.py:36] Average training steps per second: 305.59
I0902 00:18:10.309697 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.91
INFO:tensorflow:Starting iteration 20

Steps executed: 240 Episode length: 93 Return: -796.19310437190323645
INFO:tensorflow:Average training steps per second: 322.58
I0902 00:18:17.016494 139965167532032 replay_runner.py:36] Average training steps per second: 322.58
I0902 00:18:17.148300 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -574.74
INFO:tensorflow:Starting iteration 21

Steps executed: 207 Episode length: 207 Return: -360.7866013395508645
INFO:tensorflow:Average training steps per second: 330.52
I0902 00:18:23.717883 139965167532032 replay_runner.py:36] Average training steps per second: 330.52
I0902 00:18:23.839050 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.79
INFO:tensorflow:Starting iteration 22

Steps executed: 217 Episode length: 61 Return: -124.69668035209543645
INFO:tensorflow:Average training steps per second: 333.40
I0902 00:18:30.369307 139965167532032 replay_runner.py:36] Average training steps per second: 333.40
I0902 00:18:30.468049 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.58
INFO:tensorflow:Starting iteration 23

Steps executed: 367 Episode length: 212 Return: -106.5700458733065545
INFO:tensorflow:Average training steps per second: 333.57
I0902 00:18:36.953485 139965167532032 replay_runner.py:36] Average training steps per second: 333.57
I0902 00:18:37.162768 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.50
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 155 Return: -789.5555346730602545
INFO:tensorflow:Average training steps per second: 348.48
I0902 00:18:43.671943 139965167532032 replay_runner.py:36] Average training steps per second: 348.48
I0902 00:18:43.779073 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -659.43
INFO:tensorflow:Starting iteration 25

Steps executed: 233 Episode length: 145 Return: -23.49235559004682745
INFO:tensorflow:Average training steps per second: 335.77
I0902 00:18:50.088469 139965167532032 replay_runner.py:36] Average training steps per second: 335.77
I0902 00:18:50.204781 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.32
INFO:tensorflow:Starting iteration 26

Steps executed: 242 Episode length: 54 Return: -117.10240423027798745
INFO:tensorflow:Average training steps per second: 331.24
I0902 00:18:56.549132 139965167532032 replay_runner.py:36] Average training steps per second: 331.24
I0902 00:18:56.659785 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.73
INFO:tensorflow:Starting iteration 27
I0902 00:18:59.894957 139965167532032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 325.09
I0902 00:19:02.971439 139965167532032 replay_runner.py:36] Average training steps per second: 325.09

Steps executed: 265 Episode length: 95 Return: -453.80410399204707745
INFO:tensorflow:Starting iteration 28

Steps executed: 244 Episode length: 116 Return: -247.1874367574319545
INFO:tensorflow:Average training steps per second: 320.63
I0902 00:19:09.431378 139965167532032 replay_runner.py:36] Average training steps per second: 320.63
I0902 00:19:09.552980 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.22
INFO:tensorflow:Starting iteration 29

Steps executed: 262 Episode length: 88 Return: -125.76738859920319545
INFO:tensorflow:Average training steps per second: 331.35
I0902 00:19:15.729623 139965167532032 replay_runner.py:36] Average training steps per second: 331.35

Done fixed training!Episode length: 88 Return: -125.76738859920319545