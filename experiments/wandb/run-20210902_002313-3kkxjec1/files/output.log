I0902 00:23:19.447391 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:19.455898 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:19.456048 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:19.456125 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:19.456211 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:19.456267 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:19.456321 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:19.456403 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:19.456509 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:19.456571 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:19.456621 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:19.456717 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:19.456800 139965167532032 dqn_agent.py:283] 	 seed: 1630542199455844
I0902 00:23:19.458805 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:19.458938 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:19.459076 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:19.459199 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:19.459343 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:19.459417 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:19.459509 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:19.459573 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:19.459633 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:19.485059 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:19.742216 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:19.752306 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:19.758923 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:19.759136 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:19.759272 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:19.759377 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:19.759551 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:19.759647 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:19.759740 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:19.759922 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:19.760012 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:19.760091 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:19.760162 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:19.760234 139965167532032 dqn_agent.py:283] 	 seed: 1630542199758889
I0902 00:23:19.761800 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:19.761916 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:19.761989 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:19.762084 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:19.762211 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:19.762310 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:19.762408 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:19.762522 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:19.762604 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:19.783826 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:19.798377 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:19.798544 139965167532032 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
Steps executed: 278 Episode length: 132 Return: -467.15734241127743
INFO:tensorflow:Average training steps per second: 252.04
I0902 00:23:23.766403 139965167532032 replay_runner.py:36] Average training steps per second: 252.04
I0902 00:23:24.624758 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -475.56
INFO:tensorflow:Starting iteration 1

Steps executed: 363 Episode length: 234 Return: -318.19212008459476
INFO:tensorflow:Average training steps per second: 355.48
I0902 00:23:30.625595 139965167532032 replay_runner.py:36] Average training steps per second: 355.48
I0902 00:23:30.870877 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.13
INFO:tensorflow:Starting iteration 2
I0902 00:23:34.213363 139965167532032 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 345.25

Steps executed: 256 Episode length: 115 Return: -317.37787604658536
I0902 00:23:37.298510 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.12
INFO:tensorflow:Starting iteration 3

Steps executed: 594 Episode length: 594 Return: -72.497132889646136
INFO:tensorflow:Average training steps per second: 335.77
I0902 00:23:43.463523 139965167532032 replay_runner.py:36] Average training steps per second: 335.77
I0902 00:23:44.415990 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.50
INFO:tensorflow:Starting iteration 4
I0902 00:23:47.663770 139965167532032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 328.18

Steps executed: 1000 Episode length: 1000 Return: -65.1280904181756
I0902 00:23:52.868437 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.13
INFO:tensorflow:Starting iteration 5
I0902 00:23:56.039934 139965167532032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 326.23

Steps executed: 1000 Episode length: 1000 Return: -60.95038484958323
I0902 00:24:01.500930 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.95
INFO:tensorflow:Starting iteration 6

Steps executed: 1000 Episode length: 1000 Return: -165.3148496645183
INFO:tensorflow:Average training steps per second: 335.08
I0902 00:24:07.619744 139965167532032 replay_runner.py:36] Average training steps per second: 335.08
I0902 00:24:09.110010 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.31
INFO:tensorflow:Starting iteration 7
I0902 00:24:12.401604 139965167532032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 351.74

Steps executed: 1000 Episode length: 1000 Return: -134.29579302835432
I0902 00:24:16.645205 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.30
INFO:tensorflow:Starting iteration 8
I0902 00:24:20.084748 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 357.81

Steps executed: 1000 Episode length: 1000 Return: -112.01186558252564
I0902 00:24:24.885659 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.01
INFO:tensorflow:Starting iteration 9
I0902 00:24:28.308651 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 344.36

Steps executed: 360 Episode length: 360 Return: -276.9758252979126564
I0902 00:24:31.495714 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.98
INFO:tensorflow:Starting iteration 10

Steps executed: 67 Episode length: 67 Return: -163.281027995463326564
INFO:tensorflow:Average training steps per second: 333.76

Steps executed: 1067 Episode length: 1000 Return: -131.54750073167124
I0902 00:24:40.632415 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.41
INFO:tensorflow:Starting iteration 11
I0902 00:24:44.052957 139965167532032 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 345.18

Steps executed: 1000 Episode length: 1000 Return: -172.99142064160023
I0902 00:24:49.239769 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.99
INFO:tensorflow:Starting iteration 12

Steps executed: 1000 Episode length: 1000 Return: -140.75291503104043
INFO:tensorflow:Average training steps per second: 334.39
I0902 00:24:55.620584 139965167532032 replay_runner.py:36] Average training steps per second: 334.39
I0902 00:24:57.043677 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.75
INFO:tensorflow:Starting iteration 13
I0902 00:25:00.402716 139965167532032 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 330.06

Steps executed: 1000 Episode length: 1000 Return: -91.380852961220443
I0902 00:25:05.195023 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.38
INFO:tensorflow:Starting iteration 14

Steps executed: 56 Episode length: 56 Return: -99.9302566560386820443
INFO:tensorflow:Average training steps per second: 328.72

Steps executed: 1056 Episode length: 1000 Return: -54.430403037816263
I0902 00:25:13.605183 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.18
INFO:tensorflow:Starting iteration 15
I0902 00:25:16.855108 139965167532032 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 327.49
I0902 00:25:19.909101 139965167532032 replay_runner.py:36] Average training steps per second: 327.49

Steps executed: 1000 Episode length: 1000 Return: -61.928990094011453
INFO:tensorflow:Starting iteration 16

Steps executed: 244 Episode length: 116 Return: -777.1422848688493353
INFO:tensorflow:Average training steps per second: 350.10
I0902 00:25:27.970692 139965167532032 replay_runner.py:36] Average training steps per second: 350.10
I0902 00:25:28.116005 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.40
INFO:tensorflow:Starting iteration 17

Steps executed: 286 Episode length: 151 Return: -103.3550406142241453
INFO:tensorflow:Average training steps per second: 332.12
I0902 00:25:34.560566 139965167532032 replay_runner.py:36] Average training steps per second: 332.12
I0902 00:25:34.714041 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -55.37
INFO:tensorflow:Starting iteration 18

Steps executed: 228 Episode length: 84 Return: -114.99924315964985453
INFO:tensorflow:Average training steps per second: 314.72
I0902 00:25:41.080188 139965167532032 replay_runner.py:36] Average training steps per second: 314.72
I0902 00:25:41.195353 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.07
INFO:tensorflow:Starting iteration 19

Steps executed: 216 Episode length: 216 Return: -224.9446424759442853
INFO:tensorflow:Average training steps per second: 310.03
I0902 00:25:47.655378 139965167532032 replay_runner.py:36] Average training steps per second: 310.03
I0902 00:25:47.820047 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.94
INFO:tensorflow:Starting iteration 20

Steps executed: 344 Episode length: 215 Return: -162.8307315425408453
INFO:tensorflow:Average training steps per second: 323.59
I0902 00:25:54.104827 139965167532032 replay_runner.py:36] Average training steps per second: 323.59
I0902 00:25:54.375423 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.51
INFO:tensorflow:Starting iteration 21

Steps executed: 299 Episode length: 133 Return: -98.63889699262859653
INFO:tensorflow:Average training steps per second: 332.47
I0902 00:26:00.690692 139965167532032 replay_runner.py:36] Average training steps per second: 332.47
I0902 00:26:00.911905 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.07
INFO:tensorflow:Starting iteration 22

Steps executed: 190 Episode length: 190 Return: -10.90954592424044753
INFO:tensorflow:Average training steps per second: 325.28

Steps executed: 415 Episode length: 225 Return: -55.34923874291364753
I0902 00:26:07.652052 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.13
INFO:tensorflow:Starting iteration 23

Steps executed: 319 Episode length: 212 Return: -101.4762073778364353
INFO:tensorflow:Average training steps per second: 326.92
I0902 00:26:14.092862 139965167532032 replay_runner.py:36] Average training steps per second: 326.92
I0902 00:26:14.299578 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.26
INFO:tensorflow:Starting iteration 24
I0902 00:26:17.678197 139965167532032 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 321.09

Steps executed: 1000 Episode length: 1000 Return: 10.8936261738767753
I0902 00:26:23.255477 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.89
INFO:tensorflow:Starting iteration 25
I0902 00:26:26.621672 139965167532032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 323.77

Steps executed: 263 Episode length: 139 Return: -131.2749508287705353
I0902 00:26:29.885494 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.46
INFO:tensorflow:Starting iteration 26

Steps executed: 249 Episode length: 249 Return: -2.571080662003865353
INFO:tensorflow:Average training steps per second: 322.44
I0902 00:26:36.335319 139965167532032 replay_runner.py:36] Average training steps per second: 322.44
I0902 00:26:36.532045 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.57
INFO:tensorflow:Starting iteration 27

Steps executed: 499 Episode length: 352 Return: -43.07885216877949353
INFO:tensorflow:Average training steps per second: 323.94
I0902 00:26:42.940365 139965167532032 replay_runner.py:36] Average training steps per second: 323.94
I0902 00:26:43.457006 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 5.69
INFO:tensorflow:Starting iteration 28
I0902 00:26:46.776642 139965167532032 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 325.87

Steps executed: 923 Episode length: 923 Return: -235.7863042305263353
I0902 00:26:52.142327 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.79
INFO:tensorflow:Starting iteration 29

Steps executed: 695 Episode length: 500 Return: 205.08895068450147353
INFO:tensorflow:Average training steps per second: 330.87
I0902 00:26:58.418696 139965167532032 replay_runner.py:36] Average training steps per second: 330.87

Done fixed training!Episode length: 500 Return: 205.08895068450147353