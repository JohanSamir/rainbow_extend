Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 23:41:16.345589 140561847887872 run_experiment.py:549] Creating TrainRunner ...
I0902 23:41:16.354572 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:41:16.354798 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:41:16.354936 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:41:16.355066 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:41:16.355136 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:41:16.355219 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:41:16.355346 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:41:16.355602 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:41:16.355769 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:41:16.355919 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:41:16.356045 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:41:16.356133 140561847887872 dqn_agent.py:283] 	 seed: 1630626076354515
I0902 23:41:16.359724 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:41:16.359920 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:41:16.360030 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:41:16.360114 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:41:16.360194 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:41:16.360249 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:41:16.360330 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:41:16.360427 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:41:16.360488 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:41:16.398269 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:41:17.214797 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:41:17.230846 140561847887872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:41:17.239771 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:41:17.240041 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:41:17.240231 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:41:17.240472 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:41:17.240616 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:41:17.240793 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:41:17.240932 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:41:17.241079 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:41:17.241213 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:41:17.241349 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:41:17.241470 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:41:17.241587 140561847887872 dqn_agent.py:283] 	 seed: 1630626077239714
I0902 23:41:17.244614 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:41:17.244814 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:41:17.245148 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:41:17.245349 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:41:17.245510 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:41:17.245745 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:41:17.245903 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:41:17.246065 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:41:17.246228 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:41:17.279896 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:41:17.301768 140561847887872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:41:17.301978 140561847887872 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.91
I0902 23:41:24.250743 140561847887872 replay_runner.py:36] Average training steps per second: 143.91
Steps executed: 201 Episode length: 201 Return: -200.0
I0902 23:41:25.548860 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.31
I0902 23:41:30.961907 140561847887872 replay_runner.py:36] Average training steps per second: 193.31
I0902 23:41:31.373151 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 632 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 182.17
I0902 23:41:37.111392 140561847887872 replay_runner.py:36] Average training steps per second: 182.17
I0902 23:41:37.649101 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.50
INFO:tensorflow:Starting iteration 3
I0902 23:41:37.890742 140561847887872 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.32
I0902 23:41:42.959278 140561847887872 replay_runner.py:36] Average training steps per second: 197.32
I0902 23:41:43.155285 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 4


Steps executed: 424 Episode length: 318 Return: -317.0
INFO:tensorflow:Average training steps per second: 183.85
I0902 23:41:48.830987 140561847887872 replay_runner.py:36] Average training steps per second: 183.85
I0902 23:41:49.202032 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.00
INFO:tensorflow:Starting iteration 5

Steps executed: 276 Episode length: 150 Return: -149.0
INFO:tensorflow:Average training steps per second: 195.81
I0902 23:41:54.546112 140561847887872 replay_runner.py:36] Average training steps per second: 195.81
I0902 23:41:54.791166 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.61
I0902 23:42:00.346355 140561847887872 replay_runner.py:36] Average training steps per second: 187.61
I0902 23:42:00.794473 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 23:42:01.035909 140561847887872 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 193.14

Steps executed: 238 Episode length: 140 Return: -139.0
I0902 23:42:06.409753 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 8

Steps executed: 225 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 192.98
I0902 23:42:11.834022 140561847887872 replay_runner.py:36] Average training steps per second: 192.98
I0902 23:42:12.022275 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 9

Steps executed: 452 Episode length: 452 Return: -451.0
INFO:tensorflow:Average training steps per second: 192.31
I0902 23:42:17.473628 140561847887872 replay_runner.py:36] Average training steps per second: 192.31
I0902 23:42:17.863275 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.00
INFO:tensorflow:Starting iteration 10

Steps executed: 269 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 191.51
I0902 23:42:23.341102 140561847887872 replay_runner.py:36] Average training steps per second: 191.51
I0902 23:42:23.563005 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.50
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.95
I0902 23:42:28.849120 140561847887872 replay_runner.py:36] Average training steps per second: 197.95
I0902 23:42:29.339560 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 234 Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 192.86
I0902 23:42:34.771852 140561847887872 replay_runner.py:36] Average training steps per second: 192.86
I0902 23:42:34.962328 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 13
I0902 23:42:35.189748 140561847887872 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.09

Steps executed: 255 Episode length: 179 Return: -178.0
I0902 23:42:40.582044 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 14

Steps executed: 267 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 198.40
I0902 23:42:45.864196 140561847887872 replay_runner.py:36] Average training steps per second: 198.40
I0902 23:42:46.071150 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 15

Steps executed: 226 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 186.88
I0902 23:42:51.644457 140561847887872 replay_runner.py:36] Average training steps per second: 186.88
I0902 23:42:51.828973 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33
INFO:tensorflow:Starting iteration 16

Steps executed: 688 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.16
I0902 23:42:57.037957 140561847887872 replay_runner.py:36] Average training steps per second: 201.16
I0902 23:42:57.592035 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.67
INFO:tensorflow:Starting iteration 17

Steps executed: 234 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 188.13
I0902 23:43:03.149782 140561847887872 replay_runner.py:36] Average training steps per second: 188.13
I0902 23:43:03.331176 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 18
I0902 23:43:03.559885 140561847887872 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 197.59

Steps executed: 259 Episode length: 97 Return: -96.0.0
I0902 23:43:08.843298 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 19

Steps executed: 284 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 190.53
I0902 23:43:14.333381 140561847887872 replay_runner.py:36] Average training steps per second: 190.53
I0902 23:43:14.574325 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 20

Steps executed: 271 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 191.40
I0902 23:43:20.029535 140561847887872 replay_runner.py:36] Average training steps per second: 191.40
I0902 23:43:20.278711 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 21

Steps executed: 220 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 189.91
I0902 23:43:25.814306 140561847887872 replay_runner.py:36] Average training steps per second: 189.91
I0902 23:43:26.014872 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.33
INFO:tensorflow:Starting iteration 22

Steps executed: 250 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 187.02
I0902 23:43:31.685142 140561847887872 replay_runner.py:36] Average training steps per second: 187.02
I0902 23:43:31.894727 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 23

Steps executed: 265 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 196.72
I0902 23:43:37.225722 140561847887872 replay_runner.py:36] Average training steps per second: 196.72
I0902 23:43:37.461624 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 195.56
I0902 23:43:42.799522 140561847887872 replay_runner.py:36] Average training steps per second: 195.56
I0902 23:43:43.047206 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 25
I0902 23:43:43.272592 140561847887872 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.12
I0902 23:43:48.346017 140561847887872 replay_runner.py:36] Average training steps per second: 197.12

Steps executed: 149 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Starting iteration 26

Steps executed: 232 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 192.61
I0902 23:43:53.977557 140561847887872 replay_runner.py:36] Average training steps per second: 192.61
I0902 23:43:54.159750 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 27

Steps executed: 205 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 194.20
I0902 23:43:59.592074 140561847887872 replay_runner.py:36] Average training steps per second: 194.20
I0902 23:43:59.832765 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 28

Steps executed: 269 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 195.83
I0902 23:44:05.184136 140561847887872 replay_runner.py:36] Average training steps per second: 195.83
I0902 23:44:05.410324 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 29

Steps executed: 255 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 191.91

Done fixed training!Episode length: 91 Return: -90.0.0
I0902 23:44:11.102401 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67