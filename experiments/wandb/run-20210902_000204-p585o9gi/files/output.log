Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0902 00:02:10.933039 140156774885376 run_experiment.py:549] Creating TrainRunner ...
I0902 00:02:10.942713 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:02:10.942993 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:02:10.943146 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:02:10.943279 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:02:10.943402 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0902 00:02:10.943531 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:02:10.943658 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:02:10.943777 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:02:10.943952 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:02:10.944079 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0902 00:02:10.944201 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:02:10.944318 140156774885376 dqn_agent.py:283] 	 seed: 1630540930942640
I0902 00:02:10.947824 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:02:10.948076 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:02:10.948232 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:02:10.948359 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:02:10.948511 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:02:10.948649 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:02:10.948780 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:02:10.948909 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:02:10.949257 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:02:10.993434 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:11.492407 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:11.508029 140156774885376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:02:11.517525 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:02:11.517718 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:02:11.517802 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:02:11.517871 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:02:11.517934 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0902 00:02:11.518000 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:02:11.518085 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:02:11.518222 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:02:11.518339 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:02:11.518471 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0902 00:02:11.518584 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:02:11.518678 140156774885376 dqn_agent.py:283] 	 seed: 1630540931517480
I0902 00:02:11.521043 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:02:11.521209 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:02:11.521298 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:02:11.521424 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:02:11.521594 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:02:11.521689 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:02:11.521768 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:02:11.521896 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:02:11.522032 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:02:11.555215 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:02:11.589351 140156774885376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:02:11.589945 140156774885376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.42
I0902 00:02:18.419922 140156774885376 replay_runner.py:36] Average training steps per second: 146.42
Steps executed: 208 Episode length: 10 Return: 10.0
I0902 00:02:19.684013 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 202.36
I0902 00:02:24.811549 140156774885376 replay_runner.py:36] Average training steps per second: 202.36
I0902 00:02:24.953708 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.79
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.21
I0902 00:02:30.455559 140156774885376 replay_runner.py:36] Average training steps per second: 188.21
I0902 00:02:30.595386 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 00:02:30.788875 140156774885376 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 203.70
I0902 00:02:35.698469 140156774885376 replay_runner.py:36] Average training steps per second: 203.70
I0902 00:02:35.835860 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 352 Episode length: 173 Return: 173.0
INFO:tensorflow:Average training steps per second: 194.44
I0902 00:02:41.174634 140156774885376 replay_runner.py:36] Average training steps per second: 194.44
I0902 00:02:41.388631 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.98
I0902 00:02:46.358885 140156774885376 replay_runner.py:36] Average training steps per second: 208.98
I0902 00:02:46.489368 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 00:02:46.679070 140156774885376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 198.61
I0902 00:02:51.714607 140156774885376 replay_runner.py:36] Average training steps per second: 198.61
I0902 00:02:51.828611 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 389 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.35
I0902 00:02:56.914524 140156774885376 replay_runner.py:36] Average training steps per second: 203.35
I0902 00:02:57.162435 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 8

Steps executed: 384 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.40
I0902 00:03:02.341103 140156774885376 replay_runner.py:36] Average training steps per second: 200.40
I0902 00:03:02.596132 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 9

Steps executed: 369 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 198.51
I0902 00:03:07.820156 140156774885376 replay_runner.py:36] Average training steps per second: 198.51
I0902 00:03:08.061542 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.63
I0902 00:03:13.281324 140156774885376 replay_runner.py:36] Average training steps per second: 198.63
I0902 00:03:13.415824 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 136 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 186.29

Steps executed: 309 Episode length: 173 Return: 173.0
I0902 00:03:19.175969 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 12
I0902 00:03:19.525411 140156774885376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 191.90
I0902 00:03:24.736943 140156774885376 replay_runner.py:36] Average training steps per second: 191.90
I0902 00:03:24.872134 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13


Steps executed: 357 Episode length: 186 Return: 186.0
INFO:tensorflow:Average training steps per second: 195.88
I0902 00:03:30.175087 140156774885376 replay_runner.py:36] Average training steps per second: 195.88
I0902 00:03:30.400917 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.51
I0902 00:03:35.799909 140156774885376 replay_runner.py:36] Average training steps per second: 191.51
I0902 00:03:35.942028 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 321 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 193.80
I0902 00:03:41.299023 140156774885376 replay_runner.py:36] Average training steps per second: 193.80
I0902 00:03:41.518729 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.50
INFO:tensorflow:Starting iteration 16
I0902 00:03:41.712261 140156774885376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 189.92
I0902 00:03:46.978060 140156774885376 replay_runner.py:36] Average training steps per second: 189.92
I0902 00:03:47.123631 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17


Steps executed: 310 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 194.63
I0902 00:03:52.644944 140156774885376 replay_runner.py:36] Average training steps per second: 194.63
I0902 00:03:52.868631 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.61
I0902 00:03:58.231291 140156774885376 replay_runner.py:36] Average training steps per second: 193.61
I0902 00:03:58.367377 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 00:03:58.558356 140156774885376 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.44
I0902 00:04:03.782421 140156774885376 replay_runner.py:36] Average training steps per second: 191.44
I0902 00:04:03.923773 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 00:04:04.121440 140156774885376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.09
I0902 00:04:09.300811 140156774885376 replay_runner.py:36] Average training steps per second: 193.09
I0902 00:04:09.435575 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:04:09.624952 140156774885376 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.58
I0902 00:04:14.818001 140156774885376 replay_runner.py:36] Average training steps per second: 192.58
I0902 00:04:14.967492 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:04:15.162815 140156774885376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.23
I0902 00:04:20.259290 140156774885376 replay_runner.py:36] Average training steps per second: 196.23
I0902 00:04:20.397123 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 358 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.39
I0902 00:04:25.810106 140156774885376 replay_runner.py:36] Average training steps per second: 191.39
I0902 00:04:26.051567 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 24

Steps executed: 376 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.65
I0902 00:04:31.403113 140156774885376 replay_runner.py:36] Average training steps per second: 193.65
I0902 00:04:31.672188 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.41
I0902 00:04:36.935819 140156774885376 replay_runner.py:36] Average training steps per second: 197.41
I0902 00:04:37.075031 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:04:37.267695 140156774885376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 201.06
I0902 00:04:42.241767 140156774885376 replay_runner.py:36] Average training steps per second: 201.06
I0902 00:04:42.373658 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:04:42.563055 140156774885376 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 201.68
I0902 00:04:47.522072 140156774885376 replay_runner.py:36] Average training steps per second: 201.68
I0902 00:04:47.683277 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 372 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.69
I0902 00:04:52.772255 140156774885376 replay_runner.py:36] Average training steps per second: 203.69
I0902 00:04:52.980120 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.09
I0902 00:04:58.141886 140156774885376 replay_runner.py:36] Average training steps per second: 201.09
I0902 00:04:58.260978 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00