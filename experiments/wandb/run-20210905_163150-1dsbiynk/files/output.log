I0905 16:31:57.334482 139861514946560 run_experiment.py:549] Creating TrainRunner ...
I0905 16:31:57.345765 139861514946560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:31:57.346017 139861514946560 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:31:57.346188 139861514946560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:31:57.346317 139861514946560 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:31:57.346438 139861514946560 dqn_agent.py:275] 	 update_period: 4
I0905 16:31:57.346577 139861514946560 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:31:57.346759 139861514946560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:31:57.346904 139861514946560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:31:57.346993 139861514946560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:31:57.347079 139861514946560 dqn_agent.py:280] 	 optimizer: adam
I0905 16:31:57.347178 139861514946560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:31:57.347334 139861514946560 dqn_agent.py:283] 	 seed: 1630859517345707
I0905 16:31:57.350131 139861514946560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:31:57.350308 139861514946560 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:31:57.350417 139861514946560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:31:57.350567 139861514946560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:31:57.350693 139861514946560 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:31:57.350802 139861514946560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:31:57.350887 139861514946560 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:31:57.350993 139861514946560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:31:57.351104 139861514946560 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0905 16:31:59.033184 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:59.682812 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:59.695662 139861514946560 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:31:59.704498 139861514946560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:31:59.704712 139861514946560 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:31:59.704810 139861514946560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:31:59.704892 139861514946560 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:31:59.704966 139861514946560 dqn_agent.py:275] 	 update_period: 4
I0905 16:31:59.705048 139861514946560 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:31:59.705208 139861514946560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:31:59.705267 139861514946560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:31:59.705348 139861514946560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:31:59.705423 139861514946560 dqn_agent.py:280] 	 optimizer: adam
I0905 16:31:59.705476 139861514946560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:31:59.705563 139861514946560 dqn_agent.py:283] 	 seed: 1630859519704447
I0905 16:31:59.707225 139861514946560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:31:59.707450 139861514946560 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:31:59.707635 139861514946560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:31:59.707736 139861514946560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:31:59.707876 139861514946560 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:31:59.708011 139861514946560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:31:59.708165 139861514946560 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:31:59.708265 139861514946560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:31:59.708404 139861514946560 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:31:59.739865 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:59.759653 139861514946560 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:31:59.759901 139861514946560 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.67
I0905 16:32:06.578673 139861514946560 replay_runner.py:36] Average training steps per second: 146.67
Steps executed: 201 Episode length: 8 Return: 8.0.0
I0905 16:32:07.963027 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 210 Episode length: 18 Return: 18.0
INFO:tensorflow:Average training steps per second: 183.55
I0905 16:32:13.642730 139861514946560 replay_runner.py:36] Average training steps per second: 183.55
I0905 16:32:13.849954 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.50
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 171.97
I0905 16:32:19.879532 139861514946560 replay_runner.py:36] Average training steps per second: 171.97
I0905 16:32:20.147044 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 183 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 163.86
I0905 16:32:26.473039 139861514946560 replay_runner.py:36] Average training steps per second: 163.86

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 154.77
I0905 16:32:33.693060 139861514946560 replay_runner.py:36] Average training steps per second: 154.77
I0905 16:32:34.055493 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0905 16:32:34.283571 139861514946560 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 152.47

Steps executed: 248 Episode length: 123 Return: 123.0
I0905 16:32:41.398010 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 6
I0905 16:32:41.657019 139861514946560 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 139.63

Steps executed: 252 Episode length: 125 Return: 125.0
I0905 16:32:49.567372 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 135.48
I0905 16:32:57.164353 139861514946560 replay_runner.py:36] Average training steps per second: 135.48
I0905 16:32:57.940713 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0905 16:32:58.233988 139861514946560 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 157.09
I0905 16:33:04.600570 139861514946560 replay_runner.py:36] Average training steps per second: 157.09
I0905 16:33:05.043431 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 163 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 136.20

Steps executed: 346 Episode length: 183 Return: 183.0
I0905 16:33:13.361704 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 10

Steps executed: 139 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 144.56

Steps executed: 329 Episode length: 190 Return: 190.0
I0905 16:33:21.427761 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 11

Steps executed: 327 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 148.27
I0905 16:33:28.451859 139861514946560 replay_runner.py:36] Average training steps per second: 148.27
I0905 16:33:29.155229 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 143.10
I0905 16:33:36.492164 139861514946560 replay_runner.py:36] Average training steps per second: 143.10
I0905 16:33:36.874609 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0905 16:33:37.128235 139861514946560 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 138.86
I0905 16:33:44.330236 139861514946560 replay_runner.py:36] Average training steps per second: 138.86
I0905 16:33:44.813157 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0905 16:33:45.038629 139861514946560 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 152.41
I0905 16:33:51.600630 139861514946560 replay_runner.py:36] Average training steps per second: 152.41
I0905 16:33:52.086662 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0905 16:33:52.308508 139861514946560 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 152.32

Steps executed: 375 Episode length: 197 Return: 197.0
I0905 16:33:59.762977 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 16
I0905 16:34:00.048355 139861514946560 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 144.31

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:34:07.476567 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0905 16:34:07.988682 139861514946560 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 145.60
I0905 16:34:14.857558 139861514946560 replay_runner.py:36] Average training steps per second: 145.60
I0905 16:34:15.324174 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 16:34:15.601869 139861514946560 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 150.40
I0905 16:34:22.251240 139861514946560 replay_runner.py:36] Average training steps per second: 150.40
I0905 16:34:22.797108 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 332 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 134.57
I0905 16:34:30.502534 139861514946560 replay_runner.py:36] Average training steps per second: 134.57
I0905 16:34:31.175851 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 156.14
I0905 16:34:37.816887 139861514946560 replay_runner.py:36] Average training steps per second: 156.14
I0905 16:34:38.265578 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 16:34:38.517916 139861514946560 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 146.32
I0905 16:34:45.353174 139861514946560 replay_runner.py:36] Average training steps per second: 146.32
I0905 16:34:45.760836 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 16:34:46.048445 139861514946560 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 136.31
I0905 16:34:53.385107 139861514946560 replay_runner.py:36] Average training steps per second: 136.31
I0905 16:34:53.767945 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0905 16:34:54.060544 139861514946560 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 148.09
I0905 16:35:00.814103 139861514946560 replay_runner.py:36] Average training steps per second: 148.09
I0905 16:35:01.419474 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0905 16:35:01.681391 139861514946560 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 132.95
I0905 16:35:09.204170 139861514946560 replay_runner.py:36] Average training steps per second: 132.95
I0905 16:35:09.688241 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 153.31
I0905 16:35:16.488755 139861514946560 replay_runner.py:36] Average training steps per second: 153.31
I0905 16:35:17.409292 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 137.18
I0905 16:35:24.974023 139861514946560 replay_runner.py:36] Average training steps per second: 137.18
I0905 16:35:25.516492 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:35:25.801432 139861514946560 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 145.99
I0905 16:35:32.652162 139861514946560 replay_runner.py:36] Average training steps per second: 145.99
I0905 16:35:33.073614 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 16:35:33.330233 139861514946560 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 149.10
I0905 16:35:40.037585 139861514946560 replay_runner.py:36] Average training steps per second: 149.10
I0905 16:35:40.650213 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 144.73
I0905 16:35:47.823220 139861514946560 replay_runner.py:36] Average training steps per second: 144.73
I0905 16:35:48.283627 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00