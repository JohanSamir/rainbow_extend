Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0905 18:51:38.580590 139802860935168 run_experiment.py:549] Creating TrainRunner ...
I0905 18:51:38.593557 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:51:38.593988 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:51:38.594176 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:51:38.594303 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:51:38.594440 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 18:51:38.594666 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:51:38.594787 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:51:38.594964 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:51:38.595276 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:51:38.595463 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 18:51:38.595736 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:51:38.595898 139802860935168 dqn_agent.py:283] 	 seed: 1630867898593483
I0905 18:51:38.599745 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:51:38.600305 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:51:38.600563 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:51:38.600781 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:51:38.600980 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:51:38.601095 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:51:38.601203 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:51:38.601279 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:51:38.601344 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:51:39.110314 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:39.495476 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:39.511066 139802860935168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:51:39.520377 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:51:39.520649 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:51:39.520895 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:51:39.521137 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:51:39.521357 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 18:51:39.521479 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:51:39.521613 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:51:39.521725 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:51:39.521911 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:51:39.522064 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 18:51:39.522199 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:51:39.522288 139802860935168 dqn_agent.py:283] 	 seed: 1630867899520299
I0905 18:51:39.525190 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:51:39.525402 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:51:39.525556 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:51:39.525726 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:51:39.525884 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:51:39.525992 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:51:39.526068 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:51:39.526145 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:51:39.526220 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:51:39.560854 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:39.862637 139802860935168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:51:39.862982 139802860935168 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.17
I0905 18:51:45.881186 139802860935168 replay_runner.py:36] Average training steps per second: 166.17
Steps executed: 317 Episode length: 174 Return: -265.58230530170715
I0905 18:51:47.242965 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.22
INFO:tensorflow:Starting iteration 1
I0905 18:51:51.658977 139802860935168 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 226.47

Steps executed: 463 Episode length: 315 Return: -207.05250024497354
I0905 18:51:56.575877 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.80
INFO:tensorflow:Starting iteration 2

Steps executed: 350 Episode length: 163 Return: -421.13055848389764
INFO:tensorflow:Average training steps per second: 229.21
I0905 18:52:05.348718 139802860935168 replay_runner.py:36] Average training steps per second: 229.21
I0905 18:52:05.698631 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.12
INFO:tensorflow:Starting iteration 3
I0905 18:52:10.030359 139802860935168 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 234.96

Steps executed: 531 Episode length: 531 Return: -209.18309278213484
I0905 18:52:15.524604 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.18
INFO:tensorflow:Starting iteration 4

Steps executed: 136 Episode length: 136 Return: -426.46849048092964
INFO:tensorflow:Average training steps per second: 250.83

Steps executed: 1136 Episode length: 1000 Return: -208.17771830543364
I0905 18:52:26.082766 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.32
INFO:tensorflow:Starting iteration 5
I0905 18:52:30.081570 139802860935168 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 224.41
I0905 18:52:34.538241 139802860935168 replay_runner.py:36] Average training steps per second: 224.41

Steps executed: 1000 Episode length: 1000 Return: -55.263456573397674
INFO:tensorflow:Starting iteration 6
I0905 18:52:40.943680 139802860935168 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.88

Steps executed: 1000 Episode length: 1000 Return: -169.30366106960125
I0905 18:52:49.148605 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.30
INFO:tensorflow:Starting iteration 7
I0905 18:52:53.655855 139802860935168 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 195.23

Steps executed: 1000 Episode length: 1000 Return: -344.60989668042333
I0905 18:53:01.400953 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.61
INFO:tensorflow:Starting iteration 8

Steps executed: 363 Episode length: 198 Return: -94.30206312948532333
INFO:tensorflow:Average training steps per second: 194.84
I0905 18:53:10.882584 139802860935168 replay_runner.py:36] Average training steps per second: 194.84
I0905 18:53:11.321882 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.35
INFO:tensorflow:Starting iteration 9
I0905 18:53:15.326650 139802860935168 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.43

Steps executed: 1000 Episode length: 1000 Return: -202.25853128522695
I0905 18:53:23.278728 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.26
INFO:tensorflow:Starting iteration 10

Steps executed: 202 Episode length: 54 Return: -234.06110388234472695
INFO:tensorflow:Average training steps per second: 196.12
I0905 18:53:32.776266 139802860935168 replay_runner.py:36] Average training steps per second: 196.12
I0905 18:53:32.980893 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.78
INFO:tensorflow:Starting iteration 11

Steps executed: 76 Episode length: 76 Return: -106.295156409835572695
INFO:tensorflow:Average training steps per second: 195.63

Steps executed: 1076 Episode length: 1000 Return: -213.17946378844374
I0905 18:53:45.774482 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.74
INFO:tensorflow:Starting iteration 12
I0905 18:53:50.465861 139802860935168 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 196.28

Steps executed: 827 Episode length: 827 Return: -470.2562294002209374
I0905 18:53:57.529912 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.26
INFO:tensorflow:Starting iteration 13
I0905 18:54:01.583963 139802860935168 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 200.05

Steps executed: 1000 Episode length: 1000 Return: -217.63727552837463
I0905 18:54:09.773841 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.64
INFO:tensorflow:Starting iteration 14
I0905 18:54:14.336165 139802860935168 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 198.56

Steps executed: 1000 Episode length: 1000 Return: -154.42119060360096
I0905 18:54:23.218098 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.42
INFO:tensorflow:Starting iteration 15
I0905 18:54:27.426866 139802860935168 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 197.89

Steps executed: 1000 Episode length: 1000 Return: -118.01521104668949
I0905 18:54:35.556953 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.02
INFO:tensorflow:Starting iteration 16
I0905 18:54:40.195714 139802860935168 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 202.34

Steps executed: 595 Episode length: 595 Return: -66.67030963704508949
I0905 18:54:46.823322 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -66.67
INFO:tensorflow:Starting iteration 17

Steps executed: 215 Episode length: 215 Return: -373.6692274963981949
INFO:tensorflow:Average training steps per second: 197.43
I0905 18:54:56.269810 139802860935168 replay_runner.py:36] Average training steps per second: 197.43
I0905 18:54:56.535481 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.67
INFO:tensorflow:Starting iteration 18
I0905 18:55:01.045203 139802860935168 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.39

Steps executed: 463 Episode length: 463 Return: -159.0770495615860249
I0905 18:55:07.126186 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.08
INFO:tensorflow:Starting iteration 19
I0905 18:55:11.692996 139802860935168 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 197.91

Steps executed: 240 Episode length: 240 Return: -86.18333244171049249
I0905 18:55:17.100589 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.18
INFO:tensorflow:Starting iteration 20

Steps executed: 327 Episode length: 164 Return: -337.7446715853006449
INFO:tensorflow:Average training steps per second: 196.74
I0905 18:55:26.372804 139802860935168 replay_runner.py:36] Average training steps per second: 196.74
I0905 18:55:26.717785 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.57
INFO:tensorflow:Starting iteration 21

Steps executed: 296 Episode length: 156 Return: -90.89141277655403649
INFO:tensorflow:Average training steps per second: 200.76
I0905 18:55:35.808522 139802860935168 replay_runner.py:36] Average training steps per second: 200.76
I0905 18:55:36.112106 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.18
INFO:tensorflow:Starting iteration 22

Steps executed: 334 Episode length: 334 Return: 254.88881855020418649
INFO:tensorflow:Average training steps per second: 218.21
I0905 18:55:45.163955 139802860935168 replay_runner.py:36] Average training steps per second: 218.21
I0905 18:55:45.853203 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 254.89
INFO:tensorflow:Starting iteration 23
I0905 18:55:50.444253 139802860935168 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.28

Steps executed: 284 Episode length: 284 Return: -285.6848666425452649
I0905 18:55:55.286126 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.68
INFO:tensorflow:Starting iteration 24
I0905 18:56:00.005122 139802860935168 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 200.81

Steps executed: 493 Episode length: 493 Return: -527.3778142911844649
I0905 18:56:06.095258 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -527.38
INFO:tensorflow:Starting iteration 25

Steps executed: 229 Episode length: 229 Return: -168.6888084398741849
INFO:tensorflow:Average training steps per second: 186.45
I0905 18:56:16.208905 139802860935168 replay_runner.py:36] Average training steps per second: 186.45
I0905 18:56:16.547783 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.69
INFO:tensorflow:Starting iteration 26

Steps executed: 86 Episode length: 86 Return: -473.152630115317241849
INFO:tensorflow:Average training steps per second: 179.26

Steps executed: 218 Episode length: 51 Return: -95.157584283845451849
I0905 18:56:27.285464 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.29
INFO:tensorflow:Starting iteration 27

Steps executed: 278 Episode length: 140 Return: -76.43146668603849849
INFO:tensorflow:Average training steps per second: 181.41
I0905 18:56:37.559686 139802860935168 replay_runner.py:36] Average training steps per second: 181.41
I0905 18:56:37.924946 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.59
INFO:tensorflow:Starting iteration 28

Steps executed: 146 Episode length: 146 Return: -336.5703413555537549
INFO:tensorflow:Average training steps per second: 178.28
I0905 18:56:48.361366 139802860935168 replay_runner.py:36] Average training steps per second: 178.28

Steps executed: 292 Episode length: 146 Return: -85.36598314381386549
INFO:tensorflow:Starting iteration 29
I0905 18:56:52.857085 139802860935168 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 177.17
I0905 18:56:58.502142 139802860935168 replay_runner.py:36] Average training steps per second: 177.17


Done fixed training!Episode length: 139 Return: -498.7100066673407449