I0902 00:23:37.419613 139752435963904 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:37.427291 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:37.427435 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:37.427522 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:37.427592 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:37.427655 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:37.427751 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:37.427819 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:37.427878 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:37.427980 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:37.428057 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:37.428143 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:37.428216 139752435963904 dqn_agent.py:283] 	 seed: 1630542217427258
I0902 00:23:37.430175 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:37.430294 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:37.430378 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:37.430457 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:37.430526 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:37.430597 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:37.430672 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:37.430770 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:37.430866 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:37.456622 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:37.690842 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:37.699946 139752435963904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:37.705864 139752435963904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:37.705994 139752435963904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:37.706094 139752435963904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:37.706215 139752435963904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:37.706276 139752435963904 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:37.706344 139752435963904 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:37.706398 139752435963904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:37.706459 139752435963904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:37.706531 139752435963904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:37.706620 139752435963904 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:37.706696 139752435963904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:37.706767 139752435963904 dqn_agent.py:283] 	 seed: 1630542217705835
I0902 00:23:37.708204 139752435963904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:37.708319 139752435963904 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:37.708397 139752435963904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:37.708468 139752435963904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:37.708536 139752435963904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:37.708600 139752435963904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:37.708657 139752435963904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:37.708728 139752435963904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:37.708811 139752435963904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:37.729040 139752435963904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:37.742606 139752435963904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:37.742757 139752435963904 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
Steps executed: 236 Episode length: 149 Return: -501.36001215232
INFO:tensorflow:Average training steps per second: 273.73
I0902 00:23:41.396214 139752435963904 replay_runner.py:36] Average training steps per second: 273.73
I0902 00:23:42.489737 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.70
INFO:tensorflow:Starting iteration 1

Steps executed: 224 Episode length: 114 Return: -752.3311516548457
INFO:tensorflow:Average training steps per second: 363.28
I0902 00:23:48.598769 139752435963904 replay_runner.py:36] Average training steps per second: 363.28
I0902 00:23:48.732539 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -552.21
INFO:tensorflow:Starting iteration 2
I0902 00:23:52.204038 139752435963904 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 356.48

Steps executed: 211 Episode length: 211 Return: -32.532391239950826
I0902 00:23:55.141997 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -32.53
INFO:tensorflow:Starting iteration 3
I0902 00:23:58.522653 139752435963904 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 330.57

Steps executed: 1000 Episode length: 1000 Return: -280.5361207250097
I0902 00:24:03.454051 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.54
INFO:tensorflow:Starting iteration 4
I0902 00:24:06.887543 139752435963904 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 363.82

Steps executed: 1000 Episode length: 1000 Return: -18.009176593056324
I0902 00:24:12.083003 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.01
INFO:tensorflow:Starting iteration 5

Steps executed: 688 Episode length: 688 Return: -235.9188756284549724
INFO:tensorflow:Average training steps per second: 354.26
I0902 00:24:18.286689 139752435963904 replay_runner.py:36] Average training steps per second: 354.26
I0902 00:24:19.074659 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.92
INFO:tensorflow:Starting iteration 6
I0902 00:24:22.468108 139752435963904 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 360.46

Steps executed: 286 Episode length: 286 Return: -383.9480512912357724
I0902 00:24:25.476378 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.95
INFO:tensorflow:Starting iteration 7

Steps executed: 1000 Episode length: 1000 Return: -20.485850868168854
INFO:tensorflow:Average training steps per second: 346.96
I0902 00:24:31.753533 139752435963904 replay_runner.py:36] Average training steps per second: 346.96
I0902 00:24:32.873877 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -20.49
INFO:tensorflow:Starting iteration 8
I0902 00:24:36.276344 139752435963904 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 343.52

Steps executed: 502 Episode length: 502 Return: -285.5597562212041754
I0902 00:24:39.756517 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.56
INFO:tensorflow:Starting iteration 9
I0902 00:24:43.057017 139752435963904 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 336.70

Steps executed: 1000 Episode length: 1000 Return: -52.506679185251074
I0902 00:24:48.290654 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.51
INFO:tensorflow:Starting iteration 10
I0902 00:24:51.637521 139752435963904 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 330.22

Steps executed: 1000 Episode length: 1000 Return: -51.908304504705034
I0902 00:24:56.848880 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -51.91
INFO:tensorflow:Starting iteration 11
I0902 00:25:00.189780 139752435963904 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 346.35

Steps executed: 1000 Episode length: 1000 Return: -102.25133822883956
I0902 00:25:04.693698 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.25
INFO:tensorflow:Starting iteration 12
I0902 00:25:08.027487 139752435963904 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 338.03

Steps executed: 1000 Episode length: 1000 Return: -96.076812182596466
I0902 00:25:13.226553 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.08
INFO:tensorflow:Starting iteration 13
I0902 00:25:16.402939 139752435963904 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 326.57

Steps executed: 391 Episode length: 211 Return: -16.40088560793924466
I0902 00:25:19.714646 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.06
INFO:tensorflow:Starting iteration 14
I0902 00:25:23.070081 139752435963904 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 338.44

Steps executed: 1000 Episode length: 1000 Return: -106.06036219341165
I0902 00:25:28.484822 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.06
INFO:tensorflow:Starting iteration 15

Steps executed: 296 Episode length: 141 Return: -653.8400712053875765
INFO:tensorflow:Average training steps per second: 335.80
I0902 00:25:34.884022 139752435963904 replay_runner.py:36] Average training steps per second: 335.80
I0902 00:25:35.040523 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.72
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 251 Return: -808.2456373691992765
INFO:tensorflow:Average training steps per second: 317.07
I0902 00:25:41.405197 139752435963904 replay_runner.py:36] Average training steps per second: 317.07
I0902 00:25:41.587159 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -808.25
INFO:tensorflow:Starting iteration 17

Steps executed: 237 Episode length: 237 Return: -369.6867321228528565
INFO:tensorflow:Average training steps per second: 315.52
I0902 00:25:48.000942 139752435963904 replay_runner.py:36] Average training steps per second: 315.52
I0902 00:25:48.177906 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.69
INFO:tensorflow:Starting iteration 18

Steps executed: 305 Episode length: 160 Return: -831.4394970234856565
INFO:tensorflow:Average training steps per second: 328.09
I0902 00:25:54.440806 139752435963904 replay_runner.py:36] Average training steps per second: 328.09
I0902 00:25:54.646831 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -620.04
INFO:tensorflow:Starting iteration 19

Steps executed: 341 Episode length: 225 Return: -141.0563076678505265
INFO:tensorflow:Average training steps per second: 340.92
I0902 00:26:00.918902 139752435963904 replay_runner.py:36] Average training steps per second: 340.92
I0902 00:26:01.167612 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.82
INFO:tensorflow:Starting iteration 20
I0902 00:26:04.566084 139752435963904 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 339.69
I0902 00:26:07.510262 139752435963904 replay_runner.py:36] Average training steps per second: 339.69

Steps executed: 281 Episode length: 182 Return: -61.53287519138261265
INFO:tensorflow:Starting iteration 21

Steps executed: 342 Episode length: 342 Return: -459.0935771493907465
INFO:tensorflow:Average training steps per second: 334.55
I0902 00:26:14.071816 139752435963904 replay_runner.py:36] Average training steps per second: 334.55
I0902 00:26:14.397505 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.09
INFO:tensorflow:Starting iteration 22

Steps executed: 387 Episode length: 283 Return: -310.9450795555339365
INFO:tensorflow:Average training steps per second: 336.85
I0902 00:26:20.754575 139752435963904 replay_runner.py:36] Average training steps per second: 336.85
I0902 00:26:21.072528 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.79
INFO:tensorflow:Starting iteration 23

Steps executed: 106 Episode length: 106 Return: -697.8629868067199365
INFO:tensorflow:Average training steps per second: 341.54

Steps executed: 396 Episode length: 202 Return: -241.7471413812352365
I0902 00:26:27.660284 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -546.95
INFO:tensorflow:Starting iteration 24

Steps executed: 233 Episode length: 115 Return: -111.1311572936238665
INFO:tensorflow:Average training steps per second: 346.18
I0902 00:26:33.975013 139752435963904 replay_runner.py:36] Average training steps per second: 346.18
I0902 00:26:34.150479 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.86
INFO:tensorflow:Starting iteration 25

Steps executed: 364 Episode length: 175 Return: -326.6957908455283465
INFO:tensorflow:Average training steps per second: 363.82
I0902 00:26:40.398332 139752435963904 replay_runner.py:36] Average training steps per second: 363.82
I0902 00:26:40.648237 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -551.29
INFO:tensorflow:Starting iteration 26

Steps executed: 208 Episode length: 115 Return: -659.0789025407944465
INFO:tensorflow:Average training steps per second: 371.42
I0902 00:26:46.859990 139752435963904 replay_runner.py:36] Average training steps per second: 371.42
I0902 00:26:46.984012 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.61
INFO:tensorflow:Starting iteration 27

Steps executed: 267 Episode length: 165 Return: -650.3516321703542465
INFO:tensorflow:Average training steps per second: 374.63
I0902 00:26:53.196923 139752435963904 replay_runner.py:36] Average training steps per second: 374.63
I0902 00:26:53.361238 139752435963904 run_experiment.py:428] Average undiscounted return per evaluation episode: -705.14
INFO:tensorflow:Starting iteration 28

Steps executed: 105 Episode length: 105 Return: -833.7460394888719465
INFO:tensorflow:Average training steps per second: 349.29
I0902 00:26:59.573654 139752435963904 replay_runner.py:36] Average training steps per second: 349.29

Steps executed: 255 Episode length: 150 Return: -225.9840811140144365
INFO:tensorflow:Starting iteration 29
I0902 00:27:02.920468 139752435963904 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 363.23

Steps executed: 1079 Episode length: 1000 Return: -25.369199675347474

Done fixed training! Episode length: 1000 Return: -25.369199675347474