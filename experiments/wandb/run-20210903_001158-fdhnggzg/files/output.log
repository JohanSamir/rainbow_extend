Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0903 00:12:03.693947 140369919707136 run_experiment.py:549] Creating TrainRunner ...
I0903 00:12:03.702294 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:12:03.702466 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:12:03.702557 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:12:03.702618 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:12:03.702677 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:12:03.702757 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:12:03.702851 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:12:03.702919 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:12:03.703020 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:12:03.703111 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:12:03.703181 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:12:03.703232 140369919707136 dqn_agent.py:283] 	 seed: 1630627923702251
I0903 00:12:03.704967 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:12:03.705091 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:12:03.705168 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:12:03.705231 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:12:03.705291 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:12:03.705361 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:12:03.705449 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:12:03.705517 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:12:03.705571 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:12:03.731950 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:03.982080 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:03.992118 140369919707136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:12:03.998813 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:12:03.998954 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:12:03.999021 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:12:03.999082 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:12:03.999132 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:12:03.999200 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:12:03.999263 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:12:03.999312 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:12:03.999387 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:12:03.999513 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:12:03.999593 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:12:03.999687 140369919707136 dqn_agent.py:283] 	 seed: 1630627923998785
I0903 00:12:04.001165 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:12:04.001278 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:12:04.001350 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:12:04.001428 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:12:04.001484 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:12:04.001537 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:12:04.001623 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:12:04.001676 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:12:04.001791 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:12:04.021727 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:12:04.038531 140369919707136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:12:04.038689 140369919707136 replay_runner.py:41] Starting iteration 0
Steps executed: 284 Episode length: 105 Return: -515.6327058615026
INFO:tensorflow:Average training steps per second: 256.81
I0903 00:12:07.932733 140369919707136 replay_runner.py:36] Average training steps per second: 256.81
I0903 00:12:08.770267 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.35
INFO:tensorflow:Starting iteration 1

Steps executed: 246 Episode length: 93 Return: -465.75958662090048
INFO:tensorflow:Average training steps per second: 345.90
I0903 00:12:15.097818 140369919707136 replay_runner.py:36] Average training steps per second: 345.90
I0903 00:12:15.239108 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.85
INFO:tensorflow:Starting iteration 2

Steps executed: 299 Episode length: 103 Return: -631.97308846499387
INFO:tensorflow:Average training steps per second: 354.55
I0903 00:12:21.491965 140369919707136 replay_runner.py:36] Average training steps per second: 354.55
I0903 00:12:21.713048 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.42
INFO:tensorflow:Starting iteration 3

Steps executed: 223 Episode length: 223 Return: -108.38114356355172
INFO:tensorflow:Average training steps per second: 356.95
I0903 00:12:27.961060 140369919707136 replay_runner.py:36] Average training steps per second: 356.95
I0903 00:12:28.144268 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.38
INFO:tensorflow:Starting iteration 4

Steps executed: 614 Episode length: 454 Return: -612.90135045374942
INFO:tensorflow:Average training steps per second: 351.42
I0903 00:12:34.559233 140369919707136 replay_runner.py:36] Average training steps per second: 351.42
I0903 00:12:35.260238 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -636.87
INFO:tensorflow:Starting iteration 5

Steps executed: 259 Episode length: 113 Return: -271.33143909626283
INFO:tensorflow:Average training steps per second: 344.27
I0903 00:12:41.638042 140369919707136 replay_runner.py:36] Average training steps per second: 344.27
I0903 00:12:41.803286 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.92
INFO:tensorflow:Starting iteration 6

Steps executed: 551 Episode length: 551 Return: -625.39123052602623
INFO:tensorflow:Average training steps per second: 345.69
I0903 00:12:48.069818 140369919707136 replay_runner.py:36] Average training steps per second: 345.69
I0903 00:12:48.806796 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -625.39
INFO:tensorflow:Starting iteration 7
I0903 00:12:52.144102 140369919707136 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 336.95

Steps executed: 1000 Episode length: 1000 Return: -105.26281884253052
I0903 00:12:58.146143 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.26
INFO:tensorflow:Starting iteration 8
I0903 00:13:01.391818 140369919707136 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 316.46

Steps executed: 1000 Episode length: 1000 Return: -13.864447605652199
I0903 00:13:06.599481 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -13.86
INFO:tensorflow:Starting iteration 9

Steps executed: 144 Episode length: 144 Return: -527.1022560667472199
INFO:tensorflow:Average training steps per second: 328.31

Steps executed: 687 Episode length: 543 Return: -538.5295023648237199
I0903 00:13:13.716410 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -532.82
INFO:tensorflow:Starting iteration 10

Steps executed: 543 Episode length: 543 Return: -209.2766671593109199
INFO:tensorflow:Average training steps per second: 328.98
I0903 00:13:20.149395 140369919707136 replay_runner.py:36] Average training steps per second: 328.98
I0903 00:13:20.715880 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.28
INFO:tensorflow:Starting iteration 11

Steps executed: 419 Episode length: 419 Return: -753.2090461003469199
INFO:tensorflow:Average training steps per second: 324.44
I0903 00:13:27.228048 140369919707136 replay_runner.py:36] Average training steps per second: 324.44
I0903 00:13:27.634603 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -753.21
INFO:tensorflow:Starting iteration 12

Steps executed: 229 Episode length: 112 Return: -160.3501010760515799
INFO:tensorflow:Average training steps per second: 333.38
I0903 00:13:34.028397 140369919707136 replay_runner.py:36] Average training steps per second: 333.38
I0903 00:13:34.146270 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.08
INFO:tensorflow:Starting iteration 13

Steps executed: 250 Episode length: 167 Return: -397.3449462538543799
INFO:tensorflow:Average training steps per second: 320.88
I0903 00:13:40.538417 140369919707136 replay_runner.py:36] Average training steps per second: 320.88
I0903 00:13:40.709257 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.19
INFO:tensorflow:Starting iteration 14

Steps executed: 338 Episode length: 338 Return: -490.8164599024743799
INFO:tensorflow:Average training steps per second: 327.34
I0903 00:13:47.062541 140369919707136 replay_runner.py:36] Average training steps per second: 327.34
I0903 00:13:47.428745 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -490.82
INFO:tensorflow:Starting iteration 15

Steps executed: 140 Episode length: 140 Return: -275.5905567266316799
INFO:tensorflow:Average training steps per second: 331.30

Steps executed: 485 Episode length: 345 Return: -202.4707199167924699
I0903 00:13:54.205188 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.03
INFO:tensorflow:Starting iteration 16

Steps executed: 312 Episode length: 200 Return: -443.6181554231498799
INFO:tensorflow:Average training steps per second: 335.70
I0903 00:14:00.583109 140369919707136 replay_runner.py:36] Average training steps per second: 335.70
I0903 00:14:00.786594 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.99
INFO:tensorflow:Starting iteration 17

Steps executed: 213 Episode length: 213 Return: -148.0744459824205799
INFO:tensorflow:Average training steps per second: 322.17
I0903 00:14:07.318358 140369919707136 replay_runner.py:36] Average training steps per second: 322.17
I0903 00:14:07.462426 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.07
INFO:tensorflow:Starting iteration 18

Steps executed: 130 Episode length: 130 Return: -164.5729200819996799
INFO:tensorflow:Average training steps per second: 321.77
I0903 00:14:13.934182 140369919707136 replay_runner.py:36] Average training steps per second: 321.77

Steps executed: 205 Episode length: 75 Return: -49.155498369662096799
INFO:tensorflow:Starting iteration 19

Steps executed: 309 Episode length: 309 Return: -279.9335789843854699
INFO:tensorflow:Average training steps per second: 311.72
I0903 00:14:20.597686 140369919707136 replay_runner.py:36] Average training steps per second: 311.72
I0903 00:14:20.902323 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.93
INFO:tensorflow:Starting iteration 20

Steps executed: 214 Episode length: 53 Return: -107.98571854175918699
INFO:tensorflow:Average training steps per second: 317.51
I0903 00:14:27.365912 140369919707136 replay_runner.py:36] Average training steps per second: 317.51
I0903 00:14:27.494220 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.04
INFO:tensorflow:Starting iteration 21

Steps executed: 217 Episode length: 74 Return: -147.53417261991936799
INFO:tensorflow:Average training steps per second: 316.73
I0903 00:14:33.928425 140369919707136 replay_runner.py:36] Average training steps per second: 316.73
I0903 00:14:34.060113 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.66
INFO:tensorflow:Starting iteration 22

Steps executed: 265 Episode length: 94 Return: -454.93349751547923799
INFO:tensorflow:Average training steps per second: 320.25
I0903 00:14:40.498449 140369919707136 replay_runner.py:36] Average training steps per second: 320.25
I0903 00:14:40.663670 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.01
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 78 Return: -52.951425708040395799
INFO:tensorflow:Average training steps per second: 334.92
I0903 00:14:46.966173 140369919707136 replay_runner.py:36] Average training steps per second: 334.92
I0903 00:14:47.078980 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.48
INFO:tensorflow:Starting iteration 24

Steps executed: 261 Episode length: 98 Return: -93.980631089535937799
INFO:tensorflow:Average training steps per second: 338.45
I0903 00:14:53.420399 140369919707136 replay_runner.py:36] Average training steps per second: 338.45
I0903 00:14:53.599413 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.89
INFO:tensorflow:Starting iteration 25

Steps executed: 290 Episode length: 107 Return: -768.1634049469662799
INFO:tensorflow:Average training steps per second: 337.13
I0903 00:14:59.993031 140369919707136 replay_runner.py:36] Average training steps per second: 337.13
I0903 00:15:00.148966 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.22
INFO:tensorflow:Starting iteration 26

Steps executed: 257 Episode length: 69 Return: -124.48013796324423799
INFO:tensorflow:Average training steps per second: 335.17
I0903 00:15:06.578146 140369919707136 replay_runner.py:36] Average training steps per second: 335.17
I0903 00:15:06.702600 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.70
INFO:tensorflow:Starting iteration 27

Steps executed: 252 Episode length: 70 Return: -152.71254315627914799
INFO:tensorflow:Average training steps per second: 340.74
I0903 00:15:13.081215 140369919707136 replay_runner.py:36] Average training steps per second: 340.74
I0903 00:15:13.202801 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.78
INFO:tensorflow:Starting iteration 28

Steps executed: 268 Episode length: 101 Return: -396.2703565909114799
INFO:tensorflow:Average training steps per second: 341.33
I0903 00:15:19.503457 140369919707136 replay_runner.py:36] Average training steps per second: 341.33
I0903 00:15:19.660192 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -576.72
INFO:tensorflow:Starting iteration 29
I0903 00:15:23.053256 140369919707136 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 344.06
I0903 00:15:25.960088 140369919707136 replay_runner.py:36] Average training steps per second: 344.06


Done fixed training!Episode length: 107 Return: -544.7282771008136799