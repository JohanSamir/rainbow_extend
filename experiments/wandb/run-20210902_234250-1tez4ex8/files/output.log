Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0902 23:42:57.429320 140260243740672 run_experiment.py:549] Creating TrainRunner ...
I0902 23:42:57.438271 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:42:57.438507 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:42:57.438649 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:42:57.438757 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:42:57.438916 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:42:57.439005 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:42:57.439091 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:42:57.439173 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:42:57.439254 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:42:57.439335 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:42:57.439419 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:42:57.439641 140260243740672 dqn_agent.py:283] 	 seed: 1630626177438215
I0902 23:42:57.441614 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:42:57.441748 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:42:57.441848 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:42:57.441924 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:42:57.441993 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:42:57.442069 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:42:57.442214 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:42:57.442311 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:42:57.442382 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:42:57.481833 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:58.006821 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:58.021251 140260243740672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:42:58.033051 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:42:58.033246 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:42:58.033348 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:42:58.033413 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:42:58.033469 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:42:58.033521 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:42:58.033630 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:42:58.033711 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:42:58.033770 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:42:58.033837 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:42:58.033906 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:42:58.033980 140260243740672 dqn_agent.py:283] 	 seed: 1630626178033007
I0902 23:42:58.036434 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:42:58.036715 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:42:58.036891 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:42:58.037040 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:42:58.037122 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:42:58.037201 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:42:58.037322 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:42:58.037552 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:42:58.037708 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:42:58.075998 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:58.101183 140260243740672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:42:58.101541 140260243740672 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.34
I0902 23:43:04.935261 140260243740672 replay_runner.py:36] Average training steps per second: 146.34
I0902 23:43:06.061873 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1
I0902 23:43:06.254295 140260243740672 replay_runner.py:41] Starting iteration 1
Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.98
I0902 23:43:11.409978 140260243740672 replay_runner.py:36] Average training steps per second: 193.98
I0902 23:43:11.550528 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 2


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.25
I0902 23:43:16.830943 140260243740672 replay_runner.py:36] Average training steps per second: 196.25
I0902 23:43:16.971545 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:43:17.165824 140260243740672 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.47
I0902 23:43:22.179404 140260243740672 replay_runner.py:36] Average training steps per second: 199.47
I0902 23:43:22.316822 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 23:43:22.496767 140260243740672 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 193.78
I0902 23:43:27.657582 140260243740672 replay_runner.py:36] Average training steps per second: 193.78
I0902 23:43:27.799067 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:43:27.972102 140260243740672 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 200.24
I0902 23:43:32.966674 140260243740672 replay_runner.py:36] Average training steps per second: 200.24

Steps executed: 369 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 6

Steps executed: 372 Episode length: 199 Return: 199.0
INFO:tensorflow:Average training steps per second: 196.41
I0902 23:43:38.488511 140260243740672 replay_runner.py:36] Average training steps per second: 196.41
I0902 23:43:38.728295 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 7

Steps executed: 332 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 197.62
I0902 23:43:43.982027 140260243740672 replay_runner.py:36] Average training steps per second: 197.62
I0902 23:43:44.202262 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 8
I0902 23:43:44.390728 140260243740672 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 201.52

Steps executed: 392 Episode length: 200 Return: 200.0
I0902 23:43:49.607757 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 9
I0902 23:43:49.794502 140260243740672 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 189.47
I0902 23:43:55.072776 140260243740672 replay_runner.py:36] Average training steps per second: 189.47
I0902 23:43:55.206314 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.43
I0902 23:44:00.379733 140260243740672 replay_runner.py:36] Average training steps per second: 200.43
I0902 23:44:00.627697 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 11


Steps executed: 328 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 198.01
I0902 23:44:05.928097 140260243740672 replay_runner.py:36] Average training steps per second: 198.01
I0902 23:44:06.152939 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 12

Steps executed: 183 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 198.61
I0902 23:44:11.378816 140260243740672 replay_runner.py:36] Average training steps per second: 198.61

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 13

Steps executed: 309 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 194.71
I0902 23:44:16.958196 140260243740672 replay_runner.py:36] Average training steps per second: 194.71
I0902 23:44:17.175482 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 14

Steps executed: 365 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.93
I0902 23:44:22.530296 140260243740672 replay_runner.py:36] Average training steps per second: 193.93
I0902 23:44:22.795758 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 15

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.18
I0902 23:44:27.899989 140260243740672 replay_runner.py:36] Average training steps per second: 203.18
I0902 23:44:28.167969 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.50
INFO:tensorflow:Starting iteration 16

Steps executed: 334 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 194.62
I0902 23:44:33.486205 140260243740672 replay_runner.py:36] Average training steps per second: 194.62
I0902 23:44:33.709404 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 17

Steps executed: 372 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 195.82
I0902 23:44:39.010447 140260243740672 replay_runner.py:36] Average training steps per second: 195.82
I0902 23:44:39.262067 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 18

Steps executed: 341 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 190.55
I0902 23:44:44.699723 140260243740672 replay_runner.py:36] Average training steps per second: 190.55
I0902 23:44:44.955088 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 19

Steps executed: 369 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.81
I0902 23:44:50.269457 140260243740672 replay_runner.py:36] Average training steps per second: 194.81
I0902 23:44:50.518716 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 20
I0902 23:44:50.713619 140260243740672 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 190.67
I0902 23:44:55.958713 140260243740672 replay_runner.py:36] Average training steps per second: 190.67
I0902 23:44:56.097247 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21


Steps executed: 141 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 195.55
I0902 23:45:01.409574 140260243740672 replay_runner.py:36] Average training steps per second: 195.55

Steps executed: 341 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.56
I0902 23:45:07.036779 140260243740672 replay_runner.py:36] Average training steps per second: 192.56
I0902 23:45:07.171323 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:45:07.365419 140260243740672 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.60
I0902 23:45:12.585084 140260243740672 replay_runner.py:36] Average training steps per second: 191.60
I0902 23:45:12.716471 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:45:12.915990 140260243740672 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 194.40
I0902 23:45:18.060504 140260243740672 replay_runner.py:36] Average training steps per second: 194.40
I0902 23:45:18.189782 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 188 Episode length: 188 Return: 188.0
INFO:tensorflow:Average training steps per second: 192.16
I0902 23:45:23.575786 140260243740672 replay_runner.py:36] Average training steps per second: 192.16

Steps executed: 387 Episode length: 199 Return: 199.0
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.69
I0902 23:45:28.966083 140260243740672 replay_runner.py:36] Average training steps per second: 201.69
I0902 23:45:29.102220 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:45:29.304500 140260243740672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.42
I0902 23:45:34.502064 140260243740672 replay_runner.py:36] Average training steps per second: 192.42
I0902 23:45:34.633031 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:45:34.815127 140260243740672 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 200.48
I0902 23:45:39.803506 140260243740672 replay_runner.py:36] Average training steps per second: 200.48
I0902 23:45:39.940537 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.36
I0902 23:45:44.993982 140260243740672 replay_runner.py:36] Average training steps per second: 205.36
I0902 23:45:45.130406 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00