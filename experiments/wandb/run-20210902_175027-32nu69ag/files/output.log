Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0902 17:50:33.889211 140224194521088 run_experiment.py:549] Creating TrainRunner ...
I0902 17:50:33.907461 140224194521088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:33.907735 140224194521088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:33.910173 140224194521088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:33.910288 140224194521088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:33.910652 140224194521088 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:33.910754 140224194521088 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:50:33.910855 140224194521088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:33.911281 140224194521088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:33.911377 140224194521088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:33.911694 140224194521088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:33.911946 140224194521088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:33.912194 140224194521088 dqn_agent.py:283] 	 seed: 1630605033907391
I0902 17:50:33.917047 140224194521088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:33.917238 140224194521088 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:50:33.918750 140224194521088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:33.919043 140224194521088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:33.919174 140224194521088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:33.919275 140224194521088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:33.919364 140224194521088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:33.919503 140224194521088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:33.919615 140224194521088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:33.948406 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:34.315481 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:34.328142 140224194521088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:50:34.336227 140224194521088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:34.336504 140224194521088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:34.336769 140224194521088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:34.336913 140224194521088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:34.336997 140224194521088 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:34.337076 140224194521088 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:50:34.337165 140224194521088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:34.337404 140224194521088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:34.337589 140224194521088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:34.337694 140224194521088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:34.337773 140224194521088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:34.337893 140224194521088 dqn_agent.py:283] 	 seed: 1630605034336177
I0902 17:50:34.340571 140224194521088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:34.340714 140224194521088 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:50:34.340849 140224194521088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:34.340965 140224194521088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:34.341090 140224194521088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:34.341169 140224194521088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:34.341266 140224194521088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:34.341365 140224194521088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:34.341488 140224194521088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:34.401210 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:50:34.422963 140224194521088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:50:34.423293 140224194521088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.69
I0902 17:50:40.806059 140224194521088 replay_runner.py:36] Average training steps per second: 156.69
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:50:42.206574 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:50:42.429495 140224194521088 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 225.09
I0902 17:50:46.872665 140224194521088 replay_runner.py:36] Average training steps per second: 225.09
I0902 17:50:47.219905 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:50:47.443406 140224194521088 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 214.75
I0902 17:50:52.100344 140224194521088 replay_runner.py:36] Average training steps per second: 214.75
I0902 17:50:52.515652 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:50:52.770483 140224194521088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 195.58
I0902 17:50:57.884075 140224194521088 replay_runner.py:36] Average training steps per second: 195.58
I0902 17:50:58.294821 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:50:58.533793 140224194521088 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 202.87
I0902 17:51:03.463415 140224194521088 replay_runner.py:36] Average training steps per second: 202.87
I0902 17:51:03.898825 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:51:04.143646 140224194521088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 204.46
I0902 17:51:09.035072 140224194521088 replay_runner.py:36] Average training steps per second: 204.46
I0902 17:51:09.448620 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:51:09.693310 140224194521088 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 201.15
I0902 17:51:14.664991 140224194521088 replay_runner.py:36] Average training steps per second: 201.15
I0902 17:51:15.089896 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:51:15.333134 140224194521088 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 199.90
I0902 17:51:20.336141 140224194521088 replay_runner.py:36] Average training steps per second: 199.90
I0902 17:51:20.739774 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:51:20.980684 140224194521088 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 201.35
I0902 17:51:25.947567 140224194521088 replay_runner.py:36] Average training steps per second: 201.35
I0902 17:51:26.344015 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:51:26.586113 140224194521088 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 200.54
I0902 17:51:31.573102 140224194521088 replay_runner.py:36] Average training steps per second: 200.54
I0902 17:51:31.999762 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:51:32.247017 140224194521088 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 202.98
I0902 17:51:37.174024 140224194521088 replay_runner.py:36] Average training steps per second: 202.98
I0902 17:51:37.572861 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:51:37.822036 140224194521088 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.61
I0902 17:51:42.883007 140224194521088 replay_runner.py:36] Average training steps per second: 197.61
I0902 17:51:43.293684 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 232 Episode length: 232 Return: -231.0
INFO:tensorflow:Average training steps per second: 205.00
I0902 17:51:48.413627 140224194521088 replay_runner.py:36] Average training steps per second: 205.00
I0902 17:51:48.611322 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.00
INFO:tensorflow:Starting iteration 13
I0902 17:51:48.854367 140224194521088 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.44

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:51:54.296568 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 324 Episode length: 207 Return: -206.0
INFO:tensorflow:Average training steps per second: 199.87
I0902 17:51:59.537235 140224194521088 replay_runner.py:36] Average training steps per second: 199.87
I0902 17:51:59.801981 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.00
INFO:tensorflow:Starting iteration 15

Steps executed: 338 Episode length: 183 Return: -182.0
INFO:tensorflow:Average training steps per second: 201.44
I0902 17:52:05.016120 140224194521088 replay_runner.py:36] Average training steps per second: 201.44
I0902 17:52:05.294226 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.00
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.70
I0902 17:52:10.575312 140224194521088 replay_runner.py:36] Average training steps per second: 198.70
I0902 17:52:10.987200 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:52:11.230093 140224194521088 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 200.60
I0902 17:52:16.215319 140224194521088 replay_runner.py:36] Average training steps per second: 200.60
I0902 17:52:16.618670 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:52:16.871567 140224194521088 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 197.51
I0902 17:52:21.935178 140224194521088 replay_runner.py:36] Average training steps per second: 197.51
I0902 17:52:22.336806 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:52:22.562953 140224194521088 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 200.64
I0902 17:52:27.547354 140224194521088 replay_runner.py:36] Average training steps per second: 200.64
I0902 17:52:27.961556 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:52:28.208113 140224194521088 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 202.36
I0902 17:52:33.150186 140224194521088 replay_runner.py:36] Average training steps per second: 202.36
I0902 17:52:33.556809 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:52:33.803464 140224194521088 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 203.08
I0902 17:52:38.727850 140224194521088 replay_runner.py:36] Average training steps per second: 203.08
I0902 17:52:39.135944 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 17:52:39.382665 140224194521088 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 201.78
I0902 17:52:44.338923 140224194521088 replay_runner.py:36] Average training steps per second: 201.78
I0902 17:52:44.733656 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 17:52:44.977523 140224194521088 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.02
I0902 17:52:49.977325 140224194521088 replay_runner.py:36] Average training steps per second: 200.02
I0902 17:52:50.409360 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:52:50.646109 140224194521088 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 201.09
I0902 17:52:55.619560 140224194521088 replay_runner.py:36] Average training steps per second: 201.09
I0902 17:52:56.017331 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 17:52:56.259658 140224194521088 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.67
I0902 17:53:01.218608 140224194521088 replay_runner.py:36] Average training steps per second: 201.67
I0902 17:53:01.628785 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:53:01.870949 140224194521088 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 209.78
I0902 17:53:06.638126 140224194521088 replay_runner.py:36] Average training steps per second: 209.78
I0902 17:53:07.054977 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 17:53:07.273472 140224194521088 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 215.12
I0902 17:53:11.922408 140224194521088 replay_runner.py:36] Average training steps per second: 215.12
I0902 17:53:12.324625 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0902 17:53:12.593926 140224194521088 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 215.28
I0902 17:53:17.239334 140224194521088 replay_runner.py:36] Average training steps per second: 215.28
I0902 17:53:17.643300 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 146 Return: -145.0
INFO:tensorflow:Average training steps per second: 203.61
I0902 17:53:22.785047 140224194521088 replay_runner.py:36] Average training steps per second: 203.61
I0902 17:53:23.012757 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00