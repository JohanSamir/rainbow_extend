Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0905 18:51:34.200766 139666636298240 run_experiment.py:549] Creating TrainRunner ...
I0905 18:51:34.213861 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:51:34.214125 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:51:34.214321 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:51:34.214436 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:51:34.214540 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 18:51:34.214634 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:51:34.214911 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:51:34.215041 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:51:34.215182 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:51:34.215285 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 18:51:34.215375 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:51:34.215456 139666636298240 dqn_agent.py:283] 	 seed: 1630867894213792
I0905 18:51:34.218310 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:51:34.218529 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:51:34.218664 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:51:34.218770 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:51:34.218865 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:51:34.218956 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:51:34.219044 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:51:34.219138 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:51:34.219230 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:51:34.713671 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:35.072555 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:35.085052 139666636298240 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:51:35.093859 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:51:35.094046 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:51:35.094156 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:51:35.094225 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:51:35.094280 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 18:51:35.094333 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:51:35.094385 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:51:35.094487 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:51:35.094544 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:51:35.094611 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 18:51:35.094698 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:51:35.094767 139666636298240 dqn_agent.py:283] 	 seed: 1630867895093812
I0905 18:51:35.096776 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:51:35.097027 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:51:35.097145 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:51:35.097252 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:51:35.097387 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:51:35.097470 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:51:35.097567 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:51:35.097669 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:51:35.097824 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:51:35.125657 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:51:35.148940 139666636298240 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:51:35.149144 139666636298240 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 157.06
I0905 18:51:41.516528 139666636298240 replay_runner.py:36] Average training steps per second: 157.06
Steps executed: 337 Episode length: 143 Return: -314.91402616242813
I0905 18:51:42.838203 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.97
INFO:tensorflow:Starting iteration 1
I0905 18:51:47.073958 139666636298240 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 212.59
I0905 18:51:51.779021 139666636298240 replay_runner.py:36] Average training steps per second: 212.59

Steps executed: 293 Episode length: 163 Return: -363.85507723164183
INFO:tensorflow:Starting iteration 2

Steps executed: 231 Episode length: 231 Return: -353.14811260192813
INFO:tensorflow:Average training steps per second: 223.78
I0905 18:52:00.834820 139666636298240 replay_runner.py:36] Average training steps per second: 223.78
I0905 18:52:01.069409 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.15
INFO:tensorflow:Starting iteration 3
I0905 18:52:05.321005 139666636298240 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 221.22

Steps executed: 466 Episode length: 466 Return: -198.53202250256012
I0905 18:52:10.660397 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.53
INFO:tensorflow:Starting iteration 4
I0905 18:52:14.861901 139666636298240 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 246.13

Steps executed: 1000 Episode length: 1000 Return: -96.22549371176586
I0905 18:52:20.782757 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.23
INFO:tensorflow:Starting iteration 5
I0905 18:52:24.631800 139666636298240 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 258.76
I0905 18:52:28.497573 139666636298240 replay_runner.py:36] Average training steps per second: 258.76

Steps executed: 1000 Episode length: 1000 Return: -252.9422373994704
INFO:tensorflow:Starting iteration 6
I0905 18:52:36.625076 139666636298240 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 211.95

Steps executed: 1000 Episode length: 1000 Return: -271.44544849464955
I0905 18:52:44.104442 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.45
INFO:tensorflow:Starting iteration 7
I0905 18:52:48.546259 139666636298240 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 199.05

Steps executed: 1000 Episode length: 1000 Return: -162.96387977629985
I0905 18:52:56.792191 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.96
INFO:tensorflow:Starting iteration 8

Steps executed: 433 Episode length: 433 Return: -376.3426032148038985
INFO:tensorflow:Average training steps per second: 200.58
I0905 18:53:06.047051 139666636298240 replay_runner.py:36] Average training steps per second: 200.58
I0905 18:53:07.028474 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.34
INFO:tensorflow:Starting iteration 9
I0905 18:53:11.622234 139666636298240 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 202.25

Steps executed: 1000 Episode length: 1000 Return: -194.83022405599968
I0905 18:53:18.721323 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.83
INFO:tensorflow:Starting iteration 10
I0905 18:53:23.366136 139666636298240 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 202.67

Steps executed: 731 Episode length: 731 Return: -415.2387724681837568
I0905 18:53:30.363362 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.24
INFO:tensorflow:Starting iteration 11
I0905 18:53:34.857550 139666636298240 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 202.11

Steps executed: 348 Episode length: 348 Return: -154.5919293419789368
I0905 18:53:40.448356 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.59
INFO:tensorflow:Starting iteration 12
I0905 18:53:45.059709 139666636298240 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 201.93

Steps executed: 1000 Episode length: 1000 Return: -204.43778277605328
I0905 18:53:53.166795 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.44
INFO:tensorflow:Starting iteration 13
I0905 18:53:57.745945 139666636298240 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 204.58

Steps executed: 932 Episode length: 932 Return: -353.8712812873863328
I0905 18:54:06.271281 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.87
INFO:tensorflow:Starting iteration 14

Steps executed: 293 Episode length: 293 Return: -163.0218285448213328
INFO:tensorflow:Average training steps per second: 203.73
I0905 18:54:15.810476 139666636298240 replay_runner.py:36] Average training steps per second: 203.73
I0905 18:54:16.192162 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.02
INFO:tensorflow:Starting iteration 15

Steps executed: 441 Episode length: 441 Return: -207.0803470808395328
INFO:tensorflow:Average training steps per second: 203.59
I0905 18:54:25.337990 139666636298240 replay_runner.py:36] Average training steps per second: 203.59
I0905 18:54:26.099002 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.08
INFO:tensorflow:Starting iteration 16
I0905 18:54:30.723666 139666636298240 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 201.69

Steps executed: 1000 Episode length: 1000 Return: -182.31100906272755
I0905 18:54:40.363670 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.31
INFO:tensorflow:Starting iteration 17
I0905 18:54:44.773469 139666636298240 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.34

Steps executed: 1000 Episode length: 1000 Return: -5.1337086776467755
I0905 18:54:53.093944 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.13
INFO:tensorflow:Starting iteration 18
I0905 18:54:57.742145 139666636298240 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 199.25

Steps executed: 1000 Episode length: 1000 Return: -72.801727293769135
I0905 18:55:06.065480 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.80
INFO:tensorflow:Starting iteration 19
I0905 18:55:10.724123 139666636298240 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 202.62

Steps executed: 512 Episode length: 512 Return: 203.42194530741514135
I0905 18:55:16.767572 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 203.42
INFO:tensorflow:Starting iteration 20

Steps executed: 244 Episode length: 66 Return: -107.57847842789023635
INFO:tensorflow:Average training steps per second: 204.19
I0905 18:55:26.344285 139666636298240 replay_runner.py:36] Average training steps per second: 204.19
I0905 18:55:26.547174 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.93
INFO:tensorflow:Starting iteration 21

Steps executed: 255 Episode length: 255 Return: -100.9459892905707235
INFO:tensorflow:Average training steps per second: 211.50
I0905 18:55:35.549996 139666636298240 replay_runner.py:36] Average training steps per second: 211.50
I0905 18:55:35.902514 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.95
INFO:tensorflow:Starting iteration 22

Steps executed: 299 Episode length: 150 Return: -711.7140994535123235
INFO:tensorflow:Average training steps per second: 221.88
I0905 18:55:44.907158 139666636298240 replay_runner.py:36] Average training steps per second: 221.88
I0905 18:55:45.161599 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -716.81
INFO:tensorflow:Starting iteration 23
I0905 18:55:49.642809 139666636298240 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.53
I0905 18:55:54.137248 139666636298240 replay_runner.py:36] Average training steps per second: 222.53

Steps executed: 256 Episode length: 102 Return: -168.2432705939872635
INFO:tensorflow:Starting iteration 24

Steps executed: 240 Episode length: 83 Return: -130.19390582234777635
INFO:tensorflow:Average training steps per second: 202.77
I0905 18:56:03.789433 139666636298240 replay_runner.py:36] Average training steps per second: 202.77
I0905 18:56:04.016062 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.37
INFO:tensorflow:Starting iteration 25
I0905 18:56:08.577897 139666636298240 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 183.93
I0905 18:56:14.015813 139666636298240 replay_runner.py:36] Average training steps per second: 183.93

Steps executed: 261 Episode length: 261 Return: -62.59494072268309635
INFO:tensorflow:Starting iteration 26
I0905 18:56:18.771384 139666636298240 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 183.08
I0905 18:56:24.233855 139666636298240 replay_runner.py:36] Average training steps per second: 183.08

Steps executed: 285 Episode length: 188 Return: 33.897562154721709635
INFO:tensorflow:Starting iteration 27

Steps executed: 245 Episode length: 245 Return: -570.0892232866399635
INFO:tensorflow:Average training steps per second: 196.27
I0905 18:56:33.745188 139666636298240 replay_runner.py:36] Average training steps per second: 196.27
I0905 18:56:34.139938 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.09
INFO:tensorflow:Starting iteration 28

Steps executed: 274 Episode length: 274 Return: 216.38941972036935635
INFO:tensorflow:Average training steps per second: 208.10
I0905 18:56:43.752619 139666636298240 replay_runner.py:36] Average training steps per second: 208.10
I0905 18:56:44.180719 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: 216.39
INFO:tensorflow:Starting iteration 29

Steps executed: 56 Episode length: 56 Return: -121.637935373327375635
INFO:tensorflow:Average training steps per second: 179.65
I0905 18:56:54.273202 139666636298240 replay_runner.py:36] Average training steps per second: 179.65


Done fixed training!Episode length: 106 Return: -94.32032357264634635