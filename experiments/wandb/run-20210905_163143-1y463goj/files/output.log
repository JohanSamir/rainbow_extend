I0905 16:31:50.318409 140017592051712 run_experiment.py:549] Creating TrainRunner ...
I0905 16:31:50.327307 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:31:50.327507 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:31:50.327592 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:31:50.327664 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:31:50.327730 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:31:50.327829 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:31:50.327958 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:31:50.328021 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:31:50.328094 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:31:50.328170 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:31:50.328227 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:31:50.328378 140017592051712 dqn_agent.py:283] 	 seed: 1630859510327258
I0905 16:31:50.331754 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:31:50.332018 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:31:50.332258 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:31:50.332489 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:31:50.332625 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:31:50.332732 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:31:50.332835 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:31:50.332992 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:31:50.333171 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0905 16:31:51.909686 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:52.532392 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:52.544244 140017592051712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:31:52.553028 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:31:52.553203 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:31:52.553278 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:31:52.553341 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:31:52.553394 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:31:52.553445 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:31:52.553497 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:31:52.553584 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:31:52.553642 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:31:52.553694 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:31:52.553743 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:31:52.553839 140017592051712 dqn_agent.py:283] 	 seed: 1630859512552985
I0905 16:31:52.555848 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:31:52.555992 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:31:52.556065 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:31:52.556127 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:31:52.556225 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:31:52.556390 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:31:52.556473 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:31:52.556540 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:31:52.556600 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:31:52.586111 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:31:52.603424 140017592051712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:31:52.603624 140017592051712 replay_runner.py:41] Starting iteration 0
Steps executed: 37 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 157.64

Steps executed: 203 Episode length: 10 Return: 10.0
I0905 16:32:00.024994 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 73 Return: 73.0
INFO:tensorflow:Average training steps per second: 197.85
I0905 16:32:05.262881 140017592051712 replay_runner.py:36] Average training steps per second: 197.85
I0905 16:32:05.494316 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.00
INFO:tensorflow:Starting iteration 2

Steps executed: 390 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 185.48
I0905 16:32:11.096058 140017592051712 replay_runner.py:36] Average training steps per second: 185.48
I0905 16:32:11.447097 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.57
I0905 16:32:17.073169 140017592051712 replay_runner.py:36] Average training steps per second: 184.57
I0905 16:32:17.318405 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 344 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 169.07
I0905 16:32:23.440985 140017592051712 replay_runner.py:36] Average training steps per second: 169.07
I0905 16:32:23.802067 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 5

Steps executed: 305 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 160.12
I0905 16:32:30.292029 140017592051712 replay_runner.py:36] Average training steps per second: 160.12
I0905 16:32:30.845497 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.50
INFO:tensorflow:Starting iteration 6
I0905 16:32:31.128736 140017592051712 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 145.50

Steps executed: 293 Episode length: 153 Return: 153.0
I0905 16:32:38.567979 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 7
I0905 16:32:38.870132 140017592051712 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 146.43

Steps executed: 387 Episode length: 200 Return: 200.0
I0905 16:32:46.436557 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 8

Steps executed: 185 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 142.60

Steps executed: 331 Episode length: 146 Return: 146.0
I0905 16:32:54.219541 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 141.34
I0905 16:33:01.511363 140017592051712 replay_runner.py:36] Average training steps per second: 141.34
I0905 16:33:01.951254 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 348 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 147.93
I0905 16:33:08.945730 140017592051712 replay_runner.py:36] Average training steps per second: 147.93
I0905 16:33:09.665370 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 11

Steps executed: 259 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 152.00
I0905 16:33:16.492030 140017592051712 replay_runner.py:36] Average training steps per second: 152.00
I0905 16:33:17.057385 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 142.66
I0905 16:33:24.332237 140017592051712 replay_runner.py:36] Average training steps per second: 142.66
I0905 16:33:24.980249 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 347 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 135.51
I0905 16:33:32.614944 140017592051712 replay_runner.py:36] Average training steps per second: 135.51
I0905 16:33:33.229715 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 14

Steps executed: 349 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 142.80
I0905 16:33:40.497341 140017592051712 replay_runner.py:36] Average training steps per second: 142.80
I0905 16:33:41.212089 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 15

Steps executed: 279 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 138.21
I0905 16:33:48.758786 140017592051712 replay_runner.py:36] Average training steps per second: 138.21
I0905 16:33:49.323941 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 16
I0905 16:33:49.564595 140017592051712 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 150.09

Steps executed: 340 Episode length: 150 Return: 150.0
I0905 16:33:57.142489 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 17

Steps executed: 361 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 138.59
I0905 16:34:04.650717 140017592051712 replay_runner.py:36] Average training steps per second: 138.59
I0905 16:34:05.295354 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.50
INFO:tensorflow:Starting iteration 18
I0905 16:34:05.517459 140017592051712 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 149.38

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:34:12.570854 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 16:34:12.822464 140017592051712 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 143.67
I0905 16:34:19.783928 140017592051712 replay_runner.py:36] Average training steps per second: 143.67
I0905 16:34:20.213674 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 16:34:20.475143 140017592051712 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 146.48
I0905 16:34:27.302732 140017592051712 replay_runner.py:36] Average training steps per second: 146.48
I0905 16:34:27.838528 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 16:34:28.081817 140017592051712 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 141.61
I0905 16:34:35.143720 140017592051712 replay_runner.py:36] Average training steps per second: 141.61
I0905 16:34:35.538737 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 16:34:35.818447 140017592051712 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 136.08
I0905 16:34:43.167529 140017592051712 replay_runner.py:36] Average training steps per second: 136.08
I0905 16:34:43.543563 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0905 16:34:43.803988 140017592051712 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 151.74
I0905 16:34:50.394845 140017592051712 replay_runner.py:36] Average training steps per second: 151.74
I0905 16:34:51.015644 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 171 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 144.51

Steps executed: 371 Episode length: 200 Return: 200.0
I0905 16:34:58.936237 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.50
INFO:tensorflow:Starting iteration 25

Steps executed: 171 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 144.34

Steps executed: 331 Episode length: 160 Return: 160.0
I0905 16:35:06.787442 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 152.50
I0905 16:35:13.662191 140017592051712 replay_runner.py:36] Average training steps per second: 152.50
I0905 16:35:14.225992 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:35:14.567685 140017592051712 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 138.18
I0905 16:35:21.805396 140017592051712 replay_runner.py:36] Average training steps per second: 138.18
I0905 16:35:22.199570 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 368 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 144.06
I0905 16:35:29.422750 140017592051712 replay_runner.py:36] Average training steps per second: 144.06
I0905 16:35:30.048364 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 137.75
I0905 16:35:37.568097 140017592051712 replay_runner.py:36] Average training steps per second: 137.75
I0905 16:35:38.096235 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50