I0902 23:18:50.380441 140082076076032 run_experiment.py:549] Creating TrainRunner ...
I0902 23:18:50.390963 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:18:50.391248 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:18:50.391393 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:18:50.391549 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:18:50.391685 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:18:50.391877 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:18:50.392020 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:18:50.392166 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:18:50.392293 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:18:50.392422 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:18:50.392553 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:18:50.392672 140082076076032 dqn_agent.py:283] 	 seed: 1630624730390888
I0902 23:18:50.395728 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:18:50.395935 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:18:50.396075 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:18:50.396209 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:18:50.396348 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:18:50.396495 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:18:50.396615 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:18:50.396738 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:18:50.396841 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 23:18:51.909632 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:52.443144 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:52.456804 140082076076032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:18:52.466442 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:18:52.466718 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:18:52.466879 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:18:52.467018 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:18:52.467235 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:18:52.467397 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:18:52.467534 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:18:52.467652 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:18:52.467752 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:18:52.467861 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:18:52.468011 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:18:52.468107 140082076076032 dqn_agent.py:283] 	 seed: 1630624732466381
I0902 23:18:52.470544 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:18:52.470701 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:18:52.470841 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:18:52.471021 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:18:52.471183 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:18:52.471379 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:18:52.471492 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:18:52.471897 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:18:52.472096 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:18:52.502750 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:52.523583 140082076076032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:18:52.524006 140082076076032 replay_runner.py:41] Starting iteration 0
Steps executed: 46 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 155.69

Steps executed: 205 Episode length: 10 Return: 10.0
I0902 23:19:00.017596 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 210.72
I0902 23:19:04.942670 140082076076032 replay_runner.py:36] Average training steps per second: 210.72
I0902 23:19:05.078359 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 2
I0902 23:19:05.255816 140082076076032 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 210.53

Steps executed: 356 Episode length: 182 Return: 182.0
I0902 23:19:10.215362 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 3

Steps executed: 364 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 210.26
I0902 23:19:15.157094 140082076076032 replay_runner.py:36] Average training steps per second: 210.26
I0902 23:19:15.377661 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.05
I0902 23:19:20.430593 140082076076032 replay_runner.py:36] Average training steps per second: 205.05
I0902 23:19:20.564846 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 381 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 197.41
I0902 23:19:25.820156 140082076076032 replay_runner.py:36] Average training steps per second: 197.41
I0902 23:19:26.062216 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 6

Steps executed: 331 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 199.04
I0902 23:19:31.280660 140082076076032 replay_runner.py:36] Average training steps per second: 199.04
I0902 23:19:31.509883 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 7

Steps executed: 282 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 199.71
I0902 23:19:36.714386 140082076076032 replay_runner.py:36] Average training steps per second: 199.71
I0902 23:19:36.906663 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 8

Steps executed: 302 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 201.30
I0902 23:19:42.056644 140082076076032 replay_runner.py:36] Average training steps per second: 201.30
I0902 23:19:42.251200 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.03
I0902 23:19:47.383734 140082076076032 replay_runner.py:36] Average training steps per second: 202.03
I0902 23:19:47.512661 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0902 23:19:47.698509 140082076076032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 207.79

Steps executed: 291 Episode length: 141 Return: 141.0
I0902 23:19:52.709766 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.50
INFO:tensorflow:Starting iteration 11

Steps executed: 275 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 200.27
I0902 23:19:57.896269 140082076076032 replay_runner.py:36] Average training steps per second: 200.27
I0902 23:19:58.088476 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 12

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.09
I0902 23:20:03.330330 140082076076032 replay_runner.py:36] Average training steps per second: 198.09
I0902 23:20:03.589174 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 13

Steps executed: 290 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 196.74
I0902 23:20:08.865061 140082076076032 replay_runner.py:36] Average training steps per second: 196.74
I0902 23:20:09.060386 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 14

Steps executed: 333 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 197.74
I0902 23:20:14.311751 140082076076032 replay_runner.py:36] Average training steps per second: 197.74
I0902 23:20:14.530377 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 15

Steps executed: 346 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 201.73
I0902 23:20:19.665109 140082076076032 replay_runner.py:36] Average training steps per second: 201.73
I0902 23:20:19.910197 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 16

Steps executed: 378 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.19
I0902 23:20:25.284955 140082076076032 replay_runner.py:36] Average training steps per second: 193.19
I0902 23:20:25.556547 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 17

Steps executed: 306 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 199.12
I0902 23:20:30.773703 140082076076032 replay_runner.py:36] Average training steps per second: 199.12
I0902 23:20:30.990688 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 18
I0902 23:20:31.192037 140082076076032 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.09
I0902 23:20:36.240926 140082076076032 replay_runner.py:36] Average training steps per second: 198.09

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 19
I0902 23:20:36.557335 140082076076032 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.25
I0902 23:20:41.679625 140082076076032 replay_runner.py:36] Average training steps per second: 195.25
I0902 23:20:41.824699 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:20:42.028871 140082076076032 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 200.90
I0902 23:20:47.007018 140082076076032 replay_runner.py:36] Average training steps per second: 200.90
I0902 23:20:47.142422 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:20:47.340081 140082076076032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 195.54
I0902 23:20:52.454488 140082076076032 replay_runner.py:36] Average training steps per second: 195.54
I0902 23:20:52.588719 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:20:52.783647 140082076076032 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.90
I0902 23:20:57.811530 140082076076032 replay_runner.py:36] Average training steps per second: 198.90
I0902 23:20:57.951731 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:20:58.149137 140082076076032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 196.08
I0902 23:21:03.253661 140082076076032 replay_runner.py:36] Average training steps per second: 196.08
I0902 23:21:03.389222 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:21:03.582196 140082076076032 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.29
I0902 23:21:08.677320 140082076076032 replay_runner.py:36] Average training steps per second: 196.29
I0902 23:21:08.824822 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:21:09.025079 140082076076032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 199.93
I0902 23:21:14.027603 140082076076032 replay_runner.py:36] Average training steps per second: 199.93
I0902 23:21:14.158302 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:21:14.348675 140082076076032 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.81
I0902 23:21:19.482702 140082076076032 replay_runner.py:36] Average training steps per second: 194.81
I0902 23:21:19.628216 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:21:19.822009 140082076076032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 200.68
I0902 23:21:24.805626 140082076076032 replay_runner.py:36] Average training steps per second: 200.68
I0902 23:21:24.947419 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:21:25.143535 140082076076032 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.62
I0902 23:21:30.308619 140082076076032 replay_runner.py:36] Average training steps per second: 193.62
I0902 23:21:30.439350 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 201.02
I0902 23:21:35.606206 140082076076032 replay_runner.py:36] Average training steps per second: 201.02
I0902 23:21:35.852876 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00