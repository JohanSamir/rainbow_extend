I0910 10:59:12.622480 140186230077440 run_experiment.py:549] Creating TrainRunner ...
I0910 10:59:12.628594 140186230077440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:59:12.628703 140186230077440 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:59:12.628781 140186230077440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:59:12.628845 140186230077440 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:59:12.628899 140186230077440 dqn_agent.py:275] 	 update_period: 4
I0910 10:59:12.628965 140186230077440 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:59:12.629046 140186230077440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:59:12.629131 140186230077440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:59:12.629195 140186230077440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:59:12.629266 140186230077440 dqn_agent.py:280] 	 optimizer: adam
I0910 10:59:12.629337 140186230077440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:59:12.629401 140186230077440 dqn_agent.py:283] 	 seed: 1631271552628564
I0910 10:59:12.630920 140186230077440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:59:12.631017 140186230077440 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:59:12.631083 140186230077440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:59:12.631139 140186230077440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:59:12.631196 140186230077440 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:59:12.631258 140186230077440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:59:12.631328 140186230077440 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:59:12.631407 140186230077440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:59:12.631458 140186230077440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:59:12.654970 140186230077440 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:59:12.672215 140186230077440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:59:12.672383 140186230077440 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:59:12.672457 140186230077440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:59:12.672516 140186230077440 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:59:12.672589 140186230077440 dqn_agent.py:275] 	 update_period: 4
I0910 10:59:12.672655 140186230077440 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:59:12.672706 140186230077440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:59:12.672833 140186230077440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:59:12.672896 140186230077440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:59:12.672956 140186230077440 dqn_agent.py:280] 	 optimizer: adam
I0910 10:59:12.673036 140186230077440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:59:12.673102 140186230077440 dqn_agent.py:283] 	 seed: 1631271552672177
I0910 10:59:12.674490 140186230077440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:59:12.674612 140186230077440 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:59:12.674690 140186230077440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:59:12.674751 140186230077440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:59:12.674804 140186230077440 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:59:12.674863 140186230077440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:59:12.674913 140186230077440 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:59:12.674993 140186230077440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:59:12.675058 140186230077440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:59:12.696212 140186230077440 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:59:12.710161 140186230077440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 10:59:12.710331 140186230077440 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 799524.21
I0910 10:59:12.711740 140186230077440 replay_runner.py:39] Average training steps per second: 799524.21
I0910 10:59:13.473077 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 10:59:13.517115 140186230077440 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 769173.67
I0910 10:59:13.518671 140186230077440 replay_runner.py:39] Average training steps per second: 769173.67
I0910 10:59:13.711398 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 10:59:13.753149 140186230077440 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 765523.64
I0910 10:59:13.754683 140186230077440 replay_runner.py:39] Average training steps per second: 765523.64
I0910 10:59:13.941279 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 10:59:13.981260 140186230077440 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 799981.69
I0910 10:59:13.982782 140186230077440 replay_runner.py:39] Average training steps per second: 799981.69
Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 10:59:14.162148 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 10:59:14.202217 140186230077440 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 792125.40
I0910 10:59:14.203735 140186230077440 replay_runner.py:39] Average training steps per second: 792125.40
I0910 10:59:14.404522 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 10:59:14.449222 140186230077440 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 658963.71
I0910 10:59:14.451021 140186230077440 replay_runner.py:39] Average training steps per second: 658963.71
I0910 10:59:14.683323 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 10:59:14.736575 140186230077440 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 555831.43
I0910 10:59:14.738749 140186230077440 replay_runner.py:39] Average training steps per second: 555831.43
I0910 10:59:14.950500 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 10:59:15.001934 140186230077440 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 594936.74
I0910 10:59:15.003921 140186230077440 replay_runner.py:39] Average training steps per second: 594936.74
I0910 10:59:15.218878 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 10:59:15.354245 140186230077440 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 788847.85
I0910 10:59:15.355889 140186230077440 replay_runner.py:39] Average training steps per second: 788847.85
I0910 10:59:15.591527 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 10:59:15.633772 140186230077440 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 771863.08
I0910 10:59:15.635294 140186230077440 replay_runner.py:39] Average training steps per second: 771863.08
I0910 10:59:15.855354 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 10:59:15.898180 140186230077440 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 775860.90
I0910 10:59:15.899697 140186230077440 replay_runner.py:39] Average training steps per second: 775860.90
I0910 10:59:16.134012 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 10:59:16.178641 140186230077440 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 752476.50
I0910 10:59:16.180193 140186230077440 replay_runner.py:39] Average training steps per second: 752476.50
I0910 10:59:16.395912 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 10:59:16.441775 140186230077440 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 780190.48
I0910 10:59:16.443415 140186230077440 replay_runner.py:39] Average training steps per second: 780190.48
I0910 10:59:16.674461 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 10:59:16.718924 140186230077440 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 658963.71
I0910 10:59:16.720685 140186230077440 replay_runner.py:39] Average training steps per second: 658963.71
I0910 10:59:16.957297 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 10:59:17.000888 140186230077440 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 765943.02
I0910 10:59:17.002460 140186230077440 replay_runner.py:39] Average training steps per second: 765943.02
I0910 10:59:17.224340 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 10:59:17.276774 140186230077440 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 579243.75
I0910 10:59:17.278825 140186230077440 replay_runner.py:39] Average training steps per second: 579243.75
I0910 10:59:17.479999 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 10:59:17.523889 140186230077440 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 688041.99
I0910 10:59:17.525590 140186230077440 replay_runner.py:39] Average training steps per second: 688041.99
I0910 10:59:17.759038 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 10:59:17.802880 140186230077440 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 748715.46
I0910 10:59:17.804466 140186230077440 replay_runner.py:39] Average training steps per second: 748715.46
I0910 10:59:18.025428 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 10:59:18.074035 140186230077440 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 698236.06
I0910 10:59:18.075701 140186230077440 replay_runner.py:39] Average training steps per second: 698236.06
I0910 10:59:18.309545 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 10:59:18.369627 140186230077440 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 555536.95
I0910 10:59:18.371814 140186230077440 replay_runner.py:39] Average training steps per second: 555536.95
I0910 10:59:18.582408 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 10:59:18.625392 140186230077440 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 731479.60
I0910 10:59:18.626976 140186230077440 replay_runner.py:39] Average training steps per second: 731479.60
I0910 10:59:18.866156 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 10:59:18.910069 140186230077440 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 766783.18
I0910 10:59:18.911616 140186230077440 replay_runner.py:39] Average training steps per second: 766783.18
I0910 10:59:19.109943 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 10:59:19.152763 140186230077440 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 771437.19
I0910 10:59:19.154281 140186230077440 replay_runner.py:39] Average training steps per second: 771437.19
I0910 10:59:19.347468 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 10:59:19.389274 140186230077440 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 783250.05
I0910 10:59:19.390804 140186230077440 replay_runner.py:39] Average training steps per second: 783250.05
I0910 10:59:19.624835 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 10:59:19.672254 140186230077440 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 741567.19
I0910 10:59:19.673861 140186230077440 replay_runner.py:39] Average training steps per second: 741567.19
I0910 10:59:19.871728 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 10:59:19.915618 140186230077440 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 744859.53
I0910 10:59:19.917235 140186230077440 replay_runner.py:39] Average training steps per second: 744859.53
I0910 10:59:20.113158 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 10:59:20.167048 140186230077440 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 535124.27

Done fixed training!Episode length: 600 Return: -600.0
I0910 10:59:20.370539 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 10:59:20.413484 140186230077440 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 768046.88
I0910 10:59:20.415035 140186230077440 replay_runner.py:39] Average training steps per second: 768046.88
I0910 10:59:20.600956 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 10:59:20.643080 140186230077440 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 788106.73
I0910 10:59:20.644573 140186230077440 replay_runner.py:39] Average training steps per second: 788106.73
I0910 10:59:20.866632 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 10:59:20.912501 140186230077440 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 777586.95
I0910 10:59:20.914009 140186230077440 replay_runner.py:39] Average training steps per second: 777586.95
I0910 10:59:21.124094 140186230077440 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00