Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0902 23:34:32.930457 140687300532224 run_experiment.py:549] Creating TrainRunner ...
I0902 23:34:32.939631 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:32.939878 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:32.940087 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:32.940225 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:32.940419 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:32.940547 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:32.940664 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:32.940827 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:32.941042 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:32.941136 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:32.941207 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:32.941276 140687300532224 dqn_agent.py:283] 	 seed: 1630625672939559
I0902 23:34:32.943950 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:32.944166 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:34:32.944443 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:32.944627 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:32.945062 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:32.945227 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:32.945331 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:32.945597 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:32.945816 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:32.982746 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:33.397206 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:33.411651 140687300532224 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:34:33.440670 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:33.440948 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:33.441117 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:33.441231 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:33.441337 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:33.441451 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:33.441695 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:33.441828 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:33.441917 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:33.442005 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:33.442212 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:33.442323 140687300532224 dqn_agent.py:283] 	 seed: 1630625673440612
I0902 23:34:33.444733 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:33.444898 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:34:33.445071 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:33.445224 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:33.445389 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:33.445499 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:33.445596 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:33.445694 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:33.445791 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:33.479260 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:33.510311 140687300532224 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:34:33.510987 140687300532224 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.87
I0902 23:34:40.320026 140687300532224 replay_runner.py:36] Average training steps per second: 146.87
Steps executed: 200 Episode length: 200 Return: -199.0
I0902 23:34:41.552778 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.00
INFO:tensorflow:Starting iteration 1

Steps executed: 254 Episode length: 254 Return: -253.0
INFO:tensorflow:Average training steps per second: 195.33
I0902 23:34:46.907480 140687300532224 replay_runner.py:36] Average training steps per second: 195.33
I0902 23:34:47.114117 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.00
INFO:tensorflow:Starting iteration 2
I0902 23:34:47.386162 140687300532224 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 198.18

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:34:52.852733 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 378 Episode length: 189 Return: -188.0
INFO:tensorflow:Average training steps per second: 198.23
I0902 23:34:58.137817 140687300532224 replay_runner.py:36] Average training steps per second: 198.23
I0902 23:34:58.469983 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.00
INFO:tensorflow:Starting iteration 4

Steps executed: 275 Episode length: 275 Return: -274.0
INFO:tensorflow:Average training steps per second: 196.89
I0902 23:35:03.790504 140687300532224 replay_runner.py:36] Average training steps per second: 196.89
I0902 23:35:04.029202 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.13
I0902 23:35:09.237659 140687300532224 replay_runner.py:36] Average training steps per second: 201.13
I0902 23:35:09.646951 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 215 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 200.38
I0902 23:35:14.884685 140687300532224 replay_runner.py:36] Average training steps per second: 200.38
I0902 23:35:15.120875 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.72
I0902 23:35:20.292449 140687300532224 replay_runner.py:36] Average training steps per second: 202.72
I0902 23:35:20.705037 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:35:20.953286 140687300532224 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.24
I0902 23:35:26.075582 140687300532224 replay_runner.py:36] Average training steps per second: 195.24
I0902 23:35:26.457573 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 296 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 201.74
I0902 23:35:31.649634 140687300532224 replay_runner.py:36] Average training steps per second: 201.74
I0902 23:35:31.900980 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 10
I0902 23:35:32.141671 140687300532224 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 203.86

Steps executed: 318 Episode length: 128 Return: -127.0
I0902 23:35:37.315791 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.83
I0902 23:35:42.495121 140687300532224 replay_runner.py:36] Average training steps per second: 202.83
I0902 23:35:42.933786 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 243 Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 198.04
I0902 23:35:48.228736 140687300532224 replay_runner.py:36] Average training steps per second: 198.04
I0902 23:35:48.452559 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 13

Steps executed: 283 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 187.57
I0902 23:35:54.043618 140687300532224 replay_runner.py:36] Average training steps per second: 187.57
I0902 23:35:54.296447 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 14

Steps executed: 214 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 194.77
I0902 23:35:59.675376 140687300532224 replay_runner.py:36] Average training steps per second: 194.77
I0902 23:35:59.857618 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 15
I0902 23:36:00.102901 140687300532224 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 199.05

Steps executed: 288 Episode length: 113 Return: -112.0
I0902 23:36:05.362773 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 16
I0902 23:36:05.578315 140687300532224 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 193.11
I0902 23:36:10.757065 140687300532224 replay_runner.py:36] Average training steps per second: 193.11
I0902 23:36:10.939297 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 17


Steps executed: 267 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 194.51
I0902 23:36:16.327815 140687300532224 replay_runner.py:36] Average training steps per second: 194.51
I0902 23:36:16.555475 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 18

Steps executed: 273 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 197.51
I0902 23:36:21.875503 140687300532224 replay_runner.py:36] Average training steps per second: 197.51
I0902 23:36:22.099594 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 197.79
I0902 23:36:27.397944 140687300532224 replay_runner.py:36] Average training steps per second: 197.79
I0902 23:36:27.604887 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 20

Steps executed: 262 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 204.10
I0902 23:36:32.731401 140687300532224 replay_runner.py:36] Average training steps per second: 204.10
I0902 23:36:32.947809 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 21

Steps executed: 261 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 198.48
I0902 23:36:38.211807 140687300532224 replay_runner.py:36] Average training steps per second: 198.48
I0902 23:36:38.436744 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 22

Steps executed: 247 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 203.05
I0902 23:36:43.609736 140687300532224 replay_runner.py:36] Average training steps per second: 203.05
I0902 23:36:43.824143 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 23
I0902 23:36:44.055393 140687300532224 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 196.73

Steps executed: 260 Episode length: 78 Return: -77.0.0
I0902 23:36:49.365271 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 24

Steps executed: 253 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 204.44
I0902 23:36:54.492499 140687300532224 replay_runner.py:36] Average training steps per second: 204.44
I0902 23:36:54.694710 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 25

Steps executed: 238 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 202.50
I0902 23:36:59.859954 140687300532224 replay_runner.py:36] Average training steps per second: 202.50
I0902 23:37:00.058678 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 26

Steps executed: 193 Episode length: 193 Return: -192.0
INFO:tensorflow:Average training steps per second: 204.93

Steps executed: 281 Episode length: 88 Return: -87.0.0
I0902 23:37:05.437371 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.50
INFO:tensorflow:Starting iteration 27

Steps executed: 203 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 194.35
I0902 23:37:10.818243 140687300532224 replay_runner.py:36] Average training steps per second: 194.35
I0902 23:37:10.991349 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 28

Steps executed: 206 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 195.90
I0902 23:37:16.321169 140687300532224 replay_runner.py:36] Average training steps per second: 195.90
I0902 23:37:16.502663 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 151 Return: -150.0
INFO:tensorflow:Average training steps per second: 199.90
I0902 23:37:21.748852 140687300532224 replay_runner.py:36] Average training steps per second: 199.90
I0902 23:37:21.999830 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67