I0901 23:29:06.468342 139644712736768 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 23:29:06.469088 139644712736768 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 23:29:06.578809 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:06.580850 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:06.581012 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:06.581127 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:06.581224 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:06.581312 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:06.581406 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:06.581508 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:06.581758 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:06.581898 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:06.582046 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:06.582181 139644712736768 dqn_agent.py:283] 	 seed: 1630538946578688
I0901 23:29:06.585131 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:06.585332 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:06.585444 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:06.585536 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:06.585622 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:06.585707 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:06.585818 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:06.585972 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:06.586087 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:29:13.866705 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 23:29:14.977562 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:15.107798 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:29:15.141983 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:15.152781 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:15.153758 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:15.154341 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:15.154919 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:15.155540 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:15.156177 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:15.156723 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:15.157263 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:15.157845 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:15.158380 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:15.158977 139644712736768 dqn_agent.py:283] 	 seed: 1630538955141932
I0901 23:29:15.164003 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:15.169483 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:15.169978 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:15.170541 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:15.171205 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:15.171787 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:15.172308 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:15.172847 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:15.173351 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:29:16.067199 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:16.158966 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:29:16.159288 139644712736768 replay_runner.py:41] Starting iteration 0
Steps executed: 225 Episode length: 89 Return: -338.024927452396713
INFO:tensorflow:Average training steps per second: 148.62
I0901 23:29:22.888142 139644712736768 replay_runner.py:36] Average training steps per second: 148.62
I0901 23:29:23.907373 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.93
INFO:tensorflow:Starting iteration 1

Steps executed: 304 Episode length: 159 Return: -544.74606891073813
INFO:tensorflow:Average training steps per second: 203.84
I0901 23:29:32.774638 139644712736768 replay_runner.py:36] Average training steps per second: 203.84
I0901 23:29:33.115002 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -516.70
INFO:tensorflow:Starting iteration 2
I0901 23:29:37.096312 139644712736768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 204.05

Steps executed: 330 Episode length: 207 Return: -387.25817710571766
I0901 23:29:42.376086 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.46
INFO:tensorflow:Starting iteration 3
I0901 23:29:46.584668 139644712736768 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 206.37

Steps executed: 1000 Episode length: 1000 Return: -130.9865749667224
I0901 23:29:55.013846 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.99
INFO:tensorflow:Starting iteration 4
I0901 23:29:59.429106 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 208.75

Steps executed: 1000 Episode length: 1000 Return: -154.9358132518574
I0901 23:30:07.119961 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.94
INFO:tensorflow:Starting iteration 5
I0901 23:30:11.431968 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 213.57

Steps executed: 1000 Episode length: 1000 Return: -199.2486990814252
I0901 23:30:19.959165 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.25
INFO:tensorflow:Starting iteration 6
I0901 23:30:24.179588 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 211.64

Steps executed: 949 Episode length: 949 Return: -1090.49832651880352
I0901 23:30:30.878031 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -1090.50
INFO:tensorflow:Starting iteration 7
I0901 23:30:35.207466 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 214.81

Steps executed: 1000 Episode length: 1000 Return: -657.7264924401252
I0901 23:30:41.813936 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -657.73
INFO:tensorflow:Starting iteration 8

Steps executed: 661 Episode length: 661 Return: -418.422829969519572
INFO:tensorflow:Average training steps per second: 213.98
I0901 23:30:50.809122 139644712736768 replay_runner.py:36] Average training steps per second: 213.98
I0901 23:30:52.397289 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.42
INFO:tensorflow:Starting iteration 9
I0901 23:30:56.607031 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 212.89

Steps executed: 694 Episode length: 694 Return: -2272.75651038238172
I0901 23:31:02.864798 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -2272.76
INFO:tensorflow:Starting iteration 10
I0901 23:31:07.127217 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 212.04

Steps executed: 671 Episode length: 671 Return: -1012.68718284050662
I0901 23:31:13.315818 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -1012.69
INFO:tensorflow:Starting iteration 11
I0901 23:31:17.576826 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 214.38

Steps executed: 395 Episode length: 395 Return: -445.240128248401732
I0901 23:31:22.751397 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.24
INFO:tensorflow:Starting iteration 12
I0901 23:31:26.962387 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 222.90

Steps executed: 879 Episode length: 879 Return: -196.728361346361232
I0901 23:31:33.916219 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.73
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 111 Return: -860.075050376839432
INFO:tensorflow:Average training steps per second: 214.18
I0901 23:31:42.861119 139644712736768 replay_runner.py:36] Average training steps per second: 214.18
I0901 23:31:43.152946 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -810.18
INFO:tensorflow:Starting iteration 14
I0901 23:31:47.312212 139644712736768 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 218.26

Steps executed: 575 Episode length: 575 Return: 206.0947058328612832
I0901 23:31:52.942455 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 206.09
INFO:tensorflow:Starting iteration 15
I0901 23:31:57.308126 139644712736768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 223.82

Steps executed: 1000 Episode length: 1000 Return: -93.38340812738879
I0901 23:32:05.503915 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.38
INFO:tensorflow:Starting iteration 16
I0901 23:32:09.303988 139644712736768 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 264.80

Steps executed: 1000 Episode length: 1000 Return: -127.76305490303007
I0901 23:32:16.447948 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.76
INFO:tensorflow:Starting iteration 17
I0901 23:32:20.468478 139644712736768 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 231.15
I0901 23:32:24.794979 139644712736768 replay_runner.py:36] Average training steps per second: 231.15

Steps executed: 217 Episode length: 76 Return: -151.89325654833672607
INFO:tensorflow:Starting iteration 18

Steps executed: 139 Episode length: 139 Return: -125.8366369207985607
INFO:tensorflow:Average training steps per second: 208.25

Steps executed: 929 Episode length: 790 Return: -144.8066259861736607
I0901 23:32:36.364961 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.32
INFO:tensorflow:Starting iteration 19
I0901 23:32:40.670239 139644712736768 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 225.45

Steps executed: 1000 Episode length: 1000 Return: -158.51157296615457
I0901 23:32:49.844643 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.51
INFO:tensorflow:Starting iteration 20
I0901 23:32:54.112919 139644712736768 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 222.85

Steps executed: 285 Episode length: 285 Return: -317.5317912552077457
I0901 23:32:59.007817 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.53
INFO:tensorflow:Starting iteration 21

Steps executed: 325 Episode length: 325 Return: -10.85040475904980957
INFO:tensorflow:Average training steps per second: 227.43
I0901 23:33:07.606206 139644712736768 replay_runner.py:36] Average training steps per second: 227.43
I0901 23:33:08.040817 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -10.85
INFO:tensorflow:Starting iteration 22
I0901 23:33:12.413013 139644712736768 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 228.32

Steps executed: 386 Episode length: 386 Return: 19.813523027664687957
I0901 23:33:17.395773 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.81
INFO:tensorflow:Starting iteration 23

Steps executed: 226 Episode length: 226 Return: -49.36962491290064957
INFO:tensorflow:Average training steps per second: 225.97
I0901 23:33:26.152521 139644712736768 replay_runner.py:36] Average training steps per second: 225.97
I0901 23:33:26.414032 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.37
INFO:tensorflow:Starting iteration 24
I0901 23:33:30.792708 139644712736768 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 218.98

Steps executed: 1000 Episode length: 1000 Return: 159.421129933539937
I0901 23:33:38.216710 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.42
INFO:tensorflow:Starting iteration 25
I0901 23:33:42.547797 139644712736768 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 222.22

Steps executed: 872 Episode length: 872 Return: -463.9952058571308937
I0901 23:33:49.971645 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.00
INFO:tensorflow:Starting iteration 26

Steps executed: 139 Episode length: 139 Return: -134.6231137902700537
INFO:tensorflow:Average training steps per second: 218.39

Steps executed: 272 Episode length: 133 Return: -69.43787009242446537
I0901 23:33:59.127483 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.03
INFO:tensorflow:Starting iteration 27

Steps executed: 424 Episode length: 424 Return: -117.7786597710276337
INFO:tensorflow:Average training steps per second: 221.81
I0901 23:34:08.008324 139644712736768 replay_runner.py:36] Average training steps per second: 221.81
I0901 23:34:08.651793 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.78
INFO:tensorflow:Starting iteration 28

Steps executed: 227 Episode length: 227 Return: -265.5290916756577537
INFO:tensorflow:Average training steps per second: 220.35
I0901 23:34:17.592891 139644712736768 replay_runner.py:36] Average training steps per second: 220.35
I0901 23:34:17.835187 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.53
INFO:tensorflow:Starting iteration 29

Steps executed: 282 Episode length: 152 Return: -81.17415048219591537
INFO:tensorflow:Average training steps per second: 221.77
I0901 23:34:26.545941 139644712736768 replay_runner.py:36] Average training steps per second: 221.77

Done fixed training!Episode length: 152 Return: -81.17415048219591537