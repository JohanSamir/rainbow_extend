Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0905 19:02:20.134737 139802860935168 run_experiment.py:549] Creating TrainRunner ...
I0905 19:02:20.142016 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:20.142123 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:20.142176 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:20.142253 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:20.142323 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:20.142377 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:20.142423 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:20.142513 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:20.142584 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:20.142642 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:20.142691 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:20.142754 139802860935168 dqn_agent.py:283] 	 seed: 1630868540141988
I0905 19:02:20.144267 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:20.144404 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:20.144488 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:20.144543 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:20.144595 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:20.144657 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:20.144734 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:20.144792 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:20.144851 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:20.176800 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:20.380634 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:20.387685 139802860935168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:02:20.392452 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:20.392555 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:20.392610 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:20.392658 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:20.392706 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:20.392752 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:20.392818 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:20.392887 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:20.392958 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:20.393007 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:20.393076 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:20.393133 139802860935168 dqn_agent.py:283] 	 seed: 1630868540392430
I0905 19:02:20.394382 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:20.394481 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:20.394541 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:20.394594 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:20.394642 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:20.394691 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:20.394752 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:20.394831 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:20.394888 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:20.419555 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:20.432991 139802860935168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:02:20.433118 139802860935168 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 214.42
I0905 19:02:25.096954 139802860935168 replay_runner.py:36] Average training steps per second: 214.42
Steps executed: 318 Episode length: 191 Return: -504.04022235343615
I0905 19:02:26.179647 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.77
INFO:tensorflow:Starting iteration 1

Steps executed: 217 Episode length: 107 Return: -509.78998133682074
INFO:tensorflow:Average training steps per second: 312.85
I0905 19:02:33.005717 139802860935168 replay_runner.py:36] Average training steps per second: 312.85
I0905 19:02:33.205775 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -558.21
INFO:tensorflow:Starting iteration 2
I0905 19:02:37.168386 139802860935168 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 276.50

Steps executed: 1000 Episode length: 1000 Return: -172.14412645841455
I0905 19:02:44.099967 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.14
INFO:tensorflow:Starting iteration 3
I0905 19:02:48.015843 139802860935168 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 279.66

Steps executed: 1000 Episode length: 1000 Return: -149.37246409826855
I0905 19:02:53.222630 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.37
INFO:tensorflow:Starting iteration 4
I0905 19:02:57.165313 139802860935168 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 285.67

Steps executed: 1000 Episode length: 1000 Return: -223.06145594743435
I0905 19:03:02.634577 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.06
INFO:tensorflow:Starting iteration 5
I0905 19:03:06.402132 139802860935168 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 281.00

Steps executed: 1000 Episode length: 1000 Return: -400.04669172321735
I0905 19:03:12.817196 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.05
INFO:tensorflow:Starting iteration 6
I0905 19:03:16.611408 139802860935168 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 274.64

Steps executed: 368 Episode length: 368 Return: -406.4083849615452735
I0905 19:03:20.721698 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.41
INFO:tensorflow:Starting iteration 7
I0905 19:03:24.655090 139802860935168 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 267.78

Steps executed: 1000 Episode length: 1000 Return: -280.80019685497955
I0905 19:03:30.566335 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.80
INFO:tensorflow:Starting iteration 8
I0905 19:03:34.522307 139802860935168 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 271.16

Steps executed: 324 Episode length: 324 Return: -246.5107987924285255
I0905 19:03:38.556353 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.51
INFO:tensorflow:Starting iteration 9
I0905 19:03:42.461900 139802860935168 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 264.84

Steps executed: 998 Episode length: 998 Return: -307.4782030590467255
I0905 19:03:48.650436 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.48
INFO:tensorflow:Starting iteration 10

Steps executed: 339 Episode length: 284 Return: -181.4862993030266755
INFO:tensorflow:Average training steps per second: 257.99
I0905 19:03:56.295660 139802860935168 replay_runner.py:36] Average training steps per second: 257.99
I0905 19:03:56.685708 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.62
INFO:tensorflow:Starting iteration 11

Steps executed: 708 Episode length: 708 Return: -265.9698473301969755
INFO:tensorflow:Average training steps per second: 261.96
I0905 19:04:04.205350 139802860935168 replay_runner.py:36] Average training steps per second: 261.96
I0905 19:04:05.329375 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.97
INFO:tensorflow:Starting iteration 12

Steps executed: 336 Episode length: 180 Return: -106.7254869307195455
INFO:tensorflow:Average training steps per second: 259.03
I0905 19:04:12.827479 139802860935168 replay_runner.py:36] Average training steps per second: 259.03
I0905 19:04:13.119276 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.08
INFO:tensorflow:Starting iteration 13

Steps executed: 207 Episode length: 207 Return: -209.0444883502081355
INFO:tensorflow:Average training steps per second: 261.48
I0905 19:04:20.619124 139802860935168 replay_runner.py:36] Average training steps per second: 261.48
I0905 19:04:20.805092 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.04
INFO:tensorflow:Starting iteration 14

Steps executed: 307 Episode length: 160 Return: -168.8319648910183255
INFO:tensorflow:Average training steps per second: 262.17
I0905 19:04:28.438670 139802860935168 replay_runner.py:36] Average training steps per second: 262.17
I0905 19:04:28.723893 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.97
INFO:tensorflow:Starting iteration 15
I0905 19:04:32.487674 139802860935168 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 267.03

Steps executed: 627 Episode length: 627 Return: 169.34576792330673255
I0905 19:04:37.871917 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.35
INFO:tensorflow:Starting iteration 16
I0905 19:04:41.734669 139802860935168 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 276.14

Steps executed: 567 Episode length: 567 Return: 185.65060799813688255
I0905 19:04:46.438622 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.65
INFO:tensorflow:Starting iteration 17
I0905 19:04:50.422899 139802860935168 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 287.36

Steps executed: 828 Episode length: 828 Return: -576.9688180933877255
I0905 19:04:55.528297 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -576.97
INFO:tensorflow:Starting iteration 18

Steps executed: 173 Episode length: 173 Return: 60.978462288177354255
INFO:tensorflow:Average training steps per second: 275.04
I0905 19:05:03.182103 139802860935168 replay_runner.py:36] Average training steps per second: 275.04

Steps executed: 703 Episode length: 530 Return: 216.92837939865848255
INFO:tensorflow:Starting iteration 19
I0905 19:05:08.563126 139802860935168 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 278.68
I0905 19:05:12.151821 139802860935168 replay_runner.py:36] Average training steps per second: 278.68

Steps executed: 332 Episode length: 190 Return: 279.56901551018404255
INFO:tensorflow:Starting iteration 20
I0905 19:05:16.526884 139802860935168 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 273.25
I0905 19:05:20.186933 139802860935168 replay_runner.py:36] Average training steps per second: 273.25

Steps executed: 258 Episode length: 258 Return: -93.05335604386114255
INFO:tensorflow:Starting iteration 21

Steps executed: 66 Episode length: 66 Return: -51.5077573546170114255
INFO:tensorflow:Average training steps per second: 252.39
I0905 19:05:28.240882 139802860935168 replay_runner.py:36] Average training steps per second: 252.39

Steps executed: 250 Episode length: 95 Return: -240.22813285760458255
INFO:tensorflow:Starting iteration 22

Steps executed: 332 Episode length: 171 Return: -430.7230683014896655
INFO:tensorflow:Average training steps per second: 257.05
I0905 19:05:35.806760 139802860935168 replay_runner.py:36] Average training steps per second: 257.05
I0905 19:05:36.132088 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.78
INFO:tensorflow:Starting iteration 23

Steps executed: 264 Episode length: 264 Return: 0.7933911613241662655
INFO:tensorflow:Average training steps per second: 288.00
I0905 19:05:43.232809 139802860935168 replay_runner.py:36] Average training steps per second: 288.00
I0905 19:05:43.629249 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 0.79
INFO:tensorflow:Starting iteration 24
I0905 19:05:47.564870 139802860935168 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 318.57

Steps executed: 282 Episode length: 169 Return: 7.2629285903975646655
I0905 19:05:50.978803 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.66
INFO:tensorflow:Starting iteration 25

Steps executed: 245 Episode length: 136 Return: 41.718373541008085655
INFO:tensorflow:Average training steps per second: 328.27
I0905 19:05:58.278995 139802860935168 replay_runner.py:36] Average training steps per second: 328.27
I0905 19:05:58.476296 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 28.09
INFO:tensorflow:Starting iteration 26

Steps executed: 323 Episode length: 170 Return: -339.7242412676847655
INFO:tensorflow:Average training steps per second: 266.30
I0905 19:06:06.254430 139802860935168 replay_runner.py:36] Average training steps per second: 266.30
I0905 19:06:06.522654 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.27
INFO:tensorflow:Starting iteration 27
I0905 19:06:10.230491 139802860935168 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 246.12

Steps executed: 321 Episode length: 321 Return: 220.94526178230836655
I0905 19:06:14.758304 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 220.95
INFO:tensorflow:Starting iteration 28

Steps executed: 275 Episode length: 142 Return: 37.672241688180895655
INFO:tensorflow:Average training steps per second: 259.16
I0905 19:06:22.342255 139802860935168 replay_runner.py:36] Average training steps per second: 259.16
I0905 19:06:22.640574 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.99
INFO:tensorflow:Starting iteration 29

Steps executed: 73 Episode length: 73 Return: -420.547453367667295655
INFO:tensorflow:Average training steps per second: 277.07
I0905 19:06:30.137797 139802860935168 replay_runner.py:36] Average training steps per second: 277.07


Done fixed training!Episode length: 177 Return: -375.2750500909247655