Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 11:21:07.051340 139669628516352 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 11:21:07.051845 139669628516352 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 11:21:07.122753 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:07.123826 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:07.123905 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:07.123969 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:07.124027 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:07.124082 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:07.124171 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:07.124293 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:07.124367 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:07.124438 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:07.124519 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:07.124584 139669628516352 dqn_agent.py:283] 	 seed: 1630581667122699
I0902 11:21:07.126218 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:07.126348 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:07.126418 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:07.126480 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:07.126536 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:07.126593 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:07.126662 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:07.126730 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:07.126786 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.520660 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.864150 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.872270 139669628516352 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:21:08.876954 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:08.877087 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:08.877172 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:08.877233 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:08.877289 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:08.877410 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:08.877475 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:08.877542 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:08.877622 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:08.877695 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:08.877760 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:08.877830 139669628516352 dqn_agent.py:283] 	 seed: 1630581668876924
I0902 11:21:08.879317 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:08.879428 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:08.879512 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:08.879585 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:08.879642 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:08.879696 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:08.879778 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:08.879842 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:08.879927 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.899860 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.912674 139669628516352 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:21:08.912841 139669628516352 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 171.82
I0902 11:21:14.733047 139669628516352 replay_runner.py:36] Average training steps per second: 171.82
Steps executed: 237 Episode length: 137 Return: -284.9174225276709
I0902 11:21:15.722146 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.40
INFO:tensorflow:Starting iteration 1

Steps executed: 271 Episode length: 134 Return: -353.6146983780302
INFO:tensorflow:Average training steps per second: 207.41
I0902 11:21:24.706861 139669628516352 replay_runner.py:36] Average training steps per second: 207.41
I0902 11:21:24.964164 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.26
INFO:tensorflow:Starting iteration 2

Steps executed: 447 Episode length: 447 Return: -284.98057152140996
INFO:tensorflow:Average training steps per second: 206.12
I0902 11:21:34.101212 139669628516352 replay_runner.py:36] Average training steps per second: 206.12
I0902 11:21:34.937362 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.98
INFO:tensorflow:Starting iteration 3

Steps executed: 252 Episode length: 136 Return: -297.31995160807715
INFO:tensorflow:Average training steps per second: 210.76
I0902 11:21:44.021346 139669628516352 replay_runner.py:36] Average training steps per second: 210.76
I0902 11:21:44.222902 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.39
INFO:tensorflow:Starting iteration 4
I0902 11:21:48.455253 139669628516352 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 220.53

Steps executed: 1000 Episode length: 1000 Return: -142.792799003211
I0902 11:21:55.496148 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.79
INFO:tensorflow:Starting iteration 5
I0902 11:21:59.789611 139669628516352 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.70

Steps executed: 1000 Episode length: 1000 Return: -164.6701672634352
I0902 11:22:08.308603 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.67
INFO:tensorflow:Starting iteration 6
I0902 11:22:12.692994 139669628516352 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 225.52

Steps executed: 1000 Episode length: 1000 Return: -215.0717816958575
I0902 11:22:21.170170 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.07
INFO:tensorflow:Starting iteration 7
I0902 11:22:25.540655 139669628516352 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 227.74

Steps executed: 1000 Episode length: 1000 Return: -138.62635842992856
I0902 11:22:32.933081 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.63
INFO:tensorflow:Starting iteration 8
I0902 11:22:37.357162 139669628516352 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 229.13
I0902 11:22:41.721897 139669628516352 replay_runner.py:36] Average training steps per second: 229.13

Steps executed: 685 Episode length: 685 Return: -545.8278329806117856
INFO:tensorflow:Starting iteration 9

Steps executed: 341 Episode length: 341 Return: -379.5792528864988856
INFO:tensorflow:Average training steps per second: 225.93
I0902 11:22:51.860608 139669628516352 replay_runner.py:36] Average training steps per second: 225.93
I0902 11:22:52.240392 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.58
INFO:tensorflow:Starting iteration 10
I0902 11:22:56.578254 139669628516352 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 229.55

Steps executed: 1000 Episode length: 1000 Return: -108.23378124982551
I0902 11:23:03.848268 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.23
INFO:tensorflow:Starting iteration 11
I0902 11:23:08.170737 139669628516352 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 227.67

Steps executed: 1000 Episode length: 1000 Return: -266.41035160337924
I0902 11:23:16.033971 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.41
INFO:tensorflow:Starting iteration 12
I0902 11:23:20.366763 139669628516352 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 224.51

Steps executed: 1000 Episode length: 1000 Return: -174.32177132975698
I0902 11:23:27.573644 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.32
INFO:tensorflow:Starting iteration 13
I0902 11:23:31.834901 139669628516352 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 219.14

Steps executed: 1000 Episode length: 1000 Return: -169.93500408443967
I0902 11:23:40.363546 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.94
INFO:tensorflow:Starting iteration 14
I0902 11:23:44.666828 139669628516352 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 227.78

Steps executed: 1000 Episode length: 1000 Return: -92.443468377464017
I0902 11:23:51.607488 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.44
INFO:tensorflow:Starting iteration 15
I0902 11:23:55.779583 139669628516352 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 268.22

Steps executed: 693 Episode length: 559 Return: -313.7748507074067017
I0902 11:24:00.955936 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.86
INFO:tensorflow:Starting iteration 16

Steps executed: 312 Episode length: 312 Return: -282.7754672157638517
INFO:tensorflow:Average training steps per second: 251.58
I0902 11:24:08.622399 139669628516352 replay_runner.py:36] Average training steps per second: 251.58
I0902 11:24:08.946079 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.78
INFO:tensorflow:Starting iteration 17
I0902 11:24:12.822835 139669628516352 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 247.29
I0902 11:24:16.867526 139669628516352 replay_runner.py:36] Average training steps per second: 247.29

Steps executed: 301 Episode length: 147 Return: -317.2505534172212517
INFO:tensorflow:Starting iteration 18

Steps executed: 444 Episode length: 444 Return: -263.6778211606539317
INFO:tensorflow:Average training steps per second: 226.81
I0902 11:24:25.884322 139669628516352 replay_runner.py:36] Average training steps per second: 226.81
I0902 11:24:26.652699 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.68
INFO:tensorflow:Starting iteration 19
I0902 11:24:31.001873 139669628516352 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 222.69

Steps executed: 495 Episode length: 305 Return: -164.0285377938624317
I0902 11:24:36.097558 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.71
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 73 Return: -231.63517083868457417
INFO:tensorflow:Average training steps per second: 224.96
I0902 11:24:44.935606 139669628516352 replay_runner.py:36] Average training steps per second: 224.96
I0902 11:24:45.138735 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.30
INFO:tensorflow:Starting iteration 21

Steps executed: 292 Episode length: 106 Return: -492.5707487657185817
INFO:tensorflow:Average training steps per second: 225.42
I0902 11:24:53.985555 139669628516352 replay_runner.py:36] Average training steps per second: 225.42
I0902 11:24:54.232082 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.40
INFO:tensorflow:Starting iteration 22

Steps executed: 144 Episode length: 144 Return: -81.92361047691053817
INFO:tensorflow:Average training steps per second: 227.72
I0902 11:25:03.021610 139669628516352 replay_runner.py:36] Average training steps per second: 227.72

Steps executed: 293 Episode length: 149 Return: -37.89577195591694817
INFO:tensorflow:Starting iteration 23

Steps executed: 293 Episode length: 175 Return: -85.55936356497006817
INFO:tensorflow:Average training steps per second: 226.69
I0902 11:25:12.096246 139669628516352 replay_runner.py:36] Average training steps per second: 226.69
I0902 11:25:12.370676 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -407.56
INFO:tensorflow:Starting iteration 24
I0902 11:25:16.792705 139669628516352 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 223.66
I0902 11:25:21.264624 139669628516352 replay_runner.py:36] Average training steps per second: 223.66

Steps executed: 236 Episode length: 102 Return: -451.6076116524273817
INFO:tensorflow:Starting iteration 25

Steps executed: 267 Episode length: 135 Return: -593.8596919112579817
INFO:tensorflow:Average training steps per second: 230.55
I0902 11:25:30.273149 139669628516352 replay_runner.py:36] Average training steps per second: 230.55
I0902 11:25:30.523870 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -559.83
INFO:tensorflow:Starting iteration 26
I0902 11:25:34.916714 139669628516352 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 226.59
I0902 11:25:39.330361 139669628516352 replay_runner.py:36] Average training steps per second: 226.59

Steps executed: 271 Episode length: 135 Return: -145.3926997975289817
INFO:tensorflow:Starting iteration 27

Steps executed: 331 Episode length: 154 Return: -296.6608843681391417
INFO:tensorflow:Average training steps per second: 224.45
I0902 11:25:48.452209 139669628516352 replay_runner.py:36] Average training steps per second: 224.45
I0902 11:25:48.748860 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.85
INFO:tensorflow:Starting iteration 28
I0902 11:25:53.153061 139669628516352 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 226.23

Steps executed: 213 Episode length: 57 Return: -439.85536052521371417
I0902 11:25:57.772393 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.27
INFO:tensorflow:Starting iteration 29

Steps executed: 200 Episode length: 149 Return: -436.6512508753602317
INFO:tensorflow:Average training steps per second: 230.01
I0902 11:26:06.518052 139669628516352 replay_runner.py:36] Average training steps per second: 230.01

Done fixed training!Episode length: 149 Return: -436.6512508753602317