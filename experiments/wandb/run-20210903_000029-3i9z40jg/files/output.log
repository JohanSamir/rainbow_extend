Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0903 00:00:35.009775 140369919707136 run_experiment.py:549] Creating TrainRunner ...
I0903 00:00:35.016734 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:00:35.016891 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:00:35.016964 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:00:35.017023 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:00:35.017077 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:00:35.017153 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:00:35.017207 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:00:35.017302 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:00:35.017355 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:00:35.017406 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:00:35.017484 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:00:35.017563 140369919707136 dqn_agent.py:283] 	 seed: 1630627235016701
I0903 00:00:35.019302 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:00:35.019414 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:00:35.019488 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:00:35.019550 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:00:35.019606 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:00:35.019680 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:00:35.019739 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:00:35.019830 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:00:35.019901 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:00:35.042076 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:35.272582 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:35.280641 140369919707136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:00:35.286483 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:00:35.286609 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:00:35.286678 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:00:35.286736 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:00:35.286801 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:00:35.286875 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:00:35.286974 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:00:35.287049 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:00:35.287121 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:00:35.287188 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:00:35.287248 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:00:35.287319 140369919707136 dqn_agent.py:283] 	 seed: 1630627235286455
I0903 00:00:35.288690 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:00:35.288805 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:00:35.288894 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:00:35.288958 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:00:35.289012 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:00:35.289103 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:00:35.289171 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:00:35.289226 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:00:35.289292 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:00:35.306594 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:00:35.319354 140369919707136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:00:35.319484 140369919707136 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 270.39
I0903 00:00:39.018078 140369919707136 replay_runner.py:36] Average training steps per second: 270.39
I0903 00:00:39.882287 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.39
Steps executed: 317 Episode length: 164 Return: -251.94971130277767
INFO:tensorflow:Starting iteration 1

Steps executed: 292 Episode length: 110 Return: -460.07194121735397
INFO:tensorflow:Average training steps per second: 334.13
I0903 00:00:46.158514 140369919707136 replay_runner.py:36] Average training steps per second: 334.13
I0903 00:00:46.345682 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -511.32
INFO:tensorflow:Starting iteration 2
I0903 00:00:49.620867 140369919707136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 331.19

Steps executed: 406 Episode length: 231 Return: -232.90963856141266
I0903 00:00:52.969437 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.49
INFO:tensorflow:Starting iteration 3

Steps executed: 478 Episode length: 285 Return: -62.463861769252516
INFO:tensorflow:Average training steps per second: 329.71
I0903 00:00:59.320631 140369919707136 replay_runner.py:36] Average training steps per second: 329.71
I0903 00:00:59.713510 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.33
INFO:tensorflow:Starting iteration 4
I0903 00:01:03.028490 140369919707136 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 348.21

Steps executed: 1000 Episode length: 1000 Return: -86.41244711190757
I0903 00:01:08.422118 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.41
INFO:tensorflow:Starting iteration 5
I0903 00:01:11.690751 140369919707136 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 346.63

Steps executed: 1000 Episode length: 1000 Return: -63.12968406646509
I0903 00:01:16.246836 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.13
INFO:tensorflow:Starting iteration 6
I0903 00:01:19.633830 140369919707136 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 372.40

Steps executed: 1000 Episode length: 1000 Return: -144.9186284777741
I0903 00:01:24.131730 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.92
INFO:tensorflow:Starting iteration 7
I0903 00:01:27.443673 140369919707136 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 341.34

Steps executed: 1000 Episode length: 1000 Return: -91.14512746327756
I0903 00:01:31.834670 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.15
INFO:tensorflow:Starting iteration 8
I0903 00:01:35.142673 140369919707136 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 322.10

Steps executed: 1000 Episode length: 1000 Return: -104.53443425780895
I0903 00:01:40.055185 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.53
INFO:tensorflow:Starting iteration 9
I0903 00:01:43.316769 140369919707136 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 312.62

Steps executed: 1000 Episode length: 1000 Return: -113.21939610538455
I0903 00:01:48.366328 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.22
INFO:tensorflow:Starting iteration 10
I0903 00:01:51.746737 140369919707136 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 346.20

Steps executed: 1000 Episode length: 1000 Return: -22.204467342296485
I0903 00:01:56.588113 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.20
INFO:tensorflow:Starting iteration 11

Steps executed: 147 Episode length: 147 Return: -87.69120443839111485
INFO:tensorflow:Average training steps per second: 358.30

Steps executed: 1147 Episode length: 1000 Return: -71.311936693984585
I0903 00:02:05.369035 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.50
INFO:tensorflow:Starting iteration 12
I0903 00:02:08.777417 140369919707136 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 351.94

Steps executed: 1000 Episode length: 1000 Return: -46.360542089927515
I0903 00:02:13.476080 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.36
INFO:tensorflow:Starting iteration 13
I0903 00:02:16.868017 140369919707136 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 344.46

Steps executed: 1000 Episode length: 1000 Return: -29.270643366364258
I0903 00:02:21.499645 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -29.27
INFO:tensorflow:Starting iteration 14
I0903 00:02:24.922563 140369919707136 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 346.83

Steps executed: 999 Episode length: 999 Return: 148.68947206243384258
I0903 00:02:29.957508 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.69
INFO:tensorflow:Starting iteration 15

Steps executed: 392 Episode length: 392 Return: -18.42475118404752358
INFO:tensorflow:Average training steps per second: 362.62
I0903 00:02:36.145173 140369919707136 replay_runner.py:36] Average training steps per second: 362.62
I0903 00:02:36.564582 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.42
INFO:tensorflow:Starting iteration 16
I0903 00:02:39.979913 140369919707136 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 347.94

Steps executed: 489 Episode length: 489 Return: -366.1191310284925358
I0903 00:02:43.498170 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.12
INFO:tensorflow:Starting iteration 17

Steps executed: 513 Episode length: 382 Return: -90.86178212977306358
INFO:tensorflow:Average training steps per second: 345.51
I0903 00:02:49.790301 140369919707136 replay_runner.py:36] Average training steps per second: 345.51
I0903 00:02:50.290784 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.65
INFO:tensorflow:Starting iteration 18
I0903 00:02:53.679486 140369919707136 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 337.08

Steps executed: 1000 Episode length: 1000 Return: 9.97471654232764158
I0903 00:02:59.034765 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.97
INFO:tensorflow:Starting iteration 19
I0903 00:03:02.407462 140369919707136 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 343.59

Steps executed: 417 Episode length: 417 Return: -249.5761479829144858
I0903 00:03:05.819807 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.58
INFO:tensorflow:Starting iteration 20
I0903 00:03:09.135441 140369919707136 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 327.83

Steps executed: 975 Episode length: 975 Return: 96.710262824077594858
I0903 00:03:13.770623 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 96.71
INFO:tensorflow:Starting iteration 21

Steps executed: 269 Episode length: 269 Return: 9.2579806736032574858
INFO:tensorflow:Average training steps per second: 316.60
I0903 00:03:20.152663 140369919707136 replay_runner.py:36] Average training steps per second: 316.60
I0903 00:03:20.379845 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.26
INFO:tensorflow:Starting iteration 22

Steps executed: 239 Episode length: 239 Return: -285.8678206090553458
INFO:tensorflow:Average training steps per second: 336.25
I0903 00:03:26.648527 140369919707136 replay_runner.py:36] Average training steps per second: 336.25
I0903 00:03:26.834323 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.87
INFO:tensorflow:Starting iteration 23

Steps executed: 243 Episode length: 243 Return: -192.6103079790773358
INFO:tensorflow:Average training steps per second: 324.19
I0903 00:03:33.256139 140369919707136 replay_runner.py:36] Average training steps per second: 324.19
I0903 00:03:33.452151 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.61
INFO:tensorflow:Starting iteration 24

Steps executed: 626 Episode length: 626 Return: -368.9937584582255358
INFO:tensorflow:Average training steps per second: 345.11
I0903 00:03:39.686080 140369919707136 replay_runner.py:36] Average training steps per second: 345.11
I0903 00:03:40.802147 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.99
INFO:tensorflow:Starting iteration 25
I0903 00:03:44.230039 140369919707136 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 339.57

Steps executed: 699 Episode length: 699 Return: -355.1467508994923658
I0903 00:03:48.189701 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.15
INFO:tensorflow:Starting iteration 26

Steps executed: 218 Episode length: 218 Return: -22.01845889955647858
INFO:tensorflow:Average training steps per second: 340.24
I0903 00:03:54.534298 140369919707136 replay_runner.py:36] Average training steps per second: 340.24
I0903 00:03:54.700333 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.02
INFO:tensorflow:Starting iteration 27

Steps executed: 246 Episode length: 246 Return: -90.37536605165428858
INFO:tensorflow:Average training steps per second: 345.74
I0903 00:04:00.943792 140369919707136 replay_runner.py:36] Average training steps per second: 345.74
I0903 00:04:01.148844 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.38
INFO:tensorflow:Starting iteration 28

Steps executed: 592 Episode length: 592 Return: 156.14255320255388858
INFO:tensorflow:Average training steps per second: 336.83
I0903 00:04:07.423300 140369919707136 replay_runner.py:36] Average training steps per second: 336.83
I0903 00:04:08.359956 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.14
INFO:tensorflow:Starting iteration 29

Steps executed: 308 Episode length: 231 Return: -121.5298523108369358
INFO:tensorflow:Average training steps per second: 328.56
I0903 00:04:14.685090 140369919707136 replay_runner.py:36] Average training steps per second: 328.56

Done fixed training!Episode length: 231 Return: -121.5298523108369358