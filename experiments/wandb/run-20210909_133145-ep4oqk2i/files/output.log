Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 13:31:50.267121 140252157974528 run_experiment.py:549] Creating TrainRunner ...
I0909 13:31:50.272755 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:50.272871 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:50.272942 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:50.273002 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:50.273058 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:50.273135 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:50.273216 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:50.273275 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:50.273348 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:50.273410 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:50.273468 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:50.273532 140252157974528 dqn_agent.py:283] 	 seed: 1631194310272723
I0909 13:31:50.275017 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:50.275123 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:50.275198 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:50.275266 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:50.275323 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:50.275378 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:50.275436 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:50.275515 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:50.275583 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:51.372656 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:51.673474 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:51.681116 140252157974528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:31:51.685405 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:51.685526 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:51.685606 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:51.685669 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:51.685725 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:51.685801 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:51.685894 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:51.685964 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:51.686033 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:51.686107 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:51.686174 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:51.686240 140252157974528 dqn_agent.py:283] 	 seed: 1631194311685378
I0909 13:31:51.687532 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:51.687633 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:51.687700 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:51.687763 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:51.687815 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:51.687884 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:51.687968 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:51.688031 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:51.688081 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:51.704488 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:51.714890 140252157974528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:31:51.715018 140252157974528 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 292.46
I0909 13:31:55.134462 140252157974528 replay_runner.py:36] Average training steps per second: 292.46
I0909 13:31:55.775096 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:31:55.838964 140252157974528 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 382.17
I0909 13:31:58.456016 140252157974528 replay_runner.py:36] Average training steps per second: 382.17
I0909 13:31:58.580046 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:31:58.647856 140252157974528 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 384.39
I0909 13:32:01.249613 140252157974528 replay_runner.py:36] Average training steps per second: 384.39
I0909 13:32:01.366610 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3

Steps executed: 212 Episode length: 212 Return: -212.0
INFO:tensorflow:Average training steps per second: 391.91
I0909 13:32:03.984585 140252157974528 replay_runner.py:36] Average training steps per second: 391.91
I0909 13:32:04.028081 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.00
INFO:tensorflow:Starting iteration 4

Steps executed: 256 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 379.94
I0909 13:32:06.723062 140252157974528 replay_runner.py:36] Average training steps per second: 379.94
I0909 13:32:06.776608 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 5

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 379.97
I0909 13:32:09.472896 140252157974528 replay_runner.py:36] Average training steps per second: 379.97
I0909 13:32:09.597686 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:32:09.661534 140252157974528 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 374.89
I0909 13:32:12.329216 140252157974528 replay_runner.py:36] Average training steps per second: 374.89
I0909 13:32:12.454022 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 259 Episode length: 165 Return: -165.0
INFO:tensorflow:Average training steps per second: 380.18
I0909 13:32:15.151785 140252157974528 replay_runner.py:36] Average training steps per second: 380.18
I0909 13:32:15.205496 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 8

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 383.21
I0909 13:32:17.879657 140252157974528 replay_runner.py:36] Average training steps per second: 383.21
I0909 13:32:18.005328 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:32:18.069465 140252157974528 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 388.37
I0909 13:32:20.644536 140252157974528 replay_runner.py:36] Average training steps per second: 388.37
I0909 13:32:20.771691 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 254 Episode length: 100 Return: -100.0
INFO:tensorflow:Average training steps per second: 389.97
I0909 13:32:23.401524 140252157974528 replay_runner.py:36] Average training steps per second: 389.97
I0909 13:32:23.452519 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 11
I0909 13:32:23.515682 140252157974528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 387.79
I0909 13:32:26.094603 140252157974528 replay_runner.py:36] Average training steps per second: 387.79

Steps executed: 241 Episode length: 153 Return: -153.0
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 394.75
I0909 13:32:28.740128 140252157974528 replay_runner.py:36] Average training steps per second: 394.75
I0909 13:32:28.785727 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 13

Steps executed: 260 Episode length: 130 Return: -130.0
INFO:tensorflow:Average training steps per second: 395.13
I0909 13:32:31.380301 140252157974528 replay_runner.py:36] Average training steps per second: 395.13
I0909 13:32:31.433196 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 14

Steps executed: 232 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 389.19
I0909 13:32:34.068374 140252157974528 replay_runner.py:36] Average training steps per second: 389.19
I0909 13:32:34.116202 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 387.49
I0909 13:32:36.762782 140252157974528 replay_runner.py:36] Average training steps per second: 387.49
I0909 13:32:36.890190 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 277 Episode length: 158 Return: -158.0
INFO:tensorflow:Average training steps per second: 391.43
I0909 13:32:39.512844 140252157974528 replay_runner.py:36] Average training steps per second: 391.43
I0909 13:32:39.568890 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 17
I0909 13:32:39.633032 140252157974528 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 394.34
I0909 13:32:42.169075 140252157974528 replay_runner.py:36] Average training steps per second: 394.34

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 18

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 394.49
I0909 13:32:44.890179 140252157974528 replay_runner.py:36] Average training steps per second: 394.49
I0909 13:32:44.933256 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 19

Steps executed: 223 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 390.59
I0909 13:32:47.558492 140252157974528 replay_runner.py:36] Average training steps per second: 390.59
I0909 13:32:47.604273 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 20

Steps executed: 218 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 389.83
I0909 13:32:50.233705 140252157974528 replay_runner.py:36] Average training steps per second: 389.83
I0909 13:32:50.280342 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 21

Steps executed: 232 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 387.43
I0909 13:32:52.927088 140252157974528 replay_runner.py:36] Average training steps per second: 387.43
I0909 13:32:52.975788 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 22

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 392.82
I0909 13:32:55.587612 140252157974528 replay_runner.py:36] Average training steps per second: 392.82
I0909 13:32:55.709784 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23

Steps executed: 222 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 392.13
I0909 13:32:58.325604 140252157974528 replay_runner.py:36] Average training steps per second: 392.13
I0909 13:32:58.370118 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 24

Steps executed: 209 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 391.06
I0909 13:33:00.992525 140252157974528 replay_runner.py:36] Average training steps per second: 391.06
I0909 13:33:01.035553 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 25

Steps executed: 212 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 393.17
I0909 13:33:03.642395 140252157974528 replay_runner.py:36] Average training steps per second: 393.17
I0909 13:33:03.688333 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 26

Steps executed: 201 Episode length: 97 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 391.65
I0909 13:33:06.307116 140252157974528 replay_runner.py:36] Average training steps per second: 391.65
I0909 13:33:06.350138 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 27

Steps executed: 210 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 394.75
I0909 13:33:08.950887 140252157974528 replay_runner.py:36] Average training steps per second: 394.75
I0909 13:33:08.993819 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 28

Steps executed: 217 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 387.00
I0909 13:33:11.642494 140252157974528 replay_runner.py:36] Average training steps per second: 387.00
I0909 13:33:11.691359 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 29


Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 381.08
I0909 13:33:14.382668 140252157974528 replay_runner.py:36] Average training steps per second: 381.08
I0909 13:33:14.529886 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.00