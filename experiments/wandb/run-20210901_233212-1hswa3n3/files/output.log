Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 23:32:18.639854 139919604459520 run_experiment.py:549] Creating TrainRunner ...
I0901 23:32:18.658371 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:32:18.658615 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:32:18.662720 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:32:18.662882 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:32:18.663407 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:32:18.663537 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:32:18.663958 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:32:18.664084 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:32:18.664492 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:32:18.664626 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:32:18.665333 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:32:18.665521 139919604459520 dqn_agent.py:283] 	 seed: 1630539138658302
I0901 23:32:18.670982 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:32:18.671173 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:32:18.674336 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:32:18.674513 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:32:18.675045 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:32:18.675182 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:32:18.675658 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:32:18.676004 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:32:18.676269 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:32:18.714364 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:19.222136 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:19.236844 139919604459520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:32:19.245743 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:32:19.246002 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:32:19.246209 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:32:19.246342 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:32:19.246523 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:32:19.246642 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:32:19.246748 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:32:19.246861 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:32:19.247113 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:32:19.247290 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:32:19.247424 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:32:19.247539 139919604459520 dqn_agent.py:283] 	 seed: 1630539139245686
I0901 23:32:19.250609 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:32:19.250812 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:32:19.250947 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:32:19.251065 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:32:19.251172 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:32:19.251292 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:32:19.251408 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:32:19.251509 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:32:19.251608 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:32:19.280203 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:19.302654 139919604459520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:32:19.302952 139919604459520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.47
I0901 23:32:26.130471 139919604459520 replay_runner.py:36] Average training steps per second: 146.47
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:32:27.606928 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:32:27.862741 139919604459520 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 192.67
I0901 23:32:33.053853 139919604459520 replay_runner.py:36] Average training steps per second: 192.67
I0901 23:32:33.618989 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 23:32:33.958002 139919604459520 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 187.68
I0901 23:32:39.286700 139919604459520 replay_runner.py:36] Average training steps per second: 187.68
I0901 23:32:39.723237 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:32:39.968391 139919604459520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 204.42
I0901 23:32:44.860863 139919604459520 replay_runner.py:36] Average training steps per second: 204.42
I0901 23:32:45.250670 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:32:45.477701 139919604459520 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.96
I0901 23:32:50.529771 139919604459520 replay_runner.py:36] Average training steps per second: 197.96
I0901 23:32:50.930749 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:32:51.176417 139919604459520 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 206.28
I0901 23:32:56.025169 139919604459520 replay_runner.py:36] Average training steps per second: 206.28
I0901 23:32:56.440095 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 23:32:56.688198 139919604459520 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 194.87
I0901 23:33:01.820362 139919604459520 replay_runner.py:36] Average training steps per second: 194.87
I0901 23:33:02.235422 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:33:02.480239 139919604459520 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.99
I0901 23:33:07.506275 139919604459520 replay_runner.py:36] Average training steps per second: 198.99
I0901 23:33:07.920004 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:33:08.165555 139919604459520 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 200.43
I0901 23:33:13.155300 139919604459520 replay_runner.py:36] Average training steps per second: 200.43
I0901 23:33:13.542311 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 23:33:13.776233 139919604459520 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 203.41
I0901 23:33:18.692871 139919604459520 replay_runner.py:36] Average training steps per second: 203.41
I0901 23:33:19.123128 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 23:33:19.361500 139919604459520 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 203.63
I0901 23:33:24.273022 139919604459520 replay_runner.py:36] Average training steps per second: 203.63
I0901 23:33:24.665958 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 23:33:24.917865 139919604459520 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 198.85
I0901 23:33:29.947418 139919604459520 replay_runner.py:36] Average training steps per second: 198.85
I0901 23:33:30.357449 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 23:33:30.610158 139919604459520 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 201.68
I0901 23:33:35.569300 139919604459520 replay_runner.py:36] Average training steps per second: 201.68
I0901 23:33:35.986660 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 23:33:36.238101 139919604459520 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.73
I0901 23:33:41.270775 139919604459520 replay_runner.py:36] Average training steps per second: 198.73
I0901 23:33:41.677210 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 23:33:41.926818 139919604459520 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.16
I0901 23:33:46.948673 139919604459520 replay_runner.py:36] Average training steps per second: 199.16
I0901 23:33:47.372045 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 23:33:47.627777 139919604459520 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.28
I0901 23:33:52.671510 139919604459520 replay_runner.py:36] Average training steps per second: 198.28
I0901 23:33:53.069000 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 23:33:53.305857 139919604459520 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.22
I0901 23:33:58.376937 139919604459520 replay_runner.py:36] Average training steps per second: 197.22
I0901 23:33:58.796637 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 23:33:59.048922 139919604459520 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 203.61
I0901 23:34:03.960801 139919604459520 replay_runner.py:36] Average training steps per second: 203.61
I0901 23:34:04.368971 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 23:34:04.609087 139919604459520 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.39
I0901 23:34:09.753617 139919604459520 replay_runner.py:36] Average training steps per second: 194.39
I0901 23:34:10.147122 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0901 23:34:10.386065 139919604459520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 203.41
I0901 23:34:15.302797 139919604459520 replay_runner.py:36] Average training steps per second: 203.41
I0901 23:34:15.707387 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0901 23:34:15.949491 139919604459520 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 202.32
I0901 23:34:20.892787 139919604459520 replay_runner.py:36] Average training steps per second: 202.32
I0901 23:34:21.288671 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0901 23:34:21.507102 139919604459520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.19
I0901 23:34:26.527816 139919604459520 replay_runner.py:36] Average training steps per second: 199.19
I0901 23:34:26.915705 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 23:34:27.153280 139919604459520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 203.03
I0901 23:34:32.079000 139919604459520 replay_runner.py:36] Average training steps per second: 203.03
I0901 23:34:32.483592 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 23:34:32.720653 139919604459520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.50
I0901 23:34:37.708675 139919604459520 replay_runner.py:36] Average training steps per second: 200.50
I0901 23:34:38.086836 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 23:34:38.310662 139919604459520 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 198.49
I0901 23:34:43.349329 139919604459520 replay_runner.py:36] Average training steps per second: 198.49
I0901 23:34:43.735573 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0901 23:34:43.969370 139919604459520 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 202.77
I0901 23:34:48.901486 139919604459520 replay_runner.py:36] Average training steps per second: 202.77
I0901 23:34:49.310421 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 23:34:49.561781 139919604459520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.04
I0901 23:34:54.716071 139919604459520 replay_runner.py:36] Average training steps per second: 194.04
I0901 23:34:55.156985 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0901 23:34:55.422844 139919604459520 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.72
I0901 23:35:00.506592 139919604459520 replay_runner.py:36] Average training steps per second: 196.72
I0901 23:35:00.916743 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0901 23:35:01.157995 139919604459520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.20
I0901 23:35:06.031562 139919604459520 replay_runner.py:36] Average training steps per second: 205.20
I0901 23:35:06.438449 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29
I0901 23:35:06.672819 139919604459520 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 205.25
I0901 23:35:11.545464 139919604459520 replay_runner.py:36] Average training steps per second: 205.25

Done fixed training!Episode length: 500 Return: -500.0