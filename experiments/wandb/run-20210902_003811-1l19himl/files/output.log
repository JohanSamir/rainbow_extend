I0902 00:38:17.478337 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:38:17.486276 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:17.486402 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:17.486475 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:17.486536 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:17.486597 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:17.486674 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:17.486774 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:17.486860 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:17.486963 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:17.487054 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:17.487152 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:17.487221 140183943698432 dqn_agent.py:283] 	 seed: 1630543097486243
I0902 00:38:17.489012 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:17.489160 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:17.489263 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:17.489344 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:17.489421 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:17.489502 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:17.489625 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:17.489756 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:17.489850 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:17.517933 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:17.769797 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:17.778652 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:38:17.784765 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:17.784902 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:17.784974 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:17.785037 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:17.785096 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:17.785168 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:17.785260 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:17.785323 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:17.785393 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:17.785462 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:17.785518 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:17.785589 140183943698432 dqn_agent.py:283] 	 seed: 1630543097784736
I0902 00:38:17.787040 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:17.787163 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:17.787233 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:17.787293 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:17.787349 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:17.787406 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:17.787464 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:17.787548 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:17.787622 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:17.807846 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:17.823908 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:38:17.824116 140183943698432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 242.02
I0902 00:38:21.956313 140183943698432 replay_runner.py:36] Average training steps per second: 242.02
I0902 00:38:22.748043 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -476.40
Steps executed: 244 Episode length: 91 Return: -456.39549847606959
INFO:tensorflow:Starting iteration 1

Steps executed: 213 Episode length: 53 Return: -343.03557119308175
INFO:tensorflow:Average training steps per second: 359.89
I0902 00:38:28.953342 140183943698432 replay_runner.py:36] Average training steps per second: 359.89
I0902 00:38:29.066373 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.32
INFO:tensorflow:Starting iteration 2

Steps executed: 175 Episode length: 111 Return: -455.3626275251115
INFO:tensorflow:Average training steps per second: 364.90

Steps executed: 242 Episode length: 67 Return: -443.95070542509217
I0902 00:38:35.424239 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.26
INFO:tensorflow:Starting iteration 3

Steps executed: 293 Episode length: 176 Return: -346.32856123192363
INFO:tensorflow:Average training steps per second: 357.84
I0902 00:38:41.737072 140183943698432 replay_runner.py:36] Average training steps per second: 357.84
I0902 00:38:41.918726 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.66
INFO:tensorflow:Starting iteration 4

Steps executed: 266 Episode length: 99 Return: -690.637150503241763
INFO:tensorflow:Average training steps per second: 349.29
I0902 00:38:48.272094 140183943698432 replay_runner.py:36] Average training steps per second: 349.29
I0902 00:38:48.435479 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -691.63
INFO:tensorflow:Starting iteration 5

Steps executed: 282 Episode length: 155 Return: -355.07329117796223
INFO:tensorflow:Average training steps per second: 346.36
I0902 00:38:54.797131 140183943698432 replay_runner.py:36] Average training steps per second: 346.36
I0902 00:38:54.960208 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.36
INFO:tensorflow:Starting iteration 6

Steps executed: 298 Episode length: 196 Return: -730.68205078129283
INFO:tensorflow:Average training steps per second: 348.02
I0902 00:39:01.291033 140183943698432 replay_runner.py:36] Average training steps per second: 348.02
I0902 00:39:01.485311 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -657.54
INFO:tensorflow:Starting iteration 7

Steps executed: 202 Episode length: 85 Return: -500.456028577726563
INFO:tensorflow:Average training steps per second: 344.59
I0902 00:39:07.858161 140183943698432 replay_runner.py:36] Average training steps per second: 344.59
I0902 00:39:07.981575 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -636.61
INFO:tensorflow:Starting iteration 8

Steps executed: 258 Episode length: 83 Return: -304.551574557779163
INFO:tensorflow:Average training steps per second: 342.23
I0902 00:39:14.363502 140183943698432 replay_runner.py:36] Average training steps per second: 342.23
I0902 00:39:14.511115 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.26
INFO:tensorflow:Starting iteration 9

Steps executed: 237 Episode length: 89 Return: -434.061284863457843
INFO:tensorflow:Average training steps per second: 337.78
I0902 00:39:20.936792 140183943698432 replay_runner.py:36] Average training steps per second: 337.78
I0902 00:39:21.075180 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.01
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 55 Return: -345.078364522856143
INFO:tensorflow:Average training steps per second: 334.67
I0902 00:39:27.490770 140183943698432 replay_runner.py:36] Average training steps per second: 334.67
I0902 00:39:27.606668 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.73
INFO:tensorflow:Starting iteration 11

Steps executed: 237 Episode length: 70 Return: -117.857833171386558
INFO:tensorflow:Average training steps per second: 335.16
I0902 00:39:34.011351 140183943698432 replay_runner.py:36] Average training steps per second: 335.16
I0902 00:39:34.132444 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.26
INFO:tensorflow:Starting iteration 12

Steps executed: 206 Episode length: 90 Return: -244.515031688067328
INFO:tensorflow:Average training steps per second: 331.14
I0902 00:39:40.585542 140183943698432 replay_runner.py:36] Average training steps per second: 331.14
I0902 00:39:40.704882 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.08
INFO:tensorflow:Starting iteration 13
I0902 00:39:44.105802 140183943698432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 332.00

Steps executed: 333 Episode length: 333 Return: -251.06555506463675
I0902 00:39:47.418732 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.07
INFO:tensorflow:Starting iteration 14

Steps executed: 295 Episode length: 99 Return: -226.588724902300665
INFO:tensorflow:Average training steps per second: 334.30
I0902 00:39:53.813284 140183943698432 replay_runner.py:36] Average training steps per second: 334.30
I0902 00:39:53.965147 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.02
INFO:tensorflow:Starting iteration 15

Steps executed: 417 Episode length: 417 Return: -1050.7587828427745
INFO:tensorflow:Average training steps per second: 330.88
I0902 00:40:00.403751 140183943698432 replay_runner.py:36] Average training steps per second: 330.88
I0902 00:40:00.830796 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -1050.76
INFO:tensorflow:Starting iteration 16

Steps executed: 133 Episode length: 68 Return: -92.1057404674365645
INFO:tensorflow:Average training steps per second: 326.23
I0902 00:40:07.275908 140183943698432 replay_runner.py:36] Average training steps per second: 326.23

Steps executed: 269 Episode length: 72 Return: -91.5998855865135545
INFO:tensorflow:Starting iteration 17

Steps executed: 273 Episode length: 85 Return: -489.932930352258585
INFO:tensorflow:Average training steps per second: 333.64
I0902 00:40:13.829742 140183943698432 replay_runner.py:36] Average training steps per second: 333.64
I0902 00:40:13.999830 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -527.93
INFO:tensorflow:Starting iteration 18

Steps executed: 202 Episode length: 147 Return: -754.08274787514555
INFO:tensorflow:Average training steps per second: 327.65
I0902 00:40:20.442025 140183943698432 replay_runner.py:36] Average training steps per second: 327.65
I0902 00:40:20.568128 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.03
INFO:tensorflow:Starting iteration 19

Steps executed: 263 Episode length: 65 Return: -542.926953371398465
INFO:tensorflow:Average training steps per second: 327.03
I0902 00:40:27.010965 140183943698432 replay_runner.py:36] Average training steps per second: 327.03
I0902 00:40:27.144539 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.09
INFO:tensorflow:Starting iteration 20
I0902 00:40:30.529623 140183943698432 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 331.12
I0902 00:40:33.549965 140183943698432 replay_runner.py:36] Average training steps per second: 331.12

Steps executed: 245 Episode length: 50 Return: -301.839595642307235
INFO:tensorflow:Starting iteration 21

Steps executed: 235 Episode length: 50 Return: -85.9542469878266635
INFO:tensorflow:Average training steps per second: 326.74
I0902 00:40:40.131354 140183943698432 replay_runner.py:36] Average training steps per second: 326.74
I0902 00:40:40.262612 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.36
INFO:tensorflow:Starting iteration 22

Steps executed: 204 Episode length: 69 Return: -569.328449707112935
INFO:tensorflow:Average training steps per second: 326.81
I0902 00:40:46.670847 140183943698432 replay_runner.py:36] Average training steps per second: 326.81
I0902 00:40:46.797469 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -539.11
INFO:tensorflow:Starting iteration 23

Steps executed: 243 Episode length: 65 Return: -559.258229225088435
INFO:tensorflow:Average training steps per second: 323.10
I0902 00:40:53.338466 140183943698432 replay_runner.py:36] Average training steps per second: 323.10
I0902 00:40:53.480720 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.07
INFO:tensorflow:Starting iteration 24
I0902 00:40:56.819278 140183943698432 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 330.84

Steps executed: 240 Episode length: 81 Return: -786.639022232718435
I0902 00:40:59.982442 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -771.83
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 64 Return: -589.420460168206365
INFO:tensorflow:Average training steps per second: 317.67
I0902 00:41:06.451926 140183943698432 replay_runner.py:36] Average training steps per second: 317.67
I0902 00:41:06.579889 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.67
INFO:tensorflow:Starting iteration 26

Steps executed: 260 Episode length: 79 Return: -781.936055692219365
INFO:tensorflow:Average training steps per second: 325.11
I0902 00:41:12.758270 140183943698432 replay_runner.py:36] Average training steps per second: 325.11
I0902 00:41:12.909132 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -562.72
INFO:tensorflow:Starting iteration 27

Steps executed: 254 Episode length: 66 Return: -514.692128467065565
INFO:tensorflow:Average training steps per second: 331.80
I0902 00:41:19.099015 140183943698432 replay_runner.py:36] Average training steps per second: 331.80
I0902 00:41:19.240402 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -471.25
INFO:tensorflow:Starting iteration 28

Steps executed: 259 Episode length: 85 Return: -833.833932005205155
INFO:tensorflow:Average training steps per second: 350.71
I0902 00:41:25.277219 140183943698432 replay_runner.py:36] Average training steps per second: 350.71
I0902 00:41:25.398683 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -599.78
INFO:tensorflow:Starting iteration 29

Steps executed: 201 Episode length: 62 Return: -561.268536121292855
INFO:tensorflow:Average training steps per second: 342.50
I0902 00:41:31.353579 140183943698432 replay_runner.py:36] Average training steps per second: 342.50

Done fixed training!Episode length: 62 Return: -561.268536121292855