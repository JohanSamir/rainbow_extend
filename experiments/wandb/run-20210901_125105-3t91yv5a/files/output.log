Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0901 12:51:11.920779 140586480396288 run_experiment.py:549] Creating TrainRunner ...
I0901 12:51:11.931122 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:51:11.931668 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:51:11.931892 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:51:11.931997 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:51:11.932165 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:51:11.932328 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:51:11.932460 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:51:11.932545 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:51:11.932609 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:51:11.932672 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:51:11.932758 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:51:11.932842 140586480396288 dqn_agent.py:283] 	 seed: 1630500671931034
I0901 12:51:11.936485 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:51:11.936692 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:51:11.936790 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:51:11.936868 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:51:11.936936 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:51:11.937001 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:51:11.937068 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:51:11.937188 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:51:11.937275 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:51:12.112329 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:51:12.612659 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:51:12.627843 140586480396288 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:51:12.637853 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:51:12.638084 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:51:12.638276 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:51:12.638391 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:51:12.638519 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:51:12.638658 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:51:12.638772 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:51:12.638905 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:51:12.639009 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:51:12.639123 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:51:12.639225 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:51:12.639564 140586480396288 dqn_agent.py:283] 	 seed: 1630500672637800
I0901 12:51:12.642996 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:51:12.643234 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:51:12.643353 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:51:12.643514 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:51:12.643651 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:51:12.643884 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:51:12.643987 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:51:12.644297 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:51:12.644524 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:51:12.685908 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:51:12.709710 140586480396288 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:51:12.710135 140586480396288 replay_runner.py:41] Starting iteration 0
Steps executed: 179 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 135.13

Steps executed: 354 Episode length: 175 Return: -174.0
I0901 12:51:21.593597 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.00
INFO:tensorflow:Starting iteration 1
I0901 12:51:21.840893 140586480396288 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 185.40

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:51:27.676261 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:51:27.919712 140586480396288 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.81

Steps executed: 483 Episode length: 483 Return: -482.0
I0901 12:51:33.737323 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.81
I0901 12:51:39.184827 140586480396288 replay_runner.py:36] Average training steps per second: 191.81
I0901 12:51:39.652569 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:51:39.910780 140586480396288 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 185.54
I0901 12:51:45.301150 140586480396288 replay_runner.py:36] Average training steps per second: 185.54
I0901 12:51:45.744108 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:51:45.991089 140586480396288 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.27
I0901 12:51:51.274908 140586480396288 replay_runner.py:36] Average training steps per second: 189.27
I0901 12:51:51.725037 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 122 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 187.00

Steps executed: 622 Episode length: 500 Return: -500.0
I0901 12:51:57.851087 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.50
INFO:tensorflow:Starting iteration 7
I0901 12:51:58.080186 140586480396288 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 184.38

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:52:03.939677 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:52:04.191313 140586480396288 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 188.62
I0901 12:52:09.493348 140586480396288 replay_runner.py:36] Average training steps per second: 188.62
I0901 12:52:09.926918 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 235 Episode length: 235 Return: -234.0
INFO:tensorflow:Average training steps per second: 191.75
I0901 12:52:15.393758 140586480396288 replay_runner.py:36] Average training steps per second: 191.75
I0901 12:52:15.592675 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.00
INFO:tensorflow:Starting iteration 10

Steps executed: 285 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 194.24
I0901 12:52:20.977430 140586480396288 replay_runner.py:36] Average training steps per second: 194.24
I0901 12:52:21.208388 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 11

Steps executed: 267 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 194.13
I0901 12:52:26.601087 140586480396288 replay_runner.py:36] Average training steps per second: 194.13
I0901 12:52:26.815833 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 12

Steps executed: 211 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 193.79
I0901 12:52:32.210304 140586480396288 replay_runner.py:36] Average training steps per second: 193.79
I0901 12:52:32.391698 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 13
I0901 12:52:32.629233 140586480396288 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.47

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:52:38.221159 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 12:52:38.458603 140586480396288 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 186.44
I0901 12:52:43.822795 140586480396288 replay_runner.py:36] Average training steps per second: 186.44

Steps executed: 282 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Starting iteration 15

Steps executed: 88 Episode length: 88 Return: -87.00.0
INFO:tensorflow:Average training steps per second: 187.19
I0901 12:52:49.663297 140586480396288 replay_runner.py:36] Average training steps per second: 187.19
I0901 12:52:49.910654 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 16


Steps executed: 339 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 191.43
I0901 12:52:55.389330 140586480396288 replay_runner.py:36] Average training steps per second: 191.43
I0901 12:52:55.696452 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.50
INFO:tensorflow:Starting iteration 17

Steps executed: 301 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 187.84
I0901 12:53:01.274959 140586480396288 replay_runner.py:36] Average training steps per second: 187.84
I0901 12:53:01.537524 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.33
INFO:tensorflow:Starting iteration 18

Steps executed: 229 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 188.36
I0901 12:53:07.095417 140586480396288 replay_runner.py:36] Average training steps per second: 188.36
I0901 12:53:07.312708 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 19

Steps executed: 290 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 191.31
I0901 12:53:12.795752 140586480396288 replay_runner.py:36] Average training steps per second: 191.31
I0901 12:53:13.062160 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 20

Steps executed: 293 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 183.65
I0901 12:53:18.755650 140586480396288 replay_runner.py:36] Average training steps per second: 183.65
I0901 12:53:19.020626 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 21

Steps executed: 238 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 191.00
I0901 12:53:24.508728 140586480396288 replay_runner.py:36] Average training steps per second: 191.00
I0901 12:53:24.729900 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 22

Steps executed: 284 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 187.48
I0901 12:53:30.312201 140586480396288 replay_runner.py:36] Average training steps per second: 187.48
I0901 12:53:30.577602 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 23
I0901 12:53:30.805768 140586480396288 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 186.20

Steps executed: 237 Episode length: 73 Return: -72.0.0
I0901 12:53:36.378825 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 24

Steps executed: 215 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 194.96
I0901 12:53:41.747619 140586480396288 replay_runner.py:36] Average training steps per second: 194.96
I0901 12:53:41.930600 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.67
INFO:tensorflow:Starting iteration 25

Steps executed: 227 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 188.03
I0901 12:53:47.544275 140586480396288 replay_runner.py:36] Average training steps per second: 188.03
I0901 12:53:47.732075 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 26

Steps executed: 258 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 190.59
I0901 12:53:53.222236 140586480396288 replay_runner.py:36] Average training steps per second: 190.59
I0901 12:53:53.452369 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 27

Steps executed: 251 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 191.38
I0901 12:53:58.920526 140586480396288 replay_runner.py:36] Average training steps per second: 191.38
I0901 12:53:59.175153 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 28

Steps executed: 299 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 188.35
I0901 12:54:04.736660 140586480396288 replay_runner.py:36] Average training steps per second: 188.35
I0901 12:54:05.000121 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 29
I0901 12:54:05.247817 140586480396288 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 191.06

Done fixed training!Episode length: 500 Return: -500.0
I0901 12:54:10.924898 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00