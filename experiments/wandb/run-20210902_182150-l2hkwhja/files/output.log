Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 18:21:55.655432 139977662982144 run_experiment.py:549] Creating TrainRunner ...
I0902 18:21:55.663535 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:55.663698 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:55.663797 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:55.663910 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:55.664023 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:55.664105 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:55.664208 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:55.664341 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:55.664431 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:55.664553 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:55.664686 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:55.664839 139977662982144 dqn_agent.py:283] 	 seed: 1630606915663491
I0902 18:21:55.666884 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:55.666993 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:55.667065 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:55.667126 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:55.667181 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:55.667249 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:55.667306 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:55.667382 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:55.667455 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:55.691756 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:55.944193 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:55.952552 139977662982144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:21:55.959120 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:55.959227 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:55.959281 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:55.959359 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:55.959416 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:55.959461 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:55.959547 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:55.959601 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:55.959667 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:55.959730 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:55.959789 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:55.959852 139977662982144 dqn_agent.py:283] 	 seed: 1630606915959098
I0902 18:21:55.961139 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:55.961240 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:55.961318 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:55.961379 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:55.961440 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:55.961497 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:55.961542 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:55.961608 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:55.961703 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:55.981104 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:55.997261 139977662982144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:21:55.997431 139977662982144 replay_runner.py:41] Starting iteration 0
Steps executed: 212 Episode length: 101 Return: -76.217776722690964
INFO:tensorflow:Average training steps per second: 228.51
I0902 18:22:00.373836 139977662982144 replay_runner.py:36] Average training steps per second: 228.51
I0902 18:22:01.128323 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.77
INFO:tensorflow:Starting iteration 1

Steps executed: 272 Episode length: 147 Return: -248.46463386857524
INFO:tensorflow:Average training steps per second: 318.30
I0902 18:22:07.588670 139977662982144 replay_runner.py:36] Average training steps per second: 318.30
I0902 18:22:07.747553 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.59
INFO:tensorflow:Starting iteration 2

Steps executed: 301 Episode length: 157 Return: -369.89402963964934
INFO:tensorflow:Average training steps per second: 338.51
I0902 18:22:14.003472 139977662982144 replay_runner.py:36] Average training steps per second: 338.51
I0902 18:22:14.190552 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.04
INFO:tensorflow:Starting iteration 3

Steps executed: 236 Episode length: 236 Return: -87.949659339542584
INFO:tensorflow:Average training steps per second: 348.47
I0902 18:22:20.444412 139977662982144 replay_runner.py:36] Average training steps per second: 348.47
I0902 18:22:20.610640 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.95
INFO:tensorflow:Starting iteration 4
I0902 18:22:23.983093 139977662982144 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 339.88

Steps executed: 1000 Episode length: 1000 Return: -96.45805613936518
I0902 18:22:28.737677 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.46
INFO:tensorflow:Starting iteration 5
I0902 18:22:32.087238 139977662982144 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 325.58

Steps executed: 1000 Episode length: 1000 Return: -96.97469850063197
I0902 18:22:36.592584 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.97
INFO:tensorflow:Starting iteration 6
I0902 18:22:39.920325 139977662982144 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 316.81

Steps executed: 1000 Episode length: 1000 Return: -106.48198227530109
I0902 18:22:44.729388 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.48
INFO:tensorflow:Starting iteration 7
I0902 18:22:48.115845 139977662982144 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 342.31

Steps executed: 1000 Episode length: 1000 Return: -138.76633048974159
I0902 18:22:53.461430 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.77
INFO:tensorflow:Starting iteration 8
I0902 18:22:56.804642 139977662982144 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 331.51

Steps executed: 1000 Episode length: 1000 Return: -307.06143688599859
I0902 18:23:02.237475 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.06
INFO:tensorflow:Starting iteration 9

Steps executed: 221 Episode length: 221 Return: -300.7535612295451859
INFO:tensorflow:Average training steps per second: 346.97
I0902 18:23:08.557562 139977662982144 replay_runner.py:36] Average training steps per second: 346.97
I0902 18:23:08.735189 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.75
INFO:tensorflow:Starting iteration 10
I0902 18:23:12.131308 139977662982144 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 329.51

Steps executed: 804 Episode length: 804 Return: -254.4216251574629859
I0902 18:23:16.160255 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.42
INFO:tensorflow:Starting iteration 11

Steps executed: 370 Episode length: 370 Return: -259.5321455206739859
INFO:tensorflow:Average training steps per second: 350.99
I0902 18:23:22.403211 139977662982144 replay_runner.py:36] Average training steps per second: 350.99
I0902 18:23:22.738441 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.53
INFO:tensorflow:Starting iteration 12
I0902 18:23:26.185985 139977662982144 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 348.80

Steps executed: 777 Episode length: 777 Return: -308.1453627758777459
I0902 18:23:30.001315 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.15
INFO:tensorflow:Starting iteration 13

Steps executed: 342 Episode length: 159 Return: -159.5793978301759359
INFO:tensorflow:Average training steps per second: 336.34
I0902 18:23:36.354264 139977662982144 replay_runner.py:36] Average training steps per second: 336.34
I0902 18:23:36.561686 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.31
INFO:tensorflow:Starting iteration 14
I0902 18:23:39.835682 139977662982144 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 309.36

Steps executed: 709 Episode length: 709 Return: -386.6118262893959359
I0902 18:23:43.933452 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.61
INFO:tensorflow:Starting iteration 15

Steps executed: 285 Episode length: 285 Return: -111.3459099429456159
INFO:tensorflow:Average training steps per second: 316.43
I0902 18:23:50.333089 139977662982144 replay_runner.py:36] Average training steps per second: 316.43
I0902 18:23:50.548569 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.35
INFO:tensorflow:Starting iteration 16

Steps executed: 202 Episode length: 202 Return: -237.8451444213326359
INFO:tensorflow:Average training steps per second: 323.89
I0902 18:23:56.813443 139977662982144 replay_runner.py:36] Average training steps per second: 323.89
I0902 18:23:56.965415 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.85
INFO:tensorflow:Starting iteration 17

Steps executed: 401 Episode length: 287 Return: -91.48194800930258359
INFO:tensorflow:Average training steps per second: 327.20
I0902 18:24:03.314192 139977662982144 replay_runner.py:36] Average training steps per second: 327.20
I0902 18:24:03.656677 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.43
INFO:tensorflow:Starting iteration 18

Steps executed: 265 Episode length: 123 Return: -163.0732306733876359
INFO:tensorflow:Average training steps per second: 336.46
I0902 18:24:09.993111 139977662982144 replay_runner.py:36] Average training steps per second: 336.46
I0902 18:24:10.139727 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.63
INFO:tensorflow:Starting iteration 19

Steps executed: 297 Episode length: 297 Return: -335.0361600618086359
INFO:tensorflow:Average training steps per second: 318.35
I0902 18:24:16.598751 139977662982144 replay_runner.py:36] Average training steps per second: 318.35
I0902 18:24:16.847268 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.04
INFO:tensorflow:Starting iteration 20

Steps executed: 253 Episode length: 253 Return: -256.0020463239779359
INFO:tensorflow:Average training steps per second: 307.56
I0902 18:24:23.313759 139977662982144 replay_runner.py:36] Average training steps per second: 307.56
I0902 18:24:23.507829 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.00
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 201 Return: -56.80226295427039359
INFO:tensorflow:Average training steps per second: 309.80
I0902 18:24:29.835172 139977662982144 replay_runner.py:36] Average training steps per second: 309.80
I0902 18:24:30.007727 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.80
INFO:tensorflow:Starting iteration 22
I0902 18:24:33.204900 139977662982144 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 330.41

Steps executed: 1000 Episode length: 1000 Return: -57.520309342581584
I0902 18:24:38.574655 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.52
INFO:tensorflow:Starting iteration 23
I0902 18:24:41.788133 139977662982144 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 325.06

Steps executed: 1000 Episode length: 1000 Return: -59.653710449968806
I0902 18:24:46.682248 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.65
INFO:tensorflow:Starting iteration 24
I0902 18:24:49.714544 139977662982144 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 315.92

Steps executed: 1000 Episode length: 1000 Return: -71.636772980557586
I0902 18:24:55.457069 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.64
INFO:tensorflow:Starting iteration 25

Steps executed: 270 Episode length: 143 Return: -140.1493129817388586
INFO:tensorflow:Average training steps per second: 311.91
I0902 18:25:01.706781 139977662982144 replay_runner.py:36] Average training steps per second: 311.91
I0902 18:25:01.867542 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.55
INFO:tensorflow:Starting iteration 26
I0902 18:25:04.943996 139977662982144 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 332.30

Steps executed: 314 Episode length: 314 Return: -342.5594066546548586
I0902 18:25:08.282683 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.56
INFO:tensorflow:Starting iteration 27
I0902 18:25:11.310837 139977662982144 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 326.09

Steps executed: 1000 Episode length: 1000 Return: 24.0014616489548346
I0902 18:25:16.577856 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: 24.00
INFO:tensorflow:Starting iteration 28

Steps executed: 353 Episode length: 167 Return: -69.77162127247065346
INFO:tensorflow:Average training steps per second: 383.62
I0902 18:25:22.257922 139977662982144 replay_runner.py:36] Average training steps per second: 383.62
I0902 18:25:22.456970 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.02
INFO:tensorflow:Starting iteration 29
I0902 18:25:25.422862 139977662982144 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 408.00

Steps executed: 1000 Episode length: 1000 Return: 0.16544675320445396

Done fixed training! Episode length: 1000 Return: 0.16544675320445396