Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0902 17:44:32.992952 140228977166336 run_experiment.py:549] Creating TrainRunner ...
I0902 17:44:33.002459 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:33.002800 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:33.002960 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:33.003051 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:33.003129 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:33.003242 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:33.003315 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:33.003450 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:33.003525 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:33.003576 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:33.003627 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:33.003833 140228977166336 dqn_agent.py:283] 	 seed: 1630604673002400
I0902 17:44:33.007033 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:33.007272 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:33.007596 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:33.007776 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:33.007879 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:33.008080 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:33.008343 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:33.008502 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:33.008723 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:33.048382 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:33.475528 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:33.511339 140228977166336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:44:33.518758 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:33.518951 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:33.519035 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:33.519110 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:33.519175 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:33.519255 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:33.519407 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:33.519527 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:33.519609 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:33.519687 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:33.519750 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:33.519828 140228977166336 dqn_agent.py:283] 	 seed: 1630604673518713
I0902 17:44:33.522232 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:33.522384 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:33.522476 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:33.522562 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:33.522664 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:33.522753 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:33.522842 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:33.522928 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:33.523009 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:33.553479 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:33.575326 140228977166336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:44:33.575560 140228977166336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.37
I0902 17:44:40.361613 140228977166336 replay_runner.py:36] Average training steps per second: 147.37
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:44:41.896260 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:44:42.146625 140228977166336 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.86
I0902 17:44:47.125649 140228977166336 replay_runner.py:36] Average training steps per second: 200.86
I0902 17:44:47.546214 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:44:47.782479 140228977166336 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.40
I0902 17:44:53.035106 140228977166336 replay_runner.py:36] Average training steps per second: 190.40
I0902 17:44:53.423124 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:44:53.646278 140228977166336 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 202.27
I0902 17:44:58.590674 140228977166336 replay_runner.py:36] Average training steps per second: 202.27
I0902 17:44:59.027749 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:44:59.263156 140228977166336 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 202.95
I0902 17:45:04.191030 140228977166336 replay_runner.py:36] Average training steps per second: 202.95
I0902 17:45:04.584868 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:45:04.827419 140228977166336 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 193.23
I0902 17:45:10.003114 140228977166336 replay_runner.py:36] Average training steps per second: 193.23
I0902 17:45:10.413848 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:45:10.647560 140228977166336 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 203.25
I0902 17:45:15.568269 140228977166336 replay_runner.py:36] Average training steps per second: 203.25
I0902 17:45:16.017538 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:45:16.271057 140228977166336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.37
I0902 17:45:21.363963 140228977166336 replay_runner.py:36] Average training steps per second: 196.37
I0902 17:45:21.756195 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:45:21.997589 140228977166336 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 193.14
I0902 17:45:27.175719 140228977166336 replay_runner.py:36] Average training steps per second: 193.14
I0902 17:45:27.607701 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:45:27.856232 140228977166336 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 201.52
I0902 17:45:32.819086 140228977166336 replay_runner.py:36] Average training steps per second: 201.52
I0902 17:45:33.246118 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:45:33.503742 140228977166336 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 192.64
I0902 17:45:38.695389 140228977166336 replay_runner.py:36] Average training steps per second: 192.64
I0902 17:45:39.099478 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:45:39.340726 140228977166336 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.37
I0902 17:45:44.407830 140228977166336 replay_runner.py:36] Average training steps per second: 197.37
I0902 17:45:44.848440 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:45:45.102983 140228977166336 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 199.59
I0902 17:45:50.113755 140228977166336 replay_runner.py:36] Average training steps per second: 199.59
I0902 17:45:50.516052 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:45:50.764388 140228977166336 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.59
I0902 17:45:55.903875 140228977166336 replay_runner.py:36] Average training steps per second: 194.59
I0902 17:45:56.307603 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:45:56.545840 140228977166336 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 217.87
I0902 17:46:01.136101 140228977166336 replay_runner.py:36] Average training steps per second: 217.87
I0902 17:46:01.509589 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:46:01.746840 140228977166336 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 206.54
I0902 17:46:06.588716 140228977166336 replay_runner.py:36] Average training steps per second: 206.54
I0902 17:46:06.956459 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:46:07.188043 140228977166336 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 189.42
I0902 17:46:12.467786 140228977166336 replay_runner.py:36] Average training steps per second: 189.42
I0902 17:46:12.852345 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:46:13.090827 140228977166336 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 191.90
I0902 17:46:18.302421 140228977166336 replay_runner.py:36] Average training steps per second: 191.90
I0902 17:46:18.730847 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:46:18.985706 140228977166336 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 204.23
I0902 17:46:23.882491 140228977166336 replay_runner.py:36] Average training steps per second: 204.23
I0902 17:46:24.295663 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:46:24.539074 140228977166336 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.02
I0902 17:46:29.774659 140228977166336 replay_runner.py:36] Average training steps per second: 191.02
I0902 17:46:30.188465 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:46:30.436168 140228977166336 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.72
I0902 17:46:35.494221 140228977166336 replay_runner.py:36] Average training steps per second: 197.72
I0902 17:46:35.915192 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:46:36.167497 140228977166336 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.29
I0902 17:46:41.185903 140228977166336 replay_runner.py:36] Average training steps per second: 199.29
I0902 17:46:41.590981 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 17:46:41.838346 140228977166336 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.07
I0902 17:46:46.965264 140228977166336 replay_runner.py:36] Average training steps per second: 195.07
I0902 17:46:47.408573 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 17:46:47.668267 140228977166336 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 202.38
I0902 17:46:52.609879 140228977166336 replay_runner.py:36] Average training steps per second: 202.38
I0902 17:46:53.048756 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:46:53.303025 140228977166336 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.14
I0902 17:46:58.376150 140228977166336 replay_runner.py:36] Average training steps per second: 197.14
I0902 17:46:58.773196 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 17:46:59.019511 140228977166336 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 198.19
I0902 17:47:04.065625 140228977166336 replay_runner.py:36] Average training steps per second: 198.19
I0902 17:47:04.483948 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:47:04.733685 140228977166336 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 208.58
I0902 17:47:09.528435 140228977166336 replay_runner.py:36] Average training steps per second: 208.58
I0902 17:47:09.888601 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 17:47:10.111920 140228977166336 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 207.86
I0902 17:47:14.923398 140228977166336 replay_runner.py:36] Average training steps per second: 207.86
I0902 17:47:15.268635 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0902 17:47:15.494059 140228977166336 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 208.44
I0902 17:47:20.291989 140228977166336 replay_runner.py:36] Average training steps per second: 208.44
I0902 17:47:20.683920 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29
I0902 17:47:20.918584 140228977166336 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 213.49

Done fixed training!Episode length: 500 Return: -500.0
I0902 17:47:25.950796 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00