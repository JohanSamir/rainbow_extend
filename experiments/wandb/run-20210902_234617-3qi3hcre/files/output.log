Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 23:46:23.954695 140099460519936 run_experiment.py:549] Creating TrainRunner ...
I0902 23:46:23.966788 140099460519936 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:23.967071 140099460519936 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:23.967229 140099460519936 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:23.967361 140099460519936 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:23.967723 140099460519936 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:23.967884 140099460519936 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:46:23.968026 140099460519936 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:23.968166 140099460519936 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:23.968273 140099460519936 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:23.968414 140099460519936 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:23.968523 140099460519936 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:23.968727 140099460519936 dqn_agent.py:283] 	 seed: 1630626383966722
I0902 23:46:23.971807 140099460519936 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:23.972001 140099460519936 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:46:23.972121 140099460519936 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:23.972224 140099460519936 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:23.972347 140099460519936 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:23.972490 140099460519936 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:23.972589 140099460519936 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:23.972680 140099460519936 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:23.972970 140099460519936 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:24.014553 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:24.410696 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:24.425202 140099460519936 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:46:24.435608 140099460519936 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:24.436536 140099460519936 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:24.436729 140099460519936 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:24.436851 140099460519936 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:24.436942 140099460519936 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:24.447569 140099460519936 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:46:24.458605 140099460519936 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:24.461980 140099460519936 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:24.462197 140099460519936 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:24.462315 140099460519936 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:24.462470 140099460519936 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:24.462573 140099460519936 dqn_agent.py:283] 	 seed: 1630626384435540
I0902 23:46:24.464797 140099460519936 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:24.464936 140099460519936 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:46:24.465010 140099460519936 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:24.465081 140099460519936 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:24.465147 140099460519936 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:24.465234 140099460519936 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:24.465327 140099460519936 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:24.465430 140099460519936 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:24.465571 140099460519936 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:24.499245 140099460519936 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:24.520733 140099460519936 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:46:24.520954 140099460519936 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.05
I0902 23:46:30.616974 140099460519936 replay_runner.py:36] Average training steps per second: 164.05
Steps executed: 208 Episode length: 96 Return: -760.576967715364
I0902 23:46:31.843384 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -721.64
INFO:tensorflow:Starting iteration 1

Steps executed: 290 Episode length: 146 Return: -278.6303310511938
INFO:tensorflow:Average training steps per second: 225.19
I0902 23:46:40.660072 140099460519936 replay_runner.py:36] Average training steps per second: 225.19
I0902 23:46:40.915181 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.92
INFO:tensorflow:Starting iteration 2

Steps executed: 278 Episode length: 131 Return: -439.30958252109303
INFO:tensorflow:Average training steps per second: 229.95
I0902 23:46:49.700435 140099460519936 replay_runner.py:36] Average training steps per second: 229.95
I0902 23:46:49.964116 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.57
INFO:tensorflow:Starting iteration 3

Steps executed: 467 Episode length: 311 Return: -88.913895914111125
INFO:tensorflow:Average training steps per second: 231.59
I0902 23:46:58.564058 140099460519936 replay_runner.py:36] Average training steps per second: 231.59
I0902 23:46:59.104920 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.68
INFO:tensorflow:Starting iteration 4
I0902 23:47:03.302531 140099460519936 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 228.59

Steps executed: 983 Episode length: 983 Return: -120.40908886654115
I0902 23:47:12.295752 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.41
INFO:tensorflow:Starting iteration 5
I0902 23:47:16.683613 140099460519936 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 229.38

Steps executed: 948 Episode length: 948 Return: -432.08803466484715
I0902 23:47:23.728628 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.09
INFO:tensorflow:Starting iteration 6
I0902 23:47:28.062254 140099460519936 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 224.06

Steps executed: 1000 Episode length: 1000 Return: -101.24607142037058
I0902 23:47:35.117630 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.25
INFO:tensorflow:Starting iteration 7
I0902 23:47:39.487019 140099460519936 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 225.99

Steps executed: 1000 Episode length: 1000 Return: -71.099388814837928
I0902 23:47:46.225085 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.10
INFO:tensorflow:Starting iteration 8
I0902 23:47:50.617085 140099460519936 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 224.43

Steps executed: 1000 Episode length: 1000 Return: -181.47577194450943
I0902 23:47:57.110027 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.48
INFO:tensorflow:Starting iteration 9
I0902 23:48:01.469222 140099460519936 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 228.77

Steps executed: 250 Episode length: 250 Return: -451.4357140503570343
I0902 23:48:06.138438 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.44
INFO:tensorflow:Starting iteration 10

Steps executed: 282 Episode length: 282 Return: -215.8421432722297343
INFO:tensorflow:Average training steps per second: 229.41
I0902 23:48:15.026912 140099460519936 replay_runner.py:36] Average training steps per second: 229.41
I0902 23:48:15.379803 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.84
INFO:tensorflow:Starting iteration 11
I0902 23:48:19.699129 140099460519936 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 222.87

Steps executed: 819 Episode length: 819 Return: -470.0962397336257343
I0902 23:48:26.019434 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.10
INFO:tensorflow:Starting iteration 12
I0902 23:48:30.415306 140099460519936 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 223.83
I0902 23:48:34.883406 140099460519936 replay_runner.py:36] Average training steps per second: 223.83

Steps executed: 619 Episode length: 619 Return: -262.2199230676842543
INFO:tensorflow:Starting iteration 13
I0902 23:48:40.476807 140099460519936 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 227.01

Steps executed: 1000 Episode length: 1000 Return: -112.69633645118683
I0902 23:48:48.412654 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.70
INFO:tensorflow:Starting iteration 14
I0902 23:48:52.866112 140099460519936 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 236.57

Steps executed: 1000 Episode length: 1000 Return: -247.94712373205153
I0902 23:49:00.802114 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.95
INFO:tensorflow:Starting iteration 15
I0902 23:49:05.110052 140099460519936 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 223.90
I0902 23:49:09.576675 140099460519936 replay_runner.py:36] Average training steps per second: 223.90

Steps executed: 359 Episode length: 172 Return: -155.1559093404933753
INFO:tensorflow:Starting iteration 16

Steps executed: 229 Episode length: 229 Return: 87.458478159127233753
INFO:tensorflow:Average training steps per second: 226.18
I0902 23:49:18.714470 140099460519936 replay_runner.py:36] Average training steps per second: 226.18
I0902 23:49:19.018882 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: 87.46
INFO:tensorflow:Starting iteration 17
I0902 23:49:23.399908 140099460519936 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 224.56

Steps executed: 1000 Episode length: 1000 Return: 22.1984641614971033
I0902 23:49:30.716062 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: 22.20
INFO:tensorflow:Starting iteration 18

Steps executed: 248 Episode length: 134 Return: -195.0627823755948833
INFO:tensorflow:Average training steps per second: 232.20
I0902 23:49:39.442787 140099460519936 replay_runner.py:36] Average training steps per second: 232.20
I0902 23:49:39.645257 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.74
INFO:tensorflow:Starting iteration 19

Steps executed: 247 Episode length: 182 Return: -131.7208683680648833
INFO:tensorflow:Average training steps per second: 224.33
I0902 23:49:48.421481 140099460519936 replay_runner.py:36] Average training steps per second: 224.33
I0902 23:49:48.613679 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.33
INFO:tensorflow:Starting iteration 20

Steps executed: 337 Episode length: 144 Return: -539.9947185408839833
INFO:tensorflow:Average training steps per second: 228.45
I0902 23:49:57.336343 140099460519936 replay_runner.py:36] Average training steps per second: 228.45
I0902 23:49:57.615566 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -407.79
INFO:tensorflow:Starting iteration 21

Steps executed: 330 Episode length: 175 Return: -171.7303497257657333
INFO:tensorflow:Average training steps per second: 222.71
I0902 23:50:06.430446 140099460519936 replay_runner.py:36] Average training steps per second: 222.71
I0902 23:50:06.694969 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.45
INFO:tensorflow:Starting iteration 22

Steps executed: 259 Episode length: 259 Return: -472.3913166827337333
INFO:tensorflow:Average training steps per second: 218.32
I0902 23:50:15.581962 140099460519936 replay_runner.py:36] Average training steps per second: 218.32
I0902 23:50:15.876089 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -472.39
INFO:tensorflow:Starting iteration 23

Steps executed: 302 Episode length: 124 Return: -94.72787759744259533
INFO:tensorflow:Average training steps per second: 221.64
I0902 23:50:24.641498 140099460519936 replay_runner.py:36] Average training steps per second: 221.64
I0902 23:50:24.904653 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.32
INFO:tensorflow:Starting iteration 24

Steps executed: 218 Episode length: 145 Return: -105.6254591905036633
INFO:tensorflow:Average training steps per second: 222.02
I0902 23:50:33.639313 140099460519936 replay_runner.py:36] Average training steps per second: 222.02
I0902 23:50:33.837601 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.13
INFO:tensorflow:Starting iteration 25

Steps executed: 268 Episode length: 87 Return: -162.42737151832225633
INFO:tensorflow:Average training steps per second: 215.00
I0902 23:50:42.937903 140099460519936 replay_runner.py:36] Average training steps per second: 215.00
I0902 23:50:43.124945 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.13
INFO:tensorflow:Starting iteration 26

Steps executed: 171 Episode length: 171 Return: -132.2452515902735633
INFO:tensorflow:Average training steps per second: 222.21
I0902 23:50:51.982869 140099460519936 replay_runner.py:36] Average training steps per second: 222.21

Steps executed: 320 Episode length: 149 Return: -32.32038851677811633
INFO:tensorflow:Starting iteration 27

Steps executed: 270 Episode length: 89 Return: -147.58368610151274633
INFO:tensorflow:Average training steps per second: 224.88
I0902 23:51:01.047245 140099460519936 replay_runner.py:36] Average training steps per second: 224.88
I0902 23:51:01.223829 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.42
INFO:tensorflow:Starting iteration 28

Steps executed: 281 Episode length: 88 Return: -153.32741746357442633
INFO:tensorflow:Average training steps per second: 223.15
I0902 23:51:10.135458 140099460519936 replay_runner.py:36] Average training steps per second: 223.15
I0902 23:51:10.341194 140099460519936 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 29

Steps executed: 221 Episode length: 90 Return: -154.40816259072413633
INFO:tensorflow:Average training steps per second: 224.70
I0902 23:51:19.177055 140099460519936 replay_runner.py:36] Average training steps per second: 224.70

Done fixed training!Episode length: 90 Return: -154.40816259072413633