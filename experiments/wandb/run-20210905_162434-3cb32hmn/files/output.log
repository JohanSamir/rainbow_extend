I0905 16:24:39.987131 140235000764416 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:39.994369 140235000764416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:39.994495 140235000764416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:39.994584 140235000764416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:39.994646 140235000764416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:39.994702 140235000764416 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:39.994776 140235000764416 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:39.994863 140235000764416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:39.994925 140235000764416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:39.994994 140235000764416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:39.995080 140235000764416 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:39.995150 140235000764416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:39.995204 140235000764416 dqn_agent.py:283] 	 seed: 1630859079994334
I0905 16:24:39.997406 140235000764416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:39.997522 140235000764416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:39.997605 140235000764416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:39.997669 140235000764416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:39.997781 140235000764416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:39.997858 140235000764416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:39.997935 140235000764416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:39.998008 140235000764416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:39.998085 140235000764416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:41.315534 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0905 16:24:41.632197 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:41.640882 140235000764416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:41.646329 140235000764416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:41.646463 140235000764416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:41.646545 140235000764416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:41.646612 140235000764416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:41.646672 140235000764416 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:41.646758 140235000764416 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:41.646821 140235000764416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:41.646906 140235000764416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:41.646965 140235000764416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:41.647036 140235000764416 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:41.647107 140235000764416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:41.647166 140235000764416 dqn_agent.py:283] 	 seed: 1630859081646302
I0905 16:24:41.648756 140235000764416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:41.648868 140235000764416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:41.648956 140235000764416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:41.649022 140235000764416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:41.649092 140235000764416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:41.649149 140235000764416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:41.649221 140235000764416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:41.649296 140235000764416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:41.649350 140235000764416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:41.667266 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:41.679812 140235000764416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:41.679949 140235000764416 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 290.99
I0905 16:24:45.116626 140235000764416 replay_runner.py:36] Average training steps per second: 290.99
Steps executed: 233 Episode length: 109 Return: -113.81504069544745
I0905 16:24:45.820907 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.89
INFO:tensorflow:Starting iteration 1

Steps executed: 267 Episode length: 149 Return: -236.09238008625016
INFO:tensorflow:Average training steps per second: 411.34
I0905 16:24:51.374326 140235000764416 replay_runner.py:36] Average training steps per second: 411.34
I0905 16:24:51.490646 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.16
INFO:tensorflow:Starting iteration 2

Steps executed: 260 Episode length: 148 Return: -250.13868293358527
INFO:tensorflow:Average training steps per second: 394.48
I0905 16:24:57.069417 140235000764416 replay_runner.py:36] Average training steps per second: 394.48
I0905 16:24:57.236232 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.70
INFO:tensorflow:Starting iteration 3

Steps executed: 341 Episode length: 142 Return: -245.29389022765324
INFO:tensorflow:Average training steps per second: 328.99
I0905 16:25:03.742266 140235000764416 replay_runner.py:36] Average training steps per second: 328.99
I0905 16:25:03.879737 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.99
INFO:tensorflow:Starting iteration 4

Steps executed: 324 Episode length: 129 Return: -218.55380294351094
INFO:tensorflow:Average training steps per second: 417.83
I0905 16:25:09.779188 140235000764416 replay_runner.py:36] Average training steps per second: 417.83
I0905 16:25:09.909538 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.88
INFO:tensorflow:Starting iteration 5

Steps executed: 242 Episode length: 242 Return: -322.25879869629273
INFO:tensorflow:Average training steps per second: 415.97
I0905 16:25:15.411968 140235000764416 replay_runner.py:36] Average training steps per second: 415.97
I0905 16:25:15.547229 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.26
INFO:tensorflow:Starting iteration 6

Steps executed: 439 Episode length: 439 Return: -316.95175076083063
INFO:tensorflow:Average training steps per second: 414.05
I0905 16:25:21.065195 140235000764416 replay_runner.py:36] Average training steps per second: 414.05
I0905 16:25:21.505005 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.95
INFO:tensorflow:Starting iteration 7

Steps executed: 448 Episode length: 448 Return: -293.92017666209553
INFO:tensorflow:Average training steps per second: 405.39
I0905 16:25:27.104944 140235000764416 replay_runner.py:36] Average training steps per second: 405.39
I0905 16:25:27.535282 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.92
INFO:tensorflow:Starting iteration 8
I0905 16:25:30.660980 140235000764416 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 407.17

Steps executed: 695 Episode length: 695 Return: -286.36342429414163
I0905 16:25:33.912739 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.36
INFO:tensorflow:Starting iteration 9

Steps executed: 250 Episode length: 250 Return: -251.36205951929284
INFO:tensorflow:Average training steps per second: 408.93
I0905 16:25:39.529647 140235000764416 replay_runner.py:36] Average training steps per second: 408.93
I0905 16:25:39.666493 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.36
INFO:tensorflow:Starting iteration 10

Steps executed: 411 Episode length: 411 Return: -331.73991646554293
INFO:tensorflow:Average training steps per second: 407.80
I0905 16:25:45.212509 140235000764416 replay_runner.py:36] Average training steps per second: 407.80
I0905 16:25:45.528079 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.74
INFO:tensorflow:Starting iteration 11

Steps executed: 609 Episode length: 609 Return: -279.53729622753895
INFO:tensorflow:Average training steps per second: 410.17
I0905 16:25:51.098692 140235000764416 replay_runner.py:36] Average training steps per second: 410.17
I0905 16:25:51.858131 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.54
INFO:tensorflow:Starting iteration 12

Steps executed: 528 Episode length: 528 Return: -1177.9060952172558
INFO:tensorflow:Average training steps per second: 413.71
I0905 16:25:57.410201 140235000764416 replay_runner.py:36] Average training steps per second: 413.71
I0905 16:25:57.957137 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -1177.91
INFO:tensorflow:Starting iteration 13
I0905 16:26:01.052400 140235000764416 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 413.97

Steps executed: 1000 Episode length: 1000 Return: -184.17989511021761
I0905 16:26:05.090658 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.18
INFO:tensorflow:Starting iteration 14
I0905 16:26:08.236827 140235000764416 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 411.91

Steps executed: 1000 Episode length: 1000 Return: -148.41433599556927
I0905 16:26:12.084401 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.41
INFO:tensorflow:Starting iteration 15

Steps executed: 305 Episode length: 305 Return: -154.3341951826848227
INFO:tensorflow:Average training steps per second: 389.72
I0905 16:26:17.799124 140235000764416 replay_runner.py:36] Average training steps per second: 389.72
I0905 16:26:18.006927 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.33
INFO:tensorflow:Starting iteration 16

Steps executed: 340 Episode length: 340 Return: -1314.764727239601427
INFO:tensorflow:Average training steps per second: 394.24
I0905 16:26:23.705596 140235000764416 replay_runner.py:36] Average training steps per second: 394.24
I0905 16:26:23.985830 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -1314.76
INFO:tensorflow:Starting iteration 17
I0905 16:26:27.127045 140235000764416 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 409.26

Steps executed: 1000 Episode length: 1000 Return: -40.462786135486767
I0905 16:26:31.106264 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.46
INFO:tensorflow:Starting iteration 18

Steps executed: 250 Episode length: 250 Return: -353.2729603991782667
INFO:tensorflow:Average training steps per second: 403.83
I0905 16:26:36.739983 140235000764416 replay_runner.py:36] Average training steps per second: 403.83
I0905 16:26:36.903586 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.27
INFO:tensorflow:Starting iteration 19
I0905 16:26:40.035115 140235000764416 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 369.20
I0905 16:26:42.743959 140235000764416 replay_runner.py:36] Average training steps per second: 369.20

Steps executed: 1000 Episode length: 1000 Return: -97.873301826429177
INFO:tensorflow:Starting iteration 20
I0905 16:26:47.484599 140235000764416 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 360.30
I0905 16:26:50.260453 140235000764416 replay_runner.py:36] Average training steps per second: 360.30

Steps executed: 1000 Episode length: 1000 Return: -97.302277337438627
INFO:tensorflow:Starting iteration 21
I0905 16:26:55.815231 140235000764416 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 316.95

Steps executed: 1000 Episode length: 1000 Return: -106.04856354175305
I0905 16:27:01.848562 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.05
INFO:tensorflow:Starting iteration 22

Steps executed: 143 Episode length: 143 Return: -444.4767795948295305
INFO:tensorflow:Average training steps per second: 300.55
I0905 16:27:08.721810 140235000764416 replay_runner.py:36] Average training steps per second: 300.55

Steps executed: 1143 Episode length: 1000 Return: -107.87004641999941
INFO:tensorflow:Starting iteration 23
I0905 16:27:15.794237 140235000764416 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 306.68

Steps executed: 1000 Episode length: 1000 Return: -141.14915406163334
I0905 16:27:21.958461 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.15
INFO:tensorflow:Starting iteration 24
I0905 16:27:25.658318 140235000764416 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 294.25

Steps executed: 968 Episode length: 968 Return: -486.9731389913967534
I0905 16:27:31.779382 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.97
INFO:tensorflow:Starting iteration 25

Steps executed: 207 Episode length: 207 Return: -529.7788430646397534
INFO:tensorflow:Average training steps per second: 310.50
I0905 16:27:38.707235 140235000764416 replay_runner.py:36] Average training steps per second: 310.50
I0905 16:27:38.865227 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.78
INFO:tensorflow:Starting iteration 26

Steps executed: 213 Episode length: 213 Return: -475.2580274367255534
INFO:tensorflow:Average training steps per second: 315.12
I0905 16:27:45.721801 140235000764416 replay_runner.py:36] Average training steps per second: 315.12
I0905 16:27:45.881875 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -475.26
INFO:tensorflow:Starting iteration 27
I0905 16:27:49.536259 140235000764416 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 311.16

Steps executed: 1000 Episode length: 1000 Return: -80.152306641061144
I0905 16:27:54.543061 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.15
INFO:tensorflow:Starting iteration 28

Steps executed: 55 Episode length: 55 Return: -367.065557621651861144
INFO:tensorflow:Average training steps per second: 302.44

Steps executed: 809 Episode length: 754 Return: -232.7827975795783644
I0905 16:28:02.982160 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.92
INFO:tensorflow:Starting iteration 29

Steps executed: 271 Episode length: 156 Return: -233.5115179333480544
INFO:tensorflow:Average training steps per second: 271.49
I0905 16:28:10.330507 140235000764416 replay_runner.py:36] Average training steps per second: 271.49

Done fixed training!Episode length: 156 Return: -233.5115179333480544