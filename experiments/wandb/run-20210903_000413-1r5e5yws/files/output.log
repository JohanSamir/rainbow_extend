Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0903 00:04:19.190761 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0903 00:04:19.198139 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:04:19.198267 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:04:19.198322 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:04:19.198398 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:04:19.198450 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0903 00:04:19.198500 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:04:19.198548 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:04:19.198642 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:04:19.198714 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:04:19.198788 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0903 00:04:19.198847 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:04:19.198914 139735608805376 dqn_agent.py:283] 	 seed: 1630627459198110
I0903 00:04:19.201084 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:04:19.201257 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:04:19.201361 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:04:19.201445 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:04:19.201521 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:04:19.201608 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:04:19.201760 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:04:19.201949 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:04:19.202073 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:04:19.226707 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:19.515771 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:19.523895 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:04:19.530043 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:04:19.530191 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:04:19.530297 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:04:19.530366 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:04:19.530421 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0903 00:04:19.530496 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:04:19.530577 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:04:19.530675 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:04:19.530764 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:04:19.530833 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0903 00:04:19.530901 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:04:19.530981 139735608805376 dqn_agent.py:283] 	 seed: 1630627459530012
I0903 00:04:19.532664 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:04:19.532776 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:04:19.532867 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:04:19.532930 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:04:19.533038 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:04:19.533107 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:04:19.533195 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:04:19.533272 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:04:19.533345 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:04:19.551889 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:19.566710 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:04:19.566892 139735608805376 replay_runner.py:41] Starting iteration 0
Steps executed: 269 Episode length: 106 Return: -319.2246008036167
INFO:tensorflow:Average training steps per second: 254.64
I0903 00:04:23.494164 139735608805376 replay_runner.py:36] Average training steps per second: 254.64
I0903 00:04:24.300233 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.77
INFO:tensorflow:Starting iteration 1

Steps executed: 235 Episode length: 98 Return: -371.41091706791144
INFO:tensorflow:Average training steps per second: 340.23
I0903 00:04:30.497653 139735608805376 replay_runner.py:36] Average training steps per second: 340.23
I0903 00:04:30.615356 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.04
INFO:tensorflow:Starting iteration 2

Steps executed: 336 Episode length: 163 Return: -456.3491540281025
INFO:tensorflow:Average training steps per second: 339.14
I0903 00:04:36.951857 139735608805376 replay_runner.py:36] Average training steps per second: 339.14
I0903 00:04:37.157595 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.40
INFO:tensorflow:Starting iteration 3

Steps executed: 427 Episode length: 427 Return: -282.2168687902526
INFO:tensorflow:Average training steps per second: 334.55
I0903 00:04:43.491602 139735608805376 replay_runner.py:36] Average training steps per second: 334.55
I0903 00:04:43.930445 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.22
INFO:tensorflow:Starting iteration 4
I0903 00:04:47.350921 139735608805376 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 329.53

Steps executed: 1000 Episode length: 1000 Return: -92.0834146305249
I0903 00:04:51.928706 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.08
INFO:tensorflow:Starting iteration 5
I0903 00:04:55.336266 139735608805376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 332.05

Steps executed: 660 Episode length: 660 Return: -296.94513132991005
I0903 00:04:59.137086 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.95
INFO:tensorflow:Starting iteration 6
I0903 00:05:02.464282 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 336.43
I0903 00:05:05.436943 139735608805376 replay_runner.py:36] Average training steps per second: 336.43

Steps executed: 1000 Episode length: 1000 Return: -246.0263094647452
INFO:tensorflow:Starting iteration 7

Steps executed: 1000 Episode length: 1000 Return: -161.47086056873982
INFO:tensorflow:Average training steps per second: 343.11
I0903 00:05:13.343005 139735608805376 replay_runner.py:36] Average training steps per second: 343.11
I0903 00:05:14.632810 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.47
INFO:tensorflow:Starting iteration 8
I0903 00:05:18.068461 139735608805376 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 355.84

Steps executed: 643 Episode length: 643 Return: -300.0265961504778782
I0903 00:05:21.826428 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.03
INFO:tensorflow:Starting iteration 9
I0903 00:05:25.329445 139735608805376 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 355.19

Steps executed: 1000 Episode length: 1000 Return: -164.59313656941796
I0903 00:05:30.550084 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.59
INFO:tensorflow:Starting iteration 10
I0903 00:05:34.051641 139735608805376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 354.89

Steps executed: 1000 Episode length: 1000 Return: -237.10866499164774
I0903 00:05:38.894215 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.11
INFO:tensorflow:Starting iteration 11
I0903 00:05:42.241706 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 341.35

Steps executed: 937 Episode length: 937 Return: -628.5619115450961774
I0903 00:05:46.565589 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.56
INFO:tensorflow:Starting iteration 12

Steps executed: 277 Episode length: 277 Return: -189.0138704997571674
INFO:tensorflow:Average training steps per second: 330.83
I0903 00:05:52.906443 139735608805376 replay_runner.py:36] Average training steps per second: 330.83
I0903 00:05:53.187176 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.01
INFO:tensorflow:Starting iteration 13

Steps executed: 1000 Episode length: 1000 Return: -126.61442823671801
INFO:tensorflow:Average training steps per second: 347.53
I0903 00:05:59.525065 139735608805376 replay_runner.py:36] Average training steps per second: 347.53
I0903 00:06:01.245105 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.61
INFO:tensorflow:Starting iteration 14

Steps executed: 703 Episode length: 558 Return: -365.5304861322361401
INFO:tensorflow:Average training steps per second: 334.50
I0903 00:06:07.603636 139735608805376 replay_runner.py:36] Average training steps per second: 334.50
I0903 00:06:08.514132 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.07
INFO:tensorflow:Starting iteration 15
I0903 00:06:11.881674 139735608805376 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 324.27

Steps executed: 1000 Episode length: 1000 Return: -120.84223968238915
I0903 00:06:16.732305 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.84
INFO:tensorflow:Starting iteration 16
I0903 00:06:20.122772 139735608805376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 329.24

Steps executed: 1000 Episode length: 1000 Return: -182.77947038405088
I0903 00:06:24.788708 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.78
INFO:tensorflow:Starting iteration 17
I0903 00:06:28.206171 139735608805376 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 332.91
I0903 00:06:31.210322 139735608805376 replay_runner.py:36] Average training steps per second: 332.91

Steps executed: 262 Episode length: 210 Return: -181.5307731716163788
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 78 Return: -53.817993909371146788
INFO:tensorflow:Average training steps per second: 326.98
I0903 00:06:37.913281 139735608805376 replay_runner.py:36] Average training steps per second: 326.98
I0903 00:06:38.023206 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.22
INFO:tensorflow:Starting iteration 19

Steps executed: 338 Episode length: 213 Return: -350.4210623536818788
INFO:tensorflow:Average training steps per second: 324.45
I0903 00:06:44.525296 139735608805376 replay_runner.py:36] Average training steps per second: 324.45
I0903 00:06:44.753227 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.95
INFO:tensorflow:Starting iteration 20
I0903 00:06:48.171873 139735608805376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 335.82

Steps executed: 497 Episode length: 497 Return: -91.85766699134965788
I0903 00:06:51.823117 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.86
INFO:tensorflow:Starting iteration 21

Steps executed: 203 Episode length: 203 Return: -24.04957781675376888
INFO:tensorflow:Average training steps per second: 339.88
I0903 00:06:58.237824 139735608805376 replay_runner.py:36] Average training steps per second: 339.88
I0903 00:06:58.407430 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.05
INFO:tensorflow:Starting iteration 22

Steps executed: 241 Episode length: 88 Return: -134.15105849909538888
INFO:tensorflow:Average training steps per second: 335.17
I0903 00:07:04.882315 139735608805376 replay_runner.py:36] Average training steps per second: 335.17
I0903 00:07:04.988796 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.91
INFO:tensorflow:Starting iteration 23

Steps executed: 338 Episode length: 150 Return: -166.4710828209984888
INFO:tensorflow:Average training steps per second: 342.32
I0903 00:07:11.407573 139735608805376 replay_runner.py:36] Average training steps per second: 342.32
I0903 00:07:11.618786 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.91
INFO:tensorflow:Starting iteration 24

Steps executed: 263 Episode length: 64 Return: -174.38224329100292888
INFO:tensorflow:Average training steps per second: 340.80
I0903 00:07:18.027246 139735608805376 replay_runner.py:36] Average training steps per second: 340.80
I0903 00:07:18.195437 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.06
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 134 Return: -27.57890020731841288
INFO:tensorflow:Average training steps per second: 347.51
I0903 00:07:24.551685 139735608805376 replay_runner.py:36] Average training steps per second: 347.51
I0903 00:07:24.717084 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.04
INFO:tensorflow:Starting iteration 26

Steps executed: 272 Episode length: 105 Return: -118.7866229725669688
INFO:tensorflow:Average training steps per second: 333.43
I0903 00:07:31.155664 139735608805376 replay_runner.py:36] Average training steps per second: 333.43
I0903 00:07:31.307016 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.77
INFO:tensorflow:Starting iteration 27

Steps executed: 262 Episode length: 154 Return: 33.410361540020006688
INFO:tensorflow:Average training steps per second: 341.45
I0903 00:07:37.658564 139735608805376 replay_runner.py:36] Average training steps per second: 341.45
I0903 00:07:37.850451 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.84
INFO:tensorflow:Starting iteration 28

Steps executed: 588 Episode length: 588 Return: -1272.141325785025688
INFO:tensorflow:Average training steps per second: 349.82
I0903 00:07:44.190492 139735608805376 replay_runner.py:36] Average training steps per second: 349.82
I0903 00:07:45.285771 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -1272.14
INFO:tensorflow:Starting iteration 29

Steps executed: 404 Episode length: 234 Return: -633.3115088468767688
INFO:tensorflow:Average training steps per second: 336.71
I0903 00:07:51.689239 139735608805376 replay_runner.py:36] Average training steps per second: 336.71

Done fixed training!Episode length: 234 Return: -633.3115088468767688