Loaded trained dqn in mountaincar
Training fixed agent 6, please be patient, may be a while...
I0909 14:10:46.722468 140168371447808 run_experiment.py:549] Creating TrainRunner ...
I0909 14:10:46.730063 140168371447808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:10:46.730197 140168371447808 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:10:46.730277 140168371447808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:10:46.730344 140168371447808 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:10:46.730426 140168371447808 dqn_agent.py:275] 	 update_period: 4
I0909 14:10:46.730493 140168371447808 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:10:46.730574 140168371447808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:10:46.730675 140168371447808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:10:46.730756 140168371447808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:10:46.730828 140168371447808 dqn_agent.py:280] 	 optimizer: adam
I0909 14:10:46.730903 140168371447808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:10:46.730985 140168371447808 dqn_agent.py:283] 	 seed: 1631196646730030
I0909 14:10:46.732733 140168371447808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:10:46.732860 140168371447808 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:10:46.732944 140168371447808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:10:46.733012 140168371447808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:10:46.733073 140168371447808 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:10:46.733135 140168371447808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:10:46.733210 140168371447808 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:10:46.733271 140168371447808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:10:46.733339 140168371447808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:10:46.894739 140168371447808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:47.167128 140168371447808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:47.181691 140168371447808 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 14:10:47.188880 140168371447808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:10:47.189075 140168371447808 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:10:47.189267 140168371447808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:10:47.189398 140168371447808 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:10:47.189508 140168371447808 dqn_agent.py:275] 	 update_period: 4
I0909 14:10:47.189608 140168371447808 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:10:47.189721 140168371447808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:10:47.189836 140168371447808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:10:47.189965 140168371447808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:10:47.190076 140168371447808 dqn_agent.py:280] 	 optimizer: adam
I0909 14:10:47.190172 140168371447808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:10:47.190265 140168371447808 dqn_agent.py:283] 	 seed: 1631196647188838
I0909 14:10:47.192817 140168371447808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:10:47.192987 140168371447808 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:10:47.193114 140168371447808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:10:47.193223 140168371447808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:10:47.193331 140168371447808 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:10:47.193425 140168371447808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:10:47.193784 140168371447808 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:10:47.193947 140168371447808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:10:47.194090 140168371447808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:10:47.260664 140168371447808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:47.286140 140168371447808 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 14:10:47.286397 140168371447808 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 170.84
I0909 14:10:53.140172 140168371447808 replay_runner.py:36] Average training steps per second: 170.84
I0909 14:10:54.271542 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 1
I0909 14:10:54.354711 140168371447808 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 253.06
I0909 14:10:58.306667 140168371447808 replay_runner.py:36] Average training steps per second: 253.06
I0909 14:10:58.547633 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 14:10:58.630378 140168371447808 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 241.67
I0909 14:11:02.768767 140168371447808 replay_runner.py:36] Average training steps per second: 241.67
I0909 14:11:03.047344 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 14:11:03.143101 140168371447808 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 253.61
I0909 14:11:07.086471 140168371447808 replay_runner.py:36] Average training steps per second: 253.61
I0909 14:11:07.346338 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 14:11:07.436243 140168371447808 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 255.60
I0909 14:11:11.349127 140168371447808 replay_runner.py:36] Average training steps per second: 255.60
I0909 14:11:11.615272 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 14:11:11.710556 140168371447808 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 253.86
I0909 14:11:15.650200 140168371447808 replay_runner.py:36] Average training steps per second: 253.86
I0909 14:11:15.914148 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 14:11:16.005445 140168371447808 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 256.51
I0909 14:11:19.904294 140168371447808 replay_runner.py:36] Average training steps per second: 256.51
I0909 14:11:20.164845 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 14:11:20.252689 140168371447808 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 252.78
I0909 14:11:24.208976 140168371447808 replay_runner.py:36] Average training steps per second: 252.78
I0909 14:11:24.480739 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 14:11:24.585891 140168371447808 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 252.95
I0909 14:11:28.539731 140168371447808 replay_runner.py:36] Average training steps per second: 252.95
I0909 14:11:28.812096 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 219 Episode length: 219 Return: -219.0
INFO:tensorflow:Average training steps per second: 251.12
I0909 14:11:32.888637 140168371447808 replay_runner.py:36] Average training steps per second: 251.12
I0909 14:11:32.990543 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.00
INFO:tensorflow:Starting iteration 10

Steps executed: 418 Episode length: 238 Return: -238.0
INFO:tensorflow:Average training steps per second: 252.88
I0909 14:11:37.035456 140168371447808 replay_runner.py:36] Average training steps per second: 252.88
I0909 14:11:37.218543 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.33
INFO:tensorflow:Starting iteration 11

Steps executed: 355 Episode length: 173 Return: -173.0
INFO:tensorflow:Average training steps per second: 252.72
I0909 14:11:41.267595 140168371447808 replay_runner.py:36] Average training steps per second: 252.72
I0909 14:11:41.426614 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.50
INFO:tensorflow:Starting iteration 12

Steps executed: 290 Episode length: 143 Return: -143.0
INFO:tensorflow:Average training steps per second: 251.96
I0909 14:11:45.487805 140168371447808 replay_runner.py:36] Average training steps per second: 251.96
I0909 14:11:45.620167 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 13

Steps executed: 324 Episode length: 169 Return: -169.0
INFO:tensorflow:Average training steps per second: 250.80
I0909 14:11:49.698334 140168371447808 replay_runner.py:36] Average training steps per second: 250.80
I0909 14:11:49.852488 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.00
INFO:tensorflow:Starting iteration 14

Steps executed: 795 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 251.14
I0909 14:11:53.932711 140168371447808 replay_runner.py:36] Average training steps per second: 251.14
I0909 14:11:54.284920 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.00
INFO:tensorflow:Starting iteration 15
I0909 14:11:54.379064 140168371447808 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 232.31

Steps executed: 247 Episode length: 122 Return: -122.0
I0909 14:11:58.800365 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 16

Steps executed: 217 Episode length: 123 Return: -123.0
INFO:tensorflow:Average training steps per second: 253.57
I0909 14:12:02.835587 140168371447808 replay_runner.py:36] Average training steps per second: 253.57
I0909 14:12:02.931598 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 17

Steps executed: 213 Episode length: 127 Return: -127.0
INFO:tensorflow:Average training steps per second: 254.53
I0909 14:12:06.952589 140168371447808 replay_runner.py:36] Average training steps per second: 254.53
I0909 14:12:07.051727 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 18

Steps executed: 222 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 239.67
I0909 14:12:11.331782 140168371447808 replay_runner.py:36] Average training steps per second: 239.67
I0909 14:12:11.434414 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 19

Steps executed: 222 Episode length: 86 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 253.69
I0909 14:12:15.473597 140168371447808 replay_runner.py:36] Average training steps per second: 253.69
I0909 14:12:15.575276 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 20

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 252.22
I0909 14:12:19.635773 140168371447808 replay_runner.py:36] Average training steps per second: 252.22
I0909 14:12:19.911743 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21

Steps executed: 231 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 250.36
I0909 14:12:24.010782 140168371447808 replay_runner.py:36] Average training steps per second: 250.36
I0909 14:12:24.122654 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 22

Steps executed: 228 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 249.87
I0909 14:12:28.218180 140168371447808 replay_runner.py:36] Average training steps per second: 249.87
I0909 14:12:28.320579 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 23

Steps executed: 217 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 250.33
I0909 14:12:32.406448 140168371447808 replay_runner.py:36] Average training steps per second: 250.33
I0909 14:12:32.508000 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 24
I0909 14:12:32.600558 140168371447808 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 253.35
I0909 14:12:36.548122 140168371447808 replay_runner.py:36] Average training steps per second: 253.35

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 25
I0909 14:12:36.916263 140168371447808 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 252.47

Steps executed: 282 Episode length: 113 Return: -113.0
I0909 14:12:41.007813 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 26

Steps executed: 213 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 251.23
I0909 14:12:45.083789 140168371447808 replay_runner.py:36] Average training steps per second: 251.23
I0909 14:12:45.187512 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 27

Steps executed: 237 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 252.43
I0909 14:12:49.237740 140168371447808 replay_runner.py:36] Average training steps per second: 252.43
I0909 14:12:49.337716 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 28

Steps executed: 219 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 273.27
I0909 14:12:53.082638 140168371447808 replay_runner.py:36] Average training steps per second: 273.27
I0909 14:12:53.167018 140168371447808 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 29

Steps executed: 194 Episode length: 194 Return: -194.0
INFO:tensorflow:Average training steps per second: 273.71
I0909 14:12:56.911182 140168371447808 replay_runner.py:36] Average training steps per second: 273.71

Done fixed training!Episode length: 115 Return: -115.0