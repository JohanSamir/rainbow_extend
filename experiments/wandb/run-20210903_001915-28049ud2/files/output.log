I0903 00:19:20.616445 140369919707136 run_experiment.py:549] Creating TrainRunner ...
I0903 00:19:20.625652 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:20.625816 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:20.625912 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:20.625992 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:20.626066 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:20.626157 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:20.626262 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:20.626348 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:20.626419 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:20.626498 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:20.626581 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:20.626647 140369919707136 dqn_agent.py:283] 	 seed: 1630628360625608
I0903 00:19:20.628272 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:20.628410 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:20.628486 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:20.628553 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:20.628635 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:20.628693 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:20.628785 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:20.628862 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:20.628939 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:20.653152 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:20.911549 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:20.921401 140369919707136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:19:20.927464 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:20.927599 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:20.927672 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:20.927733 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:20.927789 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:20.927864 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:20.927939 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:20.928031 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:20.928121 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:20.928191 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:20.928267 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:20.928335 140369919707136 dqn_agent.py:283] 	 seed: 1630628360927432
I0903 00:19:20.929704 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:20.929902 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:20.929989 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:20.930102 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:20.930210 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:20.930280 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:20.930365 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:20.930420 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:20.930533 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:20.948121 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:20.964252 140369919707136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:19:20.964439 140369919707136 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 228.76
I0903 00:19:25.335957 140369919707136 replay_runner.py:36] Average training steps per second: 228.76
I0903 00:19:26.025051 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.48
Steps executed: 238 Episode length: 120 Return: -703.3986047782009
INFO:tensorflow:Starting iteration 1
I0903 00:19:29.423567 140369919707136 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 331.50
I0903 00:19:32.440454 140369919707136 replay_runner.py:36] Average training steps per second: 331.50

Steps executed: 257 Episode length: 98 Return: -763.64657667029189
INFO:tensorflow:Starting iteration 2
I0903 00:19:36.001862 140369919707136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 342.45
I0903 00:19:38.922302 140369919707136 replay_runner.py:36] Average training steps per second: 342.45

Steps executed: 246 Episode length: 192 Return: -213.48720710806373
INFO:tensorflow:Starting iteration 3
I0903 00:19:42.489783 140369919707136 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 339.18
I0903 00:19:45.438451 140369919707136 replay_runner.py:36] Average training steps per second: 339.18

Steps executed: 231 Episode length: 67 Return: -461.308560889975244
INFO:tensorflow:Starting iteration 4

Steps executed: 366 Episode length: 196 Return: -427.41915942071165
INFO:tensorflow:Average training steps per second: 325.06
I0903 00:19:52.050123 140369919707136 replay_runner.py:36] Average training steps per second: 325.06
I0903 00:19:52.299747 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -575.12
INFO:tensorflow:Starting iteration 5

Steps executed: 239 Episode length: 76 Return: -310.625735226046066
INFO:tensorflow:Average training steps per second: 329.90
I0903 00:19:58.781670 140369919707136 replay_runner.py:36] Average training steps per second: 329.90
I0903 00:19:58.909102 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.44
INFO:tensorflow:Starting iteration 6

Steps executed: 269 Episode length: 101 Return: -307.02673075512394
INFO:tensorflow:Average training steps per second: 329.26
I0903 00:20:05.275451 140369919707136 replay_runner.py:36] Average training steps per second: 329.26
I0903 00:20:05.418525 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.74
INFO:tensorflow:Starting iteration 7

Steps executed: 206 Episode length: 60 Return: -601.748747251350694
INFO:tensorflow:Average training steps per second: 337.63
I0903 00:20:11.786345 140369919707136 replay_runner.py:36] Average training steps per second: 337.63
I0903 00:20:11.902503 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -621.67
INFO:tensorflow:Starting iteration 8

Steps executed: 226 Episode length: 80 Return: -212.851518145635634
INFO:tensorflow:Average training steps per second: 343.38
I0903 00:20:18.249022 140369919707136 replay_runner.py:36] Average training steps per second: 343.38
I0903 00:20:18.385360 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.06
INFO:tensorflow:Starting iteration 9
I0903 00:20:21.838907 140369919707136 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 339.81

Steps executed: 216 Episode length: 103 Return: -498.10997359570524
I0903 00:20:24.920907 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.24
INFO:tensorflow:Starting iteration 10

Steps executed: 270 Episode length: 123 Return: -87.567064994169784
INFO:tensorflow:Average training steps per second: 337.40
I0903 00:20:31.336611 140369919707136 replay_runner.py:36] Average training steps per second: 337.40
I0903 00:20:31.500549 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.44
INFO:tensorflow:Starting iteration 11

Steps executed: 260 Episode length: 110 Return: -296.20999661091525
INFO:tensorflow:Average training steps per second: 331.46
I0903 00:20:37.996909 140369919707136 replay_runner.py:36] Average training steps per second: 331.46
I0903 00:20:38.140942 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.79
INFO:tensorflow:Starting iteration 12

Steps executed: 675 Episode length: 675 Return: -651.56902748365565
INFO:tensorflow:Average training steps per second: 338.58
I0903 00:20:44.531398 140369919707136 replay_runner.py:36] Average training steps per second: 338.58
I0903 00:20:45.390108 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -651.57
INFO:tensorflow:Starting iteration 13

Steps executed: 245 Episode length: 53 Return: -177.057309576018675
INFO:tensorflow:Average training steps per second: 335.93
I0903 00:20:51.797842 140369919707136 replay_runner.py:36] Average training steps per second: 335.93
I0903 00:20:51.974421 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.51
INFO:tensorflow:Starting iteration 14

Steps executed: 82 Episode length: 82 Return: -631.6872861845254675
INFO:tensorflow:Average training steps per second: 339.67

Steps executed: 262 Episode length: 103 Return: -772.16237813519075
I0903 00:20:58.536499 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -642.83
INFO:tensorflow:Starting iteration 15

Steps executed: 250 Episode length: 71 Return: -147.596967193195165
INFO:tensorflow:Average training steps per second: 331.09
I0903 00:21:05.048590 140369919707136 replay_runner.py:36] Average training steps per second: 331.09
I0903 00:21:05.169242 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.28
INFO:tensorflow:Starting iteration 16

Steps executed: 219 Episode length: 82 Return: -457.647639202253965
INFO:tensorflow:Average training steps per second: 343.97
I0903 00:21:11.518187 140369919707136 replay_runner.py:36] Average training steps per second: 343.97
I0903 00:21:11.657849 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.84
INFO:tensorflow:Starting iteration 17

Steps executed: 237 Episode length: 70 Return: -520.140344229207865
INFO:tensorflow:Average training steps per second: 339.52
I0903 00:21:18.146416 140369919707136 replay_runner.py:36] Average training steps per second: 339.52
I0903 00:21:18.307437 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.67
INFO:tensorflow:Starting iteration 18
I0903 00:21:21.762232 140369919707136 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 340.75

Steps executed: 229 Episode length: 52 Return: -134.010144139455635
I0903 00:21:24.818839 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.77
INFO:tensorflow:Starting iteration 19

Steps executed: 246 Episode length: 61 Return: -17.8560793595988945
INFO:tensorflow:Average training steps per second: 338.86
I0903 00:21:31.286255 140369919707136 replay_runner.py:36] Average training steps per second: 338.86
I0903 00:21:31.443888 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.46
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 73 Return: -369.117506941463555
INFO:tensorflow:Average training steps per second: 350.31
I0903 00:21:37.766671 140369919707136 replay_runner.py:36] Average training steps per second: 350.31
I0903 00:21:37.899535 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.37
INFO:tensorflow:Starting iteration 21

Steps executed: 227 Episode length: 85 Return: -843.624414447180755
INFO:tensorflow:Average training steps per second: 343.35
I0903 00:21:44.357149 140369919707136 replay_runner.py:36] Average training steps per second: 343.35
I0903 00:21:44.494184 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.78
INFO:tensorflow:Starting iteration 22
I0903 00:21:48.009826 140369919707136 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 352.25

Steps executed: 255 Episode length: 56 Return: -491.477949410608975
I0903 00:21:50.991839 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -555.42
INFO:tensorflow:Starting iteration 23

Steps executed: 212 Episode length: 80 Return: -754.394393655058175
INFO:tensorflow:Average training steps per second: 344.83
I0903 00:21:57.383816 140369919707136 replay_runner.py:36] Average training steps per second: 344.83
I0903 00:21:57.510479 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.79
INFO:tensorflow:Starting iteration 24

Steps executed: 261 Episode length: 77 Return: -619.081874250140675
INFO:tensorflow:Average training steps per second: 339.20
I0903 00:22:03.943312 140369919707136 replay_runner.py:36] Average training steps per second: 339.20
I0903 00:22:04.093568 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -585.12
INFO:tensorflow:Starting iteration 25

Steps executed: 212 Episode length: 86 Return: -419.287349690278475
INFO:tensorflow:Average training steps per second: 347.49
I0903 00:22:10.456258 140369919707136 replay_runner.py:36] Average training steps per second: 347.49
I0903 00:22:10.553942 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.74
INFO:tensorflow:Starting iteration 26

Steps executed: 69 Episode length: 69 Return: -521.8420006839948475
INFO:tensorflow:Average training steps per second: 352.93
I0903 00:22:16.847345 140369919707136 replay_runner.py:36] Average training steps per second: 352.93

Steps executed: 219 Episode length: 84 Return: -926.426241769573875
INFO:tensorflow:Starting iteration 27

Steps executed: 239 Episode length: 70 Return: -502.129282378505935
INFO:tensorflow:Average training steps per second: 332.47
I0903 00:22:23.410861 140369919707136 replay_runner.py:36] Average training steps per second: 332.47
I0903 00:22:23.538567 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -564.54
INFO:tensorflow:Starting iteration 28

Steps executed: 267 Episode length: 70 Return: -147.863329510029025
INFO:tensorflow:Average training steps per second: 351.84
I0903 00:22:29.769799 140369919707136 replay_runner.py:36] Average training steps per second: 351.84
I0903 00:22:29.936331 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.23
INFO:tensorflow:Starting iteration 29

Steps executed: 240 Episode length: 59 Return: -163.260270192105225
INFO:tensorflow:Average training steps per second: 368.86
I0903 00:22:35.984918 140369919707136 replay_runner.py:36] Average training steps per second: 368.86

Done fixed training!Episode length: 59 Return: -163.260270192105225