Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0902 18:05:11.662648 140423215187968 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:11.670491 140423215187968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:11.670688 140423215187968 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:11.670848 140423215187968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:11.671025 140423215187968 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:11.671145 140423215187968 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:11.671264 140423215187968 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:11.671398 140423215187968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:11.671475 140423215187968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:11.671561 140423215187968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:11.671665 140423215187968 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:11.671798 140423215187968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:11.671900 140423215187968 dqn_agent.py:283] 	 seed: 1630605911670431
I0902 18:05:11.674988 140423215187968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:11.675152 140423215187968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:11.675252 140423215187968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:11.675338 140423215187968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:11.675412 140423215187968 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:11.675648 140423215187968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:11.675785 140423215187968 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:11.675885 140423215187968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:11.676018 140423215187968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:11.713075 140423215187968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:12.179217 140423215187968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:12.193756 140423215187968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:12.203889 140423215187968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:12.204139 140423215187968 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:12.204347 140423215187968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:12.204471 140423215187968 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:12.204685 140423215187968 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:12.204822 140423215187968 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:12.204920 140423215187968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:12.205023 140423215187968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:12.205352 140423215187968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:12.205516 140423215187968 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:12.205641 140423215187968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:12.205769 140423215187968 dqn_agent.py:283] 	 seed: 1630605912203830
I0902 18:05:12.208441 140423215187968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:12.208630 140423215187968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:12.208749 140423215187968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:12.208871 140423215187968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:12.209085 140423215187968 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:12.209197 140423215187968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:12.209297 140423215187968 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:12.209391 140423215187968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:12.209486 140423215187968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:12.245575 140423215187968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:12.268761 140423215187968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:12.269088 140423215187968 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.87
I0902 18:05:18.986614 140423215187968 replay_runner.py:36] Average training steps per second: 148.87
Steps executed: 203 Episode length: 9 Return: 9.0.0
I0902 18:05:20.228271 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1
I0902 18:05:20.415032 140423215187968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 204.22

Steps executed: 14 Episode length: 14 Return: 14.00
I0902 18:05:25.447749 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.00
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 196.66
I0902 18:05:30.722668 140423215187968 replay_runner.py:36] Average training steps per second: 196.66
I0902 18:05:30.921732 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 3

Steps executed: 307 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 198.50
I0902 18:05:36.143892 140423215187968 replay_runner.py:36] Average training steps per second: 198.50
I0902 18:05:36.288089 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.36
I0902 18:05:41.394867 140423215187968 replay_runner.py:36] Average training steps per second: 203.36
I0902 18:05:41.656539 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.50
INFO:tensorflow:Starting iteration 5

Steps executed: 397 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.48
I0902 18:05:46.906295 140423215187968 replay_runner.py:36] Average training steps per second: 197.48
I0902 18:05:47.097307 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 6


Steps executed: 256 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 204.45
I0902 18:05:52.184238 140423215187968 replay_runner.py:36] Average training steps per second: 204.45
I0902 18:05:52.343199 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 7

Steps executed: 133 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 201.25

Steps executed: 278 Episode length: 145 Return: 145.0
I0902 18:05:57.727873 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 8

Steps executed: 300 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 206.34
I0902 18:06:02.750843 140423215187968 replay_runner.py:36] Average training steps per second: 206.34
I0902 18:06:02.953721 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 9

Steps executed: 331 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 204.64
I0902 18:06:08.034826 140423215187968 replay_runner.py:36] Average training steps per second: 204.64
I0902 18:06:08.237458 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 10

Steps executed: 304 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 197.87
I0902 18:06:13.479999 140423215187968 replay_runner.py:36] Average training steps per second: 197.87
I0902 18:06:13.678929 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 11

Steps executed: 379 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 208.63
I0902 18:06:18.669708 140423215187968 replay_runner.py:36] Average training steps per second: 208.63
I0902 18:06:18.905362 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 12

Steps executed: 292 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 190.46
I0902 18:06:24.345524 140423215187968 replay_runner.py:36] Average training steps per second: 190.46
I0902 18:06:24.535983 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 13
I0902 18:06:24.719465 140423215187968 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 201.67
I0902 18:06:29.678371 140423215187968 replay_runner.py:36] Average training steps per second: 201.67

Steps executed: 353 Episode length: 174 Return: 174.0
INFO:tensorflow:Starting iteration 14

Steps executed: 389 Episode length: 194 Return: 194.0
INFO:tensorflow:Average training steps per second: 198.29
I0902 18:06:35.154655 140423215187968 replay_runner.py:36] Average training steps per second: 198.29
I0902 18:06:35.405515 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.62
I0902 18:06:40.707947 140423215187968 replay_runner.py:36] Average training steps per second: 195.62
I0902 18:06:40.845323 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 18:06:41.042303 140423215187968 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 198.03
I0902 18:06:46.092394 140423215187968 replay_runner.py:36] Average training steps per second: 198.03
I0902 18:06:46.229631 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 18:06:46.426456 140423215187968 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.91

Steps executed: 345 Episode length: 167 Return: 167.0
I0902 18:06:51.771293 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.96
I0902 18:06:57.040042 140423215187968 replay_runner.py:36] Average training steps per second: 196.96
I0902 18:06:57.187904 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 18:06:57.369877 140423215187968 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.78
I0902 18:07:02.477957 140423215187968 replay_runner.py:36] Average training steps per second: 195.78
I0902 18:07:02.606468 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 18:07:02.800411 140423215187968 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 198.04
I0902 18:07:07.850446 140423215187968 replay_runner.py:36] Average training steps per second: 198.04
I0902 18:07:07.991064 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 18:07:08.188846 140423215187968 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.73
I0902 18:07:13.196058 140423215187968 replay_runner.py:36] Average training steps per second: 199.73
I0902 18:07:13.317259 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 351 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 190.64
I0902 18:07:18.753771 140423215187968 replay_runner.py:36] Average training steps per second: 190.64
I0902 18:07:18.991568 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.96
I0902 18:07:24.305039 140423215187968 replay_runner.py:36] Average training steps per second: 194.96
I0902 18:07:24.443672 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 353 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 195.62
I0902 18:07:29.741919 140423215187968 replay_runner.py:36] Average training steps per second: 195.62
I0902 18:07:29.966875 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.96
I0902 18:07:35.211060 140423215187968 replay_runner.py:36] Average training steps per second: 197.96
I0902 18:07:35.342265 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 18:07:35.537577 140423215187968 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 200.98
I0902 18:07:40.513545 140423215187968 replay_runner.py:36] Average training steps per second: 200.98
I0902 18:07:40.633033 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 18:07:40.817713 140423215187968 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.54
I0902 18:07:46.011877 140423215187968 replay_runner.py:36] Average training steps per second: 192.54
I0902 18:07:46.133598 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 18:07:46.312829 140423215187968 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 199.58
I0902 18:07:51.323646 140423215187968 replay_runner.py:36] Average training steps per second: 199.58
I0902 18:07:51.449335 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.88
I0902 18:07:56.797008 140423215187968 replay_runner.py:36] Average training steps per second: 193.88
I0902 18:07:56.919459 140423215187968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00