I0902 11:24:06.735932 140165223507968 run_experiment.py:549] Creating TrainRunner ...
I0902 11:24:06.763110 140165223507968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:06.764827 140165223507968 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:06.765001 140165223507968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:06.765107 140165223507968 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:06.765856 140165223507968 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:06.766018 140165223507968 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:06.766161 140165223507968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:06.766950 140165223507968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:06.767092 140165223507968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:06.767938 140165223507968 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:06.768080 140165223507968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:06.768191 140165223507968 dqn_agent.py:283] 	 seed: 1630581846763042
I0902 11:24:06.772033 140165223507968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:06.772193 140165223507968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:06.772341 140165223507968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:06.772720 140165223507968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:06.772872 140165223507968 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:06.773008 140165223507968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:06.773119 140165223507968 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:06.773236 140165223507968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:06.773397 140165223507968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:06.908131 140165223507968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.484230 140165223507968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.497014 140165223507968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:24:07.504911 140165223507968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:24:07.505150 140165223507968 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:24:07.505266 140165223507968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:24:07.505399 140165223507968 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:24:07.505514 140165223507968 dqn_agent.py:275] 	 update_period: 4
I0902 11:24:07.505607 140165223507968 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:24:07.505694 140165223507968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:24:07.505791 140165223507968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:24:07.505908 140165223507968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:24:07.506096 140165223507968 dqn_agent.py:280] 	 optimizer: adam
I0902 11:24:07.506222 140165223507968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:24:07.506348 140165223507968 dqn_agent.py:283] 	 seed: 1630581847504855
I0902 11:24:07.508711 140165223507968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:24:07.508901 140165223507968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:24:07.509041 140165223507968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:24:07.509144 140165223507968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:24:07.509231 140165223507968 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:24:07.509316 140165223507968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:24:07.509444 140165223507968 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:24:07.509548 140165223507968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:24:07.509650 140165223507968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:24:07.551218 140165223507968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:24:07.582036 140165223507968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:24:07.582357 140165223507968 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 134.86
I0902 11:24:14.997815 140165223507968 replay_runner.py:36] Average training steps per second: 134.86
I0902 11:24:16.139153 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1
I0902 11:24:16.343937 140165223507968 replay_runner.py:41] Starting iteration 1
Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.20
I0902 11:24:21.520567 140165223507968 replay_runner.py:36] Average training steps per second: 193.20
I0902 11:24:21.664147 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.18
INFO:tensorflow:Starting iteration 2


Steps executed: 307 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 199.74
I0902 11:24:26.849946 140165223507968 replay_runner.py:36] Average training steps per second: 199.74
I0902 11:24:27.057672 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 3
I0902 11:24:27.255802 140165223507968 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.09
I0902 11:24:32.463009 140165223507968 replay_runner.py:36] Average training steps per second: 192.09
I0902 11:24:32.724354 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 4


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.95
I0902 11:24:38.204998 140165223507968 replay_runner.py:36] Average training steps per second: 188.95
I0902 11:24:38.344477 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 317 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 192.19
I0902 11:24:43.721624 140165223507968 replay_runner.py:36] Average training steps per second: 192.19
I0902 11:24:43.940431 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 6

Steps executed: 282 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 190.93
I0902 11:24:49.376407 140165223507968 replay_runner.py:36] Average training steps per second: 190.93
I0902 11:24:49.568497 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 7

Steps executed: 325 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 188.49
I0902 11:24:55.069791 140165223507968 replay_runner.py:36] Average training steps per second: 188.49
I0902 11:24:55.301951 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 8
I0902 11:24:55.494971 140165223507968 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 193.32

Steps executed: 367 Episode length: 188 Return: 188.0
I0902 11:25:00.922637 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 9

Steps executed: 322 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 192.35
I0902 11:25:06.318069 140165223507968 replay_runner.py:36] Average training steps per second: 192.35
I0902 11:25:06.532376 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 10

Steps executed: 304 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 193.50
I0902 11:25:11.886862 140165223507968 replay_runner.py:36] Average training steps per second: 193.50
I0902 11:25:12.088789 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 11

Steps executed: 303 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 191.33
I0902 11:25:17.505784 140165223507968 replay_runner.py:36] Average training steps per second: 191.33
I0902 11:25:17.704413 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 12

Steps executed: 384 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 188.47
I0902 11:25:23.199463 140165223507968 replay_runner.py:36] Average training steps per second: 188.47
I0902 11:25:23.453504 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 13
I0902 11:25:23.649509 140165223507968 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 192.86

Steps executed: 306 Episode length: 146 Return: 146.0
I0902 11:25:29.036587 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 14

Steps executed: 394 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.98
I0902 11:25:34.574826 140165223507968 replay_runner.py:36] Average training steps per second: 186.98
I0902 11:25:34.833127 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.32
I0902 11:25:40.147831 140165223507968 replay_runner.py:36] Average training steps per second: 195.32
I0902 11:25:40.282805 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 11:25:40.471764 140165223507968 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 193.36
I0902 11:25:45.643813 140165223507968 replay_runner.py:36] Average training steps per second: 193.36
I0902 11:25:45.782798 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 11:25:45.959270 140165223507968 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 194.35
I0902 11:25:51.105419 140165223507968 replay_runner.py:36] Average training steps per second: 194.35
I0902 11:25:51.262545 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 11:25:51.516266 140165223507968 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 190.08
I0902 11:25:56.777762 140165223507968 replay_runner.py:36] Average training steps per second: 190.08
I0902 11:25:56.918394 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 11:25:57.114296 140165223507968 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 192.65
I0902 11:26:02.305591 140165223507968 replay_runner.py:36] Average training steps per second: 192.65
I0902 11:26:02.443576 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 11:26:02.622613 140165223507968 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.93
I0902 11:26:07.806395 140165223507968 replay_runner.py:36] Average training steps per second: 192.93
I0902 11:26:07.949457 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 11:26:08.143409 140165223507968 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 195.43
I0902 11:26:13.260645 140165223507968 replay_runner.py:36] Average training steps per second: 195.43
I0902 11:26:13.399949 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 11:26:13.591695 140165223507968 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.50
I0902 11:26:18.759986 140165223507968 replay_runner.py:36] Average training steps per second: 193.50
I0902 11:26:18.904853 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.18
I0902 11:26:24.168888 140165223507968 replay_runner.py:36] Average training steps per second: 197.18
I0902 11:26:24.423352 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.34
I0902 11:26:29.834699 140165223507968 replay_runner.py:36] Average training steps per second: 191.34
I0902 11:26:30.019145 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 11:26:30.205177 140165223507968 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.38
I0902 11:26:35.323876 140165223507968 replay_runner.py:36] Average training steps per second: 195.38
I0902 11:26:35.462733 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 11:26:35.652639 140165223507968 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 193.07
I0902 11:26:40.832551 140165223507968 replay_runner.py:36] Average training steps per second: 193.07
I0902 11:26:40.982619 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 11:26:41.174558 140165223507968 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 191.35
I0902 11:26:46.401268 140165223507968 replay_runner.py:36] Average training steps per second: 191.35
I0902 11:26:46.534333 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 11:26:46.723497 140165223507968 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 190.42
I0902 11:26:51.975518 140165223507968 replay_runner.py:36] Average training steps per second: 190.42
I0902 11:26:52.117017 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.14
I0902 11:26:57.336351 140165223507968 replay_runner.py:36] Average training steps per second: 199.14
I0902 11:26:57.457426 140165223507968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00