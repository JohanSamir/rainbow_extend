Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:49:14.336697 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:49:14.347069 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:49:14.347404 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:49:14.347628 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:49:14.347810 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:49:14.347944 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:49:14.348052 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:49:14.348352 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:49:14.348505 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:49:14.348628 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:49:14.348743 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:49:14.348906 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:49:14.349001 140170650351616 dqn_agent.py:283] 	 seed: 1630626554346987
I0902 23:49:14.351584 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:49:14.351725 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:49:14.351881 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:49:14.351997 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:49:14.352110 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:49:14.352199 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:49:14.352288 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:49:14.352392 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:49:14.352482 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:49:14.393602 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:49:14.958899 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:49:14.974969 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:49:14.984392 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:49:14.984599 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:49:14.984685 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:49:14.984753 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:49:14.984819 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:49:14.984909 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:49:14.985058 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:49:14.985142 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:49:14.985273 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:49:14.985357 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:49:14.985416 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:49:14.985626 140170650351616 dqn_agent.py:283] 	 seed: 1630626554984314
I0902 23:49:14.988292 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:49:14.988484 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:49:14.988652 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:49:14.988999 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:49:14.989140 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:49:14.989344 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:49:14.989452 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:49:14.989573 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:49:14.989758 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:49:15.025845 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:49:15.050749 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:49:15.051047 140170650351616 replay_runner.py:41] Starting iteration 0
Steps executed: 322 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 143.90
I0902 23:49:22.000662 140170650351616 replay_runner.py:36] Average training steps per second: 143.90
I0902 23:49:23.252446 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.33
INFO:tensorflow:Starting iteration 1

Steps executed: 242 Episode length: 94 Return: 94.0.0
INFO:tensorflow:Average training steps per second: 190.65
I0902 23:49:28.671279 140170650351616 replay_runner.py:36] Average training steps per second: 190.65
I0902 23:49:28.826903 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 80.67
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.33
I0902 23:49:34.327904 140170650351616 replay_runner.py:36] Average training steps per second: 188.33
I0902 23:49:34.470666 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:49:34.654525 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 193.64
I0902 23:49:39.819217 140170650351616 replay_runner.py:36] Average training steps per second: 193.64
I0902 23:49:39.945648 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 285 Episode length: 95 Return: 95.0.0
INFO:tensorflow:Average training steps per second: 195.37
I0902 23:49:45.232846 140170650351616 replay_runner.py:36] Average training steps per second: 195.37
I0902 23:49:45.448703 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.14
I0902 23:49:50.688332 140170650351616 replay_runner.py:36] Average training steps per second: 198.14
I0902 23:49:50.820855 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:49:50.998157 140170650351616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 192.39
I0902 23:49:56.196269 140170650351616 replay_runner.py:36] Average training steps per second: 192.39
I0902 23:49:56.332566 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 23:49:56.520983 140170650351616 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 195.39
I0902 23:50:01.639595 140170650351616 replay_runner.py:36] Average training steps per second: 195.39
I0902 23:50:01.775001 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 296 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 195.62
I0902 23:50:07.079003 140170650351616 replay_runner.py:36] Average training steps per second: 195.62
I0902 23:50:07.260561 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 9

Steps executed: 226 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 197.97
I0902 23:50:12.493120 140170650351616 replay_runner.py:36] Average training steps per second: 197.97
I0902 23:50:12.653798 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.00
INFO:tensorflow:Starting iteration 10

Steps executed: 286 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 195.54
I0902 23:50:17.955872 140170650351616 replay_runner.py:36] Average training steps per second: 195.54
I0902 23:50:18.138825 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 11

Steps executed: 259 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 188.32
I0902 23:50:23.632726 140170650351616 replay_runner.py:36] Average training steps per second: 188.32
I0902 23:50:23.827410 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 12

Steps executed: 278 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 195.32
I0902 23:50:29.144460 140170650351616 replay_runner.py:36] Average training steps per second: 195.32
I0902 23:50:29.347841 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 13

Steps executed: 259 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 192.12
I0902 23:50:34.742390 140170650351616 replay_runner.py:36] Average training steps per second: 192.12
I0902 23:50:34.906239 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 14

Steps executed: 299 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 191.65
I0902 23:50:40.303455 140170650351616 replay_runner.py:36] Average training steps per second: 191.65
I0902 23:50:40.521646 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 15

Steps executed: 355 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.14
I0902 23:50:45.633280 140170650351616 replay_runner.py:36] Average training steps per second: 203.14
I0902 23:50:45.874582 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.46
I0902 23:50:51.365311 140170650351616 replay_runner.py:36] Average training steps per second: 188.46
I0902 23:50:51.501541 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 226 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 201.78
I0902 23:50:56.653679 140170650351616 replay_runner.py:36] Average training steps per second: 201.78
I0902 23:50:56.802361 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.07
I0902 23:51:02.058629 140170650351616 replay_runner.py:36] Average training steps per second: 197.07
I0902 23:51:02.196925 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:51:02.373921 140170650351616 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.66
I0902 23:51:07.538204 140170650351616 replay_runner.py:36] Average training steps per second: 193.66
I0902 23:51:07.676755 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.89
I0902 23:51:13.056023 140170650351616 replay_runner.py:36] Average training steps per second: 192.89
I0902 23:51:13.321304 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.40
I0902 23:51:18.880823 140170650351616 replay_runner.py:36] Average training steps per second: 186.40
I0902 23:51:19.014292 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:51:19.212821 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.00
I0902 23:51:24.315365 140170650351616 replay_runner.py:36] Average training steps per second: 196.00
I0902 23:51:24.456599 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:51:24.650096 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 194.62
I0902 23:51:29.788733 140170650351616 replay_runner.py:36] Average training steps per second: 194.62
I0902 23:51:29.922254 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:51:30.109278 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 195.90
I0902 23:51:35.214440 140170650351616 replay_runner.py:36] Average training steps per second: 195.90
I0902 23:51:35.350567 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:51:35.541957 140170650351616 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.55
I0902 23:51:40.682466 140170650351616 replay_runner.py:36] Average training steps per second: 194.55
I0902 23:51:40.816652 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:51:41.003179 140170650351616 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.61
I0902 23:51:46.142278 140170650351616 replay_runner.py:36] Average training steps per second: 194.61
I0902 23:51:46.277338 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:51:46.454461 140170650351616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.22
I0902 23:51:51.657115 140170650351616 replay_runner.py:36] Average training steps per second: 192.22
I0902 23:51:51.789298 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:51:51.974931 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.79
I0902 23:51:57.109275 140170650351616 replay_runner.py:36] Average training steps per second: 194.79
I0902 23:51:57.239726 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:51:57.419962 140170650351616 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 197.50

Done fixed training!Episode length: 200 Return: 200.0
I0902 23:52:02.620112 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00