Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0901 12:28:48.265397 140586480396288 run_experiment.py:549] Creating TrainRunner ...
I0901 12:28:48.275421 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:48.275757 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:48.275933 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:48.276128 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:48.276282 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:48.276377 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:48.276443 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:48.276514 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:48.276577 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:48.276640 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:48.276716 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:48.276779 140586480396288 dqn_agent.py:283] 	 seed: 1630499328275341
I0901 12:28:48.279984 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:48.280164 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:48.280367 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:48.280482 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:48.280565 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:48.280639 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:48.280770 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:48.280910 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:48.281011 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:48.357010 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:48.817407 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:48.832137 140586480396288 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:28:48.840952 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:48.841196 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:48.841339 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:48.841485 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:48.841602 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:48.841720 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:48.841830 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:48.841936 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:48.842044 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:48.842192 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:48.842289 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:48.842377 140586480396288 dqn_agent.py:283] 	 seed: 1630499328840889
I0901 12:28:48.844795 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:48.844986 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:48.845100 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:48.845197 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:48.845308 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:48.845408 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:48.845666 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:48.845789 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:48.845897 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:48.883260 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:48.907860 140586480396288 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:28:48.908144 140586480396288 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 137.02
I0901 12:28:56.206901 140586480396288 replay_runner.py:36] Average training steps per second: 137.02
I0901 12:28:57.716699 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:28:57.951536 140586480396288 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 189.73
I0901 12:29:03.222440 140586480396288 replay_runner.py:36] Average training steps per second: 189.73
I0901 12:29:03.650793 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:29:03.896332 140586480396288 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.45
I0901 12:29:09.066279 140586480396288 replay_runner.py:36] Average training steps per second: 193.45
I0901 12:29:09.490616 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:29:09.732839 140586480396288 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 190.07
I0901 12:29:14.994591 140586480396288 replay_runner.py:36] Average training steps per second: 190.07
I0901 12:29:15.415518 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:29:15.655510 140586480396288 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 188.11
I0901 12:29:20.972115 140586480396288 replay_runner.py:36] Average training steps per second: 188.11
I0901 12:29:21.426471 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:29:21.672476 140586480396288 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 190.67
I0901 12:29:26.917445 140586480396288 replay_runner.py:36] Average training steps per second: 190.67
I0901 12:29:27.332401 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 251 Episode length: 251 Return: -250.0
INFO:tensorflow:Average training steps per second: 188.31
I0901 12:29:32.892888 140586480396288 replay_runner.py:36] Average training steps per second: 188.31
I0901 12:29:33.106983 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.00
INFO:tensorflow:Starting iteration 7

Steps executed: 204 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 195.11
I0901 12:29:38.478526 140586480396288 replay_runner.py:36] Average training steps per second: 195.11
I0901 12:29:38.656807 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 8

Steps executed: 122 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 195.01

Steps executed: 302 Episode length: 180 Return: -179.0
I0901 12:29:44.299858 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.00
INFO:tensorflow:Starting iteration 9

Steps executed: 285 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 191.50
I0901 12:29:49.757883 140586480396288 replay_runner.py:36] Average training steps per second: 191.50
I0901 12:29:50.000899 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.61
I0901 12:29:55.346923 140586480396288 replay_runner.py:36] Average training steps per second: 195.61
I0901 12:29:55.771841 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 239 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 194.83
I0901 12:30:01.148709 140586480396288 replay_runner.py:36] Average training steps per second: 194.83
I0901 12:30:01.340592 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 12

Steps executed: 261 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 188.58
I0901 12:30:06.888166 140586480396288 replay_runner.py:36] Average training steps per second: 188.58
I0901 12:30:07.114514 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 13
I0901 12:30:07.356558 140586480396288 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 197.08

Steps executed: 201 Episode length: 118 Return: -117.0
I0901 12:30:12.614016 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 14

Steps executed: 218 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 197.18
I0901 12:30:17.933431 140586480396288 replay_runner.py:36] Average training steps per second: 197.18
I0901 12:30:18.142318 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.67
INFO:tensorflow:Starting iteration 15

Steps executed: 214 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 191.36
I0901 12:30:23.615194 140586480396288 replay_runner.py:36] Average training steps per second: 191.36
I0901 12:30:23.804347 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 16

Steps executed: 234 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 196.63
I0901 12:30:29.142752 140586480396288 replay_runner.py:36] Average training steps per second: 196.63
I0901 12:30:29.337258 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 17

Steps executed: 293 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 189.89
I0901 12:30:34.838974 140586480396288 replay_runner.py:36] Average training steps per second: 189.89
I0901 12:30:35.087747 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 18
I0901 12:30:35.339955 140586480396288 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.17

Steps executed: 392 Episode length: 198 Return: -197.0
I0901 12:30:40.816346 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.67
INFO:tensorflow:Starting iteration 19
I0901 12:30:41.072828 140586480396288 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.67

Steps executed: 233 Episode length: 65 Return: -64.0.0
I0901 12:30:46.509961 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 20

Steps executed: 240 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 198.38
I0901 12:30:51.776389 140586480396288 replay_runner.py:36] Average training steps per second: 198.38
I0901 12:30:51.994690 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 21

Steps executed: 244 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 201.04
I0901 12:30:57.210468 140586480396288 replay_runner.py:36] Average training steps per second: 201.04
I0901 12:30:57.406371 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 22

Steps executed: 608 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.59
I0901 12:31:02.710803 140586480396288 replay_runner.py:36] Average training steps per second: 197.59
I0901 12:31:03.214642 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.50
INFO:tensorflow:Starting iteration 23

Steps executed: 104 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 203.65

Steps executed: 286 Episode length: 95 Return: -94.0.0
I0901 12:31:08.607921 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 24

Steps executed: 279 Episode length: 168 Return: -167.0
INFO:tensorflow:Average training steps per second: 190.71
I0901 12:31:14.088269 140586480396288 replay_runner.py:36] Average training steps per second: 190.71
I0901 12:31:14.321470 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 25

Steps executed: 270 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 191.70
I0901 12:31:19.778866 140586480396288 replay_runner.py:36] Average training steps per second: 191.70
I0901 12:31:20.009606 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 195.19
I0901 12:31:25.376113 140586480396288 replay_runner.py:36] Average training steps per second: 195.19
I0901 12:31:25.546653 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 27

Steps executed: 254 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 195.03
I0901 12:31:30.905261 140586480396288 replay_runner.py:36] Average training steps per second: 195.03
I0901 12:31:31.099101 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 28

Steps executed: 297 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 195.72
I0901 12:31:36.431993 140586480396288 replay_runner.py:36] Average training steps per second: 195.72
I0901 12:31:36.671467 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 197.09
I0901 12:31:41.975150 140586480396288 replay_runner.py:36] Average training steps per second: 197.09
I0901 12:31:42.208030 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33