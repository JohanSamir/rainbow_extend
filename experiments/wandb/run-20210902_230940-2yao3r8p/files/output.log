I0902 23:09:47.236371 140457530894336 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.236941 140457530894336 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.315077 140457530894336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.316240 140457530894336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.316313 140457530894336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.316459 140457530894336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.316522 140457530894336 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.316662 140457530894336 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:47.316760 140457530894336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.316830 140457530894336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.316894 140457530894336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.316954 140457530894336 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.317020 140457530894336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.317085 140457530894336 dqn_agent.py:283] 	 seed: 1630624187315005
I0902 23:09:47.318906 140457530894336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.319078 140457530894336 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:47.319172 140457530894336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.319252 140457530894336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.319308 140457530894336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.319409 140457530894336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.319478 140457530894336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.319577 140457530894336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.319654 140457530894336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.655652 140457530894336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0902 23:09:53.235580 140457530894336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.268599 140457530894336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.312612 140457530894336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:53.312844 140457530894336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.314406 140457530894336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.316618 140457530894336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.317688 140457530894336 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.317800 140457530894336 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:53.318624 140457530894336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:53.318722 140457530894336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.319464 140457530894336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.319555 140457530894336 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.320239 140457530894336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.320343 140457530894336 dqn_agent.py:283] 	 seed: 1630624193312547
I0902 23:09:53.335696 140457530894336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:53.335878 140457530894336 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:53.337572 140457530894336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:53.337686 140457530894336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:53.338541 140457530894336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:53.338632 140457530894336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:53.339330 140457530894336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:53.339416 140457530894336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:53.340085 140457530894336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.364544 140457530894336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.409034 140457530894336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:54.409329 140457530894336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 126.96
I0902 23:10:02.286351 140457530894336 replay_runner.py:36] Average training steps per second: 126.96
Steps executed: 270 Episode length: 153 Return: -353.36675677838923
I0902 23:10:03.646801 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.37
INFO:tensorflow:Starting iteration 1

Steps executed: 104 Episode length: 104 Return: -324.94577236320106
INFO:tensorflow:Average training steps per second: 202.95

Steps executed: 303 Episode length: 199 Return: -326.91378660790776
I0902 23:10:12.977149 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.93
INFO:tensorflow:Starting iteration 2

Steps executed: 399 Episode length: 249 Return: -325.25689038876453
INFO:tensorflow:Average training steps per second: 205.78
I0902 23:10:22.138260 140457530894336 replay_runner.py:36] Average training steps per second: 205.78
I0902 23:10:22.611745 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.12
INFO:tensorflow:Starting iteration 3
I0902 23:10:26.934688 140457530894336 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 210.03

Steps executed: 866 Episode length: 866 Return: -99.635150188427263
I0902 23:10:34.330803 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.64
INFO:tensorflow:Starting iteration 4

Steps executed: 399 Episode length: 399 Return: -340.51167911853094
INFO:tensorflow:Average training steps per second: 210.29
I0902 23:10:43.431643 140457530894336 replay_runner.py:36] Average training steps per second: 210.29
I0902 23:10:44.025455 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.51
INFO:tensorflow:Starting iteration 5
I0902 23:10:48.330750 140457530894336 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 221.19

Steps executed: 697 Episode length: 697 Return: -229.04664892201902
I0902 23:10:54.333047 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.05
INFO:tensorflow:Starting iteration 6
I0902 23:10:58.626356 140457530894336 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 218.88

Steps executed: 938 Episode length: 938 Return: -295.12863729697705
I0902 23:11:06.148408 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.13
INFO:tensorflow:Starting iteration 7
I0902 23:11:10.413544 140457530894336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 223.05

Steps executed: 754 Episode length: 754 Return: -564.38497006570135
I0902 23:11:16.601770 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -564.38
INFO:tensorflow:Starting iteration 8

Steps executed: 570 Episode length: 414 Return: -573.08379758968324
INFO:tensorflow:Average training steps per second: 220.96
I0902 23:11:25.483343 140457530894336 replay_runner.py:36] Average training steps per second: 220.96
I0902 23:11:26.264412 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.74
INFO:tensorflow:Starting iteration 9
I0902 23:11:30.539623 140457530894336 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 223.55

Steps executed: 378 Episode length: 378 Return: -656.54783021971254
I0902 23:11:35.558696 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.55
INFO:tensorflow:Starting iteration 10
I0902 23:11:40.002132 140457530894336 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.96

Steps executed: 1000 Episode length: 1000 Return: -167.01132355395853
I0902 23:11:48.103256 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.01
INFO:tensorflow:Starting iteration 11
I0902 23:11:52.435035 140457530894336 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 222.59

Steps executed: 1000 Episode length: 1000 Return: -281.80687006253113
I0902 23:11:59.721784 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.81
INFO:tensorflow:Starting iteration 12
I0902 23:12:04.059617 140457530894336 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 216.88

Steps executed: 1000 Episode length: 1000 Return: -177.67329952775847
I0902 23:12:11.523358 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.67
INFO:tensorflow:Starting iteration 13
I0902 23:12:15.833137 140457530894336 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 216.85

Steps executed: 1000 Episode length: 1000 Return: -114.60447309577849
I0902 23:12:22.587018 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.60
INFO:tensorflow:Starting iteration 14
I0902 23:12:26.927473 140457530894336 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 221.70

Steps executed: 1000 Episode length: 1000 Return: -127.93576225890227
I0902 23:12:33.939517 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.94
INFO:tensorflow:Starting iteration 15
I0902 23:12:38.553672 140457530894336 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 222.40

Steps executed: 1000 Episode length: 1000 Return: -100.69485787703712
I0902 23:12:46.547304 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.69
INFO:tensorflow:Starting iteration 16
I0902 23:12:50.318016 140457530894336 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 255.31

Steps executed: 1000 Episode length: 1000 Return: -2.2596783526805272
I0902 23:12:56.594436 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.26
INFO:tensorflow:Starting iteration 17
I0902 23:13:00.554821 140457530894336 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 239.01

Steps executed: 469 Episode length: 469 Return: -769.2616807668664272
I0902 23:13:05.700103 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -769.26
INFO:tensorflow:Starting iteration 18

Steps executed: 250 Episode length: 250 Return: -456.7859189988728272
INFO:tensorflow:Average training steps per second: 223.25
I0902 23:13:14.422527 140457530894336 replay_runner.py:36] Average training steps per second: 223.25
I0902 23:13:14.725503 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.79
INFO:tensorflow:Starting iteration 19
I0902 23:13:19.092868 140457530894336 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 223.41

Steps executed: 425 Episode length: 425 Return: -310.6551856449164272
I0902 23:13:24.380178 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.66
INFO:tensorflow:Starting iteration 20
I0902 23:13:28.783873 140457530894336 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 220.86

Steps executed: 588 Episode length: 425 Return: -291.6945059389607572
I0902 23:13:34.106899 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.30
INFO:tensorflow:Starting iteration 21

Steps executed: 296 Episode length: 143 Return: -176.9742876675480572
INFO:tensorflow:Average training steps per second: 221.24
I0902 23:13:42.763764 140457530894336 replay_runner.py:36] Average training steps per second: 221.24
I0902 23:13:43.015173 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.51
INFO:tensorflow:Starting iteration 22
I0902 23:13:47.352707 140457530894336 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 227.04

Steps executed: 1000 Episode length: 1000 Return: -96.682031087483952
I0902 23:13:54.602602 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.68
INFO:tensorflow:Starting iteration 23
I0902 23:13:58.927631 140457530894336 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 224.47

Steps executed: 347 Episode length: 347 Return: -620.3339525042709952
I0902 23:14:03.915877 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -620.33
INFO:tensorflow:Starting iteration 24
I0902 23:14:08.263541 140457530894336 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 226.61

Steps executed: 860 Episode length: 860 Return: -575.5907092212679952
I0902 23:14:14.984519 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -575.59
INFO:tensorflow:Starting iteration 25
I0902 23:14:19.218267 140457530894336 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 223.50
I0902 23:14:23.693507 140457530894336 replay_runner.py:36] Average training steps per second: 223.50

Steps executed: 1000 Episode length: 1000 Return: -37.019879769112362
INFO:tensorflow:Starting iteration 26

Steps executed: 300 Episode length: 125 Return: -644.0398166945661262
INFO:tensorflow:Average training steps per second: 220.88
I0902 23:14:36.468827 140457530894336 replay_runner.py:36] Average training steps per second: 220.88
I0902 23:14:36.766367 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.85
INFO:tensorflow:Starting iteration 27
I0902 23:14:40.967806 140457530894336 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 220.38

Steps executed: 896 Episode length: 896 Return: -136.1122335709246262
I0902 23:14:48.140063 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.11
INFO:tensorflow:Starting iteration 28

Steps executed: 280 Episode length: 141 Return: -621.5374438205188262
INFO:tensorflow:Average training steps per second: 226.86
I0902 23:14:56.757937 140457530894336 replay_runner.py:36] Average training steps per second: 226.86
I0902 23:14:57.022021 140457530894336 run_experiment.py:428] Average undiscounted return per evaluation episode: -730.79
INFO:tensorflow:Starting iteration 29

Steps executed: 630 Episode length: 630 Return: -593.2397508977391262
INFO:tensorflow:Average training steps per second: 226.65
I0902 23:15:05.729598 140457530894336 replay_runner.py:36] Average training steps per second: 226.65

Done fixed training!Episode length: 630 Return: -593.2397508977391262