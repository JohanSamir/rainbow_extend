I0905 16:21:33.366249 140202555004928 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.366757 140202555004928 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.439000 140202555004928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.440155 140202555004928 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.440249 140202555004928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.440332 140202555004928 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.440423 140202555004928 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.440484 140202555004928 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:33.440557 140202555004928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.440676 140202555004928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.440760 140202555004928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.440815 140202555004928 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.440883 140202555004928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.440947 140202555004928 dqn_agent.py:283] 	 seed: 1630858893438943
I0905 16:21:33.442674 140202555004928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.442823 140202555004928 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:33.442895 140202555004928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.442958 140202555004928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.443020 140202555004928 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.443075 140202555004928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.443163 140202555004928 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.443226 140202555004928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.443323 140202555004928 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0905 16:21:35.004694 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.295499 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.422191 140202555004928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.427671 140202555004928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.427817 140202555004928 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.427905 140202555004928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.427967 140202555004928 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.428023 140202555004928 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.428096 140202555004928 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:35.428149 140202555004928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.428319 140202555004928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.428409 140202555004928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.428465 140202555004928 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.428516 140202555004928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.428566 140202555004928 dqn_agent.py:283] 	 seed: 1630858895427630
I0905 16:21:35.430119 140202555004928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.430232 140202555004928 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:35.430301 140202555004928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.430363 140202555004928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.430419 140202555004928 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.430494 140202555004928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.430554 140202555004928 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.430604 140202555004928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.430655 140202555004928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.450004 140202555004928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.461216 140202555004928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.461401 140202555004928 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 295.21
I0905 16:21:38.848989 140202555004928 replay_runner.py:36] Average training steps per second: 295.21
Steps executed: 259 Episode length: 86 Return: -377.057817286734066
I0905 16:21:39.492962 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.07
INFO:tensorflow:Starting iteration 1
I0905 16:21:42.573715 140202555004928 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 429.53

Steps executed: 202 Episode length: 89 Return: -314.993752477702345
I0905 16:21:44.985085 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.74
INFO:tensorflow:Starting iteration 2

Steps executed: 247 Episode length: 154 Return: -239.44452281255732
INFO:tensorflow:Average training steps per second: 409.48
I0905 16:21:50.515629 140202555004928 replay_runner.py:36] Average training steps per second: 409.48
I0905 16:21:50.628809 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.54
INFO:tensorflow:Starting iteration 3

Steps executed: 225 Episode length: 129 Return: -295.71950960325864
INFO:tensorflow:Average training steps per second: 422.38
I0905 16:21:56.078839 140202555004928 replay_runner.py:36] Average training steps per second: 422.38
I0905 16:21:56.173276 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.46
INFO:tensorflow:Starting iteration 4

Steps executed: 307 Episode length: 137 Return: -301.06506464886246
INFO:tensorflow:Average training steps per second: 425.81
I0905 16:22:01.603486 140202555004928 replay_runner.py:36] Average training steps per second: 425.81
I0905 16:22:01.730277 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.86
INFO:tensorflow:Starting iteration 5

Steps executed: 287 Episode length: 102 Return: -187.88865112503163
INFO:tensorflow:Average training steps per second: 421.93
I0905 16:22:07.175678 140202555004928 replay_runner.py:36] Average training steps per second: 421.93
I0905 16:22:07.306275 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.38
INFO:tensorflow:Starting iteration 6

Steps executed: 220 Episode length: 140 Return: -187.44260456506923
INFO:tensorflow:Average training steps per second: 426.73
I0905 16:22:12.734266 140202555004928 replay_runner.py:36] Average training steps per second: 426.73
I0905 16:22:12.811690 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.39
INFO:tensorflow:Starting iteration 7

Steps executed: 251 Episode length: 88 Return: -395.749260746157232
INFO:tensorflow:Average training steps per second: 423.99
I0905 16:22:18.254278 140202555004928 replay_runner.py:36] Average training steps per second: 423.99
I0905 16:22:18.350177 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.51
INFO:tensorflow:Starting iteration 8

Steps executed: 466 Episode length: 466 Return: -308.50680482108226
INFO:tensorflow:Average training steps per second: 413.11
I0905 16:22:23.855824 140202555004928 replay_runner.py:36] Average training steps per second: 413.11
I0905 16:22:24.231163 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.51
INFO:tensorflow:Starting iteration 9

Steps executed: 260 Episode length: 260 Return: -230.82239649592032
INFO:tensorflow:Average training steps per second: 416.45
I0905 16:22:29.717914 140202555004928 replay_runner.py:36] Average training steps per second: 416.45
I0905 16:22:29.856413 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.82
INFO:tensorflow:Starting iteration 10

Steps executed: 517 Episode length: 517 Return: -290.26750171413482
INFO:tensorflow:Average training steps per second: 421.28
I0905 16:22:35.309680 140202555004928 replay_runner.py:36] Average training steps per second: 421.28
I0905 16:22:35.786032 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.27
INFO:tensorflow:Starting iteration 11

Steps executed: 588 Episode length: 457 Return: -224.89881259242625
INFO:tensorflow:Average training steps per second: 415.51
I0905 16:22:41.278283 140202555004928 replay_runner.py:36] Average training steps per second: 415.51
I0905 16:22:41.692324 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.91
INFO:tensorflow:Starting iteration 12

Steps executed: 94 Episode length: 94 Return: 49.752215555321385625
INFO:tensorflow:Average training steps per second: 419.10

Steps executed: 410 Episode length: 316 Return: -158.10172167427916
I0905 16:22:47.400892 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.17
INFO:tensorflow:Starting iteration 13

Steps executed: 270 Episode length: 270 Return: -58.066328854023516
INFO:tensorflow:Average training steps per second: 428.79
I0905 16:22:52.822647 140202555004928 replay_runner.py:36] Average training steps per second: 428.79
I0905 16:22:52.992555 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.07
INFO:tensorflow:Starting iteration 14

Steps executed: 333 Episode length: 211 Return: -113.59830715554706
INFO:tensorflow:Average training steps per second: 424.95
I0905 16:22:58.431261 140202555004928 replay_runner.py:36] Average training steps per second: 424.95
I0905 16:22:58.589408 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.79
INFO:tensorflow:Starting iteration 15

Steps executed: 682 Episode length: 570 Return: 223.190089633513576
INFO:tensorflow:Average training steps per second: 429.00
I0905 16:23:03.997862 140202555004928 replay_runner.py:36] Average training steps per second: 429.00
I0905 16:23:04.727502 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.77
INFO:tensorflow:Starting iteration 16
I0905 16:23:07.744768 140202555004928 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 448.20

Steps executed: 1000 Episode length: 1000 Return: -109.64487159602938
I0905 16:23:11.770476 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.64
INFO:tensorflow:Starting iteration 17

Steps executed: 278 Episode length: 99 Return: -124.45594371080985938
INFO:tensorflow:Average training steps per second: 315.41
I0905 16:23:18.490694 140202555004928 replay_runner.py:36] Average training steps per second: 315.41
I0905 16:23:18.606739 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.29
INFO:tensorflow:Starting iteration 18
I0905 16:23:21.678118 140202555004928 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 420.62
I0905 16:23:24.055857 140202555004928 replay_runner.py:36] Average training steps per second: 420.62

Steps executed: 1000 Episode length: 1000 Return: -109.47506143337746
INFO:tensorflow:Starting iteration 19

Steps executed: 628 Episode length: 515 Return: -185.6718523462970746
INFO:tensorflow:Average training steps per second: 427.55
I0905 16:23:30.844865 140202555004928 replay_runner.py:36] Average training steps per second: 427.55
I0905 16:23:31.372373 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.74
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 70 Return: -121.51515029377764746
INFO:tensorflow:Average training steps per second: 424.80
I0905 16:23:36.808547 140202555004928 replay_runner.py:36] Average training steps per second: 424.80
I0905 16:23:36.907180 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.26
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 102 Return: -258.7829339307186746
INFO:tensorflow:Average training steps per second: 417.82
I0905 16:23:42.392513 140202555004928 replay_runner.py:36] Average training steps per second: 417.82
I0905 16:23:42.481864 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.67
INFO:tensorflow:Starting iteration 22

Steps executed: 285 Episode length: 153 Return: -259.9537960168266346
INFO:tensorflow:Average training steps per second: 420.01
I0905 16:23:47.965543 140202555004928 replay_runner.py:36] Average training steps per second: 420.01
I0905 16:23:48.093879 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.89
INFO:tensorflow:Starting iteration 23
I0905 16:23:51.189861 140202555004928 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 414.52

Steps executed: 306 Episode length: 155 Return: -131.8173014145214446
I0905 16:23:53.750183 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.54
INFO:tensorflow:Starting iteration 24

Steps executed: 445 Episode length: 313 Return: -374.7242709660612446
INFO:tensorflow:Average training steps per second: 410.12
I0905 16:23:59.280622 140202555004928 replay_runner.py:36] Average training steps per second: 410.12
INFO:tensorflow:Starting iteration 25

Steps executed: 417 Episode length: 417 Return: -503.2848405083205446
INFO:tensorflow:Average training steps per second: 414.25
I0905 16:24:05.172209 140202555004928 replay_runner.py:36] Average training steps per second: 414.25
I0905 16:24:05.579490 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -503.28
INFO:tensorflow:Starting iteration 26

Steps executed: 296 Episode length: 113 Return: 26.403135020543941646
INFO:tensorflow:Average training steps per second: 423.66
I0905 16:24:11.025722 140202555004928 replay_runner.py:36] Average training steps per second: 423.66
I0905 16:24:11.137710 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.57
INFO:tensorflow:Starting iteration 27

Steps executed: 274 Episode length: 274 Return: -266.2868005720532746
INFO:tensorflow:Average training steps per second: 423.67
I0905 16:24:16.599714 140202555004928 replay_runner.py:36] Average training steps per second: 423.67
I0905 16:24:16.772789 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.29
INFO:tensorflow:Starting iteration 28

Steps executed: 312 Episode length: 207 Return: -106.4735601002648546
INFO:tensorflow:Average training steps per second: 416.21
I0905 16:24:22.268770 140202555004928 replay_runner.py:36] Average training steps per second: 416.21
I0905 16:24:22.420332 140202555004928 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.74
INFO:tensorflow:Starting iteration 29

Steps executed: 262 Episode length: 103 Return: -583.4565547229206546
INFO:tensorflow:Average training steps per second: 417.28
I0905 16:24:27.908201 140202555004928 replay_runner.py:36] Average training steps per second: 417.28

Done fixed training!Episode length: 103 Return: -583.4565547229206546