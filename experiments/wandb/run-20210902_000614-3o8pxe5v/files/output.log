Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0902 00:06:20.878624 139645366429696 run_experiment.py:549] Creating TrainRunner ...
I0902 00:06:20.887942 139645366429696 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:06:20.888205 139645366429696 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:06:20.888345 139645366429696 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:06:20.888527 139645366429696 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:06:20.888649 139645366429696 dqn_agent.py:275] 	 update_period: 4
I0902 00:06:20.888755 139645366429696 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:06:20.888854 139645366429696 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:06:20.888960 139645366429696 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:06:20.889056 139645366429696 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:06:20.889145 139645366429696 dqn_agent.py:280] 	 optimizer: adam
I0902 00:06:20.889223 139645366429696 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:06:20.889304 139645366429696 dqn_agent.py:283] 	 seed: 1630541180887865
I0902 00:06:20.892228 139645366429696 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:06:20.892462 139645366429696 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:06:20.892582 139645366429696 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:06:20.892701 139645366429696 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:06:20.892796 139645366429696 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:06:20.892896 139645366429696 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:06:20.893040 139645366429696 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:06:20.893197 139645366429696 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:06:20.893303 139645366429696 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:06:20.936010 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:06:21.402927 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:06:21.419136 139645366429696 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:06:21.428819 139645366429696 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:06:21.429094 139645366429696 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:06:21.429295 139645366429696 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:06:21.429395 139645366429696 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:06:21.429550 139645366429696 dqn_agent.py:275] 	 update_period: 4
I0902 00:06:21.429632 139645366429696 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:06:21.429698 139645366429696 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:06:21.430012 139645366429696 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:06:21.430201 139645366429696 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:06:21.430290 139645366429696 dqn_agent.py:280] 	 optimizer: adam
I0902 00:06:21.430364 139645366429696 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:06:21.430435 139645366429696 dqn_agent.py:283] 	 seed: 1630541181428761
I0902 00:06:21.433093 139645366429696 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:06:21.433216 139645366429696 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:06:21.433482 139645366429696 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:06:21.433654 139645366429696 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:06:21.433766 139645366429696 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:06:21.433884 139645366429696 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:06:21.434004 139645366429696 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:06:21.434136 139645366429696 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:06:21.434258 139645366429696 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:06:21.470004 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:06:21.493772 139645366429696 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:06:21.494065 139645366429696 replay_runner.py:41] Starting iteration 0
Steps executed: 324 Episode length: 324 Return: -323.0
INFO:tensorflow:Average training steps per second: 141.16
I0902 00:06:28.578531 139645366429696 replay_runner.py:36] Average training steps per second: 141.16
I0902 00:06:29.889541 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.00
INFO:tensorflow:Starting iteration 1

Steps executed: 287 Episode length: 287 Return: -286.0
INFO:tensorflow:Average training steps per second: 188.76
I0902 00:06:35.428845 139645366429696 replay_runner.py:36] Average training steps per second: 188.76
I0902 00:06:35.679448 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.00
INFO:tensorflow:Starting iteration 2

Steps executed: 688 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.26
I0902 00:06:41.045844 139645366429696 replay_runner.py:36] Average training steps per second: 195.26
I0902 00:06:41.579260 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.50
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.33
I0902 00:06:46.966473 139645366429696 replay_runner.py:36] Average training steps per second: 193.33
I0902 00:06:47.397389 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 00:06:47.644535 139645366429696 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 201.45
I0902 00:06:52.609092 139645366429696 replay_runner.py:36] Average training steps per second: 201.45
I0902 00:06:53.026598 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 251 Episode length: 251 Return: -250.0
INFO:tensorflow:Average training steps per second: 193.74
I0902 00:06:58.438512 139645366429696 replay_runner.py:36] Average training steps per second: 193.74
I0902 00:06:58.661265 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.27
I0902 00:07:04.081577 139645366429696 replay_runner.py:36] Average training steps per second: 193.27
I0902 00:07:04.517147 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 00:07:04.765403 139645366429696 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.99
I0902 00:07:10.001654 139645366429696 replay_runner.py:36] Average training steps per second: 190.99
I0902 00:07:10.418668 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 267 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 192.11
I0902 00:07:15.874169 139645366429696 replay_runner.py:36] Average training steps per second: 192.11
I0902 00:07:16.095700 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.25
I0902 00:07:21.434986 139645366429696 replay_runner.py:36] Average training steps per second: 196.25
I0902 00:07:21.871423 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 267 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 189.64
I0902 00:07:27.399893 139645366429696 replay_runner.py:36] Average training steps per second: 189.64
I0902 00:07:27.627539 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 11
I0902 00:07:27.852532 139645366429696 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 196.80

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:07:33.374517 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 158 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 188.30

Steps executed: 231 Episode length: 73 Return: -72.0.0
I0902 00:07:39.124540 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 13

Steps executed: 251 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 204.08
I0902 00:07:44.258424 139645366429696 replay_runner.py:36] Average training steps per second: 204.08
I0902 00:07:44.470551 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 14

Steps executed: 262 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 200.32
I0902 00:07:49.706690 139645366429696 replay_runner.py:36] Average training steps per second: 200.32
I0902 00:07:49.912894 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 15

Steps executed: 251 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 193.73
I0902 00:07:55.314043 139645366429696 replay_runner.py:36] Average training steps per second: 193.73
I0902 00:07:55.540844 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 16
I0902 00:07:55.799039 139645366429696 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 202.29

Steps executed: 278 Episode length: 94 Return: -93.0.0
I0902 00:08:00.971154 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 17

Steps executed: 224 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 190.17
I0902 00:08:06.467278 139645366429696 replay_runner.py:36] Average training steps per second: 190.17
I0902 00:08:06.659032 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 18

Steps executed: 254 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 195.59
I0902 00:08:12.016115 139645366429696 replay_runner.py:36] Average training steps per second: 195.59
I0902 00:08:12.228697 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 19

Steps executed: 229 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 198.09
I0902 00:08:17.510693 139645366429696 replay_runner.py:36] Average training steps per second: 198.09
I0902 00:08:17.711770 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 20

Steps executed: 633 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.42
I0902 00:08:23.098553 139645366429696 replay_runner.py:36] Average training steps per second: 194.42
I0902 00:08:23.632698 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.00
INFO:tensorflow:Starting iteration 21

Steps executed: 65 Episode length: 65 Return: -64.00.0
INFO:tensorflow:Average training steps per second: 196.24

Steps executed: 255 Episode length: 114 Return: -113.0
I0902 00:08:29.180559 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 22

Steps executed: 252 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 193.81
I0902 00:08:34.598741 139645366429696 replay_runner.py:36] Average training steps per second: 193.81
I0902 00:08:34.810178 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 23

Steps executed: 242 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 200.13
I0902 00:08:40.054620 139645366429696 replay_runner.py:36] Average training steps per second: 200.13
I0902 00:08:40.256900 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 24

Steps executed: 229 Episode length: 229 Return: -228.0
INFO:tensorflow:Average training steps per second: 196.22
I0902 00:08:45.598049 139645366429696 replay_runner.py:36] Average training steps per second: 196.22
I0902 00:08:45.782488 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.00
INFO:tensorflow:Starting iteration 25

Steps executed: 441 Episode length: 441 Return: -440.0
INFO:tensorflow:Average training steps per second: 211.15
I0902 00:08:50.763806 139645366429696 replay_runner.py:36] Average training steps per second: 211.15
I0902 00:08:51.204051 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -440.00
INFO:tensorflow:Starting iteration 26

Steps executed: 216 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 205.85
I0902 00:08:56.296377 139645366429696 replay_runner.py:36] Average training steps per second: 205.85
I0902 00:08:56.465205 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 27

Steps executed: 420 Episode length: 321 Return: -320.0
INFO:tensorflow:Average training steps per second: 196.76
I0902 00:09:01.771667 139645366429696 replay_runner.py:36] Average training steps per second: 196.76
I0902 00:09:02.123384 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.00
INFO:tensorflow:Starting iteration 28

Steps executed: 264 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 200.75
I0902 00:09:07.549412 139645366429696 replay_runner.py:36] Average training steps per second: 200.75
I0902 00:09:07.775268 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 29

Steps executed: 260 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 197.88
I0902 00:09:13.082848 139645366429696 replay_runner.py:36] Average training steps per second: 197.88

Done fixed training!Episode length: 78 Return: -77.0.0