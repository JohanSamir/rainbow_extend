Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 18:00:19.709152 140110082734080 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:19.719826 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:19.720025 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:19.720127 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:19.720209 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:19.720293 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:19.720401 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:19.720516 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:19.720657 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:19.720756 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:19.720857 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:19.720956 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:19.721063 140110082734080 dqn_agent.py:283] 	 seed: 1630605619719777
I0902 18:00:19.723523 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:19.723746 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:19.723899 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:19.724089 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:19.724227 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:19.724364 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:19.724473 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:19.724542 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:19.724606 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:19.758491 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:20.135437 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:20.148196 140110082734080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:20.158344 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:20.158524 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:20.158612 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:20.158674 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:20.158730 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:20.158790 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:20.158884 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:20.158967 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:20.159023 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:20.159148 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:20.159229 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:20.159299 140110082734080 dqn_agent.py:283] 	 seed: 1630605620158302
I0902 18:00:20.160777 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:20.161010 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:20.161149 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:20.161239 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:20.161319 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:20.161413 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:20.161536 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:20.161670 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:20.161797 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:20.193586 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:20.253352 140110082734080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:20.253716 140110082734080 replay_runner.py:41] Starting iteration 0
Steps executed: 109 Episode length: 109 Return: -187.3824193049842
INFO:tensorflow:Average training steps per second: 169.97

Steps executed: 292 Episode length: 95 Return: -232.59568044943972
I0902 18:00:27.361285 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.25
INFO:tensorflow:Starting iteration 1

Steps executed: 234 Episode length: 103 Return: -198.0014472592464
INFO:tensorflow:Average training steps per second: 233.46
I0902 18:00:36.075638 140110082734080 replay_runner.py:36] Average training steps per second: 233.46
I0902 18:00:36.243081 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.61
INFO:tensorflow:Starting iteration 2

Steps executed: 217 Episode length: 217 Return: -289.27220011890716
INFO:tensorflow:Average training steps per second: 225.94
I0902 18:00:45.053451 140110082734080 replay_runner.py:36] Average training steps per second: 225.94
I0902 18:00:45.274463 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.27
INFO:tensorflow:Starting iteration 3

Steps executed: 273 Episode length: 92 Return: -356.318368900660553
INFO:tensorflow:Average training steps per second: 238.01
I0902 18:00:53.753567 140110082734080 replay_runner.py:36] Average training steps per second: 238.01
I0902 18:00:53.993172 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.76
INFO:tensorflow:Starting iteration 4

Steps executed: 249 Episode length: 130 Return: -328.85291284207464
INFO:tensorflow:Average training steps per second: 232.33
I0902 18:01:02.730540 140110082734080 replay_runner.py:36] Average training steps per second: 232.33
I0902 18:01:02.947865 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.35
INFO:tensorflow:Starting iteration 5

Steps executed: 214 Episode length: 111 Return: -176.56764487619594
INFO:tensorflow:Average training steps per second: 226.63
I0902 18:01:11.619338 140110082734080 replay_runner.py:36] Average training steps per second: 226.63
I0902 18:01:11.816589 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.34
INFO:tensorflow:Starting iteration 6

Steps executed: 273 Episode length: 273 Return: -135.94787827118773
INFO:tensorflow:Average training steps per second: 229.95
I0902 18:01:20.333805 140110082734080 replay_runner.py:36] Average training steps per second: 229.95
I0902 18:01:20.632019 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.95
INFO:tensorflow:Starting iteration 7
I0902 18:01:25.002622 140110082734080 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 223.55

Steps executed: 348 Episode length: 152 Return: -391.92036454799404
I0902 18:01:29.824953 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.86
INFO:tensorflow:Starting iteration 8

Steps executed: 302 Episode length: 179 Return: -223.80791922874215
INFO:tensorflow:Average training steps per second: 225.18
I0902 18:01:38.427745 140110082734080 replay_runner.py:36] Average training steps per second: 225.18
I0902 18:01:38.710181 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.48
INFO:tensorflow:Starting iteration 9
I0902 18:01:43.227360 140110082734080 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.03

Steps executed: 241 Episode length: 126 Return: -148.85961284081372
I0902 18:01:47.836162 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.27
INFO:tensorflow:Starting iteration 10

Steps executed: 232 Episode length: 95 Return: -553.784317681055512
INFO:tensorflow:Average training steps per second: 232.21
I0902 18:01:56.620488 140110082734080 replay_runner.py:36] Average training steps per second: 232.21
I0902 18:01:56.812290 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.15
INFO:tensorflow:Starting iteration 11

Steps executed: 331 Episode length: 205 Return: -71.276804583353482
INFO:tensorflow:Average training steps per second: 243.85
I0902 18:02:05.272272 140110082734080 replay_runner.py:36] Average training steps per second: 243.85
I0902 18:02:05.539109 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.56
INFO:tensorflow:Starting iteration 12

Steps executed: 269 Episode length: 102 Return: -204.32937652475232
INFO:tensorflow:Average training steps per second: 236.53
I0902 18:02:14.018788 140110082734080 replay_runner.py:36] Average training steps per second: 236.53
I0902 18:02:14.221289 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.08
INFO:tensorflow:Starting iteration 13

Steps executed: 274 Episode length: 173 Return: -415.97819992287145
INFO:tensorflow:Average training steps per second: 225.40
I0902 18:02:22.962336 140110082734080 replay_runner.py:36] Average training steps per second: 225.40
I0902 18:02:23.194725 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -520.22
INFO:tensorflow:Starting iteration 14

Steps executed: 91 Episode length: 91 Return: -667.8168076897839145
INFO:tensorflow:Average training steps per second: 225.87

Steps executed: 312 Episode length: 125 Return: -294.64054623996325
I0902 18:02:32.024814 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.04
INFO:tensorflow:Starting iteration 15

Steps executed: 289 Episode length: 164 Return: -257.12483882491756
INFO:tensorflow:Average training steps per second: 224.62
I0902 18:02:40.883646 140110082734080 replay_runner.py:36] Average training steps per second: 224.62
I0902 18:02:41.141906 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.94
INFO:tensorflow:Starting iteration 16
I0902 18:02:45.446776 140110082734080 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 231.99
I0902 18:02:49.757748 140110082734080 replay_runner.py:36] Average training steps per second: 231.99

Steps executed: 267 Episode length: 127 Return: -243.34690449550584
INFO:tensorflow:Starting iteration 17

Steps executed: 276 Episode length: 169 Return: -114.08782831453986
INFO:tensorflow:Average training steps per second: 231.62
I0902 18:02:58.501363 140110082734080 replay_runner.py:36] Average training steps per second: 231.62
I0902 18:02:58.733868 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.79
INFO:tensorflow:Starting iteration 18
I0902 18:03:03.022388 140110082734080 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 225.89
I0902 18:03:07.450043 140110082734080 replay_runner.py:36] Average training steps per second: 225.89

Steps executed: 284 Episode length: 103 Return: -182.89565525529352
INFO:tensorflow:Starting iteration 19

Steps executed: 241 Episode length: 110 Return: -137.61645157762393
INFO:tensorflow:Average training steps per second: 221.49
I0902 18:03:16.556664 140110082734080 replay_runner.py:36] Average training steps per second: 221.49
I0902 18:03:16.759037 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.46
INFO:tensorflow:Starting iteration 20
I0902 18:03:21.091907 140110082734080 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 220.84
I0902 18:03:25.620626 140110082734080 replay_runner.py:36] Average training steps per second: 220.84

Steps executed: 264 Episode length: 124 Return: -191.78561532346323
INFO:tensorflow:Starting iteration 21

Steps executed: 267 Episode length: 149 Return: -318.93499417426986
INFO:tensorflow:Average training steps per second: 223.16
I0902 18:03:34.705794 140110082734080 replay_runner.py:36] Average training steps per second: 223.16
I0902 18:03:34.944861 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.64
INFO:tensorflow:Starting iteration 22
I0902 18:03:39.313177 140110082734080 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 222.47

Steps executed: 262 Episode length: 99 Return: -623.049010476286916
I0902 18:03:44.040179 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.85
INFO:tensorflow:Starting iteration 23

Steps executed: 274 Episode length: 105 Return: -316.63752222067827
INFO:tensorflow:Average training steps per second: 218.67
I0902 18:03:52.966830 140110082734080 replay_runner.py:36] Average training steps per second: 218.67
I0902 18:03:53.202291 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.24
INFO:tensorflow:Starting iteration 24
I0902 18:03:57.364938 140110082734080 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.62

Steps executed: 314 Episode length: 131 Return: -73.340225124511427
I0902 18:04:02.157771 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.25
INFO:tensorflow:Starting iteration 25

Steps executed: 283 Episode length: 160 Return: -270.36611396418266
INFO:tensorflow:Average training steps per second: 216.36
I0902 18:04:11.111552 140110082734080 replay_runner.py:36] Average training steps per second: 216.36
I0902 18:04:11.349525 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.74
INFO:tensorflow:Starting iteration 26

Steps executed: 239 Episode length: 140 Return: -326.95302895620466
INFO:tensorflow:Average training steps per second: 219.26
I0902 18:04:20.332975 140110082734080 replay_runner.py:36] Average training steps per second: 219.26
I0902 18:04:20.550417 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.40
INFO:tensorflow:Starting iteration 27

Steps executed: 310 Episode length: 310 Return: 235.744797106418226
INFO:tensorflow:Average training steps per second: 234.00
I0902 18:04:29.204797 140110082734080 replay_runner.py:36] Average training steps per second: 234.00
I0902 18:04:29.670611 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: 235.74
INFO:tensorflow:Starting iteration 28

Steps executed: 367 Episode length: 199 Return: 14.3737136749606696
INFO:tensorflow:Average training steps per second: 220.48
I0902 18:04:38.597023 140110082734080 replay_runner.py:36] Average training steps per second: 220.48
I0902 18:04:38.918069 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -23.90
INFO:tensorflow:Starting iteration 29

Steps executed: 340 Episode length: 180 Return: 2.70343947864628836
INFO:tensorflow:Average training steps per second: 223.59
I0902 18:04:47.658473 140110082734080 replay_runner.py:36] Average training steps per second: 223.59

Done fixed training!Episode length: 180 Return: 2.70343947864628836