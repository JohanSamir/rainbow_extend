Loaded trained dqn in mountaincar
Training fixed agent 3, please be patient, may be a while...
I0909 13:24:21.788905 139696222607360 run_experiment.py:549] Creating TrainRunner ...
I0909 13:24:21.797162 139696222607360 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:21.797351 139696222607360 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:21.797486 139696222607360 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:21.797606 139696222607360 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:21.797715 139696222607360 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:21.797850 139696222607360 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:21.797962 139696222607360 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:21.798117 139696222607360 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:21.798236 139696222607360 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:21.798364 139696222607360 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:21.798491 139696222607360 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:21.798604 139696222607360 dqn_agent.py:283] 	 seed: 1631193861797114
I0909 13:24:21.801218 139696222607360 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:21.801383 139696222607360 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:21.801516 139696222607360 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:21.801635 139696222607360 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:21.801747 139696222607360 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:21.801868 139696222607360 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:21.801998 139696222607360 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:21.802152 139696222607360 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:21.802263 139696222607360 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:21.844054 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:22.049946 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:22.061053 139696222607360 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:24:22.066471 139696222607360 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:22.066619 139696222607360 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:22.066722 139696222607360 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:22.066787 139696222607360 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:22.066853 139696222607360 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:22.066906 139696222607360 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:22.066957 139696222607360 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:22.067009 139696222607360 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:22.067060 139696222607360 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:22.067111 139696222607360 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:22.067161 139696222607360 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:22.067211 139696222607360 dqn_agent.py:283] 	 seed: 1631193862066437
I0909 13:24:22.068757 139696222607360 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:22.068924 139696222607360 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:22.069005 139696222607360 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:22.069077 139696222607360 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:22.069136 139696222607360 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:22.069190 139696222607360 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:22.069268 139696222607360 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:22.069323 139696222607360 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:22.069418 139696222607360 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:22.097911 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:22.115828 139696222607360 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:24:22.116030 139696222607360 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 170.10
I0909 13:24:27.995650 139696222607360 replay_runner.py:36] Average training steps per second: 170.10
I0909 13:24:29.276295 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:24:29.388471 139696222607360 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 225.41
I0909 13:24:33.825301 139696222607360 replay_runner.py:36] Average training steps per second: 225.41
I0909 13:24:34.179800 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:24:34.285168 139696222607360 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 226.01
I0909 13:24:38.710289 139696222607360 replay_runner.py:36] Average training steps per second: 226.01
I0909 13:24:39.060517 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:24:39.169953 139696222607360 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 223.03
I0909 13:24:43.654291 139696222607360 replay_runner.py:36] Average training steps per second: 223.03
I0909 13:24:44.003456 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:24:44.113459 139696222607360 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 225.52
I0909 13:24:48.548071 139696222607360 replay_runner.py:36] Average training steps per second: 225.52
I0909 13:24:48.896949 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:24:49.003701 139696222607360 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 222.50
I0909 13:24:53.498495 139696222607360 replay_runner.py:36] Average training steps per second: 222.50
I0909 13:24:53.846349 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:24:53.952504 139696222607360 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 227.06
I0909 13:24:58.357133 139696222607360 replay_runner.py:36] Average training steps per second: 227.06
I0909 13:24:58.693151 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:24:58.802209 139696222607360 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 230.74
I0909 13:25:03.136634 139696222607360 replay_runner.py:36] Average training steps per second: 230.74
I0909 13:25:03.482121 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:25:03.592877 139696222607360 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 225.74
I0909 13:25:08.023190 139696222607360 replay_runner.py:36] Average training steps per second: 225.74
I0909 13:25:08.371456 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:25:08.476879 139696222607360 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.72
I0909 13:25:12.868590 139696222607360 replay_runner.py:36] Average training steps per second: 227.72
I0909 13:25:13.210376 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 707 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.21
I0909 13:25:17.759935 139696222607360 replay_runner.py:36] Average training steps per second: 225.21
I0909 13:25:18.189926 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.50
INFO:tensorflow:Starting iteration 11

Steps executed: 721 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.30
I0909 13:25:22.746021 139696222607360 replay_runner.py:36] Average training steps per second: 225.30
I0909 13:25:23.170464 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.50
INFO:tensorflow:Starting iteration 12
I0909 13:25:23.277631 139696222607360 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 229.32
I0909 13:25:27.638846 139696222607360 replay_runner.py:36] Average training steps per second: 229.32
I0909 13:25:27.980272 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.57
I0909 13:25:32.524271 139696222607360 replay_runner.py:36] Average training steps per second: 225.57
I0909 13:25:32.930235 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.50
INFO:tensorflow:Starting iteration 14

Steps executed: 709 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 227.70
I0909 13:25:37.434384 139696222607360 replay_runner.py:36] Average training steps per second: 227.70
I0909 13:25:37.582191 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 15

Steps executed: 247 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 225.39
I0909 13:25:42.125875 139696222607360 replay_runner.py:36] Average training steps per second: 225.39
I0909 13:25:42.289547 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.33
INFO:tensorflow:Starting iteration 16

Steps executed: 277 Episode length: 93 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 227.14
I0909 13:25:46.801052 139696222607360 replay_runner.py:36] Average training steps per second: 227.14
I0909 13:25:46.952984 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 17

Steps executed: 265 Episode length: 131 Return: -131.0
INFO:tensorflow:Average training steps per second: 224.75
I0909 13:25:51.511445 139696222607360 replay_runner.py:36] Average training steps per second: 224.75
I0909 13:25:51.647782 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 18

Steps executed: 222 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 225.81
I0909 13:25:56.184190 139696222607360 replay_runner.py:36] Average training steps per second: 225.81
I0909 13:25:56.339831 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 19

Steps executed: 247 Episode length: 125 Return: -125.0
INFO:tensorflow:Average training steps per second: 226.61
I0909 13:26:00.860437 139696222607360 replay_runner.py:36] Average training steps per second: 226.61
I0909 13:26:00.996451 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 20

Steps executed: 237 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 228.04
I0909 13:26:05.484664 139696222607360 replay_runner.py:36] Average training steps per second: 228.04

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 21
I0909 13:26:05.941310 139696222607360 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 224.77
I0909 13:26:10.390782 139696222607360 replay_runner.py:36] Average training steps per second: 224.77
I0909 13:26:10.624295 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.50
INFO:tensorflow:Starting iteration 22

Steps executed: 385 Episode length: 201 Return: -201.0
INFO:tensorflow:Average training steps per second: 223.40
I0909 13:26:15.212144 139696222607360 replay_runner.py:36] Average training steps per second: 223.40
I0909 13:26:15.358857 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 23

Steps executed: 238 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 222.55

Steps executed: 727 Episode length: 600 Return: -600.0
I0909 13:26:20.389706 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.50
INFO:tensorflow:Starting iteration 24

Steps executed: 218 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 227.21
I0909 13:26:24.896049 139696222607360 replay_runner.py:36] Average training steps per second: 227.21
I0909 13:26:25.022129 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 25

Steps executed: 220 Episode length: 85 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 227.89
I0909 13:26:29.516083 139696222607360 replay_runner.py:36] Average training steps per second: 227.89
I0909 13:26:29.654861 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 26
I0909 13:26:29.769391 139696222607360 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 229.23
I0909 13:26:34.132256 139696222607360 replay_runner.py:36] Average training steps per second: 229.23

Steps executed: 342 Episode length: 165 Return: -165.0
INFO:tensorflow:Starting iteration 27

Steps executed: 265 Episode length: 172 Return: -172.0
INFO:tensorflow:Average training steps per second: 226.65
I0909 13:26:38.845414 139696222607360 replay_runner.py:36] Average training steps per second: 226.65
I0909 13:26:39.004209 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 28

Steps executed: 254 Episode length: 87 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 228.00
I0909 13:26:43.491704 139696222607360 replay_runner.py:36] Average training steps per second: 228.00
I0909 13:26:43.638000 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 245.69
I0909 13:26:47.811016 139696222607360 replay_runner.py:36] Average training steps per second: 245.69
I0909 13:26:48.088202 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00