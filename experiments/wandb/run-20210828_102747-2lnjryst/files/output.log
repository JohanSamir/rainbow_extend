Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0828 10:27:54.258116 140160266885120 run_experiment.py:549] Creating TrainRunner ...
I0828 10:27:54.266215 140160266885120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:27:54.266448 140160266885120 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:27:54.266615 140160266885120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:27:54.266695 140160266885120 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:27:54.266764 140160266885120 dqn_agent.py:275] 	 update_period: 4
I0828 10:27:54.266875 140160266885120 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:27:54.267006 140160266885120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:27:54.267135 140160266885120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:27:54.267220 140160266885120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:27:54.267300 140160266885120 dqn_agent.py:280] 	 optimizer: adam
I0828 10:27:54.267390 140160266885120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:27:54.267452 140160266885120 dqn_agent.py:283] 	 seed: 1630146474266156
I0828 10:27:54.269413 140160266885120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:27:54.269550 140160266885120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:27:54.269620 140160266885120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:27:54.269677 140160266885120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:27:54.269729 140160266885120 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:27:54.269778 140160266885120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:27:54.269830 140160266885120 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:27:54.269877 140160266885120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:27:54.269924 140160266885120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:27:54.299490 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:54.653114 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:54.664169 140160266885120 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:27:54.671398 140160266885120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:27:54.671675 140160266885120 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:27:54.671864 140160266885120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:27:54.671956 140160266885120 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:27:54.672033 140160266885120 dqn_agent.py:275] 	 update_period: 4
I0828 10:27:54.672107 140160266885120 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:27:54.672261 140160266885120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:27:54.672357 140160266885120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:27:54.672431 140160266885120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:27:54.672605 140160266885120 dqn_agent.py:280] 	 optimizer: adam
I0828 10:27:54.672688 140160266885120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:27:54.672776 140160266885120 dqn_agent.py:283] 	 seed: 1630146474671341
I0828 10:27:54.674998 140160266885120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:27:54.675120 140160266885120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:27:54.675197 140160266885120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:27:54.675261 140160266885120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:27:54.675318 140160266885120 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:27:54.675370 140160266885120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:27:54.675422 140160266885120 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:27:54.675472 140160266885120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:27:54.675547 140160266885120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:27:54.701690 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=1.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:27:54.720122 140160266885120 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:27:54.720373 140160266885120 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 155.87
I0828 10:28:01.136359 140160266885120 replay_runner.py:36] Average training steps per second: 155.87
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:28:02.690935 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:28:02.913326 140160266885120 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 195.66
I0828 10:28:08.024813 140160266885120 replay_runner.py:36] Average training steps per second: 195.66
I0828 10:28:08.431928 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:28:08.669237 140160266885120 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 194.05
I0828 10:28:13.823188 140160266885120 replay_runner.py:36] Average training steps per second: 194.05
I0828 10:28:14.260759 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0828 10:28:14.498649 140160266885120 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.89
I0828 10:28:19.552324 140160266885120 replay_runner.py:36] Average training steps per second: 197.89
I0828 10:28:19.943180 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 412 Episode length: 234 Return: -233.0
INFO:tensorflow:Average training steps per second: 192.45
I0828 10:28:25.359602 140160266885120 replay_runner.py:36] Average training steps per second: 192.45
I0828 10:28:25.703144 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.33
INFO:tensorflow:Starting iteration 5

Steps executed: 205 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.33
I0828 10:28:30.947300 140160266885120 replay_runner.py:36] Average training steps per second: 200.33
I0828 10:28:31.124301 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 6

Steps executed: 359 Episode length: 175 Return: -174.0
INFO:tensorflow:Average training steps per second: 197.53
I0828 10:28:36.439569 140160266885120 replay_runner.py:36] Average training steps per second: 197.53
I0828 10:28:36.725076 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.50
INFO:tensorflow:Starting iteration 7
I0828 10:28:36.969007 140160266885120 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.98

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:28:42.490654 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0828 10:28:42.740039 140160266885120 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.12
I0828 10:28:47.787947 140160266885120 replay_runner.py:36] Average training steps per second: 198.12
I0828 10:28:48.186687 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0828 10:28:48.437209 140160266885120 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 189.48
I0828 10:28:53.715317 140160266885120 replay_runner.py:36] Average training steps per second: 189.48
I0828 10:28:54.115264 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:28:54.346290 140160266885120 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 201.86
I0828 10:28:59.300777 140160266885120 replay_runner.py:36] Average training steps per second: 201.86
I0828 10:28:59.723006 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:28:59.972229 140160266885120 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 199.24
I0828 10:29:04.991741 140160266885120 replay_runner.py:36] Average training steps per second: 199.24
I0828 10:29:05.382222 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0828 10:29:05.619443 140160266885120 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 192.97
I0828 10:29:10.802008 140160266885120 replay_runner.py:36] Average training steps per second: 192.97
I0828 10:29:11.232990 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:29:11.458737 140160266885120 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 197.82
I0828 10:29:16.514374 140160266885120 replay_runner.py:36] Average training steps per second: 197.82
I0828 10:29:16.954744 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:29:17.281744 140160266885120 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.64
I0828 10:29:22.446686 140160266885120 replay_runner.py:36] Average training steps per second: 193.64
I0828 10:29:22.845297 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:29:23.084031 140160266885120 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 192.88
I0828 10:29:28.268957 140160266885120 replay_runner.py:36] Average training steps per second: 192.88
I0828 10:29:28.703479 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:29:28.956540 140160266885120 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 201.44
I0828 10:29:33.921196 140160266885120 replay_runner.py:36] Average training steps per second: 201.44
I0828 10:29:34.352418 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:29:34.603413 140160266885120 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 193.68
I0828 10:29:39.766930 140160266885120 replay_runner.py:36] Average training steps per second: 193.68
I0828 10:29:40.189248 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:29:40.404308 140160266885120 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 201.34
I0828 10:29:45.371443 140160266885120 replay_runner.py:36] Average training steps per second: 201.34
I0828 10:29:45.823436 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:29:46.073882 140160266885120 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 198.71
I0828 10:29:51.107080 140160266885120 replay_runner.py:36] Average training steps per second: 198.71
I0828 10:29:51.504099 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:29:51.742750 140160266885120 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.33
I0828 10:29:56.942556 140160266885120 replay_runner.py:36] Average training steps per second: 192.33
I0828 10:29:57.376394 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:29:57.617059 140160266885120 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 200.18
I0828 10:30:02.613037 140160266885120 replay_runner.py:36] Average training steps per second: 200.18
I0828 10:30:03.047983 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:30:03.295840 140160266885120 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 197.36
I0828 10:30:08.363539 140160266885120 replay_runner.py:36] Average training steps per second: 197.36
I0828 10:30:08.750551 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:30:08.991210 140160266885120 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 198.13
I0828 10:30:14.038878 140160266885120 replay_runner.py:36] Average training steps per second: 198.13
I0828 10:30:14.500335 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:30:14.743898 140160266885120 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 212.81
I0828 10:30:19.443353 140160266885120 replay_runner.py:36] Average training steps per second: 212.81
I0828 10:30:19.819090 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:30:20.055740 140160266885120 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.46
I0828 10:30:25.019796 140160266885120 replay_runner.py:36] Average training steps per second: 201.46
I0828 10:30:25.401262 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:30:25.660107 140160266885120 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 207.32
I0828 10:30:30.483829 140160266885120 replay_runner.py:36] Average training steps per second: 207.32
I0828 10:30:30.904236 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:30:31.219521 140160266885120 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 203.43
I0828 10:30:36.135623 140160266885120 replay_runner.py:36] Average training steps per second: 203.43
I0828 10:30:36.540810 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:30:36.776598 140160266885120 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 199.18
I0828 10:30:41.797722 140160266885120 replay_runner.py:36] Average training steps per second: 199.18
I0828 10:30:42.202995 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.61
I0828 10:30:47.381002 140160266885120 replay_runner.py:36] Average training steps per second: 202.61
I0828 10:30:47.811604 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00