Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
I0909 14:10:42.768338 139994741372928 run_experiment.py:549] Creating TrainRunner ...
I0909 14:10:42.774141 139994741372928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:10:42.774265 139994741372928 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:10:42.774321 139994741372928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:10:42.774377 139994741372928 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:10:42.774430 139994741372928 dqn_agent.py:275] 	 update_period: 4
I0909 14:10:42.774480 139994741372928 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:10:42.774529 139994741372928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:10:42.774596 139994741372928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:10:42.774680 139994741372928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:10:42.774751 139994741372928 dqn_agent.py:280] 	 optimizer: adam
I0909 14:10:42.774815 139994741372928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:10:42.774877 139994741372928 dqn_agent.py:283] 	 seed: 1631196642774111
I0909 14:10:42.776485 139994741372928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:10:42.776599 139994741372928 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:10:42.776678 139994741372928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:10:42.776761 139994741372928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:10:42.776839 139994741372928 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:10:42.776936 139994741372928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:10:42.777004 139994741372928 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:10:42.777063 139994741372928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:10:42.777127 139994741372928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:10:42.905618 139994741372928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:43.049327 139994741372928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:43.057810 139994741372928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 14:10:43.062613 139994741372928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:10:43.062742 139994741372928 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:10:43.062810 139994741372928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:10:43.062867 139994741372928 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:10:43.062926 139994741372928 dqn_agent.py:275] 	 update_period: 4
I0909 14:10:43.062992 139994741372928 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:10:43.063077 139994741372928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:10:43.063147 139994741372928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:10:43.063210 139994741372928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:10:43.063262 139994741372928 dqn_agent.py:280] 	 optimizer: adam
I0909 14:10:43.063342 139994741372928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:10:43.063413 139994741372928 dqn_agent.py:283] 	 seed: 1631196643062582
I0909 14:10:43.064969 139994741372928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:10:43.065082 139994741372928 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:10:43.065161 139994741372928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:10:43.065237 139994741372928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:10:43.065298 139994741372928 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:10:43.065356 139994741372928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:10:43.065425 139994741372928 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:10:43.065500 139994741372928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:10:43.065588 139994741372928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:10:43.092237 139994741372928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:10:43.106781 139994741372928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 14:10:43.106905 139994741372928 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 188.99
I0909 14:10:48.398416 139994741372928 replay_runner.py:36] Average training steps per second: 188.99
I0909 14:10:49.361070 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 14:10:49.436069 139994741372928 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 292.05
I0909 14:10:52.860687 139994741372928 replay_runner.py:36] Average training steps per second: 292.05
I0909 14:10:53.106097 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 14:10:53.214001 139994741372928 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 261.21
I0909 14:10:57.042753 139994741372928 replay_runner.py:36] Average training steps per second: 261.21
I0909 14:10:57.307106 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 14:10:57.396907 139994741372928 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 267.01
I0909 14:11:01.142630 139994741372928 replay_runner.py:36] Average training steps per second: 267.01
I0909 14:11:01.408755 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 14:11:01.502876 139994741372928 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 258.69
I0909 14:11:05.368934 139994741372928 replay_runner.py:36] Average training steps per second: 258.69
I0909 14:11:05.628723 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 14:11:05.722213 139994741372928 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 259.87
I0909 14:11:09.570512 139994741372928 replay_runner.py:36] Average training steps per second: 259.87
I0909 14:11:09.839342 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 14:11:09.946524 139994741372928 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 259.50
I0909 14:11:13.800522 139994741372928 replay_runner.py:36] Average training steps per second: 259.50
I0909 14:11:14.053208 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 14:11:14.144438 139994741372928 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 254.98
I0909 14:11:18.066677 139994741372928 replay_runner.py:36] Average training steps per second: 254.98
I0909 14:11:18.341397 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 14:11:18.430331 139994741372928 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 256.29
I0909 14:11:22.332653 139994741372928 replay_runner.py:36] Average training steps per second: 256.29
I0909 14:11:22.600737 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 184 Episode length: 87 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 261.32
I0909 14:11:26.524753 139994741372928 replay_runner.py:36] Average training steps per second: 261.32

Steps executed: 784 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 10
I0909 14:11:26.969978 139994741372928 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 258.12

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 14:11:31.130841 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 264 Episode length: 132 Return: -132.0
INFO:tensorflow:Average training steps per second: 259.07
I0909 14:11:35.099377 139994741372928 replay_runner.py:36] Average training steps per second: 259.07
I0909 14:11:35.232279 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.00
INFO:tensorflow:Starting iteration 12

Steps executed: 241 Episode length: 118 Return: -118.0
INFO:tensorflow:Average training steps per second: 261.77
I0909 14:11:39.157401 139994741372928 replay_runner.py:36] Average training steps per second: 261.77
I0909 14:11:39.270180 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 13

Steps executed: 233 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 258.58
I0909 14:11:43.246020 139994741372928 replay_runner.py:36] Average training steps per second: 258.58
I0909 14:11:43.351863 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 14

Steps executed: 214 Episode length: 101 Return: -101.0
INFO:tensorflow:Average training steps per second: 252.29
I0909 14:11:47.423368 139994741372928 replay_runner.py:36] Average training steps per second: 252.29
I0909 14:11:47.529322 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 258.69
I0909 14:11:51.484204 139994741372928 replay_runner.py:36] Average training steps per second: 258.69
I0909 14:11:51.747300 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 338 Episode length: 153 Return: -153.0
INFO:tensorflow:Average training steps per second: 262.84
I0909 14:11:55.646597 139994741372928 replay_runner.py:36] Average training steps per second: 262.84
I0909 14:11:55.788266 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.67
INFO:tensorflow:Starting iteration 17

Steps executed: 289 Episode length: 92 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 260.69
I0909 14:11:59.718431 139994741372928 replay_runner.py:36] Average training steps per second: 260.69
I0909 14:11:59.843569 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.50
INFO:tensorflow:Starting iteration 18

Steps executed: 270 Episode length: 138 Return: -138.0
INFO:tensorflow:Average training steps per second: 261.95
I0909 14:12:03.752591 139994741372928 replay_runner.py:36] Average training steps per second: 261.95
I0909 14:12:03.872814 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 19

Steps executed: 211 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 257.22
I0909 14:12:07.850812 139994741372928 replay_runner.py:36] Average training steps per second: 257.22
I0909 14:12:07.945037 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 20
I0909 14:12:08.050036 139994741372928 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 260.77
I0909 14:12:11.885256 139994741372928 replay_runner.py:36] Average training steps per second: 260.77
I0909 14:12:11.980749 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 21

Steps executed: 216 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 259.46
I0909 14:12:15.924007 139994741372928 replay_runner.py:36] Average training steps per second: 259.46
I0909 14:12:16.024704 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 22

Steps executed: 221 Episode length: 101 Return: -101.0
INFO:tensorflow:Average training steps per second: 256.23
I0909 14:12:20.023004 139994741372928 replay_runner.py:36] Average training steps per second: 256.23
I0909 14:12:20.157850 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 23

Steps executed: 266 Episode length: 133 Return: -133.0
INFO:tensorflow:Average training steps per second: 260.06
I0909 14:12:24.095426 139994741372928 replay_runner.py:36] Average training steps per second: 260.06
I0909 14:12:24.205125 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 24

Steps executed: 252 Episode length: 122 Return: -122.0
INFO:tensorflow:Average training steps per second: 255.27
I0909 14:12:28.214105 139994741372928 replay_runner.py:36] Average training steps per second: 255.27
I0909 14:12:28.318063 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 25

Steps executed: 215 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 255.71
I0909 14:12:32.334844 139994741372928 replay_runner.py:36] Average training steps per second: 255.71
I0909 14:12:32.436538 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 26

Steps executed: 220 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 259.86
I0909 14:12:36.377866 139994741372928 replay_runner.py:36] Average training steps per second: 259.86
I0909 14:12:36.483512 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 27

Steps executed: 236 Episode length: 118 Return: -118.0
INFO:tensorflow:Average training steps per second: 256.44
I0909 14:12:40.476840 139994741372928 replay_runner.py:36] Average training steps per second: 256.44
I0909 14:12:40.581144 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 28

Steps executed: 223 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 254.57

Steps executed: 725 Episode length: 600 Return: -600.0
I0909 14:12:44.953069 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 252.46
I0909 14:12:49.008676 139994741372928 replay_runner.py:36] Average training steps per second: 252.46
I0909 14:12:49.124113 139994741372928 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00