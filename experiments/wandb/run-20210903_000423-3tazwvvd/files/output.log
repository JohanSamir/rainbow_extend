I0903 00:04:29.384730 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0903 00:04:29.392643 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:04:29.392788 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:04:29.392865 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:04:29.392927 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:04:29.392983 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:04:29.393060 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:04:29.393161 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:04:29.393242 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:04:29.393327 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:04:29.393396 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:04:29.393471 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:04:29.393552 139900407642112 dqn_agent.py:283] 	 seed: 1630627469392603
I0903 00:04:29.395243 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:04:29.395367 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:04:29.395443 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:04:29.395506 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:04:29.395582 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:04:29.395682 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:04:29.395740 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:04:29.395812 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:04:29.395905 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:04:29.423067 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:29.666704 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:29.674530 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:04:29.681299 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:04:29.681434 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:04:29.681501 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:04:29.681594 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:04:29.681649 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:04:29.681702 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:04:29.681783 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:04:29.681875 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:04:29.681948 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:04:29.682018 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:04:29.682091 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:04:29.682178 139900407642112 dqn_agent.py:283] 	 seed: 1630627469681270
I0903 00:04:29.683543 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:04:29.683656 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:04:29.683740 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:04:29.683803 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:04:29.683865 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:04:29.683983 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:04:29.684063 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:04:29.684134 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:04:29.684202 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:04:29.703997 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:04:29.717258 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:04:29.717403 139900407642112 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 256.07
I0903 00:04:33.622721 139900407642112 replay_runner.py:36] Average training steps per second: 256.07
I0903 00:04:34.489274 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.47
Steps executed: 243 Episode length: 106 Return: -419.98889923449365
INFO:tensorflow:Starting iteration 1

Steps executed: 222 Episode length: 101 Return: -474.21797880649206
INFO:tensorflow:Average training steps per second: 341.09
I0903 00:04:40.750726 139900407642112 replay_runner.py:36] Average training steps per second: 341.09
I0903 00:04:40.880060 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.94
INFO:tensorflow:Starting iteration 2
I0903 00:04:44.142919 139900407642112 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 345.11

Steps executed: 348 Episode length: 183 Return: -42.527747211465074
I0903 00:04:47.295323 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.37
INFO:tensorflow:Starting iteration 3

Steps executed: 359 Episode length: 359 Return: -137.34140610789106
INFO:tensorflow:Average training steps per second: 332.84
I0903 00:04:53.733868 139900407642112 replay_runner.py:36] Average training steps per second: 332.84
I0903 00:04:54.153819 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.34
INFO:tensorflow:Starting iteration 4

Steps executed: 246 Episode length: 246 Return: -256.84294378448096
INFO:tensorflow:Average training steps per second: 332.93
I0903 00:05:00.531706 139900407642112 replay_runner.py:36] Average training steps per second: 332.93
I0903 00:05:00.714737 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.84
INFO:tensorflow:Starting iteration 5
I0903 00:05:03.984961 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 332.56

Steps executed: 1000 Episode length: 1000 Return: -79.6112755523026
I0903 00:05:09.127801 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.61
INFO:tensorflow:Starting iteration 6

Steps executed: 1000 Episode length: 1000 Return: -164.98761159310132
INFO:tensorflow:Average training steps per second: 335.02
I0903 00:05:15.471920 139900407642112 replay_runner.py:36] Average training steps per second: 335.02
I0903 00:05:17.033425 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.99
INFO:tensorflow:Starting iteration 7
I0903 00:05:20.381202 139900407642112 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 337.74

Steps executed: 1000 Episode length: 1000 Return: -43.870621634710552
I0903 00:05:26.631686 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.87
INFO:tensorflow:Starting iteration 8
I0903 00:05:29.869091 139900407642112 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 307.90

Steps executed: 518 Episode length: 518 Return: -214.2406450637080652
I0903 00:05:33.807213 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.24
INFO:tensorflow:Starting iteration 9
I0903 00:05:37.119842 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 322.45

Steps executed: 1000 Episode length: 1000 Return: -74.562535664656442
I0903 00:05:42.368485 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.56
INFO:tensorflow:Starting iteration 10
I0903 00:05:45.772505 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 340.53

Steps executed: 1000 Episode length: 1000 Return: -205.21793066113442
I0903 00:05:50.237933 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.22
INFO:tensorflow:Starting iteration 11
I0903 00:05:53.682035 139900407642112 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 338.70

Steps executed: 1000 Episode length: 1000 Return: -27.205271021610397
I0903 00:05:58.776920 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.21
INFO:tensorflow:Starting iteration 12
I0903 00:06:02.212346 139900407642112 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 347.06

Steps executed: 1000 Episode length: 1000 Return: -134.34810951821015
I0903 00:06:06.868680 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.35
INFO:tensorflow:Starting iteration 13
I0903 00:06:10.245599 139900407642112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 323.84

Steps executed: 617 Episode length: 617 Return: -352.8382015960431015
I0903 00:06:14.124917 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.84
INFO:tensorflow:Starting iteration 14
I0903 00:06:17.484340 139900407642112 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 353.39

Steps executed: 1000 Episode length: 1000 Return: -81.265248782828355
I0903 00:06:21.954210 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.27
INFO:tensorflow:Starting iteration 15

Steps executed: 529 Episode length: 405 Return: -302.3043388807106355
INFO:tensorflow:Average training steps per second: 325.07
I0903 00:06:28.353739 139900407642112 replay_runner.py:36] Average training steps per second: 325.07
I0903 00:06:28.948471 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.61
INFO:tensorflow:Starting iteration 16

Steps executed: 261 Episode length: 154 Return: -275.4794789794985355
INFO:tensorflow:Average training steps per second: 324.79
I0903 00:06:35.375270 139900407642112 replay_runner.py:36] Average training steps per second: 324.79
I0903 00:06:35.530783 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.51
INFO:tensorflow:Starting iteration 17

Steps executed: 232 Episode length: 112 Return: -704.1566435170762355
INFO:tensorflow:Average training steps per second: 334.80
I0903 00:06:41.854623 139900407642112 replay_runner.py:36] Average training steps per second: 334.80
I0903 00:06:42.010542 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -690.76
INFO:tensorflow:Starting iteration 18

Steps executed: 203 Episode length: 81 Return: -581.54592872177482355
INFO:tensorflow:Average training steps per second: 332.46
I0903 00:06:48.437127 139900407642112 replay_runner.py:36] Average training steps per second: 332.46
I0903 00:06:48.582231 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -506.13
INFO:tensorflow:Starting iteration 19

Steps executed: 230 Episode length: 122 Return: -117.3587675344411855
INFO:tensorflow:Average training steps per second: 336.51
I0903 00:06:54.931484 139900407642112 replay_runner.py:36] Average training steps per second: 336.51
I0903 00:06:55.048494 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.74
INFO:tensorflow:Starting iteration 20

Steps executed: 263 Episode length: 114 Return: -609.5760214795124555
INFO:tensorflow:Average training steps per second: 331.25
I0903 00:07:01.462242 139900407642112 replay_runner.py:36] Average training steps per second: 331.25
I0903 00:07:01.630105 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.43
INFO:tensorflow:Starting iteration 21

Steps executed: 261 Episode length: 132 Return: -441.1987034505546655
INFO:tensorflow:Average training steps per second: 332.08
I0903 00:07:08.051378 139900407642112 replay_runner.py:36] Average training steps per second: 332.08
I0903 00:07:08.219285 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.49
INFO:tensorflow:Starting iteration 22

Steps executed: 245 Episode length: 151 Return: -369.6093176827256655
INFO:tensorflow:Average training steps per second: 333.14
I0903 00:07:14.609341 139900407642112 replay_runner.py:36] Average training steps per second: 333.14
I0903 00:07:14.756593 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.51
INFO:tensorflow:Starting iteration 23

Steps executed: 241 Episode length: 76 Return: -174.90541785543047655
INFO:tensorflow:Average training steps per second: 338.20
I0903 00:07:21.145809 139900407642112 replay_runner.py:36] Average training steps per second: 338.20
I0903 00:07:21.259624 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.77
INFO:tensorflow:Starting iteration 24
I0903 00:07:24.636698 139900407642112 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 337.50

Steps executed: 292 Episode length: 133 Return: -424.7738767295943655
I0903 00:07:27.750282 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.67
INFO:tensorflow:Starting iteration 25

Steps executed: 212 Episode length: 53 Return: -82.666571870241346655
INFO:tensorflow:Average training steps per second: 332.00
I0903 00:07:34.192140 139900407642112 replay_runner.py:36] Average training steps per second: 332.00
I0903 00:07:34.297396 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.65
INFO:tensorflow:Starting iteration 26

Steps executed: 358 Episode length: 358 Return: -583.8192122680566655
INFO:tensorflow:Average training steps per second: 328.01
I0903 00:07:40.742724 139900407642112 replay_runner.py:36] Average training steps per second: 328.01
I0903 00:07:41.050012 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -583.82
INFO:tensorflow:Starting iteration 27

Steps executed: 160 Episode length: 61 Return: -165.39712344772994655
INFO:tensorflow:Average training steps per second: 321.97
I0903 00:07:47.498024 139900407642112 replay_runner.py:36] Average training steps per second: 321.97

Steps executed: 305 Episode length: 145 Return: -57.46060886373050655
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 101 Return: 2.1366464639867644655
INFO:tensorflow:Average training steps per second: 335.02
I0903 00:07:53.986825 139900407642112 replay_runner.py:36] Average training steps per second: 335.02
I0903 00:07:54.103271 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.98
INFO:tensorflow:Starting iteration 29

Steps executed: 262 Episode length: 108 Return: -942.1125043477961655
INFO:tensorflow:Average training steps per second: 324.89
I0903 00:08:00.370103 139900407642112 replay_runner.py:36] Average training steps per second: 324.89

Done fixed training!Episode length: 108 Return: -942.1125043477961655