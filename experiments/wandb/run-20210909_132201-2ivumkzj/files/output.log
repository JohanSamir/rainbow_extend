Loaded trained dqn in mountaincar
Training fixed agent 3, please be patient, may be a while...
I0909 13:22:06.989728 139696222607360 run_experiment.py:549] Creating TrainRunner ...
I0909 13:22:06.995838 139696222607360 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:06.995949 139696222607360 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:06.996002 139696222607360 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:06.996074 139696222607360 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:06.996117 139696222607360 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:06.996164 139696222607360 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:06.996210 139696222607360 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:06.996268 139696222607360 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:06.996321 139696222607360 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:06.996368 139696222607360 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:06.996434 139696222607360 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:06.996494 139696222607360 dqn_agent.py:283] 	 seed: 1631193726995810
I0909 13:22:06.998185 139696222607360 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:06.998283 139696222607360 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:06.998338 139696222607360 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:06.998392 139696222607360 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:06.998436 139696222607360 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:06.998495 139696222607360 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:06.998541 139696222607360 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:06.998650 139696222607360 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:06.998698 139696222607360 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:07.255725 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:07.389576 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:07.396952 139696222607360 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:22:07.401594 139696222607360 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:07.401719 139696222607360 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:07.401792 139696222607360 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:07.401859 139696222607360 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:07.401919 139696222607360 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:07.401987 139696222607360 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:07.402086 139696222607360 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:07.402157 139696222607360 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:07.402223 139696222607360 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:07.402291 139696222607360 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:07.402359 139696222607360 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:07.402428 139696222607360 dqn_agent.py:283] 	 seed: 1631193727401568
I0909 13:22:07.403768 139696222607360 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:07.403864 139696222607360 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:07.403914 139696222607360 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:07.403958 139696222607360 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:07.404008 139696222607360 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:07.404055 139696222607360 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:07.404105 139696222607360 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:07.404154 139696222607360 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:07.404213 139696222607360 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:07.422729 139696222607360 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:07.433301 139696222607360 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:22:07.433423 139696222607360 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 201.25
I0909 13:22:12.402720 139696222607360 replay_runner.py:36] Average training steps per second: 201.25
I0909 13:22:13.383319 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:22:13.474848 139696222607360 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 261.02
I0909 13:22:17.306455 139696222607360 replay_runner.py:36] Average training steps per second: 261.02
I0909 13:22:17.544059 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:22:17.637473 139696222607360 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 266.46
I0909 13:22:21.390927 139696222607360 replay_runner.py:36] Average training steps per second: 266.46
I0909 13:22:21.636349 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:22:21.727644 139696222607360 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 257.21
I0909 13:22:25.616146 139696222607360 replay_runner.py:36] Average training steps per second: 257.21
I0909 13:22:25.866643 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:22:25.961281 139696222607360 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 262.24
I0909 13:22:29.775038 139696222607360 replay_runner.py:36] Average training steps per second: 262.24
I0909 13:22:30.013619 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:22:30.105750 139696222607360 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 261.90
I0909 13:22:33.924567 139696222607360 replay_runner.py:36] Average training steps per second: 261.90
I0909 13:22:34.167692 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6

Steps executed: 339 Episode length: 171 Return: -171.0
INFO:tensorflow:Average training steps per second: 258.16
I0909 13:22:38.133003 139696222607360 replay_runner.py:36] Average training steps per second: 258.16
I0909 13:22:38.269613 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.50
INFO:tensorflow:Starting iteration 7

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 257.45
I0909 13:22:42.249469 139696222607360 replay_runner.py:36] Average training steps per second: 257.45
I0909 13:22:42.489888 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 725 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 268.13
I0909 13:22:46.308607 139696222607360 replay_runner.py:36] Average training steps per second: 268.13
I0909 13:22:46.602512 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.50
INFO:tensorflow:Starting iteration 9

Steps executed: 231 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 264.99
I0909 13:22:50.468800 139696222607360 replay_runner.py:36] Average training steps per second: 264.99
I0909 13:22:50.571001 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 10

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.90
I0909 13:22:54.422503 139696222607360 replay_runner.py:36] Average training steps per second: 265.90
I0909 13:22:54.666206 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 794 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 268.03
I0909 13:22:58.486705 139696222607360 replay_runner.py:36] Average training steps per second: 268.03
I0909 13:22:58.818230 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.67
INFO:tensorflow:Starting iteration 12

Steps executed: 234 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 269.07
I0909 13:23:02.623584 139696222607360 replay_runner.py:36] Average training steps per second: 269.07
I0909 13:23:02.736271 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.22
I0909 13:23:06.602062 139696222607360 replay_runner.py:36] Average training steps per second: 265.22
I0909 13:23:06.867451 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14

Steps executed: 207 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 261.80
I0909 13:23:10.780819 139696222607360 replay_runner.py:36] Average training steps per second: 261.80
I0909 13:23:10.874505 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 15

Steps executed: 212 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 266.21
I0909 13:23:14.719947 139696222607360 replay_runner.py:36] Average training steps per second: 266.21
I0909 13:23:14.803900 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 16

Steps executed: 212 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 267.75
I0909 13:23:18.636711 139696222607360 replay_runner.py:36] Average training steps per second: 267.75
I0909 13:23:18.724787 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 17

Steps executed: 213 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 264.59
I0909 13:23:22.600462 139696222607360 replay_runner.py:36] Average training steps per second: 264.59
I0909 13:23:22.694556 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 18

Steps executed: 217 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 257.55
I0909 13:23:26.673022 139696222607360 replay_runner.py:36] Average training steps per second: 257.55
I0909 13:23:26.767889 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 19

Steps executed: 272 Episode length: 84 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 260.61
I0909 13:23:30.697513 139696222607360 replay_runner.py:36] Average training steps per second: 260.61
I0909 13:23:30.812242 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 20

Steps executed: 215 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 263.18
I0909 13:23:34.702025 139696222607360 replay_runner.py:36] Average training steps per second: 263.18
I0909 13:23:34.793770 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 21

Steps executed: 225 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 264.91
I0909 13:23:38.662767 139696222607360 replay_runner.py:36] Average training steps per second: 264.91
I0909 13:23:38.754598 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 22

Steps executed: 214 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 243.14
I0909 13:23:42.974539 139696222607360 replay_runner.py:36] Average training steps per second: 243.14
I0909 13:23:43.067542 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 23

Steps executed: 289 Episode length: 94 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 262.51
I0909 13:23:46.974979 139696222607360 replay_runner.py:36] Average training steps per second: 262.51
I0909 13:23:47.101473 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.33
INFO:tensorflow:Starting iteration 24

Steps executed: 224 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 265.78
I0909 13:23:50.956903 139696222607360 replay_runner.py:36] Average training steps per second: 265.78
I0909 13:23:51.054857 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 25

Steps executed: 218 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 267.48
I0909 13:23:54.884458 139696222607360 replay_runner.py:36] Average training steps per second: 267.48
I0909 13:23:54.968405 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 26

Steps executed: 215 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 264.61
I0909 13:23:58.843282 139696222607360 replay_runner.py:36] Average training steps per second: 264.61
I0909 13:23:58.935348 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 27

Steps executed: 211 Episode length: 86 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 262.67
I0909 13:24:02.830763 139696222607360 replay_runner.py:36] Average training steps per second: 262.67
I0909 13:24:02.929038 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 28

Steps executed: 307 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 265.12
I0909 13:24:06.815154 139696222607360 replay_runner.py:36] Average training steps per second: 265.12
I0909 13:24:06.954240 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 285.34
I0909 13:24:10.545264 139696222607360 replay_runner.py:36] Average training steps per second: 285.34
I0909 13:24:10.784613 139696222607360 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.50