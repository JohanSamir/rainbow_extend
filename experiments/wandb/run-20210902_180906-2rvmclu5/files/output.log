Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 18:09:13.440223 140123653724160 run_experiment.py:549] Creating TrainRunner ...
I0902 18:09:13.450283 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:13.450469 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:13.450552 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:13.450615 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:13.450679 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:13.450739 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:13.450787 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:13.450833 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:13.450884 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:13.450961 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:13.451129 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:13.451209 140123653724160 dqn_agent.py:283] 	 seed: 1630606153450230
I0902 18:09:13.454086 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:13.454443 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:13.454675 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:13.454789 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:13.454870 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:13.454975 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:13.455085 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:13.455449 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:13.455547 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:13.496999 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:13.987514 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:14.004064 140123653724160 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:09:14.013616 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:14.013910 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:14.014073 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:14.014159 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:14.014338 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:14.014612 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:14.015022 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:14.015192 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:14.015354 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:14.015497 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:14.015620 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:14.015754 140123653724160 dqn_agent.py:283] 	 seed: 1630606154013569
I0902 18:09:14.018908 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:14.019146 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:14.019335 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:14.019464 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:14.019597 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:14.019717 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:14.019957 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:14.020125 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:14.020261 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:14.057512 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:14.081534 140123653724160 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:09:14.082173 140123653724160 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 141.64
I0902 18:09:21.142878 140123653724160 replay_runner.py:36] Average training steps per second: 141.64
I0902 18:09:22.672873 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 300 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 194.31
I0902 18:09:28.050028 140123653724160 replay_runner.py:36] Average training steps per second: 194.31
I0902 18:09:28.325275 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.00
INFO:tensorflow:Starting iteration 2

Steps executed: 219 Episode length: 219 Return: -218.0
INFO:tensorflow:Average training steps per second: 194.49
I0902 18:09:33.711206 140123653724160 replay_runner.py:36] Average training steps per second: 194.49
I0902 18:09:33.890136 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.00
INFO:tensorflow:Starting iteration 3
I0902 18:09:34.130331 140123653724160 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.68
I0902 18:09:39.189423 140123653724160 replay_runner.py:36] Average training steps per second: 197.68
I0902 18:09:39.393110 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 4

Steps executed: 242 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 198.28
I0902 18:09:44.680496 140123653724160 replay_runner.py:36] Average training steps per second: 198.28

Steps executed: 400 Episode length: 400 Return: -399.0
INFO:tensorflow:Starting iteration 5

Steps executed: 205 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 195.89
I0902 18:09:50.507572 140123653724160 replay_runner.py:36] Average training steps per second: 195.89
I0902 18:09:50.674445 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 6

Steps executed: 238 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 192.20
I0902 18:09:56.117033 140123653724160 replay_runner.py:36] Average training steps per second: 192.20
I0902 18:09:56.316791 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 7

Steps executed: 224 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 196.73
I0902 18:10:01.643765 140123653724160 replay_runner.py:36] Average training steps per second: 196.73
I0902 18:10:01.833285 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 8

Steps executed: 177 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 195.30

Steps executed: 677 Episode length: 500 Return: -500.0
I0902 18:10:07.755018 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.70
I0902 18:10:13.019208 140123653724160 replay_runner.py:36] Average training steps per second: 198.70
I0902 18:10:13.468237 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 18:10:13.718411 140123653724160 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 196.30
I0902 18:10:18.812893 140123653724160 replay_runner.py:36] Average training steps per second: 196.30
I0902 18:10:19.227371 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 18:10:19.469250 140123653724160 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 194.34
I0902 18:10:24.615419 140123653724160 replay_runner.py:36] Average training steps per second: 194.34
I0902 18:10:25.047685 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 18:10:25.292459 140123653724160 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 194.02
I0902 18:10:30.446860 140123653724160 replay_runner.py:36] Average training steps per second: 194.02
I0902 18:10:30.897644 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 197.40
I0902 18:10:36.217173 140123653724160 replay_runner.py:36] Average training steps per second: 197.40
I0902 18:10:36.400192 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 14

Steps executed: 507 Episode length: 410 Return: -409.0
INFO:tensorflow:Average training steps per second: 191.73
I0902 18:10:41.903971 140123653724160 replay_runner.py:36] Average training steps per second: 191.73
I0902 18:10:42.351997 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.50
INFO:tensorflow:Starting iteration 15

Steps executed: 150 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 201.01
I0902 18:10:47.572629 140123653724160 replay_runner.py:36] Average training steps per second: 201.01

Steps executed: 279 Episode length: 129 Return: -128.0
INFO:tensorflow:Starting iteration 16

Steps executed: 147 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 195.43
I0902 18:10:53.176175 140123653724160 replay_runner.py:36] Average training steps per second: 195.43
I0902 18:10:53.358514 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.00
INFO:tensorflow:Starting iteration 17


Steps executed: 220 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 206.32
I0902 18:10:58.428898 140123653724160 replay_runner.py:36] Average training steps per second: 206.32
I0902 18:10:58.613925 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 18

Steps executed: 248 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 213.38
I0902 18:11:03.547638 140123653724160 replay_runner.py:36] Average training steps per second: 213.38
I0902 18:11:03.733879 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 19

Steps executed: 245 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 215.62
I0902 18:11:08.596618 140123653724160 replay_runner.py:36] Average training steps per second: 215.62
I0902 18:11:08.784911 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 228.44
I0902 18:11:13.392072 140123653724160 replay_runner.py:36] Average training steps per second: 228.44
I0902 18:11:13.583524 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 219.92
I0902 18:11:18.352268 140123653724160 replay_runner.py:36] Average training steps per second: 219.92
I0902 18:11:18.520770 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 22

Steps executed: 235 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 228.73
I0902 18:11:23.103316 140123653724160 replay_runner.py:36] Average training steps per second: 228.73
I0902 18:11:23.281716 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 23

Steps executed: 288 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 231.03
I0902 18:11:27.834041 140123653724160 replay_runner.py:36] Average training steps per second: 231.03
I0902 18:11:28.027748 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.00
INFO:tensorflow:Starting iteration 24

Steps executed: 269 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 229.00
I0902 18:11:32.666383 140123653724160 replay_runner.py:36] Average training steps per second: 229.00
I0902 18:11:32.859758 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 241.46
I0902 18:11:37.215777 140123653724160 replay_runner.py:36] Average training steps per second: 241.46
I0902 18:11:37.559123 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 243 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 231.08
I0902 18:11:42.103521 140123653724160 replay_runner.py:36] Average training steps per second: 231.08
I0902 18:11:42.254076 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 27

Steps executed: 572 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 246.23
I0902 18:11:46.519570 140123653724160 replay_runner.py:36] Average training steps per second: 246.23
I0902 18:11:46.903150 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.50
INFO:tensorflow:Starting iteration 28

Steps executed: 228 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 242.02
I0902 18:11:51.257308 140123653724160 replay_runner.py:36] Average training steps per second: 242.02
I0902 18:11:51.413955 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00
INFO:tensorflow:Starting iteration 29
I0902 18:11:51.611841 140123653724160 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 238.79
I0902 18:11:55.800027 140123653724160 replay_runner.py:36] Average training steps per second: 238.79

Done fixed training!Episode length: 76 Return: -75.0.0