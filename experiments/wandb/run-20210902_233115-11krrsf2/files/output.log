Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0902 23:31:21.997061 140527680751616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:31:22.005315 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:22.005514 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:22.005630 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:22.005717 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:22.005796 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:22.005875 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:22.005938 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:22.006020 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:22.006114 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:22.006234 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:22.006347 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:22.006438 140527680751616 dqn_agent.py:283] 	 seed: 1630625482005258
I0902 23:31:22.009266 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:22.009413 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:22.009501 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:22.009626 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:22.009736 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:22.009801 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:22.009861 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:22.009918 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:22.009976 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:22.047918 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:22.473428 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:22.510630 140527680751616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:31:22.519375 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:22.519617 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:22.519756 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:22.519851 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:22.519979 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:22.520146 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:22.520232 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:22.520378 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:22.520538 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:22.520687 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:22.520833 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:22.520964 140527680751616 dqn_agent.py:283] 	 seed: 1630625482519311
I0902 23:31:22.523970 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:22.524232 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:22.524396 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:22.524495 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:22.524617 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:22.524744 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:22.524852 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:22.524923 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:22.524993 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:22.558273 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:22.578184 140527680751616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:31:22.578402 140527680751616 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.84
I0902 23:31:29.530702 140527680751616 replay_runner.py:36] Average training steps per second: 143.84
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:31:30.868772 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 487 Episode length: 383 Return: -382.0
INFO:tensorflow:Average training steps per second: 204.30
I0902 23:31:35.982948 140527680751616 replay_runner.py:36] Average training steps per second: 204.30
I0902 23:31:36.394633 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.50
INFO:tensorflow:Starting iteration 2
I0902 23:31:36.635298 140527680751616 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 207.09

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:31:41.870146 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:31:42.102111 140527680751616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.57
I0902 23:31:47.113363 140527680751616 replay_runner.py:36] Average training steps per second: 199.57
I0902 23:31:47.534070 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 23:31:47.776218 140527680751616 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 200.87
I0902 23:31:52.755216 140527680751616 replay_runner.py:36] Average training steps per second: 200.87
I0902 23:31:53.161930 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:31:53.402453 140527680751616 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 202.58
I0902 23:31:58.339242 140527680751616 replay_runner.py:36] Average training steps per second: 202.58
I0902 23:31:58.784791 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 23:31:59.038442 140527680751616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.84
I0902 23:32:04.119124 140527680751616 replay_runner.py:36] Average training steps per second: 196.84
I0902 23:32:04.557383 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 71 Episode length: 71 Return: -70.00.0
INFO:tensorflow:Average training steps per second: 197.41

Steps executed: 279 Episode length: 119 Return: -118.0
I0902 23:32:10.108181 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.48
I0902 23:32:15.491821 140527680751616 replay_runner.py:36] Average training steps per second: 194.48
I0902 23:32:15.900419 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 682 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.43
I0902 23:32:21.301673 140527680751616 replay_runner.py:36] Average training steps per second: 193.43
I0902 23:32:21.869260 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.67
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.25
I0902 23:32:27.209295 140527680751616 replay_runner.py:36] Average training steps per second: 196.25
I0902 23:32:27.603775 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 23:32:27.835741 140527680751616 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 194.52
I0902 23:32:32.976880 140527680751616 replay_runner.py:36] Average training steps per second: 194.52
I0902 23:32:33.433346 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 281 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 200.50
I0902 23:32:38.670635 140527680751616 replay_runner.py:36] Average training steps per second: 200.50
I0902 23:32:38.906183 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 13
I0902 23:32:39.148626 140527680751616 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.62

Steps executed: 242 Episode length: 242 Return: -241.0
I0902 23:32:44.483019 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.00
INFO:tensorflow:Starting iteration 14
I0902 23:32:44.740383 140527680751616 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.06
I0902 23:32:49.764649 140527680751616 replay_runner.py:36] Average training steps per second: 199.06
I0902 23:32:49.933784 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -68.00
INFO:tensorflow:Starting iteration 15


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.57
I0902 23:32:55.288857 140527680751616 replay_runner.py:36] Average training steps per second: 195.57
I0902 23:32:55.721655 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 286 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 190.11
I0902 23:33:01.231796 140527680751616 replay_runner.py:36] Average training steps per second: 190.11
I0902 23:33:01.478352 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 17

Steps executed: 203 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 200.48
I0902 23:33:06.709141 140527680751616 replay_runner.py:36] Average training steps per second: 200.48
I0902 23:33:06.876980 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.10
I0902 23:33:12.211876 140527680751616 replay_runner.py:36] Average training steps per second: 196.10
I0902 23:33:12.631695 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 175 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 201.32
I0902 23:33:17.841417 140527680751616 replay_runner.py:36] Average training steps per second: 201.32

Steps executed: 298 Episode length: 123 Return: -122.0
INFO:tensorflow:Starting iteration 20

Steps executed: 429 Episode length: 260 Return: -259.0
INFO:tensorflow:Average training steps per second: 196.92
I0902 23:33:23.418259 140527680751616 replay_runner.py:36] Average training steps per second: 196.92
I0902 23:33:23.778041 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 197.79
I0902 23:33:29.074979 140527680751616 replay_runner.py:36] Average training steps per second: 197.79
I0902 23:33:29.256041 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 22

Steps executed: 201 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 193.84
I0902 23:33:34.658140 140527680751616 replay_runner.py:36] Average training steps per second: 193.84
I0902 23:33:34.824189 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 23

Steps executed: 137 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 198.48
I0902 23:33:40.102405 140527680751616 replay_runner.py:36] Average training steps per second: 198.48

Steps executed: 214 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Starting iteration 24

Steps executed: 250 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 209.12
I0902 23:33:45.304655 140527680751616 replay_runner.py:36] Average training steps per second: 209.12
I0902 23:33:45.506351 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 25

Steps executed: 264 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 200.79
I0902 23:33:50.720921 140527680751616 replay_runner.py:36] Average training steps per second: 200.79
I0902 23:33:50.928922 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 26

Steps executed: 281 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 209.95
I0902 23:33:55.939325 140527680751616 replay_runner.py:36] Average training steps per second: 209.95
I0902 23:33:56.180915 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 27

Steps executed: 618 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.39
I0902 23:34:01.420394 140527680751616 replay_runner.py:36] Average training steps per second: 201.39
I0902 23:34:01.912827 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.50
INFO:tensorflow:Starting iteration 28

Steps executed: 253 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 198.30
I0902 23:34:07.172171 140527680751616 replay_runner.py:36] Average training steps per second: 198.30
I0902 23:34:07.396275 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 195.21
I0902 23:34:12.749881 140527680751616 replay_runner.py:36] Average training steps per second: 195.21
I0902 23:34:12.935192 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33