Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 23:55:47.242401 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0902 23:55:47.253912 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:47.254185 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:47.254352 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:47.254493 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:47.254613 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:47.254724 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:55:47.254830 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:47.254945 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:47.255450 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:47.255685 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:47.255808 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:47.255948 139735608805376 dqn_agent.py:283] 	 seed: 1630626947253824
I0902 23:55:47.259067 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:47.259244 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:55:47.259337 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:47.259411 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:47.259478 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:47.259543 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:47.259635 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:47.259728 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:47.259780 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:47.299444 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:47.706944 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:47.720991 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:55:47.748505 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:47.748782 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:47.748992 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:47.749135 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:47.749671 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:47.749875 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:55:47.750016 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:47.750120 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:47.750197 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:47.750288 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:47.750395 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:47.750470 139735608805376 dqn_agent.py:283] 	 seed: 1630626947748438
I0902 23:55:47.753668 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:47.753871 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:55:47.754059 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:47.754175 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:47.754266 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:47.754341 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:47.754451 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:47.754799 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:47.754941 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:47.784640 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:47.806487 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:55:47.806840 139735608805376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 170.08
I0902 23:55:53.686978 139735608805376 replay_runner.py:36] Average training steps per second: 170.08
Steps executed: 226 Episode length: 101 Return: 4.96601553815293166
I0902 23:55:54.910475 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.52
INFO:tensorflow:Starting iteration 1

Steps executed: 247 Episode length: 140 Return: -244.37549882478686
INFO:tensorflow:Average training steps per second: 227.58
I0902 23:56:03.608473 139735608805376 replay_runner.py:36] Average training steps per second: 227.58
I0902 23:56:03.835529 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -577.77
INFO:tensorflow:Starting iteration 2

Steps executed: 274 Episode length: 150 Return: -229.85601883226957
INFO:tensorflow:Average training steps per second: 230.65
I0902 23:56:12.469577 139735608805376 replay_runner.py:36] Average training steps per second: 230.65
I0902 23:56:12.704253 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.07
INFO:tensorflow:Starting iteration 3
I0902 23:56:17.073346 139735608805376 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 232.32

Steps executed: 776 Episode length: 776 Return: -466.65220557847267
I0902 23:56:23.174516 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.65
INFO:tensorflow:Starting iteration 4

Steps executed: 215 Episode length: 215 Return: -74.710601773952457
INFO:tensorflow:Average training steps per second: 227.70
I0902 23:56:31.967642 139735608805376 replay_runner.py:36] Average training steps per second: 227.70
I0902 23:56:32.193295 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.71
INFO:tensorflow:Starting iteration 5
I0902 23:56:36.521661 139735608805376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 221.49

Steps executed: 1000 Episode length: 1000 Return: -30.320630195150958
I0902 23:56:44.164412 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.32
INFO:tensorflow:Starting iteration 6
I0902 23:56:48.476355 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 223.94

Steps executed: 1000 Episode length: 1000 Return: 2.35382429840799158
I0902 23:56:55.720804 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: 2.35
INFO:tensorflow:Starting iteration 7
I0902 23:56:59.986852 139735608805376 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 227.86

Steps executed: 819 Episode length: 819 Return: -332.3740458529057458
I0902 23:57:06.727360 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.37
INFO:tensorflow:Starting iteration 8

Steps executed: 403 Episode length: 403 Return: -282.1512039112536458
INFO:tensorflow:Average training steps per second: 227.38
I0902 23:57:15.426376 139735608805376 replay_runner.py:36] Average training steps per second: 227.38
I0902 23:57:16.087101 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.15
INFO:tensorflow:Starting iteration 9

Steps executed: 189 Episode length: 189 Return: -299.3539738979666458
INFO:tensorflow:Average training steps per second: 230.26
I0902 23:57:24.745863 139735608805376 replay_runner.py:36] Average training steps per second: 230.26

Steps executed: 479 Episode length: 290 Return: -332.1995776224126458
INFO:tensorflow:Starting iteration 10
I0902 23:57:29.638403 139735608805376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 234.22

Steps executed: 824 Episode length: 824 Return: -288.6294934569533658
I0902 23:57:35.577477 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.63
INFO:tensorflow:Starting iteration 11
I0902 23:57:39.919829 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 228.25

Steps executed: 1000 Episode length: 1000 Return: -392.32685850023864
I0902 23:57:47.853042 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.33
INFO:tensorflow:Starting iteration 12
I0902 23:57:52.115627 139735608805376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 239.69

Steps executed: 959 Episode length: 959 Return: -317.0920246430678864
I0902 23:57:58.364915 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.09
INFO:tensorflow:Starting iteration 13

Steps executed: 229 Episode length: 229 Return: -150.5932765244843864
INFO:tensorflow:Average training steps per second: 250.03
I0902 23:58:06.286726 139735608805376 replay_runner.py:36] Average training steps per second: 250.03
I0902 23:58:06.513939 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.59
INFO:tensorflow:Starting iteration 14
I0902 23:58:10.634955 139735608805376 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 257.10

Steps executed: 986 Episode length: 986 Return: -449.2052834369103564
I0902 23:58:17.018203 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.21
INFO:tensorflow:Starting iteration 15

Steps executed: 233 Episode length: 233 Return: -480.6902044338473564
INFO:tensorflow:Average training steps per second: 248.78
I0902 23:58:25.131217 139735608805376 replay_runner.py:36] Average training steps per second: 248.78
I0902 23:58:25.358284 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.69
INFO:tensorflow:Starting iteration 16
I0902 23:58:29.502611 139735608805376 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 248.71

Steps executed: 330 Episode length: 175 Return: -110.0655474009423564
I0902 23:58:33.783540 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.47
INFO:tensorflow:Starting iteration 17

Steps executed: 275 Episode length: 128 Return: -139.8071779219164664
INFO:tensorflow:Average training steps per second: 254.70
I0902 23:58:41.733785 139735608805376 replay_runner.py:36] Average training steps per second: 254.70
I0902 23:58:41.962471 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.29
INFO:tensorflow:Starting iteration 18

Steps executed: 210 Episode length: 210 Return: -100.4589921823282564
INFO:tensorflow:Average training steps per second: 264.44
I0902 23:58:49.695141 139735608805376 replay_runner.py:36] Average training steps per second: 264.44
I0902 23:58:49.877953 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.46
INFO:tensorflow:Starting iteration 19
I0902 23:58:53.732943 139735608805376 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 274.49

Steps executed: 243 Episode length: 62 Return: -101.44353489818728564
I0902 23:58:57.540691 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.08
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 87 Return: -418.35752357929846564
INFO:tensorflow:Average training steps per second: 280.59
I0902 23:59:04.864176 139735608805376 replay_runner.py:36] Average training steps per second: 280.59
I0902 23:59:04.993278 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.46
INFO:tensorflow:Starting iteration 21

Steps executed: 233 Episode length: 110 Return: -415.4562947092933564
INFO:tensorflow:Average training steps per second: 278.94
I0902 23:59:12.174037 139735608805376 replay_runner.py:36] Average training steps per second: 278.94
I0902 23:59:12.335548 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.62
INFO:tensorflow:Starting iteration 22
I0902 23:59:15.819804 139735608805376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 286.55
I0902 23:59:19.310370 139735608805376 replay_runner.py:36] Average training steps per second: 286.55

Steps executed: 242 Episode length: 117 Return: -356.6247712256591464
INFO:tensorflow:Starting iteration 23

Steps executed: 239 Episode length: 111 Return: -698.9919668980133464
INFO:tensorflow:Average training steps per second: 293.14
I0902 23:59:26.332163 139735608805376 replay_runner.py:36] Average training steps per second: 293.14
I0902 23:59:26.492286 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -542.71
INFO:tensorflow:Starting iteration 24

Steps executed: 69 Episode length: 69 Return: -180.343866784056423464
INFO:tensorflow:Average training steps per second: 291.12

Steps executed: 547 Episode length: 478 Return: -132.9407725476401464
I0902 23:59:33.946867 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.64
INFO:tensorflow:Starting iteration 25

Steps executed: 264 Episode length: 73 Return: -96.728235554826684464
INFO:tensorflow:Average training steps per second: 306.27
I0902 23:59:40.574717 139735608805376 replay_runner.py:36] Average training steps per second: 306.27
I0902 23:59:40.724903 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.43
INFO:tensorflow:Starting iteration 26

Steps executed: 271 Episode length: 144 Return: -46.82176905837991464
INFO:tensorflow:Average training steps per second: 305.26
I0902 23:59:47.386539 139735608805376 replay_runner.py:36] Average training steps per second: 305.26
I0902 23:59:47.544955 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -17.33
INFO:tensorflow:Starting iteration 27

Steps executed: 211 Episode length: 69 Return: -379.65654775481033864
INFO:tensorflow:Average training steps per second: 306.33
I0902 23:59:54.168437 139735608805376 replay_runner.py:36] Average training steps per second: 306.33
I0902 23:59:54.289985 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.48
INFO:tensorflow:Starting iteration 28

Steps executed: 381 Episode length: 266 Return: -73.57675498258428664
INFO:tensorflow:Average training steps per second: 299.32
I0903 00:00:00.812901 139735608805376 replay_runner.py:36] Average training steps per second: 299.32
I0903 00:00:01.098724 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.01
INFO:tensorflow:Starting iteration 29
I0903 00:00:04.271088 139735608805376 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 287.70
I0903 00:00:07.747152 139735608805376 replay_runner.py:36] Average training steps per second: 287.70


Done fixed training!Episode length: 106 Return: -426.6160957842423664