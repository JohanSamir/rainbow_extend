Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 23:56:56.665889 140268994136064 run_experiment.py:549] Creating TrainRunner ...
I0901 23:56:56.675252 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:56:56.675530 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:56:56.675672 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:56:56.675792 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:56:56.675907 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:56:56.676017 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:56:56.676123 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:56:56.676268 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:56:56.676460 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:56:56.676577 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:56:56.676687 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:56:56.676786 140268994136064 dqn_agent.py:283] 	 seed: 1630540616675188
I0901 23:56:56.679777 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:56:56.679982 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:56:56.680127 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:56:56.680292 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:56:56.680421 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:56:56.680540 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:56:56.680766 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:56:56.680899 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:56:56.681022 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:56:56.724638 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:57.165988 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:57.179813 140268994136064 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:56:57.188630 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:56:57.188984 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:56:57.189403 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:56:57.189565 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:56:57.189701 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:56:57.190045 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:56:57.190214 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:56:57.190343 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:56:57.190577 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:56:57.190808 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:56:57.190966 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:56:57.191075 140268994136064 dqn_agent.py:283] 	 seed: 1630540617188555
I0901 23:56:57.193770 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:56:57.193908 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:56:57.194004 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:56:57.194087 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:56:57.194171 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:56:57.194278 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:56:57.194344 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:56:57.194403 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:56:57.194475 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:56:57.226323 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:57.247128 140268994136064 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:56:57.247340 140268994136064 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.35
I0901 23:57:04.127279 140268994136064 replay_runner.py:36] Average training steps per second: 145.35
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:57:05.516583 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 283 Episode length: 283 Return: -282.0
INFO:tensorflow:Average training steps per second: 195.66
I0901 23:57:10.880681 140268994136064 replay_runner.py:36] Average training steps per second: 195.66
I0901 23:57:11.114468 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.00
INFO:tensorflow:Starting iteration 2

Steps executed: 115 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 205.57

Steps executed: 272 Episode length: 157 Return: -156.0
I0901 23:57:16.443333 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 3

Steps executed: 321 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 200.00
I0901 23:57:21.677911 140268994136064 replay_runner.py:36] Average training steps per second: 200.00
I0901 23:57:21.956664 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 4

Steps executed: 345 Episode length: 345 Return: -344.0
INFO:tensorflow:Average training steps per second: 197.67
I0901 23:57:27.269091 140268994136064 replay_runner.py:36] Average training steps per second: 197.67
I0901 23:57:27.540583 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.00
INFO:tensorflow:Starting iteration 5

Steps executed: 278 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 194.25
I0901 23:57:32.916660 140268994136064 replay_runner.py:36] Average training steps per second: 194.25
I0901 23:57:33.163080 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 6
I0901 23:57:33.419804 140268994136064 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 198.31

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:57:38.882586 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:57:39.122405 140268994136064 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 200.59
I0901 23:57:44.108178 140268994136064 replay_runner.py:36] Average training steps per second: 200.59
I0901 23:57:44.520380 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:57:44.755130 140268994136064 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.27
I0901 23:57:49.850416 140268994136064 replay_runner.py:36] Average training steps per second: 196.27
I0901 23:57:50.282860 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 23:57:50.524385 140268994136064 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 199.60
I0901 23:57:55.534973 140268994136064 replay_runner.py:36] Average training steps per second: 199.60
I0901 23:57:55.951302 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 253 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 193.21
I0901 23:58:01.347136 140268994136064 replay_runner.py:36] Average training steps per second: 193.21
I0901 23:58:01.566474 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.88
I0901 23:58:06.893554 140268994136064 replay_runner.py:36] Average training steps per second: 196.88
I0901 23:58:07.326938 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 179 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 198.03
I0901 23:58:12.627567 140268994136064 replay_runner.py:36] Average training steps per second: 198.03

Steps executed: 255 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Starting iteration 13

Steps executed: 587 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.32
I0901 23:58:18.205326 140268994136064 replay_runner.py:36] Average training steps per second: 195.32
I0901 23:58:18.708636 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.00
INFO:tensorflow:Starting iteration 14

Steps executed: 598 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.48
I0901 23:58:24.065198 140268994136064 replay_runner.py:36] Average training steps per second: 195.48
I0901 23:58:24.550068 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.50
INFO:tensorflow:Starting iteration 15

Steps executed: 526 Episode length: 398 Return: -397.0
INFO:tensorflow:Average training steps per second: 193.76
I0901 23:58:29.946282 140268994136064 replay_runner.py:36] Average training steps per second: 193.76
I0901 23:58:30.383409 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.00
INFO:tensorflow:Starting iteration 16

Steps executed: 269 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 197.80
I0901 23:58:35.679698 140268994136064 replay_runner.py:36] Average training steps per second: 197.80
I0901 23:58:35.908995 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 17

Steps executed: 291 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 197.14
I0901 23:58:41.230655 140268994136064 replay_runner.py:36] Average training steps per second: 197.14
I0901 23:58:41.480923 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 18

Steps executed: 211 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.84
I0901 23:58:46.704247 140268994136064 replay_runner.py:36] Average training steps per second: 200.84
I0901 23:58:46.880000 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 19

Steps executed: 210 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 203.96
I0901 23:58:52.028637 140268994136064 replay_runner.py:36] Average training steps per second: 203.96
I0901 23:58:52.192272 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 195.64
I0901 23:58:57.530856 140268994136064 replay_runner.py:36] Average training steps per second: 195.64
I0901 23:58:57.700048 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.00
INFO:tensorflow:Starting iteration 21
I0901 23:58:57.932973 140268994136064 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 201.48

Steps executed: 255 Episode length: 97 Return: -96.0.0
I0901 23:59:03.100878 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 22

Steps executed: 213 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 199.53
I0901 23:59:08.342429 140268994136064 replay_runner.py:36] Average training steps per second: 199.53
I0901 23:59:08.515357 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 23

Steps executed: 284 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 196.73
I0901 23:59:13.837234 140268994136064 replay_runner.py:36] Average training steps per second: 196.73
I0901 23:59:14.076718 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 24

Steps executed: 271 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 196.11
I0901 23:59:19.424872 140268994136064 replay_runner.py:36] Average training steps per second: 196.11
I0901 23:59:19.637122 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 25

Steps executed: 85 Episode length: 85 Return: -84.00.0
INFO:tensorflow:Average training steps per second: 198.35
I0901 23:59:24.916320 140268994136064 replay_runner.py:36] Average training steps per second: 198.35

Steps executed: 206 Episode length: 121 Return: -120.0
INFO:tensorflow:Starting iteration 26

Steps executed: 226 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 197.27
I0901 23:59:30.381913 140268994136064 replay_runner.py:36] Average training steps per second: 197.27
I0901 23:59:30.581884 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 27

Steps executed: 263 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 199.46
I0901 23:59:35.853859 140268994136064 replay_runner.py:36] Average training steps per second: 199.46
I0901 23:59:36.055333 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 28

Steps executed: 84 Episode length: 84 Return: -83.00.0
INFO:tensorflow:Average training steps per second: 208.30
I0901 23:59:41.086870 140268994136064 replay_runner.py:36] Average training steps per second: 208.30

Steps executed: 235 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 207.63
I0901 23:59:46.327801 140268994136064 replay_runner.py:36] Average training steps per second: 207.63
I0901 23:59:46.504565 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00