Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0828 10:23:24.943339 140078257940480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:23:24.955341 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:23:24.955543 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:23:24.955637 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:23:24.955707 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:23:24.955771 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:23:24.955883 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:23:24.956136 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:23:24.956254 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:23:24.956363 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:23:24.956459 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:23:24.956537 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:23:24.956753 140078257940480 dqn_agent.py:283] 	 seed: 1630146204955279
I0828 10:23:24.959756 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:23:24.959951 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:23:24.960080 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:23:24.960167 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:23:24.960242 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:23:24.960315 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:23:24.960404 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:23:24.960566 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:23:24.960761 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:23:25.001299 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:25.419187 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:25.717061 140078257940480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:23:25.726741 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:23:25.727061 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:23:25.727362 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:23:25.727693 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:23:25.727890 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:23:25.728051 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:23:25.728161 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:23:25.728283 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:23:25.728379 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:23:25.728520 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:23:25.728653 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:23:25.728951 140078257940480 dqn_agent.py:283] 	 seed: 1630146205726688
I0828 10:23:25.732101 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:23:25.732313 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:23:25.732590 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:23:25.732770 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:23:25.732893 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:23:25.733123 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:23:25.733235 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:23:25.733334 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:23:25.733444 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:23:25.768673 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:25.789655 140078257940480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:23:25.789877 140078257940480 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.99
I0828 10:23:31.963479 140078257940480 replay_runner.py:36] Average training steps per second: 161.99
Steps executed: 287 Episode length: 91 Return: -124.24318651892787
I0828 10:23:33.165145 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.63
INFO:tensorflow:Starting iteration 1

Steps executed: 246 Episode length: 73 Return: -67.570312360995398
INFO:tensorflow:Average training steps per second: 221.44
I0828 10:23:42.116038 140078257940480 replay_runner.py:36] Average training steps per second: 221.44
I0828 10:23:42.275308 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.59
INFO:tensorflow:Starting iteration 2

Steps executed: 258 Episode length: 73 Return: -482.10278873468364
INFO:tensorflow:Average training steps per second: 220.52
I0828 10:23:51.200336 140078257940480 replay_runner.py:36] Average training steps per second: 220.52
I0828 10:23:51.395070 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.78
INFO:tensorflow:Starting iteration 3

Steps executed: 250 Episode length: 60 Return: -455.17347908038076
INFO:tensorflow:Average training steps per second: 223.35
I0828 10:24:00.276139 140078257940480 replay_runner.py:36] Average training steps per second: 223.35
I0828 10:24:00.492610 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -513.48
INFO:tensorflow:Starting iteration 4

Steps executed: 281 Episode length: 90 Return: -205.33404640994564
INFO:tensorflow:Average training steps per second: 217.33
I0828 10:24:09.375605 140078257940480 replay_runner.py:36] Average training steps per second: 217.33
I0828 10:24:09.572324 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.56
INFO:tensorflow:Starting iteration 5

Steps executed: 217 Episode length: 88 Return: -161.44833308833294
INFO:tensorflow:Average training steps per second: 227.23
I0828 10:24:18.245735 140078257940480 replay_runner.py:36] Average training steps per second: 227.23
I0828 10:24:18.377799 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.41
INFO:tensorflow:Starting iteration 6
I0828 10:24:22.702028 140078257940480 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 241.20

Steps executed: 290 Episode length: 178 Return: -876.4603785487649
I0828 10:24:27.141294 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -799.86
INFO:tensorflow:Starting iteration 7

Steps executed: 207 Episode length: 67 Return: -628.75954351029879
INFO:tensorflow:Average training steps per second: 238.22
I0828 10:24:35.582749 140078257940480 replay_runner.py:36] Average training steps per second: 238.22
I0828 10:24:35.730436 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -637.87
INFO:tensorflow:Starting iteration 8

Steps executed: 256 Episode length: 62 Return: -563.36056707320619
INFO:tensorflow:Average training steps per second: 252.01
I0828 10:24:43.798026 140078257940480 replay_runner.py:36] Average training steps per second: 252.01
I0828 10:24:44.008477 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.29
INFO:tensorflow:Starting iteration 9

Steps executed: 215 Episode length: 60 Return: -161.66356234441359
INFO:tensorflow:Average training steps per second: 232.77
I0828 10:24:52.508542 140078257940480 replay_runner.py:36] Average training steps per second: 232.77
I0828 10:24:52.646156 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.39
INFO:tensorflow:Starting iteration 10

Steps executed: 245 Episode length: 83 Return: -775.90120667472549
INFO:tensorflow:Average training steps per second: 223.30
I0828 10:25:01.364078 140078257940480 replay_runner.py:36] Average training steps per second: 223.30
I0828 10:25:01.575767 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -545.34
INFO:tensorflow:Starting iteration 11

Steps executed: 247 Episode length: 73 Return: -464.65192049750759
INFO:tensorflow:Average training steps per second: 223.94
I0828 10:25:10.449875 140078257940480 replay_runner.py:36] Average training steps per second: 223.94
I0828 10:25:10.670555 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.54
INFO:tensorflow:Starting iteration 12

Steps executed: 279 Episode length: 81 Return: -126.21876533058738
INFO:tensorflow:Average training steps per second: 221.20
I0828 10:25:19.610955 140078257940480 replay_runner.py:36] Average training steps per second: 221.20
I0828 10:25:19.804897 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.53
INFO:tensorflow:Starting iteration 13

Steps executed: 207 Episode length: 65 Return: -616.52363051970278
INFO:tensorflow:Average training steps per second: 217.87
I0828 10:25:28.687853 140078257940480 replay_runner.py:36] Average training steps per second: 217.87
I0828 10:25:28.869204 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.40
INFO:tensorflow:Starting iteration 14

Steps executed: 220 Episode length: 63 Return: -465.14074751365978
INFO:tensorflow:Average training steps per second: 214.01
I0828 10:25:37.976954 140078257940480 replay_runner.py:36] Average training steps per second: 214.01
I0828 10:25:38.174866 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.81
INFO:tensorflow:Starting iteration 15

Steps executed: 257 Episode length: 73 Return: -440.66332152164918
INFO:tensorflow:Average training steps per second: 217.02
I0828 10:25:47.174617 140078257940480 replay_runner.py:36] Average training steps per second: 217.02
I0828 10:25:47.387574 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.83
INFO:tensorflow:Starting iteration 16

Steps executed: 238 Episode length: 72 Return: -685.08319054914588
INFO:tensorflow:Average training steps per second: 222.53
I0828 10:25:56.259004 140078257940480 replay_runner.py:36] Average training steps per second: 222.53
I0828 10:25:56.463278 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.28
INFO:tensorflow:Starting iteration 17

Steps executed: 202 Episode length: 68 Return: -459.69618236490598
INFO:tensorflow:Average training steps per second: 221.32
I0828 10:26:05.325793 140078257940480 replay_runner.py:36] Average training steps per second: 221.32
I0828 10:26:05.491617 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -528.06
INFO:tensorflow:Starting iteration 18

Steps executed: 274 Episode length: 154 Return: -1160.9964365143194
INFO:tensorflow:Average training steps per second: 218.45
I0828 10:26:14.454906 140078257940480 replay_runner.py:36] Average training steps per second: 218.45
I0828 10:26:14.711333 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -735.56
INFO:tensorflow:Starting iteration 19

Steps executed: 225 Episode length: 79 Return: -740.596604692285494
INFO:tensorflow:Average training steps per second: 221.42
I0828 10:26:23.617159 140078257940480 replay_runner.py:36] Average training steps per second: 221.42
I0828 10:26:23.828690 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -733.96
INFO:tensorflow:Starting iteration 20

Steps executed: 244 Episode length: 52 Return: -121.113016940085224
INFO:tensorflow:Average training steps per second: 220.00
I0828 10:26:32.736363 140078257940480 replay_runner.py:36] Average training steps per second: 220.00
I0828 10:26:32.928049 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.28
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 58 Return: -507.903000472037324
INFO:tensorflow:Average training steps per second: 218.94
I0828 10:26:41.822016 140078257940480 replay_runner.py:36] Average training steps per second: 218.94
I0828 10:26:42.015906 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.36
INFO:tensorflow:Starting iteration 22

Steps executed: 148 Episode length: 75 Return: -653.041113451350524
INFO:tensorflow:Average training steps per second: 219.00
I0828 10:26:50.919901 140078257940480 replay_runner.py:36] Average training steps per second: 219.00

Steps executed: 215 Episode length: 67 Return: -588.207334755469224
INFO:tensorflow:Starting iteration 23

Steps executed: 258 Episode length: 78 Return: -770.305778822549654
INFO:tensorflow:Average training steps per second: 217.40
I0828 10:27:00.087554 140078257940480 replay_runner.py:36] Average training steps per second: 217.40
I0828 10:27:00.295702 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -593.95
INFO:tensorflow:Starting iteration 24
I0828 10:27:04.617506 140078257940480 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.94
I0828 10:27:09.144039 140078257940480 replay_runner.py:36] Average training steps per second: 220.94

Steps executed: 207 Episode length: 55 Return: -433.773207738385754
INFO:tensorflow:Starting iteration 25

Steps executed: 211 Episode length: 86 Return: -152.966200447216584
INFO:tensorflow:Average training steps per second: 217.88
I0828 10:27:18.266221 140078257940480 replay_runner.py:36] Average training steps per second: 217.88
I0828 10:27:18.400000 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.49
INFO:tensorflow:Starting iteration 26

Steps executed: 250 Episode length: 88 Return: -387.326974307519834
INFO:tensorflow:Average training steps per second: 226.25
I0828 10:27:26.973630 140078257940480 replay_runner.py:36] Average training steps per second: 226.25
I0828 10:27:27.191121 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -676.20
INFO:tensorflow:Starting iteration 27

Steps executed: 206 Episode length: 56 Return: -453.761356535377334
INFO:tensorflow:Average training steps per second: 221.25
I0828 10:27:35.932545 140078257940480 replay_runner.py:36] Average training steps per second: 221.25
I0828 10:27:36.098437 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -621.17
INFO:tensorflow:Starting iteration 28

Steps executed: 217 Episode length: 72 Return: -709.570183134051734
INFO:tensorflow:Average training steps per second: 229.55
I0828 10:27:44.711365 140078257940480 replay_runner.py:36] Average training steps per second: 229.55
I0828 10:27:44.882957 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -643.07
INFO:tensorflow:Starting iteration 29

Steps executed: 237 Episode length: 73 Return: -430.605289248416334
INFO:tensorflow:Average training steps per second: 245.82
I0828 10:27:53.139464 140078257940480 replay_runner.py:36] Average training steps per second: 245.82

Done fixed training!Episode length: 73 Return: -430.605289248416334