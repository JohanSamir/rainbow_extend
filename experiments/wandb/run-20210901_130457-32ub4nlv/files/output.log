I0901 13:05:04.192435 139982171817984 run_experiment.py:549] Creating TrainRunner ...
I0901 13:05:04.200513 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:05:04.200656 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:05:04.200730 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:05:04.200792 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:05:04.200848 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 13:05:04.200930 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:05:04.201047 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:05:04.201108 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:05:04.201207 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:05:04.201287 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 13:05:04.201375 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:05:04.201480 139982171817984 dqn_agent.py:283] 	 seed: 1630501504200476
I0901 13:05:04.204379 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:05:04.204576 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:05:04.204720 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:05:04.204809 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:05:04.204896 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:05:04.204995 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:05:04.205108 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:05:04.205186 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:05:04.205270 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:05:04.237596 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:04.545372 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:04.558899 139982171817984 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:05:04.567477 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:05:04.567706 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:05:04.567845 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:05:04.567937 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:05:04.568062 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 13:05:04.568148 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:05:04.568232 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:05:04.568286 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:05:04.568359 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:05:04.568451 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 13:05:04.568599 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:05:04.568669 139982171817984 dqn_agent.py:283] 	 seed: 1630501504567431
I0901 13:05:04.570359 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:05:04.570483 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:05:04.570561 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:05:04.570630 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:05:04.570693 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:05:04.570757 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:05:04.570853 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:05:04.570928 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:05:04.570997 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:05:04.598209 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:04.616771 139982171817984 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:05:04.617051 139982171817984 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 197.55
I0901 13:05:09.679429 139982171817984 replay_runner.py:36] Average training steps per second: 197.55
I0901 13:05:10.801729 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.40
Steps executed: 331 Episode length: 189 Return: -11.203590180196437
INFO:tensorflow:Starting iteration 1
I0901 13:05:14.615818 139982171817984 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 272.85
I0901 13:05:18.281372 139982171817984 replay_runner.py:36] Average training steps per second: 272.85

Steps executed: 212 Episode length: 82 Return: -361.786434861613437
INFO:tensorflow:Starting iteration 2
I0901 13:05:22.135448 139982171817984 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 272.67
I0901 13:05:25.803297 139982171817984 replay_runner.py:36] Average training steps per second: 272.67

Steps executed: 214 Episode length: 90 Return: -638.861244720064577
INFO:tensorflow:Starting iteration 3

Steps executed: 314 Episode length: 314 Return: 181.037788955272367
INFO:tensorflow:Average training steps per second: 269.36
I0901 13:05:33.349459 139982171817984 replay_runner.py:36] Average training steps per second: 269.36
I0901 13:05:33.696784 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.04
INFO:tensorflow:Starting iteration 4

Steps executed: 221 Episode length: 148 Return: -69.919148097838567
INFO:tensorflow:Average training steps per second: 274.60
I0901 13:05:41.031689 139982171817984 replay_runner.py:36] Average training steps per second: 274.60
I0901 13:05:41.174583 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.92
INFO:tensorflow:Starting iteration 5

Steps executed: 300 Episode length: 143 Return: -161.19941763798187
INFO:tensorflow:Average training steps per second: 282.83
I0901 13:05:48.345819 139982171817984 replay_runner.py:36] Average training steps per second: 282.83
I0901 13:05:48.548169 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.87
INFO:tensorflow:Starting iteration 6

Steps executed: 225 Episode length: 65 Return: -180.910970060487677
INFO:tensorflow:Average training steps per second: 296.19
I0901 13:05:55.479685 139982171817984 replay_runner.py:36] Average training steps per second: 296.19
I0901 13:05:55.630389 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.31
INFO:tensorflow:Starting iteration 7

Steps executed: 237 Episode length: 129 Return: -202.35721266479555
INFO:tensorflow:Average training steps per second: 302.64
I0901 13:06:02.466366 139982171817984 replay_runner.py:36] Average training steps per second: 302.64
I0901 13:06:02.623693 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.69
INFO:tensorflow:Starting iteration 8

Steps executed: 257 Episode length: 137 Return: -241.01889654455813
INFO:tensorflow:Average training steps per second: 303.56
I0901 13:06:09.417664 139982171817984 replay_runner.py:36] Average training steps per second: 303.56
I0901 13:06:09.584677 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.51
INFO:tensorflow:Starting iteration 9
I0901 13:06:13.072627 139982171817984 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 305.80

Steps executed: 203 Episode length: 72 Return: -342.576155220515456
I0901 13:06:16.480031 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.34
INFO:tensorflow:Starting iteration 10

Steps executed: 241 Episode length: 66 Return: -344.629855158818466
INFO:tensorflow:Average training steps per second: 316.38
I0901 13:06:23.049550 139982171817984 replay_runner.py:36] Average training steps per second: 316.38
I0901 13:06:23.193783 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.63
INFO:tensorflow:Starting iteration 11

Steps executed: 284 Episode length: 98 Return: 8.204477029786986416
INFO:tensorflow:Average training steps per second: 320.43
I0901 13:06:29.753717 139982171817984 replay_runner.py:36] Average training steps per second: 320.43
I0901 13:06:29.918414 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.99
INFO:tensorflow:Starting iteration 12

Steps executed: 223 Episode length: 92 Return: -296.535513842334726
INFO:tensorflow:Average training steps per second: 308.21
I0901 13:06:36.597133 139982171817984 replay_runner.py:36] Average training steps per second: 308.21
I0901 13:06:36.731801 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.30
INFO:tensorflow:Starting iteration 13

Steps executed: 289 Episode length: 101 Return: -684.82907761973126
INFO:tensorflow:Average training steps per second: 317.94
I0901 13:06:43.324334 139982171817984 replay_runner.py:36] Average training steps per second: 317.94
I0901 13:06:43.506243 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.41
INFO:tensorflow:Starting iteration 14
I0901 13:06:46.920360 139982171817984 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 321.97
I0901 13:06:50.026498 139982171817984 replay_runner.py:36] Average training steps per second: 321.97

Steps executed: 267 Episode length: 106 Return: -326.15178629929346
INFO:tensorflow:Starting iteration 15

Steps executed: 291 Episode length: 125 Return: -202.69770495569998
INFO:tensorflow:Average training steps per second: 321.90
I0901 13:06:56.790071 139982171817984 replay_runner.py:36] Average training steps per second: 321.90
I0901 13:06:56.984956 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.40
INFO:tensorflow:Starting iteration 16

Steps executed: 336 Episode length: 197 Return: -437.02369925367384
INFO:tensorflow:Average training steps per second: 315.33
I0901 13:07:03.551298 139982171817984 replay_runner.py:36] Average training steps per second: 315.33
I0901 13:07:03.792290 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.27
INFO:tensorflow:Starting iteration 17

Steps executed: 212 Episode length: 75 Return: -113.625926998144234
INFO:tensorflow:Average training steps per second: 317.76
I0901 13:07:10.340878 139982171817984 replay_runner.py:36] Average training steps per second: 317.76
I0901 13:07:10.471602 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.98
INFO:tensorflow:Starting iteration 18

Steps executed: 217 Episode length: 217 Return: -187.42988747633024
INFO:tensorflow:Average training steps per second: 318.97
I0901 13:07:17.001765 139982171817984 replay_runner.py:36] Average training steps per second: 318.97
I0901 13:07:17.160892 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.43
INFO:tensorflow:Starting iteration 19

Steps executed: 234 Episode length: 56 Return: -427.590465656831954
INFO:tensorflow:Average training steps per second: 320.88
I0901 13:07:23.666584 139982171817984 replay_runner.py:36] Average training steps per second: 320.88
I0901 13:07:23.821627 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.85
INFO:tensorflow:Starting iteration 20

Steps executed: 73 Episode length: 73 Return: -301.6148177720805954
INFO:tensorflow:Average training steps per second: 330.63

Steps executed: 257 Episode length: 105 Return: -206.61013468730073
I0901 13:07:30.391740 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.58
INFO:tensorflow:Starting iteration 21

Steps executed: 230 Episode length: 52 Return: -290.323908060642053
INFO:tensorflow:Average training steps per second: 327.46
I0901 13:07:36.868363 139982171817984 replay_runner.py:36] Average training steps per second: 327.46
I0901 13:07:37.024169 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.15
INFO:tensorflow:Starting iteration 22

Steps executed: 238 Episode length: 80 Return: -302.702473835666353
INFO:tensorflow:Average training steps per second: 334.04
I0901 13:07:43.407075 139982171817984 replay_runner.py:36] Average training steps per second: 334.04
I0901 13:07:43.557938 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.87
INFO:tensorflow:Starting iteration 23

Steps executed: 247 Episode length: 59 Return: -528.387069259052253
INFO:tensorflow:Average training steps per second: 338.14
I0901 13:07:49.931375 139982171817984 replay_runner.py:36] Average training steps per second: 338.14
I0901 13:07:50.084653 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -505.85
INFO:tensorflow:Starting iteration 24
I0901 13:07:53.462914 139982171817984 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 334.11

Steps executed: 217 Episode length: 71 Return: -560.605968018620353
I0901 13:07:56.598139 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.25
INFO:tensorflow:Starting iteration 25

Steps executed: 217 Episode length: 148 Return: -242.72370429412578
INFO:tensorflow:Average training steps per second: 330.49
I0901 13:08:03.079009 139982171817984 replay_runner.py:36] Average training steps per second: 330.49
I0901 13:08:03.220089 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.05
INFO:tensorflow:Starting iteration 26

Steps executed: 201 Episode length: 87 Return: -779.336491452488678
INFO:tensorflow:Average training steps per second: 363.48
I0901 13:08:09.460329 139982171817984 replay_runner.py:36] Average training steps per second: 363.48
I0901 13:08:09.575323 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.40
INFO:tensorflow:Starting iteration 27

Steps executed: 227 Episode length: 61 Return: -493.860141844893598
INFO:tensorflow:Average training steps per second: 341.75
I0901 13:08:15.941860 139982171817984 replay_runner.py:36] Average training steps per second: 341.75
I0901 13:08:16.113313 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -511.96
INFO:tensorflow:Starting iteration 28

Steps executed: 220 Episode length: 85 Return: -779.856075648234598
INFO:tensorflow:Average training steps per second: 336.97
I0901 13:08:22.471920 139982171817984 replay_runner.py:36] Average training steps per second: 336.97
I0901 13:08:22.608336 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -653.22
INFO:tensorflow:Starting iteration 29

Steps executed: 215 Episode length: 64 Return: -355.123467968070668
INFO:tensorflow:Average training steps per second: 366.33
I0901 13:08:28.807716 139982171817984 replay_runner.py:36] Average training steps per second: 366.33

Done fixed training!Episode length: 64 Return: -355.123467968070668