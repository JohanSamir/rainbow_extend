I0905 16:21:33.411687 140334269278208 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.412409 140334269278208 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.515520 140334269278208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.518638 140334269278208 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.518784 140334269278208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.518879 140334269278208 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.518966 140334269278208 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.519072 140334269278208 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:33.519196 140334269278208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.519487 140334269278208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.519645 140334269278208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.519790 140334269278208 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.519923 140334269278208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.520014 140334269278208 dqn_agent.py:283] 	 seed: 1630858893515453
I0905 16:21:33.523725 140334269278208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.523909 140334269278208 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:33.524046 140334269278208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.524186 140334269278208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.524349 140334269278208 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.524462 140334269278208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.524639 140334269278208 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.524768 140334269278208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.524888 140334269278208 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0905 16:21:35.104110 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.409804 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.536484 140334269278208 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.541332 140334269278208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.541481 140334269278208 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.541561 140334269278208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.541624 140334269278208 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.541682 140334269278208 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.541759 140334269278208 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:35.541822 140334269278208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.541911 140334269278208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.541984 140334269278208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.542050 140334269278208 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.542111 140334269278208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.542179 140334269278208 dqn_agent.py:283] 	 seed: 1630858895541296
I0905 16:21:35.543560 140334269278208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.543671 140334269278208 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:35.543741 140334269278208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.543802 140334269278208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.543859 140334269278208 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.543915 140334269278208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.543986 140334269278208 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.544058 140334269278208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.544119 140334269278208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.561490 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.572170 140334269278208 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.572351 140334269278208 replay_runner.py:41] Starting iteration 0
Steps executed: 231 Episode length: 119 Return: -344.05303088759626
INFO:tensorflow:Average training steps per second: 278.47
I0905 16:21:39.163666 140334269278208 replay_runner.py:36] Average training steps per second: 278.47
I0905 16:21:39.801673 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.98
INFO:tensorflow:Starting iteration 1

Steps executed: 212 Episode length: 87 Return: -466.263051590627686
INFO:tensorflow:Average training steps per second: 404.11
I0905 16:21:45.360540 140334269278208 replay_runner.py:36] Average training steps per second: 404.11
I0905 16:21:45.451769 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.38
INFO:tensorflow:Starting iteration 2
I0905 16:21:48.527083 140334269278208 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 409.06

Steps executed: 208 Episode length: 123 Return: -454.38269548486414
I0905 16:21:51.059378 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.21
INFO:tensorflow:Starting iteration 3

Steps executed: 229 Episode length: 119 Return: -506.90668668979434
INFO:tensorflow:Average training steps per second: 402.64
I0905 16:21:56.614281 140334269278208 replay_runner.py:36] Average training steps per second: 402.64
I0905 16:21:56.718963 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.65
INFO:tensorflow:Starting iteration 4

Steps executed: 223 Episode length: 140 Return: -338.65901113818824
INFO:tensorflow:Average training steps per second: 405.37
I0905 16:22:02.270300 140334269278208 replay_runner.py:36] Average training steps per second: 405.37
I0905 16:22:02.366482 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.81
INFO:tensorflow:Starting iteration 5

Steps executed: 274 Episode length: 125 Return: -300.42000465075135
INFO:tensorflow:Average training steps per second: 389.24
I0905 16:22:08.019812 140334269278208 replay_runner.py:36] Average training steps per second: 389.24
I0905 16:22:08.138574 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.69
INFO:tensorflow:Starting iteration 6

Steps executed: 305 Episode length: 122 Return: -233.29596223820425
INFO:tensorflow:Average training steps per second: 402.89
I0905 16:22:13.706244 140334269278208 replay_runner.py:36] Average training steps per second: 402.89
I0905 16:22:13.815918 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.96
INFO:tensorflow:Starting iteration 7

Steps executed: 300 Episode length: 132 Return: -323.65440771818253
INFO:tensorflow:Average training steps per second: 404.19
I0905 16:22:19.387110 140334269278208 replay_runner.py:36] Average training steps per second: 404.19
I0905 16:22:19.522802 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.94
INFO:tensorflow:Starting iteration 8
I0905 16:22:22.586388 140334269278208 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 407.91

Steps executed: 518 Episode length: 518 Return: -219.49863734946413
I0905 16:22:25.465221 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.50
INFO:tensorflow:Starting iteration 9

Steps executed: 248 Episode length: 107 Return: -240.40064167306662
INFO:tensorflow:Average training steps per second: 412.55
I0905 16:22:30.972563 140334269278208 replay_runner.py:36] Average training steps per second: 412.55
I0905 16:22:31.071798 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.94
INFO:tensorflow:Starting iteration 10

Steps executed: 532 Episode length: 430 Return: -557.37113983599762
INFO:tensorflow:Average training steps per second: 400.52
I0905 16:22:36.645431 140334269278208 replay_runner.py:36] Average training steps per second: 400.52
I0905 16:22:37.078378 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.10
INFO:tensorflow:Starting iteration 11

Steps executed: 397 Episode length: 397 Return: -773.25851351682762
INFO:tensorflow:Average training steps per second: 411.04
I0905 16:22:42.590542 140334269278208 replay_runner.py:36] Average training steps per second: 411.04
I0905 16:22:42.961774 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -773.26
INFO:tensorflow:Starting iteration 12

Steps executed: 426 Episode length: 426 Return: -1509.8367076298641
INFO:tensorflow:Average training steps per second: 411.52
I0905 16:22:48.475757 140334269278208 replay_runner.py:36] Average training steps per second: 411.52
I0905 16:22:48.824362 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -1509.84
INFO:tensorflow:Starting iteration 13

Steps executed: 126 Episode length: 126 Return: -189.05222663666268
INFO:tensorflow:Average training steps per second: 409.31

Steps executed: 1126 Episode length: 1000 Return: -57.07213889668689
I0905 16:22:55.515415 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.06
INFO:tensorflow:Starting iteration 14
I0905 16:22:58.610545 140334269278208 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 408.50

Steps executed: 909 Episode length: 909 Return: -387.358707903899389
I0905 16:23:02.102471 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.36
INFO:tensorflow:Starting iteration 15

Steps executed: 349 Episode length: 254 Return: -280.765794164650589
INFO:tensorflow:Average training steps per second: 420.63
I0905 16:23:07.561028 140334269278208 replay_runner.py:36] Average training steps per second: 420.63
I0905 16:23:07.735794 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.73
INFO:tensorflow:Starting iteration 16
I0905 16:23:10.669160 140334269278208 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 355.12

Steps executed: 1000 Episode length: 1000 Return: -28.829628021484996
I0905 16:23:15.663691 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -28.83
INFO:tensorflow:Starting iteration 17

Steps executed: 1112 Episode length: 1000 Return: -261.31950222876526
INFO:tensorflow:Average training steps per second: 393.27
I0905 16:23:21.683655 140334269278208 replay_runner.py:36] Average training steps per second: 393.27
I0905 16:23:23.478370 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.91
INFO:tensorflow:Starting iteration 18
I0905 16:23:26.562202 140334269278208 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 405.20

Steps executed: 1000 Episode length: 1000 Return: -166.66172968181223
I0905 16:23:30.186697 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.66
INFO:tensorflow:Starting iteration 19

Steps executed: 751 Episode length: 751 Return: -477.9675115961178223
INFO:tensorflow:Average training steps per second: 394.79
I0905 16:23:35.801499 140334269278208 replay_runner.py:36] Average training steps per second: 394.79
I0905 16:23:36.614787 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -477.97
INFO:tensorflow:Starting iteration 20

Steps executed: 1000 Episode length: 1000 Return: -19.802476987038027
INFO:tensorflow:Average training steps per second: 408.22
I0905 16:23:42.152488 140334269278208 replay_runner.py:36] Average training steps per second: 408.22
I0905 16:23:43.231967 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -19.80
INFO:tensorflow:Starting iteration 21

Steps executed: 535 Episode length: 535 Return: -81.91375752963188027
INFO:tensorflow:Average training steps per second: 401.08
I0905 16:23:48.802655 140334269278208 replay_runner.py:36] Average training steps per second: 401.08
I0905 16:23:49.341890 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.91
INFO:tensorflow:Starting iteration 22
I0905 16:23:52.426023 140334269278208 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 405.48

Steps executed: 721 Episode length: 721 Return: -384.9524896035447027
I0905 16:23:55.987793 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.95
INFO:tensorflow:Starting iteration 23

Steps executed: 265 Episode length: 265 Return: -15.87107293094582927
INFO:tensorflow:Average training steps per second: 411.04
I0905 16:24:01.499468 140334269278208 replay_runner.py:36] Average training steps per second: 411.04
I0905 16:24:01.644335 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.87
INFO:tensorflow:Starting iteration 24

Steps executed: 210 Episode length: 210 Return: -42.96990595384642927
INFO:tensorflow:Average training steps per second: 411.35
I0905 16:24:07.146572 140334269278208 replay_runner.py:36] Average training steps per second: 411.35
I0905 16:24:07.257204 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.97
INFO:tensorflow:Starting iteration 25

Steps executed: 496 Episode length: 302 Return: -43.48847178885698427
INFO:tensorflow:Average training steps per second: 408.43
I0905 16:24:12.778573 140334269278208 replay_runner.py:36] Average training steps per second: 408.43
I0905 16:24:13.073365 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.86
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 217 Return: -262.8085400623918427
INFO:tensorflow:Average training steps per second: 409.72
I0905 16:24:18.583842 140334269278208 replay_runner.py:36] Average training steps per second: 409.72
I0905 16:24:18.687335 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.81
INFO:tensorflow:Starting iteration 27

Steps executed: 252 Episode length: 252 Return: -469.7809853010429427
INFO:tensorflow:Average training steps per second: 399.10
I0905 16:24:24.275219 140334269278208 replay_runner.py:36] Average training steps per second: 399.10
I0905 16:24:24.435269 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -469.78
INFO:tensorflow:Starting iteration 28

Steps executed: 399 Episode length: 298 Return: -255.7886889105017227
INFO:tensorflow:Average training steps per second: 409.57
I0905 16:24:29.950257 140334269278208 replay_runner.py:36] Average training steps per second: 409.57
I0905 16:24:30.200652 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.98
INFO:tensorflow:Starting iteration 29

Steps executed: 202 Episode length: 96 Return: -547.12356717128747227
INFO:tensorflow:Average training steps per second: 351.16
I0905 16:24:36.037288 140334269278208 replay_runner.py:36] Average training steps per second: 351.16

Done fixed training!Episode length: 96 Return: -547.12356717128747227