I0910 11:23:37.056192 139967107905536 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 11:23:37.056683 139967107905536 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 11:23:37.115045 139967107905536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:37.116059 139967107905536 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:37.116166 139967107905536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:37.116240 139967107905536 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:37.116322 139967107905536 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:37.116530 139967107905536 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:37.116611 139967107905536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:37.116727 139967107905536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:37.116814 139967107905536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:37.116911 139967107905536 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:37.117025 139967107905536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:37.117110 139967107905536 dqn_agent.py:283] 	 seed: 1631273017114990
I0910 11:23:37.118867 139967107905536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:37.119015 139967107905536 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:37.119097 139967107905536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:37.119171 139967107905536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:37.119235 139967107905536 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:37.119313 139967107905536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:37.119407 139967107905536 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:37.119518 139967107905536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:37.119597 139967107905536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.346198 139967107905536 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.414736 139967107905536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:38.414894 139967107905536 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:38.414947 139967107905536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:38.415027 139967107905536 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:38.415084 139967107905536 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:38.415177 139967107905536 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:38.415225 139967107905536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:38.415290 139967107905536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:38.415355 139967107905536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:38.415413 139967107905536 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:38.415477 139967107905536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:38.415534 139967107905536 dqn_agent.py:283] 	 seed: 1631273018414697
I0910 11:23:38.416847 139967107905536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:38.416964 139967107905536 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:38.417035 139967107905536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:38.417105 139967107905536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:38.417162 139967107905536 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:38.417252 139967107905536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:38.417321 139967107905536 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:38.417377 139967107905536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:38.417450 139967107905536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.435997 139967107905536 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.446871 139967107905536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:23:38.447048 139967107905536 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 887871.30
I0910 11:23:38.448292 139967107905536 replay_runner.py:39] Average training steps per second: 887871.30
Loaded trained dqn in mountaincar
Training fixed agent 6, please be patient, may be a while...
I0910 11:23:39.178830 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:23:39.234547 139967107905536 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 819040.03
I0910 11:23:39.235972 139967107905536 replay_runner.py:39] Average training steps per second: 819040.03
I0910 11:23:39.391080 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:23:39.443334 139967107905536 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 814427.96
I0910 11:23:39.444759 139967107905536 replay_runner.py:39] Average training steps per second: 814427.96
I0910 11:23:39.613759 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:23:39.665830 139967107905536 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 647169.26
I0910 11:23:39.667634 139967107905536 replay_runner.py:39] Average training steps per second: 647169.26
I0910 11:23:39.854462 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:23:39.908436 139967107905536 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 768469.04
I0910 11:23:39.909952 139967107905536 replay_runner.py:39] Average training steps per second: 768469.04
I0910 11:23:40.086483 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:23:40.141587 139967107905536 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 748581.83
I0910 11:23:40.143184 139967107905536 replay_runner.py:39] Average training steps per second: 748581.83
I0910 11:23:40.312160 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:23:40.366125 139967107905536 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 790781.30
I0910 11:23:40.367620 139967107905536 replay_runner.py:39] Average training steps per second: 790781.30
I0910 11:23:40.537599 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 7
I0910 11:23:40.591846 139967107905536 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 746982.01
I0910 11:23:40.593418 139967107905536 replay_runner.py:39] Average training steps per second: 746982.01
I0910 11:23:40.766750 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:23:40.827665 139967107905536 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 775717.40
I0910 11:23:40.829270 139967107905536 replay_runner.py:39] Average training steps per second: 775717.40
I0910 11:23:41.009207 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:23:41.063133 139967107905536 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 786628.66
I0910 11:23:41.064638 139967107905536 replay_runner.py:39] Average training steps per second: 786628.66
I0910 11:23:41.256381 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:23:41.311951 139967107905536 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 827115.76
I0910 11:23:41.313395 139967107905536 replay_runner.py:39] Average training steps per second: 827115.76
I0910 11:23:41.471411 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:23:41.523933 139967107905536 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 831873.07
I0910 11:23:41.525352 139967107905536 replay_runner.py:39] Average training steps per second: 831873.07
I0910 11:23:41.695599 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:23:41.750087 139967107905536 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 707541.16
I0910 11:23:41.751748 139967107905536 replay_runner.py:39] Average training steps per second: 707541.16
I0910 11:23:41.919853 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:23:41.971569 139967107905536 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 781353.20
I0910 11:23:41.973055 139967107905536 replay_runner.py:39] Average training steps per second: 781353.20
I0910 11:23:42.134887 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:23:42.186806 139967107905536 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 852847.50
I0910 11:23:42.188186 139967107905536 replay_runner.py:39] Average training steps per second: 852847.50
I0910 11:23:42.347946 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:23:42.411087 139967107905536 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 769738.30
I0910 11:23:42.412633 139967107905536 replay_runner.py:39] Average training steps per second: 769738.30
I0910 11:23:42.585281 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:23:42.641041 139967107905536 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 802123.54
I0910 11:23:42.642507 139967107905536 replay_runner.py:39] Average training steps per second: 802123.54
I0910 11:23:42.803844 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:23:42.857780 139967107905536 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 775430.58
I0910 11:23:42.859301 139967107905536 replay_runner.py:39] Average training steps per second: 775430.58
I0910 11:23:43.017513 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:23:43.070763 139967107905536 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 798762.90
I0910 11:23:43.072247 139967107905536 replay_runner.py:39] Average training steps per second: 798762.90
I0910 11:23:43.253969 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:23:43.305805 139967107905536 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 921420.04
I0910 11:23:43.307090 139967107905536 replay_runner.py:39] Average training steps per second: 921420.04
I0910 11:23:43.468109 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:23:43.519285 139967107905536 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 852154.41
I0910 11:23:43.520692 139967107905536 replay_runner.py:39] Average training steps per second: 852154.41
I0910 11:23:43.680006 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:23:43.733237 139967107905536 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 833857.65
I0910 11:23:43.734644 139967107905536 replay_runner.py:39] Average training steps per second: 833857.65
I0910 11:23:43.890842 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:23:43.942210 139967107905536 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 836852.35
I0910 11:23:43.943615 139967107905536 replay_runner.py:39] Average training steps per second: 836852.35
I0910 11:23:44.100310 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:23:44.155839 139967107905536 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 834853.50
I0910 11:23:44.157246 139967107905536 replay_runner.py:39] Average training steps per second: 834853.50
I0910 11:23:44.312369 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:23:44.363602 139967107905536 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 818400.78
I0910 11:23:44.365025 139967107905536 replay_runner.py:39] Average training steps per second: 818400.78
I0910 11:23:44.521554 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:23:44.573273 139967107905536 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 838022.78
I0910 11:23:44.574710 139967107905536 replay_runner.py:39] Average training steps per second: 838022.78
I0910 11:23:44.748838 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:23:44.802551 139967107905536 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 748314.72
I0910 11:23:44.804139 139967107905536 replay_runner.py:39] Average training steps per second: 748314.72
I0910 11:23:44.989314 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:23:45.042112 139967107905536 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 752881.71
I0910 11:23:45.043717 139967107905536 replay_runner.py:39] Average training steps per second: 752881.71
I0910 11:23:45.234224 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:23:45.287733 139967107905536 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 779755.34
I0910 11:23:45.289277 139967107905536 replay_runner.py:39] Average training steps per second: 779755.34
I0910 11:23:45.466623 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:23:45.519347 139967107905536 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 836185.01
I0910 11:23:45.520791 139967107905536 replay_runner.py:39] Average training steps per second: 836185.01

Done fixed training!Episode length: 600 Return: -600.0