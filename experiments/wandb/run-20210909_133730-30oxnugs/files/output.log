I0909 13:37:36.486437 139825988216832 run_experiment.py:549] Creating TrainRunner ...
I0909 13:37:36.496081 139825988216832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:37:36.496275 139825988216832 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:37:36.496413 139825988216832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:37:36.496528 139825988216832 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:37:36.496662 139825988216832 dqn_agent.py:275] 	 update_period: 4
I0909 13:37:36.496795 139825988216832 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:37:36.496912 139825988216832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:37:36.497060 139825988216832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:37:36.497295 139825988216832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:37:36.497409 139825988216832 dqn_agent.py:280] 	 optimizer: adam
I0909 13:37:36.497505 139825988216832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:37:36.497604 139825988216832 dqn_agent.py:283] 	 seed: 1631194656496031
I0909 13:37:36.500424 139825988216832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:37:36.500588 139825988216832 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:37:36.500708 139825988216832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:37:36.500818 139825988216832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:37:36.500916 139825988216832 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:37:36.501013 139825988216832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:37:36.501108 139825988216832 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:37:36.501229 139825988216832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:37:36.501361 139825988216832 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 6, please be patient, may be a while...
I0909 13:37:38.005998 139825988216832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:38.286081 139825988216832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:38.296751 139825988216832 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:37:38.302115 139825988216832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:37:38.302398 139825988216832 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:37:38.302543 139825988216832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:37:38.302658 139825988216832 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:37:38.302744 139825988216832 dqn_agent.py:275] 	 update_period: 4
I0909 13:37:38.302882 139825988216832 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:37:38.303051 139825988216832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:37:38.303158 139825988216832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:37:38.303231 139825988216832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:37:38.303304 139825988216832 dqn_agent.py:280] 	 optimizer: adam
I0909 13:37:38.303491 139825988216832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:37:38.303585 139825988216832 dqn_agent.py:283] 	 seed: 1631194658302088
I0909 13:37:38.305692 139825988216832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:37:38.305807 139825988216832 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:37:38.305882 139825988216832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:37:38.306081 139825988216832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:37:38.306190 139825988216832 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:37:38.306376 139825988216832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:37:38.306459 139825988216832 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:37:38.306561 139825988216832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:37:38.306694 139825988216832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:37:38.330607 139825988216832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:38.348647 139825988216832 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:37:38.348975 139825988216832 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 172.34
I0909 13:37:44.151943 139825988216832 replay_runner.py:36] Average training steps per second: 172.34
I0909 13:37:45.671689 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:37:45.794241 139825988216832 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.33
I0909 13:37:50.888409 139825988216832 replay_runner.py:36] Average training steps per second: 196.33
I0909 13:37:51.443200 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:37:51.579895 139825988216832 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.77
I0909 13:37:56.963614 139825988216832 replay_runner.py:36] Average training steps per second: 185.77
I0909 13:37:57.506704 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3

Steps executed: 241 Episode length: 241 Return: -241.0
INFO:tensorflow:Average training steps per second: 190.27
I0909 13:38:02.893706 139825988216832 replay_runner.py:36] Average training steps per second: 190.27
I0909 13:38:03.115592 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.00
INFO:tensorflow:Starting iteration 4

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 188.57
I0909 13:38:08.544837 139825988216832 replay_runner.py:36] Average training steps per second: 188.57
I0909 13:38:09.107606 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:38:09.243364 139825988216832 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 190.73
I0909 13:38:14.487392 139825988216832 replay_runner.py:36] Average training steps per second: 190.73
I0909 13:38:15.061415 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:38:15.198513 139825988216832 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 185.37
I0909 13:38:20.593709 139825988216832 replay_runner.py:36] Average training steps per second: 185.37
I0909 13:38:21.143430 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:38:21.285617 139825988216832 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 189.33
I0909 13:38:26.567990 139825988216832 replay_runner.py:36] Average training steps per second: 189.33
I0909 13:38:27.090425 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:38:27.222968 139825988216832 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.27
I0909 13:38:32.451789 139825988216832 replay_runner.py:36] Average training steps per second: 191.27
I0909 13:38:33.002680 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:38:33.134085 139825988216832 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.36
I0909 13:38:38.306196 139825988216832 replay_runner.py:36] Average training steps per second: 193.36
I0909 13:38:38.814407 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:38:38.946712 139825988216832 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 187.62

Steps executed: 776 Episode length: 600 Return: -600.0
I0909 13:38:44.983444 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.67
INFO:tensorflow:Starting iteration 11

Steps executed: 216 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 186.53
I0909 13:38:50.479486 139825988216832 replay_runner.py:36] Average training steps per second: 186.53
I0909 13:38:50.703326 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 12

Steps executed: 120 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 186.01
I0909 13:38:56.218578 139825988216832 replay_runner.py:36] Average training steps per second: 186.01

Steps executed: 240 Episode length: 120 Return: -120.0
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 191.66
I0909 13:39:01.791851 139825988216832 replay_runner.py:36] Average training steps per second: 191.66
I0909 13:39:02.313138 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14

Steps executed: 212 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 189.39
I0909 13:39:07.719045 139825988216832 replay_runner.py:36] Average training steps per second: 189.39
I0909 13:39:07.921601 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 189.64
I0909 13:39:13.328733 139825988216832 replay_runner.py:36] Average training steps per second: 189.64
I0909 13:39:13.856075 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 189.05
I0909 13:39:19.276495 139825988216832 replay_runner.py:36] Average training steps per second: 189.05
I0909 13:39:19.465580 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 17

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 190.65
I0909 13:39:24.851261 139825988216832 replay_runner.py:36] Average training steps per second: 190.65
I0909 13:39:25.039136 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 18
I0909 13:39:25.161926 139825988216832 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 186.73

Steps executed: 444 Episode length: 444 Return: -444.0
I0909 13:39:30.934780 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.00
INFO:tensorflow:Starting iteration 19

Steps executed: 195 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 188.79
I0909 13:39:36.360765 139825988216832 replay_runner.py:36] Average training steps per second: 188.79

Steps executed: 300 Episode length: 105 Return: -105.0
INFO:tensorflow:Starting iteration 20

Steps executed: 248 Episode length: 121 Return: -121.0
INFO:tensorflow:Average training steps per second: 188.11
I0909 13:39:42.085223 139825988216832 replay_runner.py:36] Average training steps per second: 188.11
I0909 13:39:42.323061 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 21

Steps executed: 223 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 187.14
I0909 13:39:47.801503 139825988216832 replay_runner.py:36] Average training steps per second: 187.14
I0909 13:39:48.011625 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 22

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 190.44
I0909 13:39:53.396636 139825988216832 replay_runner.py:36] Average training steps per second: 190.44
I0909 13:39:53.933661 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23

Steps executed: 285 Episode length: 86 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 187.34
I0909 13:39:59.403077 139825988216832 replay_runner.py:36] Average training steps per second: 187.34
I0909 13:39:59.669313 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 24

Steps executed: 757 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 189.07
I0909 13:40:05.093754 139825988216832 replay_runner.py:36] Average training steps per second: 189.07
I0909 13:40:05.747275 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.50
INFO:tensorflow:Starting iteration 25

Steps executed: 255 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 189.30
I0909 13:40:11.158067 139825988216832 replay_runner.py:36] Average training steps per second: 189.30
I0909 13:40:11.391381 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 26
I0909 13:40:11.522235 139825988216832 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 190.04

Steps executed: 209 Episode length: 105 Return: -105.0
I0909 13:40:16.980392 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 27

Steps executed: 217 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 188.61
I0909 13:40:22.413400 139825988216832 replay_runner.py:36] Average training steps per second: 188.61
I0909 13:40:22.604825 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 28

Steps executed: 204 Episode length: 97 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 191.56
I0909 13:40:27.950515 139825988216832 replay_runner.py:36] Average training steps per second: 191.56
I0909 13:40:28.127442 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 93 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 197.52
I0909 13:40:33.325830 139825988216832 replay_runner.py:36] Average training steps per second: 197.52
I0909 13:40:33.540502 139825988216832 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00