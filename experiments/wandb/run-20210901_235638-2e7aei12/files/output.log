Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 23:56:45.415855 140286289131520 run_experiment.py:549] Creating TrainRunner ...
I0901 23:56:45.425437 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:56:45.425642 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:56:45.425716 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:56:45.425778 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:56:45.425834 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0901 23:56:45.425924 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:56:45.426030 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:56:45.426107 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:56:45.426243 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:56:45.426599 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:56:45.426813 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:56:45.426918 140286289131520 dqn_agent.py:283] 	 seed: 1630540605425379
I0901 23:56:45.429798 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:56:45.429967 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:56:45.430192 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:56:45.430427 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:56:45.430649 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:56:45.430748 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:56:45.430921 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:56:45.431080 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:56:45.431200 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:56:45.472043 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:45.977887 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:45.993088 140286289131520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:56:46.001610 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:56:46.001905 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:56:46.002173 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:56:46.002466 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:56:46.002665 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0901 23:56:46.002814 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:56:46.002999 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:56:46.003084 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:56:46.003174 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:56:46.003321 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:56:46.003434 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:56:46.003535 140286289131520 dqn_agent.py:283] 	 seed: 1630540606001559
I0901 23:56:46.006522 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:56:46.006658 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:56:46.006768 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:56:46.006855 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:56:46.006925 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:56:46.007061 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:56:46.007151 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:56:46.007214 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:56:46.007431 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:56:46.041199 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:56:46.062707 140286289131520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:56:46.063007 140286289131520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.13
I0901 23:56:52.637313 140286289131520 replay_runner.py:36] Average training steps per second: 152.13
Steps executed: 208 Episode length: 11 Return: 11.0
I0901 23:56:53.794038 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.90
INFO:tensorflow:Starting iteration 1
I0901 23:56:54.002442 140286289131520 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 198.11

Steps executed: 233 Episode length: 80 Return: 80.0
I0901 23:56:59.228153 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 77.67
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.27
I0901 23:57:04.618890 140286289131520 replay_runner.py:36] Average training steps per second: 192.27
I0901 23:57:04.741034 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0901 23:57:04.921672 140286289131520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 191.73
I0901 23:57:10.137638 140286289131520 replay_runner.py:36] Average training steps per second: 191.73
I0901 23:57:10.294582 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0901 23:57:10.492519 140286289131520 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 191.67
I0901 23:57:15.710214 140286289131520 replay_runner.py:36] Average training steps per second: 191.67
I0901 23:57:15.847837 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 23:57:16.036116 140286289131520 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 192.44
I0901 23:57:21.232882 140286289131520 replay_runner.py:36] Average training steps per second: 192.44
I0901 23:57:21.365644 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0901 23:57:21.552102 140286289131520 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 191.06
I0901 23:57:26.786706 140286289131520 replay_runner.py:36] Average training steps per second: 191.06
I0901 23:57:26.914490 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 376 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 193.57
I0901 23:57:32.272636 140286289131520 replay_runner.py:36] Average training steps per second: 193.57
I0901 23:57:32.538216 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 8

Steps executed: 355 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 191.59
I0901 23:57:37.955285 140286289131520 replay_runner.py:36] Average training steps per second: 191.59
I0901 23:57:38.186144 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.50
INFO:tensorflow:Starting iteration 9

Steps executed: 320 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 192.18
I0901 23:57:43.578512 140286289131520 replay_runner.py:36] Average training steps per second: 192.18
I0901 23:57:43.792119 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 10
I0901 23:57:43.967329 140286289131520 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 190.93
I0901 23:57:49.205273 140286289131520 replay_runner.py:36] Average training steps per second: 190.93

Steps executed: 333 Episode length: 169 Return: 169.0
INFO:tensorflow:Starting iteration 11
I0901 23:57:49.631667 140286289131520 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 192.42
I0901 23:57:54.828906 140286289131520 replay_runner.py:36] Average training steps per second: 192.42
I0901 23:57:55.014178 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 12

Steps executed: 279 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 188.75
I0901 23:58:00.505896 140286289131520 replay_runner.py:36] Average training steps per second: 188.75
I0901 23:58:00.652120 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.34
I0901 23:58:06.080077 140286289131520 replay_runner.py:36] Average training steps per second: 191.34
I0901 23:58:06.301949 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.50
INFO:tensorflow:Starting iteration 14

Steps executed: 337 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.29
I0901 23:58:11.749575 140286289131520 replay_runner.py:36] Average training steps per second: 190.29
I0901 23:58:11.883331 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15


Steps executed: 282 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 190.63
I0901 23:58:17.314803 140286289131520 replay_runner.py:36] Average training steps per second: 190.63
I0901 23:58:17.510542 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 16
I0901 23:58:17.702178 140286289131520 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 188.64
I0901 23:58:23.003602 140286289131520 replay_runner.py:36] Average training steps per second: 188.64
I0901 23:58:23.142303 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.26
I0901 23:58:28.644140 140286289131520 replay_runner.py:36] Average training steps per second: 188.26
I0901 23:58:28.782073 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:58:28.970717 140286289131520 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 189.53
I0901 23:58:34.247529 140286289131520 replay_runner.py:36] Average training steps per second: 189.53
I0901 23:58:34.384835 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:58:34.564043 140286289131520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 188.43
I0901 23:58:39.871503 140286289131520 replay_runner.py:36] Average training steps per second: 188.43
I0901 23:58:40.014617 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:58:40.210558 140286289131520 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.21
I0901 23:58:45.386660 140286289131520 replay_runner.py:36] Average training steps per second: 193.21
I0901 23:58:45.519951 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:58:45.705193 140286289131520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 195.40
I0901 23:58:50.823492 140286289131520 replay_runner.py:36] Average training steps per second: 195.40
I0901 23:58:50.946629 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:58:51.136662 140286289131520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.37
I0901 23:58:56.308480 140286289131520 replay_runner.py:36] Average training steps per second: 193.37
I0901 23:58:56.441699 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:58:56.636431 140286289131520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 198.57

Steps executed: 385 Episode length: 195 Return: 195.0
I0901 23:59:01.929581 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.74
I0901 23:59:07.398068 140286289131520 replay_runner.py:36] Average training steps per second: 189.74
I0901 23:59:07.542957 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 327 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 191.29
I0901 23:59:12.959931 140286289131520 replay_runner.py:36] Average training steps per second: 191.29
I0901 23:59:13.179098 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 26
I0901 23:59:13.368724 140286289131520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 190.39
I0901 23:59:18.621348 140286289131520 replay_runner.py:36] Average training steps per second: 190.39
I0901 23:59:18.755380 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.09
I0901 23:59:24.181639 140286289131520 replay_runner.py:36] Average training steps per second: 191.09
I0901 23:59:24.317717 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:59:24.503430 140286289131520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 198.95
I0901 23:59:29.530400 140286289131520 replay_runner.py:36] Average training steps per second: 198.95
I0901 23:59:29.666424 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.71
I0901 23:59:35.138515 140286289131520 replay_runner.py:36] Average training steps per second: 189.71
I0901 23:59:35.264349 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00