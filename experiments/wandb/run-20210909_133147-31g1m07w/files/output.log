Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
I0909 13:31:52.801045 139663366092800 run_experiment.py:549] Creating TrainRunner ...
I0909 13:31:52.806541 139663366092800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:52.806658 139663366092800 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:52.806723 139663366092800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:52.806795 139663366092800 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:52.806856 139663366092800 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:52.806902 139663366092800 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:52.806971 139663366092800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:52.807045 139663366092800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:52.807119 139663366092800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:52.807163 139663366092800 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:52.807221 139663366092800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:52.807286 139663366092800 dqn_agent.py:283] 	 seed: 1631194312806511
I0909 13:31:52.808749 139663366092800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:52.808846 139663366092800 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:52.808906 139663366092800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:52.808964 139663366092800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:52.809018 139663366092800 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:52.809075 139663366092800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:52.809125 139663366092800 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:52.809171 139663366092800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:52.809238 139663366092800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:53.901595 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:54.073736 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:54.082313 139663366092800 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:31:54.087144 139663366092800 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:54.087263 139663366092800 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:54.087316 139663366092800 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:54.087369 139663366092800 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:54.087414 139663366092800 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:54.087469 139663366092800 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:54.087518 139663366092800 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:54.087569 139663366092800 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:54.087640 139663366092800 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:54.087731 139663366092800 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:54.087798 139663366092800 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:54.087860 139663366092800 dqn_agent.py:283] 	 seed: 1631194314087118
I0909 13:31:54.089298 139663366092800 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:54.089407 139663366092800 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:54.089475 139663366092800 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:54.089535 139663366092800 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:54.089590 139663366092800 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:54.089645 139663366092800 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:54.089723 139663366092800 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:54.089790 139663366092800 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:54.089846 139663366092800 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:54.108636 139663366092800 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:54.120764 139663366092800 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:31:54.120934 139663366092800 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 290.47
I0909 13:31:57.563999 139663366092800 replay_runner.py:36] Average training steps per second: 290.47
I0909 13:31:58.205784 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:31:58.271178 139663366092800 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 388.35
I0909 13:32:00.846386 139663366092800 replay_runner.py:36] Average training steps per second: 388.35
I0909 13:32:00.969984 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:32:01.033330 139663366092800 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 386.69
I0909 13:32:03.619671 139663366092800 replay_runner.py:36] Average training steps per second: 386.69
I0909 13:32:03.742212 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:32:03.806349 139663366092800 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 386.00
I0909 13:32:06.397224 139663366092800 replay_runner.py:36] Average training steps per second: 386.00

Steps executed: 111 Episode length: 111 Return: -111.0
INFO:tensorflow:Starting iteration 4

Steps executed: 317 Episode length: 206 Return: -206.0
INFO:tensorflow:Average training steps per second: 380.32
I0909 13:32:09.156286 139663366092800 replay_runner.py:36] Average training steps per second: 380.32
I0909 13:32:09.310812 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.50
INFO:tensorflow:Starting iteration 5


Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 389.19
I0909 13:32:11.946805 139663366092800 replay_runner.py:36] Average training steps per second: 389.19
I0909 13:32:12.075291 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6

Steps executed: 780 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 383.31
I0909 13:32:14.750287 139663366092800 replay_runner.py:36] Average training steps per second: 383.31
I0909 13:32:14.911732 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.00
INFO:tensorflow:Starting iteration 7
I0909 13:32:14.975758 139663366092800 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 387.41
I0909 13:32:17.557196 139663366092800 replay_runner.py:36] Average training steps per second: 387.41
I0909 13:32:17.683645 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 387.90
I0909 13:32:20.324489 139663366092800 replay_runner.py:36] Average training steps per second: 387.90
I0909 13:32:20.447126 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:32:20.512557 139663366092800 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 383.47
I0909 13:32:23.120593 139663366092800 replay_runner.py:36] Average training steps per second: 383.47
I0909 13:32:23.180853 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.00
INFO:tensorflow:Starting iteration 10


Steps executed: 228 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 385.86
I0909 13:32:25.837763 139663366092800 replay_runner.py:36] Average training steps per second: 385.86
I0909 13:32:25.889124 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 11
I0909 13:32:25.954352 139663366092800 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 383.45
I0909 13:32:28.562454 139663366092800 replay_runner.py:36] Average training steps per second: 383.45

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 12

Steps executed: 222 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 387.24
I0909 13:32:31.338274 139663366092800 replay_runner.py:36] Average training steps per second: 387.24
I0909 13:32:31.386395 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 13

Steps executed: 296 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 371.75
I0909 13:32:34.149536 139663366092800 replay_runner.py:36] Average training steps per second: 371.75
I0909 13:32:34.209992 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 14

Steps executed: 246 Episode length: 149 Return: -149.0
INFO:tensorflow:Average training steps per second: 375.60
I0909 13:32:36.937661 139663366092800 replay_runner.py:36] Average training steps per second: 375.60
I0909 13:32:36.987786 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 15

Steps executed: 273 Episode length: 123 Return: -123.0
INFO:tensorflow:Average training steps per second: 385.35
I0909 13:32:39.649373 139663366092800 replay_runner.py:36] Average training steps per second: 385.35
I0909 13:32:39.705297 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.50
INFO:tensorflow:Starting iteration 16

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 383.57
I0909 13:32:42.379247 139663366092800 replay_runner.py:36] Average training steps per second: 383.57
I0909 13:32:42.499688 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17

Steps executed: 213 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 385.11
I0909 13:32:45.160205 139663366092800 replay_runner.py:36] Average training steps per second: 385.11
I0909 13:32:45.206625 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 18

Steps executed: 209 Episode length: 126 Return: -126.0
INFO:tensorflow:Average training steps per second: 381.78
I0909 13:32:47.890598 139663366092800 replay_runner.py:36] Average training steps per second: 381.78
I0909 13:32:47.934432 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 19

Steps executed: 790 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 382.33
I0909 13:32:50.614765 139663366092800 replay_runner.py:36] Average training steps per second: 382.33
I0909 13:32:50.779832 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.33
INFO:tensorflow:Starting iteration 20

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 376.21
I0909 13:32:53.503385 139663366092800 replay_runner.py:36] Average training steps per second: 376.21
I0909 13:32:53.637208 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21

Steps executed: 218 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 382.14
I0909 13:32:56.318838 139663366092800 replay_runner.py:36] Average training steps per second: 382.14
I0909 13:32:56.364889 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 22
I0909 13:32:56.429382 139663366092800 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 377.51

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:32:59.203964 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 388.82
I0909 13:33:01.840945 139663366092800 replay_runner.py:36] Average training steps per second: 388.82
I0909 13:33:01.885817 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 24

Steps executed: 211 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 387.80
I0909 13:33:04.529359 139663366092800 replay_runner.py:36] Average training steps per second: 387.80
I0909 13:33:04.575033 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 384.34
I0909 13:33:07.243932 139663366092800 replay_runner.py:36] Average training steps per second: 384.34
I0909 13:33:07.291726 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 26

Steps executed: 214 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 380.75
I0909 13:33:09.983947 139663366092800 replay_runner.py:36] Average training steps per second: 380.75
I0909 13:33:10.032435 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 27

Steps executed: 216 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 387.35
I0909 13:33:12.678852 139663366092800 replay_runner.py:36] Average training steps per second: 387.35
I0909 13:33:12.725615 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 28

Steps executed: 213 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 381.38
I0909 13:33:15.412919 139663366092800 replay_runner.py:36] Average training steps per second: 381.38
I0909 13:33:15.457971 139663366092800 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 29
I0909 13:33:15.521895 139663366092800 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 398.34
I0909 13:33:18.032552 139663366092800 replay_runner.py:36] Average training steps per second: 398.34

Done fixed training!Episode length: 106 Return: -106.0