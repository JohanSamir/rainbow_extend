Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 23:50:44.289347 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0902 23:50:44.302144 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:50:44.302458 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:50:44.302698 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:50:44.302824 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:50:44.303130 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:50:44.303388 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:50:44.303546 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:50:44.303762 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:50:44.303916 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:50:44.304030 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:50:44.304154 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:50:44.304282 139819819333632 dqn_agent.py:283] 	 seed: 1630626644302081
I0902 23:50:44.307866 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:50:44.308210 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:50:44.308441 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:50:44.308610 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:50:44.308756 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:50:44.308996 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:50:44.309158 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:50:44.309286 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:50:44.309398 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:50:44.349147 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:44.723703 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:44.738986 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:50:44.749182 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:50:44.749431 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:50:44.749649 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:50:44.749809 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:50:44.749945 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:50:44.750043 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:50:44.750171 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:50:44.750289 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:50:44.750614 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:50:44.750879 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:50:44.751024 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:50:44.751183 139819819333632 dqn_agent.py:283] 	 seed: 1630626644749129
I0902 23:50:44.753512 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:50:44.753687 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:50:44.753774 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:50:44.753889 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:50:44.754016 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:50:44.754115 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:50:44.754212 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:50:44.754346 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:50:44.754429 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:50:44.834022 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:44.859577 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:50:44.859862 139819819333632 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.02
I0902 23:50:51.070784 139819819333632 replay_runner.py:36] Average training steps per second: 161.02
Steps executed: 251 Episode length: 75 Return: -481.59989745866893
I0902 23:50:52.360046 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.66
INFO:tensorflow:Starting iteration 1

Steps executed: 243 Episode length: 75 Return: -742.31595814497783
INFO:tensorflow:Average training steps per second: 220.79
I0902 23:51:01.081998 139819819333632 replay_runner.py:36] Average training steps per second: 220.79
I0902 23:51:01.289523 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -615.37
INFO:tensorflow:Starting iteration 2

Steps executed: 257 Episode length: 119 Return: -504.17216587184924
INFO:tensorflow:Average training steps per second: 217.42
I0902 23:51:10.171254 139819819333632 replay_runner.py:36] Average training steps per second: 217.42
I0902 23:51:10.407992 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -606.98
INFO:tensorflow:Starting iteration 3
I0902 23:51:14.832792 139819819333632 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 222.69

Steps executed: 603 Episode length: 603 Return: -393.93853913472454
I0902 23:51:20.933808 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.94
INFO:tensorflow:Starting iteration 4
I0902 23:51:25.400403 139819819333632 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 223.77

Steps executed: 923 Episode length: 923 Return: -429.77707412369124
I0902 23:51:32.325886 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.78
INFO:tensorflow:Starting iteration 5
I0902 23:51:36.750442 139819819333632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 226.76

Steps executed: 1000 Episode length: 1000 Return: -103.98772963935318
I0902 23:51:42.863465 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.99
INFO:tensorflow:Starting iteration 6
I0902 23:51:47.262181 139819819333632 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 228.09

Steps executed: 1000 Episode length: 1000 Return: -59.983470014446618
I0902 23:51:56.489716 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.98
INFO:tensorflow:Starting iteration 7
I0902 23:52:00.822620 139819819333632 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 217.70
I0902 23:52:05.416487 139819819333632 replay_runner.py:36] Average training steps per second: 217.70

Steps executed: 1000 Episode length: 1000 Return: -41.523447006135946
INFO:tensorflow:Starting iteration 8
I0902 23:52:12.635271 139819819333632 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 223.96

Steps executed: 1000 Episode length: 1000 Return: -103.58372815120546
I0902 23:52:20.118004 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.58
INFO:tensorflow:Starting iteration 9
I0902 23:52:24.490766 139819819333632 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 217.22

Steps executed: 1000 Episode length: 1000 Return: -174.18522326363436
I0902 23:52:32.698707 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.19
INFO:tensorflow:Starting iteration 10
I0902 23:52:37.160119 139819819333632 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 223.06

Steps executed: 575 Episode length: 575 Return: -286.3446285026734436
I0902 23:52:42.743057 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.34
INFO:tensorflow:Starting iteration 11
I0902 23:52:47.042536 139819819333632 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 229.59

Steps executed: 1000 Episode length: 1000 Return: -98.303099338151986
I0902 23:52:53.394874 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.30
INFO:tensorflow:Starting iteration 12
I0902 23:52:57.653902 139819819333632 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 223.87

Steps executed: 894 Episode length: 894 Return: -294.4181771737832986
I0902 23:53:03.959662 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.42
INFO:tensorflow:Starting iteration 13

Steps executed: 270 Episode length: 75 Return: -257.57034540082866986
INFO:tensorflow:Average training steps per second: 222.81
I0902 23:53:12.797823 139819819333632 replay_runner.py:36] Average training steps per second: 222.81
I0902 23:53:13.036180 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.07
INFO:tensorflow:Starting iteration 14
I0902 23:53:17.390283 139819819333632 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 224.77

Steps executed: 1000 Episode length: 1000 Return: -229.67052280909223
I0902 23:53:25.436553 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.67
INFO:tensorflow:Starting iteration 15
I0902 23:53:29.790509 139819819333632 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 216.59
I0902 23:53:34.407984 139819819333632 replay_runner.py:36] Average training steps per second: 216.59

Steps executed: 200 Episode length: 103 Return: -763.8393498632113223
INFO:tensorflow:Starting iteration 16
I0902 23:53:38.837937 139819819333632 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 221.82

Steps executed: 625 Episode length: 625 Return: -234.5328886160595223
I0902 23:53:45.060582 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.53
INFO:tensorflow:Starting iteration 17
I0902 23:53:49.399254 139819819333632 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 216.26
I0902 23:53:54.023920 139819819333632 replay_runner.py:36] Average training steps per second: 216.26

Steps executed: 401 Episode length: 401 Return: -790.2782971378685223
INFO:tensorflow:Starting iteration 18

Steps executed: 286 Episode length: 155 Return: -134.3555599254733223
INFO:tensorflow:Average training steps per second: 219.10
I0902 23:54:03.677021 139819819333632 replay_runner.py:36] Average training steps per second: 219.10
I0902 23:54:03.963251 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.25
INFO:tensorflow:Starting iteration 19

Steps executed: 309 Episode length: 309 Return: -125.9665327911978623
INFO:tensorflow:Average training steps per second: 221.85
I0902 23:54:12.854140 139819819333632 replay_runner.py:36] Average training steps per second: 221.85
I0902 23:54:13.301864 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.97
INFO:tensorflow:Starting iteration 20

Steps executed: 217 Episode length: 68 Return: -114.86079265650918623
INFO:tensorflow:Average training steps per second: 221.14
I0902 23:54:22.147427 139819819333632 replay_runner.py:36] Average training steps per second: 221.14
I0902 23:54:22.293096 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.39
INFO:tensorflow:Starting iteration 21

Steps executed: 251 Episode length: 251 Return: -359.6160681138369523
INFO:tensorflow:Average training steps per second: 220.69
I0902 23:54:31.233774 139819819333632 replay_runner.py:36] Average training steps per second: 220.69
I0902 23:54:31.516840 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.62
INFO:tensorflow:Starting iteration 22

Steps executed: 130 Episode length: 130 Return: -75.12915010589316523
INFO:tensorflow:Average training steps per second: 224.62

Steps executed: 369 Episode length: 239 Return: -245.2173494901939523
I0902 23:54:40.765483 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.17
INFO:tensorflow:Starting iteration 23

Steps executed: 343 Episode length: 150 Return: -148.7580505485659623
INFO:tensorflow:Average training steps per second: 220.71
I0902 23:54:49.732542 139819819333632 replay_runner.py:36] Average training steps per second: 220.71
I0902 23:54:50.049039 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.11
INFO:tensorflow:Starting iteration 24
I0902 23:54:54.295525 139819819333632 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 228.12

Steps executed: 215 Episode length: 87 Return: -140.95826391287034623
I0902 23:54:58.870930 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.83
INFO:tensorflow:Starting iteration 25

Steps executed: 370 Episode length: 273 Return: -651.2036416661258623
INFO:tensorflow:Average training steps per second: 225.12
I0902 23:55:07.884230 139819819333632 replay_runner.py:36] Average training steps per second: 225.12
I0902 23:55:08.309362 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.13
INFO:tensorflow:Starting iteration 26

Steps executed: 245 Episode length: 106 Return: -26.33224993690163323
INFO:tensorflow:Average training steps per second: 225.03
I0902 23:55:17.052986 139819819333632 replay_runner.py:36] Average training steps per second: 225.03
I0902 23:55:17.272398 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.93
INFO:tensorflow:Starting iteration 27

Steps executed: 79 Episode length: 79 Return: -149.083922181169873323
INFO:tensorflow:Average training steps per second: 221.12

Steps executed: 1079 Episode length: 1000 Return: 166.549734433900323
I0902 23:55:28.522146 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.73
INFO:tensorflow:Starting iteration 28

Steps executed: 207 Episode length: 92 Return: -39.244450101009434323
INFO:tensorflow:Average training steps per second: 229.01
I0902 23:55:37.190169 139819819333632 replay_runner.py:36] Average training steps per second: 229.01
I0902 23:55:37.359026 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.82
INFO:tensorflow:Starting iteration 29

Steps executed: 237 Episode length: 89 Return: -199.66600388202769723
INFO:tensorflow:Average training steps per second: 221.85
I0902 23:55:46.205719 139819819333632 replay_runner.py:36] Average training steps per second: 221.85

Done fixed training!Episode length: 89 Return: -199.66600388202769723