Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0902 23:56:09.744994 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0902 23:56:09.756599 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:56:09.756918 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:56:09.757078 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:56:09.757202 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:56:09.757336 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:56:09.757435 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:56:09.757533 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:56:09.757646 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:56:09.757769 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:56:09.757878 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:56:09.757988 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:56:09.758090 139926926592000 dqn_agent.py:283] 	 seed: 1630626969756531
I0902 23:56:09.761473 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:56:09.761701 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:56:09.761868 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:56:09.761987 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:56:09.762102 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:56:09.762195 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:56:09.762281 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:56:09.762379 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:56:09.762471 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:56:09.803440 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:56:10.200883 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:56:10.215067 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:56:10.224828 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:56:10.225041 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:56:10.225145 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:56:10.225231 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:56:10.225303 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:56:10.225377 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:56:10.225528 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:56:10.225606 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:56:10.225690 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:56:10.225775 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:56:10.225842 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:56:10.225892 139926926592000 dqn_agent.py:283] 	 seed: 1630626970224761
I0902 23:56:10.255731 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:56:10.260035 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:56:10.260236 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:56:10.260448 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:56:10.260747 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:56:10.261150 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:56:10.261363 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:56:10.261537 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:56:10.261765 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:56:10.309345 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:56:10.358633 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:56:10.359027 139926926592000 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.15
I0902 23:56:16.451703 139926926592000 replay_runner.py:36] Average training steps per second: 164.15
Steps executed: 290 Episode length: 115 Return: -350.78979195751344
I0902 23:56:17.789893 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.74
INFO:tensorflow:Starting iteration 1

Steps executed: 274 Episode length: 274 Return: -292.53305879408083
INFO:tensorflow:Average training steps per second: 220.46
I0902 23:56:26.365285 139926926592000 replay_runner.py:36] Average training steps per second: 220.46
I0902 23:56:26.686240 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.53
INFO:tensorflow:Starting iteration 2
I0902 23:56:30.819901 139926926592000 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 218.59

Steps executed: 285 Episode length: 143 Return: -435.21493294521623
I0902 23:56:35.682771 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.90
INFO:tensorflow:Starting iteration 3

Steps executed: 410 Episode length: 410 Return: -345.75407056596223
INFO:tensorflow:Average training steps per second: 218.77
I0902 23:56:44.612212 139926926592000 replay_runner.py:36] Average training steps per second: 218.77
I0902 23:56:45.429413 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.75
INFO:tensorflow:Starting iteration 4
I0902 23:56:49.614248 139926926592000 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 222.49

Steps executed: 1000 Episode length: 1000 Return: -169.23747322811636
I0902 23:56:57.472108 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.24
INFO:tensorflow:Starting iteration 5
I0902 23:57:01.654366 139926926592000 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.55

Steps executed: 1000 Episode length: 1000 Return: -183.47387360040026
I0902 23:57:10.219891 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.47
INFO:tensorflow:Starting iteration 6
I0902 23:57:14.470245 139926926592000 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 219.54

Steps executed: 1000 Episode length: 1000 Return: -302.44385989376166
I0902 23:57:21.872001 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.44
INFO:tensorflow:Starting iteration 7
I0902 23:57:26.120675 139926926592000 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 227.85

Steps executed: 894 Episode length: 894 Return: -390.6940193424574166
I0902 23:57:33.201985 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.69
INFO:tensorflow:Starting iteration 8

Steps executed: 529 Episode length: 529 Return: -220.6087441552437366
INFO:tensorflow:Average training steps per second: 229.43
I0902 23:57:41.846456 139926926592000 replay_runner.py:36] Average training steps per second: 229.43
I0902 23:57:42.699621 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.61
INFO:tensorflow:Starting iteration 9

Steps executed: 430 Episode length: 241 Return: -555.3358163688922366
INFO:tensorflow:Average training steps per second: 233.90
I0902 23:57:51.162747 139926926592000 replay_runner.py:36] Average training steps per second: 233.90
I0902 23:57:51.631773 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -561.82
INFO:tensorflow:Starting iteration 10
I0902 23:57:55.819854 139926926592000 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 235.08

Steps executed: 1000 Episode length: 1000 Return: -112.38255286240272
I0902 23:58:02.711392 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.38
INFO:tensorflow:Starting iteration 11

Steps executed: 249 Episode length: 249 Return: -229.1708979553242572
INFO:tensorflow:Average training steps per second: 245.90
I0902 23:58:10.878514 139926926592000 replay_runner.py:36] Average training steps per second: 245.90
I0902 23:58:11.163139 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.17
INFO:tensorflow:Starting iteration 12

Steps executed: 464 Episode length: 282 Return: -458.7841375371506472
INFO:tensorflow:Average training steps per second: 246.93
I0902 23:58:19.229884 139926926592000 replay_runner.py:36] Average training steps per second: 246.93
I0902 23:58:19.693933 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.04
INFO:tensorflow:Starting iteration 13
I0902 23:58:23.777734 139926926592000 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 251.42

Steps executed: 498 Episode length: 498 Return: -48.58207661947216472
I0902 23:58:28.696327 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -48.58
INFO:tensorflow:Starting iteration 14

Steps executed: 74 Episode length: 74 Return: -143.358854038248416472
INFO:tensorflow:Average training steps per second: 252.77

Steps executed: 1074 Episode length: 1000 Return: -149.49002289266872
I0902 23:58:40.348037 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.42
INFO:tensorflow:Starting iteration 15

Steps executed: 303 Episode length: 303 Return: -214.5356647698727872
INFO:tensorflow:Average training steps per second: 263.02
I0902 23:58:48.097448 139926926592000 replay_runner.py:36] Average training steps per second: 263.02
I0902 23:58:48.415866 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.54
INFO:tensorflow:Starting iteration 16

Steps executed: 319 Episode length: 319 Return: -37.57250426303723872
INFO:tensorflow:Average training steps per second: 268.74
I0902 23:58:55.978600 139926926592000 replay_runner.py:36] Average training steps per second: 268.74
I0902 23:58:56.312369 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -37.57
INFO:tensorflow:Starting iteration 17

Steps executed: 121 Episode length: 121 Return: -156.5427451006691572
INFO:tensorflow:Average training steps per second: 278.40

Steps executed: 391 Episode length: 270 Return: -217.7498575373716572
I0902 23:59:03.990497 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.15
INFO:tensorflow:Starting iteration 18

Steps executed: 411 Episode length: 248 Return: -483.7821428031633772
INFO:tensorflow:Average training steps per second: 274.76
I0902 23:59:11.190264 139926926592000 replay_runner.py:36] Average training steps per second: 274.76
I0902 23:59:11.567011 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.92
INFO:tensorflow:Starting iteration 19

Steps executed: 237 Episode length: 134 Return: -177.6686420003185872
INFO:tensorflow:Average training steps per second: 287.14
I0902 23:59:18.528920 139926926592000 replay_runner.py:36] Average training steps per second: 287.14
I0902 23:59:18.690419 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.16
INFO:tensorflow:Starting iteration 20

Steps executed: 399 Episode length: 215 Return: -121.4598852601775472
INFO:tensorflow:Average training steps per second: 295.56
I0902 23:59:25.478606 139926926592000 replay_runner.py:36] Average training steps per second: 295.56
I0902 23:59:25.777153 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.82
INFO:tensorflow:Starting iteration 21

Steps executed: 240 Episode length: 70 Return: -147.75315404002396472
INFO:tensorflow:Average training steps per second: 297.83
I0902 23:59:32.551688 139926926592000 replay_runner.py:36] Average training steps per second: 297.83
I0902 23:59:32.687784 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.46
INFO:tensorflow:Starting iteration 22

Steps executed: 237 Episode length: 116 Return: -153.7660767527771772
INFO:tensorflow:Average training steps per second: 311.04
I0902 23:59:39.233375 139926926592000 replay_runner.py:36] Average training steps per second: 311.04
I0902 23:59:39.407648 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.29
INFO:tensorflow:Starting iteration 23
I0902 23:59:42.806726 139926926592000 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 311.90
I0902 23:59:46.013153 139926926592000 replay_runner.py:36] Average training steps per second: 311.90

Steps executed: 269 Episode length: 269 Return: -624.5292593096577772
INFO:tensorflow:Starting iteration 24

Steps executed: 341 Episode length: 341 Return: -178.9051570736666372
INFO:tensorflow:Average training steps per second: 312.50
I0902 23:59:52.845441 139926926592000 replay_runner.py:36] Average training steps per second: 312.50
I0902 23:59:53.234260 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.91
INFO:tensorflow:Starting iteration 25

Steps executed: 411 Episode length: 225 Return: -271.4737815363530472
INFO:tensorflow:Average training steps per second: 319.17
I0902 23:59:59.610059 139926926592000 replay_runner.py:36] Average training steps per second: 319.17
I0902 23:59:59.944655 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.50
INFO:tensorflow:Starting iteration 26
I0903 00:00:03.204305 139926926592000 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 316.25

Steps executed: 270 Episode length: 156 Return: -694.7756655812702472
I0903 00:00:06.577308 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -697.49
INFO:tensorflow:Starting iteration 27

Steps executed: 327 Episode length: 327 Return: 255.14075459745082472
INFO:tensorflow:Average training steps per second: 323.99
I0903 00:00:12.911164 139926926592000 replay_runner.py:36] Average training steps per second: 323.99
I0903 00:00:13.315313 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 255.14
INFO:tensorflow:Starting iteration 28

Steps executed: 211 Episode length: 50 Return: -102.97539896587045472
INFO:tensorflow:Average training steps per second: 312.32
I0903 00:00:19.684769 139926926592000 replay_runner.py:36] Average training steps per second: 312.32
I0903 00:00:19.821658 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.88
INFO:tensorflow:Starting iteration 29
I0903 00:00:23.053689 139926926592000 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 338.20
I0903 00:00:26.010773 139926926592000 replay_runner.py:36] Average training steps per second: 338.20


Done fixed training!Episode length: 264 Return: -92.30546163434478472