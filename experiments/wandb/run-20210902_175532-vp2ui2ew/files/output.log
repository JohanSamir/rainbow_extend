Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 17:55:38.794950 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 17:55:38.805240 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:38.805441 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:38.805561 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:38.805625 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:38.805682 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:38.805738 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:38.805790 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:38.805841 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:38.805905 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:38.805957 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:38.806021 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:38.806301 140016423897088 dqn_agent.py:283] 	 seed: 1630605338805190
I0902 17:55:38.808773 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:38.808931 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:38.809110 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:38.809301 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:38.809515 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:38.809710 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:38.809823 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:38.809933 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:38.810031 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:38.848076 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:39.331602 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:39.349705 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:55:39.370561 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:39.370776 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:39.370909 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:39.371057 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:39.371150 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:39.371224 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:39.371320 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:39.371581 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:39.371683 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:39.371934 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:39.372031 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:39.372113 140016423897088 dqn_agent.py:283] 	 seed: 1630605339370515
I0902 17:55:39.375364 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:39.375515 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:39.375611 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:39.375693 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:39.375769 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:39.375829 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:39.375881 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:39.375931 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:39.375982 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:39.409942 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:39.428933 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:55:39.429201 140016423897088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 159.82
I0902 17:55:45.686609 140016423897088 replay_runner.py:36] Average training steps per second: 159.82
Steps executed: 256 Episode length: 73 Return: -389.03977370909524
I0902 17:55:46.874812 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.56
INFO:tensorflow:Starting iteration 1

Steps executed: 264 Episode length: 79 Return: -754.95355675386325
INFO:tensorflow:Average training steps per second: 229.98
I0902 17:55:55.575894 140016423897088 replay_runner.py:36] Average training steps per second: 229.98
I0902 17:55:55.795122 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -541.25
INFO:tensorflow:Starting iteration 2
I0902 17:56:00.089513 140016423897088 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 235.38
I0902 17:56:04.338247 140016423897088 replay_runner.py:36] Average training steps per second: 235.38

Steps executed: 261 Episode length: 76 Return: -584.402541450294874
INFO:tensorflow:Starting iteration 3

Steps executed: 210 Episode length: 73 Return: -726.778285084305674
INFO:tensorflow:Average training steps per second: 229.29
I0902 17:56:13.125124 140016423897088 replay_runner.py:36] Average training steps per second: 229.29
I0902 17:56:13.314531 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -697.72
INFO:tensorflow:Starting iteration 4

Steps executed: 279 Episode length: 122 Return: -613.03907900726514
INFO:tensorflow:Average training steps per second: 220.96
I0902 17:56:22.024659 140016423897088 replay_runner.py:36] Average training steps per second: 220.96
I0902 17:56:22.295730 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -663.63
INFO:tensorflow:Starting iteration 5
I0902 17:56:26.331750 140016423897088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.17

Steps executed: 240 Episode length: 88 Return: -570.404538513690314
I0902 17:56:31.058236 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -586.86
INFO:tensorflow:Starting iteration 6

Steps executed: 254 Episode length: 73 Return: -537.623376549253914
INFO:tensorflow:Average training steps per second: 231.60
I0902 17:56:39.718818 140016423897088 replay_runner.py:36] Average training steps per second: 231.60
I0902 17:56:39.939754 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.47
INFO:tensorflow:Starting iteration 7

Steps executed: 267 Episode length: 86 Return: -554.455046572594814
INFO:tensorflow:Average training steps per second: 241.27
I0902 17:56:48.339022 140016423897088 replay_runner.py:36] Average training steps per second: 241.27
I0902 17:56:48.555527 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.96
INFO:tensorflow:Starting iteration 8
I0902 17:56:52.778738 140016423897088 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 236.75

Steps executed: 424 Episode length: 272 Return: -477.75882324595466
I0902 17:56:57.425585 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.33
INFO:tensorflow:Starting iteration 9

Steps executed: 242 Episode length: 151 Return: -697.29943872938956
INFO:tensorflow:Average training steps per second: 227.43
I0902 17:57:06.188300 140016423897088 replay_runner.py:36] Average training steps per second: 227.43
I0902 17:57:06.386987 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.58
INFO:tensorflow:Starting iteration 10

Steps executed: 220 Episode length: 220 Return: -164.22892163537102
INFO:tensorflow:Average training steps per second: 222.27
I0902 17:57:15.241134 140016423897088 replay_runner.py:36] Average training steps per second: 222.27
I0902 17:57:15.443629 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.23
INFO:tensorflow:Starting iteration 11

Steps executed: 235 Episode length: 149 Return: -248.58172499486787
INFO:tensorflow:Average training steps per second: 224.86
I0902 17:57:23.990976 140016423897088 replay_runner.py:36] Average training steps per second: 224.86
I0902 17:57:24.205867 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.64
INFO:tensorflow:Starting iteration 12

Steps executed: 201 Episode length: 201 Return: -271.54569268560493
INFO:tensorflow:Average training steps per second: 219.44
I0902 17:57:33.132839 140016423897088 replay_runner.py:36] Average training steps per second: 219.44
I0902 17:57:33.332054 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.55
INFO:tensorflow:Starting iteration 13

Steps executed: 419 Episode length: 328 Return: -297.72286338623485
INFO:tensorflow:Average training steps per second: 223.59
I0902 17:57:42.232495 140016423897088 replay_runner.py:36] Average training steps per second: 223.59
I0902 17:57:42.716767 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.79
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 141 Return: -212.58824879439726
INFO:tensorflow:Average training steps per second: 225.34
I0902 17:57:51.508920 140016423897088 replay_runner.py:36] Average training steps per second: 225.34
I0902 17:57:51.711331 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.92
INFO:tensorflow:Starting iteration 15

Steps executed: 221 Episode length: 99 Return: -339.970925583811976
INFO:tensorflow:Average training steps per second: 223.55
I0902 17:58:00.608405 140016423897088 replay_runner.py:36] Average training steps per second: 223.55
I0902 17:58:00.798518 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.56
INFO:tensorflow:Starting iteration 16

Steps executed: 284 Episode length: 176 Return: -80.673920417933326
INFO:tensorflow:Average training steps per second: 218.26
I0902 17:58:09.650367 140016423897088 replay_runner.py:36] Average training steps per second: 218.26
I0902 17:58:09.902914 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.56
INFO:tensorflow:Starting iteration 17

Steps executed: 250 Episode length: 250 Return: -205.65772448182596
INFO:tensorflow:Average training steps per second: 220.21
I0902 17:58:18.695562 140016423897088 replay_runner.py:36] Average training steps per second: 220.21
I0902 17:58:18.956486 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.66
INFO:tensorflow:Starting iteration 18

Steps executed: 231 Episode length: 122 Return: -193.13216372255596
INFO:tensorflow:Average training steps per second: 223.11
I0902 17:58:27.806814 140016423897088 replay_runner.py:36] Average training steps per second: 223.11
I0902 17:58:28.009042 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.35
INFO:tensorflow:Starting iteration 19

Steps executed: 306 Episode length: 159 Return: -268.23824514824884
INFO:tensorflow:Average training steps per second: 218.81
I0902 17:58:36.883270 140016423897088 replay_runner.py:36] Average training steps per second: 218.81
I0902 17:58:37.153264 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.04
INFO:tensorflow:Starting iteration 20

Steps executed: 264 Episode length: 116 Return: -240.41225861555313
INFO:tensorflow:Average training steps per second: 220.91
I0902 17:58:46.031227 140016423897088 replay_runner.py:36] Average training steps per second: 220.91
I0902 17:58:46.266722 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.36
INFO:tensorflow:Starting iteration 21
I0902 17:58:50.539906 140016423897088 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 226.74

Steps executed: 248 Episode length: 143 Return: -309.35152391404325
I0902 17:58:55.154775 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.08
INFO:tensorflow:Starting iteration 22

Steps executed: 251 Episode length: 97 Return: -664.337013528822825
INFO:tensorflow:Average training steps per second: 234.91
I0902 17:59:03.755558 140016423897088 replay_runner.py:36] Average training steps per second: 234.91
I0902 17:59:03.972469 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -545.73
INFO:tensorflow:Starting iteration 23

Steps executed: 163 Episode length: 163 Return: -460.69350250821753
INFO:tensorflow:Average training steps per second: 230.55
I0902 17:59:12.625106 140016423897088 replay_runner.py:36] Average training steps per second: 230.55

Steps executed: 279 Episode length: 116 Return: -80.354822104435663
INFO:tensorflow:Starting iteration 24

Steps executed: 299 Episode length: 143 Return: -388.84056823448453
INFO:tensorflow:Average training steps per second: 222.80
I0902 17:59:21.515455 140016423897088 replay_runner.py:36] Average training steps per second: 222.80
I0902 17:59:21.792923 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.16
INFO:tensorflow:Starting iteration 25

Steps executed: 223 Episode length: 121 Return: -99.346481744459883
INFO:tensorflow:Average training steps per second: 227.61
I0902 17:59:30.501697 140016423897088 replay_runner.py:36] Average training steps per second: 227.61
I0902 17:59:30.688863 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -407.25
INFO:tensorflow:Starting iteration 26

Steps executed: 348 Episode length: 187 Return: -95.309598993150425
INFO:tensorflow:Average training steps per second: 224.49
I0902 17:59:39.438390 140016423897088 replay_runner.py:36] Average training steps per second: 224.49
I0902 17:59:39.756939 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.35
INFO:tensorflow:Starting iteration 27

Steps executed: 413 Episode length: 225 Return: -249.42710596700678
INFO:tensorflow:Average training steps per second: 225.89
I0902 17:59:48.441451 140016423897088 replay_runner.py:36] Average training steps per second: 225.89
I0902 17:59:48.808096 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.23
INFO:tensorflow:Starting iteration 28
I0902 17:59:52.985305 140016423897088 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 227.30

Steps executed: 245 Episode length: 144 Return: -447.23486762329935
I0902 17:59:57.596531 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.47
INFO:tensorflow:Starting iteration 29

Steps executed: 284 Episode length: 131 Return: -403.29837068641857
INFO:tensorflow:Average training steps per second: 226.12
I0902 18:00:06.151936 140016423897088 replay_runner.py:36] Average training steps per second: 226.12

Done fixed training!Episode length: 131 Return: -403.29837068641857