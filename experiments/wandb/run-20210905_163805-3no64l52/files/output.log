Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0905 16:38:11.093538 139803301922816 run_experiment.py:549] Creating TrainRunner ...
I0905 16:38:11.103243 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:38:11.103404 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:38:11.103536 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:38:11.103654 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:38:11.103751 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:38:11.103848 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:38:11.103954 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:38:11.104077 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:38:11.104197 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:38:11.104349 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:38:11.104459 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:38:11.104556 139803301922816 dqn_agent.py:283] 	 seed: 1630859891103204
I0905 16:38:11.107024 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:38:11.107167 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:38:11.107290 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:38:11.107405 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:38:11.107506 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:38:11.107608 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:38:11.107699 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:38:11.107789 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:38:11.107899 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:38:12.137328 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:12.327288 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:12.334346 139803301922816 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:38:12.339366 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:38:12.339487 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:38:12.339539 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:38:12.339592 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:38:12.339643 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:38:12.339729 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:38:12.339776 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:38:12.339839 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:38:12.339882 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:38:12.339974 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:38:12.340027 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:38:12.340074 139803301922816 dqn_agent.py:283] 	 seed: 1630859892339341
I0905 16:38:12.341476 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:38:12.341595 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:38:12.341667 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:38:12.341746 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:38:12.341805 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:38:12.341881 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:38:12.341942 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:38:12.342018 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:38:12.342089 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:38:12.359748 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:12.371222 139803301922816 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:38:12.371388 139803301922816 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 281.27
I0905 16:38:15.926922 139803301922816 replay_runner.py:36] Average training steps per second: 281.27
Steps executed: 222 Episode length: 140 Return: -336.190400051242
I0905 16:38:16.710564 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.36
INFO:tensorflow:Starting iteration 1
I0905 16:38:19.623026 139803301922816 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 335.14

Steps executed: 273 Episode length: 101 Return: -266.1480875302658
I0905 16:38:22.787279 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.92
INFO:tensorflow:Starting iteration 2
I0905 16:38:25.734211 139803301922816 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 356.58

Steps executed: 265 Episode length: 265 Return: -164.83810994181079
I0905 16:38:28.725767 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.84
INFO:tensorflow:Starting iteration 3

Steps executed: 424 Episode length: 280 Return: -528.59590455197679
INFO:tensorflow:Average training steps per second: 362.31
I0905 16:38:34.996524 139803301922816 replay_runner.py:36] Average training steps per second: 362.31
I0905 16:38:35.292448 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.10
INFO:tensorflow:Starting iteration 4
I0905 16:38:38.764461 139803301922816 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 341.94

Steps executed: 1000 Episode length: 1000 Return: -102.3494806923601
I0905 16:38:43.245123 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.35
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -141.8034705942913
INFO:tensorflow:Average training steps per second: 358.80
I0905 16:38:49.455399 139803301922816 replay_runner.py:36] Average training steps per second: 358.80
I0905 16:38:50.663627 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.80
INFO:tensorflow:Starting iteration 6

Steps executed: 707 Episode length: 707 Return: -436.473960415362813
INFO:tensorflow:Average training steps per second: 353.31
I0905 16:38:56.907789 139803301922816 replay_runner.py:36] Average training steps per second: 353.31
I0905 16:38:58.098319 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.47
INFO:tensorflow:Starting iteration 7

Steps executed: 357 Episode length: 357 Return: -263.420841427793333
INFO:tensorflow:Average training steps per second: 367.45
I0905 16:39:04.192181 139803301922816 replay_runner.py:36] Average training steps per second: 367.45
I0905 16:39:04.513240 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.42
INFO:tensorflow:Starting iteration 8
I0905 16:39:07.945519 139803301922816 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 354.20

Steps executed: 414 Episode length: 414 Return: -355.513516315914833
I0905 16:39:11.112075 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.51
INFO:tensorflow:Starting iteration 9

Steps executed: 450 Episode length: 450 Return: -327.135295140230373
INFO:tensorflow:Average training steps per second: 331.78
I0905 16:39:17.467124 139803301922816 replay_runner.py:36] Average training steps per second: 331.78
I0905 16:39:17.988977 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.14
INFO:tensorflow:Starting iteration 10

Steps executed: 275 Episode length: 176 Return: -318.238175186277873
INFO:tensorflow:Average training steps per second: 319.89
I0905 16:39:24.343192 139803301922816 replay_runner.py:36] Average training steps per second: 319.89
I0905 16:39:24.543858 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.98
INFO:tensorflow:Starting iteration 11

Steps executed: 192 Episode length: 192 Return: -482.875187127890063
INFO:tensorflow:Average training steps per second: 331.84

Steps executed: 550 Episode length: 358 Return: -430.941249266433063
I0905 16:39:31.301829 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.91
INFO:tensorflow:Starting iteration 12

Steps executed: 646 Episode length: 646 Return: -366.472120221630633
INFO:tensorflow:Average training steps per second: 363.62
I0905 16:39:37.385662 139803301922816 replay_runner.py:36] Average training steps per second: 363.62
I0905 16:39:38.440846 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.47
INFO:tensorflow:Starting iteration 13
I0905 16:39:41.863428 139803301922816 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 373.48

Steps executed: 605 Episode length: 605 Return: -388.941784304801333
I0905 16:39:45.489454 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.94
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 169 Return: -103.985601599696513
INFO:tensorflow:Average training steps per second: 363.15
I0905 16:39:51.707924 139803301922816 replay_runner.py:36] Average training steps per second: 363.15
I0905 16:39:51.863375 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.98
INFO:tensorflow:Starting iteration 15

Steps executed: 130 Episode length: 130 Return: -774.128223711858413
INFO:tensorflow:Average training steps per second: 360.95

Steps executed: 1130 Episode length: 1000 Return: -174.92034787597575
I0905 16:40:00.010425 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.52
INFO:tensorflow:Starting iteration 16

Steps executed: 245 Episode length: 245 Return: -213.0989816057132275
INFO:tensorflow:Average training steps per second: 347.24
I0905 16:40:06.316363 139803301922816 replay_runner.py:36] Average training steps per second: 347.24
I0905 16:40:06.502205 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.10
INFO:tensorflow:Starting iteration 17

Steps executed: 75 Episode length: 75 Return: -137.833252670165252275
INFO:tensorflow:Average training steps per second: 338.86
I0905 16:40:12.890046 139803301922816 replay_runner.py:36] Average training steps per second: 338.86

Steps executed: 435 Episode length: 360 Return: -252.1363430172927275
INFO:tensorflow:Starting iteration 18

Steps executed: 303 Episode length: 156 Return: -33.46201384734114575
INFO:tensorflow:Average training steps per second: 340.38
I0905 16:40:19.609822 139803301922816 replay_runner.py:36] Average training steps per second: 340.38
I0905 16:40:19.819317 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.47
INFO:tensorflow:Starting iteration 19

Steps executed: 209 Episode length: 209 Return: -445.0731436799561675
INFO:tensorflow:Average training steps per second: 351.67
I0905 16:40:26.103408 139803301922816 replay_runner.py:36] Average training steps per second: 351.67
I0905 16:40:26.267298 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.07
INFO:tensorflow:Starting iteration 20

Steps executed: 499 Episode length: 386 Return: -324.9134087057128675
INFO:tensorflow:Average training steps per second: 336.98
I0905 16:40:32.664561 139803301922816 replay_runner.py:36] Average training steps per second: 336.98
I0905 16:40:33.185416 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.11
INFO:tensorflow:Starting iteration 21

Steps executed: 325 Episode length: 254 Return: -18.63782030911898675
INFO:tensorflow:Average training steps per second: 331.05
I0905 16:40:39.609382 139803301922816 replay_runner.py:36] Average training steps per second: 331.05
I0905 16:40:39.862604 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.14
INFO:tensorflow:Starting iteration 22

Steps executed: 248 Episode length: 69 Return: -160.20307414550294675
INFO:tensorflow:Average training steps per second: 327.27
I0905 16:40:46.290227 139803301922816 replay_runner.py:36] Average training steps per second: 327.27
I0905 16:40:46.405387 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.89
INFO:tensorflow:Starting iteration 23

Steps executed: 230 Episode length: 110 Return: -673.7190105409846675
INFO:tensorflow:Average training steps per second: 317.48
I0905 16:40:52.767654 139803301922816 replay_runner.py:36] Average training steps per second: 317.48
I0905 16:40:52.895750 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.38
INFO:tensorflow:Starting iteration 24

Steps executed: 300 Episode length: 134 Return: -190.1185759813570875
INFO:tensorflow:Average training steps per second: 315.18
I0905 16:40:59.319082 139803301922816 replay_runner.py:36] Average training steps per second: 315.18
I0905 16:40:59.524521 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.33
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 139 Return: -371.4241728642495675
INFO:tensorflow:Average training steps per second: 353.15
I0905 16:41:05.575866 139803301922816 replay_runner.py:36] Average training steps per second: 353.15
I0905 16:41:05.723770 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.59
INFO:tensorflow:Starting iteration 26

Steps executed: 320 Episode length: 168 Return: -323.7272444024195675
INFO:tensorflow:Average training steps per second: 363.38
I0905 16:41:11.954622 139803301922816 replay_runner.py:36] Average training steps per second: 363.38
I0905 16:41:12.135897 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.26
INFO:tensorflow:Starting iteration 27

Steps executed: 311 Episode length: 128 Return: -223.5158918686448675
INFO:tensorflow:Average training steps per second: 370.29
I0905 16:41:18.413875 139803301922816 replay_runner.py:36] Average training steps per second: 370.29
I0905 16:41:18.572797 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.99
INFO:tensorflow:Starting iteration 28

Steps executed: 278 Episode length: 152 Return: -404.5706706822756475
INFO:tensorflow:Average training steps per second: 355.15
I0905 16:41:24.893841 139803301922816 replay_runner.py:36] Average training steps per second: 355.15
I0905 16:41:25.037466 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -374.17
INFO:tensorflow:Starting iteration 29
I0905 16:41:28.421948 139803301922816 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 347.59

Steps executed: 417 Episode length: 228 Return: -528.0882400793325475

Done fixed training!Episode length: 228 Return: -528.0882400793325475