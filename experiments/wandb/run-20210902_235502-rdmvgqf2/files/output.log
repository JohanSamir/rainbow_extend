Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0902 23:55:09.496456 140549568862208 run_experiment.py:549] Creating TrainRunner ...
I0902 23:55:09.505989 140549568862208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:09.506191 140549568862208 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:09.506275 140549568862208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:09.506364 140549568862208 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:09.506492 140549568862208 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:09.506559 140549568862208 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:55:09.506613 140549568862208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:09.506760 140549568862208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:09.506817 140549568862208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:09.506882 140549568862208 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:09.506937 140549568862208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:09.507349 140549568862208 dqn_agent.py:283] 	 seed: 1630626909505927
I0902 23:55:09.510159 140549568862208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:09.510323 140549568862208 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:55:09.510419 140549568862208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:09.510509 140549568862208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:09.510654 140549568862208 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:09.510749 140549568862208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:09.510814 140549568862208 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:09.510880 140549568862208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:09.510974 140549568862208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:09.550531 140549568862208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:10.065184 140549568862208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:10.079861 140549568862208 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:55:10.090539 140549568862208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:10.090766 140549568862208 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:10.090876 140549568862208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:10.090961 140549568862208 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:10.091031 140549568862208 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:10.091111 140549568862208 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:55:10.091204 140549568862208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:10.091275 140549568862208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:10.091338 140549568862208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:10.091418 140549568862208 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:10.091499 140549568862208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:10.091557 140549568862208 dqn_agent.py:283] 	 seed: 1630626910090486
I0902 23:55:10.093702 140549568862208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:10.093975 140549568862208 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:55:10.094136 140549568862208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:10.094344 140549568862208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:10.094633 140549568862208 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:10.094795 140549568862208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:10.095073 140549568862208 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:10.095341 140549568862208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:10.095654 140549568862208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:10.131139 140549568862208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:10.156274 140549568862208 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:55:10.156588 140549568862208 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.23
I0902 23:55:16.995439 140549568862208 replay_runner.py:36] Average training steps per second: 146.23
Steps executed: 205 Episode length: 11 Return: 11.0
I0902 23:55:18.154231 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.64
INFO:tensorflow:Starting iteration 1

Steps executed: 376 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.86
I0902 23:55:23.526051 140549568862208 replay_runner.py:36] Average training steps per second: 192.86
I0902 23:55:23.786716 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 2
I0902 23:55:23.985195 140549568862208 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.55

Steps executed: 204 Episode length: 11 Return: 11.0.0
I0902 23:55:29.285761 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.60
INFO:tensorflow:Starting iteration 3

Steps executed: 252 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.45
I0902 23:55:34.688690 140549568862208 replay_runner.py:36] Average training steps per second: 191.45
I0902 23:55:34.854572 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.40
INFO:tensorflow:Starting iteration 4

Steps executed: 231 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 196.65
I0902 23:55:40.126393 140549568862208 replay_runner.py:36] Average training steps per second: 196.65
I0902 23:55:40.279522 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.50
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.56
I0902 23:55:45.773266 140549568862208 replay_runner.py:36] Average training steps per second: 188.56
I0902 23:55:45.905608 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 273 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 202.14
I0902 23:55:51.029401 140549568862208 replay_runner.py:36] Average training steps per second: 202.14
I0902 23:55:51.212697 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 7

Steps executed: 378 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.74
I0902 23:55:56.379293 140549568862208 replay_runner.py:36] Average training steps per second: 200.74
I0902 23:55:56.689584 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 8

Steps executed: 318 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 203.10
I0902 23:56:01.801793 140549568862208 replay_runner.py:36] Average training steps per second: 203.10
I0902 23:56:02.000908 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 9

Steps executed: 269 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 205.18
I0902 23:56:07.065321 140549568862208 replay_runner.py:36] Average training steps per second: 205.18
I0902 23:56:07.232956 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.50
INFO:tensorflow:Starting iteration 10

Steps executed: 317 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 200.67
I0902 23:56:12.444355 140549568862208 replay_runner.py:36] Average training steps per second: 200.67
I0902 23:56:12.652533 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 11

Steps executed: 331 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 195.59
I0902 23:56:17.950897 140549568862208 replay_runner.py:36] Average training steps per second: 195.59
I0902 23:56:18.177836 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 12

Steps executed: 248 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 199.84
I0902 23:56:23.376842 140549568862208 replay_runner.py:36] Average training steps per second: 199.84
I0902 23:56:23.553977 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 13

Steps executed: 318 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 197.18
I0902 23:56:28.821882 140549568862208 replay_runner.py:36] Average training steps per second: 197.18
I0902 23:56:29.030411 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 14

Steps executed: 209 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 195.23
I0902 23:56:34.343899 140549568862208 replay_runner.py:36] Average training steps per second: 195.23
I0902 23:56:34.499899 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 104.50
INFO:tensorflow:Starting iteration 15

Steps executed: 258 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 192.61
I0902 23:56:39.892151 140549568862208 replay_runner.py:36] Average training steps per second: 192.61
I0902 23:56:40.076547 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.00
INFO:tensorflow:Starting iteration 16
I0902 23:56:40.267632 140549568862208 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 193.51
I0902 23:56:45.435777 140549568862208 replay_runner.py:36] Average training steps per second: 193.51
I0902 23:56:45.627009 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 17


Steps executed: 310 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 194.42
I0902 23:56:50.952370 140549568862208 replay_runner.py:36] Average training steps per second: 194.42
I0902 23:56:51.158074 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.05
I0902 23:56:56.405336 140549568862208 replay_runner.py:36] Average training steps per second: 197.05
I0902 23:56:56.547224 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 236 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 198.04
I0902 23:57:01.790829 140549568862208 replay_runner.py:36] Average training steps per second: 198.04
I0902 23:57:01.955322 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.71
I0902 23:57:07.365262 140549568862208 replay_runner.py:36] Average training steps per second: 191.71
I0902 23:57:07.510370 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:57:07.703039 140549568862208 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 202.03
I0902 23:57:12.653263 140549568862208 replay_runner.py:36] Average training steps per second: 202.03
I0902 23:57:12.788333 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:57:12.980156 140549568862208 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.23
I0902 23:57:18.102628 140549568862208 replay_runner.py:36] Average training steps per second: 195.23
I0902 23:57:18.238085 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:57:18.420140 140549568862208 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 202.44
I0902 23:57:23.360346 140549568862208 replay_runner.py:36] Average training steps per second: 202.44
I0902 23:57:23.488883 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:57:23.677036 140549568862208 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 199.39
I0902 23:57:28.692745 140549568862208 replay_runner.py:36] Average training steps per second: 199.39
I0902 23:57:28.827109 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:57:29.012180 140549568862208 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 202.50
I0902 23:57:33.950731 140549568862208 replay_runner.py:36] Average training steps per second: 202.50
I0902 23:57:34.073722 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:57:34.254478 140549568862208 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.87
I0902 23:57:39.283329 140549568862208 replay_runner.py:36] Average training steps per second: 198.87
I0902 23:57:39.410757 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:57:39.599012 140549568862208 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 202.43
I0902 23:57:44.539597 140549568862208 replay_runner.py:36] Average training steps per second: 202.43
I0902 23:57:44.656831 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:57:44.836370 140549568862208 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.61
I0902 23:57:49.700398 140549568862208 replay_runner.py:36] Average training steps per second: 205.61
I0902 23:57:49.827623 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 209.12
I0902 23:57:54.791103 140549568862208 replay_runner.py:36] Average training steps per second: 209.12
I0902 23:57:54.920226 140549568862208 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00