Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0828 10:28:09.559592 140078257940480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:28:09.570369 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:28:09.570654 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:28:09.570765 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:28:09.570885 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:28:09.570966 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:28:09.571239 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:28:09.571463 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:28:09.571598 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:28:09.571869 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:28:09.572113 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:28:09.572270 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:28:09.572436 140078257940480 dqn_agent.py:283] 	 seed: 1630146489570308
I0828 10:28:09.576229 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:28:09.576554 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:28:09.576690 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:28:09.576843 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:28:09.577013 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:28:09.577177 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:28:09.577400 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:28:09.577548 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:28:09.577732 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:28:09.615228 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:10.002617 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:10.017099 140078257940480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:28:10.025576 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:28:10.025748 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:28:10.025822 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:28:10.025883 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:28:10.025940 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:28:10.026024 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:28:10.026186 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:28:10.026277 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:28:10.026447 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:28:10.026527 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:28:10.026865 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:28:10.027030 140078257940480 dqn_agent.py:283] 	 seed: 1630146490025534
I0828 10:28:10.029893 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:28:10.030145 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:28:10.030258 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:28:10.030359 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:28:10.030539 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:28:10.030779 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:28:10.030920 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:28:10.031140 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:28:10.031248 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:28:10.102561 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:10.125645 140078257940480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:28:10.126144 140078257940480 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.18
I0828 10:28:16.331093 140078257940480 replay_runner.py:36] Average training steps per second: 161.18
Steps executed: 230 Episode length: 54 Return: -235.46320329315837
I0828 10:28:17.637255 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.69
INFO:tensorflow:Starting iteration 1

Steps executed: 368 Episode length: 309 Return: -2403.730312731967
INFO:tensorflow:Average training steps per second: 218.85
I0828 10:28:26.583557 140078257940480 replay_runner.py:36] Average training steps per second: 218.85
I0828 10:28:27.068574 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -1264.43
INFO:tensorflow:Starting iteration 2

Steps executed: 264 Episode length: 81 Return: -383.47440781450456
INFO:tensorflow:Average training steps per second: 218.29
I0828 10:28:36.040261 140078257940480 replay_runner.py:36] Average training steps per second: 218.29
I0828 10:28:36.284502 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.08
INFO:tensorflow:Starting iteration 3

Steps executed: 80 Episode length: 80 Return: -429.212761386944356
INFO:tensorflow:Average training steps per second: 216.47

Steps executed: 243 Episode length: 75 Return: -646.72825125380023
I0828 10:28:45.326804 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -522.70
INFO:tensorflow:Starting iteration 4

Steps executed: 203 Episode length: 88 Return: -495.62118258327885
INFO:tensorflow:Average training steps per second: 214.57
I0828 10:28:54.366037 140078257940480 replay_runner.py:36] Average training steps per second: 214.57
I0828 10:28:54.560407 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.03
INFO:tensorflow:Starting iteration 5

Steps executed: 215 Episode length: 128 Return: -415.2212141357909
INFO:tensorflow:Average training steps per second: 222.30
I0828 10:29:03.448177 140078257940480 replay_runner.py:36] Average training steps per second: 222.30
I0828 10:29:03.619746 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.26
INFO:tensorflow:Starting iteration 6

Steps executed: 254 Episode length: 133 Return: -341.7629891174789
INFO:tensorflow:Average training steps per second: 216.51
I0828 10:29:12.646854 140078257940480 replay_runner.py:36] Average training steps per second: 216.51
I0828 10:29:12.854523 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -485.83
INFO:tensorflow:Starting iteration 7

Steps executed: 301 Episode length: 132 Return: -397.6239977058861
INFO:tensorflow:Average training steps per second: 217.27
I0828 10:29:21.698200 140078257940480 replay_runner.py:36] Average training steps per second: 217.27
I0828 10:29:21.938599 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.58
INFO:tensorflow:Starting iteration 8

Steps executed: 238 Episode length: 88 Return: -562.69812385768511
INFO:tensorflow:Average training steps per second: 220.91
I0828 10:29:30.836911 140078257940480 replay_runner.py:36] Average training steps per second: 220.91
I0828 10:29:31.015361 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.88
INFO:tensorflow:Starting iteration 9

Steps executed: 276 Episode length: 97 Return: -594.98218994986055
INFO:tensorflow:Average training steps per second: 214.53
I0828 10:29:40.057711 140078257940480 replay_runner.py:36] Average training steps per second: 214.53
I0828 10:29:40.320935 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -596.47
INFO:tensorflow:Starting iteration 10

Steps executed: 189 Episode length: 189 Return: -373.4666661650992
INFO:tensorflow:Average training steps per second: 217.10
I0828 10:29:49.276840 140078257940480 replay_runner.py:36] Average training steps per second: 217.10

Steps executed: 284 Episode length: 95 Return: -282.47431180419122
INFO:tensorflow:Starting iteration 11

Steps executed: 338 Episode length: 193 Return: -1545.978402453747
INFO:tensorflow:Average training steps per second: 218.48
I0828 10:29:58.504111 140078257940480 replay_runner.py:36] Average training steps per second: 218.48
I0828 10:29:58.828777 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -748.41
INFO:tensorflow:Starting iteration 12
I0828 10:30:03.176736 140078257940480 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 220.73

Steps executed: 252 Episode length: 88 Return: -517.15546339190186
I0828 10:30:07.938146 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.70
INFO:tensorflow:Starting iteration 13

Steps executed: 234 Episode length: 111 Return: -766.0122142290695
INFO:tensorflow:Average training steps per second: 216.06
I0828 10:30:16.882854 140078257940480 replay_runner.py:36] Average training steps per second: 216.06
I0828 10:30:17.072873 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -663.47
INFO:tensorflow:Starting iteration 14

Steps executed: 325 Episode length: 190 Return: -1401.2454025600193
INFO:tensorflow:Average training steps per second: 218.53
I0828 10:30:25.863030 140078257940480 replay_runner.py:36] Average training steps per second: 218.53
I0828 10:30:26.218604 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -1174.80
INFO:tensorflow:Starting iteration 15

Steps executed: 295 Episode length: 123 Return: -679.22086279851093
INFO:tensorflow:Average training steps per second: 225.40
I0828 10:30:34.968728 140078257940480 replay_runner.py:36] Average training steps per second: 225.40
I0828 10:30:35.229671 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -647.46
INFO:tensorflow:Starting iteration 16

Steps executed: 234 Episode length: 59 Return: -428.154618998219063
INFO:tensorflow:Average training steps per second: 222.11
I0828 10:30:43.980273 140078257940480 replay_runner.py:36] Average training steps per second: 222.11
I0828 10:30:44.172564 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.68
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 127 Return: -991.93800980313163
INFO:tensorflow:Average training steps per second: 231.02
I0828 10:30:52.877499 140078257940480 replay_runner.py:36] Average training steps per second: 231.02
I0828 10:30:53.065601 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -816.15
INFO:tensorflow:Starting iteration 18
I0828 10:30:57.373556 140078257940480 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 233.53
I0828 10:31:01.656118 140078257940480 replay_runner.py:36] Average training steps per second: 233.53

Steps executed: 251 Episode length: 68 Return: -597.100233587770563
INFO:tensorflow:Starting iteration 19

Steps executed: 273 Episode length: 82 Return: -646.011125005891763
INFO:tensorflow:Average training steps per second: 230.59
I0828 10:31:10.480889 140078257940480 replay_runner.py:36] Average training steps per second: 230.59
I0828 10:31:10.695418 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.17
INFO:tensorflow:Starting iteration 20
I0828 10:31:15.036223 140078257940480 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 221.83
I0828 10:31:19.544670 140078257940480 replay_runner.py:36] Average training steps per second: 221.83

Steps executed: 277 Episode length: 79 Return: -652.434316136112863
INFO:tensorflow:Starting iteration 21

Steps executed: 256 Episode length: 63 Return: -470.697216537672553
INFO:tensorflow:Average training steps per second: 223.74
I0828 10:31:28.648649 140078257940480 replay_runner.py:36] Average training steps per second: 223.74
I0828 10:31:28.868576 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.77
INFO:tensorflow:Starting iteration 22
I0828 10:31:33.065037 140078257940480 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 218.63

Steps executed: 255 Episode length: 61 Return: -494.413209581460253
I0828 10:31:37.858216 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -556.50
INFO:tensorflow:Starting iteration 23

Steps executed: 204 Episode length: 69 Return: -514.171658208116353
INFO:tensorflow:Average training steps per second: 222.52
I0828 10:31:46.809325 140078257940480 replay_runner.py:36] Average training steps per second: 222.52
I0828 10:31:46.976227 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -536.11
INFO:tensorflow:Starting iteration 24
I0828 10:31:51.341905 140078257940480 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 219.40
I0828 10:31:55.900298 140078257940480 replay_runner.py:36] Average training steps per second: 219.40

Steps executed: 238 Episode length: 86 Return: -449.545324232390163
INFO:tensorflow:Starting iteration 25

Steps executed: 207 Episode length: 81 Return: -706.420749026216263
INFO:tensorflow:Average training steps per second: 222.83
I0828 10:32:05.010220 140078257940480 replay_runner.py:36] Average training steps per second: 222.83
I0828 10:32:05.188690 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -587.68
INFO:tensorflow:Starting iteration 26

Steps executed: 257 Episode length: 67 Return: -549.367434139564853
INFO:tensorflow:Average training steps per second: 218.30
I0828 10:32:14.149249 140078257940480 replay_runner.py:36] Average training steps per second: 218.30
I0828 10:32:14.382840 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.49
INFO:tensorflow:Starting iteration 27

Steps executed: 259 Episode length: 68 Return: -499.870074330231133
INFO:tensorflow:Average training steps per second: 221.86
I0828 10:32:23.170251 140078257940480 replay_runner.py:36] Average training steps per second: 221.86
I0828 10:32:23.388367 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -477.86
INFO:tensorflow:Starting iteration 28

Steps executed: 232 Episode length: 67 Return: -606.796617358726733
INFO:tensorflow:Average training steps per second: 221.20
I0828 10:32:32.296487 140078257940480 replay_runner.py:36] Average training steps per second: 221.20
I0828 10:32:32.483535 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -636.82
INFO:tensorflow:Starting iteration 29

Steps executed: 227 Episode length: 82 Return: -879.158311990377733
INFO:tensorflow:Average training steps per second: 220.74
I0828 10:32:41.337576 140078257940480 replay_runner.py:36] Average training steps per second: 220.74

Done fixed training!Episode length: 82 Return: -879.158311990377733