Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 12:34:43.566244 140583573075968 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:43.577506 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:43.577863 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:43.578163 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:43.578343 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:43.578483 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:43.578601 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:43.578705 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:43.578824 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:43.578953 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:43.579445 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:43.579694 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:43.579953 140583573075968 dqn_agent.py:283] 	 seed: 1630499683577448
I0901 12:34:43.583386 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:43.583602 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:43.583733 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:43.583846 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:43.583951 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:43.584047 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:43.584146 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:43.584234 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:43.584316 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:43.629532 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:44.108924 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:44.122849 140583573075968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:44.132306 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:44.132595 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:44.132747 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:44.133103 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:44.133280 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:44.133440 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:44.133741 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:44.134009 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:44.134145 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:44.134258 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:44.134415 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:44.134522 140583573075968 dqn_agent.py:283] 	 seed: 1630499684132230
I0901 12:34:44.137226 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:44.137509 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:44.137660 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:44.137796 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:44.137907 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:44.138029 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:44.138219 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:44.138292 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:44.138362 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:44.177083 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:44.201288 140583573075968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:44.201614 140583573075968 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 139.95
I0901 12:34:51.347337 140583573075968 replay_runner.py:36] Average training steps per second: 139.95
I0901 12:34:52.911310 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:34:53.154204 140583573075968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 185.12
I0901 12:34:58.556650 140583573075968 replay_runner.py:36] Average training steps per second: 185.12
I0901 12:34:58.957281 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:34:59.186588 140583573075968 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.28
I0901 12:35:04.584227 140583573075968 replay_runner.py:36] Average training steps per second: 185.28
I0901 12:35:05.071537 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:35:05.302203 140583573075968 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 185.38
I0901 12:35:10.697124 140583573075968 replay_runner.py:36] Average training steps per second: 185.38
I0901 12:35:11.128738 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 223 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 179.07
I0901 12:35:16.941177 140583573075968 replay_runner.py:36] Average training steps per second: 179.07
I0901 12:35:17.135784 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.01
I0901 12:35:22.745477 140583573075968 replay_runner.py:36] Average training steps per second: 186.01
I0901 12:35:23.206509 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:35:23.465464 140583573075968 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 185.09
I0901 12:35:28.868637 140583573075968 replay_runner.py:36] Average training steps per second: 185.09
I0901 12:35:29.307411 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:35:29.524216 140583573075968 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 183.89
I0901 12:35:34.962521 140583573075968 replay_runner.py:36] Average training steps per second: 183.89
I0901 12:35:35.443722 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:35:35.696686 140583573075968 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 189.62
I0901 12:35:40.971036 140583573075968 replay_runner.py:36] Average training steps per second: 189.62
I0901 12:35:41.442964 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:35:41.678853 140583573075968 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 183.85
I0901 12:35:47.118453 140583573075968 replay_runner.py:36] Average training steps per second: 183.85
I0901 12:35:47.584956 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 169 Episode length: 169 Return: -168.0
INFO:tensorflow:Average training steps per second: 186.76
I0901 12:35:53.194365 140583573075968 replay_runner.py:36] Average training steps per second: 186.76

Steps executed: 407 Episode length: 238 Return: -237.0
INFO:tensorflow:Starting iteration 11
I0901 12:35:53.878518 140583573075968 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 187.21
I0901 12:35:59.220708 140583573075968 replay_runner.py:36] Average training steps per second: 187.21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 12
I0901 12:35:59.938387 140583573075968 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 183.37
I0901 12:36:05.392389 140583573075968 replay_runner.py:36] Average training steps per second: 183.37
I0901 12:36:05.848941 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 297 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 190.00
I0901 12:36:11.362620 140583573075968 replay_runner.py:36] Average training steps per second: 190.00
I0901 12:36:11.661424 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 14
I0901 12:36:11.929319 140583573075968 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 183.80
I0901 12:36:17.370686 140583573075968 replay_runner.py:36] Average training steps per second: 183.80

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 15
I0901 12:36:18.025541 140583573075968 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.29
I0901 12:36:23.309052 140583573075968 replay_runner.py:36] Average training steps per second: 189.29
I0901 12:36:23.777894 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:36:24.043518 140583573075968 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 189.99
I0901 12:36:29.307346 140583573075968 replay_runner.py:36] Average training steps per second: 189.99
I0901 12:36:29.757867 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 463 Episode length: 335 Return: -334.0
INFO:tensorflow:Average training steps per second: 187.08
I0901 12:36:35.363205 140583573075968 replay_runner.py:36] Average training steps per second: 187.08
I0901 12:36:35.776416 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.50
INFO:tensorflow:Starting iteration 18

Steps executed: 196 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 193.79
I0901 12:36:41.188198 140583573075968 replay_runner.py:36] Average training steps per second: 193.79
I0901 12:36:41.462611 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 19

Steps executed: 274 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 188.73
I0901 12:36:47.001099 140583573075968 replay_runner.py:36] Average training steps per second: 188.73
I0901 12:36:47.458397 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.46
I0901 12:36:53.078690 140583573075968 replay_runner.py:36] Average training steps per second: 186.46

Steps executed: 453 Episode length: 453 Return: -452.0
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.90
I0901 12:36:58.904470 140583573075968 replay_runner.py:36] Average training steps per second: 194.90
I0901 12:36:59.319710 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 220 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 196.03
I0901 12:37:04.674831 140583573075968 replay_runner.py:36] Average training steps per second: 196.03
I0901 12:37:04.881795 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.33
INFO:tensorflow:Starting iteration 23

Steps executed: 402 Episode length: 204 Return: -203.0
INFO:tensorflow:Average training steps per second: 194.95
I0901 12:37:10.240315 140583573075968 replay_runner.py:36] Average training steps per second: 194.95
I0901 12:37:10.588948 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 24

Steps executed: 285 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 188.71
I0901 12:37:16.132228 140583573075968 replay_runner.py:36] Average training steps per second: 188.71
I0901 12:37:16.387101 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 25
I0901 12:37:16.625352 140583573075968 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.87

Steps executed: 245 Episode length: 144 Return: -143.0
I0901 12:37:21.956587 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 26

Steps executed: 144 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 188.83
I0901 12:37:27.510641 140583573075968 replay_runner.py:36] Average training steps per second: 188.83

Steps executed: 328 Episode length: 184 Return: -183.0
INFO:tensorflow:Starting iteration 27

Steps executed: 271 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 186.76
I0901 12:37:33.427627 140583573075968 replay_runner.py:36] Average training steps per second: 186.76
I0901 12:37:33.678558 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 28

Steps executed: 284 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 194.73
I0901 12:37:39.033509 140583573075968 replay_runner.py:36] Average training steps per second: 194.73
I0901 12:37:39.301096 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 377 Return: -376.0
INFO:tensorflow:Average training steps per second: 191.56
I0901 12:37:44.779059 140583573075968 replay_runner.py:36] Average training steps per second: 191.56
I0901 12:37:45.103229 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.00