I0902 18:17:50.977873 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 18:17:50.985243 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:50.985377 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:50.985467 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:50.985525 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:50.985578 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:50.985665 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:50.985794 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:50.985860 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:50.985913 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:50.985982 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:50.986053 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:50.986117 140016423897088 dqn_agent.py:283] 	 seed: 1630606670985206
I0902 18:17:50.987754 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:50.987869 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:50.987942 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:50.988002 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:50.988058 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:50.988113 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:50.988179 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:50.988244 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:50.988321 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:51.012120 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:51.253102 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:51.261170 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:17:51.267782 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:17:51.267911 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:17:51.267976 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:17:51.268044 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:17:51.268098 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:17:51.268159 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:17:51.268223 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:17:51.268298 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:17:51.268369 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:17:51.268415 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:17:51.268465 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:17:51.268517 140016423897088 dqn_agent.py:283] 	 seed: 1630606671267755
I0902 18:17:51.269875 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:17:51.269978 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:17:51.270047 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:17:51.270109 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:17:51.270170 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:17:51.270238 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:17:51.270295 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:17:51.270374 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:17:51.270457 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:17:51.289878 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:17:51.303883 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:17:51.304049 140016423897088 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 278.50
I0902 18:17:54.894846 140016423897088 replay_runner.py:36] Average training steps per second: 278.50
I0902 18:17:55.680556 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.62
Steps executed: 245 Episode length: 161 Return: -155.6351860343806
INFO:tensorflow:Starting iteration 1
I0902 18:17:59.086262 140016423897088 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 370.88
I0902 18:18:01.782829 140016423897088 replay_runner.py:36] Average training steps per second: 370.88

Steps executed: 272 Episode length: 129 Return: -246.31823076732977
INFO:tensorflow:Starting iteration 2
I0902 18:18:05.401932 140016423897088 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 345.05
I0902 18:18:08.300297 140016423897088 replay_runner.py:36] Average training steps per second: 345.05

Steps executed: 411 Episode length: 222 Return: -310.87641778581576
INFO:tensorflow:Starting iteration 3
I0902 18:18:11.958070 140016423897088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 326.70
I0902 18:18:15.019201 140016423897088 replay_runner.py:36] Average training steps per second: 326.70

Steps executed: 503 Episode length: 503 Return: 127.658140787283376
INFO:tensorflow:Starting iteration 4
I0902 18:18:18.870200 140016423897088 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 322.08

Steps executed: 1000 Episode length: 1000 Return: -160.86460343370024
I0902 18:18:23.558805 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.86
INFO:tensorflow:Starting iteration 5
I0902 18:18:26.904868 140016423897088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 327.80

Steps executed: 1000 Episode length: 1000 Return: -162.25069295298178
I0902 18:18:31.493017 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.25
INFO:tensorflow:Starting iteration 6
I0902 18:18:34.827480 140016423897088 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 339.84

Steps executed: 762 Episode length: 762 Return: -280.3424602692643478
I0902 18:18:38.949580 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.34
INFO:tensorflow:Starting iteration 7

Steps executed: 211 Episode length: 211 Return: -262.0541815160211478
INFO:tensorflow:Average training steps per second: 336.76
I0902 18:18:45.244091 140016423897088 replay_runner.py:36] Average training steps per second: 336.76
I0902 18:18:45.390840 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.05
INFO:tensorflow:Starting iteration 8

Steps executed: 781 Episode length: 781 Return: -323.8563154247771478
INFO:tensorflow:Average training steps per second: 327.90
I0902 18:18:51.737472 140016423897088 replay_runner.py:36] Average training steps per second: 327.90
I0902 18:18:52.695715 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.86
INFO:tensorflow:Starting iteration 9

Steps executed: 1000 Episode length: 1000 Return: -160.19788404096458
INFO:tensorflow:Average training steps per second: 324.31
I0902 18:18:59.003946 140016423897088 replay_runner.py:36] Average training steps per second: 324.31
I0902 18:19:00.841742 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.20
INFO:tensorflow:Starting iteration 10

Steps executed: 325 Episode length: 325 Return: -735.0497307959369458
INFO:tensorflow:Average training steps per second: 349.80
I0902 18:19:07.094187 140016423897088 replay_runner.py:36] Average training steps per second: 349.80
I0902 18:19:07.400464 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -735.05
INFO:tensorflow:Starting iteration 11
I0902 18:19:10.813757 140016423897088 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 340.84

Steps executed: 1000 Episode length: 1000 Return: -113.88229972358067
I0902 18:19:15.644268 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.88
INFO:tensorflow:Starting iteration 12

Steps executed: 283 Episode length: 161 Return: -153.0954481106484267
INFO:tensorflow:Average training steps per second: 345.42
I0902 18:19:21.998906 140016423897088 replay_runner.py:36] Average training steps per second: 345.42
I0902 18:19:22.167508 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.37
INFO:tensorflow:Starting iteration 13
I0902 18:19:25.606793 140016423897088 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 356.80

Steps executed: 1000 Episode length: 1000 Return: -126.93694725294002
I0902 18:19:30.671968 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.94
INFO:tensorflow:Starting iteration 14

Steps executed: 48 Episode length: 48 Return: -409.015642972452494002
INFO:tensorflow:Average training steps per second: 351.34

Steps executed: 668 Episode length: 620 Return: -323.1586968241503002
I0902 18:19:38.108247 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.09
INFO:tensorflow:Starting iteration 15
I0902 18:19:41.559278 140016423897088 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 371.65

Steps executed: 1000 Episode length: 1000 Return: -85.835200233729202
I0902 18:19:46.309033 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.84
INFO:tensorflow:Starting iteration 16

Steps executed: 227 Episode length: 72 Return: -123.09546161157211202
INFO:tensorflow:Average training steps per second: 346.59
I0902 18:19:52.625799 140016423897088 replay_runner.py:36] Average training steps per second: 346.59
I0902 18:19:52.766112 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.66
INFO:tensorflow:Starting iteration 17

Steps executed: 347 Episode length: 347 Return: -122.4936641958792302
INFO:tensorflow:Average training steps per second: 355.89
I0902 18:19:59.045271 140016423897088 replay_runner.py:36] Average training steps per second: 355.89
I0902 18:19:59.386732 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.49
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -530.5348089956242302
INFO:tensorflow:Average training steps per second: 357.55
I0902 18:20:05.669460 140016423897088 replay_runner.py:36] Average training steps per second: 357.55
I0902 18:20:06.346089 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.53
INFO:tensorflow:Starting iteration 19
I0902 18:20:09.800798 140016423897088 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 354.65

Steps executed: 663 Episode length: 663 Return: -70.78068951704341302
I0902 18:20:13.607212 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.78
INFO:tensorflow:Starting iteration 20

Steps executed: 287 Episode length: 287 Return: -29.02077700424698302
INFO:tensorflow:Average training steps per second: 352.07
I0902 18:20:19.974789 140016423897088 replay_runner.py:36] Average training steps per second: 352.07
I0902 18:20:20.248414 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -29.02
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: -118.3144293132806802
INFO:tensorflow:Average training steps per second: 352.92
I0902 18:20:26.602092 140016423897088 replay_runner.py:36] Average training steps per second: 352.92
I0902 18:20:26.746770 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.31
INFO:tensorflow:Starting iteration 22
I0902 18:20:30.260608 140016423897088 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 355.29

Steps executed: 378 Episode length: 378 Return: -18.44368721992701402
I0902 18:20:33.501367 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.44
INFO:tensorflow:Starting iteration 23

Steps executed: 250 Episode length: 73 Return: -182.14593415172098602
INFO:tensorflow:Average training steps per second: 343.18
I0902 18:20:39.910932 140016423897088 replay_runner.py:36] Average training steps per second: 343.18
I0902 18:20:40.041492 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.86
INFO:tensorflow:Starting iteration 24

Steps executed: 253 Episode length: 64 Return: -313.88946309369024602
INFO:tensorflow:Average training steps per second: 342.55
I0902 18:20:46.410779 140016423897088 replay_runner.py:36] Average training steps per second: 342.55
I0902 18:20:46.544676 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.50
INFO:tensorflow:Starting iteration 25
I0902 18:20:49.935563 140016423897088 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 337.11
I0902 18:20:52.902351 140016423897088 replay_runner.py:36] Average training steps per second: 337.11

Steps executed: 379 Episode length: 379 Return: -588.2677711419012602
INFO:tensorflow:Starting iteration 26

Steps executed: 203 Episode length: 203 Return: -747.0588256445545602
INFO:tensorflow:Average training steps per second: 338.70
I0902 18:20:59.640935 140016423897088 replay_runner.py:36] Average training steps per second: 338.70
I0902 18:20:59.775664 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -747.06
INFO:tensorflow:Starting iteration 27

Steps executed: 309 Episode length: 122 Return: -513.1921418462967302
INFO:tensorflow:Average training steps per second: 342.13
I0902 18:21:06.010842 140016423897088 replay_runner.py:36] Average training steps per second: 342.13
I0902 18:21:06.190034 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.41
INFO:tensorflow:Starting iteration 28

Steps executed: 356 Episode length: 356 Return: -419.5512716885623302
INFO:tensorflow:Average training steps per second: 339.74
I0902 18:21:12.476480 140016423897088 replay_runner.py:36] Average training steps per second: 339.74
I0902 18:21:12.790999 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.55
INFO:tensorflow:Starting iteration 29

Steps executed: 217 Episode length: 89 Return: -70.525948162228083302
INFO:tensorflow:Average training steps per second: 342.33
I0902 18:21:18.985691 140016423897088 replay_runner.py:36] Average training steps per second: 342.33

Done fixed training!Episode length: 89 Return: -70.525948162228083302