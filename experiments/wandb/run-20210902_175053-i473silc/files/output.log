Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 17:51:00.013144 139977662982144 run_experiment.py:549] Creating TrainRunner ...
I0902 17:51:00.025677 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:51:00.025931 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:51:00.026064 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:51:00.026154 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:51:00.026232 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 17:51:00.026304 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:51:00.026655 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:51:00.026841 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:51:00.027245 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:51:00.027383 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 17:51:00.027484 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:51:00.027577 139977662982144 dqn_agent.py:283] 	 seed: 1630605060025618
I0902 17:51:00.032549 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:51:00.032837 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:51:00.032980 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:51:00.033089 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:51:00.033179 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:51:00.033265 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:51:00.033351 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:51:00.033444 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:51:00.033544 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:51:00.076082 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:51:00.480003 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:51:00.499714 139977662982144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:51:00.524956 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:51:00.525175 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:51:00.525280 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:51:00.525376 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:51:00.525436 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 17:51:00.525492 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:51:00.525569 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:51:00.525620 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:51:00.525672 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:51:00.525722 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 17:51:00.525813 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:51:00.525866 139977662982144 dqn_agent.py:283] 	 seed: 1630605060524914
I0902 17:51:00.528654 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:51:00.528893 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:51:00.529119 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:51:00.529210 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:51:00.529413 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:51:00.529718 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:51:00.529966 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:51:00.530088 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:51:00.530157 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:51:00.565251 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:51:00.587080 139977662982144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:51:00.587297 139977662982144 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 162.07
I0902 17:51:06.757721 139977662982144 replay_runner.py:36] Average training steps per second: 162.07
Steps executed: 209 Episode length: 71 Return: -653.77144694862357
I0902 17:51:07.954329 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.55
INFO:tensorflow:Starting iteration 1

Steps executed: 239 Episode length: 62 Return: -561.08218194346662
INFO:tensorflow:Average training steps per second: 218.09
I0902 17:51:16.910108 139977662982144 replay_runner.py:36] Average training steps per second: 218.09
I0902 17:51:17.126237 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -711.07
INFO:tensorflow:Starting iteration 2

Steps executed: 214 Episode length: 99 Return: -775.67890789366325
INFO:tensorflow:Average training steps per second: 218.45
I0902 17:51:26.044312 139977662982144 replay_runner.py:36] Average training steps per second: 218.45
I0902 17:51:26.245299 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -762.94
INFO:tensorflow:Starting iteration 3

Steps executed: 234 Episode length: 113 Return: -242.00546261689001
INFO:tensorflow:Average training steps per second: 221.55
I0902 17:51:35.063895 139977662982144 replay_runner.py:36] Average training steps per second: 221.55
I0902 17:51:35.255307 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.86
INFO:tensorflow:Starting iteration 4

Steps executed: 274 Episode length: 125 Return: -265.32190820214511
INFO:tensorflow:Average training steps per second: 218.66
I0902 17:51:44.177714 139977662982144 replay_runner.py:36] Average training steps per second: 218.66
I0902 17:51:44.411041 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.85
INFO:tensorflow:Starting iteration 5

Steps executed: 345 Episode length: 188 Return: -85.785841087557098
INFO:tensorflow:Average training steps per second: 220.25
I0902 17:51:53.335031 139977662982144 replay_runner.py:36] Average training steps per second: 220.25
I0902 17:51:53.628355 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.48
INFO:tensorflow:Starting iteration 6

Steps executed: 325 Episode length: 149 Return: -397.41991911594198
INFO:tensorflow:Average training steps per second: 222.16
I0902 17:52:02.517601 139977662982144 replay_runner.py:36] Average training steps per second: 222.16
I0902 17:52:02.808862 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.94
INFO:tensorflow:Starting iteration 7

Steps executed: 195 Episode length: 195 Return: -592.60848149431858
INFO:tensorflow:Average training steps per second: 221.80

Steps executed: 353 Episode length: 158 Return: -130.87052241843543
I0902 17:52:12.038633 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.74
INFO:tensorflow:Starting iteration 8

Steps executed: 340 Episode length: 141 Return: -189.54361806541543
INFO:tensorflow:Average training steps per second: 216.19
I0902 17:52:20.991637 139977662982144 replay_runner.py:36] Average training steps per second: 216.19
I0902 17:52:21.278198 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.88
INFO:tensorflow:Starting iteration 9

Steps executed: 262 Episode length: 173 Return: -107.46746170615458
INFO:tensorflow:Average training steps per second: 130.38
I0902 17:52:33.128585 139977662982144 replay_runner.py:36] Average training steps per second: 130.38
I0902 17:52:33.396601 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.63
INFO:tensorflow:Starting iteration 10

Steps executed: 522 Episode length: 324 Return: -471.63170107789216
INFO:tensorflow:Average training steps per second: 220.18
I0902 17:52:42.341905 139977662982144 replay_runner.py:36] Average training steps per second: 220.18
I0902 17:52:42.918376 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.44
INFO:tensorflow:Starting iteration 11

Steps executed: 213 Episode length: 119 Return: -452.65497501164987
INFO:tensorflow:Average training steps per second: 218.86
I0902 17:52:51.851053 139977662982144 replay_runner.py:36] Average training steps per second: 218.86
I0902 17:52:52.034699 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.17
INFO:tensorflow:Starting iteration 12

Steps executed: 317 Episode length: 317 Return: -429.47123699298237
INFO:tensorflow:Average training steps per second: 224.57
I0902 17:53:00.804655 139977662982144 replay_runner.py:36] Average training steps per second: 224.57
I0902 17:53:01.172296 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.47
INFO:tensorflow:Starting iteration 13

Steps executed: 319 Episode length: 192 Return: -300.22090979979816
INFO:tensorflow:Average training steps per second: 244.04
I0902 17:53:09.488017 139977662982144 replay_runner.py:36] Average training steps per second: 244.04
I0902 17:53:09.807775 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.71
INFO:tensorflow:Starting iteration 14
I0902 17:53:14.024899 139977662982144 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 233.98

Steps executed: 233 Episode length: 80 Return: -363.982471700139575
I0902 17:53:18.509689 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.24
INFO:tensorflow:Starting iteration 15

Steps executed: 259 Episode length: 259 Return: -155.47347693475666
INFO:tensorflow:Average training steps per second: 225.05
I0902 17:53:27.337429 139977662982144 replay_runner.py:36] Average training steps per second: 225.05
I0902 17:53:27.630638 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.47
INFO:tensorflow:Starting iteration 16

Steps executed: 305 Episode length: 166 Return: -183.57289172099536
INFO:tensorflow:Average training steps per second: 225.00
I0902 17:53:36.494294 139977662982144 replay_runner.py:36] Average training steps per second: 225.00
I0902 17:53:36.733338 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.88
INFO:tensorflow:Starting iteration 17

Steps executed: 241 Episode length: 97 Return: -276.903872043609693
INFO:tensorflow:Average training steps per second: 228.02
I0902 17:53:45.407254 139977662982144 replay_runner.py:36] Average training steps per second: 228.02
I0902 17:53:45.589506 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.91
INFO:tensorflow:Starting iteration 18

Steps executed: 258 Episode length: 79 Return: -433.952122781670776
INFO:tensorflow:Average training steps per second: 227.65
I0902 17:53:54.329510 139977662982144 replay_runner.py:36] Average training steps per second: 227.65
I0902 17:53:54.572280 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.91
INFO:tensorflow:Starting iteration 19

Steps executed: 215 Episode length: 215 Return: -288.08518317067706
INFO:tensorflow:Average training steps per second: 219.63
I0902 17:54:03.400362 139977662982144 replay_runner.py:36] Average training steps per second: 219.63
I0902 17:54:03.615947 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.09
INFO:tensorflow:Starting iteration 20

Steps executed: 321 Episode length: 153 Return: -193.99778696315076
INFO:tensorflow:Average training steps per second: 221.96
I0902 17:54:12.457435 139977662982144 replay_runner.py:36] Average training steps per second: 221.96
I0902 17:54:12.737173 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.69
INFO:tensorflow:Starting iteration 21

Steps executed: 291 Episode length: 205 Return: -229.93339622063276
INFO:tensorflow:Average training steps per second: 222.65
I0902 17:54:21.593042 139977662982144 replay_runner.py:36] Average training steps per second: 222.65
I0902 17:54:21.877225 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.66
INFO:tensorflow:Starting iteration 22

Steps executed: 278 Episode length: 104 Return: -306.00383763636237
INFO:tensorflow:Average training steps per second: 216.37
I0902 17:54:30.895994 139977662982144 replay_runner.py:36] Average training steps per second: 216.37
I0902 17:54:31.149416 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.88
INFO:tensorflow:Starting iteration 23

Steps executed: 110 Episode length: 110 Return: -482.92913412873897
INFO:tensorflow:Average training steps per second: 218.58
I0902 17:54:40.043125 139977662982144 replay_runner.py:36] Average training steps per second: 218.58

Steps executed: 236 Episode length: 126 Return: -216.33664009447432
INFO:tensorflow:Starting iteration 24

Steps executed: 260 Episode length: 125 Return: -386.58060506635763
INFO:tensorflow:Average training steps per second: 216.86
I0902 17:54:49.295178 139977662982144 replay_runner.py:36] Average training steps per second: 216.86
I0902 17:54:49.519325 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.27
INFO:tensorflow:Starting iteration 25

Steps executed: 420 Episode length: 231 Return: -502.94943620742214
INFO:tensorflow:Average training steps per second: 222.30
I0902 17:54:58.448446 139977662982144 replay_runner.py:36] Average training steps per second: 222.30
I0902 17:54:58.865998 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.14
INFO:tensorflow:Starting iteration 26

Steps executed: 484 Episode length: 288 Return: -155.04689211974414
INFO:tensorflow:Average training steps per second: 222.49
I0902 17:55:07.634397 139977662982144 replay_runner.py:36] Average training steps per second: 222.49
I0902 17:55:08.122749 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.73
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 116 Return: -273.02192016943524
INFO:tensorflow:Average training steps per second: 224.13
I0902 17:55:16.952081 139977662982144 replay_runner.py:36] Average training steps per second: 224.13
I0902 17:55:17.131924 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.64
INFO:tensorflow:Starting iteration 28

Steps executed: 261 Episode length: 178 Return: -258.38319342199354
INFO:tensorflow:Average training steps per second: 225.52
I0902 17:55:25.934012 139977662982144 replay_runner.py:36] Average training steps per second: 225.52
I0902 17:55:26.155690 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.64
INFO:tensorflow:Starting iteration 29

Steps executed: 307 Episode length: 111 Return: -291.84108305917152
INFO:tensorflow:Average training steps per second: 224.27
I0902 17:55:34.927648 139977662982144 replay_runner.py:36] Average training steps per second: 224.27

Done fixed training!Episode length: 111 Return: -291.84108305917152