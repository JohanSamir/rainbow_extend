Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 23:59:59.420836 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0901 23:59:59.433204 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:59.433484 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:59.433640 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:59.433751 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:59.433862 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:59.433968 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:59:59.434085 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:59.434307 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:59.434425 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:59.434564 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:59.434662 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:59.434820 139644712736768 dqn_agent.py:283] 	 seed: 1630540799433143
I0901 23:59:59.437628 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:59.437788 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:59:59.437889 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:59.437972 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:59.438027 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:59.438076 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:59.438168 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:59.438236 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:59.438289 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:59.478755 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:59.861677 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:59.876839 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:59:59.885823 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:59.886060 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:59.886225 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:59.886353 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:59.886486 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:59.886617 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:59:59.886718 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:59.886850 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:59.886971 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:59.887118 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:59.887404 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:59.887619 139644712736768 dqn_agent.py:283] 	 seed: 1630540799885772
I0901 23:59:59.890728 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:59.890935 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:59:59.891066 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:59.891182 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:59.891325 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:59.891437 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:59.891662 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:59.891955 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:59.892294 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:59.964578 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:59.988285 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:59:59.988705 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 169.52
I0902 00:00:05.888113 139644712736768 replay_runner.py:36] Average training steps per second: 169.52
Steps executed: 221 Episode length: 99 Return: -565.606236925947836
I0902 00:00:07.095073 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.37
INFO:tensorflow:Starting iteration 1

Steps executed: 363 Episode length: 167 Return: -348.43525879156426
INFO:tensorflow:Average training steps per second: 224.87
I0902 00:00:15.897916 139644712736768 replay_runner.py:36] Average training steps per second: 224.87
I0902 00:00:16.206636 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.71
INFO:tensorflow:Starting iteration 2

Steps executed: 256 Episode length: 123 Return: -304.46332219531827
INFO:tensorflow:Average training steps per second: 227.41
I0902 00:00:24.746558 139644712736768 replay_runner.py:36] Average training steps per second: 227.41
I0902 00:00:24.964106 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.55
INFO:tensorflow:Starting iteration 3

Steps executed: 263 Episode length: 115 Return: -353.69268020123536
INFO:tensorflow:Average training steps per second: 222.38
I0902 00:00:33.781647 139644712736768 replay_runner.py:36] Average training steps per second: 222.38
I0902 00:00:34.041439 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.38
INFO:tensorflow:Starting iteration 4
I0902 00:00:38.360493 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 217.88

Steps executed: 1000 Episode length: 1000 Return: -178.85411178637167
I0902 00:00:45.952219 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.85
INFO:tensorflow:Starting iteration 5
I0902 00:00:50.206380 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.03

Steps executed: 1000 Episode length: 1000 Return: -110.70533341378069
I0902 00:00:58.656257 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.71
INFO:tensorflow:Starting iteration 6

Steps executed: 523 Episode length: 523 Return: -324.0447027859811469
INFO:tensorflow:Average training steps per second: 219.52
I0902 00:01:07.536719 139644712736768 replay_runner.py:36] Average training steps per second: 219.52
I0902 00:01:08.551324 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.04
INFO:tensorflow:Starting iteration 7
I0902 00:01:12.846536 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 221.05

Steps executed: 862 Episode length: 862 Return: -438.7204062061088669
I0902 00:01:18.932210 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.72
INFO:tensorflow:Starting iteration 8

Steps executed: 389 Episode length: 389 Return: -385.5833478372896669
INFO:tensorflow:Average training steps per second: 227.20
I0902 00:01:27.706796 139644712736768 replay_runner.py:36] Average training steps per second: 227.20
I0902 00:01:28.269112 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -385.58
INFO:tensorflow:Starting iteration 9
I0902 00:01:32.376903 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 224.60

Steps executed: 404 Episode length: 404 Return: -416.3862251607886669
I0902 00:01:37.568994 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -416.39
INFO:tensorflow:Starting iteration 10

Steps executed: 135 Episode length: 135 Return: -141.9199432674164669
INFO:tensorflow:Average training steps per second: 231.47

Steps executed: 1060 Episode length: 925 Return: -562.013229412553369
I0902 00:01:48.061745 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.97
INFO:tensorflow:Starting iteration 11
I0902 00:01:52.275047 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 236.18

Steps executed: 1000 Episode length: 1000 Return: -226.67290056174446
I0902 00:01:58.944752 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.67
INFO:tensorflow:Starting iteration 12
I0902 00:02:03.184169 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 224.12

Steps executed: 1000 Episode length: 1000 Return: -61.416236992440366
I0902 00:02:11.066743 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.42
INFO:tensorflow:Starting iteration 13
I0902 00:02:15.300759 139644712736768 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 215.49

Steps executed: 1000 Episode length: 1000 Return: -112.50076593797422
I0902 00:02:22.658504 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 14
I0902 00:02:27.052534 139644712736768 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 216.01

Steps executed: 262 Episode length: 136 Return: -912.0794753441237822
I0902 00:02:31.941282 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.09
INFO:tensorflow:Starting iteration 15
I0902 00:02:36.011378 139644712736768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 219.42

Steps executed: 865 Episode length: 865 Return: -497.9952064177951522
I0902 00:02:42.495090 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.00
INFO:tensorflow:Starting iteration 16

Steps executed: 203 Episode length: 146 Return: -144.2731222974600222
INFO:tensorflow:Average training steps per second: 229.28
I0902 00:02:50.976748 139644712736768 replay_runner.py:36] Average training steps per second: 229.28
I0902 00:02:51.133198 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.81
INFO:tensorflow:Starting iteration 17

Steps executed: 258 Episode length: 162 Return: -187.5448189197314822
INFO:tensorflow:Average training steps per second: 225.40
I0902 00:02:59.952454 139644712736768 replay_runner.py:36] Average training steps per second: 225.40
I0902 00:03:00.161284 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.92
INFO:tensorflow:Starting iteration 18

Steps executed: 265 Episode length: 265 Return: -587.1752447377276822
INFO:tensorflow:Average training steps per second: 226.63
I0902 00:03:08.665549 139644712736768 replay_runner.py:36] Average training steps per second: 226.63
I0902 00:03:08.959875 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -587.18
INFO:tensorflow:Starting iteration 19

Steps executed: 263 Episode length: 90 Return: -390.21113414188295822
INFO:tensorflow:Average training steps per second: 216.25
I0902 00:03:17.988918 139644712736768 replay_runner.py:36] Average training steps per second: 216.25
I0902 00:03:18.236913 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.06
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 122 Return: -129.4806259792517822
INFO:tensorflow:Average training steps per second: 217.42
I0902 00:03:27.114156 139644712736768 replay_runner.py:36] Average training steps per second: 217.42
I0902 00:03:27.370597 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.49
INFO:tensorflow:Starting iteration 21

Steps executed: 313 Episode length: 139 Return: -111.2734528697003422
INFO:tensorflow:Average training steps per second: 216.96
I0902 00:03:36.281450 139644712736768 replay_runner.py:36] Average training steps per second: 216.96
I0902 00:03:36.605131 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.21
INFO:tensorflow:Starting iteration 22

Steps executed: 269 Episode length: 111 Return: -106.0850802653929722
INFO:tensorflow:Average training steps per second: 221.11
I0902 00:03:45.378579 139644712736768 replay_runner.py:36] Average training steps per second: 221.11
I0902 00:03:45.611591 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.24
INFO:tensorflow:Starting iteration 23
I0902 00:03:49.994476 139644712736768 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 219.40

Steps executed: 1000 Episode length: 1000 Return: -102.87724887282918
I0902 00:03:57.914628 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.88
INFO:tensorflow:Starting iteration 24

Steps executed: 285 Episode length: 285 Return: -484.3011109242513618
INFO:tensorflow:Average training steps per second: 219.63
I0902 00:04:06.830931 139644712736768 replay_runner.py:36] Average training steps per second: 219.63
I0902 00:04:07.184073 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -484.30
INFO:tensorflow:Starting iteration 25

Steps executed: 265 Episode length: 132 Return: -161.9902888235400318
INFO:tensorflow:Average training steps per second: 220.71
I0902 00:04:16.095246 139644712736768 replay_runner.py:36] Average training steps per second: 220.71
I0902 00:04:16.374755 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.22
INFO:tensorflow:Starting iteration 26

Steps executed: 522 Episode length: 395 Return: -117.7621939263857818
INFO:tensorflow:Average training steps per second: 224.51
I0902 00:04:25.034945 139644712736768 replay_runner.py:36] Average training steps per second: 224.51
I0902 00:04:25.847712 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.52
INFO:tensorflow:Starting iteration 27

Steps executed: 203 Episode length: 203 Return: -15.08470971146270818
INFO:tensorflow:Average training steps per second: 219.59
I0902 00:04:34.705906 139644712736768 replay_runner.py:36] Average training steps per second: 219.59
I0902 00:04:34.910483 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.08
INFO:tensorflow:Starting iteration 28

Steps executed: 191 Episode length: 191 Return: -256.9273470540121818
INFO:tensorflow:Average training steps per second: 229.85

Steps executed: 268 Episode length: 77 Return: -91.941487779792871818
I0902 00:04:43.978726 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.43
INFO:tensorflow:Starting iteration 29

Steps executed: 233 Episode length: 156 Return: -46.01527317953226818
INFO:tensorflow:Average training steps per second: 231.43
I0902 00:04:52.514472 139644712736768 replay_runner.py:36] Average training steps per second: 231.43

Done fixed training!Episode length: 156 Return: -46.01527317953226818