Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
Steps executed: 248 Episode length: 122 Return: -122.0
I0910 11:10:01.797060 139735142316032 run_experiment.py:549] Creating TrainRunner ...
I0910 11:10:01.802814 139735142316032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:10:01.802950 139735142316032 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:10:01.803030 139735142316032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:10:01.803091 139735142316032 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:10:01.803145 139735142316032 dqn_agent.py:275] 	 update_period: 4
I0910 11:10:01.803197 139735142316032 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:10:01.803293 139735142316032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:10:01.803368 139735142316032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:10:01.803433 139735142316032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:10:01.803512 139735142316032 dqn_agent.py:280] 	 optimizer: adam
I0910 11:10:01.803588 139735142316032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:10:01.803654 139735142316032 dqn_agent.py:283] 	 seed: 1631272201802783
I0910 11:10:01.805710 139735142316032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:10:01.805859 139735142316032 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:10:01.805983 139735142316032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:10:01.806090 139735142316032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:10:01.806174 139735142316032 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:10:01.806251 139735142316032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:10:01.806339 139735142316032 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:10:01.806446 139735142316032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:10:01.806546 139735142316032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:10:01.830610 139735142316032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0910 11:10:01.846837 139735142316032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:10:01.846953 139735142316032 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:10:01.847055 139735142316032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:10:01.847120 139735142316032 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:10:01.847183 139735142316032 dqn_agent.py:275] 	 update_period: 4
I0910 11:10:01.847252 139735142316032 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:10:01.847365 139735142316032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:10:01.847418 139735142316032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:10:01.847478 139735142316032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:10:01.847541 139735142316032 dqn_agent.py:280] 	 optimizer: adam
I0910 11:10:01.847604 139735142316032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:10:01.847666 139735142316032 dqn_agent.py:283] 	 seed: 1631272201846812
I0910 11:10:01.848972 139735142316032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:10:01.849072 139735142316032 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:10:01.849136 139735142316032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:10:01.849192 139735142316032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:10:01.849252 139735142316032 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:10:01.849303 139735142316032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:10:01.849373 139735142316032 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:10:01.849434 139735142316032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:10:01.849485 139735142316032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:10:01.867440 139735142316032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0910 11:10:01.880699 139735142316032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:10:01.880840 139735142316032 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 863558.58
I0910 11:10:01.882123 139735142316032 replay_runner.py:39] Average training steps per second: 863558.58
I0910 11:10:02.539768 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 1
I0910 11:10:02.610178 139735142316032 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 825000.79
I0910 11:10:02.611629 139735142316032 replay_runner.py:39] Average training steps per second: 825000.79
I0910 11:10:02.681468 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 2
I0910 11:10:02.750753 139735142316032 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 810023.95
I0910 11:10:02.752230 139735142316032 replay_runner.py:39] Average training steps per second: 810023.95
I0910 11:10:02.832328 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 3
I0910 11:10:02.900047 139735142316032 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 864270.35
I0910 11:10:02.901435 139735142316032 replay_runner.py:39] Average training steps per second: 864270.35
I0910 11:10:02.969960 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 4
I0910 11:10:03.038646 139735142316032 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 834687.36
I0910 11:10:03.040085 139735142316032 replay_runner.py:39] Average training steps per second: 834687.36
I0910 11:10:03.110171 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 5
I0910 11:10:03.178313 139735142316032 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 813164.79
I0910 11:10:03.179782 139735142316032 replay_runner.py:39] Average training steps per second: 813164.79

Steps executed: 128 Episode length: 128 Return: -128.0
INFO:tensorflow:Starting iteration 6
I0910 11:10:03.327993 139735142316032 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 812849.61
I0910 11:10:03.329451 139735142316032 replay_runner.py:39] Average training steps per second: 812849.61
I0910 11:10:03.400812 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 7
I0910 11:10:03.467119 139735142316032 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 845284.97
I0910 11:10:03.468533 139735142316032 replay_runner.py:39] Average training steps per second: 845284.97
I0910 11:10:03.539721 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 8
I0910 11:10:03.607573 139735142316032 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 792724.25
I0910 11:10:03.609098 139735142316032 replay_runner.py:39] Average training steps per second: 792724.25
I0910 11:10:03.682600 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 9
I0910 11:10:03.753122 139735142316032 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 839868.64
I0910 11:10:03.754546 139735142316032 replay_runner.py:39] Average training steps per second: 839868.64
I0910 11:10:03.864812 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 10
I0910 11:10:03.934645 139735142316032 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 807217.86
I0910 11:10:03.936135 139735142316032 replay_runner.py:39] Average training steps per second: 807217.86
I0910 11:10:04.005977 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 11
I0910 11:10:04.073742 139735142316032 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 904334.63
I0910 11:10:04.075093 139735142316032 replay_runner.py:39] Average training steps per second: 904334.63
I0910 11:10:04.147929 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 12
I0910 11:10:04.228197 139735142316032 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 839868.64
I0910 11:10:04.229717 139735142316032 replay_runner.py:39] Average training steps per second: 839868.64
I0910 11:10:04.307416 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 13
I0910 11:10:04.378786 139735142316032 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 791378.11
I0910 11:10:04.380292 139735142316032 replay_runner.py:39] Average training steps per second: 791378.11
I0910 11:10:04.453823 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 14
I0910 11:10:04.521901 139735142316032 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 800439.69
I0910 11:10:04.523373 139735142316032 replay_runner.py:39] Average training steps per second: 800439.69
I0910 11:10:04.596266 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 15
I0910 11:10:04.664919 139735142316032 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 723904.73
I0910 11:10:04.666555 139735142316032 replay_runner.py:39] Average training steps per second: 723904.73
I0910 11:10:04.742350 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 16
I0910 11:10:04.809894 139735142316032 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 827442.10
I0910 11:10:04.811333 139735142316032 replay_runner.py:39] Average training steps per second: 827442.10
I0910 11:10:04.893476 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 17
I0910 11:10:04.965892 139735142316032 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 694191.33
I0910 11:10:04.967611 139735142316032 replay_runner.py:39] Average training steps per second: 694191.33
I0910 11:10:05.043311 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 18
I0910 11:10:05.116667 139735142316032 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 836518.55
I0910 11:10:05.118145 139735142316032 replay_runner.py:39] Average training steps per second: 836518.55
I0910 11:10:05.187794 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 19
I0910 11:10:05.258804 139735142316032 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 813953.81
I0910 11:10:05.260295 139735142316032 replay_runner.py:39] Average training steps per second: 813953.81

Done fixed training!Episode length: 127 Return: -127.0
INFO:tensorflow:Starting iteration 20
I0910 11:10:05.417563 139735142316032 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 905506.04
I0910 11:10:05.418966 139735142316032 replay_runner.py:39] Average training steps per second: 905506.04
I0910 11:10:05.495184 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 21
I0910 11:10:05.565868 139735142316032 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 767203.95
I0910 11:10:05.567428 139735142316032 replay_runner.py:39] Average training steps per second: 767203.95
I0910 11:10:05.634201 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 22
I0910 11:10:05.707732 139735142316032 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 763016.92
I0910 11:10:05.709573 139735142316032 replay_runner.py:39] Average training steps per second: 763016.92
I0910 11:10:05.788954 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 23
I0910 11:10:05.892428 139735142316032 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 617081.65
I0910 11:10:05.894355 139735142316032 replay_runner.py:39] Average training steps per second: 617081.65
I0910 11:10:05.978664 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 24
I0910 11:10:06.056347 139735142316032 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 595781.82
I0910 11:10:06.058332 139735142316032 replay_runner.py:39] Average training steps per second: 595781.82
I0910 11:10:06.140568 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 25
I0910 11:10:06.212157 139735142316032 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 657620.57
I0910 11:10:06.214025 139735142316032 replay_runner.py:39] Average training steps per second: 657620.57
I0910 11:10:06.295155 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 26
I0910 11:10:06.367018 139735142316032 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 820161.13
I0910 11:10:06.368567 139735142316032 replay_runner.py:39] Average training steps per second: 820161.13
I0910 11:10:06.446970 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 27
I0910 11:10:06.518028 139735142316032 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 821929.06
I0910 11:10:06.519494 139735142316032 replay_runner.py:39] Average training steps per second: 821929.06
I0910 11:10:06.588628 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 28
I0910 11:10:06.653498 139735142316032 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 917389.33
I0910 11:10:06.654819 139735142316032 replay_runner.py:39] Average training steps per second: 917389.33
I0910 11:10:06.723808 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 29
I0910 11:10:06.791807 139735142316032 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 808930.38
I0910 11:10:06.793279 139735142316032 replay_runner.py:39] Average training steps per second: 808930.38
I0910 11:10:06.867834 139735142316032 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50