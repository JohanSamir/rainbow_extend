I0902 23:29:55.361474 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:29:55.372744 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:29:55.373022 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:29:55.373180 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:29:55.373300 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:29:55.373404 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:29:55.373499 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:29:55.373591 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:29:55.373697 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:29:55.373792 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:29:55.373883 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:29:55.373982 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:29:55.374075 140006414895104 dqn_agent.py:283] 	 seed: 1630625395372677
I0902 23:29:55.377009 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:29:55.377242 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:29:55.377367 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:29:55.377465 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:29:55.377568 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:29:55.377690 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:29:55.377792 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:29:55.377892 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:29:55.377988 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 23:29:57.206852 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:29:57.637835 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:29:57.650884 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:29:57.658885 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:29:57.659190 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:29:57.659394 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:29:57.659543 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:29:57.659669 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:29:57.659953 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:29:57.660135 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:29:57.660417 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:29:57.660610 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:29:57.660787 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:29:57.660923 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:29:57.661065 140006414895104 dqn_agent.py:283] 	 seed: 1630625397658837
I0902 23:29:57.664921 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:29:57.665196 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:29:57.665361 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:29:57.665474 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:29:57.665574 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:29:57.665731 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:29:57.665872 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:29:57.665983 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:29:57.666098 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:29:57.696951 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:29:57.719050 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:29:57.719389 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.41
I0902 23:30:03.915241 140006414895104 replay_runner.py:36] Average training steps per second: 161.41
Steps executed: 210 Episode length: 210 Return: -193.21983831078836
I0902 23:30:05.143193 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.22
INFO:tensorflow:Starting iteration 1

Steps executed: 253 Episode length: 132 Return: -750.50648985731793
INFO:tensorflow:Average training steps per second: 215.32
I0902 23:30:14.110610 140006414895104 replay_runner.py:36] Average training steps per second: 215.32
I0902 23:30:14.337420 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.52
INFO:tensorflow:Starting iteration 2

Steps executed: 267 Episode length: 267 Return: -257.85872943618733
INFO:tensorflow:Average training steps per second: 217.42
I0902 23:30:23.310635 140006414895104 replay_runner.py:36] Average training steps per second: 217.42
I0902 23:30:23.630528 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.86
INFO:tensorflow:Starting iteration 3

Steps executed: 287 Episode length: 141 Return: -326.66095649366243
INFO:tensorflow:Average training steps per second: 218.21
I0902 23:30:32.651465 140006414895104 replay_runner.py:36] Average training steps per second: 218.21
I0902 23:30:32.915812 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.17
INFO:tensorflow:Starting iteration 4
I0902 23:30:37.228631 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 207.31

Steps executed: 1000 Episode length: 1000 Return: -87.51673014022742
I0902 23:30:44.908573 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.52
INFO:tensorflow:Starting iteration 5
I0902 23:30:49.181216 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 220.95

Steps executed: 1000 Episode length: 1000 Return: -114.75437329755891
I0902 23:30:55.392306 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.75
INFO:tensorflow:Starting iteration 6
I0902 23:30:59.735018 140006414895104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 225.72

Steps executed: 1000 Episode length: 1000 Return: -200.16302378836051
I0902 23:31:06.542712 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.16
INFO:tensorflow:Starting iteration 7
I0902 23:31:10.879292 140006414895104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 216.32

Steps executed: 1000 Episode length: 1000 Return: -490.60798327563924
I0902 23:31:17.973431 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -490.61
INFO:tensorflow:Starting iteration 8
I0902 23:31:22.021082 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 222.44

Steps executed: 1000 Episode length: 1000 Return: -483.50221368020824
I0902 23:31:29.251733 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.50
INFO:tensorflow:Starting iteration 9
I0902 23:31:33.426946 140006414895104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.93

Steps executed: 1000 Episode length: 1000 Return: -174.44702237492803
I0902 23:31:41.324653 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.45
INFO:tensorflow:Starting iteration 10
I0902 23:31:45.709395 140006414895104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 224.93

Steps executed: 1000 Episode length: 1000 Return: -296.19681979046476
I0902 23:31:52.441787 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.20
INFO:tensorflow:Starting iteration 11
I0902 23:31:56.722767 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 223.40

Steps executed: 1000 Episode length: 1000 Return: -126.38824144522813
I0902 23:32:03.928513 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.39
INFO:tensorflow:Starting iteration 12
I0902 23:32:08.255593 140006414895104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 217.24

Steps executed: 1000 Episode length: 1000 Return: 165.149981117647633
I0902 23:32:14.586081 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.15
INFO:tensorflow:Starting iteration 13
I0902 23:32:18.974496 140006414895104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 215.83

Steps executed: 557 Episode length: 557 Return: -227.8474879233638133
I0902 23:32:24.733716 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.85
INFO:tensorflow:Starting iteration 14
I0902 23:32:29.080284 140006414895104 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 214.08

Steps executed: 1000 Episode length: 1000 Return: -48.369108187066463
I0902 23:32:36.386049 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -48.37
INFO:tensorflow:Starting iteration 15
I0902 23:32:40.632889 140006414895104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 215.97

Steps executed: 1000 Episode length: 1000 Return: -99.543573389648773
I0902 23:32:49.538294 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.54
INFO:tensorflow:Starting iteration 16

Steps executed: 409 Episode length: 409 Return: -40.65695661461928773
INFO:tensorflow:Average training steps per second: 217.84
I0902 23:32:58.559934 140006414895104 replay_runner.py:36] Average training steps per second: 217.84
I0902 23:32:59.326819 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.66
INFO:tensorflow:Starting iteration 17

Steps executed: 88 Episode length: 88 Return: -108.908339415122278773
INFO:tensorflow:Average training steps per second: 220.99

Steps executed: 844 Episode length: 756 Return: -562.3056667893338773
I0902 23:33:10.007113 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.61
INFO:tensorflow:Starting iteration 18

Steps executed: 332 Episode length: 192 Return: -16.15996772082373773
INFO:tensorflow:Average training steps per second: 222.41
I0902 23:33:18.911713 140006414895104 replay_runner.py:36] Average training steps per second: 222.41
I0902 23:33:19.255722 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.55
INFO:tensorflow:Starting iteration 19

Steps executed: 234 Episode length: 234 Return: -83.77602207216823773
INFO:tensorflow:Average training steps per second: 224.81
I0902 23:33:28.099343 140006414895104 replay_runner.py:36] Average training steps per second: 224.81
I0902 23:33:28.385360 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.78
INFO:tensorflow:Starting iteration 20
I0902 23:33:32.717968 140006414895104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 221.01

Steps executed: 623 Episode length: 623 Return: -431.7632213596582773
I0902 23:33:38.531349 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.76
INFO:tensorflow:Starting iteration 21

Steps executed: 284 Episode length: 203 Return: -589.9716740779111773
INFO:tensorflow:Average training steps per second: 230.53
I0902 23:33:47.258470 140006414895104 replay_runner.py:36] Average training steps per second: 230.53
I0902 23:33:47.560100 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -700.53
INFO:tensorflow:Starting iteration 22

Steps executed: 563 Episode length: 563 Return: -468.0538446999443673
INFO:tensorflow:Average training steps per second: 232.90
I0902 23:33:56.175709 140006414895104 replay_runner.py:36] Average training steps per second: 232.90
I0902 23:33:57.314798 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.05
INFO:tensorflow:Starting iteration 23

Steps executed: 340 Episode length: 204 Return: -222.7181066873543673
INFO:tensorflow:Average training steps per second: 223.31
I0902 23:34:06.214183 140006414895104 replay_runner.py:36] Average training steps per second: 223.31
I0902 23:34:06.528928 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.44
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 142 Return: -676.1813980445903673
INFO:tensorflow:Average training steps per second: 219.76
I0902 23:34:15.451272 140006414895104 replay_runner.py:36] Average training steps per second: 219.76
I0902 23:34:15.750052 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -554.68
INFO:tensorflow:Starting iteration 25

Steps executed: 218 Episode length: 118 Return: -329.3625209871103673
INFO:tensorflow:Average training steps per second: 234.42
I0902 23:34:24.329260 140006414895104 replay_runner.py:36] Average training steps per second: 234.42
I0902 23:34:24.529729 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.93
INFO:tensorflow:Starting iteration 26

Steps executed: 64 Episode length: 64 Return: -140.548332320768763673
INFO:tensorflow:Average training steps per second: 220.02

Steps executed: 432 Episode length: 368 Return: -286.9412717953487673
I0902 23:34:34.026297 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.74
INFO:tensorflow:Starting iteration 27

Steps executed: 467 Episode length: 329 Return: 232.19370024171995673
INFO:tensorflow:Average training steps per second: 227.09
I0902 23:34:42.766533 140006414895104 replay_runner.py:36] Average training steps per second: 227.09
I0902 23:34:43.339495 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.27
INFO:tensorflow:Starting iteration 28
I0902 23:34:47.635281 140006414895104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 222.97

Steps executed: 338 Episode length: 154 Return: -276.2686653975935473
I0902 23:34:52.475786 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.95
INFO:tensorflow:Starting iteration 29

Steps executed: 262 Episode length: 262 Return: -205.8300050494479273
INFO:tensorflow:Average training steps per second: 216.57
I0902 23:35:01.440194 140006414895104 replay_runner.py:36] Average training steps per second: 216.57

Done fixed training!Episode length: 262 Return: -205.8300050494479273