Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0828 10:50:32.028540 140455557396480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:50:32.046230 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:32.046519 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:32.046665 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:32.046784 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:32.046894 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:32.047005 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:32.047113 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:32.047219 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:32.047325 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:32.047431 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:32.047542 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:32.047649 140455557396480 dqn_agent.py:283] 	 seed: 1630147832046148
I0828 10:50:32.051337 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:32.051546 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:32.051697 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:32.051827 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:32.051941 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:32.052060 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:32.052166 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:32.052276 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:32.052418 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:32.086719 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:32.336847 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:32.346807 140455557396480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:50:32.354899 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:32.355042 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:32.355115 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:32.355176 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:32.355237 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:32.355290 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:32.355367 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:32.355457 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:32.355517 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:32.355567 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:32.355618 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:32.355668 140455557396480 dqn_agent.py:283] 	 seed: 1630147832354867
I0828 10:50:32.357060 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:32.357162 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:32.357222 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:32.357273 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:32.357321 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:32.357381 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:32.357475 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:32.357551 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:32.357621 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:32.375670 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:32.391202 140455557396480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:50:32.391309 140455557396480 replay_runner.py:41] Starting iteration 0
Steps executed: 270 Episode length: 161 Return: -338.20785082207624
INFO:tensorflow:Average training steps per second: 252.92
I0828 10:50:36.345338 140455557396480 replay_runner.py:36] Average training steps per second: 252.92
I0828 10:50:37.078195 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.20
INFO:tensorflow:Starting iteration 1

Steps executed: 242 Episode length: 94 Return: -310.935050208044343
INFO:tensorflow:Average training steps per second: 336.55
I0828 10:50:43.202829 140455557396480 replay_runner.py:36] Average training steps per second: 336.55
I0828 10:50:43.331740 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.45
INFO:tensorflow:Starting iteration 2

Steps executed: 314 Episode length: 200 Return: -188.97540979548396
INFO:tensorflow:Average training steps per second: 338.13
I0828 10:50:49.309526 140455557396480 replay_runner.py:36] Average training steps per second: 338.13
I0828 10:50:49.491240 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.90
INFO:tensorflow:Starting iteration 3
I0828 10:50:52.735900 140455557396480 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 341.00

Steps executed: 209 Episode length: 108 Return: -240.78059317392447
I0828 10:50:55.790615 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.48
INFO:tensorflow:Starting iteration 4

Steps executed: 347 Episode length: 152 Return: -282.32595570665367
INFO:tensorflow:Average training steps per second: 331.76
I0828 10:51:02.233140 140455557396480 replay_runner.py:36] Average training steps per second: 331.76
I0828 10:51:02.452474 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.44
INFO:tensorflow:Starting iteration 5

Steps executed: 240 Episode length: 133 Return: -324.69018068248215
INFO:tensorflow:Average training steps per second: 334.89
I0828 10:51:08.806074 140455557396480 replay_runner.py:36] Average training steps per second: 334.89
I0828 10:51:08.970015 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.86
INFO:tensorflow:Starting iteration 6

Steps executed: 385 Episode length: 197 Return: -74.142330658448913
INFO:tensorflow:Average training steps per second: 342.34
I0828 10:51:15.311217 140455557396480 replay_runner.py:36] Average training steps per second: 342.34
I0828 10:51:15.571130 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.18
INFO:tensorflow:Starting iteration 7

Steps executed: 236 Episode length: 98 Return: -226.579584722615253
INFO:tensorflow:Average training steps per second: 245.06
I0828 10:51:23.079319 140455557396480 replay_runner.py:36] Average training steps per second: 245.06
I0828 10:51:23.225838 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.83
INFO:tensorflow:Starting iteration 8

Steps executed: 279 Episode length: 133 Return: -142.46822190353532
INFO:tensorflow:Average training steps per second: 336.36
I0828 10:51:29.622539 140455557396480 replay_runner.py:36] Average training steps per second: 336.36
I0828 10:51:29.794089 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.00
INFO:tensorflow:Starting iteration 9

Steps executed: 244 Episode length: 118 Return: -284.52527730340904
INFO:tensorflow:Average training steps per second: 329.76
I0828 10:51:36.234841 140455557396480 replay_runner.py:36] Average training steps per second: 329.76
I0828 10:51:36.387737 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.16
INFO:tensorflow:Starting iteration 10

Steps executed: 245 Episode length: 76 Return: -288.773735818860545
INFO:tensorflow:Average training steps per second: 333.80
I0828 10:51:42.762076 140455557396480 replay_runner.py:36] Average training steps per second: 333.80
I0828 10:51:42.902516 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.68
INFO:tensorflow:Starting iteration 11

Steps executed: 347 Episode length: 148 Return: -211.27224275646662
INFO:tensorflow:Average training steps per second: 333.71
I0828 10:51:49.283458 140455557396480 replay_runner.py:36] Average training steps per second: 333.71
I0828 10:51:49.501392 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.39
INFO:tensorflow:Starting iteration 12

Steps executed: 232 Episode length: 100 Return: -232.35878918470934
INFO:tensorflow:Average training steps per second: 329.96
I0828 10:51:55.950451 140455557396480 replay_runner.py:36] Average training steps per second: 329.96
I0828 10:51:56.089395 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.98
INFO:tensorflow:Starting iteration 13

Steps executed: 208 Episode length: 208 Return: -388.38418477910164
INFO:tensorflow:Average training steps per second: 339.66
I0828 10:52:02.440488 140455557396480 replay_runner.py:36] Average training steps per second: 339.66
I0828 10:52:02.601498 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.38
INFO:tensorflow:Starting iteration 14

Steps executed: 210 Episode length: 93 Return: -333.361645516542394
INFO:tensorflow:Average training steps per second: 350.82
I0828 10:52:08.887533 140455557396480 replay_runner.py:36] Average training steps per second: 350.82
I0828 10:52:09.022992 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.98
INFO:tensorflow:Starting iteration 15

Steps executed: 403 Episode length: 224 Return: -362.16502031553164
INFO:tensorflow:Average training steps per second: 342.13
I0828 10:52:15.393920 140455557396480 replay_runner.py:36] Average training steps per second: 342.13
I0828 10:52:15.688516 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.11
INFO:tensorflow:Starting iteration 16

Steps executed: 212 Episode length: 125 Return: -402.55595105010036
INFO:tensorflow:Average training steps per second: 353.77
I0828 10:52:21.957642 140455557396480 replay_runner.py:36] Average training steps per second: 353.77
I0828 10:52:22.078404 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.74
INFO:tensorflow:Starting iteration 17

Steps executed: 237 Episode length: 81 Return: -323.456891395683336
INFO:tensorflow:Average training steps per second: 348.27
I0828 10:52:28.411048 140455557396480 replay_runner.py:36] Average training steps per second: 348.27
I0828 10:52:28.548744 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.91
INFO:tensorflow:Starting iteration 18

Steps executed: 322 Episode length: 322 Return: -16.829010227008865
INFO:tensorflow:Average training steps per second: 343.38
I0828 10:52:34.931501 140455557396480 replay_runner.py:36] Average training steps per second: 343.38
I0828 10:52:35.234075 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -16.83
INFO:tensorflow:Starting iteration 19

Steps executed: 287 Episode length: 144 Return: -641.00839081739228
INFO:tensorflow:Average training steps per second: 354.96
I0828 10:52:41.496079 140455557396480 replay_runner.py:36] Average training steps per second: 354.96
I0828 10:52:41.666399 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.32
INFO:tensorflow:Starting iteration 20
I0828 10:52:45.196813 140455557396480 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 357.12
I0828 10:52:47.997341 140455557396480 replay_runner.py:36] Average training steps per second: 357.12

Steps executed: 246 Episode length: 102 Return: -50.779429701156495
INFO:tensorflow:Starting iteration 21

Steps executed: 202 Episode length: 107 Return: -107.36136678166942
INFO:tensorflow:Average training steps per second: 350.84
I0828 10:52:54.489273 140455557396480 replay_runner.py:36] Average training steps per second: 350.84
I0828 10:52:54.616937 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.11
INFO:tensorflow:Starting iteration 22

Steps executed: 301 Episode length: 127 Return: -207.33993705025767
INFO:tensorflow:Average training steps per second: 339.50
I0828 10:53:00.962025 140455557396480 replay_runner.py:36] Average training steps per second: 339.50
I0828 10:53:01.154520 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.49
INFO:tensorflow:Starting iteration 23

Steps executed: 257 Episode length: 104 Return: -629.09117500346977
INFO:tensorflow:Average training steps per second: 342.36
I0828 10:53:07.507932 140455557396480 replay_runner.py:36] Average training steps per second: 342.36
I0828 10:53:07.682270 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.45
INFO:tensorflow:Starting iteration 24

Steps executed: 165 Episode length: 73 Return: -332.711999513499177
INFO:tensorflow:Average training steps per second: 339.37
I0828 10:53:14.035452 140455557396480 replay_runner.py:36] Average training steps per second: 339.37

Steps executed: 254 Episode length: 89 Return: -369.418690840001437
INFO:tensorflow:Starting iteration 25
I0828 10:53:17.641542 140455557396480 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 347.29

Steps executed: 261 Episode length: 261 Return: 23.2437055671753827
I0828 10:53:20.732477 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: 23.24
INFO:tensorflow:Starting iteration 26

Steps executed: 246 Episode length: 138 Return: -405.80611778885503
INFO:tensorflow:Average training steps per second: 339.48
I0828 10:53:27.098190 140455557396480 replay_runner.py:36] Average training steps per second: 339.48
I0828 10:53:27.245849 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -440.19
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 102 Return: -299.68679947267105
INFO:tensorflow:Average training steps per second: 338.82
I0828 10:53:33.567615 140455557396480 replay_runner.py:36] Average training steps per second: 338.82
I0828 10:53:33.701826 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.29
INFO:tensorflow:Starting iteration 28

Steps executed: 228 Episode length: 137 Return: -100.01468029839964
INFO:tensorflow:Average training steps per second: 333.31
I0828 10:53:40.081091 140455557396480 replay_runner.py:36] Average training steps per second: 333.31
I0828 10:53:40.213799 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.37
INFO:tensorflow:Starting iteration 29

Steps executed: 242 Episode length: 163 Return: -416.40989723544794
INFO:tensorflow:Average training steps per second: 349.48
I0828 10:53:46.471697 140455557396480 replay_runner.py:36] Average training steps per second: 349.48

Done fixed training!Episode length: 163 Return: -416.40989723544794