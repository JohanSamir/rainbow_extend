Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 12:54:59.904659 140460307478528 run_experiment.py:549] Creating TrainRunner ...
I0901 12:54:59.916543 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:54:59.916836 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:54:59.917037 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:54:59.917191 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:54:59.917311 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 12:54:59.917393 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:54:59.917476 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:54:59.917558 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:54:59.917684 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:54:59.917808 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 12:54:59.917931 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:54:59.918203 140460307478528 dqn_agent.py:283] 	 seed: 1630500899916480
I0901 12:54:59.921584 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:54:59.921937 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:54:59.922150 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:54:59.922261 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:54:59.922369 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:54:59.922471 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:54:59.922558 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:54:59.922638 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:54:59.922713 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:54:59.990219 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:00.790163 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:00.806535 140460307478528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:55:00.815458 140460307478528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:55:00.815726 140460307478528 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:55:00.815851 140460307478528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:55:00.815993 140460307478528 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:55:00.816167 140460307478528 dqn_agent.py:275] 	 update_period: 4
I0901 12:55:00.816301 140460307478528 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:55:00.816407 140460307478528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:55:00.816562 140460307478528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:55:00.816826 140460307478528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:55:00.817045 140460307478528 dqn_agent.py:280] 	 optimizer: adam
I0901 12:55:00.817225 140460307478528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:55:00.817363 140460307478528 dqn_agent.py:283] 	 seed: 1630500900815392
I0901 12:55:00.820631 140460307478528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:55:00.820873 140460307478528 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:55:00.821005 140460307478528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:55:00.821230 140460307478528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:55:00.821360 140460307478528 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:55:00.821477 140460307478528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:55:00.821608 140460307478528 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:55:00.821727 140460307478528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:55:00.821835 140460307478528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:55:00.858846 140460307478528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:00.882918 140460307478528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:55:00.883248 140460307478528 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.26
I0901 12:55:07.283116 140460307478528 replay_runner.py:36] Average training steps per second: 156.26
Steps executed: 203 Episode length: 65 Return: -114.68039625453216
I0901 12:55:08.446611 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.53
INFO:tensorflow:Starting iteration 1

Steps executed: 160 Episode length: 68 Return: -557.19872413531716
INFO:tensorflow:Average training steps per second: 224.64
I0901 12:55:17.264199 140460307478528 replay_runner.py:36] Average training steps per second: 224.64

Steps executed: 235 Episode length: 75 Return: -684.97790256037416
INFO:tensorflow:Starting iteration 2

Steps executed: 261 Episode length: 133 Return: -272.69939866466283
INFO:tensorflow:Average training steps per second: 229.96
I0901 12:55:26.097415 140460307478528 replay_runner.py:36] Average training steps per second: 229.96
I0901 12:55:26.321437 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.78
INFO:tensorflow:Starting iteration 3

Steps executed: 320 Episode length: 131 Return: -634.49178290906793
INFO:tensorflow:Average training steps per second: 227.54
I0901 12:55:35.064636 140460307478528 replay_runner.py:36] Average training steps per second: 227.54
I0901 12:55:35.340314 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -641.62
INFO:tensorflow:Starting iteration 4

Steps executed: 224 Episode length: 132 Return: -200.07953699204413
INFO:tensorflow:Average training steps per second: 229.07
I0901 12:55:44.132833 140460307478528 replay_runner.py:36] Average training steps per second: 229.07
I0901 12:55:44.334475 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.91
INFO:tensorflow:Starting iteration 5

Steps executed: 350 Episode length: 154 Return: -256.48086775428423
INFO:tensorflow:Average training steps per second: 221.94
I0901 12:55:53.194537 140460307478528 replay_runner.py:36] Average training steps per second: 221.94
I0901 12:55:53.495057 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.89
INFO:tensorflow:Starting iteration 6

Steps executed: 249 Episode length: 90 Return: -724.261773293174323
INFO:tensorflow:Average training steps per second: 220.41
I0901 12:56:02.401756 140460307478528 replay_runner.py:36] Average training steps per second: 220.41
I0901 12:56:02.653257 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -701.08
INFO:tensorflow:Starting iteration 7

Steps executed: 156 Episode length: 156 Return: -202.46793379968756
INFO:tensorflow:Average training steps per second: 224.23

Steps executed: 318 Episode length: 162 Return: -120.46430453278442
I0901 12:56:11.867384 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.47
INFO:tensorflow:Starting iteration 8

Steps executed: 220 Episode length: 100 Return: -552.71052079690892
INFO:tensorflow:Average training steps per second: 219.66
I0901 12:56:20.816492 140460307478528 replay_runner.py:36] Average training steps per second: 219.66
I0901 12:56:21.016551 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.99
INFO:tensorflow:Starting iteration 9

Steps executed: 167 Episode length: 167 Return: -345.97708589659762
INFO:tensorflow:Average training steps per second: 230.08

Steps executed: 306 Episode length: 139 Return: -171.62639810831843
I0901 12:56:29.937127 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.80
INFO:tensorflow:Starting iteration 10

Steps executed: 251 Episode length: 105 Return: -78.623749511239956
INFO:tensorflow:Average training steps per second: 223.63
I0901 12:56:38.804405 140460307478528 replay_runner.py:36] Average training steps per second: 223.63
I0901 12:56:39.016064 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.70
INFO:tensorflow:Starting iteration 11

Steps executed: 261 Episode length: 108 Return: -210.35681797395975
INFO:tensorflow:Average training steps per second: 224.14
I0901 12:56:47.962939 140460307478528 replay_runner.py:36] Average training steps per second: 224.14
I0901 12:56:48.191035 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.43
INFO:tensorflow:Starting iteration 12

Steps executed: 513 Episode length: 416 Return: 152.661627765517555
INFO:tensorflow:Average training steps per second: 227.54
I0901 12:56:56.921960 140460307478528 replay_runner.py:36] Average training steps per second: 227.54
I0901 12:56:57.599675 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.60
INFO:tensorflow:Starting iteration 13

Steps executed: 238 Episode length: 113 Return: -81.181980853544457
INFO:tensorflow:Average training steps per second: 221.18
I0901 12:57:06.489775 140460307478528 replay_runner.py:36] Average training steps per second: 221.18
I0901 12:57:06.698799 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.04
INFO:tensorflow:Starting iteration 14

Steps executed: 393 Episode length: 200 Return: -67.375560554649616
INFO:tensorflow:Average training steps per second: 220.48
I0901 12:57:15.601294 140460307478528 replay_runner.py:36] Average training steps per second: 220.48
I0901 12:57:15.988950 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.03
INFO:tensorflow:Starting iteration 15

Steps executed: 263 Episode length: 116 Return: -156.89912289293684
INFO:tensorflow:Average training steps per second: 224.45
I0901 12:57:24.830233 140460307478528 replay_runner.py:36] Average training steps per second: 224.45
I0901 12:57:25.068083 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.89
INFO:tensorflow:Starting iteration 16

Steps executed: 224 Episode length: 113 Return: -353.40424024636414
INFO:tensorflow:Average training steps per second: 221.75
I0901 12:57:33.948024 140460307478528 replay_runner.py:36] Average training steps per second: 221.75
I0901 12:57:34.160891 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.73
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: -99.973559286124244
INFO:tensorflow:Average training steps per second: 219.30
I0901 12:57:43.156377 140460307478528 replay_runner.py:36] Average training steps per second: 219.30
I0901 12:57:43.359471 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.97
INFO:tensorflow:Starting iteration 18

Steps executed: 214 Episode length: 68 Return: -159.535394665949927
INFO:tensorflow:Average training steps per second: 224.46
I0901 12:57:52.283345 140460307478528 replay_runner.py:36] Average training steps per second: 224.46
I0901 12:57:52.489821 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.88
INFO:tensorflow:Starting iteration 19

Steps executed: 342 Episode length: 171 Return: -306.84536117966195
INFO:tensorflow:Average training steps per second: 216.24
I0901 12:58:01.538869 140460307478528 replay_runner.py:36] Average training steps per second: 216.24
I0901 12:58:01.917230 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.42
INFO:tensorflow:Starting iteration 20

Steps executed: 214 Episode length: 105 Return: -332.52856900139136
INFO:tensorflow:Average training steps per second: 217.88
I0901 12:58:10.951722 140460307478528 replay_runner.py:36] Average training steps per second: 217.88
I0901 12:58:11.145251 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.27
INFO:tensorflow:Starting iteration 21
I0901 12:58:15.449699 140460307478528 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 220.14
I0901 12:58:19.992592 140460307478528 replay_runner.py:36] Average training steps per second: 220.14

Steps executed: 257 Episode length: 84 Return: -173.365900620262366
INFO:tensorflow:Starting iteration 22

Steps executed: 463 Episode length: 285 Return: -406.79763940801666
INFO:tensorflow:Average training steps per second: 228.39
I0901 12:58:28.943670 140460307478528 replay_runner.py:36] Average training steps per second: 228.39
I0901 12:58:29.456008 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.40
INFO:tensorflow:Starting iteration 23
I0901 12:58:33.861352 140460307478528 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 224.81

Steps executed: 300 Episode length: 125 Return: -195.54400106439385
I0901 12:58:38.607934 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.52
INFO:tensorflow:Starting iteration 24

Steps executed: 245 Episode length: 85 Return: -41.3668395864092566
INFO:tensorflow:Average training steps per second: 216.97
I0901 12:58:47.628560 140460307478528 replay_runner.py:36] Average training steps per second: 216.97
I0901 12:58:47.882472 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.17
INFO:tensorflow:Starting iteration 25

Steps executed: 252 Episode length: 127 Return: -95.841504404904656
INFO:tensorflow:Average training steps per second: 217.71
I0901 12:58:56.927214 140460307478528 replay_runner.py:36] Average training steps per second: 217.71
I0901 12:58:57.155417 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.57
INFO:tensorflow:Starting iteration 26
I0901 12:59:01.645770 140460307478528 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 217.39
I0901 12:59:06.246823 140460307478528 replay_runner.py:36] Average training steps per second: 217.39

Steps executed: 274 Episode length: 97 Return: -220.915373497279386
INFO:tensorflow:Starting iteration 27

Steps executed: 207 Episode length: 132 Return: -505.85519985121397
INFO:tensorflow:Average training steps per second: 216.89
I0901 12:59:15.666618 140460307478528 replay_runner.py:36] Average training steps per second: 216.89
I0901 12:59:15.866096 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.07
INFO:tensorflow:Starting iteration 28

Steps executed: 204 Episode length: 64 Return: -329.634834957290197
INFO:tensorflow:Average training steps per second: 217.99
I0901 12:59:24.904102 140460307478528 replay_runner.py:36] Average training steps per second: 217.99
I0901 12:59:25.115185 140460307478528 run_experiment.py:428] Average undiscounted return per evaluation episode: -493.50
INFO:tensorflow:Starting iteration 29

Steps executed: 230 Episode length: 96 Return: 5.686339860850026108
INFO:tensorflow:Average training steps per second: 214.80
I0901 12:59:34.100514 140460307478528 replay_runner.py:36] Average training steps per second: 214.80

Done fixed training!Episode length: 96 Return: 5.686339860850026108