I0828 10:18:36.962017 139821415028736 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:36.962613 139821415028736 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:37.039569 139821415028736 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:37.041143 139821415028736 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:37.041254 139821415028736 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:37.041317 139821415028736 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:37.041374 139821415028736 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:37.041597 139821415028736 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:37.041692 139821415028736 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:37.041783 139821415028736 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:37.041854 139821415028736 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:37.041921 139821415028736 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:37.041987 139821415028736 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:37.042042 139821415028736 dqn_agent.py:283] 	 seed: 1630145917039478
I0828 10:18:37.044000 139821415028736 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:37.044151 139821415028736 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:37.044224 139821415028736 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:37.044290 139821415028736 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:37.044349 139821415028736 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:37.044407 139821415028736 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:37.044463 139821415028736 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:37.044546 139821415028736 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:37.044613 139821415028736 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.450299 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0828 10:18:38.812530 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.821233 139821415028736 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.825688 139821415028736 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.825834 139821415028736 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.825916 139821415028736 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.825985 139821415028736 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.826048 139821415028736 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.826143 139821415028736 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:38.826279 139821415028736 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.826342 139821415028736 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.826409 139821415028736 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.826468 139821415028736 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.826557 139821415028736 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.826623 139821415028736 dqn_agent.py:283] 	 seed: 1630145918825657
I0828 10:18:38.828239 139821415028736 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.828351 139821415028736 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:38.828428 139821415028736 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.828496 139821415028736 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.828559 139821415028736 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.828631 139821415028736 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.828697 139821415028736 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.828791 139821415028736 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.828863 139821415028736 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.847152 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.859255 139821415028736 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.859409 139821415028736 replay_runner.py:41] Starting iteration 0
Steps executed: 314 Episode length: 169 Return: -664.5871332533256
INFO:tensorflow:Average training steps per second: 171.98
I0828 10:18:44.674531 139821415028736 replay_runner.py:36] Average training steps per second: 171.98
I0828 10:18:45.731507 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -824.31
INFO:tensorflow:Starting iteration 1
I0828 10:18:49.932353 139821415028736 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 214.25

Steps executed: 244 Episode length: 162 Return: -767.4799710574406
I0828 10:18:54.856356 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.52
INFO:tensorflow:Starting iteration 2

Steps executed: 241 Episode length: 86 Return: -811.13057354829216
INFO:tensorflow:Average training steps per second: 216.73
I0828 10:19:03.771744 139821415028736 replay_runner.py:36] Average training steps per second: 216.73
I0828 10:19:03.977352 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -699.72
INFO:tensorflow:Starting iteration 3

Steps executed: 218 Episode length: 123 Return: -14.910261620131124
INFO:tensorflow:Average training steps per second: 217.74
I0828 10:19:12.883765 139821415028736 replay_runner.py:36] Average training steps per second: 217.74
I0828 10:19:13.059999 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.39
INFO:tensorflow:Starting iteration 4

Steps executed: 280 Episode length: 88 Return: -816.401681623976354
INFO:tensorflow:Average training steps per second: 218.94
I0828 10:19:21.845219 139821415028736 replay_runner.py:36] Average training steps per second: 218.94
I0828 10:19:22.100179 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -644.07
INFO:tensorflow:Starting iteration 5

Steps executed: 241 Episode length: 79 Return: -795.522012030672854
INFO:tensorflow:Average training steps per second: 215.39
I0828 10:19:31.062188 139821415028736 replay_runner.py:36] Average training steps per second: 215.39
I0828 10:19:31.276947 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.08
INFO:tensorflow:Starting iteration 6

Steps executed: 227 Episode length: 69 Return: -525.817144417287554
INFO:tensorflow:Average training steps per second: 216.78
I0828 10:19:40.160399 139821415028736 replay_runner.py:36] Average training steps per second: 216.78
I0828 10:19:40.373350 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -586.70
INFO:tensorflow:Starting iteration 7

Steps executed: 210 Episode length: 70 Return: -704.021109391361354
INFO:tensorflow:Average training steps per second: 216.05
I0828 10:19:49.236593 139821415028736 replay_runner.py:36] Average training steps per second: 216.05
I0828 10:19:49.423991 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -693.75
INFO:tensorflow:Starting iteration 8

Steps executed: 202 Episode length: 81 Return: -842.260574681406354
INFO:tensorflow:Average training steps per second: 216.17
I0828 10:19:58.338236 139821415028736 replay_runner.py:36] Average training steps per second: 216.17
I0828 10:19:58.523743 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -655.92
INFO:tensorflow:Starting iteration 9

Steps executed: 205 Episode length: 68 Return: -641.819443709802344
INFO:tensorflow:Average training steps per second: 221.18
I0828 10:20:07.180385 139821415028736 replay_runner.py:36] Average training steps per second: 221.18
I0828 10:20:07.368447 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -634.15
INFO:tensorflow:Starting iteration 10

Steps executed: 295 Episode length: 176 Return: -1083.3106996573774
INFO:tensorflow:Average training steps per second: 219.71
I0828 10:20:16.166856 139821415028736 replay_runner.py:36] Average training steps per second: 219.71
I0828 10:20:16.478393 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -857.74
INFO:tensorflow:Starting iteration 11

Steps executed: 225 Episode length: 84 Return: -187.175106126335274
INFO:tensorflow:Average training steps per second: 222.73
I0828 10:20:25.214041 139821415028736 replay_runner.py:36] Average training steps per second: 222.73
I0828 10:20:25.370659 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.43
INFO:tensorflow:Starting iteration 12

Steps executed: 261 Episode length: 63 Return: -492.345075692547674
INFO:tensorflow:Average training steps per second: 220.30
I0828 10:20:34.180447 139821415028736 replay_runner.py:36] Average training steps per second: 220.30
I0828 10:20:34.407300 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.66
INFO:tensorflow:Starting iteration 13

Steps executed: 314 Episode length: 137 Return: -887.07124346166774
INFO:tensorflow:Average training steps per second: 222.79
I0828 10:20:43.177181 139821415028736 replay_runner.py:36] Average training steps per second: 222.79
I0828 10:20:43.479435 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -593.26
INFO:tensorflow:Starting iteration 14

Steps executed: 248 Episode length: 86 Return: -427.618504893634774
INFO:tensorflow:Average training steps per second: 217.38
I0828 10:20:52.377125 139821415028736 replay_runner.py:36] Average training steps per second: 217.38
I0828 10:20:52.609597 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.98
INFO:tensorflow:Starting iteration 15

Steps executed: 305 Episode length: 106 Return: -517.62110228177344
INFO:tensorflow:Average training steps per second: 221.68
I0828 10:21:01.334563 139821415028736 replay_runner.py:36] Average training steps per second: 221.68
I0828 10:21:01.637176 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -632.25
INFO:tensorflow:Starting iteration 16

Steps executed: 233 Episode length: 70 Return: -163.309129862847544
INFO:tensorflow:Average training steps per second: 221.98
I0828 10:21:10.432394 139821415028736 replay_runner.py:36] Average training steps per second: 221.98
I0828 10:21:10.582467 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.82
INFO:tensorflow:Starting iteration 17

Steps executed: 246 Episode length: 159 Return: -1170.6697861612126
INFO:tensorflow:Average training steps per second: 224.50
I0828 10:21:19.353776 139821415028736 replay_runner.py:36] Average training steps per second: 224.50
I0828 10:21:19.599946 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -920.00
INFO:tensorflow:Starting iteration 18

Steps executed: 236 Episode length: 85 Return: -571.926521083471226
INFO:tensorflow:Average training steps per second: 245.15
I0828 10:21:27.937227 139821415028736 replay_runner.py:36] Average training steps per second: 245.15
I0828 10:21:28.107327 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.56
INFO:tensorflow:Starting iteration 19

Steps executed: 266 Episode length: 78 Return: -116.312707924606296
INFO:tensorflow:Average training steps per second: 257.76
I0828 10:21:35.897114 139821415028736 replay_runner.py:36] Average training steps per second: 257.76
I0828 10:21:36.022312 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 20

Steps executed: 226 Episode length: 64 Return: -497.863399276151376
INFO:tensorflow:Average training steps per second: 238.51
I0828 10:21:44.116699 139821415028736 replay_runner.py:36] Average training steps per second: 238.51
I0828 10:21:44.297907 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -653.65
INFO:tensorflow:Starting iteration 21

Steps executed: 265 Episode length: 72 Return: -541.727333213874976
INFO:tensorflow:Average training steps per second: 226.73
I0828 10:21:52.879387 139821415028736 replay_runner.py:36] Average training steps per second: 226.73
I0828 10:21:53.100103 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.20
INFO:tensorflow:Starting iteration 22

Steps executed: 252 Episode length: 76 Return: -694.639246144356276
INFO:tensorflow:Average training steps per second: 221.41
I0828 10:22:01.899155 139821415028736 replay_runner.py:36] Average training steps per second: 221.41
I0828 10:22:02.116832 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -579.83
INFO:tensorflow:Starting iteration 23

Steps executed: 74 Episode length: 74 Return: -595.4190795371082276
INFO:tensorflow:Average training steps per second: 224.73

Steps executed: 200 Episode length: 69 Return: -542.777465854863856
I0828 10:22:11.051937 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.03
INFO:tensorflow:Starting iteration 24

Steps executed: 261 Episode length: 132 Return: -603.92535317285966
INFO:tensorflow:Average training steps per second: 228.75
I0828 10:22:19.675276 139821415028736 replay_runner.py:36] Average training steps per second: 228.75
I0828 10:22:19.937139 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -724.56
INFO:tensorflow:Starting iteration 25
I0828 10:22:24.194206 139821415028736 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 225.30

Steps executed: 329 Episode length: 329 Return: -2991.1371443272446
I0828 10:22:29.178255 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -2991.14
INFO:tensorflow:Starting iteration 26

Steps executed: 293 Episode length: 107 Return: -653.95263999374946
INFO:tensorflow:Average training steps per second: 222.47
I0828 10:22:38.001668 139821415028736 replay_runner.py:36] Average training steps per second: 222.47
I0828 10:22:38.295717 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -671.73
INFO:tensorflow:Starting iteration 27
I0828 10:22:42.622794 139821415028736 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 223.65

Steps executed: 236 Episode length: 84 Return: -580.550134029842646
I0828 10:22:47.305128 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -555.29
INFO:tensorflow:Starting iteration 28

Steps executed: 210 Episode length: 130 Return: -966.91545508464556
INFO:tensorflow:Average training steps per second: 221.54
I0828 10:22:56.094625 139821415028736 replay_runner.py:36] Average training steps per second: 221.54
I0828 10:22:56.290434 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -630.47
INFO:tensorflow:Starting iteration 29

Steps executed: 180 Episode length: 57 Return: -400.753090357243856
INFO:tensorflow:Average training steps per second: 226.31
I0828 10:23:05.060450 139821415028736 replay_runner.py:36] Average training steps per second: 226.31


Done fixed training!Episode length: 52 Return: -509.156690964905656