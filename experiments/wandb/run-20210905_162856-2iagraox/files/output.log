I0905 16:29:02.749869 140017592051712 run_experiment.py:549] Creating TrainRunner ...
I0905 16:29:02.758222 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:02.758379 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:02.758456 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:02.758518 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:02.758586 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:02.758666 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:02.758770 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:02.758849 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:02.758916 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:02.758995 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:02.759063 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:02.759135 140017592051712 dqn_agent.py:283] 	 seed: 1630859342758184
I0905 16:29:02.760860 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:02.760988 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:02.761066 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:02.761194 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:02.761259 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:02.761339 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:02.761397 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:02.761468 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:02.761545 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0905 16:29:04.272348 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.596666 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.607584 140017592051712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:29:04.616010 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:04.616197 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:04.616281 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:04.616356 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:04.616426 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:04.616507 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:04.616562 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:04.616655 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:04.616758 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:04.616858 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:04.616918 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:04.616995 140017592051712 dqn_agent.py:283] 	 seed: 1630859344615968
I0905 16:29:04.619024 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:04.619151 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:04.619232 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:04.619297 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:04.619356 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:04.619416 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:04.619487 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:04.619570 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:04.619654 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:29:04.642523 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.658135 140017592051712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:29:04.658344 140017592051712 replay_runner.py:41] Starting iteration 0
Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 204.81
I0905 16:29:09.541092 140017592051712 replay_runner.py:36] Average training steps per second: 204.81
I0905 16:29:10.264195 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 249.19
I0905 16:29:14.422387 140017592051712 replay_runner.py:36] Average training steps per second: 249.19
I0905 16:29:14.517188 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 233.95
I0905 16:29:18.972369 140017592051712 replay_runner.py:36] Average training steps per second: 233.95
I0905 16:29:19.075126 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 288 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 219.82
I0905 16:29:23.782685 140017592051712 replay_runner.py:36] Average training steps per second: 219.82
I0905 16:29:23.953840 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.00
INFO:tensorflow:Starting iteration 4

Steps executed: 373 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 220.91
I0905 16:29:28.656198 140017592051712 replay_runner.py:36] Average training steps per second: 220.91
I0905 16:29:28.896214 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 5

Steps executed: 386 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.97
I0905 16:29:33.748866 140017592051712 replay_runner.py:36] Average training steps per second: 213.97
I0905 16:29:33.985222 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00
INFO:tensorflow:Starting iteration 6

Steps executed: 277 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 214.19
I0905 16:29:38.833210 140017592051712 replay_runner.py:36] Average training steps per second: 214.19
I0905 16:29:39.014965 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 7

Steps executed: 300 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 207.20
I0905 16:29:44.024402 140017592051712 replay_runner.py:36] Average training steps per second: 207.20
I0905 16:29:44.226626 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 8

Steps executed: 284 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 211.19
I0905 16:29:49.148446 140017592051712 replay_runner.py:36] Average training steps per second: 211.19
I0905 16:29:49.325147 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 9

Steps executed: 281 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 207.03
I0905 16:29:54.351019 140017592051712 replay_runner.py:36] Average training steps per second: 207.03
I0905 16:29:54.525459 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 10

Steps executed: 285 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 210.03
I0905 16:29:59.475476 140017592051712 replay_runner.py:36] Average training steps per second: 210.03
I0905 16:29:59.652060 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 11
I0905 16:29:59.838893 140017592051712 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 210.67
I0905 16:30:04.586368 140017592051712 replay_runner.py:36] Average training steps per second: 210.67
I0905 16:30:04.709350 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12


Steps executed: 348 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 210.13
I0905 16:30:09.650439 140017592051712 replay_runner.py:36] Average training steps per second: 210.13
I0905 16:30:09.864751 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 13

Steps executed: 325 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 206.72
I0905 16:30:14.896041 140017592051712 replay_runner.py:36] Average training steps per second: 206.72
I0905 16:30:15.110438 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 14

Steps executed: 312 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 212.13
I0905 16:30:20.011348 140017592051712 replay_runner.py:36] Average training steps per second: 212.13
I0905 16:30:20.214242 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 15

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.37
I0905 16:30:25.089240 140017592051712 replay_runner.py:36] Average training steps per second: 213.37
I0905 16:30:25.339923 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 16

Steps executed: 385 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.42
I0905 16:30:30.345460 140017592051712 replay_runner.py:36] Average training steps per second: 207.42
I0905 16:30:30.591478 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 17

Steps executed: 310 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 214.33
I0905 16:30:35.450586 140017592051712 replay_runner.py:36] Average training steps per second: 214.33
I0905 16:30:35.649179 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 18

Steps executed: 351 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 213.07
I0905 16:30:40.530980 140017592051712 replay_runner.py:36] Average training steps per second: 213.07
I0905 16:30:40.771377 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.50
INFO:tensorflow:Starting iteration 19

Steps executed: 374 Episode length: 199 Return: 199.0
INFO:tensorflow:Average training steps per second: 212.20
I0905 16:30:45.672867 140017592051712 replay_runner.py:36] Average training steps per second: 212.20
I0905 16:30:45.915279 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 20

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.76
I0905 16:30:50.771073 140017592051712 replay_runner.py:36] Average training steps per second: 213.76
I0905 16:30:51.060145 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 210.34
I0905 16:30:56.004694 140017592051712 replay_runner.py:36] Average training steps per second: 210.34
I0905 16:30:56.127036 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 16:30:56.315888 140017592051712 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 212.68
I0905 16:31:01.018431 140017592051712 replay_runner.py:36] Average training steps per second: 212.68
I0905 16:31:01.142981 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 393 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.44
I0905 16:31:06.016509 140017592051712 replay_runner.py:36] Average training steps per second: 213.44
I0905 16:31:06.253070 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.50
INFO:tensorflow:Starting iteration 24
I0905 16:31:06.435707 140017592051712 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 208.28

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:31:11.365516 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0905 16:31:11.542007 140017592051712 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 208.65
I0905 16:31:16.335210 140017592051712 replay_runner.py:36] Average training steps per second: 208.65
I0905 16:31:16.468183 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 348 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 205.56
I0905 16:31:21.520403 140017592051712 replay_runner.py:36] Average training steps per second: 205.56
I0905 16:31:21.736898 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 209.69
I0905 16:31:26.686196 140017592051712 replay_runner.py:36] Average training steps per second: 209.69
I0905 16:31:26.815557 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 16:31:26.997556 140017592051712 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 209.19
I0905 16:31:31.778623 140017592051712 replay_runner.py:36] Average training steps per second: 209.19
I0905 16:31:31.905352 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0905 16:31:32.094898 140017592051712 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 207.87
I0905 16:31:36.906017 140017592051712 replay_runner.py:36] Average training steps per second: 207.87

Done fixed training!Episode length: 200 Return: 200.0