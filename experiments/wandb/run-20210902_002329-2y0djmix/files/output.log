I0902 00:23:35.597305 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:35.607564 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:35.607796 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:35.607913 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:35.608066 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:35.608171 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:35.608287 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:35.608360 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:35.608467 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:35.608545 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:35.608622 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:35.608726 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:35.608811 140183943698432 dqn_agent.py:283] 	 seed: 1630542215607500
I0902 00:23:35.610768 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:35.610894 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:35.610981 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:35.611074 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:35.611230 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:35.611307 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:35.611372 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:35.611450 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:35.611515 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:35.641022 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:35.911433 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:35.921661 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:35.930072 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:35.930257 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:35.930343 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:35.930416 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:35.930483 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:35.930588 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:35.930698 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:35.930781 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:35.930846 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:35.930932 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:35.931015 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:35.931093 140183943698432 dqn_agent.py:283] 	 seed: 1630542215930036
I0902 00:23:35.932793 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:35.932923 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:35.933020 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:35.933095 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:35.933221 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:35.933294 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:35.933393 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:35.933465 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:35.933559 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:35.957066 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:35.974720 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:35.974915 140183943698432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 258.98
I0902 00:23:39.836463 140183943698432 replay_runner.py:36] Average training steps per second: 258.98
I0902 00:23:40.906602 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.44
Steps executed: 338 Episode length: 218 Return: -423.1150958029898
INFO:tensorflow:Starting iteration 1
I0902 00:23:44.405376 140183943698432 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 362.62

Steps executed: 323 Episode length: 152 Return: -572.1083242135887
I0902 00:23:47.344752 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -544.04
INFO:tensorflow:Starting iteration 2

Steps executed: 230 Episode length: 230 Return: -160.90973376734567
INFO:tensorflow:Average training steps per second: 342.42
I0902 00:23:53.733762 140183943698432 replay_runner.py:36] Average training steps per second: 342.42
I0902 00:23:53.909321 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.91
INFO:tensorflow:Starting iteration 3
I0902 00:23:57.107122 140183943698432 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 315.11
I0902 00:24:00.280866 140183943698432 replay_runner.py:36] Average training steps per second: 315.11

Steps executed: 630 Episode length: 630 Return: -557.92997777995267
INFO:tensorflow:Starting iteration 4

Steps executed: 1000 Episode length: 1000 Return: -71.99457032533881
INFO:tensorflow:Average training steps per second: 334.26
I0902 00:24:07.390917 140183943698432 replay_runner.py:36] Average training steps per second: 334.26
I0902 00:24:09.152774 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.99
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -152.65818567369138
INFO:tensorflow:Average training steps per second: 334.86
I0902 00:24:15.458156 140183943698432 replay_runner.py:36] Average training steps per second: 334.86
I0902 00:24:17.149735 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.66
INFO:tensorflow:Starting iteration 6
I0902 00:24:20.576913 140183943698432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 354.11

Steps executed: 1000 Episode length: 1000 Return: -274.59326164970598
I0902 00:24:25.063962 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.59
INFO:tensorflow:Starting iteration 7
I0902 00:24:28.480189 140183943698432 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 347.01

Steps executed: 262 Episode length: 262 Return: -133.2790717602253598
I0902 00:24:31.558391 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.28
INFO:tensorflow:Starting iteration 8

Steps executed: 890 Episode length: 710 Return: -208.3629418459907598
INFO:tensorflow:Average training steps per second: 321.24
I0902 00:24:38.015675 140183943698432 replay_runner.py:36] Average training steps per second: 321.24
I0902 00:24:38.991233 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.46
INFO:tensorflow:Starting iteration 9
I0902 00:24:42.229959 140183943698432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 325.90

Steps executed: 992 Episode length: 992 Return: -708.7425970288907598
I0902 00:24:47.863159 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -708.74
INFO:tensorflow:Starting iteration 10

Steps executed: 254 Episode length: 254 Return: -128.2078682797658598
INFO:tensorflow:Average training steps per second: 332.99
I0902 00:24:54.188765 140183943698432 replay_runner.py:36] Average training steps per second: 332.99
I0902 00:24:54.360107 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.21
INFO:tensorflow:Starting iteration 11
I0902 00:24:57.655926 140183943698432 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 348.88

Steps executed: 1000 Episode length: 1000 Return: -88.488289748583288
I0902 00:25:03.394584 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.49
INFO:tensorflow:Starting iteration 12
I0902 00:25:06.688187 140183943698432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 342.76

Steps executed: 1000 Episode length: 1000 Return: -294.59031724048388
I0902 00:25:11.518918 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.59
INFO:tensorflow:Starting iteration 13

Steps executed: 154 Episode length: 154 Return: -142.1734882055933388
INFO:tensorflow:Average training steps per second: 348.80

Steps executed: 453 Episode length: 299 Return: -116.2842753718704988
I0902 00:25:17.937438 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.23
INFO:tensorflow:Starting iteration 14

Steps executed: 407 Episode length: 273 Return: -291.1093421334554788
INFO:tensorflow:Average training steps per second: 321.59
I0902 00:25:24.481467 140183943698432 replay_runner.py:36] Average training steps per second: 321.59
I0902 00:25:24.756636 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.65
INFO:tensorflow:Starting iteration 15
I0902 00:25:28.151739 140183943698432 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 348.54

Steps executed: 1000 Episode length: 1000 Return: -181.01335693140524
I0902 00:25:33.750225 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.01
INFO:tensorflow:Starting iteration 16

Steps executed: 307 Episode length: 307 Return: -41.48620627827252524
INFO:tensorflow:Average training steps per second: 327.06
I0902 00:25:40.015968 140183943698432 replay_runner.py:36] Average training steps per second: 327.06
I0902 00:25:40.309237 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.49
INFO:tensorflow:Starting iteration 17

Steps executed: 235 Episode length: 121 Return: -111.4984773485285524
INFO:tensorflow:Average training steps per second: 328.12
I0902 00:25:46.631230 140183943698432 replay_runner.py:36] Average training steps per second: 328.12
I0902 00:25:46.763231 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.99
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 158 Return: -184.2739762614354524
INFO:tensorflow:Average training steps per second: 347.38
I0902 00:25:52.964771 140183943698432 replay_runner.py:36] Average training steps per second: 347.38
I0902 00:25:53.117717 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.08
INFO:tensorflow:Starting iteration 19

Steps executed: 381 Episode length: 196 Return: -499.4836030572065524
INFO:tensorflow:Average training steps per second: 348.00
I0902 00:25:59.441095 140183943698432 replay_runner.py:36] Average training steps per second: 348.00
I0902 00:25:59.702135 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.56
INFO:tensorflow:Starting iteration 20
I0902 00:26:03.129585 140183943698432 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 343.69

Steps executed: 201 Episode length: 201 Return: -186.1464782622788324
I0902 00:26:06.220216 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.15
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 228 Return: -432.4443024444918324
INFO:tensorflow:Average training steps per second: 349.40
I0902 00:26:12.560690 140183943698432 replay_runner.py:36] Average training steps per second: 349.40
I0902 00:26:12.741225 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.44
INFO:tensorflow:Starting iteration 22

Steps executed: 289 Episode length: 114 Return: -451.3114329042278324
INFO:tensorflow:Average training steps per second: 347.14
I0902 00:26:19.067867 140183943698432 replay_runner.py:36] Average training steps per second: 347.14
I0902 00:26:19.240874 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -706.96
INFO:tensorflow:Starting iteration 23
I0902 00:26:22.733728 140183943698432 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 358.80
I0902 00:26:25.521039 140183943698432 replay_runner.py:36] Average training steps per second: 358.80

Steps executed: 238 Episode length: 125 Return: -282.9805800904321724
INFO:tensorflow:Starting iteration 24

Steps executed: 226 Episode length: 74 Return: -316.90869019157867724
INFO:tensorflow:Average training steps per second: 363.37
I0902 00:26:31.906560 140183943698432 replay_runner.py:36] Average training steps per second: 363.37
I0902 00:26:32.031914 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.88
INFO:tensorflow:Starting iteration 25

Steps executed: 265 Episode length: 120 Return: 16.741636116401196724
INFO:tensorflow:Average training steps per second: 355.19
I0902 00:26:38.384011 140183943698432 replay_runner.py:36] Average training steps per second: 355.19
I0902 00:26:38.498788 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.38
INFO:tensorflow:Starting iteration 26

Steps executed: 288 Episode length: 150 Return: -25.27394719133394624
INFO:tensorflow:Average training steps per second: 338.12
I0902 00:26:44.917050 140183943698432 replay_runner.py:36] Average training steps per second: 338.12
I0902 00:26:45.059376 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.25
INFO:tensorflow:Starting iteration 27
I0902 00:26:48.456669 140183943698432 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 335.19

Steps executed: 563 Episode length: 563 Return: -65.15828000251122624
I0902 00:26:52.068464 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.16
INFO:tensorflow:Starting iteration 28

Steps executed: 282 Episode length: 89 Return: -186.76105537977475424
INFO:tensorflow:Average training steps per second: 341.54
I0902 00:26:58.262187 140183943698432 replay_runner.py:36] Average training steps per second: 341.54
I0902 00:26:58.401101 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.12
INFO:tensorflow:Starting iteration 29

Steps executed: 236 Episode length: 79 Return: -801.98618906903215424
INFO:tensorflow:Average training steps per second: 366.73
I0902 00:27:04.461632 140183943698432 replay_runner.py:36] Average training steps per second: 366.73

Done fixed training!Episode length: 79 Return: -801.98618906903215424