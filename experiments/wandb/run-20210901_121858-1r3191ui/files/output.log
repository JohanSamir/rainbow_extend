Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0901 12:19:04.804899 140606607828992 run_experiment.py:549] Creating TrainRunner ...
I0901 12:19:04.814524 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:04.814792 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:04.814912 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:04.815155 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:04.815392 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:04.815592 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:04.815756 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:04.815874 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:04.815976 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:04.816087 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:04.816191 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:04.816290 140606607828992 dqn_agent.py:283] 	 seed: 1630498744814454
I0901 12:19:04.819310 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:04.819521 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:04.819662 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:04.819783 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:04.819893 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:04.819999 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:04.820115 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:04.820220 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:04.820324 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:05.045584 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.525289 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.540480 140606607828992 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:19:05.549919 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:19:05.550192 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:19:05.550314 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:19:05.550457 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:19:05.550596 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:19:05.550679 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:19:05.550839 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:19:05.550934 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:19:05.551222 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:19:05.551442 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:19:05.551576 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:19:05.551672 140606607828992 dqn_agent.py:283] 	 seed: 1630498745549851
I0901 12:19:05.554461 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:19:05.554607 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:19:05.554764 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:19:05.554858 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:19:05.554920 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:19:05.555058 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:19:05.555120 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:19:05.555174 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:19:05.555228 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:19:05.587413 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:19:05.608421 140606607828992 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:19:05.608835 140606607828992 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.58
I0901 12:19:12.385314 140606607828992 replay_runner.py:36] Average training steps per second: 147.58
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:19:13.942773 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:19:14.185295 140606607828992 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.00
I0901 12:19:19.185857 140606607828992 replay_runner.py:36] Average training steps per second: 200.00
I0901 12:19:19.586761 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:19:19.822804 140606607828992 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.45
I0901 12:19:25.073856 140606607828992 replay_runner.py:36] Average training steps per second: 190.45
I0901 12:19:25.490228 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:19:25.731061 140606607828992 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.71
I0901 12:19:30.713795 140606607828992 replay_runner.py:36] Average training steps per second: 200.71
I0901 12:19:31.139437 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:19:31.384830 140606607828992 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.78
I0901 12:19:36.466993 140606607828992 replay_runner.py:36] Average training steps per second: 196.78
I0901 12:19:36.870271 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:19:37.113047 140606607828992 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 207.92
I0901 12:19:41.923035 140606607828992 replay_runner.py:36] Average training steps per second: 207.92
I0901 12:19:42.327092 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:19:42.559297 140606607828992 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 197.81
I0901 12:19:47.615225 140606607828992 replay_runner.py:36] Average training steps per second: 197.81
I0901 12:19:48.005169 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:19:48.280469 140606607828992 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.00
I0901 12:19:53.331419 140606607828992 replay_runner.py:36] Average training steps per second: 198.00
I0901 12:19:53.767188 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:19:54.002187 140606607828992 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 190.86
I0901 12:19:59.242089 140606607828992 replay_runner.py:36] Average training steps per second: 190.86
I0901 12:19:59.631617 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:19:59.863222 140606607828992 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.92
I0901 12:20:04.942083 140606607828992 replay_runner.py:36] Average training steps per second: 196.92
I0901 12:20:05.342400 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 141 Episode length: 141 Return: -140.0
INFO:tensorflow:Average training steps per second: 195.77

Steps executed: 310 Episode length: 169 Return: -168.0
I0901 12:20:10.960958 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.39
I0901 12:20:16.411534 140606607828992 replay_runner.py:36] Average training steps per second: 192.39
I0901 12:20:16.856665 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:20:17.111209 140606607828992 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.17
I0901 12:20:22.235435 140606607828992 replay_runner.py:36] Average training steps per second: 195.17
I0901 12:20:22.688987 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 605 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.73
I0901 12:20:28.155831 140606607828992 replay_runner.py:36] Average training steps per second: 191.73
I0901 12:20:28.646003 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.77
I0901 12:20:34.100441 140606607828992 replay_runner.py:36] Average training steps per second: 191.77
I0901 12:20:34.520625 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 263 Episode length: 263 Return: -262.0
INFO:tensorflow:Average training steps per second: 202.01
I0901 12:20:39.718929 140606607828992 replay_runner.py:36] Average training steps per second: 202.01
I0901 12:20:39.946013 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.00
INFO:tensorflow:Starting iteration 16

Steps executed: 220 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 197.64
I0901 12:20:45.220813 140606607828992 replay_runner.py:36] Average training steps per second: 197.64
I0901 12:20:45.402075 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 17
I0901 12:20:45.652704 140606607828992 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 194.46
I0901 12:20:50.796045 140606607828992 replay_runner.py:36] Average training steps per second: 194.46

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 18

Steps executed: 137 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 196.14
I0901 12:20:56.556003 140606607828992 replay_runner.py:36] Average training steps per second: 196.14
I0901 12:20:56.771632 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 19


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.79
I0901 12:21:02.096326 140606607828992 replay_runner.py:36] Average training steps per second: 196.79
I0901 12:21:02.499667 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 252 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 197.69
I0901 12:21:07.797588 140606607828992 replay_runner.py:36] Average training steps per second: 197.69
I0901 12:21:08.014680 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 21

Steps executed: 239 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 195.84
I0901 12:21:13.365130 140606607828992 replay_runner.py:36] Average training steps per second: 195.84
I0901 12:21:13.566713 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 22
I0901 12:21:13.804595 140606607828992 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 199.78

Steps executed: 233 Episode length: 95 Return: -94.0.0
I0901 12:21:19.026158 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 23

Steps executed: 267 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 191.15
I0901 12:21:24.504059 140606607828992 replay_runner.py:36] Average training steps per second: 191.15
I0901 12:21:24.728124 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 24

Steps executed: 372 Episode length: 372 Return: -371.0
INFO:tensorflow:Average training steps per second: 199.25
I0901 12:21:29.995309 140606607828992 replay_runner.py:36] Average training steps per second: 199.25
I0901 12:21:30.311480 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.00
INFO:tensorflow:Starting iteration 25

Steps executed: 222 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 193.86
I0901 12:21:35.710250 140606607828992 replay_runner.py:36] Average training steps per second: 193.86
I0901 12:21:35.875816 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 26

Steps executed: 116 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 205.25

Steps executed: 274 Episode length: 87 Return: -86.0.0
I0901 12:21:41.212856 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 27

Steps executed: 266 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 203.91
I0901 12:21:46.357704 140606607828992 replay_runner.py:36] Average training steps per second: 203.91
I0901 12:21:46.554918 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 28

Steps executed: 301 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 204.87
I0901 12:21:51.682214 140606607828992 replay_runner.py:36] Average training steps per second: 204.87
I0901 12:21:51.971408 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.33
INFO:tensorflow:Starting iteration 29

Steps executed: 246 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 205.34
I0901 12:21:57.078708 140606607828992 replay_runner.py:36] Average training steps per second: 205.34

Done fixed training!Episode length: 64 Return: -63.0.0