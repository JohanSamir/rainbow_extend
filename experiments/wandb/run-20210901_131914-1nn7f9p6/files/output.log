I0901 13:19:19.901826 139683016574976 run_experiment.py:549] Creating TrainRunner ...
I0901 13:19:19.911009 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:19:19.911141 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:19:19.911230 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:19:19.911292 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:19:19.911347 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:19:19.911427 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:19:19.911481 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:19:19.911586 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:19:19.911666 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:19:19.911744 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:19:19.911824 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:19:19.911904 139683016574976 dqn_agent.py:283] 	 seed: 1630502359910970
I0901 13:19:19.913547 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:19:19.913663 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:19:19.913739 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:19:19.913807 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:19:19.913865 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:19:19.913964 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:19:19.914031 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:19:19.914085 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:19:19.914171 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:19:19.944038 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:20.193503 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:20.203350 139683016574976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:19:20.209757 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:19:20.209925 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:19:20.210026 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:19:20.210177 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:19:20.210263 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:19:20.210354 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:19:20.210467 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:19:20.210537 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:19:20.210613 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:19:20.210760 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:19:20.210939 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:19:20.211017 139683016574976 dqn_agent.py:283] 	 seed: 1630502360209722
I0901 13:19:20.212606 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:19:20.212775 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:19:20.212889 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:19:20.212962 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:19:20.213033 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:19:20.213114 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:19:20.213207 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:19:20.213278 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:19:20.213349 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:19:20.237322 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:20.251446 139683016574976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:19:20.251603 139683016574976 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 238.17
I0901 13:19:24.450433 139683016574976 replay_runner.py:36] Average training steps per second: 238.17
I0901 13:19:25.215785 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.64
Steps executed: 237 Episode length: 108 Return: -148.73946684362403
INFO:tensorflow:Starting iteration 1

Steps executed: 271 Episode length: 124 Return: -229.52507366296174
INFO:tensorflow:Average training steps per second: 326.21
I0901 13:19:31.669056 139683016574976 replay_runner.py:36] Average training steps per second: 326.21
I0901 13:19:31.842610 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.72
INFO:tensorflow:Starting iteration 2

Steps executed: 310 Episode length: 113 Return: -262.18354991240227
INFO:tensorflow:Average training steps per second: 332.46
I0901 13:19:38.217390 139683016574976 replay_runner.py:36] Average training steps per second: 332.46
I0901 13:19:38.409467 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.62
INFO:tensorflow:Starting iteration 3

Steps executed: 298 Episode length: 133 Return: -242.05438880518923
INFO:tensorflow:Average training steps per second: 351.20
I0901 13:19:44.682529 139683016574976 replay_runner.py:36] Average training steps per second: 351.20
I0901 13:19:44.826446 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.84
INFO:tensorflow:Starting iteration 4

Steps executed: 271 Episode length: 82 Return: -237.005759439041758
INFO:tensorflow:Average training steps per second: 332.04
I0901 13:19:51.279142 139683016574976 replay_runner.py:36] Average training steps per second: 332.04
I0901 13:19:51.420372 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.19
INFO:tensorflow:Starting iteration 5

Steps executed: 349 Episode length: 232 Return: -422.08199698865985
INFO:tensorflow:Average training steps per second: 332.08
I0901 13:19:57.850959 139683016574976 replay_runner.py:36] Average training steps per second: 332.08
I0901 13:19:58.107728 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.94
INFO:tensorflow:Starting iteration 6

Steps executed: 263 Episode length: 263 Return: -218.13627295403631
INFO:tensorflow:Average training steps per second: 347.94
I0901 13:20:04.444329 139683016574976 replay_runner.py:36] Average training steps per second: 347.94
I0901 13:20:04.669936 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.14
INFO:tensorflow:Starting iteration 7

Steps executed: 438 Episode length: 438 Return: -276.16919535724431
INFO:tensorflow:Average training steps per second: 357.52
I0901 13:20:11.004701 139683016574976 replay_runner.py:36] Average training steps per second: 357.52
I0901 13:20:11.642631 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.17
INFO:tensorflow:Starting iteration 8

Steps executed: 263 Episode length: 134 Return: -43.414462211242581
INFO:tensorflow:Average training steps per second: 341.72
I0901 13:20:18.014267 139683016574976 replay_runner.py:36] Average training steps per second: 341.72
I0901 13:20:18.186939 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -36.46
INFO:tensorflow:Starting iteration 9

Steps executed: 642 Episode length: 642 Return: -263.30432665819151
INFO:tensorflow:Average training steps per second: 345.84
I0901 13:20:24.536091 139683016574976 replay_runner.py:36] Average training steps per second: 345.84
I0901 13:20:25.583086 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.30
INFO:tensorflow:Starting iteration 10
I0901 13:20:29.006058 139683016574976 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 351.63

Steps executed: 867 Episode length: 867 Return: -519.55813426361111
I0901 13:20:33.395104 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.56
INFO:tensorflow:Starting iteration 11

Steps executed: 88 Episode length: 88 Return: -162.6278594909061311
INFO:tensorflow:Average training steps per second: 332.55

Steps executed: 449 Episode length: 361 Return: -314.64792052177194
I0901 13:20:40.188280 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.64
INFO:tensorflow:Starting iteration 12

Steps executed: 384 Episode length: 384 Return: -326.40536929652916
INFO:tensorflow:Average training steps per second: 345.83
I0901 13:20:46.385543 139683016574976 replay_runner.py:36] Average training steps per second: 345.83
I0901 13:20:46.783901 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.41
INFO:tensorflow:Starting iteration 13

Steps executed: 261 Episode length: 140 Return: -148.27881567796447
INFO:tensorflow:Average training steps per second: 351.56
I0901 13:20:53.028589 139683016574976 replay_runner.py:36] Average training steps per second: 351.56
I0901 13:20:53.212047 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.62
INFO:tensorflow:Starting iteration 14

Steps executed: 436 Episode length: 294 Return: -257.61140280495783
INFO:tensorflow:Average training steps per second: 366.77
I0901 13:20:59.437639 139683016574976 replay_runner.py:36] Average training steps per second: 366.77
I0901 13:20:59.774301 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.01
INFO:tensorflow:Starting iteration 15
I0901 13:21:03.311183 139683016574976 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 366.94

Steps executed: 277 Episode length: 164 Return: -142.38226658439822
I0901 13:21:06.189106 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.38
INFO:tensorflow:Starting iteration 16

Steps executed: 1000 Episode length: 1000 Return: -218.5667839662271
INFO:tensorflow:Average training steps per second: 354.45
I0901 13:21:12.537096 139683016574976 replay_runner.py:36] Average training steps per second: 354.45
I0901 13:21:13.934758 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.57
INFO:tensorflow:Starting iteration 17
I0901 13:21:17.511453 139683016574976 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 370.04

Steps executed: 374 Episode length: 210 Return: -140.937185059847821
I0901 13:21:20.440873 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.78
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 114 Return: -300.358048308977621
INFO:tensorflow:Average training steps per second: 357.93
I0901 13:21:26.794028 139683016574976 replay_runner.py:36] Average training steps per second: 357.93
I0901 13:21:26.902158 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.34
INFO:tensorflow:Starting iteration 19

Steps executed: 295 Episode length: 134 Return: -112.330752077210131
INFO:tensorflow:Average training steps per second: 351.08
I0901 13:21:33.253004 139683016574976 replay_runner.py:36] Average training steps per second: 351.08
I0901 13:21:33.415812 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.97
INFO:tensorflow:Starting iteration 20
I0901 13:21:36.961622 139683016574976 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 349.04

Steps executed: 213 Episode length: 116 Return: -111.982044572910721
I0901 13:21:39.925994 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.78
INFO:tensorflow:Starting iteration 21

Steps executed: 462 Episode length: 462 Return: -72.2035249247694121
INFO:tensorflow:Average training steps per second: 342.15
I0901 13:21:46.372271 139683016574976 replay_runner.py:36] Average training steps per second: 342.15
I0901 13:21:46.843188 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.20
INFO:tensorflow:Starting iteration 22

Steps executed: 247 Episode length: 129 Return: -60.5606246742970741
INFO:tensorflow:Average training steps per second: 327.17
I0901 13:21:53.332591 139683016574976 replay_runner.py:36] Average training steps per second: 327.17
I0901 13:21:53.464589 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.44
INFO:tensorflow:Starting iteration 23

Steps executed: 289 Episode length: 97 Return: -196.9455010739306741
INFO:tensorflow:Average training steps per second: 312.61
I0901 13:22:00.054291 139683016574976 replay_runner.py:36] Average training steps per second: 312.61
I0901 13:22:00.192930 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.31
INFO:tensorflow:Starting iteration 24

Steps executed: 255 Episode length: 65 Return: -222.7397358533570241
INFO:tensorflow:Average training steps per second: 312.85
I0901 13:22:06.729821 139683016574976 replay_runner.py:36] Average training steps per second: 312.85
I0901 13:22:06.874411 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.10
INFO:tensorflow:Starting iteration 25
I0901 13:22:10.195129 139683016574976 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 335.54

Steps executed: 1000 Episode length: 1000 Return: -57.06044851007566
I0901 13:22:15.520245 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.06
INFO:tensorflow:Starting iteration 26

Steps executed: 124 Episode length: 124 Return: -23.5632118000100866
INFO:tensorflow:Average training steps per second: 326.25
I0901 13:22:21.892983 139683016574976 replay_runner.py:36] Average training steps per second: 326.25

Steps executed: 269 Episode length: 145 Return: -91.9966538101236366
INFO:tensorflow:Starting iteration 27

Steps executed: 334 Episode length: 160 Return: -175.262285579073536
INFO:tensorflow:Average training steps per second: 345.15
I0901 13:22:28.374646 139683016574976 replay_runner.py:36] Average training steps per second: 345.15
I0901 13:22:28.603801 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.92
INFO:tensorflow:Starting iteration 28

Steps executed: 249 Episode length: 112 Return: -228.597515450109576
INFO:tensorflow:Average training steps per second: 347.38
I0901 13:22:34.948011 139683016574976 replay_runner.py:36] Average training steps per second: 347.38
I0901 13:22:35.098163 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.17
INFO:tensorflow:Starting iteration 29

Steps executed: 256 Episode length: 94 Return: -202.7268013375866676
INFO:tensorflow:Average training steps per second: 323.93
I0901 13:22:41.625744 139683016574976 replay_runner.py:36] Average training steps per second: 323.93

Done fixed training!Episode length: 94 Return: -202.7268013375866676