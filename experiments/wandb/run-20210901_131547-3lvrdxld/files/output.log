I0901 13:15:53.809786 140315766171648 run_experiment.py:549] Creating TrainRunner ...
I0901 13:15:53.817434 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:53.817572 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:53.817702 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:53.817767 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:53.817823 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:53.817957 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:53.818030 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:53.818135 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:53.818250 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:53.818365 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:53.818455 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:53.818543 140315766171648 dqn_agent.py:283] 	 seed: 1630502153817397
I0901 13:15:53.820280 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:53.820394 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:53.820470 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:53.820532 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:53.820589 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:53.820658 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:53.820727 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:53.820829 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:53.820959 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:53.848453 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:54.120563 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:54.130148 140315766171648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:15:54.137494 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:54.137648 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:54.137718 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:54.137807 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:54.137912 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:54.137999 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:54.138067 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:54.138159 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:54.138251 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:54.138352 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:54.138428 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:54.138507 140315766171648 dqn_agent.py:283] 	 seed: 1630502154137450
I0901 13:15:54.139895 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:54.140016 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:54.140121 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:54.140182 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:54.140467 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:54.140559 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:54.140626 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:54.140730 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:54.140803 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:54.164677 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:54.182828 140315766171648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:15:54.183098 140315766171648 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 226.28
I0901 13:15:58.602565 140315766171648 replay_runner.py:36] Average training steps per second: 226.28
Steps executed: 291 Episode length: 144 Return: -311.4883050888598
I0901 13:15:59.475801 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.00
INFO:tensorflow:Starting iteration 1
I0901 13:16:02.879101 140315766171648 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 326.66
I0901 13:16:05.940613 140315766171648 replay_runner.py:36] Average training steps per second: 326.66

Steps executed: 211 Episode length: 83 Return: -166.13099773479578
INFO:tensorflow:Starting iteration 2
I0901 13:16:09.450031 140315766171648 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 330.63
I0901 13:16:12.474831 140315766171648 replay_runner.py:36] Average training steps per second: 330.63

Steps executed: 201 Episode length: 124 Return: -257.4698171141418
INFO:tensorflow:Starting iteration 3

Steps executed: 223 Episode length: 223 Return: -61.27987871907044
INFO:tensorflow:Average training steps per second: 332.96
I0901 13:16:19.014032 140315766171648 replay_runner.py:36] Average training steps per second: 332.96
I0901 13:16:19.172298 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.28
INFO:tensorflow:Starting iteration 4

Steps executed: 311 Episode length: 124 Return: -292.95196318166563
INFO:tensorflow:Average training steps per second: 324.15
I0901 13:16:25.653974 140315766171648 replay_runner.py:36] Average training steps per second: 324.15
I0901 13:16:25.836061 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.98
INFO:tensorflow:Starting iteration 5

Steps executed: 231 Episode length: 131 Return: -355.95489728921363
INFO:tensorflow:Average training steps per second: 320.28
I0901 13:16:32.355586 140315766171648 replay_runner.py:36] Average training steps per second: 320.28
I0901 13:16:32.481994 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.34
INFO:tensorflow:Starting iteration 6

Steps executed: 241 Episode length: 124 Return: -257.59383644060643
INFO:tensorflow:Average training steps per second: 318.48
I0901 13:16:39.015474 140315766171648 replay_runner.py:36] Average training steps per second: 318.48
I0901 13:16:39.161538 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.88
INFO:tensorflow:Starting iteration 7
I0901 13:16:42.553059 140315766171648 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 320.03

Steps executed: 234 Episode length: 70 Return: -142.216059682549243
I0901 13:16:45.800199 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.08
INFO:tensorflow:Starting iteration 8

Steps executed: 280 Episode length: 94 Return: -265.293346618670173
INFO:tensorflow:Average training steps per second: 321.64
I0901 13:16:52.341668 140315766171648 replay_runner.py:36] Average training steps per second: 321.64
I0901 13:16:52.499007 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.22
INFO:tensorflow:Starting iteration 9

Steps executed: 267 Episode length: 106 Return: -249.09506254937875
INFO:tensorflow:Average training steps per second: 329.53
I0901 13:16:58.939031 140315766171648 replay_runner.py:36] Average training steps per second: 329.53
I0901 13:16:59.074306 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.53
INFO:tensorflow:Starting iteration 10

Steps executed: 259 Episode length: 163 Return: -384.73867855286255
INFO:tensorflow:Average training steps per second: 338.19
I0901 13:17:05.478681 140315766171648 replay_runner.py:36] Average training steps per second: 338.19
I0901 13:17:05.654449 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.89
INFO:tensorflow:Starting iteration 11

Steps executed: 341 Episode length: 269 Return: -345.00806027190634
INFO:tensorflow:Average training steps per second: 338.57
I0901 13:17:12.088985 140315766171648 replay_runner.py:36] Average training steps per second: 338.57
I0901 13:17:12.357914 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.24
INFO:tensorflow:Starting iteration 12

Steps executed: 227 Episode length: 70 Return: -260.573137350543334
INFO:tensorflow:Average training steps per second: 341.33
I0901 13:17:18.792463 140315766171648 replay_runner.py:36] Average training steps per second: 341.33
I0901 13:17:18.910370 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.27
INFO:tensorflow:Starting iteration 13

Steps executed: 222 Episode length: 80 Return: -233.441961169749054
INFO:tensorflow:Average training steps per second: 338.76
I0901 13:17:25.354030 140315766171648 replay_runner.py:36] Average training steps per second: 338.76
I0901 13:17:25.477830 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.95
INFO:tensorflow:Starting iteration 14
I0901 13:17:28.983314 140315766171648 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 340.12

Steps executed: 241 Episode length: 158 Return: -145.24131278902954
I0901 13:17:32.068703 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.63
INFO:tensorflow:Starting iteration 15

Steps executed: 221 Episode length: 107 Return: -264.37360938335374
INFO:tensorflow:Average training steps per second: 335.52
I0901 13:17:38.557855 140315766171648 replay_runner.py:36] Average training steps per second: 335.52
I0901 13:17:38.685523 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.26
INFO:tensorflow:Starting iteration 16

Steps executed: 202 Episode length: 62 Return: -473.870179411915964
INFO:tensorflow:Average training steps per second: 344.64
I0901 13:17:45.092443 140315766171648 replay_runner.py:36] Average training steps per second: 344.64
I0901 13:17:45.213568 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.51
INFO:tensorflow:Starting iteration 17
I0901 13:17:48.726983 140315766171648 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 335.89

Steps executed: 599 Episode length: 599 Return: -504.23788673163267
I0901 13:17:52.630413 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -504.24
INFO:tensorflow:Starting iteration 18

Steps executed: 290 Episode length: 95 Return: -408.440358786823257
INFO:tensorflow:Average training steps per second: 329.07
I0901 13:17:59.139890 140315766171648 replay_runner.py:36] Average training steps per second: 329.07
I0901 13:17:59.306918 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -407.89
INFO:tensorflow:Starting iteration 19

Steps executed: 265 Episode length: 169 Return: -493.41812771026497
INFO:tensorflow:Average training steps per second: 325.95
I0901 13:18:05.870879 140315766171648 replay_runner.py:36] Average training steps per second: 325.95
I0901 13:18:06.057079 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.25
INFO:tensorflow:Starting iteration 20

Steps executed: 213 Episode length: 72 Return: -493.672772433477867
INFO:tensorflow:Average training steps per second: 332.55
I0901 13:18:12.545085 140315766171648 replay_runner.py:36] Average training steps per second: 332.55
I0901 13:18:12.675461 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.12
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 89 Return: -568.890576633756487
INFO:tensorflow:Average training steps per second: 329.10
I0901 13:18:19.137574 140315766171648 replay_runner.py:36] Average training steps per second: 329.10
I0901 13:18:19.307733 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.30
INFO:tensorflow:Starting iteration 22
I0901 13:18:22.778192 140315766171648 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 332.74
I0901 13:18:25.783789 140315766171648 replay_runner.py:36] Average training steps per second: 332.74

Steps executed: 225 Episode length: 56 Return: -423.549845633396167
INFO:tensorflow:Starting iteration 23

Steps executed: 220 Episode length: 55 Return: -263.432414261604867
INFO:tensorflow:Average training steps per second: 340.40
I0901 13:18:32.325473 140315766171648 replay_runner.py:36] Average training steps per second: 340.40
I0901 13:18:32.434983 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.77
INFO:tensorflow:Starting iteration 24

Steps executed: 289 Episode length: 199 Return: -260.22749468961274
INFO:tensorflow:Average training steps per second: 326.42
I0901 13:18:38.961570 140315766171648 replay_runner.py:36] Average training steps per second: 326.42
I0901 13:18:39.155956 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.09
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 82 Return: -768.106239791476774
INFO:tensorflow:Average training steps per second: 338.44
I0901 13:18:45.530543 140315766171648 replay_runner.py:36] Average training steps per second: 338.44
I0901 13:18:45.672897 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -733.31
INFO:tensorflow:Starting iteration 26
I0901 13:18:49.034638 140315766171648 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 329.94

Steps executed: 254 Episode length: 108 Return: -286.20318940703034
I0901 13:18:52.254807 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.14
INFO:tensorflow:Starting iteration 27

Steps executed: 253 Episode length: 85 Return: -463.754135378343459
INFO:tensorflow:Average training steps per second: 319.66
I0901 13:18:58.571589 140315766171648 replay_runner.py:36] Average training steps per second: 319.66
I0901 13:18:58.725326 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.25
INFO:tensorflow:Starting iteration 28

Steps executed: 211 Episode length: 59 Return: -243.592960671220859
INFO:tensorflow:Average training steps per second: 338.61
I0901 13:19:04.964075 140315766171648 replay_runner.py:36] Average training steps per second: 338.61
I0901 13:19:05.078016 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.09
INFO:tensorflow:Starting iteration 29

Steps executed: 243 Episode length: 78 Return: -452.757259914758049
INFO:tensorflow:Average training steps per second: 360.95
I0901 13:19:11.261987 140315766171648 replay_runner.py:36] Average training steps per second: 360.95

Done fixed training!Episode length: 78 Return: -452.757259914758049