Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 17:46:11.140906 140110082734080 run_experiment.py:549] Creating TrainRunner ...
I0902 17:46:11.150161 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:46:11.150485 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:46:11.150750 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:46:11.150905 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:46:11.151183 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 17:46:11.151301 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:46:11.151394 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:46:11.151498 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:46:11.151663 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:46:11.151755 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 17:46:11.151848 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:46:11.151937 140110082734080 dqn_agent.py:283] 	 seed: 1630604771150080
I0902 17:46:11.155107 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:46:11.155245 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:46:11.155354 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:46:11.155438 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:46:11.155514 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:46:11.155594 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:46:11.155677 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:46:11.155825 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:46:11.155906 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:46:11.188477 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:11.565630 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:11.581710 140110082734080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:46:11.591365 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:46:11.591643 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:46:11.591833 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:46:11.591948 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:46:11.592054 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 17:46:11.592136 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:46:11.592415 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:46:11.592527 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:46:11.592605 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:46:11.592716 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 17:46:11.592788 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:46:11.592859 140110082734080 dqn_agent.py:283] 	 seed: 1630604771591320
I0902 17:46:11.595625 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:46:11.595806 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:46:11.595931 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:46:11.596044 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:46:11.596144 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:46:11.596241 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:46:11.596379 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:46:11.596485 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:46:11.596580 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:46:11.909612 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:46:11.929706 140110082734080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:46:11.930172 140110082734080 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.65
I0902 17:46:17.931073 140110082734080 replay_runner.py:36] Average training steps per second: 166.65
Steps executed: 210 Episode length: 77 Return: -419.33146918797826
I0902 17:46:19.106118 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.52
INFO:tensorflow:Starting iteration 1

Steps executed: 214 Episode length: 71 Return: -156.63959834037388
INFO:tensorflow:Average training steps per second: 225.93
I0902 17:46:27.703394 140110082734080 replay_runner.py:36] Average training steps per second: 225.93
I0902 17:46:27.877086 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.08
INFO:tensorflow:Starting iteration 2
I0902 17:46:32.255147 140110082734080 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 225.24
I0902 17:46:36.695577 140110082734080 replay_runner.py:36] Average training steps per second: 225.24

Steps executed: 238 Episode length: 87 Return: -388.90395610077294
INFO:tensorflow:Starting iteration 3

Steps executed: 230 Episode length: 67 Return: -164.53611186517992
INFO:tensorflow:Average training steps per second: 224.08
I0902 17:46:45.594268 140110082734080 replay_runner.py:36] Average training steps per second: 224.08
I0902 17:46:45.812323 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.95
INFO:tensorflow:Starting iteration 4

Steps executed: 170 Episode length: 71 Return: -174.45039573893322
INFO:tensorflow:Average training steps per second: 225.67
I0902 17:46:54.661889 140110082734080 replay_runner.py:36] Average training steps per second: 225.67

Steps executed: 234 Episode length: 64 Return: -90.320534682930922
INFO:tensorflow:Starting iteration 5

Steps executed: 283 Episode length: 84 Return: -167.11768314522175
INFO:tensorflow:Average training steps per second: 229.02
I0902 17:47:03.588852 140110082734080 replay_runner.py:36] Average training steps per second: 229.02
I0902 17:47:03.844691 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.75
INFO:tensorflow:Starting iteration 6

Steps executed: 284 Episode length: 102 Return: -234.92368208709544
INFO:tensorflow:Average training steps per second: 257.49
I0902 17:47:11.815465 140110082734080 replay_runner.py:36] Average training steps per second: 257.49
I0902 17:47:12.066435 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.16
INFO:tensorflow:Starting iteration 7

Steps executed: 204 Episode length: 68 Return: -566.084060275640544
INFO:tensorflow:Average training steps per second: 239.66
I0902 17:47:20.355120 140110082734080 replay_runner.py:36] Average training steps per second: 239.66
I0902 17:47:20.526465 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.22
INFO:tensorflow:Starting iteration 8

Steps executed: 219 Episode length: 63 Return: -124.253217380821774
INFO:tensorflow:Average training steps per second: 262.46
I0902 17:47:28.571231 140110082734080 replay_runner.py:36] Average training steps per second: 262.46
I0902 17:47:28.738868 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.20
INFO:tensorflow:Starting iteration 9
I0902 17:47:32.978372 140110082734080 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 241.44

Steps executed: 260 Episode length: 68 Return: -655.162280577796274
I0902 17:47:37.372645 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.61
INFO:tensorflow:Starting iteration 10

Steps executed: 244 Episode length: 79 Return: -102.347315085960084
INFO:tensorflow:Average training steps per second: 227.54
I0902 17:47:46.013660 140110082734080 replay_runner.py:36] Average training steps per second: 227.54
I0902 17:47:46.220984 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.52
INFO:tensorflow:Starting iteration 11

Steps executed: 226 Episode length: 71 Return: -533.339784137862684
INFO:tensorflow:Average training steps per second: 238.89
I0902 17:47:54.668943 140110082734080 replay_runner.py:36] Average training steps per second: 238.89
I0902 17:47:54.879637 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -563.24
INFO:tensorflow:Starting iteration 12

Steps executed: 260 Episode length: 104 Return: -95.925938185165784
INFO:tensorflow:Average training steps per second: 227.13
I0902 17:48:03.645404 140110082734080 replay_runner.py:36] Average training steps per second: 227.13
I0902 17:48:03.873687 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.61
INFO:tensorflow:Starting iteration 13

Steps executed: 262 Episode length: 105 Return: -176.75445132767268
INFO:tensorflow:Average training steps per second: 225.08
I0902 17:48:12.701262 140110082734080 replay_runner.py:36] Average training steps per second: 225.08
I0902 17:48:12.943924 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.40
INFO:tensorflow:Starting iteration 14

Steps executed: 252 Episode length: 98 Return: -300.340574997471668
INFO:tensorflow:Average training steps per second: 231.54
I0902 17:48:21.671727 140110082734080 replay_runner.py:36] Average training steps per second: 231.54
I0902 17:48:21.893689 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -476.10
INFO:tensorflow:Starting iteration 15

Steps executed: 226 Episode length: 74 Return: -706.945015408454268
INFO:tensorflow:Average training steps per second: 232.97
I0902 17:48:30.360229 140110082734080 replay_runner.py:36] Average training steps per second: 232.97
I0902 17:48:30.569227 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -666.07
INFO:tensorflow:Starting iteration 16


Steps executed: 238 Episode length: 148 Return: 16.4519016710118468
INFO:tensorflow:Average training steps per second: 233.06
I0902 17:48:39.273318 140110082734080 replay_runner.py:36] Average training steps per second: 233.06
I0902 17:48:39.482456 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.76
INFO:tensorflow:Starting iteration 17

Steps executed: 257 Episode length: 99 Return: -103.539081428951088
INFO:tensorflow:Average training steps per second: 232.60
I0902 17:48:48.218749 140110082734080 replay_runner.py:36] Average training steps per second: 232.60
I0902 17:48:48.445582 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.38
INFO:tensorflow:Starting iteration 18
I0902 17:48:52.848384 140110082734080 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 233.66

Steps executed: 275 Episode length: 90 Return: -114.017001258009878
I0902 17:48:57.357864 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.73
INFO:tensorflow:Starting iteration 19

Steps executed: 249 Episode length: 149 Return: -116.40542414909768
INFO:tensorflow:Average training steps per second: 230.10
I0902 17:49:06.080894 140110082734080 replay_runner.py:36] Average training steps per second: 230.10
I0902 17:49:06.299699 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -407.19
INFO:tensorflow:Starting iteration 20
I0902 17:49:10.615822 140110082734080 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 224.81
I0902 17:49:15.064666 140110082734080 replay_runner.py:36] Average training steps per second: 224.81

Steps executed: 230 Episode length: 146 Return: -381.08887663014138
INFO:tensorflow:Starting iteration 21

Steps executed: 213 Episode length: 104 Return: -348.36852159866294
INFO:tensorflow:Average training steps per second: 227.11
I0902 17:49:23.992900 140110082734080 replay_runner.py:36] Average training steps per second: 227.11
I0902 17:49:24.186762 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.43
INFO:tensorflow:Starting iteration 22

Steps executed: 255 Episode length: 80 Return: -691.663244454963254
INFO:tensorflow:Average training steps per second: 232.82
I0902 17:49:32.652570 140110082734080 replay_runner.py:36] Average training steps per second: 232.82
I0902 17:49:32.857631 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.15
INFO:tensorflow:Starting iteration 23
I0902 17:49:37.111346 140110082734080 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 232.04

Steps executed: 220 Episode length: 220 Return: -463.52960232465233
I0902 17:49:41.638995 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -463.53
INFO:tensorflow:Starting iteration 24

Steps executed: 274 Episode length: 100 Return: -113.17825694522493
INFO:tensorflow:Average training steps per second: 228.65
I0902 17:49:50.364637 140110082734080 replay_runner.py:36] Average training steps per second: 228.65
I0902 17:49:50.587292 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.09
INFO:tensorflow:Starting iteration 25
I0902 17:49:55.030530 140110082734080 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 224.61

Steps executed: 364 Episode length: 208 Return: -66.813140188951753
I0902 17:49:59.815362 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.49
INFO:tensorflow:Starting iteration 26

Steps executed: 314 Episode length: 128 Return: -220.04303750116733
INFO:tensorflow:Average training steps per second: 251.50
I0902 17:50:08.161389 140110082734080 replay_runner.py:36] Average training steps per second: 251.50
I0902 17:50:08.414881 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.07
INFO:tensorflow:Starting iteration 27

Steps executed: 228 Episode length: 124 Return: -224.19214805603872
INFO:tensorflow:Average training steps per second: 236.99
I0902 17:50:16.706724 140110082734080 replay_runner.py:36] Average training steps per second: 236.99
I0902 17:50:16.875341 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.92
INFO:tensorflow:Starting iteration 28

Steps executed: 163 Episode length: 163 Return: -205.88752075973227
INFO:tensorflow:Average training steps per second: 240.71
I0902 17:50:25.243119 140110082734080 replay_runner.py:36] Average training steps per second: 240.71

Steps executed: 335 Episode length: 172 Return: -293.97825044614067
INFO:tensorflow:Starting iteration 29

Steps executed: 253 Episode length: 102 Return: -397.69285585920056
INFO:tensorflow:Average training steps per second: 243.99
I0902 17:50:33.958570 140110082734080 replay_runner.py:36] Average training steps per second: 243.99

Done fixed training!Episode length: 102 Return: -397.69285585920056