I0901 23:49:42.364871 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0901 23:49:42.375380 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:49:42.375609 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:49:42.375778 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:49:42.375880 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:49:42.375977 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0901 23:49:42.376239 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:49:42.376373 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:49:42.376519 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:49:42.376656 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:49:42.376778 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0901 23:49:42.376898 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:49:42.376982 140183943698432 dqn_agent.py:283] 	 seed: 1630540182375319
I0901 23:49:42.379914 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:49:42.380177 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:49:42.381153 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:49:42.381330 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:49:42.381449 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:49:42.381611 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:49:42.381798 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:49:42.381881 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:49:42.381955 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0901 23:49:44.203789 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:49:44.626795 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:49:44.641566 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:49:44.650929 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:49:44.651137 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:49:44.651240 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:49:44.651312 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:49:44.651375 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0901 23:49:44.651438 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:49:44.651520 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:49:44.651867 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:49:44.652021 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:49:44.652164 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0901 23:49:44.652317 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:49:44.652425 140183943698432 dqn_agent.py:283] 	 seed: 1630540184650877
I0901 23:49:44.655240 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:49:44.655499 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:49:44.655658 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:49:44.655742 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:49:44.655810 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:49:44.655910 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:49:44.656010 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:49:44.656111 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:49:44.656408 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:49:44.690482 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:49:44.714230 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:49:44.714539 140183943698432 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.23
I0901 23:49:50.841119 140183943698432 replay_runner.py:36] Average training steps per second: 163.23
Steps executed: 350 Episode length: 177 Return: -288.77580021147976
I0901 23:49:52.142245 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.50
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 219 Return: -273.73632568963926
INFO:tensorflow:Average training steps per second: 226.30
I0901 23:50:00.919239 140183943698432 replay_runner.py:36] Average training steps per second: 226.30
I0901 23:50:01.223152 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.74
INFO:tensorflow:Starting iteration 2

Steps executed: 322 Episode length: 256 Return: -384.96511525848473
INFO:tensorflow:Average training steps per second: 218.79
I0901 23:50:10.080818 140183943698432 replay_runner.py:36] Average training steps per second: 218.79
I0901 23:50:10.435695 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.03
INFO:tensorflow:Starting iteration 3

Steps executed: 465 Episode length: 465 Return: -252.24910991594663
INFO:tensorflow:Average training steps per second: 225.39
I0901 23:50:19.069917 140183943698432 replay_runner.py:36] Average training steps per second: 225.39
I0901 23:50:19.731397 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.25
INFO:tensorflow:Starting iteration 4

Steps executed: 588 Episode length: 588 Return: -305.03802525931815
INFO:tensorflow:Average training steps per second: 227.09
I0901 23:50:28.392685 140183943698432 replay_runner.py:36] Average training steps per second: 227.09
I0901 23:50:29.411128 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.04
INFO:tensorflow:Starting iteration 5
I0901 23:50:33.675741 140183943698432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 239.83

Steps executed: 698 Episode length: 698 Return: -181.29644546691365
I0901 23:50:39.553355 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.30
INFO:tensorflow:Starting iteration 6
I0901 23:50:43.783503 140183943698432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.77

Steps executed: 1000 Episode length: 1000 Return: -75.53796033901139
I0901 23:50:51.947270 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.54
INFO:tensorflow:Starting iteration 7

Steps executed: 732 Episode length: 732 Return: -347.548461928373139
INFO:tensorflow:Average training steps per second: 230.29
I0901 23:51:00.479683 140183943698432 replay_runner.py:36] Average training steps per second: 230.29
I0901 23:51:02.081858 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.55
INFO:tensorflow:Starting iteration 8

Steps executed: 417 Episode length: 417 Return: -295.997723485071939
INFO:tensorflow:Average training steps per second: 217.20
I0901 23:51:10.891461 140183943698432 replay_runner.py:36] Average training steps per second: 217.20
I0901 23:51:11.507019 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.00
INFO:tensorflow:Starting iteration 9
I0901 23:51:15.806132 140183943698432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 221.26

Steps executed: 542 Episode length: 542 Return: -306.318899161614839
I0901 23:51:21.389702 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.32
INFO:tensorflow:Starting iteration 10
I0901 23:51:25.739046 140183943698432 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.58

Steps executed: 533 Episode length: 533 Return: -283.689766540450639
I0901 23:51:31.085009 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.69
INFO:tensorflow:Starting iteration 11

Steps executed: 389 Episode length: 389 Return: -189.676379173033339
INFO:tensorflow:Average training steps per second: 224.48
I0901 23:51:39.885083 140183943698432 replay_runner.py:36] Average training steps per second: 224.48
I0901 23:51:40.428048 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.68
INFO:tensorflow:Starting iteration 12
I0901 23:51:44.856424 140183943698432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 225.89

Steps executed: 889 Episode length: 889 Return: -449.563440088021239
I0901 23:51:51.099571 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.56
INFO:tensorflow:Starting iteration 13
I0901 23:51:55.306452 140183943698432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 225.12

Steps executed: 1000 Episode length: 1000 Return: -322.12824968606003
I0901 23:52:02.138524 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.13
INFO:tensorflow:Starting iteration 14

Steps executed: 555 Episode length: 555 Return: -267.8937731213045503
INFO:tensorflow:Average training steps per second: 222.89
I0901 23:52:10.994994 140183943698432 replay_runner.py:36] Average training steps per second: 222.89
I0901 23:52:11.755151 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.89
INFO:tensorflow:Starting iteration 15
I0901 23:52:16.066905 140183943698432 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 218.33

Steps executed: 211 Episode length: 211 Return: 3.5518665119107175503
I0901 23:52:20.894883 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: 3.55
INFO:tensorflow:Starting iteration 16

Steps executed: 330 Episode length: 167 Return: -136.9911883982656703
INFO:tensorflow:Average training steps per second: 225.14
I0901 23:52:29.687403 140183943698432 replay_runner.py:36] Average training steps per second: 225.14
I0901 23:52:30.020814 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.79
INFO:tensorflow:Starting iteration 17
I0901 23:52:34.396179 140183943698432 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 230.01

Steps executed: 1000 Episode length: 1000 Return: -121.80605110529443
I0901 23:52:41.472445 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.81
INFO:tensorflow:Starting iteration 18
I0901 23:52:45.887444 140183943698432 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 229.93
I0901 23:52:50.237018 140183943698432 replay_runner.py:36] Average training steps per second: 229.93

Steps executed: 333 Episode length: 333 Return: -52.66139454410280543
INFO:tensorflow:Starting iteration 19

Steps executed: 324 Episode length: 324 Return: -529.8322501178412543
INFO:tensorflow:Average training steps per second: 216.56
I0901 23:52:59.550862 140183943698432 replay_runner.py:36] Average training steps per second: 216.56
I0901 23:52:59.976104 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.83
INFO:tensorflow:Starting iteration 20
I0901 23:53:04.184808 140183943698432 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 220.14

Steps executed: 211 Episode length: 211 Return: -202.3441077452988543
I0901 23:53:08.939192 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.34
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 84 Return: -786.68609687558558543
INFO:tensorflow:Average training steps per second: 217.51
I0901 23:53:17.864543 140183943698432 replay_runner.py:36] Average training steps per second: 217.51
I0901 23:53:18.085833 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.72
INFO:tensorflow:Starting iteration 22

Steps executed: 333 Episode length: 189 Return: -183.5176096094108443
INFO:tensorflow:Average training steps per second: 224.01
I0901 23:53:26.839561 140183943698432 replay_runner.py:36] Average training steps per second: 224.01
I0901 23:53:27.157116 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.78
INFO:tensorflow:Starting iteration 23

Steps executed: 362 Episode length: 231 Return: -292.4251591665997743
INFO:tensorflow:Average training steps per second: 231.80
I0901 23:53:35.835110 140183943698432 replay_runner.py:36] Average training steps per second: 231.80
I0901 23:53:36.194535 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.32
INFO:tensorflow:Starting iteration 24

Steps executed: 306 Episode length: 109 Return: -648.1154694967676743
INFO:tensorflow:Average training steps per second: 237.08
I0901 23:53:44.688067 140183943698432 replay_runner.py:36] Average training steps per second: 237.08
I0901 23:53:44.979819 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.29
INFO:tensorflow:Starting iteration 25

Steps executed: 210 Episode length: 99 Return: -229.89640624090354443
INFO:tensorflow:Average training steps per second: 233.64
I0901 23:53:53.513895 140183943698432 replay_runner.py:36] Average training steps per second: 233.64
I0901 23:53:53.706872 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.28
INFO:tensorflow:Starting iteration 26

Steps executed: 257 Episode length: 127 Return: -215.5620312961329443
INFO:tensorflow:Average training steps per second: 230.70
I0901 23:54:02.361903 140183943698432 replay_runner.py:36] Average training steps per second: 230.70
I0901 23:54:02.574578 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.38
INFO:tensorflow:Starting iteration 27

Steps executed: 238 Episode length: 119 Return: -210.5325732336040443
INFO:tensorflow:Average training steps per second: 226.39
I0901 23:54:11.300321 140183943698432 replay_runner.py:36] Average training steps per second: 226.39
I0901 23:54:11.525567 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.19
INFO:tensorflow:Starting iteration 28

Steps executed: 360 Episode length: 165 Return: -72.93875538467356443
INFO:tensorflow:Average training steps per second: 233.18
I0901 23:54:20.129527 140183943698432 replay_runner.py:36] Average training steps per second: 233.18
I0901 23:54:20.481154 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.49
INFO:tensorflow:Starting iteration 29

Steps executed: 266 Episode length: 87 Return: -417.39872516519256443
INFO:tensorflow:Average training steps per second: 233.13
I0901 23:54:29.044777 140183943698432 replay_runner.py:36] Average training steps per second: 233.13

Done fixed training!Episode length: 87 Return: -417.39872516519256443