Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 11:27:10.892715 139657297655808 run_experiment.py:549] Creating TrainRunner ...
I0902 11:27:10.924244 139657297655808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:10.924754 139657297655808 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:10.925002 139657297655808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:10.925150 139657297655808 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:10.925669 139657297655808 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:10.926440 139657297655808 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:10.926815 139657297655808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:10.927628 139657297655808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:10.928223 139657297655808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:10.928765 139657297655808 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:10.929437 139657297655808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:10.929988 139657297655808 dqn_agent.py:283] 	 seed: 1630582030923605
I0902 11:27:10.934467 139657297655808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:10.934734 139657297655808 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:27:10.934928 139657297655808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:10.935255 139657297655808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:10.935410 139657297655808 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:10.935545 139657297655808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:10.935689 139657297655808 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:10.935814 139657297655808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:10.936046 139657297655808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:11.171502 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:11.617342 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:11.635505 139657297655808 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:27:11.646288 139657297655808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:11.646527 139657297655808 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:11.646726 139657297655808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:11.646938 139657297655808 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:11.647133 139657297655808 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:11.647258 139657297655808 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:11.647376 139657297655808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:11.647567 139657297655808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:11.647720 139657297655808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:11.647877 139657297655808 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:11.648025 139657297655808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:11.648183 139657297655808 dqn_agent.py:283] 	 seed: 1630582031646234
I0902 11:27:11.650655 139657297655808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:11.650808 139657297655808 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:27:11.650926 139657297655808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:11.651077 139657297655808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:11.651231 139657297655808 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:11.651392 139657297655808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:11.651497 139657297655808 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:11.651608 139657297655808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:11.651722 139657297655808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:11.694429 139657297655808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:11.713662 139657297655808 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:27:11.713865 139657297655808 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 126.42
I0902 11:27:19.624320 139657297655808 replay_runner.py:36] Average training steps per second: 126.42
Steps executed: 201 Episode length: 53 Return: 53.0
I0902 11:27:20.944758 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 67.00
INFO:tensorflow:Starting iteration 1

Steps executed: 340 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 202.97
I0902 11:27:26.059533 139657297655808 replay_runner.py:36] Average training steps per second: 202.97
I0902 11:27:26.274678 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.73
I0902 11:27:31.617290 139657297655808 replay_runner.py:36] Average training steps per second: 193.73
I0902 11:27:31.769742 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 11:27:31.950278 139657297655808 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.54
I0902 11:27:37.144398 139657297655808 replay_runner.py:36] Average training steps per second: 192.54
I0902 11:27:37.290575 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 11:27:37.485856 139657297655808 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 192.92

Steps executed: 286 Episode length: 146 Return: 146.0
I0902 11:27:42.874141 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.00
I0902 11:27:48.283407 139657297655808 replay_runner.py:36] Average training steps per second: 192.00
I0902 11:27:48.429686 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 11:27:48.628506 139657297655808 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 189.48
I0902 11:27:53.906833 139657297655808 replay_runner.py:36] Average training steps per second: 189.48
I0902 11:27:54.047170 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 11:27:54.250105 139657297655808 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.51
I0902 11:27:59.499552 139657297655808 replay_runner.py:36] Average training steps per second: 190.51
I0902 11:27:59.641825 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 314 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 192.62
I0902 11:28:05.013953 139657297655808 replay_runner.py:36] Average training steps per second: 192.62
I0902 11:28:05.235510 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 9

Steps executed: 99 Episode length: 99 Return: 99.09.0
INFO:tensorflow:Average training steps per second: 187.89
I0902 11:28:10.756547 139657297655808 replay_runner.py:36] Average training steps per second: 187.89

Steps executed: 295 Episode length: 96 Return: 96.0.0
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.53
I0902 11:28:16.206718 139657297655808 replay_runner.py:36] Average training steps per second: 198.53
I0902 11:28:16.351159 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 242 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 189.68
I0902 11:28:21.821701 139657297655808 replay_runner.py:36] Average training steps per second: 189.68
I0902 11:28:21.990655 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.00
INFO:tensorflow:Starting iteration 12

Steps executed: 221 Episode length: 113 Return: 113.0
INFO:tensorflow:Average training steps per second: 197.64
I0902 11:28:27.243100 139657297655808 replay_runner.py:36] Average training steps per second: 197.64
I0902 11:28:27.401448 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.50
INFO:tensorflow:Starting iteration 13

Steps executed: 183 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 190.07
I0902 11:28:32.858417 139657297655808 replay_runner.py:36] Average training steps per second: 190.07

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 14

Steps executed: 155 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 195.69
I0902 11:28:38.422604 139657297655808 replay_runner.py:36] Average training steps per second: 195.69

Steps executed: 306 Episode length: 151 Return: 151.0
INFO:tensorflow:Starting iteration 15

Steps executed: 328 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 188.65
I0902 11:28:44.137740 139657297655808 replay_runner.py:36] Average training steps per second: 188.65
I0902 11:28:44.365731 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 16

Steps executed: 345 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 195.81
I0902 11:28:49.670286 139657297655808 replay_runner.py:36] Average training steps per second: 195.81
I0902 11:28:49.907955 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 17
I0902 11:28:50.103431 139657297655808 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 190.52

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 11:28:55.493485 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 11:28:55.686297 139657297655808 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 200.88
I0902 11:29:00.664785 139657297655808 replay_runner.py:36] Average training steps per second: 200.88
I0902 11:29:00.801732 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 290 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 191.86
I0902 11:29:06.207337 139657297655808 replay_runner.py:36] Average training steps per second: 191.86
I0902 11:29:06.426217 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 20

Steps executed: 338 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 192.94
I0902 11:29:11.808206 139657297655808 replay_runner.py:36] Average training steps per second: 192.94
I0902 11:29:12.041406 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.36
I0902 11:29:17.538627 139657297655808 replay_runner.py:36] Average training steps per second: 188.36
I0902 11:29:17.690281 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 11:29:17.887541 139657297655808 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.25
I0902 11:29:23.010354 139657297655808 replay_runner.py:36] Average training steps per second: 195.25
I0902 11:29:23.151122 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 226 Episode length: 106 Return: 106.0
INFO:tensorflow:Average training steps per second: 188.51
I0902 11:29:28.648446 139657297655808 replay_runner.py:36] Average training steps per second: 188.51
I0902 11:29:28.812916 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.00
INFO:tensorflow:Starting iteration 24

Steps executed: 264 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 194.12
I0902 11:29:34.163112 139657297655808 replay_runner.py:36] Average training steps per second: 194.12
I0902 11:29:34.345821 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 25

Steps executed: 275 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 189.51
I0902 11:29:39.812882 139657297655808 replay_runner.py:36] Average training steps per second: 189.51
I0902 11:29:40.016980 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.84
I0902 11:29:45.402300 139657297655808 replay_runner.py:36] Average training steps per second: 192.84
I0902 11:29:45.548458 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 11:29:45.719967 139657297655808 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 188.63
I0902 11:29:51.021743 139657297655808 replay_runner.py:36] Average training steps per second: 188.63
I0902 11:29:51.163936 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 11:29:51.357568 139657297655808 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 197.00
I0902 11:29:56.434010 139657297655808 replay_runner.py:36] Average training steps per second: 197.00
I0902 11:29:56.575120 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.88
I0902 11:30:01.778295 139657297655808 replay_runner.py:36] Average training steps per second: 199.88
I0902 11:30:01.908041 139657297655808 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00