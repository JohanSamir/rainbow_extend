Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 18:00:23.758659 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:23.769351 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:23.769688 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:23.769878 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:23.770041 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:23.770206 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:23.770348 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:23.770502 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:23.770728 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:23.770824 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:23.771018 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:23.771160 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:23.771334 140016423897088 dqn_agent.py:283] 	 seed: 1630605623769238
I0902 18:00:23.774507 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:23.774754 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:23.774931 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:23.775036 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:23.775129 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:23.775223 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:23.775340 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:23.775467 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:23.775573 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:23.813644 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:24.180088 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:24.194262 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:24.202985 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:24.203195 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:24.203370 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:24.203584 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:24.203699 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:24.203785 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:24.203911 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:24.204125 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:24.204264 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:24.204373 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:24.204453 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:24.204566 140016423897088 dqn_agent.py:283] 	 seed: 1630605624202939
I0902 18:00:24.207187 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:24.207378 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:24.207481 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:24.207578 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:24.207654 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:24.207748 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:24.207866 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:24.207960 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:24.208052 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:24.236294 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:24.295534 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:24.295805 140016423897088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.71
I0902 18:00:30.294602 140016423897088 replay_runner.py:36] Average training steps per second: 166.71
Steps executed: 205 Episode length: 205 Return: -577.7390878209176
I0902 18:00:31.510306 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -577.74
INFO:tensorflow:Starting iteration 1

Steps executed: 240 Episode length: 131 Return: -378.3761114671823
INFO:tensorflow:Average training steps per second: 225.09
I0902 18:00:40.244608 140016423897088 replay_runner.py:36] Average training steps per second: 225.09
I0902 18:00:40.459649 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.02
INFO:tensorflow:Starting iteration 2

Steps executed: 142 Episode length: 142 Return: -139.98774700539653
INFO:tensorflow:Average training steps per second: 215.38
I0902 18:00:49.204853 140016423897088 replay_runner.py:36] Average training steps per second: 215.38

Steps executed: 242 Episode length: 100 Return: -155.72469135738274
INFO:tensorflow:Starting iteration 3

Steps executed: 258 Episode length: 139 Return: -305.42283736742723
INFO:tensorflow:Average training steps per second: 218.06
I0902 18:00:58.272743 140016423897088 replay_runner.py:36] Average training steps per second: 218.06
I0902 18:00:58.503931 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.67
INFO:tensorflow:Starting iteration 4

Steps executed: 100 Episode length: 100 Return: -500.20728230496473
INFO:tensorflow:Average training steps per second: 221.28

Steps executed: 222 Episode length: 122 Return: -159.05111809532573
I0902 18:01:07.565934 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.63
INFO:tensorflow:Starting iteration 5

Steps executed: 231 Episode length: 231 Return: -438.78916504740843
INFO:tensorflow:Average training steps per second: 217.35
I0902 18:01:16.595176 140016423897088 replay_runner.py:36] Average training steps per second: 217.35
I0902 18:01:16.842715 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.79
INFO:tensorflow:Starting iteration 6

Steps executed: 345 Episode length: 228 Return: -164.10447875127293
INFO:tensorflow:Average training steps per second: 217.32
I0902 18:01:25.806046 140016423897088 replay_runner.py:36] Average training steps per second: 217.32
I0902 18:01:26.141331 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.05
INFO:tensorflow:Starting iteration 7

Steps executed: 208 Episode length: 107 Return: -204.92995884350665
INFO:tensorflow:Average training steps per second: 220.88
I0902 18:01:35.026359 140016423897088 replay_runner.py:36] Average training steps per second: 220.88
I0902 18:01:35.219416 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.15
INFO:tensorflow:Starting iteration 8

Steps executed: 352 Episode length: 156 Return: -263.73246435197475
INFO:tensorflow:Average training steps per second: 212.24
I0902 18:01:44.363995 140016423897088 replay_runner.py:36] Average training steps per second: 212.24
I0902 18:01:44.688755 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.63
INFO:tensorflow:Starting iteration 9

Steps executed: 144 Episode length: 144 Return: -449.21611060889336
INFO:tensorflow:Average training steps per second: 219.66

Steps executed: 411 Episode length: 267 Return: -316.28176839232316
I0902 18:01:53.978347 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.75
INFO:tensorflow:Starting iteration 10

Steps executed: 259 Episode length: 95 Return: -249.536710235427286
INFO:tensorflow:Average training steps per second: 234.84
I0902 18:02:02.499719 140016423897088 replay_runner.py:36] Average training steps per second: 234.84
I0902 18:02:02.726914 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.91
INFO:tensorflow:Starting iteration 11

Steps executed: 341 Episode length: 235 Return: -78.908484381561567
INFO:tensorflow:Average training steps per second: 224.53
I0902 18:02:11.307903 140016423897088 replay_runner.py:36] Average training steps per second: 224.53
I0902 18:02:11.632113 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.54
INFO:tensorflow:Starting iteration 12

Steps executed: 327 Episode length: 157 Return: -609.39558464336817
INFO:tensorflow:Average training steps per second: 220.16
I0902 18:02:20.457118 140016423897088 replay_runner.py:36] Average training steps per second: 220.16
I0902 18:02:20.753641 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -577.34
INFO:tensorflow:Starting iteration 13

Steps executed: 230 Episode length: 127 Return: -93.300151139822327
INFO:tensorflow:Average training steps per second: 224.61
I0902 18:02:29.363779 140016423897088 replay_runner.py:36] Average training steps per second: 224.61
I0902 18:02:29.572979 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.83
INFO:tensorflow:Starting iteration 14

Steps executed: 254 Episode length: 129 Return: -566.26646826838717
INFO:tensorflow:Average training steps per second: 214.80
I0902 18:02:38.572872 140016423897088 replay_runner.py:36] Average training steps per second: 214.80
I0902 18:02:38.802481 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.84
INFO:tensorflow:Starting iteration 15

Steps executed: 354 Episode length: 199 Return: -37.753889238924397
INFO:tensorflow:Average training steps per second: 228.11
I0902 18:02:47.545419 140016423897088 replay_runner.py:36] Average training steps per second: 228.11
I0902 18:02:47.889899 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.31
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 90 Return: -634.754811971212727
INFO:tensorflow:Average training steps per second: 227.41
I0902 18:02:56.432368 140016423897088 replay_runner.py:36] Average training steps per second: 227.41
I0902 18:02:56.641424 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.71
INFO:tensorflow:Starting iteration 17

Steps executed: 238 Episode length: 123 Return: -453.05334339210814
INFO:tensorflow:Average training steps per second: 225.08
I0902 18:03:05.347764 140016423897088 replay_runner.py:36] Average training steps per second: 225.08
I0902 18:03:05.557075 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.10
INFO:tensorflow:Starting iteration 18

Steps executed: 281 Episode length: 176 Return: -142.86027851383008
INFO:tensorflow:Average training steps per second: 224.23
I0902 18:03:14.355184 140016423897088 replay_runner.py:36] Average training steps per second: 224.23
I0902 18:03:14.623143 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.26
INFO:tensorflow:Starting iteration 19

Steps executed: 324 Episode length: 161 Return: -72.195421386776948
INFO:tensorflow:Average training steps per second: 222.26
I0902 18:03:23.373596 140016423897088 replay_runner.py:36] Average training steps per second: 222.26
I0902 18:03:23.680138 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.26
INFO:tensorflow:Starting iteration 20

Steps executed: 309 Episode length: 134 Return: -385.41579014177814
INFO:tensorflow:Average training steps per second: 219.09
I0902 18:03:32.533059 140016423897088 replay_runner.py:36] Average training steps per second: 219.09
I0902 18:03:32.861016 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.07
INFO:tensorflow:Starting iteration 21

Steps executed: 255 Episode length: 140 Return: -382.93851989918454
INFO:tensorflow:Average training steps per second: 218.43
I0902 18:03:41.775044 140016423897088 replay_runner.py:36] Average training steps per second: 218.43
I0902 18:03:42.020396 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.79
INFO:tensorflow:Starting iteration 22

Steps executed: 210 Episode length: 125 Return: -57.562420212389074
INFO:tensorflow:Average training steps per second: 223.40
I0902 18:03:50.783869 140016423897088 replay_runner.py:36] Average training steps per second: 223.40
I0902 18:03:50.970486 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.86
INFO:tensorflow:Starting iteration 23

Steps executed: 276 Episode length: 173 Return: -31.309669520517417
INFO:tensorflow:Average training steps per second: 224.10
I0902 18:03:59.810770 140016423897088 replay_runner.py:36] Average training steps per second: 224.10
I0902 18:04:00.055994 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.43
INFO:tensorflow:Starting iteration 24

Steps executed: 256 Episode length: 127 Return: -340.83856826438927
INFO:tensorflow:Average training steps per second: 219.24
I0902 18:04:08.972134 140016423897088 replay_runner.py:36] Average training steps per second: 219.24
I0902 18:04:09.211272 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.45
INFO:tensorflow:Starting iteration 25

Steps executed: 347 Episode length: 188 Return: -2.4140864043559134
INFO:tensorflow:Average training steps per second: 221.24
I0902 18:04:17.929828 140016423897088 replay_runner.py:36] Average training steps per second: 221.24
I0902 18:04:18.282879 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -30.47
INFO:tensorflow:Starting iteration 26

Steps executed: 249 Episode length: 75 Return: -582.951232066524534
INFO:tensorflow:Average training steps per second: 216.41
I0902 18:04:27.071198 140016423897088 replay_runner.py:36] Average training steps per second: 216.41
I0902 18:04:27.293994 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -554.56
INFO:tensorflow:Starting iteration 27

Steps executed: 247 Episode length: 125 Return: -189.77474414818295
INFO:tensorflow:Average training steps per second: 218.21
I0902 18:04:36.183152 140016423897088 replay_runner.py:36] Average training steps per second: 218.21
I0902 18:04:36.400256 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.95
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 147 Return: -311.21999105247266
INFO:tensorflow:Average training steps per second: 224.05
I0902 18:04:45.159508 140016423897088 replay_runner.py:36] Average training steps per second: 224.05
I0902 18:04:45.377859 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.58
INFO:tensorflow:Starting iteration 29

Steps executed: 220 Episode length: 118 Return: -407.50740807679586
INFO:tensorflow:Average training steps per second: 223.34
I0902 18:04:54.151963 140016423897088 replay_runner.py:36] Average training steps per second: 223.34

Done fixed training!Episode length: 118 Return: -407.50740807679586