Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 12:22:15.964954 139847227246592 run_experiment.py:549] Creating TrainRunner ...
I0901 12:22:15.974664 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:15.974929 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:15.975536 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:15.975726 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:15.975847 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:15.975977 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:15.976097 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:15.976207 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:15.976293 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:15.976376 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:15.976530 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:15.976638 139847227246592 dqn_agent.py:283] 	 seed: 1630498935974594
I0901 12:22:15.979962 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:15.980198 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:22:15.980349 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:15.980473 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:15.980594 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:15.980718 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:15.980812 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:15.980980 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:15.981237 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:16.194902 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:16.650847 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:16.666038 139847227246592 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:22:16.674159 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:16.674420 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:16.674794 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:16.675258 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:16.675404 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:16.675552 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:16.675684 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:16.675940 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:16.676158 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:16.676300 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:16.676389 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:16.676465 139847227246592 dqn_agent.py:283] 	 seed: 1630498936674056
I0901 12:22:16.678991 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:16.679122 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:22:16.679209 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:16.679272 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:16.679331 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:16.679410 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:16.679476 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:16.679598 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:16.679706 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:16.715309 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:16.736069 139847227246592 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:22:16.736395 139847227246592 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 131.84
I0901 12:22:24.321647 139847227246592 replay_runner.py:36] Average training steps per second: 131.84
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:22:25.844077 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:22:26.085287 139847227246592 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 186.62
I0901 12:22:31.444149 139847227246592 replay_runner.py:36] Average training steps per second: 186.62
I0901 12:22:31.906566 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:22:32.152418 139847227246592 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.26
I0901 12:22:37.436666 139847227246592 replay_runner.py:36] Average training steps per second: 189.26
I0901 12:22:37.855015 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 210 Episode length: 210 Return: -209.0
INFO:tensorflow:Average training steps per second: 183.53
I0901 12:22:43.543500 139847227246592 replay_runner.py:36] Average training steps per second: 183.53
I0901 12:22:43.738732 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.80
I0901 12:22:49.088325 139847227246592 replay_runner.py:36] Average training steps per second: 195.80
I0901 12:22:49.495964 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:22:49.738281 139847227246592 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 187.79
I0901 12:22:55.063792 139847227246592 replay_runner.py:36] Average training steps per second: 187.79
I0901 12:22:55.498239 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:22:55.736536 139847227246592 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 194.78
I0901 12:23:00.870945 139847227246592 replay_runner.py:36] Average training steps per second: 194.78
I0901 12:23:01.311213 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:23:01.556515 139847227246592 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 188.07
I0901 12:23:06.874425 139847227246592 replay_runner.py:36] Average training steps per second: 188.07
I0901 12:23:07.328793 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:23:07.583951 139847227246592 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 194.53
I0901 12:23:12.725023 139847227246592 replay_runner.py:36] Average training steps per second: 194.53
I0901 12:23:13.168339 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 255 Episode length: 255 Return: -254.0
INFO:tensorflow:Average training steps per second: 188.12
I0901 12:23:18.740452 139847227246592 replay_runner.py:36] Average training steps per second: 188.12
I0901 12:23:18.961125 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.40
I0901 12:23:24.440160 139847227246592 replay_runner.py:36] Average training steps per second: 191.40
I0901 12:23:24.878951 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:23:25.127620 139847227246592 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 185.96
I0901 12:23:30.505791 139847227246592 replay_runner.py:36] Average training steps per second: 185.96
I0901 12:23:30.937875 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 599 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.20
I0901 12:23:36.480024 139847227246592 replay_runner.py:36] Average training steps per second: 189.20
I0901 12:23:37.037170 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.00
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.08
I0901 12:23:42.578461 139847227246592 replay_runner.py:36] Average training steps per second: 189.08
I0901 12:23:43.013127 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 477 Episode length: 477 Return: -476.0
INFO:tensorflow:Average training steps per second: 188.63
I0901 12:23:48.548640 139847227246592 replay_runner.py:36] Average training steps per second: 188.63
I0901 12:23:48.957099 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -476.00
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.33
I0901 12:23:54.425509 139847227246592 replay_runner.py:36] Average training steps per second: 191.33
I0901 12:23:54.898348 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 414 Episode length: 414 Return: -413.0
INFO:tensorflow:Average training steps per second: 193.98
I0901 12:24:00.310675 139847227246592 replay_runner.py:36] Average training steps per second: 193.98
I0901 12:24:00.726732 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.00
INFO:tensorflow:Starting iteration 17

Steps executed: 335 Episode length: 141 Return: -140.0
INFO:tensorflow:Average training steps per second: 186.95
I0901 12:24:06.327839 139847227246592 replay_runner.py:36] Average training steps per second: 186.95
I0901 12:24:06.650970 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.67
INFO:tensorflow:Starting iteration 18
I0901 12:24:06.898600 139847227246592 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.22

Steps executed: 232 Episode length: 104 Return: -103.0
I0901 12:24:12.223141 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 19

Steps executed: 263 Episode length: 199 Return: -198.0
INFO:tensorflow:Average training steps per second: 189.82
I0901 12:24:17.737416 139847227246592 replay_runner.py:36] Average training steps per second: 189.82
I0901 12:24:17.984322 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 20

Steps executed: 213 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 188.75
I0901 12:24:23.537403 139847227246592 replay_runner.py:36] Average training steps per second: 188.75
I0901 12:24:23.733042 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.24
I0901 12:24:29.240031 139847227246592 replay_runner.py:36] Average training steps per second: 190.24
I0901 12:24:29.690999 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 12:24:29.942460 139847227246592 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.69
I0901 12:24:35.159755 139847227246592 replay_runner.py:36] Average training steps per second: 191.69
I0901 12:24:35.596229 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 12:24:35.840954 139847227246592 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 188.88
I0901 12:24:41.135862 139847227246592 replay_runner.py:36] Average training steps per second: 188.88
I0901 12:24:41.566353 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 12:24:41.814476 139847227246592 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 202.84
I0901 12:24:46.745090 139847227246592 replay_runner.py:36] Average training steps per second: 202.84
I0901 12:24:47.141119 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 268 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 191.12
I0901 12:24:52.601745 139847227246592 replay_runner.py:36] Average training steps per second: 191.12
I0901 12:24:52.814681 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.00
I0901 12:24:58.017827 139847227246592 replay_runner.py:36] Average training steps per second: 201.00
I0901 12:24:58.450518 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 83 Return: -82.000
INFO:tensorflow:Average training steps per second: 199.12
I0901 12:25:03.711906 139847227246592 replay_runner.py:36] Average training steps per second: 199.12
I0901 12:25:03.907521 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 28

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.42
I0901 12:25:09.204092 139847227246592 replay_runner.py:36] Average training steps per second: 197.42
I0901 12:25:09.605975 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.17
I0901 12:25:14.897424 139847227246592 replay_runner.py:36] Average training steps per second: 198.17
I0901 12:25:15.281206 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00