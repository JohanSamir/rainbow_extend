Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
I0910 11:17:29.027392 140316400793600 run_experiment.py:549] Creating TrainRunner ...
I0910 11:17:29.040999 140316400793600 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:17:29.041238 140316400793600 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:17:29.041383 140316400793600 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:17:29.041487 140316400793600 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:17:29.041579 140316400793600 dqn_agent.py:275] 	 update_period: 4
I0910 11:17:29.041672 140316400793600 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:17:29.041764 140316400793600 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:17:29.041848 140316400793600 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:17:29.041934 140316400793600 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:17:29.042016 140316400793600 dqn_agent.py:280] 	 optimizer: adam
I0910 11:17:29.042098 140316400793600 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:17:29.042182 140316400793600 dqn_agent.py:283] 	 seed: 1631272649040936
I0910 11:17:29.045001 140316400793600 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:17:29.045189 140316400793600 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:17:29.045319 140316400793600 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:17:29.045424 140316400793600 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:17:29.045518 140316400793600 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:17:29.045610 140316400793600 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:17:29.045715 140316400793600 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:17:29.045808 140316400793600 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:17:29.045907 140316400793600 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:17:30.363001 140316400793600 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:17:30.383709 140316400793600 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:17:30.383879 140316400793600 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:17:30.383962 140316400793600 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:17:30.384027 140316400793600 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:17:30.384119 140316400793600 dqn_agent.py:275] 	 update_period: 4
I0910 11:17:30.384211 140316400793600 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:17:30.384264 140316400793600 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:17:30.384409 140316400793600 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:17:30.384484 140316400793600 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:17:30.384663 140316400793600 dqn_agent.py:280] 	 optimizer: adam
I0910 11:17:30.384773 140316400793600 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:17:30.384837 140316400793600 dqn_agent.py:283] 	 seed: 1631272650383660
I0910 11:17:30.386497 140316400793600 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:17:30.386629 140316400793600 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:17:30.386713 140316400793600 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:17:30.386793 140316400793600 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:17:30.386855 140316400793600 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:17:30.386937 140316400793600 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:17:30.387026 140316400793600 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:17:30.387100 140316400793600 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:17:30.387176 140316400793600 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:17:30.409906 140316400793600 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:17:30.425174 140316400793600 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:17:30.425499 140316400793600 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 796185.27
I0910 11:17:30.426954 140316400793600 replay_runner.py:39] Average training steps per second: 796185.27
Steps executed: 364 Episode length: 183 Return: -183.0
I0910 11:17:31.356814 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:17:31.407051 140316400793600 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 434013.25
I0910 11:17:31.409714 140316400793600 replay_runner.py:39] Average training steps per second: 434013.25
I0910 11:17:31.603941 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.50
INFO:tensorflow:Starting iteration 2
I0910 11:17:31.635810 140316400793600 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 779320.70
I0910 11:17:31.637335 140316400793600 replay_runner.py:39] Average training steps per second: 779320.70
I0910 11:17:31.999924 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:17:32.050440 140316400793600 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 492578.27
I0910 11:17:32.052857 140316400793600 replay_runner.py:39] Average training steps per second: 492578.27
I0910 11:17:32.325580 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:17:32.359186 140316400793600 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 699400.37
I0910 11:17:32.360903 140316400793600 replay_runner.py:39] Average training steps per second: 699400.37
I0910 11:17:32.507121 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 5
I0910 11:17:32.539655 140316400793600 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 754099.96

Steps executed: 115 Episode length: 115 Return: -115.0
I0910 11:17:32.814013 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 6
I0910 11:17:32.849346 140316400793600 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 737136.03
I0910 11:17:32.851018 140316400793600 replay_runner.py:39] Average training steps per second: 737136.03
I0910 11:17:32.930894 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 7
I0910 11:17:32.962283 140316400793600 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 818400.78
I0910 11:17:32.963842 140316400793600 replay_runner.py:39] Average training steps per second: 818400.78
I0910 11:17:33.118933 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.00
INFO:tensorflow:Starting iteration 8
I0910 11:17:33.151848 140316400793600 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 802123.54
I0910 11:17:33.153332 140316400793600 replay_runner.py:39] Average training steps per second: 802123.54
I0910 11:17:33.280772 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 9
I0910 11:17:33.320100 140316400793600 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 825325.46
I0910 11:17:33.321595 140316400793600 replay_runner.py:39] Average training steps per second: 825325.46
I0910 11:17:33.445698 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.50
INFO:tensorflow:Starting iteration 10
I0910 11:17:33.479004 140316400793600 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 746583.13
I0910 11:17:33.480603 140316400793600 replay_runner.py:39] Average training steps per second: 746583.13
I0910 11:17:33.751820 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 11
I0910 11:17:33.787920 140316400793600 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 792874.10
I0910 11:17:33.789441 140316400793600 replay_runner.py:39] Average training steps per second: 792874.10
I0910 11:17:33.911457 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.50
INFO:tensorflow:Starting iteration 12
I0910 11:17:33.944712 140316400793600 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 784128.62
I0910 11:17:33.946249 140316400793600 replay_runner.py:39] Average training steps per second: 784128.62
I0910 11:17:34.090734 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.00
INFO:tensorflow:Starting iteration 13
I0910 11:17:34.124104 140316400793600 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 752476.50
I0910 11:17:34.125673 140316400793600 replay_runner.py:39] Average training steps per second: 752476.50
I0910 11:17:34.320506 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:17:34.361155 140316400793600 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 606113.29

Steps executed: 199 Episode length: 199 Return: -199.0
I0910 11:17:34.628249 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 15
I0910 11:17:34.661453 140316400793600 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 834189.34
I0910 11:17:34.662901 140316400793600 replay_runner.py:39] Average training steps per second: 834189.34
I0910 11:17:34.880074 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:17:34.912350 140316400793600 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 803660.47
I0910 11:17:34.913834 140316400793600 replay_runner.py:39] Average training steps per second: 803660.47
I0910 11:17:35.159149 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:17:35.196090 140316400793600 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 486973.64
I0910 11:17:35.198514 140316400793600 replay_runner.py:39] Average training steps per second: 486973.64
I0910 11:17:35.454062 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.50
INFO:tensorflow:Starting iteration 18
I0910 11:17:35.486874 140316400793600 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 562918.27
I0910 11:17:35.488910 140316400793600 replay_runner.py:39] Average training steps per second: 562918.27
I0910 11:17:35.733984 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 19
I0910 11:17:35.766331 140316400793600 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 762600.73
I0910 11:17:35.767855 140316400793600 replay_runner.py:39] Average training steps per second: 762600.73
I0910 11:17:36.052673 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.00
INFO:tensorflow:Starting iteration 20
I0910 11:17:36.084729 140316400793600 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 792874.10
I0910 11:17:36.086235 140316400793600 replay_runner.py:39] Average training steps per second: 792874.10
I0910 11:17:36.295346 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:17:36.326763 140316400793600 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 766362.87
I0910 11:17:36.328300 140316400793600 replay_runner.py:39] Average training steps per second: 766362.87
I0910 11:17:36.433053 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.00
INFO:tensorflow:Starting iteration 22
I0910 11:17:36.464076 140316400793600 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 786481.16
I0910 11:17:36.465576 140316400793600 replay_runner.py:39] Average training steps per second: 786481.16
I0910 11:17:36.565010 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 23
I0910 11:17:36.596059 140316400793600 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 774714.44
I0910 11:17:36.597589 140316400793600 replay_runner.py:39] Average training steps per second: 774714.44
I0910 11:17:36.782688 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:17:36.817904 140316400793600 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 792874.10
I0910 11:17:36.819415 140316400793600 replay_runner.py:39] Average training steps per second: 792874.10
I0910 11:17:36.909075 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 25
I0910 11:17:36.940498 140316400793600 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 817922.00
I0910 11:17:36.941942 140316400793600 replay_runner.py:39] Average training steps per second: 817922.00
I0910 11:17:36.999294 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.00
INFO:tensorflow:Starting iteration 26
I0910 11:17:37.032395 140316400793600 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 760802.47
I0910 11:17:37.033940 140316400793600 replay_runner.py:39] Average training steps per second: 760802.47
I0910 11:17:37.236774 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:17:37.268333 140316400793600 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 799371.83
I0910 11:17:37.269826 140316400793600 replay_runner.py:39] Average training steps per second: 799371.83
I0910 11:17:37.339139 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.00
INFO:tensorflow:Starting iteration 28
I0910 11:17:37.371440 140316400793600 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 794074.97
I0910 11:17:37.372957 140316400793600 replay_runner.py:39] Average training steps per second: 794074.97
I0910 11:17:37.484481 140316400793600 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 29
I0910 11:17:37.516631 140316400793600 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 802276.97
I0910 11:17:37.518140 140316400793600 replay_runner.py:39] Average training steps per second: 802276.97

Done fixed training!Episode length: 118 Return: -118.0