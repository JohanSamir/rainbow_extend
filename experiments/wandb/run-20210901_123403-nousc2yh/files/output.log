Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0901 12:34:10.145233 139809619294208 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:10.154631 139809619294208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:10.154888 139809619294208 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:10.155033 139809619294208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:10.155483 139809619294208 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:10.155672 139809619294208 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:10.155846 139809619294208 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:10.156017 139809619294208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:10.156156 139809619294208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:10.156260 139809619294208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:10.156330 139809619294208 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:10.156398 139809619294208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:10.156518 139809619294208 dqn_agent.py:283] 	 seed: 1630499650154574
I0901 12:34:10.159710 139809619294208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:10.159940 139809619294208 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:34:10.160129 139809619294208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:10.160240 139809619294208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:10.160320 139809619294208 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:10.160590 139809619294208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:10.160761 139809619294208 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:10.160865 139809619294208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:10.160972 139809619294208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:10.203674 139809619294208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:10.764278 139809619294208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:10.778800 139809619294208 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:10.789615 139809619294208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:10.789818 139809619294208 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:10.789929 139809619294208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:10.790184 139809619294208 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:10.790289 139809619294208 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:10.790425 139809619294208 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:10.790591 139809619294208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:10.790685 139809619294208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:10.790764 139809619294208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:10.791109 139809619294208 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:10.791276 139809619294208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:10.791373 139809619294208 dqn_agent.py:283] 	 seed: 1630499650789564
I0901 12:34:10.793749 139809619294208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:10.793912 139809619294208 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:34:10.794006 139809619294208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:10.794142 139809619294208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:10.794294 139809619294208 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:10.794378 139809619294208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:10.794486 139809619294208 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:10.794570 139809619294208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:10.794652 139809619294208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:10.834498 139809619294208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:10.858675 139809619294208 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:10.858980 139809619294208 replay_runner.py:41] Starting iteration 0
Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 136.97
I0901 12:34:18.160052 139809619294208 replay_runner.py:36] Average training steps per second: 136.97
I0901 12:34:19.389749 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 187.47
I0901 12:34:24.920064 139809619294208 replay_runner.py:36] Average training steps per second: 187.47
I0901 12:34:25.081247 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 2

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 190.97
I0901 12:34:30.518740 139809619294208 replay_runner.py:36] Average training steps per second: 190.97
I0901 12:34:30.667234 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 3

Steps executed: 133 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 202.55

Steps executed: 207 Episode length: 9 Return: 9.0.0
I0901 12:34:35.956545 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 185.79
I0901 12:34:41.514174 139809619294208 replay_runner.py:36] Average training steps per second: 185.79
I0901 12:34:41.659074 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.68
I0901 12:34:46.982319 139809619294208 replay_runner.py:36] Average training steps per second: 194.68
I0901 12:34:47.135155 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 6

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 192.99
I0901 12:34:52.506468 139809619294208 replay_runner.py:36] Average training steps per second: 192.99
I0901 12:34:52.653265 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 7

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 183.54
I0901 12:34:58.282274 139809619294208 replay_runner.py:36] Average training steps per second: 183.54
I0901 12:34:58.440945 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 8

Steps executed: 219 Episode length: 33 Return: 33.0
INFO:tensorflow:Average training steps per second: 194.62
I0901 12:35:03.762454 139809619294208 replay_runner.py:36] Average training steps per second: 194.62
I0901 12:35:03.925379 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 31.29
INFO:tensorflow:Starting iteration 9

Steps executed: 240 Episode length: 43 Return: 43.0
INFO:tensorflow:Average training steps per second: 188.99
I0901 12:35:09.409974 139809619294208 replay_runner.py:36] Average training steps per second: 188.99
I0901 12:35:09.595586 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 40.00
INFO:tensorflow:Starting iteration 10

Steps executed: 223 Episode length: 83 Return: 83.0
INFO:tensorflow:Average training steps per second: 185.11
I0901 12:35:15.199398 139809619294208 replay_runner.py:36] Average training steps per second: 185.11
I0901 12:35:15.377918 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.33
INFO:tensorflow:Starting iteration 11

Steps executed: 209 Episode length: 70 Return: 70.0
INFO:tensorflow:Average training steps per second: 185.73
I0901 12:35:20.964985 139809619294208 replay_runner.py:36] Average training steps per second: 185.73
I0901 12:35:21.121909 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.67
INFO:tensorflow:Starting iteration 12

Steps executed: 342 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 181.27
I0901 12:35:26.839663 139809619294208 replay_runner.py:36] Average training steps per second: 181.27
I0901 12:35:27.092041 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 13

Steps executed: 243 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 187.89
I0901 12:35:32.619885 139809619294208 replay_runner.py:36] Average training steps per second: 187.89
I0901 12:35:32.803988 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 81.00
INFO:tensorflow:Starting iteration 14
I0901 12:35:33.009624 139809619294208 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 184.19

Steps executed: 241 Episode length: 92 Return: 92.0.0
I0901 12:35:38.616316 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.50
INFO:tensorflow:Starting iteration 15

Steps executed: 226 Episode length: 42 Return: 42.0.0
INFO:tensorflow:Average training steps per second: 181.99
I0901 12:35:44.302947 139809619294208 replay_runner.py:36] Average training steps per second: 181.99
I0901 12:35:44.483630 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.20
INFO:tensorflow:Starting iteration 16

Steps executed: 240 Episode length: 61 Return: 61.0.0
INFO:tensorflow:Average training steps per second: 184.21
I0901 12:35:50.113033 139809619294208 replay_runner.py:36] Average training steps per second: 184.21
I0901 12:35:50.292414 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 60.00
INFO:tensorflow:Starting iteration 17

Steps executed: 72 Episode length: 39 Return: 39.00.0
INFO:tensorflow:Average training steps per second: 181.24

Steps executed: 216 Episode length: 37 Return: 37.0.0
I0901 12:35:56.178954 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 36.00
INFO:tensorflow:Starting iteration 18

Steps executed: 227 Episode length: 39 Return: 39.0.0
INFO:tensorflow:Average training steps per second: 187.29
I0901 12:36:01.717665 139809619294208 replay_runner.py:36] Average training steps per second: 187.29
I0901 12:36:01.896528 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 37.83
INFO:tensorflow:Starting iteration 19

Steps executed: 220 Episode length: 37 Return: 37.0.0
INFO:tensorflow:Average training steps per second: 183.06
I0901 12:36:07.546478 139809619294208 replay_runner.py:36] Average training steps per second: 183.06
I0901 12:36:07.714988 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 36.67
INFO:tensorflow:Starting iteration 20

Steps executed: 211 Episode length: 44 Return: 44.0.0
INFO:tensorflow:Average training steps per second: 188.06
I0901 12:36:13.227217 139809619294208 replay_runner.py:36] Average training steps per second: 188.06
I0901 12:36:13.406515 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 42.20
INFO:tensorflow:Starting iteration 21

Steps executed: 207 Episode length: 28 Return: 28.0.0
INFO:tensorflow:Average training steps per second: 189.20
I0901 12:36:18.882033 139809619294208 replay_runner.py:36] Average training steps per second: 189.20
I0901 12:36:19.028819 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.88
INFO:tensorflow:Starting iteration 22

Steps executed: 213 Episode length: 42 Return: 42.0.0
INFO:tensorflow:Average training steps per second: 186.60
I0901 12:36:24.578810 139809619294208 replay_runner.py:36] Average training steps per second: 186.60
I0901 12:36:24.739083 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 35.50
INFO:tensorflow:Starting iteration 23

Steps executed: 36 Episode length: 36 Return: 36.00.0
INFO:tensorflow:Average training steps per second: 185.68

Steps executed: 230 Episode length: 32 Return: 32.0.0
I0901 12:36:30.506262 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 32.86
INFO:tensorflow:Starting iteration 24

Steps executed: 207 Episode length: 45 Return: 45.0.0
INFO:tensorflow:Average training steps per second: 184.45
I0901 12:36:36.130073 139809619294208 replay_runner.py:36] Average training steps per second: 184.45
I0901 12:36:36.281233 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 41.40
INFO:tensorflow:Starting iteration 25

Steps executed: 224 Episode length: 41 Return: 41.0.0
INFO:tensorflow:Average training steps per second: 187.35
I0901 12:36:41.819810 139809619294208 replay_runner.py:36] Average training steps per second: 187.35
I0901 12:36:42.008870 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 44.80
INFO:tensorflow:Starting iteration 26

Steps executed: 206 Episode length: 35 Return: 35.0.0
INFO:tensorflow:Average training steps per second: 186.71
I0901 12:36:47.550855 139809619294208 replay_runner.py:36] Average training steps per second: 186.71
I0901 12:36:47.709764 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 34.33
INFO:tensorflow:Starting iteration 27

Steps executed: 224 Episode length: 61 Return: 61.0.0
INFO:tensorflow:Average training steps per second: 186.48
I0901 12:36:53.266407 139809619294208 replay_runner.py:36] Average training steps per second: 186.48
I0901 12:36:53.455211 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 56.00
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 48 Return: 48.0.0
INFO:tensorflow:Average training steps per second: 192.80
I0901 12:36:58.844305 139809619294208 replay_runner.py:36] Average training steps per second: 192.80
I0901 12:36:59.004132 139809619294208 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.40
INFO:tensorflow:Starting iteration 29

Steps executed: 221 Episode length: 50 Return: 50.0.0
INFO:tensorflow:Average training steps per second: 194.88
I0901 12:37:04.320405 139809619294208 replay_runner.py:36] Average training steps per second: 194.88

Done fixed training!Episode length: 50 Return: 50.0.0