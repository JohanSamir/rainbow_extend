Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0901 23:53:00.831766 140437416843264 run_experiment.py:549] Creating TrainRunner ...
I0901 23:53:00.840580 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:53:00.840772 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:53:00.840849 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:53:00.840911 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:53:00.840967 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:53:00.841055 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:53:00.841156 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:53:00.841220 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:53:00.841276 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:53:00.841343 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:53:00.841453 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:53:00.841547 140437416843264 dqn_agent.py:283] 	 seed: 1630540380840534
I0901 23:53:00.844752 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:53:00.844946 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:53:00.845067 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:53:00.845138 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:53:00.845196 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:53:00.845283 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:53:00.845405 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:53:00.845477 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:53:00.845547 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:53:00.881263 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:01.367718 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:01.383793 140437416843264 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:53:01.393328 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:53:01.393491 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:53:01.393567 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:53:01.393630 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:53:01.393717 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:53:01.393801 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:53:01.393918 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:53:01.393998 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:53:01.394067 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:53:01.394168 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:53:01.394245 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:53:01.394311 140437416843264 dqn_agent.py:283] 	 seed: 1630540381393284
I0901 23:53:01.396948 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:53:01.397167 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:53:01.397328 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:53:01.397469 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:53:01.397603 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:53:01.397734 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:53:01.397839 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:53:01.398053 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:53:01.398251 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:53:01.439021 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:53:01.466979 140437416843264 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:53:01.467282 140437416843264 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.59
I0901 23:53:08.197520 140437416843264 replay_runner.py:36] Average training steps per second: 148.59
Steps executed: 203 Episode length: 10 Return: 10.0
I0901 23:53:09.430580 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.50
INFO:tensorflow:Starting iteration 1

Steps executed: 326 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 197.90
I0901 23:53:14.665138 140437416843264 replay_runner.py:36] Average training steps per second: 197.90
I0901 23:53:14.906420 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.23
I0901 23:53:20.256263 140437416843264 replay_runner.py:36] Average training steps per second: 194.23
I0901 23:53:20.384350 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0901 23:53:20.566979 140437416843264 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 195.57
I0901 23:53:25.680595 140437416843264 replay_runner.py:36] Average training steps per second: 195.57
I0901 23:53:25.846360 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.50
INFO:tensorflow:Starting iteration 4


Steps executed: 372 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 200.68
I0901 23:53:31.027424 140437416843264 replay_runner.py:36] Average training steps per second: 200.68
I0901 23:53:31.269902 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 5

Steps executed: 192 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 199.44
I0901 23:53:36.473126 140437416843264 replay_runner.py:36] Average training steps per second: 199.44

Steps executed: 359 Episode length: 167 Return: 167.0
INFO:tensorflow:Starting iteration 6

Steps executed: 357 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 214.02
I0901 23:53:41.610284 140437416843264 replay_runner.py:36] Average training steps per second: 214.02
I0901 23:53:41.822630 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.50
INFO:tensorflow:Starting iteration 7
I0901 23:53:42.007370 140437416843264 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 206.07
I0901 23:53:46.860417 140437416843264 replay_runner.py:36] Average training steps per second: 206.07
I0901 23:53:47.063568 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 8


Steps executed: 268 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 204.06
I0901 23:53:52.366834 140437416843264 replay_runner.py:36] Average training steps per second: 204.06
I0901 23:53:52.546508 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 9
I0901 23:53:52.731907 140437416843264 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 203.34
I0901 23:53:57.650394 140437416843264 replay_runner.py:36] Average training steps per second: 203.34
I0901 23:53:57.833683 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 10

Steps executed: 277 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 202.66

Steps executed: 264 Episode length: 126 Return: 126.0
I0901 23:54:03.123289 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.79
I0901 23:54:08.320837 140437416843264 replay_runner.py:36] Average training steps per second: 199.79
I0901 23:54:08.458564 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 250 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 198.60
I0901 23:54:13.682492 140437416843264 replay_runner.py:36] Average training steps per second: 198.60
I0901 23:54:13.840612 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.00
INFO:tensorflow:Starting iteration 13

Steps executed: 253 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 204.87
I0901 23:54:18.913501 140437416843264 replay_runner.py:36] Average training steps per second: 204.87
I0901 23:54:19.078433 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.96
I0901 23:54:24.351471 140437416843264 replay_runner.py:36] Average training steps per second: 195.96
I0901 23:54:24.485409 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 23:54:24.667452 140437416843264 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 199.49
I0901 23:54:29.680764 140437416843264 replay_runner.py:36] Average training steps per second: 199.49
I0901 23:54:29.818269 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:54:30.003448 140437416843264 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.57
I0901 23:54:35.065317 140437416843264 replay_runner.py:36] Average training steps per second: 197.57
I0901 23:54:35.222309 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:54:35.414277 140437416843264 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 204.52
I0901 23:54:40.304275 140437416843264 replay_runner.py:36] Average training steps per second: 204.52
I0901 23:54:40.442536 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:54:40.635451 140437416843264 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.98
I0901 23:54:45.790981 140437416843264 replay_runner.py:36] Average training steps per second: 193.98
I0901 23:54:45.909879 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:54:46.093219 140437416843264 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 210.70
I0901 23:54:50.839706 140437416843264 replay_runner.py:36] Average training steps per second: 210.70
I0901 23:54:50.976246 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:54:51.169774 140437416843264 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.23
I0901 23:54:56.454764 140437416843264 replay_runner.py:36] Average training steps per second: 189.23
I0901 23:54:56.582259 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:54:56.765769 140437416843264 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 200.22
I0901 23:55:01.760729 140437416843264 replay_runner.py:36] Average training steps per second: 200.22
I0901 23:55:01.898807 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:55:02.095199 140437416843264 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.82
I0901 23:55:07.255105 140437416843264 replay_runner.py:36] Average training steps per second: 193.82
I0901 23:55:07.387874 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:55:07.573825 140437416843264 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 199.52
I0901 23:55:12.586245 140437416843264 replay_runner.py:36] Average training steps per second: 199.52
I0901 23:55:12.728734 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:55:12.920638 140437416843264 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 193.35
I0901 23:55:18.093157 140437416843264 replay_runner.py:36] Average training steps per second: 193.35
I0901 23:55:18.230026 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:55:18.406886 140437416843264 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.07
I0901 23:55:23.507481 140437416843264 replay_runner.py:36] Average training steps per second: 196.07
I0901 23:55:23.661534 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:55:23.859418 140437416843264 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.23
I0901 23:55:28.955947 140437416843264 replay_runner.py:36] Average training steps per second: 196.23
I0901 23:55:29.087688 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:55:29.274004 140437416843264 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.89
I0901 23:55:34.513121 140437416843264 replay_runner.py:36] Average training steps per second: 190.89
I0901 23:55:34.670220 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:55:34.879033 140437416843264 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.93
I0901 23:55:39.957352 140437416843264 replay_runner.py:36] Average training steps per second: 196.93
I0901 23:55:40.092535 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 23:55:40.268299 140437416843264 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 195.47

Done fixed training!Episode length: 200 Return: 200.0
I0901 23:55:45.528701 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00