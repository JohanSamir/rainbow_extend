Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 23:34:02.513218 139633860089856 run_experiment.py:549] Creating TrainRunner ...
I0902 23:34:02.522956 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:02.523233 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:02.523426 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:02.523668 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:02.523806 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:02.523934 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:02.524057 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:02.524201 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:02.524362 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:02.524516 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:02.524712 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:02.524839 139633860089856 dqn_agent.py:283] 	 seed: 1630625642522887
I0902 23:34:02.528378 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:02.528612 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:02.528781 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:02.528921 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:02.529055 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:02.529185 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:02.529310 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:02.529430 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:02.529556 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:02.573271 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:03.125437 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:03.141722 139633860089856 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:34:03.151770 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:03.151943 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:03.152018 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:03.152082 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:03.152152 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:03.152300 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:03.152435 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:03.152509 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:03.152612 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:03.152714 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:03.152819 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:03.152962 139633860089856 dqn_agent.py:283] 	 seed: 1630625643151729
I0902 23:34:03.156404 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:03.156772 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:03.157041 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:03.157331 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:03.157561 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:03.157806 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:03.157957 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:03.158281 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:03.158427 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:03.194675 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:03.222902 139633860089856 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:34:03.223261 139633860089856 replay_runner.py:41] Starting iteration 0
Steps executed: 282 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 140.96
I0902 23:34:10.317746 139633860089856 replay_runner.py:36] Average training steps per second: 140.96
I0902 23:34:11.553441 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.69
I0902 23:34:16.910287 139633860089856 replay_runner.py:36] Average training steps per second: 193.69
I0902 23:34:17.050048 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2

Steps executed: 327 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 198.47
I0902 23:34:22.263857 139633860089856 replay_runner.py:36] Average training steps per second: 198.47
I0902 23:34:22.494518 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.63
I0902 23:34:27.643790 139633860089856 replay_runner.py:36] Average training steps per second: 201.63
I0902 23:34:27.772627 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 302 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 198.18
I0902 23:34:32.996320 139633860089856 replay_runner.py:36] Average training steps per second: 198.18
I0902 23:34:33.183785 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 5
I0902 23:34:33.426499 139633860089856 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 202.35

Steps executed: 279 Episode length: 130 Return: 130.0
I0902 23:34:38.540066 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.74
I0902 23:34:43.738268 139633860089856 replay_runner.py:36] Average training steps per second: 199.74
I0902 23:34:43.871429 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 258 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 197.25
I0902 23:34:49.118298 139633860089856 replay_runner.py:36] Average training steps per second: 197.25
I0902 23:34:49.290631 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.00
INFO:tensorflow:Starting iteration 8
I0902 23:34:49.480493 139633860089856 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 194.51

Steps executed: 292 Episode length: 132 Return: 132.0
I0902 23:34:54.822899 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 9

Steps executed: 336 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 194.32
I0902 23:35:00.160754 139633860089856 replay_runner.py:36] Average training steps per second: 194.32
I0902 23:35:00.386509 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 10

Steps executed: 341 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 198.48
I0902 23:35:05.603191 139633860089856 replay_runner.py:36] Average training steps per second: 198.48
I0902 23:35:05.829303 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.49
I0902 23:35:10.950530 139633860089856 replay_runner.py:36] Average training steps per second: 202.49
I0902 23:35:11.081738 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12
I0902 23:35:11.263606 139633860089856 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.37
I0902 23:35:16.382470 139633860089856 replay_runner.py:36] Average training steps per second: 195.37
I0902 23:35:16.501260 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0902 23:35:16.679507 139633860089856 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 203.52
I0902 23:35:21.593466 139633860089856 replay_runner.py:36] Average training steps per second: 203.52
I0902 23:35:21.736609 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0902 23:35:21.933956 139633860089856 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.17
I0902 23:35:27.111974 139633860089856 replay_runner.py:36] Average training steps per second: 193.17
I0902 23:35:27.228696 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0902 23:35:27.412070 139633860089856 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.51
I0902 23:35:32.580217 139633860089856 replay_runner.py:36] Average training steps per second: 193.51
I0902 23:35:32.712718 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:35:32.892300 139633860089856 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 194.22
I0902 23:35:38.041599 139633860089856 replay_runner.py:36] Average training steps per second: 194.22
I0902 23:35:38.176790 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:35:38.366019 139633860089856 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 191.98
I0902 23:35:43.575402 139633860089856 replay_runner.py:36] Average training steps per second: 191.98
I0902 23:35:43.717746 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:35:43.912286 139633860089856 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 192.11
I0902 23:35:49.117847 139633860089856 replay_runner.py:36] Average training steps per second: 192.11
I0902 23:35:49.270055 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 379 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.19
I0902 23:35:54.820415 139633860089856 replay_runner.py:36] Average training steps per second: 186.19
I0902 23:35:55.099056 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.64
I0902 23:36:00.469501 139633860089856 replay_runner.py:36] Average training steps per second: 192.64
I0902 23:36:00.604682 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:36:00.783119 139633860089856 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 194.21
I0902 23:36:05.932781 139633860089856 replay_runner.py:36] Average training steps per second: 194.21
I0902 23:36:06.075683 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:36:06.276493 139633860089856 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.02
I0902 23:36:11.457833 139633860089856 replay_runner.py:36] Average training steps per second: 193.02
I0902 23:36:11.595412 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:36:11.792953 139633860089856 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.90
I0902 23:36:16.977381 139633860089856 replay_runner.py:36] Average training steps per second: 192.90
I0902 23:36:17.119733 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:36:17.315186 139633860089856 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 195.54
I0902 23:36:22.429559 139633860089856 replay_runner.py:36] Average training steps per second: 195.54
I0902 23:36:22.564599 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:36:22.757117 139633860089856 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.48
I0902 23:36:27.926316 139633860089856 replay_runner.py:36] Average training steps per second: 193.48
I0902 23:36:28.061126 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:36:28.243288 139633860089856 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.87
I0902 23:36:33.247014 139633860089856 replay_runner.py:36] Average training steps per second: 199.87
I0902 23:36:33.400795 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:36:33.586415 139633860089856 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.52
I0902 23:36:38.754388 139633860089856 replay_runner.py:36] Average training steps per second: 193.52
I0902 23:36:38.896450 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:36:39.095749 139633860089856 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 198.90
I0902 23:36:44.124083 139633860089856 replay_runner.py:36] Average training steps per second: 198.90
I0902 23:36:44.256921 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.54
I0902 23:36:49.556149 139633860089856 replay_runner.py:36] Average training steps per second: 195.54
I0902 23:36:49.686017 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00