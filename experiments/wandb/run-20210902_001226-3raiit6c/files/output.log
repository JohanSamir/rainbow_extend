Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 00:12:32.749410 140490221283328 run_experiment.py:549] Creating TrainRunner ...
I0902 00:12:32.766414 140490221283328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:12:32.766698 140490221283328 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:12:32.767018 140490221283328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:12:32.767231 140490221283328 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:12:32.767544 140490221283328 dqn_agent.py:275] 	 update_period: 4
I0902 00:12:32.767752 140490221283328 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:12:32.767914 140490221283328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:12:32.768051 140490221283328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:12:32.768199 140490221283328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:12:32.768406 140490221283328 dqn_agent.py:280] 	 optimizer: adam
I0902 00:12:32.768636 140490221283328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:12:32.768792 140490221283328 dqn_agent.py:283] 	 seed: 1630541552766339
I0902 00:12:32.773688 140490221283328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:12:32.774039 140490221283328 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:12:32.774458 140490221283328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:12:32.774631 140490221283328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:12:32.774874 140490221283328 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:12:32.775017 140490221283328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:12:32.775157 140490221283328 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:12:32.775279 140490221283328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:12:32.775445 140490221283328 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:12:32.828573 140490221283328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:33.343253 140490221283328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:33.360044 140490221283328 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:12:33.376534 140490221283328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:12:33.376853 140490221283328 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:12:33.377216 140490221283328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:12:33.377389 140490221283328 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:12:33.377528 140490221283328 dqn_agent.py:275] 	 update_period: 4
I0902 00:12:33.377871 140490221283328 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:12:33.378067 140490221283328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:12:33.378279 140490221283328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:12:33.378449 140490221283328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:12:33.378563 140490221283328 dqn_agent.py:280] 	 optimizer: adam
I0902 00:12:33.378670 140490221283328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:12:33.378771 140490221283328 dqn_agent.py:283] 	 seed: 1630541553376473
I0902 00:12:33.381835 140490221283328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:12:33.382031 140490221283328 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:12:33.382255 140490221283328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:12:33.382394 140490221283328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:12:33.382508 140490221283328 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:12:33.382620 140490221283328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:12:33.382731 140490221283328 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:12:33.382947 140490221283328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:12:33.383070 140490221283328 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:12:33.423385 140490221283328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:33.453322 140490221283328 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:12:33.453852 140490221283328 replay_runner.py:41] Starting iteration 0
Steps executed: 157 Episode length: 157 Return: -156.0
INFO:tensorflow:Average training steps per second: 132.44

Steps executed: 295 Episode length: 138 Return: -137.0
I0902 00:12:42.425218 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.50
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.94
I0902 00:12:47.937682 140490221283328 replay_runner.py:36] Average training steps per second: 189.94
I0902 00:12:48.357714 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 251 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 190.43
I0902 00:12:53.859156 140490221283328 replay_runner.py:36] Average training steps per second: 190.43
I0902 00:12:54.078859 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 3

Steps executed: 273 Episode length: 273 Return: -272.0
INFO:tensorflow:Average training steps per second: 186.27
I0902 00:12:59.697538 140490221283328 replay_runner.py:36] Average training steps per second: 186.27
I0902 00:12:59.933312 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.51
I0902 00:13:05.321279 140490221283328 replay_runner.py:36] Average training steps per second: 194.51
I0902 00:13:05.748089 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 00:13:05.990508 140490221283328 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 194.16
I0902 00:13:11.141893 140490221283328 replay_runner.py:36] Average training steps per second: 194.16
I0902 00:13:11.544242 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 320 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 191.48
I0902 00:13:17.004847 140490221283328 replay_runner.py:36] Average training steps per second: 191.48
I0902 00:13:17.264907 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.00
INFO:tensorflow:Starting iteration 7

Steps executed: 102 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 193.44

Steps executed: 219 Episode length: 117 Return: -116.0
I0902 00:13:22.829994 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 8

Steps executed: 425 Episode length: 425 Return: -424.0
INFO:tensorflow:Average training steps per second: 187.11
I0902 00:13:28.420794 140490221283328 replay_runner.py:36] Average training steps per second: 187.11
I0902 00:13:28.777080 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.00
INFO:tensorflow:Starting iteration 9

Steps executed: 658 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.42
I0902 00:13:34.187739 140490221283328 replay_runner.py:36] Average training steps per second: 193.42
I0902 00:13:34.724961 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.50
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.54
I0902 00:13:40.041267 140490221283328 replay_runner.py:36] Average training steps per second: 197.54
I0902 00:13:40.436064 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 217 Episode length: 66 Return: -65.0.0
INFO:tensorflow:Average training steps per second: 189.82
I0902 00:13:46.017423 140490221283328 replay_runner.py:36] Average training steps per second: 189.82
I0902 00:13:46.207332 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 12

Steps executed: 255 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 192.02
I0902 00:13:51.663830 140490221283328 replay_runner.py:36] Average training steps per second: 192.02
I0902 00:13:51.879028 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 13

Steps executed: 251 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 189.03
I0902 00:13:57.411245 140490221283328 replay_runner.py:36] Average training steps per second: 189.03
I0902 00:13:57.630456 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.33
I0902 00:14:03.048186 140490221283328 replay_runner.py:36] Average training steps per second: 193.33
I0902 00:14:03.489764 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 210 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 193.42
I0902 00:14:08.976100 140490221283328 replay_runner.py:36] Average training steps per second: 193.42
I0902 00:14:09.175084 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.00
INFO:tensorflow:Starting iteration 16

Steps executed: 248 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 196.55
I0902 00:14:14.519937 140490221283328 replay_runner.py:36] Average training steps per second: 196.55
I0902 00:14:14.739682 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 17

Steps executed: 243 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 190.36
I0902 00:14:20.247589 140490221283328 replay_runner.py:36] Average training steps per second: 190.36
I0902 00:14:20.465834 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 18

Steps executed: 236 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 191.01
I0902 00:14:25.943847 140490221283328 replay_runner.py:36] Average training steps per second: 191.01
I0902 00:14:26.152538 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 191.89
I0902 00:14:31.614707 140490221283328 replay_runner.py:36] Average training steps per second: 191.89
I0902 00:14:31.823540 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 20

Steps executed: 255 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 189.24
I0902 00:14:37.343241 140490221283328 replay_runner.py:36] Average training steps per second: 189.24
I0902 00:14:37.566416 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 21
I0902 00:14:37.807655 140490221283328 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.94
I0902 00:14:42.885794 140490221283328 replay_runner.py:36] Average training steps per second: 196.94

Steps executed: 254 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Starting iteration 22

Steps executed: 262 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 195.61
I0902 00:14:48.456678 140490221283328 replay_runner.py:36] Average training steps per second: 195.61
I0902 00:14:48.666043 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 23

Steps executed: 218 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 199.84
I0902 00:14:53.902460 140490221283328 replay_runner.py:36] Average training steps per second: 199.84
I0902 00:14:54.081919 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 24
I0902 00:14:54.316814 140490221283328 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 208.05

Steps executed: 374 Episode length: 289 Return: -288.0
I0902 00:14:59.390561 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.00
INFO:tensorflow:Starting iteration 25

Steps executed: 402 Episode length: 244 Return: -243.0
INFO:tensorflow:Average training steps per second: 206.70
I0902 00:15:04.453974 140490221283328 replay_runner.py:36] Average training steps per second: 206.70
I0902 00:15:04.750928 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 26

Steps executed: 263 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 205.61
I0902 00:15:09.843941 140490221283328 replay_runner.py:36] Average training steps per second: 205.61
I0902 00:15:10.038471 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 27
I0902 00:15:10.252325 140490221283328 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.19

Steps executed: 232 Episode length: 119 Return: -118.0
I0902 00:15:15.551521 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 28

Steps executed: 248 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 203.23
I0902 00:15:20.694944 140490221283328 replay_runner.py:36] Average training steps per second: 203.23
I0902 00:15:20.899671 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 202.44
I0902 00:15:26.071084 140490221283328 replay_runner.py:36] Average training steps per second: 202.44
I0902 00:15:26.350679 140490221283328 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67