Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0903 00:19:52.718822 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0903 00:19:52.726573 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:52.726701 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:52.726781 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:52.726844 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:52.726899 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:52.726971 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:52.727027 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:52.727112 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:52.727164 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:52.727220 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:52.727297 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:52.727376 140006414895104 dqn_agent.py:283] 	 seed: 1630628392726544
I0903 00:19:52.729140 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:52.729262 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:52.729341 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:52.729405 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:52.729463 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:52.729536 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:52.729599 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:52.729685 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:52.729740 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:52.754681 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:53.024266 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:53.034261 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:19:53.041689 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:53.041841 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:53.041927 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:53.041999 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:53.042061 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:53.042126 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:53.042207 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:53.042303 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:53.042366 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:53.042452 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:53.042524 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:53.042587 140006414895104 dqn_agent.py:283] 	 seed: 1630628393041656
I0903 00:19:53.044233 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:53.044374 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:53.044464 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:53.044554 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:53.044618 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:53.044683 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:53.044779 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:53.044914 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:53.044990 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:53.066743 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:53.082880 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:19:53.083151 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 216.92
I0903 00:19:57.693260 140006414895104 replay_runner.py:36] Average training steps per second: 216.92
I0903 00:19:58.563505 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.65
Steps executed: 335 Episode length: 175 Return: -313.5544584206894
INFO:tensorflow:Starting iteration 1

Steps executed: 290 Episode length: 201 Return: -203.56275963380816
INFO:tensorflow:Average training steps per second: 326.07
I0903 00:20:04.956050 140006414895104 replay_runner.py:36] Average training steps per second: 326.07
I0903 00:20:05.164871 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.40
INFO:tensorflow:Starting iteration 2

Steps executed: 282 Episode length: 95 Return: -356.797027435611546
INFO:tensorflow:Average training steps per second: 323.31
I0903 00:20:11.670208 140006414895104 replay_runner.py:36] Average training steps per second: 323.31
I0903 00:20:11.831742 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.02
INFO:tensorflow:Starting iteration 3
I0903 00:20:15.269416 140006414895104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 328.13
I0903 00:20:18.317335 140006414895104 replay_runner.py:36] Average training steps per second: 328.13


Steps executed: 241 Episode length: 55 Return: -441.579856265078746
INFO:tensorflow:Starting iteration 4

Steps executed: 225 Episode length: 78 Return: -784.341142953096746
INFO:tensorflow:Average training steps per second: 331.25
I0903 00:20:24.935122 140006414895104 replay_runner.py:36] Average training steps per second: 331.25
I0903 00:20:25.063920 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -711.97
INFO:tensorflow:Starting iteration 5

Steps executed: 204 Episode length: 61 Return: -587.626002314574576
INFO:tensorflow:Average training steps per second: 329.28
I0903 00:20:31.562254 140006414895104 replay_runner.py:36] Average training steps per second: 329.28
I0903 00:20:31.660941 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.16
INFO:tensorflow:Starting iteration 6

Steps executed: 289 Episode length: 105 Return: -556.07586621995426
INFO:tensorflow:Average training steps per second: 307.56
I0903 00:20:38.391455 140006414895104 replay_runner.py:36] Average training steps per second: 307.56
I0903 00:20:38.576213 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -588.11
INFO:tensorflow:Starting iteration 7

Steps executed: 238 Episode length: 93 Return: -637.258773724306326
INFO:tensorflow:Average training steps per second: 325.32
I0903 00:20:45.145580 140006414895104 replay_runner.py:36] Average training steps per second: 325.32
I0903 00:20:45.292403 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.76
INFO:tensorflow:Starting iteration 8

Steps executed: 269 Episode length: 74 Return: -294.397010572495856
INFO:tensorflow:Average training steps per second: 323.94
I0903 00:20:51.851182 140006414895104 replay_runner.py:36] Average training steps per second: 323.94
I0903 00:20:52.004391 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.73
INFO:tensorflow:Starting iteration 9
I0903 00:20:55.459735 140006414895104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 326.33

Steps executed: 442 Episode length: 442 Return: -1337.9237031413713
I0903 00:20:59.102403 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -1337.92
INFO:tensorflow:Starting iteration 10

Steps executed: 245 Episode length: 51 Return: -341.501095954971253
INFO:tensorflow:Average training steps per second: 324.34
I0903 00:21:05.623263 140006414895104 replay_runner.py:36] Average training steps per second: 324.34
I0903 00:21:05.767012 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -511.48
INFO:tensorflow:Starting iteration 11

Steps executed: 230 Episode length: 83 Return: -295.818893226290363
INFO:tensorflow:Average training steps per second: 325.02
I0903 00:21:12.305131 140006414895104 replay_runner.py:36] Average training steps per second: 325.02
I0903 00:21:12.445843 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.26
INFO:tensorflow:Starting iteration 12

Steps executed: 285 Episode length: 146 Return: -348.07514325800683
INFO:tensorflow:Average training steps per second: 323.00
I0903 00:21:18.981698 140006414895104 replay_runner.py:36] Average training steps per second: 323.00
I0903 00:21:19.144019 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.58
INFO:tensorflow:Starting iteration 13

Steps executed: 211 Episode length: 54 Return: -220.924348378547933
INFO:tensorflow:Average training steps per second: 323.42
I0903 00:21:25.702361 140006414895104 replay_runner.py:36] Average training steps per second: 323.42
I0903 00:21:25.834233 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.48
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 64 Return: -615.079812721189133
INFO:tensorflow:Average training steps per second: 323.74
I0903 00:21:32.371052 140006414895104 replay_runner.py:36] Average training steps per second: 323.74
I0903 00:21:32.492351 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -607.87
INFO:tensorflow:Starting iteration 15

Steps executed: 237 Episode length: 80 Return: -119.258677099801837
INFO:tensorflow:Average training steps per second: 326.43
I0903 00:21:38.999261 140006414895104 replay_runner.py:36] Average training steps per second: 326.43
I0903 00:21:39.160999 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.37
INFO:tensorflow:Starting iteration 16

Steps executed: 215 Episode length: 64 Return: -548.252690960679437
INFO:tensorflow:Average training steps per second: 317.89
I0903 00:21:45.754326 140006414895104 replay_runner.py:36] Average training steps per second: 317.89
I0903 00:21:45.893570 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -504.83
INFO:tensorflow:Starting iteration 17

Steps executed: 206 Episode length: 113 Return: -667.03386275213317
INFO:tensorflow:Average training steps per second: 326.43
I0903 00:21:52.383168 140006414895104 replay_runner.py:36] Average training steps per second: 326.43
I0903 00:21:52.509310 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -645.50
INFO:tensorflow:Starting iteration 18

Steps executed: 273 Episode length: 80 Return: -676.284145441663717
INFO:tensorflow:Average training steps per second: 322.92
I0903 00:21:59.052391 140006414895104 replay_runner.py:36] Average training steps per second: 322.92
I0903 00:21:59.225876 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -625.82
INFO:tensorflow:Starting iteration 19

Steps executed: 201 Episode length: 62 Return: -372.298099325026277
INFO:tensorflow:Average training steps per second: 310.32
I0903 00:22:05.905760 140006414895104 replay_runner.py:36] Average training steps per second: 310.32
I0903 00:22:06.028217 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.39
INFO:tensorflow:Starting iteration 20

Steps executed: 246 Episode length: 72 Return: -325.554878097438257
INFO:tensorflow:Average training steps per second: 325.12
I0903 00:22:12.542437 140006414895104 replay_runner.py:36] Average training steps per second: 325.12
I0903 00:22:12.696830 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.83
INFO:tensorflow:Starting iteration 21

Steps executed: 244 Episode length: 54 Return: -312.108155137289777
INFO:tensorflow:Average training steps per second: 332.34
I0903 00:22:19.155730 140006414895104 replay_runner.py:36] Average training steps per second: 332.34
I0903 00:22:19.301014 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.70
INFO:tensorflow:Starting iteration 22

Steps executed: 257 Episode length: 85 Return: -216.815164172415127
INFO:tensorflow:Average training steps per second: 329.10
I0903 00:22:25.780026 140006414895104 replay_runner.py:36] Average training steps per second: 329.10
I0903 00:22:25.917303 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.68
INFO:tensorflow:Starting iteration 23

Steps executed: 243 Episode length: 66 Return: -522.596388593460537
INFO:tensorflow:Average training steps per second: 340.45
I0903 00:22:32.230086 140006414895104 replay_runner.py:36] Average training steps per second: 340.45
I0903 00:22:32.370257 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.83
INFO:tensorflow:Starting iteration 24

Steps executed: 203 Episode length: 64 Return: -504.217631320072237
INFO:tensorflow:Average training steps per second: 341.83
I0903 00:22:38.608621 140006414895104 replay_runner.py:36] Average training steps per second: 341.83
I0903 00:22:38.728037 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.36
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 79 Return: -557.154947798415337
INFO:tensorflow:Average training steps per second: 332.99
I0903 00:22:44.940541 140006414895104 replay_runner.py:36] Average training steps per second: 332.99
I0903 00:22:45.069334 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -573.35
INFO:tensorflow:Starting iteration 26

Steps executed: 208 Episode length: 51 Return: -333.479836945221737
INFO:tensorflow:Average training steps per second: 352.52
I0903 00:22:50.913691 140006414895104 replay_runner.py:36] Average training steps per second: 352.52
I0903 00:22:51.034715 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -556.36
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 92 Return: -642.882576708668637
INFO:tensorflow:Average training steps per second: 376.00
I0903 00:22:56.696684 140006414895104 replay_runner.py:36] Average training steps per second: 376.00
I0903 00:22:56.826436 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.65
INFO:tensorflow:Starting iteration 28

Steps executed: 214 Episode length: 62 Return: -562.920201221856457
INFO:tensorflow:Average training steps per second: 388.13
I0903 00:23:02.246502 140006414895104 replay_runner.py:36] Average training steps per second: 388.13
I0903 00:23:02.347077 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.11
INFO:tensorflow:Starting iteration 29

Steps executed: 257 Episode length: 78 Return: -120.022888662504817
INFO:tensorflow:Average training steps per second: 384.79
I0903 00:23:07.791470 140006414895104 replay_runner.py:36] Average training steps per second: 384.79

Done fixed training!Episode length: 78 Return: -120.022888662504817