Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0905 18:55:53.149846 139976788297728 run_experiment.py:549] Creating TrainRunner ...
I0905 18:55:53.160140 139976788297728 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:53.160457 139976788297728 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:53.160623 139976788297728 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:53.161088 139976788297728 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:53.161239 139976788297728 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:53.161373 139976788297728 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:53.161511 139976788297728 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:53.161634 139976788297728 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:53.161734 139976788297728 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:53.161807 139976788297728 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:53.161920 139976788297728 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:53.162026 139976788297728 dqn_agent.py:283] 	 seed: 1630868153160065
I0905 18:55:53.165311 139976788297728 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:53.165456 139976788297728 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:53.165544 139976788297728 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:53.165618 139976788297728 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:53.165683 139976788297728 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:53.165784 139976788297728 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:53.165931 139976788297728 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:53.166056 139976788297728 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:53.166157 139976788297728 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:53.216737 139976788297728 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.782710 139976788297728 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.798140 139976788297728 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:55:53.806688 139976788297728 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:53.806954 139976788297728 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:53.807170 139976788297728 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:53.807455 139976788297728 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:53.807759 139976788297728 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:53.807895 139976788297728 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:53.808017 139976788297728 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:53.808160 139976788297728 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:53.808303 139976788297728 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:53.808441 139976788297728 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:53.808535 139976788297728 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:53.808721 139976788297728 dqn_agent.py:283] 	 seed: 1630868153806634
I0905 18:55:53.812004 139976788297728 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:53.812328 139976788297728 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:53.812452 139976788297728 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:53.812540 139976788297728 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:53.812656 139976788297728 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:53.812803 139976788297728 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:53.813069 139976788297728 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:53.813188 139976788297728 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:53.813263 139976788297728 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:53.860550 139976788297728 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.889801 139976788297728 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:55:53.890068 139976788297728 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 119.36
I0905 18:56:02.268567 139976788297728 replay_runner.py:36] Average training steps per second: 119.36
Steps executed: 200 Episode length: 10 Return: 10.0
I0905 18:56:03.761217 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 75 Return: 75.0
INFO:tensorflow:Average training steps per second: 168.53
I0905 18:56:09.883378 139976788297728 replay_runner.py:36] Average training steps per second: 168.53
I0905 18:56:10.117055 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.33
INFO:tensorflow:Starting iteration 2

Steps executed: 146 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 159.42

Steps executed: 294 Episode length: 148 Return: 148.0
I0905 18:56:16.936744 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 3

Steps executed: 257 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 160.94
I0905 18:56:23.345052 139976788297728 replay_runner.py:36] Average training steps per second: 160.94
I0905 18:56:23.648722 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 4

Steps executed: 343 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 174.70
I0905 18:56:29.557608 139976788297728 replay_runner.py:36] Average training steps per second: 174.70
I0905 18:56:30.025282 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 5

Steps executed: 276 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 162.18
I0905 18:56:36.437612 139976788297728 replay_runner.py:36] Average training steps per second: 162.18
I0905 18:56:36.764574 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 6

Steps executed: 203 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 155.49
I0905 18:56:43.430153 139976788297728 replay_runner.py:36] Average training steps per second: 155.49
I0905 18:56:43.735238 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 101.50
INFO:tensorflow:Starting iteration 7

Steps executed: 250 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 157.92
I0905 18:56:50.328209 139976788297728 replay_runner.py:36] Average training steps per second: 157.92
I0905 18:56:50.657326 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.00
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 157.12
I0905 18:56:57.264936 139976788297728 replay_runner.py:36] Average training steps per second: 157.12
I0905 18:56:57.525401 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0905 18:56:57.766575 139976788297728 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 156.93
I0905 18:57:04.139543 139976788297728 replay_runner.py:36] Average training steps per second: 156.93
I0905 18:57:04.389228 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 155.56
I0905 18:57:11.065006 139976788297728 replay_runner.py:36] Average training steps per second: 155.56
I0905 18:57:11.383486 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 11

Steps executed: 288 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 158.78
I0905 18:57:17.928771 139976788297728 replay_runner.py:36] Average training steps per second: 158.78
I0905 18:57:18.332880 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.00
INFO:tensorflow:Starting iteration 12

Steps executed: 117 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 156.88

Steps executed: 237 Episode length: 120 Return: 120.0
I0905 18:57:25.223422 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 13
I0905 18:57:25.429954 139976788297728 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 178.10

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 18:57:31.335616 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 269 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 149.02
I0905 18:57:38.290523 139976788297728 replay_runner.py:36] Average training steps per second: 149.02
I0905 18:57:38.649436 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 154.30
I0905 18:57:45.327952 139976788297728 replay_runner.py:36] Average training steps per second: 154.30
I0905 18:57:45.631279 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 268 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 161.65
I0905 18:57:52.067898 139976788297728 replay_runner.py:36] Average training steps per second: 161.65
I0905 18:57:52.418263 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 166.32
I0905 18:57:58.679677 139976788297728 replay_runner.py:36] Average training steps per second: 166.32
I0905 18:57:58.956121 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 18:57:59.202571 139976788297728 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 153.35
I0905 18:58:05.724125 139976788297728 replay_runner.py:36] Average training steps per second: 153.35
I0905 18:58:05.980004 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 18:58:06.174974 139976788297728 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 162.67
I0905 18:58:12.323149 139976788297728 replay_runner.py:36] Average training steps per second: 162.67
I0905 18:58:12.577459 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 18:58:12.775148 139976788297728 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 159.15
I0905 18:58:19.059058 139976788297728 replay_runner.py:36] Average training steps per second: 159.15
I0905 18:58:19.305564 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 18:58:19.549820 139976788297728 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 157.08
I0905 18:58:25.916511 139976788297728 replay_runner.py:36] Average training steps per second: 157.08
I0905 18:58:26.171135 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 18:58:26.369008 139976788297728 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 161.70
I0905 18:58:32.553710 139976788297728 replay_runner.py:36] Average training steps per second: 161.70
I0905 18:58:32.811589 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 190 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 165.52

Steps executed: 358 Episode length: 168 Return: 168.0
I0905 18:58:39.546081 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 24

Steps executed: 298 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 150.61
I0905 18:58:46.434163 139976788297728 replay_runner.py:36] Average training steps per second: 150.61
I0905 18:58:46.801693 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 149.74
I0905 18:58:53.721937 139976788297728 replay_runner.py:36] Average training steps per second: 149.74
I0905 18:58:54.012732 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 295 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 151.02
I0905 18:59:00.874502 139976788297728 replay_runner.py:36] Average training steps per second: 151.02
I0905 18:59:01.275054 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 162.03
I0905 18:59:07.661128 139976788297728 replay_runner.py:36] Average training steps per second: 162.03
I0905 18:59:07.899154 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 18:59:08.102239 139976788297728 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 164.47
I0905 18:59:14.182806 139976788297728 replay_runner.py:36] Average training steps per second: 164.47
I0905 18:59:14.413393 139976788297728 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 290 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 164.92
I0905 18:59:20.660701 139976788297728 replay_runner.py:36] Average training steps per second: 164.92

Done fixed training!Episode length: 143 Return: 143.0