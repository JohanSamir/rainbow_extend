Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 23:50:35.225460 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0902 23:50:35.237958 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:50:35.238198 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:50:35.238301 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:50:35.238400 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:50:35.238487 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:50:35.238612 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:50:35.238807 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:50:35.238987 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:50:35.239114 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:50:35.239244 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:50:35.239367 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:50:35.239493 139735608805376 dqn_agent.py:283] 	 seed: 1630626635237893
I0902 23:50:35.242852 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:50:35.243106 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:50:35.243288 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:50:35.243395 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:50:35.243474 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:50:35.243548 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:50:35.243627 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:50:35.243850 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:50:35.243947 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:50:35.282015 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:35.670614 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:35.686416 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:50:35.694015 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:50:35.694266 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:50:35.694449 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:50:35.694575 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:50:35.694652 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:50:35.694728 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:50:35.694909 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:50:35.695032 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:50:35.695167 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:50:35.695285 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:50:35.695456 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:50:35.695731 139735608805376 dqn_agent.py:283] 	 seed: 1630626635693961
I0902 23:50:35.698850 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:50:35.699060 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:50:35.699167 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:50:35.699252 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:50:35.699329 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:50:35.699424 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:50:35.699499 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:50:35.699590 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:50:35.699822 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:50:35.775659 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:50:35.797495 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:50:35.797818 139735608805376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 159.02
I0902 23:50:42.086831 139735608805376 replay_runner.py:36] Average training steps per second: 159.02
Steps executed: 339 Episode length: 172 Return: -528.1796501249992
I0902 23:50:43.415053 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.80
INFO:tensorflow:Starting iteration 1
I0902 23:50:47.715254 139735608805376 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 220.36
I0902 23:50:52.253574 139735608805376 replay_runner.py:36] Average training steps per second: 220.36

Steps executed: 256 Episode length: 134 Return: -317.6068899724086
INFO:tensorflow:Starting iteration 2

Steps executed: 221 Episode length: 98 Return: -343.809692056521044
INFO:tensorflow:Average training steps per second: 228.30
I0902 23:51:01.148277 139735608805376 replay_runner.py:36] Average training steps per second: 228.30
I0902 23:51:01.350114 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.11
INFO:tensorflow:Starting iteration 3

Steps executed: 252 Episode length: 112 Return: -554.45765814555634
INFO:tensorflow:Average training steps per second: 218.66
I0902 23:51:10.261506 139735608805376 replay_runner.py:36] Average training steps per second: 218.66
I0902 23:51:10.486786 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -552.23
INFO:tensorflow:Starting iteration 4

Steps executed: 284 Episode length: 284 Return: -647.06260071834114
INFO:tensorflow:Average training steps per second: 224.65
I0902 23:51:19.211858 139735608805376 replay_runner.py:36] Average training steps per second: 224.65
I0902 23:51:19.581928 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -647.06
INFO:tensorflow:Starting iteration 5
I0902 23:51:23.967925 139735608805376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.76

Steps executed: 1000 Episode length: 1000 Return: -83.11842538413242
I0902 23:51:30.970255 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.12
INFO:tensorflow:Starting iteration 6
I0902 23:51:35.217835 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 225.61

Steps executed: 1000 Episode length: 1000 Return: -88.89666542220232
I0902 23:51:42.835426 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.90
INFO:tensorflow:Starting iteration 7

Steps executed: 299 Episode length: 222 Return: -335.375516998872132
INFO:tensorflow:Average training steps per second: 224.59
I0902 23:51:51.676945 139735608805376 replay_runner.py:36] Average training steps per second: 224.59
I0902 23:51:51.950080 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.97
INFO:tensorflow:Starting iteration 8
I0902 23:51:56.270429 139735608805376 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 232.27

Steps executed: 547 Episode length: 547 Return: -339.345470142161842
I0902 23:52:01.572806 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.35
INFO:tensorflow:Starting iteration 9
I0902 23:52:05.934749 139735608805376 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 228.24

Steps executed: 1000 Episode length: 1000 Return: -284.17153835951933
I0902 23:52:12.081079 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.17
INFO:tensorflow:Starting iteration 10
I0902 23:52:16.475055 139735608805376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 225.85

Steps executed: 664 Episode length: 664 Return: -2694.396667095776933
I0902 23:52:22.381723 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -2694.40
INFO:tensorflow:Starting iteration 11
I0902 23:52:26.531721 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 220.67
I0902 23:52:31.064038 139735608805376 replay_runner.py:36] Average training steps per second: 220.67

Steps executed: 1000 Episode length: 1000 Return: -144.11711319696914
INFO:tensorflow:Starting iteration 12
I0902 23:52:39.392700 139735608805376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 225.49

Steps executed: 1000 Episode length: 1000 Return: -141.34449844628233
I0902 23:52:45.997619 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.34
INFO:tensorflow:Starting iteration 13
I0902 23:52:50.266401 139735608805376 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 230.29

Steps executed: 1000 Episode length: 1000 Return: -102.30857594749953
I0902 23:52:58.201973 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.31
INFO:tensorflow:Starting iteration 14

Steps executed: 245 Episode length: 179 Return: -150.1673143593296253
INFO:tensorflow:Average training steps per second: 228.12
I0902 23:53:06.758726 139735608805376 replay_runner.py:36] Average training steps per second: 228.12
I0902 23:53:06.962252 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.81
INFO:tensorflow:Starting iteration 15

Steps executed: 796 Episode length: 639 Return: -708.7799793378069253
INFO:tensorflow:Average training steps per second: 225.63
I0902 23:53:15.570280 139735608805376 replay_runner.py:36] Average training steps per second: 225.63
I0902 23:53:17.281348 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.85
INFO:tensorflow:Starting iteration 16

Steps executed: 298 Episode length: 104 Return: -514.9238460584415753
INFO:tensorflow:Average training steps per second: 221.14
I0902 23:53:26.117346 139735608805376 replay_runner.py:36] Average training steps per second: 221.14
I0902 23:53:26.358787 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.29
INFO:tensorflow:Starting iteration 17

Steps executed: 62 Episode length: 62 Return: -95.3149215352672915753
INFO:tensorflow:Average training steps per second: 217.82

Steps executed: 413 Episode length: 351 Return: -53.69517986878285753
I0902 23:53:35.788939 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.51
INFO:tensorflow:Starting iteration 18

Steps executed: 145 Episode length: 145 Return: -85.43215430000723753
INFO:tensorflow:Average training steps per second: 211.20

Steps executed: 664 Episode length: 519 Return: -71.08905715274912753
I0902 23:53:45.956499 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.26
INFO:tensorflow:Starting iteration 19

Steps executed: 134 Episode length: 134 Return: -747.8675689157425753
INFO:tensorflow:Average training steps per second: 212.00

Steps executed: 456 Episode length: 322 Return: -824.2535559604531753
I0902 23:53:55.640853 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -786.06
INFO:tensorflow:Starting iteration 20

Steps executed: 270 Episode length: 126 Return: -522.3165506526504753
INFO:tensorflow:Average training steps per second: 214.95
I0902 23:54:04.423869 139735608805376 replay_runner.py:36] Average training steps per second: 214.95
I0902 23:54:04.659862 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.55
INFO:tensorflow:Starting iteration 21

Steps executed: 217 Episode length: 217 Return: -510.5256424537028653
INFO:tensorflow:Average training steps per second: 219.00
I0902 23:54:13.317508 139735608805376 replay_runner.py:36] Average training steps per second: 219.00
I0902 23:54:13.588912 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.53
INFO:tensorflow:Starting iteration 22

Steps executed: 202 Episode length: 202 Return: -95.12594361590364653
INFO:tensorflow:Average training steps per second: 219.11
I0902 23:54:22.463103 139735608805376 replay_runner.py:36] Average training steps per second: 219.11
I0902 23:54:22.668981 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.13
INFO:tensorflow:Starting iteration 23
I0902 23:54:27.024290 139735608805376 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 218.72

Steps executed: 302 Episode length: 132 Return: -211.8402061384684353
I0902 23:54:31.883849 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.07
INFO:tensorflow:Starting iteration 24

Steps executed: 389 Episode length: 389 Return: -366.9986716986736353
INFO:tensorflow:Average training steps per second: 223.64
I0902 23:54:40.925707 139735608805376 replay_runner.py:36] Average training steps per second: 223.64
I0902 23:54:41.465240 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.00
INFO:tensorflow:Starting iteration 25

Steps executed: 473 Episode length: 329 Return: -71.54548907117768353
INFO:tensorflow:Average training steps per second: 220.45
I0902 23:54:50.031802 139735608805376 replay_runner.py:36] Average training steps per second: 220.45
I0902 23:54:50.568218 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.44
INFO:tensorflow:Starting iteration 26
I0902 23:54:54.926859 139735608805376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 218.83
I0902 23:54:59.497285 139735608805376 replay_runner.py:36] Average training steps per second: 218.83

Steps executed: 308 Episode length: 119 Return: -398.0452927297059353
INFO:tensorflow:Starting iteration 27

Steps executed: 303 Episode length: 303 Return: -51.83854754147823353
INFO:tensorflow:Average training steps per second: 222.05
I0902 23:55:08.787036 139735608805376 replay_runner.py:36] Average training steps per second: 222.05
I0902 23:55:09.170152 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -51.84
INFO:tensorflow:Starting iteration 28
I0902 23:55:13.467455 139735608805376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 223.10


Steps executed: 1136 Episode length: 1000 Return: 36.1772473694351653
I0902 23:55:21.312111 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.92
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 107 Return: -722.6124404876762653
INFO:tensorflow:Average training steps per second: 223.70
I0902 23:55:30.193422 139735608805376 replay_runner.py:36] Average training steps per second: 223.70

Done fixed training!Episode length: 107 Return: -722.6124404876762653