I0909 13:24:20.073357 140277178812416 run_experiment.py:549] Creating TrainRunner ...
I0909 13:24:20.078841 140277178812416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:20.078940 140277178812416 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:20.078995 140277178812416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:20.079044 140277178812416 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:20.079105 140277178812416 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:20.079150 140277178812416 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:20.079199 140277178812416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:20.079268 140277178812416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:20.079349 140277178812416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:20.079418 140277178812416 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:20.079482 140277178812416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:20.079539 140277178812416 dqn_agent.py:283] 	 seed: 1631193860078815
I0909 13:24:20.081051 140277178812416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:20.081165 140277178812416 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:20.081228 140277178812416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:20.081280 140277178812416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:20.081331 140277178812416 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:20.081400 140277178812416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:20.081447 140277178812416 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:20.081518 140277178812416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:20.081601 140277178812416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:20.106371 140277178812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:20.246485 140277178812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:20.253376 140277178812416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:24:20.258047 140277178812416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:20.258147 140277178812416 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:20.258203 140277178812416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:20.258249 140277178812416 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:20.258296 140277178812416 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:20.258342 140277178812416 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:20.258409 140277178812416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:20.258479 140277178812416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:20.258558 140277178812416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:20.258623 140277178812416 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:20.258681 140277178812416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:20.258745 140277178812416 dqn_agent.py:283] 	 seed: 1631193860258025
I0909 13:24:20.259922 140277178812416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:20.260014 140277178812416 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:20.260079 140277178812416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:20.260131 140277178812416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:20.260179 140277178812416 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:20.260239 140277178812416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:20.260298 140277178812416 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:20.260375 140277178812416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:20.260441 140277178812416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:20.281900 140277178812416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:20.294368 140277178812416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:24:20.294493 140277178812416 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 198.52
I0909 13:24:25.332063 140277178812416 replay_runner.py:36] Average training steps per second: 198.52
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:24:26.561821 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:24:26.657925 140277178812416 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 231.89
I0909 13:24:30.970961 140277178812416 replay_runner.py:36] Average training steps per second: 231.89
I0909 13:24:31.313933 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:24:31.418281 140277178812416 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 225.85
I0909 13:24:35.846206 140277178812416 replay_runner.py:36] Average training steps per second: 225.85
I0909 13:24:36.186914 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:24:36.293390 140277178812416 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 227.20
I0909 13:24:40.695394 140277178812416 replay_runner.py:36] Average training steps per second: 227.20
I0909 13:24:41.038446 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:24:41.145278 140277178812416 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 221.57
I0909 13:24:45.658925 140277178812416 replay_runner.py:36] Average training steps per second: 221.57
I0909 13:24:45.990464 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:24:46.094673 140277178812416 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 225.71
I0909 13:24:50.525560 140277178812416 replay_runner.py:36] Average training steps per second: 225.71
I0909 13:24:50.893914 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:24:51.004566 140277178812416 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.87
I0909 13:24:55.412856 140277178812416 replay_runner.py:36] Average training steps per second: 226.87
I0909 13:24:55.739009 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:24:55.848140 140277178812416 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 225.36
I0909 13:25:00.286023 140277178812416 replay_runner.py:36] Average training steps per second: 225.36
I0909 13:25:00.627292 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:25:00.739695 140277178812416 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 228.71
I0909 13:25:05.112599 140277178812416 replay_runner.py:36] Average training steps per second: 228.71
I0909 13:25:05.469339 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:25:05.583633 140277178812416 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 225.17
I0909 13:25:10.025378 140277178812416 replay_runner.py:36] Average training steps per second: 225.17
I0909 13:25:10.385207 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:25:10.503304 140277178812416 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.63
I0909 13:25:14.916186 140277178812416 replay_runner.py:36] Average training steps per second: 226.63
I0909 13:25:15.277191 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:25:15.389396 140277178812416 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 226.19
I0909 13:25:19.811088 140277178812416 replay_runner.py:36] Average training steps per second: 226.19
I0909 13:25:20.165019 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 256 Episode length: 153 Return: -153.0
INFO:tensorflow:Average training steps per second: 224.68
I0909 13:25:24.729824 140277178812416 replay_runner.py:36] Average training steps per second: 224.68
I0909 13:25:24.884335 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 13

Steps executed: 247 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 224.82
I0909 13:25:29.445703 140277178812416 replay_runner.py:36] Average training steps per second: 224.82
I0909 13:25:29.590789 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 14
I0909 13:25:29.696918 140277178812416 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 224.40

Steps executed: 214 Episode length: 107 Return: -107.0
I0909 13:25:34.277661 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 15

Steps executed: 238 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 224.02
I0909 13:25:38.860584 140277178812416 replay_runner.py:36] Average training steps per second: 224.02
I0909 13:25:39.002051 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 16

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.53
I0909 13:25:43.537840 140277178812416 replay_runner.py:36] Average training steps per second: 225.53
I0909 13:25:43.885200 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0909 13:25:43.992443 140277178812416 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 223.53
I0909 13:25:48.466590 140277178812416 replay_runner.py:36] Average training steps per second: 223.53
I0909 13:25:48.805226 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0909 13:25:48.914523 140277178812416 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 226.35
I0909 13:25:53.332912 140277178812416 replay_runner.py:36] Average training steps per second: 226.35
I0909 13:25:53.668545 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0909 13:25:53.769234 140277178812416 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 223.10
I0909 13:25:58.251883 140277178812416 replay_runner.py:36] Average training steps per second: 223.10

Steps executed: 247 Episode length: 126 Return: -126.0
INFO:tensorflow:Starting iteration 20

Steps executed: 302 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 221.79
I0909 13:26:02.996025 140277178812416 replay_runner.py:36] Average training steps per second: 221.79
I0909 13:26:03.170501 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 21

Steps executed: 329 Episode length: 164 Return: -164.0
INFO:tensorflow:Average training steps per second: 223.77
I0909 13:26:07.740430 140277178812416 replay_runner.py:36] Average training steps per second: 223.77
I0909 13:26:07.922485 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.50
INFO:tensorflow:Starting iteration 22
I0909 13:26:08.027117 140277178812416 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 222.06

Steps executed: 368 Episode length: 178 Return: -178.0
I0909 13:26:12.756572 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.00
INFO:tensorflow:Starting iteration 23

Steps executed: 228 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 220.05
I0909 13:26:17.405758 140277178812416 replay_runner.py:36] Average training steps per second: 220.05
I0909 13:26:17.551975 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 24

Steps executed: 225 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 221.50
I0909 13:26:22.178322 140277178812416 replay_runner.py:36] Average training steps per second: 221.50
I0909 13:26:22.311371 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 25

Steps executed: 306 Episode length: 159 Return: -159.0
INFO:tensorflow:Average training steps per second: 224.82
I0909 13:26:26.867028 140277178812416 replay_runner.py:36] Average training steps per second: 224.82
I0909 13:26:27.059473 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.00
INFO:tensorflow:Starting iteration 26

Steps executed: 402 Episode length: 214 Return: -214.0
INFO:tensorflow:Average training steps per second: 224.92
I0909 13:26:31.607827 140277178812416 replay_runner.py:36] Average training steps per second: 224.92
I0909 13:26:31.834942 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 27

Steps executed: 186 Episode length: 186 Return: -186.0
INFO:tensorflow:Average training steps per second: 225.70
I0909 13:26:36.378200 140277178812416 replay_runner.py:36] Average training steps per second: 225.70

Steps executed: 375 Episode length: 189 Return: -189.0
INFO:tensorflow:Starting iteration 28

Steps executed: 313 Episode length: 157 Return: -157.0
INFO:tensorflow:Average training steps per second: 223.48
I0909 13:26:41.185297 140277178812416 replay_runner.py:36] Average training steps per second: 223.48
I0909 13:26:41.371495 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 227.71
I0909 13:26:45.864165 140277178812416 replay_runner.py:36] Average training steps per second: 227.71
I0909 13:26:46.022561 140277178812416 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00