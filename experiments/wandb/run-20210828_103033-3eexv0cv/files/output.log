Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0828 10:30:39.627996 140137371908096 run_experiment.py:549] Creating TrainRunner ...
I0828 10:30:39.637665 140137371908096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:39.637876 140137371908096 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:39.637998 140137371908096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:39.638089 140137371908096 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:39.638191 140137371908096 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:39.638282 140137371908096 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:39.638383 140137371908096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:39.638509 140137371908096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:39.638626 140137371908096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:39.638746 140137371908096 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:39.638859 140137371908096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:39.638967 140137371908096 dqn_agent.py:283] 	 seed: 1630146639637605
I0828 10:30:39.641978 140137371908096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:39.642292 140137371908096 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:39.642501 140137371908096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:39.642723 140137371908096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:39.642889 140137371908096 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:39.643034 140137371908096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:39.643175 140137371908096 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:39.643249 140137371908096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:39.643313 140137371908096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:39.684369 140137371908096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.244163 140137371908096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.259165 140137371908096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:30:40.268944 140137371908096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:30:40.269255 140137371908096 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:30:40.269496 140137371908096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:30:40.269785 140137371908096 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:30:40.269962 140137371908096 dqn_agent.py:275] 	 update_period: 4
I0828 10:30:40.270134 140137371908096 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:30:40.270258 140137371908096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:30:40.270364 140137371908096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:30:40.270500 140137371908096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:30:40.270810 140137371908096 dqn_agent.py:280] 	 optimizer: adam
I0828 10:30:40.271010 140137371908096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:30:40.271174 140137371908096 dqn_agent.py:283] 	 seed: 1630146640268873
I0828 10:30:40.274100 140137371908096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:30:40.274301 140137371908096 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:30:40.274398 140137371908096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:30:40.274507 140137371908096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:30:40.274684 140137371908096 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:30:40.274914 140137371908096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:30:40.275007 140137371908096 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:30:40.275087 140137371908096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:30:40.275332 140137371908096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:30:40.308635 140137371908096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:30:40.332315 140137371908096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:30:40.332684 140137371908096 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.63
I0828 10:30:47.061065 140137371908096 replay_runner.py:36] Average training steps per second: 148.63
Steps executed: 202 Episode length: 11 Return: 11.0
I0828 10:30:48.260481 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.10
INFO:tensorflow:Starting iteration 1

Steps executed: 213 Episode length: 14 Return: 14.0
INFO:tensorflow:Average training steps per second: 202.87
I0828 10:30:53.374997 140137371908096 replay_runner.py:36] Average training steps per second: 202.87
I0828 10:30:53.500584 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.75
INFO:tensorflow:Starting iteration 2

Steps executed: 336 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 197.45
I0828 10:30:58.741763 140137371908096 replay_runner.py:36] Average training steps per second: 197.45
I0828 10:30:58.937903 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 3

Steps executed: 201 Episode length: 19 Return: 19.0.0
INFO:tensorflow:Average training steps per second: 211.37
I0828 10:31:03.847528 140137371908096 replay_runner.py:36] Average training steps per second: 211.37
I0828 10:31:03.976432 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.75
INFO:tensorflow:Starting iteration 4

Steps executed: 204 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 198.87
I0828 10:31:09.186821 140137371908096 replay_runner.py:36] Average training steps per second: 198.87
I0828 10:31:09.316882 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.33
INFO:tensorflow:Starting iteration 5

Steps executed: 223 Episode length: 105 Return: 105.0
INFO:tensorflow:Average training steps per second: 199.35
I0828 10:31:14.523043 140137371908096 replay_runner.py:36] Average training steps per second: 199.35
I0828 10:31:14.678175 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 55.75
INFO:tensorflow:Starting iteration 6

Steps executed: 241 Episode length: 114 Return: 114.0
INFO:tensorflow:Average training steps per second: 194.57
I0828 10:31:20.001907 140137371908096 replay_runner.py:36] Average training steps per second: 194.57
I0828 10:31:20.164739 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.50
INFO:tensorflow:Starting iteration 7
I0828 10:31:20.347340 140137371908096 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.90

Steps executed: 299 Episode length: 146 Return: 146.0
I0828 10:31:25.797584 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 8

Steps executed: 207 Episode length: 26 Return: 26.0.0
INFO:tensorflow:Average training steps per second: 197.00
I0828 10:31:31.071558 140137371908096 replay_runner.py:36] Average training steps per second: 197.00
I0828 10:31:31.221395 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 23.00
INFO:tensorflow:Starting iteration 9

Steps executed: 244 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 192.70
I0828 10:31:36.580340 140137371908096 replay_runner.py:36] Average training steps per second: 192.70
I0828 10:31:36.749147 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.00
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.12
I0828 10:31:42.172213 140137371908096 replay_runner.py:36] Average training steps per second: 191.12
I0828 10:31:42.320590 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 132 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 195.58
I0828 10:31:47.640702 140137371908096 replay_runner.py:36] Average training steps per second: 195.58

Steps executed: 260 Episode length: 128 Return: 128.0
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.97
I0828 10:31:53.256687 140137371908096 replay_runner.py:36] Average training steps per second: 189.97
I0828 10:31:53.390892 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 240 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 198.13
I0828 10:31:58.633053 140137371908096 replay_runner.py:36] Average training steps per second: 198.13
I0828 10:31:58.793884 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 14

Steps executed: 312 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 190.10
I0828 10:32:04.246523 140137371908096 replay_runner.py:36] Average training steps per second: 190.10
I0828 10:32:04.446825 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.68
I0828 10:32:09.833242 140137371908096 replay_runner.py:36] Average training steps per second: 192.68
I0828 10:32:09.979082 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0828 10:32:10.227424 140137371908096 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 190.33
I0828 10:32:15.482004 140137371908096 replay_runner.py:36] Average training steps per second: 190.33
I0828 10:32:15.607474 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 298 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 189.90
I0828 10:32:21.050655 140137371908096 replay_runner.py:36] Average training steps per second: 189.90
I0828 10:32:21.252886 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 18

Steps executed: 300 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 194.92
I0828 10:32:26.566998 140137371908096 replay_runner.py:36] Average training steps per second: 194.92
I0828 10:32:26.780587 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 19

Steps executed: 329 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 193.76
I0828 10:32:32.139947 140137371908096 replay_runner.py:36] Average training steps per second: 193.76
I0828 10:32:32.355906 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 20

Steps executed: 229 Episode length: 112 Return: 112.0
INFO:tensorflow:Average training steps per second: 201.93
I0828 10:32:37.492199 140137371908096 replay_runner.py:36] Average training steps per second: 201.93
I0828 10:32:37.653038 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 21

Steps executed: 222 Episode length: 110 Return: 110.0
INFO:tensorflow:Average training steps per second: 197.52
I0828 10:32:42.903284 140137371908096 replay_runner.py:36] Average training steps per second: 197.52
I0828 10:32:43.041853 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 111.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.05
I0828 10:32:48.147312 140137371908096 replay_runner.py:36] Average training steps per second: 203.05
I0828 10:32:48.275418 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0828 10:32:48.466997 140137371908096 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 188.93
I0828 10:32:53.760614 140137371908096 replay_runner.py:36] Average training steps per second: 188.93

Steps executed: 271 Episode length: 117 Return: 117.0
INFO:tensorflow:Starting iteration 24

Steps executed: 211 Episode length: 107 Return: 107.0
INFO:tensorflow:Average training steps per second: 200.05
I0828 10:32:59.113507 140137371908096 replay_runner.py:36] Average training steps per second: 200.05
I0828 10:32:59.254462 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 105.50
INFO:tensorflow:Starting iteration 25

Steps executed: 210 Episode length: 16 Return: 16.0.0
INFO:tensorflow:Average training steps per second: 193.34
I0828 10:33:04.610477 140137371908096 replay_runner.py:36] Average training steps per second: 193.34
I0828 10:33:04.752305 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.09
INFO:tensorflow:Starting iteration 26
I0828 10:33:04.934081 140137371908096 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 199.53
I0828 10:33:09.946367 140137371908096 replay_runner.py:36] Average training steps per second: 199.53

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 27

Steps executed: 249 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 196.32
I0828 10:33:15.359493 140137371908096 replay_runner.py:36] Average training steps per second: 196.32
I0828 10:33:15.507133 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.50
INFO:tensorflow:Starting iteration 28

Steps executed: 234 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 204.77
I0828 10:33:20.574745 140137371908096 replay_runner.py:36] Average training steps per second: 204.77
I0828 10:33:20.737689 140137371908096 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.00
INFO:tensorflow:Starting iteration 29

Steps executed: 212 Episode length: 111 Return: 111.0
INFO:tensorflow:Average training steps per second: 198.96
I0828 10:33:25.940137 140137371908096 replay_runner.py:36] Average training steps per second: 198.96

Done fixed training!Episode length: 111 Return: 111.0