Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
I0910 10:59:54.251451 140257491974144 run_experiment.py:549] Creating TrainRunner ...
I0910 10:59:54.257701 140257491974144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:59:54.257842 140257491974144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:59:54.257919 140257491974144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:59:54.257978 140257491974144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:59:54.258031 140257491974144 dqn_agent.py:275] 	 update_period: 4
I0910 10:59:54.258112 140257491974144 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:59:54.258210 140257491974144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:59:54.258284 140257491974144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:59:54.258389 140257491974144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:59:54.258469 140257491974144 dqn_agent.py:280] 	 optimizer: adam
I0910 10:59:54.258535 140257491974144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:59:54.258596 140257491974144 dqn_agent.py:283] 	 seed: 1631271594257666
I0910 10:59:54.260337 140257491974144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:59:54.260452 140257491974144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:59:54.260579 140257491974144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:59:54.260649 140257491974144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:59:54.260705 140257491974144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:59:54.260764 140257491974144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:59:54.260818 140257491974144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:59:54.260870 140257491974144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:59:54.260987 140257491974144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:59:55.425702 140257491974144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:59:55.445896 140257491974144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:59:55.446050 140257491974144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:59:55.446121 140257491974144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:59:55.446183 140257491974144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:59:55.446238 140257491974144 dqn_agent.py:275] 	 update_period: 4
I0910 10:59:55.446291 140257491974144 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:59:55.446368 140257491974144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:59:55.446424 140257491974144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:59:55.446529 140257491974144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:59:55.446588 140257491974144 dqn_agent.py:280] 	 optimizer: adam
I0910 10:59:55.446642 140257491974144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:59:55.446693 140257491974144 dqn_agent.py:283] 	 seed: 1631271595445852
I0910 10:59:55.448232 140257491974144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:59:55.448361 140257491974144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:59:55.448446 140257491974144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:59:55.448510 140257491974144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:59:55.448567 140257491974144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:59:55.448620 140257491974144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:59:55.448694 140257491974144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:59:55.448776 140257491974144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:59:55.448836 140257491974144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:59:55.471423 140257491974144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:59:55.486231 140257491974144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 10:59:55.486475 140257491974144 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 729444.17
I0910 10:59:55.487996 140257491974144 replay_runner.py:39] Average training steps per second: 729444.17
I0910 10:59:56.309333 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.00
INFO:tensorflow:Starting iteration 1
I0910 10:59:56.355626 140257491974144 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 777442.82
I0910 10:59:56.357125 140257491974144 replay_runner.py:39] Average training steps per second: 777442.82
I0910 10:59:56.630998 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.00
INFO:tensorflow:Starting iteration 2
I0910 10:59:56.671303 140257491974144 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 789441.75
I0910 10:59:56.672810 140257491974144 replay_runner.py:39] Average training steps per second: 789441.75
I0910 10:59:56.794303 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.50
INFO:tensorflow:Starting iteration 3
I0910 10:59:56.838177 140257491974144 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 802430.46
I0910 10:59:56.839648 140257491974144 replay_runner.py:39] Average training steps per second: 802430.46
I0910 10:59:57.031674 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 10:59:57.074643 140257491974144 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 803044.99
I0910 10:59:57.076124 140257491974144 replay_runner.py:39] Average training steps per second: 803044.99
I0910 10:59:57.345752 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.00
INFO:tensorflow:Starting iteration 5
I0910 10:59:57.391598 140257491974144 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 786186.32
I0910 10:59:57.393153 140257491974144 replay_runner.py:39] Average training steps per second: 786186.32
I0910 10:59:57.666309 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.50
INFO:tensorflow:Starting iteration 6
I0910 10:59:57.708957 140257491974144 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 806131.85
I0910 10:59:57.710460 140257491974144 replay_runner.py:39] Average training steps per second: 806131.85
Steps executed: 777 Episode length: 600 Return: -600.0
I0910 10:59:57.812354 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.00
INFO:tensorflow:Starting iteration 7
I0910 10:59:57.854273 140257491974144 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 798458.79
I0910 10:59:57.855745 140257491974144 replay_runner.py:39] Average training steps per second: 798458.79
I0910 10:59:57.969760 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.00
INFO:tensorflow:Starting iteration 8
I0910 10:59:58.021420 140257491974144 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 791228.82
I0910 10:59:58.022992 140257491974144 replay_runner.py:39] Average training steps per second: 791228.82
I0910 10:59:58.144837 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.50
INFO:tensorflow:Starting iteration 9
I0910 10:59:58.186968 140257491974144 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 818880.12
I0910 10:59:58.188416 140257491974144 replay_runner.py:39] Average training steps per second: 818880.12
I0910 10:59:58.313743 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.00
INFO:tensorflow:Starting iteration 10
I0910 10:59:58.354673 140257491974144 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 805976.94
I0910 10:59:58.356125 140257491974144 replay_runner.py:39] Average training steps per second: 805976.94
I0910 10:59:58.563933 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 10:59:58.606829 140257491974144 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 787810.67
I0910 10:59:58.608350 140257491974144 replay_runner.py:39] Average training steps per second: 787810.67
I0910 10:59:58.851197 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 10:59:58.897502 140257491974144 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 795128.72
I0910 10:59:58.898993 140257491974144 replay_runner.py:39] Average training steps per second: 795128.72
I0910 10:59:59.020918 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.00
INFO:tensorflow:Starting iteration 13
I0910 10:59:59.063159 140257491974144 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 804894.26
I0910 10:59:59.064632 140257491974144 replay_runner.py:39] Average training steps per second: 804894.26
I0910 10:59:59.309462 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.00
INFO:tensorflow:Starting iteration 14
I0910 10:59:59.350663 140257491974144 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 817125.27
I0910 10:59:59.352115 140257491974144 replay_runner.py:39] Average training steps per second: 817125.27
I0910 10:59:59.465970 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.50
INFO:tensorflow:Starting iteration 15
I0910 10:59:59.508472 140257491974144 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 801816.86
I0910 10:59:59.509927 140257491974144 replay_runner.py:39] Average training steps per second: 801816.86
I0910 10:59:59.675422 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.50
INFO:tensorflow:Starting iteration 16
I0910 10:59:59.716604 140257491974144 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 806131.85


Steps executed: 180 Episode length: 180 Return: -180.0
I0910 10:59:59.907583 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 10:59:59.958472 140257491974144 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 817603.12
I0910 10:59:59.960000 140257491974144 replay_runner.py:39] Average training steps per second: 817603.12
I0910 11:00:00.063177 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.50
INFO:tensorflow:Starting iteration 18
I0910 11:00:00.106535 140257491974144 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 779031.20
I0910 11:00:00.108029 140257491974144 replay_runner.py:39] Average training steps per second: 779031.20
I0910 11:00:00.336862 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:00:00.377775 140257491974144 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 794526.24
I0910 11:00:00.379261 140257491974144 replay_runner.py:39] Average training steps per second: 794526.24
I0910 11:00:00.498948 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.00
INFO:tensorflow:Starting iteration 20
I0910 11:00:00.543978 140257491974144 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 613830.53
I0910 11:00:00.545873 140257491974144 replay_runner.py:39] Average training steps per second: 613830.53
I0910 11:00:00.662786 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.50
INFO:tensorflow:Starting iteration 21
I0910 11:00:00.704411 140257491974144 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 793774.41
I0910 11:00:00.705902 140257491974144 replay_runner.py:39] Average training steps per second: 793774.41
I0910 11:00:00.944481 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.50
INFO:tensorflow:Starting iteration 22
I0910 11:00:00.986560 140257491974144 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 776291.69
I0910 11:00:00.988078 140257491974144 replay_runner.py:39] Average training steps per second: 776291.69
I0910 11:00:01.091395 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.00
INFO:tensorflow:Starting iteration 23
I0910 11:00:01.133286 140257491974144 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 859136.42
I0910 11:00:01.134708 140257491974144 replay_runner.py:39] Average training steps per second: 859136.42
I0910 11:00:01.370665 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.00
INFO:tensorflow:Starting iteration 24
I0910 11:00:01.411839 140257491974144 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 799371.83
I0910 11:00:01.413357 140257491974144 replay_runner.py:39] Average training steps per second: 799371.83
I0910 11:00:01.520357 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.00
INFO:tensorflow:Starting iteration 25
I0910 11:00:01.561474 140257491974144 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 819200.00
I0910 11:00:01.562912 140257491974144 replay_runner.py:39] Average training steps per second: 819200.00

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 26
I0910 11:00:01.883328 140257491974144 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 843584.88
I0910 11:00:01.884831 140257491974144 replay_runner.py:39] Average training steps per second: 843584.88
I0910 11:00:02.047954 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.00
INFO:tensorflow:Starting iteration 27
I0910 11:00:02.088641 140257491974144 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 818081.53
I0910 11:00:02.090073 140257491974144 replay_runner.py:39] Average training steps per second: 818081.53
I0910 11:00:02.187669 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.00
INFO:tensorflow:Starting iteration 28
I0910 11:00:02.228594 140257491974144 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 808618.47
I0910 11:00:02.230042 140257491974144 replay_runner.py:39] Average training steps per second: 808618.47
I0910 11:00:02.355037 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -178.50
INFO:tensorflow:Starting iteration 29
I0910 11:00:02.395599 140257491974144 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 812377.30
I0910 11:00:02.397065 140257491974144 replay_runner.py:39] Average training steps per second: 812377.30
I0910 11:00:02.591090 140257491974144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00