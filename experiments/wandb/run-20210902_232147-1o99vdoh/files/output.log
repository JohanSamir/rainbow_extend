I0902 23:21:53.666474 140392186603520 run_experiment.py:549] Creating TrainRunner ...
I0902 23:21:53.679291 140392186603520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:53.679600 140392186603520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:53.679754 140392186603520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:53.679883 140392186603520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:53.680060 140392186603520 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:53.680261 140392186603520 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:53.680426 140392186603520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:53.680564 140392186603520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:53.680692 140392186603520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:53.680810 140392186603520 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:53.680929 140392186603520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:53.681049 140392186603520 dqn_agent.py:283] 	 seed: 1630624913679217
I0902 23:21:53.684484 140392186603520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:53.684715 140392186603520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:53.685049 140392186603520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:53.685344 140392186603520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:53.685535 140392186603520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:53.685759 140392186603520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:53.685880 140392186603520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:53.686027 140392186603520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:53.686141 140392186603520 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 5, please be patient, may be a while...
I0902 23:21:55.677250 140392186603520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.198781 140392186603520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.211351 140392186603520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:21:56.218534 140392186603520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:56.218796 140392186603520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:56.218911 140392186603520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:56.218992 140392186603520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:56.219095 140392186603520 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:56.219260 140392186603520 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:56.219424 140392186603520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:56.219687 140392186603520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:56.219830 140392186603520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:56.219918 140392186603520 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:56.219990 140392186603520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:56.220061 140392186603520 dqn_agent.py:283] 	 seed: 1630624916218489
I0902 23:21:56.223315 140392186603520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:56.223539 140392186603520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:56.223677 140392186603520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:56.223858 140392186603520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:56.223981 140392186603520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:56.224060 140392186603520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:56.224132 140392186603520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:56.224224 140392186603520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:56.224414 140392186603520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:21:56.254343 140392186603520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.274487 140392186603520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:21:56.274775 140392186603520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.01
I0902 23:22:02.853868 140392186603520 replay_runner.py:36] Average training steps per second: 152.01
Steps executed: 204 Episode length: 10 Return: 10.0
I0902 23:22:04.010150 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 209.16
I0902 23:22:08.977065 140392186603520 replay_runner.py:36] Average training steps per second: 209.16
I0902 23:22:09.114716 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.84
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.18
I0902 23:22:14.272768 140392186603520 replay_runner.py:36] Average training steps per second: 201.18
I0902 23:22:14.397148 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:22:14.587275 140392186603520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 218.56
I0902 23:22:19.163506 140392186603520 replay_runner.py:36] Average training steps per second: 218.56
I0902 23:22:19.292428 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 383 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 203.09
I0902 23:22:24.397549 140392186603520 replay_runner.py:36] Average training steps per second: 203.09
I0902 23:22:24.628911 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 5

Steps executed: 368 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 203.77
I0902 23:22:29.720310 140392186603520 replay_runner.py:36] Average training steps per second: 203.77
I0902 23:22:29.975189 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 6

Steps executed: 326 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 201.78
I0902 23:22:35.122149 140392186603520 replay_runner.py:36] Average training steps per second: 201.78
I0902 23:22:35.330933 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 7

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.50
I0902 23:22:40.657064 140392186603520 replay_runner.py:36] Average training steps per second: 194.50
I0902 23:22:40.908183 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 8

Steps executed: 291 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 196.83
I0902 23:22:46.180202 140392186603520 replay_runner.py:36] Average training steps per second: 196.83
I0902 23:22:46.385820 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.50
INFO:tensorflow:Starting iteration 9
I0902 23:22:46.584861 140392186603520 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.46

Steps executed: 273 Episode length: 134 Return: 134.0
I0902 23:22:51.862784 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 10

Steps executed: 312 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 195.49
I0902 23:22:57.162752 140392186603520 replay_runner.py:36] Average training steps per second: 195.49
I0902 23:22:57.382393 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 11

Steps executed: 308 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 194.90
I0902 23:23:02.700300 140392186603520 replay_runner.py:36] Average training steps per second: 194.90
I0902 23:23:02.914674 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 12

Steps executed: 344 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 189.79
I0902 23:23:08.377431 140392186603520 replay_runner.py:36] Average training steps per second: 189.79
I0902 23:23:08.601515 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 13
I0902 23:23:08.787215 140392186603520 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.06
I0902 23:23:13.836472 140392186603520 replay_runner.py:36] Average training steps per second: 198.06

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 14

Steps executed: 159 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 196.81
I0902 23:23:19.266027 140392186603520 replay_runner.py:36] Average training steps per second: 196.81
I0902 23:23:19.486287 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 15


Steps executed: 284 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 192.09
I0902 23:23:24.887499 140392186603520 replay_runner.py:36] Average training steps per second: 192.09
I0902 23:23:25.085578 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 16

Steps executed: 335 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 197.34
I0902 23:23:30.332340 140392186603520 replay_runner.py:36] Average training steps per second: 197.34
I0902 23:23:30.554675 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.50
INFO:tensorflow:Starting iteration 17
I0902 23:23:30.740693 140392186603520 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 187.35

Steps executed: 387 Episode length: 198 Return: 198.0
I0902 23:23:36.331745 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.31
I0902 23:23:41.472556 140392186603520 replay_runner.py:36] Average training steps per second: 201.31
I0902 23:23:41.614329 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:23:41.784964 140392186603520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.34
I0902 23:23:47.011806 140392186603520 replay_runner.py:36] Average training steps per second: 191.34
I0902 23:23:47.148077 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 338 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 193.27
I0902 23:23:52.514101 140392186603520 replay_runner.py:36] Average training steps per second: 193.27
I0902 23:23:52.752232 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 21
I0902 23:23:52.944633 140392186603520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.86
I0902 23:23:57.948611 140392186603520 replay_runner.py:36] Average training steps per second: 199.86
I0902 23:23:58.081659 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.04
I0902 23:24:03.567114 140392186603520 replay_runner.py:36] Average training steps per second: 189.04
I0902 23:24:03.714658 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 264 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 199.23
I0902 23:24:08.911961 140392186603520 replay_runner.py:36] Average training steps per second: 199.23
I0902 23:24:09.101091 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.96
I0902 23:24:14.517132 140392186603520 replay_runner.py:36] Average training steps per second: 191.96
I0902 23:24:14.657148 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:24:14.851561 140392186603520 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 192.62
I0902 23:24:20.043579 140392186603520 replay_runner.py:36] Average training steps per second: 192.62
I0902 23:24:20.240817 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:24:20.448002 140392186603520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.78
I0902 23:24:25.478971 140392186603520 replay_runner.py:36] Average training steps per second: 198.78
I0902 23:24:25.606060 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 360 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 196.59
I0902 23:24:30.885666 140392186603520 replay_runner.py:36] Average training steps per second: 196.59
I0902 23:24:31.113944 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 28
I0902 23:24:31.296562 140392186603520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.61

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:24:36.289766 140392186603520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 355 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.30
I0902 23:24:41.483257 140392186603520 replay_runner.py:36] Average training steps per second: 199.30

Done fixed training!Episode length: 200 Return: 200.0