I0902 00:38:28.390479 139825600018432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:38:28.398406 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:28.398550 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:28.398632 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:28.398700 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:28.398764 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:28.398828 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:28.398914 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:28.399030 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:28.399199 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:28.399361 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:28.399466 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:28.399567 139825600018432 dqn_agent.py:283] 	 seed: 1630543108398368
I0902 00:38:28.401582 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:28.401706 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:28.401796 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:28.401867 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:28.401960 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:28.402025 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:28.402163 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:28.402255 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:28.402334 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:28.428610 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:28.696146 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:28.705375 139825600018432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:38:28.712312 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:38:28.712447 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:38:28.712537 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:38:28.712634 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:38:28.712779 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:38:28.712849 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:38:28.712956 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:38:28.713018 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:38:28.713100 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:38:28.713194 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:38:28.713274 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:38:28.713343 139825600018432 dqn_agent.py:283] 	 seed: 1630543108712276
I0902 00:38:28.715015 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:38:28.715135 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:38:28.715216 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:38:28.715286 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:38:28.715350 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:38:28.715431 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:38:28.715497 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:38:28.715588 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:38:28.715672 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:38:28.737458 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:38:28.753522 139825600018432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:38:28.753857 139825600018432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 228.83
I0902 00:38:33.124229 139825600018432 replay_runner.py:36] Average training steps per second: 228.83
I0902 00:38:33.856220 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -813.06
Steps executed: 200 Episode length: 129 Return: -1008.0307584065035
INFO:tensorflow:Starting iteration 1

Steps executed: 230 Episode length: 82 Return: -773.508744611467635
INFO:tensorflow:Average training steps per second: 334.56
I0902 00:38:40.294770 139825600018432 replay_runner.py:36] Average training steps per second: 334.56
I0902 00:38:40.421293 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -684.69
INFO:tensorflow:Starting iteration 2

Steps executed: 346 Episode length: 201 Return: -875.96343154762045
INFO:tensorflow:Average training steps per second: 326.82
I0902 00:38:46.913098 139825600018432 replay_runner.py:36] Average training steps per second: 326.82
I0902 00:38:47.130226 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -750.17
INFO:tensorflow:Starting iteration 3

Steps executed: 212 Episode length: 55 Return: -344.976390186336345
INFO:tensorflow:Average training steps per second: 334.44
I0902 00:38:53.509214 139825600018432 replay_runner.py:36] Average training steps per second: 334.44
I0902 00:38:53.616875 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.37
INFO:tensorflow:Starting iteration 4

Steps executed: 54 Episode length: 54 Return: -387.3072303040108345
INFO:tensorflow:Average training steps per second: 332.73
I0902 00:39:00.053803 139825600018432 replay_runner.py:36] Average training steps per second: 332.73

Steps executed: 254 Episode length: 73 Return: -511.650014127322445
INFO:tensorflow:Starting iteration 5

Steps executed: 220 Episode length: 220 Return: -335.23410204853375
INFO:tensorflow:Average training steps per second: 332.29
I0902 00:39:06.615955 139825600018432 replay_runner.py:36] Average training steps per second: 332.29
I0902 00:39:06.778287 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.23
INFO:tensorflow:Starting iteration 6

Steps executed: 293 Episode length: 164 Return: -627.51620917736668
INFO:tensorflow:Average training steps per second: 331.14
I0902 00:39:13.203012 139825600018432 replay_runner.py:36] Average training steps per second: 331.14
I0902 00:39:13.385648 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -846.10
INFO:tensorflow:Starting iteration 7

Steps executed: 286 Episode length: 205 Return: -452.23013517932538
INFO:tensorflow:Average training steps per second: 330.51
I0902 00:39:19.807394 139825600018432 replay_runner.py:36] Average training steps per second: 330.51
I0902 00:39:20.038542 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -586.48
INFO:tensorflow:Starting iteration 8

Steps executed: 223 Episode length: 64 Return: -156.147805524280228
INFO:tensorflow:Average training steps per second: 332.85
I0902 00:39:26.431962 139825600018432 replay_runner.py:36] Average training steps per second: 332.85
I0902 00:39:26.548406 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.40
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 85 Return: -662.950269342019618
INFO:tensorflow:Average training steps per second: 332.21
I0902 00:39:32.966548 139825600018432 replay_runner.py:36] Average training steps per second: 332.21
I0902 00:39:33.096006 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -687.96
INFO:tensorflow:Starting iteration 10

Steps executed: 248 Episode length: 124 Return: -373.06515119424778
INFO:tensorflow:Average training steps per second: 327.41
I0902 00:39:39.572880 139825600018432 replay_runner.py:36] Average training steps per second: 327.41
I0902 00:39:39.738139 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.75
INFO:tensorflow:Starting iteration 11

Steps executed: 262 Episode length: 107 Return: -430.40471262767378
INFO:tensorflow:Average training steps per second: 332.68
I0902 00:39:46.174251 139825600018432 replay_runner.py:36] Average training steps per second: 332.68
I0902 00:39:46.336506 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.43
INFO:tensorflow:Starting iteration 12

Steps executed: 266 Episode length: 131 Return: -496.98889816578173
INFO:tensorflow:Average training steps per second: 330.15
I0902 00:39:52.765746 139825600018432 replay_runner.py:36] Average training steps per second: 330.15
I0902 00:39:52.904459 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.54
INFO:tensorflow:Starting iteration 13

Steps executed: 263 Episode length: 103 Return: -515.96883809105913
INFO:tensorflow:Average training steps per second: 329.80
I0902 00:39:59.355486 139825600018432 replay_runner.py:36] Average training steps per second: 329.80
I0902 00:39:59.522046 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.21
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 56 Return: -304.663883495731743
INFO:tensorflow:Average training steps per second: 336.53
I0902 00:40:05.937800 139825600018432 replay_runner.py:36] Average training steps per second: 336.53
I0902 00:40:06.085430 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.53
INFO:tensorflow:Starting iteration 15
I0902 00:40:09.533859 139825600018432 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 338.73
I0902 00:40:12.486398 139825600018432 replay_runner.py:36] Average training steps per second: 338.73

Steps executed: 261 Episode length: 261 Return: -113.66924729369109
INFO:tensorflow:Starting iteration 16

Steps executed: 233 Episode length: 51 Return: -368.346589233524479
INFO:tensorflow:Average training steps per second: 337.78
I0902 00:40:19.104951 139825600018432 replay_runner.py:36] Average training steps per second: 337.78
I0902 00:40:19.236358 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.88
INFO:tensorflow:Starting iteration 17

Steps executed: 238 Episode length: 67 Return: -141.541930377257679
INFO:tensorflow:Average training steps per second: 335.68
I0902 00:40:25.669268 139825600018432 replay_runner.py:36] Average training steps per second: 335.68
I0902 00:40:25.814902 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.37
INFO:tensorflow:Starting iteration 18
I0902 00:40:29.332881 139825600018432 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 340.63

Steps executed: 267 Episode length: 80 Return: -203.780304840256669
I0902 00:40:32.408377 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.00
INFO:tensorflow:Starting iteration 19

Steps executed: 246 Episode length: 77 Return: -501.932445179037249
INFO:tensorflow:Average training steps per second: 340.11
I0902 00:40:38.806941 139825600018432 replay_runner.py:36] Average training steps per second: 340.11
I0902 00:40:38.956350 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.37
INFO:tensorflow:Starting iteration 20

Steps executed: 224 Episode length: 62 Return: -484.511992227729439
INFO:tensorflow:Average training steps per second: 344.65
I0902 00:40:45.319924 139825600018432 replay_runner.py:36] Average training steps per second: 344.65
I0902 00:40:45.466666 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.18
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 52 Return: -443.275594356020869
INFO:tensorflow:Average training steps per second: 349.17
I0902 00:40:51.811701 139825600018432 replay_runner.py:36] Average training steps per second: 349.17
I0902 00:40:51.977636 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -452.46
INFO:tensorflow:Starting iteration 22

Steps executed: 64 Episode length: 64 Return: -475.4555202310600669
INFO:tensorflow:Average training steps per second: 349.98
I0902 00:40:58.321090 139825600018432 replay_runner.py:36] Average training steps per second: 349.98

Steps executed: 231 Episode length: 95 Return: -378.906961463266769
INFO:tensorflow:Starting iteration 23

Steps executed: 236 Episode length: 54 Return: -382.727045894139859
INFO:tensorflow:Average training steps per second: 350.97
I0902 00:41:04.743301 139825600018432 replay_runner.py:36] Average training steps per second: 350.97
I0902 00:41:04.885131 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.30
INFO:tensorflow:Starting iteration 24

Steps executed: 243 Episode length: 56 Return: -372.667318026818259
INFO:tensorflow:Average training steps per second: 363.78
I0902 00:41:10.986450 139825600018432 replay_runner.py:36] Average training steps per second: 363.78
I0902 00:41:11.136819 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.61
INFO:tensorflow:Starting iteration 25

Steps executed: 256 Episode length: 60 Return: -581.987162707549859
INFO:tensorflow:Average training steps per second: 365.37
I0902 00:41:17.220650 139825600018432 replay_runner.py:36] Average training steps per second: 365.37
I0902 00:41:17.364882 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.16
INFO:tensorflow:Starting iteration 26

Steps executed: 201 Episode length: 67 Return: -413.239420959253159
INFO:tensorflow:Average training steps per second: 371.77
I0902 00:41:23.402868 139825600018432 replay_runner.py:36] Average training steps per second: 371.77
I0902 00:41:23.517030 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.22
INFO:tensorflow:Starting iteration 27

Steps executed: 250 Episode length: 80 Return: -783.767771300608249
INFO:tensorflow:Average training steps per second: 370.86
I0902 00:41:29.354508 139825600018432 replay_runner.py:36] Average training steps per second: 370.86
I0902 00:41:29.497498 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.70
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 53 Return: -468.244392026704139
INFO:tensorflow:Average training steps per second: 388.23
I0902 00:41:35.248130 139825600018432 replay_runner.py:36] Average training steps per second: 388.23
I0902 00:41:35.348831 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -521.17
INFO:tensorflow:Starting iteration 29

Steps executed: 223 Episode length: 80 Return: -853.446230088283339
INFO:tensorflow:Average training steps per second: 385.94
I0902 00:41:40.948320 139825600018432 replay_runner.py:36] Average training steps per second: 385.94

Done fixed training!Episode length: 80 Return: -853.446230088283339