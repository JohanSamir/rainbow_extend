I0828 10:21:38.386878 139788988807168 run_experiment.py:549] Creating TrainRunner ...
I0828 10:21:38.394155 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:38.394300 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:38.394373 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:38.394433 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:38.394521 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:38.394593 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:38.394691 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:38.394773 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:38.394874 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:38.394953 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:38.395017 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:38.395081 139788988807168 dqn_agent.py:283] 	 seed: 1630146098394095
I0828 10:21:38.396745 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:38.396862 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:21:38.396927 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:38.397015 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:38.397072 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:38.397143 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:38.397215 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:38.397278 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:38.397359 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:38.449461 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:39.011946 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:39.024934 139788988807168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:21:39.032996 139788988807168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:39.033210 139788988807168 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:39.033346 139788988807168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:39.033469 139788988807168 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:39.033613 139788988807168 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:39.033682 139788988807168 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:39.033791 139788988807168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:39.033911 139788988807168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:39.033994 139788988807168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:39.034254 139788988807168 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:39.034434 139788988807168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:39.034594 139788988807168 dqn_agent.py:283] 	 seed: 1630146099032945
I0828 10:21:39.037163 139788988807168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:39.037315 139788988807168 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:21:39.037408 139788988807168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:39.037475 139788988807168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:39.037533 139788988807168 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:39.037627 139788988807168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:39.037707 139788988807168 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:39.037762 139788988807168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:39.037825 139788988807168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:39.065011 139788988807168 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:39.133006 139788988807168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:21:39.133329 139788988807168 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 148.97
I0828 10:21:45.846489 139788988807168 replay_runner.py:36] Average training steps per second: 148.97
Steps executed: 200 Episode length: 10 Return: 10.0
I0828 10:21:46.887089 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 1

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 193.20
I0828 10:21:52.251081 139788988807168 replay_runner.py:36] Average training steps per second: 193.20
I0828 10:21:52.391164 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 2

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 198.10
I0828 10:21:57.629153 139788988807168 replay_runner.py:36] Average training steps per second: 198.10
I0828 10:21:57.784857 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.10
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 13 Return: 13.0
INFO:tensorflow:Average training steps per second: 189.45
I0828 10:22:03.240329 139788988807168 replay_runner.py:36] Average training steps per second: 189.45
I0828 10:22:03.383891 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.18
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 198.75
I0828 10:22:08.600937 139788988807168 replay_runner.py:36] Average training steps per second: 198.75
I0828 10:22:08.754515 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.47
INFO:tensorflow:Starting iteration 5

Steps executed: 209 Episode length: 24 Return: 24.0
INFO:tensorflow:Average training steps per second: 195.23
I0828 10:22:14.081347 139788988807168 replay_runner.py:36] Average training steps per second: 195.23
I0828 10:22:14.213658 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.90
INFO:tensorflow:Starting iteration 6
I0828 10:22:14.400891 139788988807168 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 190.31
I0828 10:22:19.656239 139788988807168 replay_runner.py:36] Average training steps per second: 190.31
I0828 10:22:19.814428 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 58.50
INFO:tensorflow:Starting iteration 7


Steps executed: 217 Episode length: 21 Return: 21.0
INFO:tensorflow:Average training steps per second: 197.74
I0828 10:22:25.066363 139788988807168 replay_runner.py:36] Average training steps per second: 197.74
I0828 10:22:25.214683 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 24.11
INFO:tensorflow:Starting iteration 8

Steps executed: 209 Episode length: 26 Return: 26.0
INFO:tensorflow:Average training steps per second: 191.19
I0828 10:22:30.653153 139788988807168 replay_runner.py:36] Average training steps per second: 191.19
I0828 10:22:30.786101 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.12
INFO:tensorflow:Starting iteration 9

Steps executed: 204 Episode length: 20 Return: 20.0
INFO:tensorflow:Average training steps per second: 193.10
I0828 10:22:36.155565 139788988807168 replay_runner.py:36] Average training steps per second: 193.10
I0828 10:22:36.309396 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 29.14
INFO:tensorflow:Starting iteration 10

Steps executed: 219 Episode length: 23 Return: 23.0
INFO:tensorflow:Average training steps per second: 194.25
I0828 10:22:41.662391 139788988807168 replay_runner.py:36] Average training steps per second: 194.25
I0828 10:22:41.804005 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 24.33
INFO:tensorflow:Starting iteration 11

Steps executed: 204 Episode length: 21 Return: 21.0
INFO:tensorflow:Average training steps per second: 188.33
I0828 10:22:47.312053 139788988807168 replay_runner.py:36] Average training steps per second: 188.33
I0828 10:22:47.449984 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.40
INFO:tensorflow:Starting iteration 12

Steps executed: 219 Episode length: 22 Return: 22.0
INFO:tensorflow:Average training steps per second: 196.08
I0828 10:22:52.737202 139788988807168 replay_runner.py:36] Average training steps per second: 196.08
I0828 10:22:52.903421 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.91
INFO:tensorflow:Starting iteration 13

Steps executed: 306 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 190.76
I0828 10:22:58.340119 139788988807168 replay_runner.py:36] Average training steps per second: 190.76
I0828 10:22:58.527226 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 14

Steps executed: 245 Episode length: 122 Return: 122.0
INFO:tensorflow:Average training steps per second: 192.98
I0828 10:23:03.897440 139788988807168 replay_runner.py:36] Average training steps per second: 192.98
I0828 10:23:04.057711 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.41
I0828 10:23:09.195517 139788988807168 replay_runner.py:36] Average training steps per second: 202.41
I0828 10:23:09.316894 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0828 10:23:09.498857 139788988807168 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 208.27
I0828 10:23:14.300954 139788988807168 replay_runner.py:36] Average training steps per second: 208.27
I0828 10:23:14.429943 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0828 10:23:14.641000 139788988807168 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 186.32
I0828 10:23:20.008866 139788988807168 replay_runner.py:36] Average training steps per second: 186.32
I0828 10:23:20.140902 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0828 10:23:20.344877 139788988807168 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.19
I0828 10:23:25.501998 139788988807168 replay_runner.py:36] Average training steps per second: 194.19
I0828 10:23:25.643425 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0828 10:23:25.840571 139788988807168 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 192.51
I0828 10:23:31.035628 139788988807168 replay_runner.py:36] Average training steps per second: 192.51
I0828 10:23:31.165256 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0828 10:23:31.346916 139788988807168 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.97
I0828 10:23:36.476310 139788988807168 replay_runner.py:36] Average training steps per second: 194.97
I0828 10:23:36.617979 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0828 10:23:36.817201 139788988807168 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 193.39
I0828 10:23:41.988721 139788988807168 replay_runner.py:36] Average training steps per second: 193.39
I0828 10:23:42.112505 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0828 10:23:42.299829 139788988807168 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.24
I0828 10:23:47.556737 139788988807168 replay_runner.py:36] Average training steps per second: 190.24
I0828 10:23:47.703884 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 255 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 197.87
I0828 10:23:52.950379 139788988807168 replay_runner.py:36] Average training steps per second: 197.87
I0828 10:23:53.126677 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 24
I0828 10:23:53.325719 139788988807168 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 190.54
I0828 10:23:58.574619 139788988807168 replay_runner.py:36] Average training steps per second: 190.54

Steps executed: 253 Episode length: 126 Return: 126.0
INFO:tensorflow:Starting iteration 25

Steps executed: 330 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 196.75
I0828 10:24:04.028158 139788988807168 replay_runner.py:36] Average training steps per second: 196.75
I0828 10:24:04.253973 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 26

Steps executed: 295 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 191.50
I0828 10:24:09.659194 139788988807168 replay_runner.py:36] Average training steps per second: 191.50
I0828 10:24:09.859423 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 27

Steps executed: 386 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 190.20
I0828 10:24:15.302246 139788988807168 replay_runner.py:36] Average training steps per second: 190.20
I0828 10:24:15.558947 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00
INFO:tensorflow:Starting iteration 28

Steps executed: 343 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 199.48
I0828 10:24:20.765418 139788988807168 replay_runner.py:36] Average training steps per second: 199.48
I0828 10:24:20.975651 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 207.38
I0828 10:24:25.984994 139788988807168 replay_runner.py:36] Average training steps per second: 207.38
I0828 10:24:26.173681 139788988807168 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50