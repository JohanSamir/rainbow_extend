Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0901 23:44:08.603643 140476478453760 run_experiment.py:549] Creating TrainRunner ...
I0901 23:44:08.613064 140476478453760 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:08.613366 140476478453760 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:08.613714 140476478453760 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:08.613852 140476478453760 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:08.613968 140476478453760 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:08.614138 140476478453760 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:08.614266 140476478453760 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:08.614372 140476478453760 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:08.614496 140476478453760 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:08.614670 140476478453760 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:08.614814 140476478453760 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:08.615009 140476478453760 dqn_agent.py:283] 	 seed: 1630539848612986
I0901 23:44:08.618428 140476478453760 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:08.618648 140476478453760 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:08.618789 140476478453760 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:08.618910 140476478453760 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:08.619075 140476478453760 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:08.619200 140476478453760 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:08.619321 140476478453760 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:08.619441 140476478453760 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:08.619553 140476478453760 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:08.660517 140476478453760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:09.217121 140476478453760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:09.230139 140476478453760 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:44:09.239989 140476478453760 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:09.240240 140476478453760 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:09.240377 140476478453760 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:09.240502 140476478453760 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:09.240613 140476478453760 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:09.240721 140476478453760 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:09.240831 140476478453760 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:09.240938 140476478453760 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:09.241044 140476478453760 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:09.241147 140476478453760 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:09.241251 140476478453760 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:09.241352 140476478453760 dqn_agent.py:283] 	 seed: 1630539849239924
I0901 23:44:09.244044 140476478453760 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:09.244231 140476478453760 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:09.244361 140476478453760 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:09.244491 140476478453760 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:09.244608 140476478453760 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:09.244735 140476478453760 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:09.244843 140476478453760 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:09.244948 140476478453760 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:09.245057 140476478453760 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:09.278547 140476478453760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:09.300951 140476478453760 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:44:09.301243 140476478453760 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.50
I0901 23:44:15.946097 140476478453760 replay_runner.py:36] Average training steps per second: 150.50
Steps executed: 333 Episode length: 134 Return: 134.0
I0901 23:44:17.210638 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.57
INFO:tensorflow:Starting iteration 1
I0901 23:44:17.386001 140476478453760 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 209.46

Steps executed: 70 Episode length: 70 Return: 70.04.0
I0901 23:44:22.307393 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 72.67
INFO:tensorflow:Starting iteration 2

Steps executed: 218 Episode length: 73 Return: 73.0.0
INFO:tensorflow:Average training steps per second: 203.32
I0901 23:44:27.413686 140476478453760 replay_runner.py:36] Average training steps per second: 203.32
I0901 23:44:27.648282 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 3

Steps executed: 372 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 221.76
I0901 23:44:32.333544 140476478453760 replay_runner.py:36] Average training steps per second: 221.76
I0901 23:44:32.474188 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.50
INFO:tensorflow:Starting iteration 4

Steps executed: 233 Episode length: 114 Return: 114.0
INFO:tensorflow:Average training steps per second: 197.83
I0901 23:44:37.708807 140476478453760 replay_runner.py:36] Average training steps per second: 197.83
I0901 23:44:37.830924 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 210.85
I0901 23:44:42.755214 140476478453760 replay_runner.py:36] Average training steps per second: 210.85
I0901 23:44:42.886914 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.80
I0901 23:44:48.049400 140476478453760 replay_runner.py:36] Average training steps per second: 200.80
I0901 23:44:48.303258 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 7

Steps executed: 305 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 208.30
I0901 23:44:53.313762 140476478453760 replay_runner.py:36] Average training steps per second: 208.30
I0901 23:44:53.523373 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.50
INFO:tensorflow:Starting iteration 8

Steps executed: 310 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 193.16
I0901 23:44:58.885524 140476478453760 replay_runner.py:36] Average training steps per second: 193.16
I0901 23:44:59.090451 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 9

Steps executed: 338 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 202.16
I0901 23:45:04.230789 140476478453760 replay_runner.py:36] Average training steps per second: 202.16
I0901 23:45:04.450523 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 10

Steps executed: 289 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 199.18
I0901 23:45:09.668495 140476478453760 replay_runner.py:36] Average training steps per second: 199.18
I0901 23:45:09.859806 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.76
I0901 23:45:15.220125 140476478453760 replay_runner.py:36] Average training steps per second: 193.76
I0901 23:45:15.370392 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 335 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.63
I0901 23:45:20.754402 140476478453760 replay_runner.py:36] Average training steps per second: 192.63
I0901 23:45:20.984138 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.50
INFO:tensorflow:Starting iteration 13

Steps executed: 304 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 200.12
I0901 23:45:26.178515 140476478453760 replay_runner.py:36] Average training steps per second: 200.12
I0901 23:45:26.387259 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.75
I0901 23:45:31.580652 140476478453760 replay_runner.py:36] Average training steps per second: 199.75
I0901 23:45:31.717236 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 23:45:31.909666 140476478453760 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 200.61
I0901 23:45:36.894936 140476478453760 replay_runner.py:36] Average training steps per second: 200.61
I0901 23:45:37.023498 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:45:37.208765 140476478453760 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 194.21
I0901 23:45:42.358444 140476478453760 replay_runner.py:36] Average training steps per second: 194.21
I0901 23:45:42.500730 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:45:42.685870 140476478453760 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 194.52
I0901 23:45:47.827292 140476478453760 replay_runner.py:36] Average training steps per second: 194.52
I0901 23:45:47.966422 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.20
I0901 23:45:53.404796 140476478453760 replay_runner.py:36] Average training steps per second: 198.20
I0901 23:45:53.669485 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.83
I0901 23:45:58.819932 140476478453760 replay_runner.py:36] Average training steps per second: 201.83
I0901 23:45:58.954890 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:45:59.126241 140476478453760 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 198.35
I0901 23:46:04.168181 140476478453760 replay_runner.py:36] Average training steps per second: 198.35
I0901 23:46:04.311861 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:46:04.506253 140476478453760 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.22
I0901 23:46:09.526328 140476478453760 replay_runner.py:36] Average training steps per second: 199.22
I0901 23:46:09.668299 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:46:09.864979 140476478453760 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.42
I0901 23:46:14.905310 140476478453760 replay_runner.py:36] Average training steps per second: 198.42
I0901 23:46:15.054031 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:46:15.248768 140476478453760 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 196.87
I0901 23:46:20.328787 140476478453760 replay_runner.py:36] Average training steps per second: 196.87
I0901 23:46:20.465569 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:46:20.647248 140476478453760 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.02
I0901 23:46:25.723224 140476478453760 replay_runner.py:36] Average training steps per second: 197.02
I0901 23:46:25.858482 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:46:26.048363 140476478453760 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 199.12
I0901 23:46:31.070934 140476478453760 replay_runner.py:36] Average training steps per second: 199.12
I0901 23:46:31.210739 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:46:31.406358 140476478453760 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 195.84
I0901 23:46:36.513063 140476478453760 replay_runner.py:36] Average training steps per second: 195.84
I0901 23:46:36.645019 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:46:36.833686 140476478453760 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 200.76
I0901 23:46:41.815213 140476478453760 replay_runner.py:36] Average training steps per second: 200.76
I0901 23:46:41.947640 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:46:42.128892 140476478453760 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 197.79
I0901 23:46:47.185142 140476478453760 replay_runner.py:36] Average training steps per second: 197.79
I0901 23:46:47.324469 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.71
I0901 23:46:52.497306 140476478453760 replay_runner.py:36] Average training steps per second: 200.71
I0901 23:46:52.631443 140476478453760 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00