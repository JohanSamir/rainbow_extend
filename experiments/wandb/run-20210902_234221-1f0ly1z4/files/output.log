Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0902 23:42:28.570199 140608500226048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:42:28.580618 140608500226048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:42:28.580905 140608500226048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:42:28.581069 140608500226048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:42:28.581212 140608500226048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:42:28.581327 140608500226048 dqn_agent.py:275] 	 update_period: 4
I0902 23:42:28.581438 140608500226048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:42:28.581550 140608500226048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:42:28.581657 140608500226048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:42:28.581765 140608500226048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:42:28.581872 140608500226048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:42:28.581981 140608500226048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:42:28.582090 140608500226048 dqn_agent.py:283] 	 seed: 1630626148580548
I0902 23:42:28.585566 140608500226048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:42:28.585808 140608500226048 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:42:28.585973 140608500226048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:42:28.586104 140608500226048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:42:28.586234 140608500226048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:42:28.586364 140608500226048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:42:28.586476 140608500226048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:42:28.586636 140608500226048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:42:28.586764 140608500226048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:42:28.630649 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:29.171133 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:29.187286 140608500226048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:42:29.204167 140608500226048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:42:29.204391 140608500226048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:42:29.204499 140608500226048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:42:29.204579 140608500226048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:42:29.204671 140608500226048 dqn_agent.py:275] 	 update_period: 4
I0902 23:42:29.204871 140608500226048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:42:29.205017 140608500226048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:42:29.205138 140608500226048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:42:29.205204 140608500226048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:42:29.205289 140608500226048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:42:29.205448 140608500226048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:42:29.205522 140608500226048 dqn_agent.py:283] 	 seed: 1630626149204119
I0902 23:42:29.207816 140608500226048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:42:29.207996 140608500226048 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:42:29.208109 140608500226048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:42:29.208256 140608500226048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:42:29.208410 140608500226048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:42:29.208567 140608500226048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:42:29.208652 140608500226048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:42:29.208727 140608500226048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:42:29.208966 140608500226048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:42:29.247159 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:42:29.271530 140608500226048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:42:29.272152 140608500226048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.01
I0902 23:42:36.074758 140608500226048 replay_runner.py:36] Average training steps per second: 147.01
I0902 23:42:37.250272 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1
I0902 23:42:37.432200 140608500226048 replay_runner.py:41] Starting iteration 1

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.80
I0902 23:42:42.539808 140608500226048 replay_runner.py:36] Average training steps per second: 195.80
I0902 23:42:42.671679 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 2

Steps executed: 255 Episode length: 87 Return: 87.0
INFO:tensorflow:Average training steps per second: 207.38
I0902 23:42:47.683138 140608500226048 replay_runner.py:36] Average training steps per second: 207.38
I0902 23:42:47.853315 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 85.00
INFO:tensorflow:Starting iteration 3
I0902 23:42:48.043118 140608500226048 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.07
I0902 23:42:53.118307 140608500226048 replay_runner.py:36] Average training steps per second: 197.07
I0902 23:42:53.238303 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.29
I0902 23:42:58.289705 140608500226048 replay_runner.py:36] Average training steps per second: 205.29
I0902 23:42:58.429829 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:42:58.613252 140608500226048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 195.44
I0902 23:43:03.730243 140608500226048 replay_runner.py:36] Average training steps per second: 195.44
I0902 23:43:03.863636 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:43:04.071406 140608500226048 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 204.50
I0902 23:43:08.961902 140608500226048 replay_runner.py:36] Average training steps per second: 204.50
I0902 23:43:09.233812 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 7

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.03
I0902 23:43:14.508563 140608500226048 replay_runner.py:36] Average training steps per second: 197.03
I0902 23:43:14.750304 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 8


Steps executed: 274 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 195.96
I0902 23:43:20.043766 140608500226048 replay_runner.py:36] Average training steps per second: 195.96
I0902 23:43:20.242051 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 9

Steps executed: 339 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 197.88
I0902 23:43:25.493552 140608500226048 replay_runner.py:36] Average training steps per second: 197.88
I0902 23:43:25.731250 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 10

Steps executed: 269 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 199.69
I0902 23:43:30.930396 140608500226048 replay_runner.py:36] Average training steps per second: 199.69
I0902 23:43:31.108706 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.50
INFO:tensorflow:Starting iteration 11

Steps executed: 339 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 202.25
I0902 23:43:36.243172 140608500226048 replay_runner.py:36] Average training steps per second: 202.25
I0902 23:43:36.460130 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 12

Steps executed: 365 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 202.80
I0902 23:43:41.576384 140608500226048 replay_runner.py:36] Average training steps per second: 202.80
I0902 23:43:41.815851 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 13

Steps executed: 282 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 202.89
I0902 23:43:46.930547 140608500226048 replay_runner.py:36] Average training steps per second: 202.89
I0902 23:43:47.116607 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 14
I0902 23:43:47.305358 140608500226048 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 201.92
I0902 23:43:52.258182 140608500226048 replay_runner.py:36] Average training steps per second: 201.92
I0902 23:43:52.454110 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.50
INFO:tensorflow:Starting iteration 15

Steps executed: 297 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 202.59
I0902 23:43:57.558999 140608500226048 replay_runner.py:36] Average training steps per second: 202.59
I0902 23:43:57.762123 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 16

Steps executed: 308 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 199.04
I0902 23:44:02.978672 140608500226048 replay_runner.py:36] Average training steps per second: 199.04
I0902 23:44:03.113139 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.85
I0902 23:44:08.357215 140608500226048 replay_runner.py:36] Average training steps per second: 197.85
I0902 23:44:08.495153 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:44:08.709801 140608500226048 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 196.80
I0902 23:44:13.791525 140608500226048 replay_runner.py:36] Average training steps per second: 196.80
I0902 23:44:13.929902 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:44:14.113878 140608500226048 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 196.47
I0902 23:44:19.204007 140608500226048 replay_runner.py:36] Average training steps per second: 196.47
I0902 23:44:19.341589 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 181 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 198.50

Steps executed: 381 Episode length: 200 Return: 200.0
I0902 23:44:24.842932 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 21

Steps executed: 326 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 197.25
I0902 23:44:30.098043 140608500226048 replay_runner.py:36] Average training steps per second: 197.25
I0902 23:44:30.332762 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.01
I0902 23:44:35.503498 140608500226048 replay_runner.py:36] Average training steps per second: 201.01
I0902 23:44:35.637283 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:44:35.827352 140608500226048 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 199.08

Steps executed: 352 Episode length: 169 Return: 169.0
I0902 23:44:41.097006 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.99
I0902 23:44:46.479866 140608500226048 replay_runner.py:36] Average training steps per second: 192.99
I0902 23:44:46.616577 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:44:46.810459 140608500226048 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.43
I0902 23:44:51.927754 140608500226048 replay_runner.py:36] Average training steps per second: 195.43
I0902 23:44:52.068289 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:44:52.270923 140608500226048 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.81
I0902 23:44:57.404813 140608500226048 replay_runner.py:36] Average training steps per second: 194.81
I0902 23:44:57.539967 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:44:57.732120 140608500226048 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.64
I0902 23:45:02.923692 140608500226048 replay_runner.py:36] Average training steps per second: 192.64
I0902 23:45:03.059038 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:45:03.251275 140608500226048 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.89
I0902 23:45:08.409386 140608500226048 replay_runner.py:36] Average training steps per second: 193.89
I0902 23:45:08.547877 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:45:08.736231 140608500226048 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 194.29
I0902 23:45:13.883477 140608500226048 replay_runner.py:36] Average training steps per second: 194.29

Done fixed training!Episode length: 200 Return: 200.0