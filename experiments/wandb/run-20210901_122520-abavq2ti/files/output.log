Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 12:25:27.605973 139847227246592 run_experiment.py:549] Creating TrainRunner ...
I0901 12:25:27.616610 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:25:27.616854 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:25:27.616984 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:25:27.617138 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:25:27.617311 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:25:27.617446 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:25:27.617595 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:25:27.617695 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:25:27.617798 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:25:27.617908 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:25:27.618014 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:25:27.618101 139847227246592 dqn_agent.py:283] 	 seed: 1630499127616546
I0901 12:25:27.621081 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:25:27.621280 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:25:27.621409 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:25:27.621528 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:25:27.621613 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:25:27.621717 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:25:27.621814 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:25:27.621936 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:25:27.622050 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:25:27.686705 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:28.154638 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:28.169021 139847227246592 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:25:28.177414 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:25:28.177616 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:25:28.177701 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:25:28.177771 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:25:28.177835 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:25:28.177904 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:25:28.177985 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:25:28.178049 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:25:28.178125 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:25:28.178197 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:25:28.178256 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:25:28.178336 139847227246592 dqn_agent.py:283] 	 seed: 1630499128177348
I0901 12:25:28.180700 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:25:28.180895 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:25:28.181011 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:25:28.181099 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:25:28.181207 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:25:28.181351 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:25:28.181485 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:25:28.181641 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:25:28.181810 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:25:28.216722 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:25:28.237614 139847227246592 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:25:28.237861 139847227246592 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 137.25
I0901 12:25:35.524144 139847227246592 replay_runner.py:36] Average training steps per second: 137.25
I0901 12:25:37.053317 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:25:37.304837 139847227246592 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 188.98
I0901 12:25:42.596580 139847227246592 replay_runner.py:36] Average training steps per second: 188.98
I0901 12:25:43.025179 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:25:43.252629 139847227246592 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.95
I0901 12:25:48.631064 139847227246592 replay_runner.py:36] Average training steps per second: 185.95
I0901 12:25:49.078845 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 340 Episode length: 189 Return: -188.0
INFO:tensorflow:Average training steps per second: 190.16
I0901 12:25:54.586477 139847227246592 replay_runner.py:36] Average training steps per second: 190.16
I0901 12:25:54.903399 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 183.10
I0901 12:26:00.598134 139847227246592 replay_runner.py:36] Average training steps per second: 183.10
I0901 12:26:01.080102 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 281 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 183.43
I0901 12:26:06.788596 139847227246592 replay_runner.py:36] Average training steps per second: 183.43
I0901 12:26:07.057173 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.50
INFO:tensorflow:Starting iteration 6

Steps executed: 263 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 185.42
I0901 12:26:12.710922 139847227246592 replay_runner.py:36] Average training steps per second: 185.42
I0901 12:26:12.954367 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 7

Steps executed: 205 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 183.65
I0901 12:26:18.649851 139847227246592 replay_runner.py:36] Average training steps per second: 183.65
I0901 12:26:18.835333 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 8

Steps executed: 222 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 187.11
I0901 12:26:24.423226 139847227246592 replay_runner.py:36] Average training steps per second: 187.11
I0901 12:26:24.631910 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 9

Steps executed: 236 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 187.19
I0901 12:26:30.226516 139847227246592 replay_runner.py:36] Average training steps per second: 187.19
I0901 12:26:30.457592 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 10

Steps executed: 253 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 185.02
I0901 12:26:36.116165 139847227246592 replay_runner.py:36] Average training steps per second: 185.02
I0901 12:26:36.355614 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 11

Steps executed: 210 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 187.12
I0901 12:26:41.946539 139847227246592 replay_runner.py:36] Average training steps per second: 187.12
I0901 12:26:42.156227 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 12

Steps executed: 247 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 184.13
I0901 12:26:47.843698 139847227246592 replay_runner.py:36] Average training steps per second: 184.13
I0901 12:26:48.064477 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 13

Steps executed: 256 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 166.67
I0901 12:26:54.320876 139847227246592 replay_runner.py:36] Average training steps per second: 166.67
I0901 12:26:54.552659 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.83
I0901 12:27:00.078350 139847227246592 replay_runner.py:36] Average training steps per second: 189.83
I0901 12:27:00.532532 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 227 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 186.84
I0901 12:27:06.140851 139847227246592 replay_runner.py:36] Average training steps per second: 186.84
I0901 12:27:06.351120 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 16
I0901 12:27:06.604948 139847227246592 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 194.72

Steps executed: 273 Episode length: 173 Return: -172.0
I0901 12:27:11.986636 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.50
INFO:tensorflow:Starting iteration 17

Steps executed: 221 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 186.14
I0901 12:27:17.613097 139847227246592 replay_runner.py:36] Average training steps per second: 186.14
I0901 12:27:17.808206 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 18

Steps executed: 241 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 188.04
I0901 12:27:23.385425 139847227246592 replay_runner.py:36] Average training steps per second: 188.04
I0901 12:27:23.611245 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 19

Steps executed: 263 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 189.19
I0901 12:27:29.284792 139847227246592 replay_runner.py:36] Average training steps per second: 189.19
I0901 12:27:29.516306 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 185.89
I0901 12:27:35.125217 139847227246592 replay_runner.py:36] Average training steps per second: 185.89
I0901 12:27:35.323921 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 21

Steps executed: 275 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 184.69
I0901 12:27:40.988877 139847227246592 replay_runner.py:36] Average training steps per second: 184.69
I0901 12:27:41.254086 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 22

Steps executed: 648 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.58
I0901 12:27:46.808348 139847227246592 replay_runner.py:36] Average training steps per second: 188.58
I0901 12:27:47.366831 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.50
INFO:tensorflow:Starting iteration 23

Steps executed: 208 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 200.80
I0901 12:27:52.578735 139847227246592 replay_runner.py:36] Average training steps per second: 200.80
I0901 12:27:52.754615 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 24

Steps executed: 263 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 195.91
I0901 12:27:58.098717 139847227246592 replay_runner.py:36] Average training steps per second: 195.91
I0901 12:27:58.302965 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 25
I0901 12:27:58.538353 139847227246592 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.14

Steps executed: 285 Episode length: 117 Return: -116.0
I0901 12:28:03.917600 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 26

Steps executed: 263 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 197.23
I0901 12:28:09.228841 139847227246592 replay_runner.py:36] Average training steps per second: 197.23
I0901 12:28:09.484144 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 27

Steps executed: 206 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 195.43
I0901 12:28:14.840643 139847227246592 replay_runner.py:36] Average training steps per second: 195.43
I0901 12:28:15.026689 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 28

Steps executed: 273 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 202.64
I0901 12:28:20.202624 139847227246592 replay_runner.py:36] Average training steps per second: 202.64
I0901 12:28:20.429065 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 29

Steps executed: 232 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 206.39
I0901 12:28:25.509022 139847227246592 replay_runner.py:36] Average training steps per second: 206.39

Done fixed training!Episode length: 116 Return: -115.0