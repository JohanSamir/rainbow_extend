Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0901 13:15:30.149704 140298343233536 run_experiment.py:549] Creating TrainRunner ...
I0901 13:15:30.157388 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:30.157508 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:30.157565 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:30.157641 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:30.157688 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:30.157740 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:30.157789 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:30.157860 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:30.157933 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:30.158023 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:30.158090 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:30.158165 140298343233536 dqn_agent.py:283] 	 seed: 1630502130157356
I0901 13:15:30.159821 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:30.159941 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:30.160015 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:30.160077 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:30.160135 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:30.160185 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:30.160284 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:30.160372 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:30.160482 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:30.184949 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:30.453617 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:30.462152 140298343233536 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:15:30.468952 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:30.469128 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:30.469277 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:30.469356 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:30.469421 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:30.469509 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:30.469576 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:30.469670 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:30.469761 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:30.469882 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:30.469985 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:30.470077 140298343233536 dqn_agent.py:283] 	 seed: 1630502130468920
I0901 13:15:30.471972 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:30.472093 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:30.472172 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:30.472235 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:30.472292 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:30.472373 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:30.472439 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:30.472516 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:30.472585 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:30.509976 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:30.533668 140298343233536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:15:30.533881 140298343233536 replay_runner.py:41] Starting iteration 0
Steps executed: 339 Episode length: 149 Return: -244.47254484831294
INFO:tensorflow:Average training steps per second: 240.67
I0901 13:15:34.689401 140298343233536 replay_runner.py:36] Average training steps per second: 240.67
I0901 13:15:35.536509 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.19
INFO:tensorflow:Starting iteration 1

Steps executed: 349 Episode length: 153 Return: -456.08428696491585
INFO:tensorflow:Average training steps per second: 347.63
I0901 13:15:41.770247 140298343233536 replay_runner.py:36] Average training steps per second: 347.63
I0901 13:15:41.983930 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.78
INFO:tensorflow:Starting iteration 2

Steps executed: 245 Episode length: 115 Return: -296.62303100115725
INFO:tensorflow:Average training steps per second: 352.20
I0901 13:15:47.974851 140298343233536 replay_runner.py:36] Average training steps per second: 352.20
I0901 13:15:48.134936 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.28
INFO:tensorflow:Starting iteration 3

Steps executed: 317 Episode length: 129 Return: -371.71535389239965
INFO:tensorflow:Average training steps per second: 339.57
I0901 13:15:54.544656 140298343233536 replay_runner.py:36] Average training steps per second: 339.57
I0901 13:15:54.724841 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.93
INFO:tensorflow:Starting iteration 4

Steps executed: 263 Episode length: 74 Return: -4.96513267100232384
INFO:tensorflow:Average training steps per second: 330.27
I0901 13:16:01.245241 140298343233536 replay_runner.py:36] Average training steps per second: 330.27
I0901 13:16:01.374503 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.47
INFO:tensorflow:Starting iteration 5
I0901 13:16:04.818480 140298343233536 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 326.49

Steps executed: 428 Episode length: 340 Return: 252.152969246284284
I0901 13:16:08.209414 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -4.33
INFO:tensorflow:Starting iteration 6

Steps executed: 293 Episode length: 141 Return: -330.18902876561874
INFO:tensorflow:Average training steps per second: 323.44
I0901 13:16:14.667276 140298343233536 replay_runner.py:36] Average training steps per second: 323.44
I0901 13:16:14.816550 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.29
INFO:tensorflow:Starting iteration 7

Steps executed: 326 Episode length: 127 Return: 14.1691179921515844
INFO:tensorflow:Average training steps per second: 326.35
I0901 13:16:21.271519 140298343233536 replay_runner.py:36] Average training steps per second: 326.35
I0901 13:16:21.436158 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.29
INFO:tensorflow:Starting iteration 8

Steps executed: 89 Episode length: 89 Return: -265.3530098592746644
INFO:tensorflow:Average training steps per second: 325.24

Steps executed: 269 Episode length: 129 Return: -295.55126734307174
I0901 13:16:28.116385 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.28
INFO:tensorflow:Starting iteration 9

Steps executed: 275 Episode length: 88 Return: -327.652588027872874
INFO:tensorflow:Average training steps per second: 327.66
I0901 13:16:34.606632 140298343233536 replay_runner.py:36] Average training steps per second: 327.66
I0901 13:16:34.715809 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.89
INFO:tensorflow:Starting iteration 10

Steps executed: 254 Episode length: 61 Return: -174.448904143779694
INFO:tensorflow:Average training steps per second: 326.92
I0901 13:16:41.219394 140298343233536 replay_runner.py:36] Average training steps per second: 326.92
I0901 13:16:41.314738 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.27
INFO:tensorflow:Starting iteration 11

Steps executed: 290 Episode length: 97 Return: -106.361743139493264
INFO:tensorflow:Average training steps per second: 325.63
I0901 13:16:47.801259 140298343233536 replay_runner.py:36] Average training steps per second: 325.63
I0901 13:16:47.982974 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.29
INFO:tensorflow:Starting iteration 12

Steps executed: 250 Episode length: 53 Return: -299.333520047236944
INFO:tensorflow:Average training steps per second: 322.65
I0901 13:16:54.493990 140298343233536 replay_runner.py:36] Average training steps per second: 322.65
I0901 13:16:54.600108 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.93
INFO:tensorflow:Starting iteration 13

Steps executed: 297 Episode length: 121 Return: -55.855469313877333
INFO:tensorflow:Average training steps per second: 314.00
I0901 13:17:01.168413 140298343233536 replay_runner.py:36] Average training steps per second: 314.00
I0901 13:17:01.349566 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.02
INFO:tensorflow:Starting iteration 14

Steps executed: 255 Episode length: 84 Return: -284.396616956859643
INFO:tensorflow:Average training steps per second: 304.54
I0901 13:17:08.008091 140298343233536 replay_runner.py:36] Average training steps per second: 304.54
I0901 13:17:08.141951 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.40
INFO:tensorflow:Starting iteration 15

Steps executed: 279 Episode length: 93 Return: -167.958036053707137
INFO:tensorflow:Average training steps per second: 314.32
I0901 13:17:14.752278 140298343233536 replay_runner.py:36] Average training steps per second: 314.32
I0901 13:17:14.874244 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.56
INFO:tensorflow:Starting iteration 16

Steps executed: 360 Episode length: 287 Return: -1537.7442179401799
INFO:tensorflow:Average training steps per second: 318.03
I0901 13:17:21.430323 140298343233536 replay_runner.py:36] Average training steps per second: 318.03
I0901 13:17:21.700394 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -1073.06
INFO:tensorflow:Starting iteration 17

Steps executed: 239 Episode length: 115 Return: -641.83713415328389
INFO:tensorflow:Average training steps per second: 324.51
I0901 13:17:28.191166 140298343233536 replay_runner.py:36] Average training steps per second: 324.51
I0901 13:17:28.350739 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.47
INFO:tensorflow:Starting iteration 18

Steps executed: 279 Episode length: 85 Return: -635.938569385348289
INFO:tensorflow:Average training steps per second: 323.40
I0901 13:17:34.851989 140298343233536 replay_runner.py:36] Average training steps per second: 323.40
I0901 13:17:35.017473 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.01
INFO:tensorflow:Starting iteration 19

Steps executed: 248 Episode length: 61 Return: -476.687615964861289
INFO:tensorflow:Average training steps per second: 313.24
I0901 13:17:41.626325 140298343233536 replay_runner.py:36] Average training steps per second: 313.24
I0901 13:17:41.768505 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.31
INFO:tensorflow:Starting iteration 20

Steps executed: 220 Episode length: 85 Return: -344.648246223773079
INFO:tensorflow:Average training steps per second: 324.93
I0901 13:17:48.257472 140298343233536 replay_runner.py:36] Average training steps per second: 324.93
I0901 13:17:48.376183 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.91
INFO:tensorflow:Starting iteration 21

Steps executed: 308 Episode length: 159 Return: -241.95780871898708
INFO:tensorflow:Average training steps per second: 331.05
I0901 13:17:54.815542 140298343233536 replay_runner.py:36] Average training steps per second: 331.05
I0901 13:17:54.985510 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.88
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 52 Return: -346.744615512127208
INFO:tensorflow:Average training steps per second: 331.05
I0901 13:18:01.475685 140298343233536 replay_runner.py:36] Average training steps per second: 331.05
I0901 13:18:01.616758 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -554.49
INFO:tensorflow:Starting iteration 23

Steps executed: 67 Episode length: 67 Return: -140.9907066667572608
INFO:tensorflow:Average training steps per second: 328.18

Steps executed: 270 Episode length: 79 Return: -689.853401200541448
I0901 13:18:08.294745 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -576.10
INFO:tensorflow:Starting iteration 24

Steps executed: 255 Episode length: 58 Return: -261.017108797614478
INFO:tensorflow:Average training steps per second: 327.26
I0901 13:18:14.814993 140298343233536 replay_runner.py:36] Average training steps per second: 327.26
I0901 13:18:14.966823 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.61
INFO:tensorflow:Starting iteration 25

Steps executed: 202 Episode length: 106 Return: -321.70889119960688
INFO:tensorflow:Average training steps per second: 331.68
I0901 13:18:21.446924 140298343233536 replay_runner.py:36] Average training steps per second: 331.68
I0901 13:18:21.571735 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.41
INFO:tensorflow:Starting iteration 26

Steps executed: 251 Episode length: 52 Return: -354.697835932137238
INFO:tensorflow:Average training steps per second: 328.29
I0901 13:18:28.100665 140298343233536 replay_runner.py:36] Average training steps per second: 328.29
I0901 13:18:28.245248 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -452.35
INFO:tensorflow:Starting iteration 27

Steps executed: 223 Episode length: 106 Return: -659.69000354157378
INFO:tensorflow:Average training steps per second: 337.93
I0901 13:18:34.639627 140298343233536 replay_runner.py:36] Average training steps per second: 337.93
I0901 13:18:34.786238 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -845.79
INFO:tensorflow:Starting iteration 28

Steps executed: 366 Episode length: 181 Return: -373.26380530552507
INFO:tensorflow:Average training steps per second: 336.71
I0901 13:18:41.217930 140298343233536 replay_runner.py:36] Average training steps per second: 336.71
I0901 13:18:41.448818 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.39
INFO:tensorflow:Starting iteration 29

Steps executed: 230 Episode length: 81 Return: -753.628240802643407
INFO:tensorflow:Average training steps per second: 344.42
I0901 13:18:47.773996 140298343233536 replay_runner.py:36] Average training steps per second: 344.42

Done fixed training!Episode length: 81 Return: -753.628240802643407