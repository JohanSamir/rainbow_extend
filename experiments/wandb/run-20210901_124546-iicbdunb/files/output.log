Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0901 12:45:53.136675 140536266098688 run_experiment.py:549] Creating TrainRunner ...
I0901 12:45:53.148068 140536266098688 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:45:53.148359 140536266098688 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:45:53.148513 140536266098688 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:45:53.148648 140536266098688 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:45:53.148769 140536266098688 dqn_agent.py:275] 	 update_period: 4
I0901 12:45:53.148864 140536266098688 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:45:53.148990 140536266098688 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:45:53.149071 140536266098688 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:45:53.149138 140536266098688 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:45:53.149203 140536266098688 dqn_agent.py:280] 	 optimizer: adam
I0901 12:45:53.149267 140536266098688 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:45:53.149329 140536266098688 dqn_agent.py:283] 	 seed: 1630500353148006
I0901 12:45:53.152083 140536266098688 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:45:53.152316 140536266098688 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:45:53.152489 140536266098688 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:45:53.152628 140536266098688 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:45:53.152731 140536266098688 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:45:53.152803 140536266098688 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:45:53.152875 140536266098688 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:45:53.152939 140536266098688 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:45:53.153001 140536266098688 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:45:53.194161 140536266098688 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:53.614922 140536266098688 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:53.655491 140536266098688 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:45:53.666701 140536266098688 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:45:53.667015 140536266098688 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:45:53.667460 140536266098688 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:45:53.667641 140536266098688 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:45:53.667763 140536266098688 dqn_agent.py:275] 	 update_period: 4
I0901 12:45:53.667916 140536266098688 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:45:53.668180 140536266098688 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:45:53.668366 140536266098688 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:45:53.668606 140536266098688 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:45:53.668946 140536266098688 dqn_agent.py:280] 	 optimizer: adam
I0901 12:45:53.669110 140536266098688 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:45:53.669200 140536266098688 dqn_agent.py:283] 	 seed: 1630500353666648
I0901 12:45:53.672277 140536266098688 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:45:53.672523 140536266098688 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:45:53.672685 140536266098688 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:45:53.672886 140536266098688 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:45:53.673158 140536266098688 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:45:53.673658 140536266098688 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:45:53.673867 140536266098688 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:45:53.674021 140536266098688 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:45:53.674256 140536266098688 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:45:53.709971 140536266098688 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:53.732175 140536266098688 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:45:53.732573 140536266098688 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 154.34
I0901 12:46:00.212270 140536266098688 replay_runner.py:36] Average training steps per second: 154.34
Steps executed: 276 Episode length: 94 Return: -559.8253634063376
I0901 12:46:01.489312 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -536.31
INFO:tensorflow:Starting iteration 1

Steps executed: 155 Episode length: 155 Return: -286.0194860395036
INFO:tensorflow:Average training steps per second: 215.76

Steps executed: 242 Episode length: 87 Return: -659.00751892776256
I0901 12:46:10.797368 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -472.51
INFO:tensorflow:Starting iteration 2

Steps executed: 321 Episode length: 185 Return: -47.45180691081376
INFO:tensorflow:Average training steps per second: 226.44
I0901 12:46:19.472533 140536266098688 replay_runner.py:36] Average training steps per second: 226.44
I0901 12:46:19.763566 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.83
INFO:tensorflow:Starting iteration 3

Steps executed: 214 Episode length: 107 Return: -180.70165738072484
INFO:tensorflow:Average training steps per second: 230.20
I0901 12:46:28.525875 140536266098688 replay_runner.py:36] Average training steps per second: 230.20
I0901 12:46:28.712917 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.59
INFO:tensorflow:Starting iteration 4

Steps executed: 209 Episode length: 83 Return: -318.223616005075985
INFO:tensorflow:Average training steps per second: 222.36
I0901 12:46:37.455342 140536266098688 replay_runner.py:36] Average training steps per second: 222.36
I0901 12:46:37.629692 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.18
INFO:tensorflow:Starting iteration 5

Steps executed: 246 Episode length: 113 Return: -187.88641394417218
INFO:tensorflow:Average training steps per second: 221.47
I0901 12:46:46.397811 140536266098688 replay_runner.py:36] Average training steps per second: 221.47
I0901 12:46:46.617398 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.81
INFO:tensorflow:Starting iteration 6

Steps executed: 217 Episode length: 92 Return: -376.194092251150272
INFO:tensorflow:Average training steps per second: 224.56
I0901 12:46:55.462757 140536266098688 replay_runner.py:36] Average training steps per second: 224.56
I0901 12:46:55.651305 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.23
INFO:tensorflow:Starting iteration 7

Steps executed: 330 Episode length: 140 Return: -230.50689421016548
INFO:tensorflow:Average training steps per second: 219.94
I0901 12:47:04.504039 140536266098688 replay_runner.py:36] Average training steps per second: 219.94
I0901 12:47:04.799924 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.42
INFO:tensorflow:Starting iteration 8

Steps executed: 289 Episode length: 129 Return: -303.10018464100318
INFO:tensorflow:Average training steps per second: 228.48
I0901 12:47:13.602480 140536266098688 replay_runner.py:36] Average training steps per second: 228.48
I0901 12:47:13.841245 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.95
INFO:tensorflow:Starting iteration 9

Steps executed: 264 Episode length: 116 Return: -245.33609362182728
INFO:tensorflow:Average training steps per second: 222.71
I0901 12:47:22.794601 140536266098688 replay_runner.py:36] Average training steps per second: 222.71
I0901 12:47:23.037896 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.18
INFO:tensorflow:Starting iteration 10

Steps executed: 222 Episode length: 71 Return: -252.304354467006997
INFO:tensorflow:Average training steps per second: 230.76
I0901 12:47:31.772502 140536266098688 replay_runner.py:36] Average training steps per second: 230.76
I0901 12:47:31.956002 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.83
INFO:tensorflow:Starting iteration 11

Steps executed: 245 Episode length: 108 Return: -63.693091709162914
INFO:tensorflow:Average training steps per second: 225.22
I0901 12:47:40.709875 140536266098688 replay_runner.py:36] Average training steps per second: 225.22
I0901 12:47:40.902714 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.64
INFO:tensorflow:Starting iteration 12

Steps executed: 230 Episode length: 74 Return: -244.475420841100154
INFO:tensorflow:Average training steps per second: 224.09
I0901 12:47:49.672504 140536266098688 replay_runner.py:36] Average training steps per second: 224.09
I0901 12:47:49.829144 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.42
INFO:tensorflow:Starting iteration 13

Steps executed: 227 Episode length: 227 Return: -154.70055513886916
INFO:tensorflow:Average training steps per second: 222.13
I0901 12:47:58.693042 140536266098688 replay_runner.py:36] Average training steps per second: 222.13
I0901 12:47:58.952943 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.70
INFO:tensorflow:Starting iteration 14

Steps executed: 123 Episode length: 55 Return: -62.4226697711638716
INFO:tensorflow:Average training steps per second: 221.45

Steps executed: 1123 Episode length: 1000 Return: -15.641413315772812
I0901 12:48:11.077715 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.50
INFO:tensorflow:Starting iteration 15

Steps executed: 537 Episode length: 398 Return: -184.2544208745880512
INFO:tensorflow:Average training steps per second: 222.11
I0901 12:48:20.015099 140536266098688 replay_runner.py:36] Average training steps per second: 222.11
I0901 12:48:20.764986 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.58
INFO:tensorflow:Starting iteration 16

Steps executed: 224 Episode length: 224 Return: -294.4191973457441512
INFO:tensorflow:Average training steps per second: 222.85
I0901 12:48:29.694786 140536266098688 replay_runner.py:36] Average training steps per second: 222.85
I0901 12:48:29.946616 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.42
INFO:tensorflow:Starting iteration 17
I0901 12:48:34.332283 140536266098688 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 217.34
I0901 12:48:38.933789 140536266098688 replay_runner.py:36] Average training steps per second: 217.34

Steps executed: 281 Episode length: 180 Return: -298.5753614893063512
INFO:tensorflow:Starting iteration 18

Steps executed: 268 Episode length: 80 Return: -404.08907590554254512
INFO:tensorflow:Average training steps per second: 222.13
I0901 12:48:47.998903 140536266098688 replay_runner.py:36] Average training steps per second: 222.13
I0901 12:48:48.189605 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.43
INFO:tensorflow:Starting iteration 19

Steps executed: 262 Episode length: 64 Return: -116.68437967099474512
INFO:tensorflow:Average training steps per second: 226.82
I0901 12:48:56.932421 140536266098688 replay_runner.py:36] Average training steps per second: 226.82
I0901 12:48:57.102621 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.97
INFO:tensorflow:Starting iteration 20

Steps executed: 238 Episode length: 61 Return: -445.69673674961574512
INFO:tensorflow:Average training steps per second: 222.19
I0901 12:49:06.010402 140536266098688 replay_runner.py:36] Average training steps per second: 222.19
I0901 12:49:06.235333 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.63
INFO:tensorflow:Starting iteration 21

Steps executed: 212 Episode length: 73 Return: -378.80854182619234512
INFO:tensorflow:Average training steps per second: 219.47
I0901 12:49:15.024702 140536266098688 replay_runner.py:36] Average training steps per second: 219.47
I0901 12:49:15.187041 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -422.42
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 57 Return: -343.69812151749643512
INFO:tensorflow:Average training steps per second: 233.42
I0901 12:49:23.743510 140536266098688 replay_runner.py:36] Average training steps per second: 233.42
I0901 12:49:23.952547 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -433.78
INFO:tensorflow:Starting iteration 23

Steps executed: 288 Episode length: 91 Return: -651.41244824714247512
INFO:tensorflow:Average training steps per second: 229.84
I0901 12:49:32.619769 140536266098688 replay_runner.py:36] Average training steps per second: 229.84
I0901 12:49:32.849950 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -648.49
INFO:tensorflow:Starting iteration 24

Steps executed: 205 Episode length: 59 Return: -47.696945883888893512
INFO:tensorflow:Average training steps per second: 216.79
I0901 12:49:41.728408 140536266098688 replay_runner.py:36] Average training steps per second: 216.79
I0901 12:49:41.900915 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.12
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 54 Return: -427.42474639141864512
INFO:tensorflow:Average training steps per second: 222.80
I0901 12:49:50.542333 140536266098688 replay_runner.py:36] Average training steps per second: 222.80
I0901 12:49:50.726272 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.07
INFO:tensorflow:Starting iteration 26

Steps executed: 145 Episode length: 88 Return: -125.73486278652486512
INFO:tensorflow:Average training steps per second: 233.78
I0901 12:49:59.385638 140536266098688 replay_runner.py:36] Average training steps per second: 233.78

Steps executed: 234 Episode length: 89 Return: -379.21066432235096512
INFO:tensorflow:Starting iteration 27

Steps executed: 214 Episode length: 77 Return: -593.59338869657653512
INFO:tensorflow:Average training steps per second: 222.95
I0901 12:50:08.392029 140536266098688 replay_runner.py:36] Average training steps per second: 222.95
I0901 12:50:08.589558 140536266098688 run_experiment.py:428] Average undiscounted return per evaluation episode: -551.48
INFO:tensorflow:Starting iteration 28

Steps executed: 183 Episode length: 65 Return: -598.58829525422553512
INFO:tensorflow:Average training steps per second: 222.33
I0901 12:50:17.448628 140536266098688 replay_runner.py:36] Average training steps per second: 222.33

Steps executed: 249 Episode length: 66 Return: -570.31058990237633512
INFO:tensorflow:Starting iteration 29

Steps executed: 241 Episode length: 85 Return: -707.50454906035773512
INFO:tensorflow:Average training steps per second: 226.59
I0901 12:50:26.400730 140536266098688 replay_runner.py:36] Average training steps per second: 226.59

Done fixed training!Episode length: 85 Return: -707.50454906035773512