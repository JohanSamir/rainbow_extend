Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 16:38:25.181585 139967707396096 run_experiment.py:549] Creating TrainRunner ...
I0905 16:38:25.187976 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:38:25.188088 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:38:25.188140 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:38:25.188218 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:38:25.188260 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:38:25.188336 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:38:25.188414 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:38:25.188499 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:38:25.188549 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:38:25.188635 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:38:25.188684 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:38:25.188740 139967707396096 dqn_agent.py:283] 	 seed: 1630859905187944
I0905 16:38:25.190322 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:38:25.190419 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:38:25.190473 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:38:25.190521 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:38:25.190583 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:38:25.190624 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:38:25.190705 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:38:25.190823 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:38:25.190888 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:38:26.242704 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:26.469355 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:26.476966 139967707396096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:38:26.482466 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:38:26.482593 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:38:26.482673 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:38:26.482734 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:38:26.482789 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:38:26.482864 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:38:26.482953 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:38:26.483021 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:38:26.483084 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:38:26.483142 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:38:26.483217 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:38:26.483291 139967707396096 dqn_agent.py:283] 	 seed: 1630859906482439
I0905 16:38:26.484723 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:38:26.484835 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:38:26.484947 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:38:26.485027 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:38:26.485120 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:38:26.485177 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:38:26.485229 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:38:26.485368 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:38:26.485493 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:38:26.504138 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:38:26.517721 139967707396096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:38:26.517870 139967707396096 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 250.50
I0905 16:38:30.510044 139967707396096 replay_runner.py:36] Average training steps per second: 250.50
Steps executed: 307 Episode length: 121 Return: -271.51211537394653
I0905 16:38:31.411203 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.33
INFO:tensorflow:Starting iteration 1

Steps executed: 252 Episode length: 143 Return: -367.14057293116304
INFO:tensorflow:Average training steps per second: 349.74
I0905 16:38:37.558708 139967707396096 replay_runner.py:36] Average training steps per second: 349.74
I0905 16:38:37.713093 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.33
INFO:tensorflow:Starting iteration 2

Steps executed: 252 Episode length: 120 Return: -210.95486067552913
INFO:tensorflow:Average training steps per second: 349.42
I0905 16:38:44.035027 139967707396096 replay_runner.py:36] Average training steps per second: 349.42
I0905 16:38:44.173619 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.71
INFO:tensorflow:Starting iteration 3

Steps executed: 355 Episode length: 355 Return: -89.597322123838643
INFO:tensorflow:Average training steps per second: 351.52
I0905 16:38:50.407435 139967707396096 replay_runner.py:36] Average training steps per second: 351.52
I0905 16:38:50.783166 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.60
INFO:tensorflow:Starting iteration 4
I0905 16:38:54.168131 139967707396096 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 347.55
I0905 16:38:57.045808 139967707396096 replay_runner.py:36] Average training steps per second: 347.55

Steps executed: 1000 Episode length: 1000 Return: -120.06676898855225
INFO:tensorflow:Starting iteration 5
I0905 16:39:02.234094 139967707396096 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 356.04

Steps executed: 1000 Episode length: 1000 Return: -140.81697743898465
I0905 16:39:07.334094 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.82
INFO:tensorflow:Starting iteration 6

Steps executed: 452 Episode length: 452 Return: -249.0460092760696465
INFO:tensorflow:Average training steps per second: 371.80
I0905 16:39:13.399986 139967707396096 replay_runner.py:36] Average training steps per second: 371.80
I0905 16:39:13.842659 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.05
INFO:tensorflow:Starting iteration 7

Steps executed: 583 Episode length: 583 Return: -399.6526931911957465
INFO:tensorflow:Average training steps per second: 373.82
I0905 16:39:20.016968 139967707396096 replay_runner.py:36] Average training steps per second: 373.82
I0905 16:39:20.604172 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.65
INFO:tensorflow:Starting iteration 8
I0905 16:39:24.117770 139967707396096 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 366.14

Steps executed: 360 Episode length: 360 Return: -327.4179346924467465
I0905 16:39:27.138654 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.42
INFO:tensorflow:Starting iteration 9

Steps executed: 561 Episode length: 363 Return: -346.5325602001261465
INFO:tensorflow:Average training steps per second: 329.65
I0905 16:39:33.505340 139967707396096 replay_runner.py:36] Average training steps per second: 329.65
I0905 16:39:33.971373 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.42
INFO:tensorflow:Starting iteration 10

Steps executed: 430 Episode length: 430 Return: -271.5399084870425765
INFO:tensorflow:Average training steps per second: 330.42
I0905 16:39:40.239649 139967707396096 replay_runner.py:36] Average training steps per second: 330.42
I0905 16:39:40.710188 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.54
INFO:tensorflow:Starting iteration 11

Steps executed: 167 Episode length: 167 Return: -51.87565909372026765
INFO:tensorflow:Average training steps per second: 341.30

Steps executed: 954 Episode length: 787 Return: -479.9347746959084765
I0905 16:39:48.077956 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.91
INFO:tensorflow:Starting iteration 12
I0905 16:39:51.379809 139967707396096 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 335.72

Steps executed: 1000 Episode length: 1000 Return: -64.211934102829495
I0905 16:39:56.662120 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.21
INFO:tensorflow:Starting iteration 13

Steps executed: 208 Episode length: 208 Return: -92.41138910170582495
INFO:tensorflow:Average training steps per second: 336.80
I0905 16:40:02.977707 139967707396096 replay_runner.py:36] Average training steps per second: 336.80
I0905 16:40:03.110736 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.41
INFO:tensorflow:Starting iteration 14
I0905 16:40:06.456285 139967707396096 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 339.35

Steps executed: 1000 Episode length: 1000 Return: -7.0629212206952275
I0905 16:40:11.473156 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -7.06
INFO:tensorflow:Starting iteration 15

Steps executed: 412 Episode length: 412 Return: -129.3199261473408275
INFO:tensorflow:Average training steps per second: 365.02
I0905 16:40:17.686214 139967707396096 replay_runner.py:36] Average training steps per second: 365.02
I0905 16:40:18.138104 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.32
INFO:tensorflow:Starting iteration 16

Steps executed: 404 Episode length: 404 Return: -110.7811866186675375
INFO:tensorflow:Average training steps per second: 347.61
I0905 16:40:24.452527 139967707396096 replay_runner.py:36] Average training steps per second: 347.61
I0905 16:40:24.840870 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.78
INFO:tensorflow:Starting iteration 17
I0905 16:40:28.224627 139967707396096 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 335.50
I0905 16:40:31.205961 139967707396096 replay_runner.py:36] Average training steps per second: 335.50

Steps executed: 339 Episode length: 339 Return: -37.73788423446122375
INFO:tensorflow:Starting iteration 18
I0905 16:40:34.904346 139967707396096 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 336.89

Steps executed: 935 Episode length: 935 Return: -124.8258896322732575
I0905 16:40:39.601774 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.83
INFO:tensorflow:Starting iteration 19

Steps executed: 330 Episode length: 137 Return: -68.63434720049572575
INFO:tensorflow:Average training steps per second: 335.01
I0905 16:40:45.937736 139967707396096 replay_runner.py:36] Average training steps per second: 335.01
I0905 16:40:46.141724 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.17
INFO:tensorflow:Starting iteration 20

Steps executed: 332 Episode length: 332 Return: -7.216879557528813575
INFO:tensorflow:Average training steps per second: 323.88
I0905 16:40:52.449618 139967707396096 replay_runner.py:36] Average training steps per second: 323.88
I0905 16:40:52.814331 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -7.22
INFO:tensorflow:Starting iteration 21
I0905 16:40:56.072735 139967707396096 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 322.60

Steps executed: 1000 Episode length: 1000 Return: -57.777483663661475
I0905 16:41:01.921713 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.78
INFO:tensorflow:Starting iteration 22
I0905 16:41:05.237147 139967707396096 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 322.69

Steps executed: 619 Episode length: 619 Return: 160.04883739485518475
I0905 16:41:09.298821 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.05
INFO:tensorflow:Starting iteration 23

Steps executed: 394 Episode length: 270 Return: -24.38629713807866475
INFO:tensorflow:Average training steps per second: 326.26
I0905 16:41:15.670423 139967707396096 replay_runner.py:36] Average training steps per second: 326.26
I0905 16:41:15.928527 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.24
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 206 Return: -1.954768787294384475
INFO:tensorflow:Average training steps per second: 323.70
I0905 16:41:22.307580 139967707396096 replay_runner.py:36] Average training steps per second: 323.70
I0905 16:41:22.485425 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -1.95
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 91 Return: -2.8863602644338897575
INFO:tensorflow:Average training steps per second: 344.93
I0905 16:41:28.726413 139967707396096 replay_runner.py:36] Average training steps per second: 344.93
I0905 16:41:28.863050 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.54
INFO:tensorflow:Starting iteration 26

Steps executed: 261 Episode length: 261 Return: -298.4872847585471675
INFO:tensorflow:Average training steps per second: 353.15
I0905 16:41:35.019109 139967707396096 replay_runner.py:36] Average training steps per second: 353.15
I0905 16:41:35.211687 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.49
INFO:tensorflow:Starting iteration 27

Steps executed: 317 Episode length: 161 Return: -3.200258540002949675
INFO:tensorflow:Average training steps per second: 344.96
I0905 16:41:41.511123 139967707396096 replay_runner.py:36] Average training steps per second: 344.96
I0905 16:41:41.707498 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.52
INFO:tensorflow:Starting iteration 28

Steps executed: 209 Episode length: 209 Return: 6.2317107728108949675
INFO:tensorflow:Average training steps per second: 328.03
I0905 16:41:48.265270 139967707396096 replay_runner.py:36] Average training steps per second: 328.03
I0905 16:41:48.418544 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: 6.23
INFO:tensorflow:Starting iteration 29
I0905 16:41:51.996445 139967707396096 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 310.27

Steps executed: 1000 Episode length: 1000 Return: 119.187274700526345

Done fixed training! Episode length: 1000 Return: 119.187274700526345