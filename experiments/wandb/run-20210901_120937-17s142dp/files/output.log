I0901 12:09:44.305590 140583573075968 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 12:09:44.306212 140583573075968 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 12:09:44.390737 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:44.391841 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:44.391932 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:44.391995 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:44.392051 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:44.392138 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:09:44.392271 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:44.392371 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:44.392435 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:44.392535 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:44.392620 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:44.392696 140583573075968 dqn_agent.py:283] 	 seed: 1630498184390679
I0901 12:09:44.394599 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:44.394787 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:09:44.394870 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:44.394934 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:44.395009 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:44.395090 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:44.395204 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:44.395302 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:44.395389 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 12:09:45.963403 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.342246 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.351502 140583573075968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:09:46.355482 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:46.355627 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:46.355708 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:46.355776 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:46.355847 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:46.355910 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:09:46.356009 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:46.356100 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:46.356202 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:46.356280 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:46.356341 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:46.356422 140583573075968 dqn_agent.py:283] 	 seed: 1630498186355448
I0901 12:09:46.358055 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:46.358218 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:09:46.358320 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:46.358412 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:46.358518 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:46.358583 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:46.358660 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:46.358734 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:46.358795 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.380567 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.393344 140583573075968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:09:46.393529 140583573075968 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.65
I0901 12:09:53.121665 140583573075968 replay_runner.py:36] Average training steps per second: 148.65
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:09:54.166614 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:09:54.392243 140583573075968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 188.74
I0901 12:09:59.691223 140583573075968 replay_runner.py:36] Average training steps per second: 188.74
I0901 12:10:00.150909 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:10:00.417325 140583573075968 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.36
I0901 12:10:05.616487 140583573075968 replay_runner.py:36] Average training steps per second: 192.36
I0901 12:10:06.004866 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 277 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 181.89
I0901 12:10:11.747264 140583573075968 replay_runner.py:36] Average training steps per second: 181.89
I0901 12:10:11.989019 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.33
INFO:tensorflow:Starting iteration 4

Steps executed: 251 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 211.24
I0901 12:10:16.971971 140583573075968 replay_runner.py:36] Average training steps per second: 211.24
I0901 12:10:17.211048 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.60
I0901 12:10:22.734031 140583573075968 replay_runner.py:36] Average training steps per second: 189.60
I0901 12:10:23.115232 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:10:23.337354 140583573075968 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 191.90
I0901 12:10:28.548716 140583573075968 replay_runner.py:36] Average training steps per second: 191.90
I0901 12:10:29.010594 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:10:29.265631 140583573075968 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 203.53

Steps executed: 489 Episode length: 489 Return: -488.0
I0901 12:10:34.553968 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.00
INFO:tensorflow:Starting iteration 8
I0901 12:10:34.776454 140583573075968 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 184.14

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:10:40.579135 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:10:40.811702 140583573075968 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.67
I0901 12:10:45.896869 140583573075968 replay_runner.py:36] Average training steps per second: 196.67
I0901 12:10:46.340644 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 248 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 197.51
I0901 12:10:51.636766 140583573075968 replay_runner.py:36] Average training steps per second: 197.51
I0901 12:10:51.817595 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.80
I0901 12:10:57.345054 140583573075968 replay_runner.py:36] Average training steps per second: 188.80
I0901 12:10:57.806430 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:10:58.042239 140583573075968 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 203.11
I0901 12:11:02.965949 140583573075968 replay_runner.py:36] Average training steps per second: 203.11
I0901 12:11:03.424139 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 12:11:03.683493 140583573075968 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 196.25
I0901 12:11:08.779811 140583573075968 replay_runner.py:36] Average training steps per second: 196.25
I0901 12:11:09.163051 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 12:11:09.393990 140583573075968 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 193.31
I0901 12:11:14.567747 140583573075968 replay_runner.py:36] Average training steps per second: 193.31
I0901 12:11:15.025054 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 12:11:15.289404 140583573075968 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 201.51
I0901 12:11:20.252487 140583573075968 replay_runner.py:36] Average training steps per second: 201.51
I0901 12:11:20.669799 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:11:20.915389 140583573075968 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 190.56
I0901 12:11:26.163872 140583573075968 replay_runner.py:36] Average training steps per second: 190.56
I0901 12:11:26.551247 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 12:11:26.779901 140583573075968 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 201.22
I0901 12:11:31.750324 140583573075968 replay_runner.py:36] Average training steps per second: 201.22
I0901 12:11:32.214407 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 12:11:32.477797 140583573075968 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 199.00
I0901 12:11:37.503435 140583573075968 replay_runner.py:36] Average training steps per second: 199.00
I0901 12:11:37.887821 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0901 12:11:38.128926 140583573075968 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 186.94
I0901 12:11:43.478682 140583573075968 replay_runner.py:36] Average training steps per second: 186.94
I0901 12:11:43.872931 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 249 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 205.33
I0901 12:11:48.976390 140583573075968 replay_runner.py:36] Average training steps per second: 205.33
I0901 12:11:49.207426 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.84
I0901 12:11:54.620679 140583573075968 replay_runner.py:36] Average training steps per second: 193.84
I0901 12:11:55.002474 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 12:11:55.233507 140583573075968 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.67
I0901 12:12:00.397211 140583573075968 replay_runner.py:36] Average training steps per second: 193.67
I0901 12:12:00.852380 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 12:12:01.106927 140583573075968 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 201.70
I0901 12:12:06.065439 140583573075968 replay_runner.py:36] Average training steps per second: 201.70
I0901 12:12:06.499323 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 12:12:06.752511 140583573075968 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 187.31
I0901 12:12:12.092295 140583573075968 replay_runner.py:36] Average training steps per second: 187.31
I0901 12:12:12.509589 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 198.24
I0901 12:12:17.795014 140583573075968 replay_runner.py:36] Average training steps per second: 198.24
I0901 12:12:18.023655 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.15
I0901 12:12:23.330247 140583573075968 replay_runner.py:36] Average training steps per second: 198.15
I0901 12:12:23.736654 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 237 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 184.43
I0901 12:12:29.399445 140583573075968 replay_runner.py:36] Average training steps per second: 184.43
I0901 12:12:29.606569 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 28

Steps executed: 137 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 211.65

Steps executed: 264 Episode length: 127 Return: -126.0
I0901 12:12:34.765230 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 217.18
I0901 12:12:39.596554 140583573075968 replay_runner.py:36] Average training steps per second: 217.18
I0901 12:12:39.951857 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00