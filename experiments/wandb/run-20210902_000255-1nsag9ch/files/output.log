Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0902 00:03:01.977547 140268994136064 run_experiment.py:549] Creating TrainRunner ...
I0902 00:03:01.986869 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:03:01.987210 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:03:01.987435 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:03:01.987573 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:03:01.987691 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0902 00:03:01.987787 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:03:01.987901 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:03:01.988033 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:03:01.988182 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:03:01.988322 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0902 00:03:01.988426 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:03:01.988540 140268994136064 dqn_agent.py:283] 	 seed: 1630540981986757
I0902 00:03:01.991918 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:03:01.992057 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:03:01.992161 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:03:01.992229 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:03:01.992295 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:03:01.992352 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:03:01.992448 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:03:01.992510 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:03:01.992582 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:03:02.032550 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:03:02.517384 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:03:02.531211 140268994136064 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:03:02.539445 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:03:02.539725 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:03:02.539830 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:03:02.539902 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:03:02.539964 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0902 00:03:02.540054 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:03:02.540208 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:03:02.540406 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:03:02.540537 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:03:02.540676 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0902 00:03:02.540762 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:03:02.540863 140268994136064 dqn_agent.py:283] 	 seed: 1630540982539383
I0902 00:03:02.543105 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:03:02.543246 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:03:02.543328 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:03:02.543432 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:03:02.543502 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:03:02.543621 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:03:02.543693 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:03:02.543829 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:03:02.543971 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:03:02.580175 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:03:02.602855 140268994136064 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:03:02.603139 140268994136064 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.54
I0902 00:03:09.381427 140268994136064 replay_runner.py:36] Average training steps per second: 147.54
I0902 00:03:10.837389 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 00:03:11.097949 140268994136064 replay_runner.py:41] Starting iteration 1
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.08
I0902 00:03:16.331791 140268994136064 replay_runner.py:36] Average training steps per second: 191.08
I0902 00:03:16.755784 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 285 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 201.76
I0902 00:03:21.958036 140268994136064 replay_runner.py:36] Average training steps per second: 201.76
I0902 00:03:22.198421 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 3
I0902 00:03:22.443379 140268994136064 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 193.83

Steps executed: 327 Episode length: 132 Return: -131.0
I0902 00:03:27.879283 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.50
INFO:tensorflow:Starting iteration 4

Steps executed: 289 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 198.52
I0902 00:03:33.147843 140268994136064 replay_runner.py:36] Average training steps per second: 198.52
I0902 00:03:33.405554 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 5

Steps executed: 228 Episode length: 228 Return: -227.0
INFO:tensorflow:Average training steps per second: 194.27
I0902 00:03:38.794472 140268994136064 replay_runner.py:36] Average training steps per second: 194.27
I0902 00:03:38.980542 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.75
I0902 00:03:44.284510 140268994136064 replay_runner.py:36] Average training steps per second: 197.75
I0902 00:03:44.703971 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 264 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 196.12
I0902 00:03:50.045845 140268994136064 replay_runner.py:36] Average training steps per second: 196.12
I0902 00:03:50.272835 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 8

Steps executed: 282 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 194.09
I0902 00:03:55.664118 140268994136064 replay_runner.py:36] Average training steps per second: 194.09
I0902 00:03:55.906392 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 9

Steps executed: 236 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 198.80
I0902 00:04:01.178656 140268994136064 replay_runner.py:36] Average training steps per second: 198.80
I0902 00:04:01.382454 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 10

Steps executed: 289 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 193.99
I0902 00:04:06.780033 140268994136064 replay_runner.py:36] Average training steps per second: 193.99
I0902 00:04:07.022620 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 11
I0902 00:04:07.250633 140268994136064 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 201.93

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:04:12.632330 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 00:04:12.879637 140268994136064 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.24
I0902 00:04:18.002050 140268994136064 replay_runner.py:36] Average training steps per second: 195.24

Steps executed: 231 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Starting iteration 13

Steps executed: 297 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 199.54
I0902 00:04:23.462218 140268994136064 replay_runner.py:36] Average training steps per second: 199.54
I0902 00:04:23.715671 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 14

Steps executed: 311 Episode length: 155 Return: -154.0
INFO:tensorflow:Average training steps per second: 199.55
I0902 00:04:28.968454 140268994136064 replay_runner.py:36] Average training steps per second: 199.55
I0902 00:04:29.233552 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.67
INFO:tensorflow:Starting iteration 15

Steps executed: 282 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 196.98
I0902 00:04:34.551683 140268994136064 replay_runner.py:36] Average training steps per second: 196.98
I0902 00:04:34.790206 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 16

Steps executed: 205 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 200.53
I0902 00:04:40.019875 140268994136064 replay_runner.py:36] Average training steps per second: 200.53
I0902 00:04:40.188603 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 17

Steps executed: 222 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 205.29
I0902 00:04:45.295805 140268994136064 replay_runner.py:36] Average training steps per second: 205.29
I0902 00:04:45.484323 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.00
INFO:tensorflow:Starting iteration 18

Steps executed: 222 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 203.65
I0902 00:04:50.636292 140268994136064 replay_runner.py:36] Average training steps per second: 203.65
I0902 00:04:50.817933 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.00
INFO:tensorflow:Starting iteration 19
I0902 00:04:51.053011 140268994136064 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 205.00
I0902 00:04:55.931574 140268994136064 replay_runner.py:36] Average training steps per second: 205.00

Steps executed: 243 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Starting iteration 20

Steps executed: 229 Episode length: 229 Return: -228.0
INFO:tensorflow:Average training steps per second: 206.23
I0902 00:05:01.205555 140268994136064 replay_runner.py:36] Average training steps per second: 206.23
I0902 00:05:01.385775 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.00
INFO:tensorflow:Starting iteration 21

Steps executed: 238 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 199.01
I0902 00:05:06.641084 140268994136064 replay_runner.py:36] Average training steps per second: 199.01
I0902 00:05:06.839159 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.51
I0902 00:05:12.351274 140268994136064 replay_runner.py:36] Average training steps per second: 192.51
I0902 00:05:12.788855 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 00:05:13.038475 140268994136064 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 194.97
I0902 00:05:18.168016 140268994136064 replay_runner.py:36] Average training steps per second: 194.97

Steps executed: 228 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Starting iteration 24

Steps executed: 230 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 200.83
I0902 00:05:23.562800 140268994136064 replay_runner.py:36] Average training steps per second: 200.83
I0902 00:05:23.759393 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.67
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 198.51
I0902 00:05:29.050319 140268994136064 replay_runner.py:36] Average training steps per second: 198.51
I0902 00:05:29.207314 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 26
I0902 00:05:29.439778 140268994136064 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.06

Steps executed: 248 Episode length: 75 Return: -74.000
I0902 00:05:34.696948 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 27

Steps executed: 306 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 203.19
I0902 00:05:39.964566 140268994136064 replay_runner.py:36] Average training steps per second: 203.19
I0902 00:05:40.223254 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 28

Steps executed: 267 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 199.50
I0902 00:05:45.519740 140268994136064 replay_runner.py:36] Average training steps per second: 199.50
I0902 00:05:45.742020 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 212.10
I0902 00:05:50.687111 140268994136064 replay_runner.py:36] Average training steps per second: 212.10
I0902 00:05:50.922620 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67