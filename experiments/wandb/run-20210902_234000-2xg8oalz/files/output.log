Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:40:07.150635 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:07.160691 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:07.160977 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:07.161133 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:07.161254 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:07.161399 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:07.161529 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:40:07.161647 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:07.161755 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:07.161868 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:07.161988 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:07.162107 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:07.162211 140170650351616 dqn_agent.py:283] 	 seed: 1630626007160627
I0902 23:40:07.165521 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:07.165749 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:40:07.165896 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:07.166001 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:07.166089 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:07.166397 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:07.166759 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:07.166900 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:07.167016 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:07.210115 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:08.263079 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:08.280725 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:08.292388 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:08.292807 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:08.293126 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:08.293454 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:08.293678 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:08.293842 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:40:08.293996 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:08.294114 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:08.294223 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:08.294339 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:08.294447 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:08.294633 140170650351616 dqn_agent.py:283] 	 seed: 1630626008292296
I0902 23:40:08.297621 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:08.297809 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:40:08.297943 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:08.298102 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:08.298231 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:08.298344 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:08.298459 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:08.298591 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:08.298706 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:08.339867 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:08.367633 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:08.368144 140170650351616 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 142.84
I0902 23:40:15.369435 140170650351616 replay_runner.py:36] Average training steps per second: 142.84
I0902 23:40:16.531022 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.79
I0902 23:40:21.742906 140170650351616 replay_runner.py:36] Average training steps per second: 198.79
I0902 23:40:21.876935 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 191.15
I0902 23:40:27.305879 140170650351616 replay_runner.py:36] Average training steps per second: 191.15
I0902 23:40:27.440416 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 3

Steps executed: 348 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 206.70
I0902 23:40:32.473004 140170650351616 replay_runner.py:36] Average training steps per second: 206.70
I0902 23:40:32.706786 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 4

Steps executed: 362 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.48
I0902 23:40:38.160073 140170650351616 replay_runner.py:36] Average training steps per second: 189.48
I0902 23:40:38.374634 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.39
I0902 23:40:43.438538 140170650351616 replay_runner.py:36] Average training steps per second: 204.39
I0902 23:40:43.566290 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:40:43.752341 140170650351616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 201.75
I0902 23:40:48.709531 140170650351616 replay_runner.py:36] Average training steps per second: 201.75
I0902 23:40:48.843985 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 23:40:49.035340 140170650351616 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 199.67
I0902 23:40:54.043834 140170650351616 replay_runner.py:36] Average training steps per second: 199.67
I0902 23:40:54.176167 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0902 23:40:54.360858 140170650351616 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.50
I0902 23:40:59.476523 140170650351616 replay_runner.py:36] Average training steps per second: 195.50
I0902 23:40:59.621946 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0902 23:40:59.815608 140170650351616 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 187.17

Steps executed: 389 Episode length: 191 Return: 191.0
I0902 23:41:05.432608 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 10
I0902 23:41:05.620363 140170650351616 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 192.16
I0902 23:41:10.824714 140170650351616 replay_runner.py:36] Average training steps per second: 192.16

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 11

Steps executed: 331 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 196.11
I0902 23:41:16.393846 140170650351616 replay_runner.py:36] Average training steps per second: 196.11
I0902 23:41:16.608293 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 12

Steps executed: 374 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.02
I0902 23:41:21.872572 140170650351616 replay_runner.py:36] Average training steps per second: 197.02
I0902 23:41:22.123894 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 13

Steps executed: 384 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 190.96
I0902 23:41:27.539837 140170650351616 replay_runner.py:36] Average training steps per second: 190.96
I0902 23:41:27.815227 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 14
I0902 23:41:28.006487 140170650351616 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 192.41
I0902 23:41:33.204244 140170650351616 replay_runner.py:36] Average training steps per second: 192.41

Steps executed: 347 Episode length: 162 Return: 162.0
INFO:tensorflow:Starting iteration 15
I0902 23:41:33.659688 140170650351616 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 186.25
I0902 23:41:39.029209 140170650351616 replay_runner.py:36] Average training steps per second: 186.25
I0902 23:41:39.232963 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 16


Steps executed: 393 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.75
I0902 23:41:44.424897 140170650351616 replay_runner.py:36] Average training steps per second: 199.75
I0902 23:41:44.711877 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.50
INFO:tensorflow:Starting iteration 17

Steps executed: 281 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 190.26
I0902 23:41:50.166501 140170650351616 replay_runner.py:36] Average training steps per second: 190.26
I0902 23:41:50.356681 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 18

Steps executed: 360 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 198.00
I0902 23:41:55.577001 140170650351616 replay_runner.py:36] Average training steps per second: 198.00
I0902 23:41:55.824219 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.00
I0902 23:42:01.409367 140170650351616 replay_runner.py:36] Average training steps per second: 185.00
I0902 23:42:01.558051 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:42:01.761598 140170650351616 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.92
I0902 23:42:07.027475 140170650351616 replay_runner.py:36] Average training steps per second: 189.92
I0902 23:42:07.166547 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 347 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 191.16
I0902 23:42:12.594163 140170650351616 replay_runner.py:36] Average training steps per second: 191.16
I0902 23:42:12.828363 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.49
I0902 23:42:18.160787 140170650351616 replay_runner.py:36] Average training steps per second: 194.49
I0902 23:42:18.309382 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:42:18.507811 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.18
I0902 23:42:23.711643 140170650351616 replay_runner.py:36] Average training steps per second: 192.18
I0902 23:42:23.840742 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 387 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.54
I0902 23:42:29.162085 140170650351616 replay_runner.py:36] Average training steps per second: 194.54
I0902 23:42:29.447872 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.37
I0902 23:42:34.845988 140170650351616 replay_runner.py:36] Average training steps per second: 192.37
I0902 23:42:34.980438 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:42:35.162260 140170650351616 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 195.29
I0902 23:42:40.283083 140170650351616 replay_runner.py:36] Average training steps per second: 195.29
I0902 23:42:40.420455 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:42:40.607157 140170650351616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 199.45
I0902 23:42:45.621299 140170650351616 replay_runner.py:36] Average training steps per second: 199.45
I0902 23:42:45.766307 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:42:45.945913 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 197.34
I0902 23:42:51.013611 140170650351616 replay_runner.py:36] Average training steps per second: 197.34
I0902 23:42:51.157849 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.53
I0902 23:42:56.366125 140170650351616 replay_runner.py:36] Average training steps per second: 201.53
I0902 23:42:56.621822 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00