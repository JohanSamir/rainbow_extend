Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0901 13:15:48.068673 139683016574976 run_experiment.py:549] Creating TrainRunner ...
I0901 13:15:48.076149 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:48.076269 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:48.076349 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:48.076404 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:48.076461 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:48.076602 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:48.076658 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:48.076740 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:48.076799 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:48.076871 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:48.076923 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:48.077000 139683016574976 dqn_agent.py:283] 	 seed: 1630502148076117
I0901 13:15:48.078651 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:48.078761 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:48.078835 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:48.078933 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:48.078995 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:48.079054 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:48.079109 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:48.079196 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:48.079313 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:48.104858 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:48.408947 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:48.417955 139683016574976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:15:48.425835 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:15:48.426048 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:15:48.426171 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:15:48.426253 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:15:48.426324 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:15:48.426398 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:15:48.426481 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:15:48.426551 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:15:48.426620 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:15:48.426704 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:15:48.426773 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:15:48.426847 139683016574976 dqn_agent.py:283] 	 seed: 1630502148425775
I0901 13:15:48.428170 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:15:48.428290 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:15:48.428378 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:15:48.428442 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:15:48.428499 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:15:48.428551 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:15:48.428634 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:15:48.428718 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:15:48.428776 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:15:48.450773 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:15:48.465708 139683016574976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:15:48.465890 139683016574976 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 253.64
I0901 13:15:52.408644 139683016574976 replay_runner.py:36] Average training steps per second: 253.64
I0901 13:15:53.240822 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.96
Steps executed: 330 Episode length: 133 Return: -335.03258730408186
INFO:tensorflow:Starting iteration 1
I0901 13:15:56.653943 139683016574976 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 332.54

Steps executed: 264 Episode length: 145 Return: -254.68858762179258
I0901 13:15:59.834127 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.94
INFO:tensorflow:Starting iteration 2

Steps executed: 313 Episode length: 145 Return: -413.88958188880395
INFO:tensorflow:Average training steps per second: 330.12
I0901 13:16:06.271137 139683016574976 replay_runner.py:36] Average training steps per second: 330.12
I0901 13:16:06.457080 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.51
INFO:tensorflow:Starting iteration 3

Steps executed: 280 Episode length: 123 Return: -259.91353039345725
INFO:tensorflow:Average training steps per second: 334.93
I0901 13:16:12.806482 139683016574976 replay_runner.py:36] Average training steps per second: 334.93
I0901 13:16:12.960867 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.42
INFO:tensorflow:Starting iteration 4

Steps executed: 261 Episode length: 75 Return: -324.603757243113735
INFO:tensorflow:Average training steps per second: 332.77
I0901 13:16:19.399541 139683016574976 replay_runner.py:36] Average training steps per second: 332.77
I0901 13:16:19.514744 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.58
INFO:tensorflow:Starting iteration 5

Steps executed: 296 Episode length: 129 Return: -264.93023082526014
INFO:tensorflow:Average training steps per second: 323.90
I0901 13:16:26.039992 139683016574976 replay_runner.py:36] Average training steps per second: 323.90
I0901 13:16:26.200448 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.73
INFO:tensorflow:Starting iteration 6

Steps executed: 260 Episode length: 133 Return: -296.76582546324124
INFO:tensorflow:Average training steps per second: 321.72
I0901 13:16:32.716207 139683016574976 replay_runner.py:36] Average training steps per second: 321.72
I0901 13:16:32.878186 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.62
INFO:tensorflow:Starting iteration 7

Steps executed: 254 Episode length: 110 Return: -126.32196928829698
INFO:tensorflow:Average training steps per second: 327.04
I0901 13:16:39.333438 139683016574976 replay_runner.py:36] Average training steps per second: 327.04
I0901 13:16:39.479200 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.42
INFO:tensorflow:Starting iteration 8

Steps executed: 70 Episode length: 70 Return: -244.4880803204593598
INFO:tensorflow:Average training steps per second: 328.41

Steps executed: 216 Episode length: 73 Return: -259.252029007903698
I0901 13:16:46.029781 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.22
INFO:tensorflow:Starting iteration 9
I0901 13:16:49.429842 139683016574976 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 330.22
I0901 13:16:52.458410 139683016574976 replay_runner.py:36] Average training steps per second: 330.22

Steps executed: 1000 Episode length: 1000 Return: 28.055671712643814
INFO:tensorflow:Starting iteration 10

Steps executed: 258 Episode length: 73 Return: -183.5006599883304844
INFO:tensorflow:Average training steps per second: 315.15
I0901 13:17:00.547113 139683016574976 replay_runner.py:36] Average training steps per second: 315.15
I0901 13:17:00.690749 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -170.67
INFO:tensorflow:Starting iteration 11

Steps executed: 272 Episode length: 87 Return: -114.2957634500922444
INFO:tensorflow:Average training steps per second: 317.66
I0901 13:17:07.199778 139683016574976 replay_runner.py:36] Average training steps per second: 317.66
I0901 13:17:07.339307 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.67
INFO:tensorflow:Starting iteration 12

Steps executed: 261 Episode length: 173 Return: -146.632936007694744
INFO:tensorflow:Average training steps per second: 319.32
I0901 13:17:13.842030 139683016574976 replay_runner.py:36] Average training steps per second: 319.32
I0901 13:17:13.997116 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.76
INFO:tensorflow:Starting iteration 13

Steps executed: 221 Episode length: 221 Return: -197.695248600010844
INFO:tensorflow:Average training steps per second: 319.25
I0901 13:17:20.480851 139683016574976 replay_runner.py:36] Average training steps per second: 319.25
I0901 13:17:20.658661 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.70
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 76 Return: -111.7842524958524444
INFO:tensorflow:Average training steps per second: 319.55
I0901 13:17:27.152296 139683016574976 replay_runner.py:36] Average training steps per second: 319.55
I0901 13:17:27.285930 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.40
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 63 Return: -307.3607733733711444
INFO:tensorflow:Average training steps per second: 323.81
I0901 13:17:33.722021 139683016574976 replay_runner.py:36] Average training steps per second: 323.81
I0901 13:17:33.848924 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.61
INFO:tensorflow:Starting iteration 16
I0901 13:17:37.257374 139683016574976 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 324.71

Steps executed: 274 Episode length: 90 Return: -361.8939967904277544
I0901 13:17:40.505201 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.10
INFO:tensorflow:Starting iteration 17

Steps executed: 280 Episode length: 83 Return: -348.8972528704336844
INFO:tensorflow:Average training steps per second: 328.30
I0901 13:17:46.942822 139683016574976 replay_runner.py:36] Average training steps per second: 328.30
I0901 13:17:47.093842 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.44
INFO:tensorflow:Starting iteration 18

Steps executed: 263 Episode length: 83 Return: -199.9535316340090484
INFO:tensorflow:Average training steps per second: 336.76
I0901 13:17:53.474504 139683016574976 replay_runner.py:36] Average training steps per second: 336.76
I0901 13:17:53.619306 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.66
INFO:tensorflow:Starting iteration 19

Steps executed: 247 Episode length: 187 Return: -247.381293848753874
INFO:tensorflow:Average training steps per second: 330.39
I0901 13:18:00.077203 139683016574976 replay_runner.py:36] Average training steps per second: 330.39
I0901 13:18:00.261363 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.74
INFO:tensorflow:Starting iteration 20

Steps executed: 269 Episode length: 101 Return: -391.297946959238274
INFO:tensorflow:Average training steps per second: 333.23
I0901 13:18:06.717290 139683016574976 replay_runner.py:36] Average training steps per second: 333.23
I0901 13:18:06.875581 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.42
INFO:tensorflow:Starting iteration 21

Steps executed: 257 Episode length: 73 Return: -52.98100980318965544
INFO:tensorflow:Average training steps per second: 329.72
I0901 13:18:13.366049 139683016574976 replay_runner.py:36] Average training steps per second: 329.72
I0901 13:18:13.521905 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.25
INFO:tensorflow:Starting iteration 22

Steps executed: 261 Episode length: 67 Return: -319.3183881031606544
INFO:tensorflow:Average training steps per second: 331.50
I0901 13:18:19.954936 139683016574976 replay_runner.py:36] Average training steps per second: 331.50
I0901 13:18:20.093500 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.43
INFO:tensorflow:Starting iteration 23

Steps executed: 248 Episode length: 95 Return: -511.8337997774896544
INFO:tensorflow:Average training steps per second: 328.50
I0901 13:18:26.569918 139683016574976 replay_runner.py:36] Average training steps per second: 328.50
I0901 13:18:26.722970 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -659.86
INFO:tensorflow:Starting iteration 24

Steps executed: 215 Episode length: 83 Return: -322.6104986669759544
INFO:tensorflow:Average training steps per second: 344.22
I0901 13:18:33.037713 139683016574976 replay_runner.py:36] Average training steps per second: 344.22
I0901 13:18:33.170068 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.37
INFO:tensorflow:Starting iteration 25

Steps executed: 204 Episode length: 61 Return: -554.0062432211253544
INFO:tensorflow:Average training steps per second: 340.11
I0901 13:18:39.552771 139683016574976 replay_runner.py:36] Average training steps per second: 340.11
I0901 13:18:39.671192 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -595.78
INFO:tensorflow:Starting iteration 26

Steps executed: 308 Episode length: 142 Return: -430.079253735894844
INFO:tensorflow:Average training steps per second: 340.58
I0901 13:18:46.017516 139683016574976 replay_runner.py:36] Average training steps per second: 340.58
I0901 13:18:46.196241 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.18
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 71 Return: -469.9597531006766644
INFO:tensorflow:Average training steps per second: 326.22
I0901 13:18:52.597515 139683016574976 replay_runner.py:36] Average training steps per second: 326.22
I0901 13:18:52.698006 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.29
INFO:tensorflow:Starting iteration 28

Steps executed: 280 Episode length: 89 Return: -230.8388431487413744
INFO:tensorflow:Average training steps per second: 321.64
I0901 13:18:58.994305 139683016574976 replay_runner.py:36] Average training steps per second: 321.64
I0901 13:18:59.156183 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -564.07
INFO:tensorflow:Starting iteration 29

Steps executed: 237 Episode length: 51 Return: -151.1148073753808244
INFO:tensorflow:Average training steps per second: 336.33
I0901 13:19:05.441471 139683016574976 replay_runner.py:36] Average training steps per second: 336.33

Done fixed training!Episode length: 51 Return: -151.1148073753808244