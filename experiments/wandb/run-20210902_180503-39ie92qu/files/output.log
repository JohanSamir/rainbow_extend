Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 18:05:10.406448 140669712693248 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:10.416376 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:10.416659 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:10.416857 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:10.417047 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:10.417177 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:10.417298 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:10.417477 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:10.417602 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:10.417721 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:10.417819 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:10.417922 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:10.418066 140669712693248 dqn_agent.py:283] 	 seed: 1630605910416288
I0902 18:05:10.421447 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:10.421647 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:10.421808 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:10.421935 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:10.422049 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:10.422210 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:10.422333 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:10.422511 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:10.422640 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:10.465806 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:10.952873 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:10.966388 140669712693248 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:10.975334 140669712693248 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:10.975545 140669712693248 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:10.975727 140669712693248 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:10.975860 140669712693248 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:10.975929 140669712693248 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:10.976035 140669712693248 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:05:10.976149 140669712693248 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:10.976285 140669712693248 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:10.976398 140669712693248 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:10.976503 140669712693248 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:10.976651 140669712693248 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:10.976799 140669712693248 dqn_agent.py:283] 	 seed: 1630605910975285
I0902 18:05:10.979550 140669712693248 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:10.979739 140669712693248 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:05:10.979857 140669712693248 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:10.979945 140669712693248 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:10.980027 140669712693248 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:10.980139 140669712693248 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:10.980279 140669712693248 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:10.980410 140669712693248 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:10.980556 140669712693248 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:11.010899 140669712693248 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:05:11.033934 140669712693248 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:11.034131 140669712693248 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 154.02
I0902 18:05:17.526951 140669712693248 replay_runner.py:36] Average training steps per second: 154.02
I0902 18:05:18.659487 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 1
I0902 18:05:18.838732 140669712693248 replay_runner.py:41] Starting iteration 1
Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.91

Steps executed: 212 Episode length: 24 Return: 24.0
I0902 18:05:24.047898 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.50
INFO:tensorflow:Starting iteration 2
I0902 18:05:24.232419 140669712693248 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 199.00
I0902 18:05:29.258275 140669712693248 replay_runner.py:36] Average training steps per second: 199.00
I0902 18:05:29.386610 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.01
I0902 18:05:34.530654 140669712693248 replay_runner.py:36] Average training steps per second: 202.01
I0902 18:05:34.666053 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 18:05:34.857315 140669712693248 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 198.22
I0902 18:05:39.902570 140669712693248 replay_runner.py:36] Average training steps per second: 198.22

Steps executed: 331 Episode length: 160 Return: 160.0
INFO:tensorflow:Starting iteration 5
I0902 18:05:40.301167 140669712693248 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.94
I0902 18:05:45.353625 140669712693248 replay_runner.py:36] Average training steps per second: 197.94
I0902 18:05:45.576627 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 6

Steps executed: 332 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 201.87
I0902 18:05:50.717622 140669712693248 replay_runner.py:36] Average training steps per second: 201.87
I0902 18:05:50.911860 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 7

Steps executed: 322 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 202.85
I0902 18:05:56.027555 140669712693248 replay_runner.py:36] Average training steps per second: 202.85

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 8
I0902 18:05:56.419545 140669712693248 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 204.18
I0902 18:06:01.317939 140669712693248 replay_runner.py:36] Average training steps per second: 204.18
I0902 18:06:01.553287 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 9

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.69
I0902 18:06:06.815284 140669712693248 replay_runner.py:36] Average training steps per second: 196.69
I0902 18:06:06.992624 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 10

Steps executed: 303 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 204.79
I0902 18:06:12.055150 140669712693248 replay_runner.py:36] Average training steps per second: 204.79
I0902 18:06:12.282989 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 11

Steps executed: 350 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 204.25
I0902 18:06:17.368467 140669712693248 replay_runner.py:36] Average training steps per second: 204.25
I0902 18:06:17.608643 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 12

Steps executed: 380 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 193.84
I0902 18:06:22.948576 140669712693248 replay_runner.py:36] Average training steps per second: 193.84
I0902 18:06:23.165983 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 13

Steps executed: 278 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 204.47
I0902 18:06:28.279296 140669712693248 replay_runner.py:36] Average training steps per second: 204.47
I0902 18:06:28.465259 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 14

Steps executed: 278 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 194.53
I0902 18:06:33.801232 140669712693248 replay_runner.py:36] Average training steps per second: 194.53
I0902 18:06:33.934071 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.48
I0902 18:06:39.212958 140669712693248 replay_runner.py:36] Average training steps per second: 196.48
I0902 18:06:39.357837 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 18:06:39.541031 140669712693248 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.73
I0902 18:06:44.650556 140669712693248 replay_runner.py:36] Average training steps per second: 195.73
I0902 18:06:44.787220 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 18:06:44.980049 140669712693248 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.13
I0902 18:06:50.105318 140669712693248 replay_runner.py:36] Average training steps per second: 195.13

Steps executed: 347 Episode length: 171 Return: 171.0
INFO:tensorflow:Starting iteration 18
I0902 18:06:50.538249 140669712693248 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 199.29
I0902 18:06:55.556636 140669712693248 replay_runner.py:36] Average training steps per second: 199.29
I0902 18:06:55.687079 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.96
I0902 18:07:01.138077 140669712693248 replay_runner.py:36] Average training steps per second: 189.96
I0902 18:07:01.328368 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 20

Steps executed: 312 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 196.94
I0902 18:07:06.588301 140669712693248 replay_runner.py:36] Average training steps per second: 196.94
I0902 18:07:06.816153 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 21


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.49
I0902 18:07:12.126634 140669712693248 replay_runner.py:36] Average training steps per second: 195.49
I0902 18:07:12.257550 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 18:07:12.439288 140669712693248 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.81
I0902 18:07:17.520695 140669712693248 replay_runner.py:36] Average training steps per second: 196.81
I0902 18:07:17.664167 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 18:07:17.840977 140669712693248 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 198.21
I0902 18:07:22.886635 140669712693248 replay_runner.py:36] Average training steps per second: 198.21
I0902 18:07:23.023858 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 18:07:23.221329 140669712693248 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 194.85
I0902 18:07:28.353895 140669712693248 replay_runner.py:36] Average training steps per second: 194.85
I0902 18:07:28.483416 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 384 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.50
I0902 18:07:33.784695 140669712693248 replay_runner.py:36] Average training steps per second: 195.50
I0902 18:07:34.048390 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.19
I0902 18:07:39.193197 140669712693248 replay_runner.py:36] Average training steps per second: 202.19
I0902 18:07:39.324543 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 18:07:39.514844 140669712693248 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 195.78
I0902 18:07:44.623274 140669712693248 replay_runner.py:36] Average training steps per second: 195.78
I0902 18:07:44.760295 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 18:07:44.947673 140669712693248 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 200.55
I0902 18:07:49.934321 140669712693248 replay_runner.py:36] Average training steps per second: 200.55
I0902 18:07:50.073678 140669712693248 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 18:07:50.348942 140669712693248 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 193.86
I0902 18:07:55.507714 140669712693248 replay_runner.py:36] Average training steps per second: 193.86

Done fixed training!Episode length: 200 Return: 200.0