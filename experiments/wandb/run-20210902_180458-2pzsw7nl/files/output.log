Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 18:05:05.344370 140110082734080 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:05.354945 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:05.355229 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:05.355361 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:05.355447 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:05.355526 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:05.355618 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:05.355731 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:05.355881 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:05.356057 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:05.356225 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:05.356404 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:05.356493 140110082734080 dqn_agent.py:283] 	 seed: 1630605905354868
I0902 18:05:05.359722 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:05.359940 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:05.360053 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:05.360157 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:05.360276 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:05.360375 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:05.360507 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:05.360584 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:05.360662 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:05.391525 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:05.804954 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:05.818333 140110082734080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:05.828276 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:05.828578 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:05.828771 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:05.828914 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:05.828999 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:05.829074 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:05.829180 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:05.829308 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:05.829392 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:05.829478 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:05.829718 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:05.829864 140110082734080 dqn_agent.py:283] 	 seed: 1630605905828231
I0902 18:05:05.862352 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:05.862704 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:05.863111 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:05.863273 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:05.863393 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:05.863526 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:05.863649 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:05.863776 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:05.864053 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:05.895965 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:05.917821 140110082734080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:05.918104 140110082734080 replay_runner.py:41] Starting iteration 0
Steps executed: 211 Episode length: 68 Return: -507.1464728754265
INFO:tensorflow:Average training steps per second: 176.51
I0902 18:05:11.583921 140110082734080 replay_runner.py:36] Average training steps per second: 176.51
I0902 18:05:12.717230 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.23
INFO:tensorflow:Starting iteration 1

Steps executed: 307 Episode length: 111 Return: -598.0266094628837
INFO:tensorflow:Average training steps per second: 233.92
I0902 18:05:21.362140 140110082734080 replay_runner.py:36] Average training steps per second: 233.92
I0902 18:05:21.619577 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -638.16
INFO:tensorflow:Starting iteration 2

Steps executed: 273 Episode length: 124 Return: -660.3041718450758
INFO:tensorflow:Average training steps per second: 216.50
I0902 18:05:30.536214 140110082734080 replay_runner.py:36] Average training steps per second: 216.50
I0902 18:05:30.789358 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -525.36
INFO:tensorflow:Starting iteration 3

Steps executed: 242 Episode length: 152 Return: -754.6615353528341
INFO:tensorflow:Average training steps per second: 222.64
I0902 18:05:39.575624 140110082734080 replay_runner.py:36] Average training steps per second: 222.64
I0902 18:05:39.786794 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -724.48
INFO:tensorflow:Starting iteration 4

Steps executed: 298 Episode length: 198 Return: -270.90347393687664
INFO:tensorflow:Average training steps per second: 225.90
I0902 18:05:48.389859 140110082734080 replay_runner.py:36] Average training steps per second: 225.90
I0902 18:05:48.638208 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.57
INFO:tensorflow:Starting iteration 5
I0902 18:05:52.866555 140110082734080 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 231.87

Steps executed: 221 Episode length: 125 Return: -312.75521619251464
I0902 18:05:57.344950 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.47
INFO:tensorflow:Starting iteration 6

Steps executed: 314 Episode length: 173 Return: -617.26581306973013
INFO:tensorflow:Average training steps per second: 231.27
I0902 18:06:05.933732 140110082734080 replay_runner.py:36] Average training steps per second: 231.27
I0902 18:06:06.203197 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.38
INFO:tensorflow:Starting iteration 7

Steps executed: 179 Episode length: 179 Return: -213.13969308060544
INFO:tensorflow:Average training steps per second: 220.08
I0902 18:06:14.964515 140110082734080 replay_runner.py:36] Average training steps per second: 220.08

Steps executed: 302 Episode length: 123 Return: -396.86943643671947
INFO:tensorflow:Starting iteration 8

Steps executed: 239 Episode length: 106 Return: -225.73649841954358
INFO:tensorflow:Average training steps per second: 219.15
I0902 18:06:24.125182 140110082734080 replay_runner.py:36] Average training steps per second: 219.15
I0902 18:06:24.335215 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.04
INFO:tensorflow:Starting iteration 9
I0902 18:06:28.565580 140110082734080 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 219.83
I0902 18:06:33.115025 140110082734080 replay_runner.py:36] Average training steps per second: 219.83

Steps executed: 327 Episode length: 167 Return: -525.09738180291088
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 124 Return: -453.24400473994837
INFO:tensorflow:Average training steps per second: 224.26
I0902 18:06:42.177046 140110082734080 replay_runner.py:36] Average training steps per second: 224.26
I0902 18:06:42.388062 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.38
INFO:tensorflow:Starting iteration 11
I0902 18:06:46.776427 140110082734080 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 220.78

Steps executed: 336 Episode length: 218 Return: -26.645379228254697
I0902 18:06:51.635476 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.32
INFO:tensorflow:Starting iteration 12

Steps executed: 260 Episode length: 170 Return: -47.927502801286557
INFO:tensorflow:Average training steps per second: 214.92
I0902 18:07:00.588554 140110082734080 replay_runner.py:36] Average training steps per second: 214.92
I0902 18:07:00.814613 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.07
INFO:tensorflow:Starting iteration 13

Steps executed: 213 Episode length: 119 Return: -197.70746307980335
INFO:tensorflow:Average training steps per second: 216.52
I0902 18:07:09.793203 140110082734080 replay_runner.py:36] Average training steps per second: 216.52
I0902 18:07:09.966611 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.69
INFO:tensorflow:Starting iteration 14

Steps executed: 207 Episode length: 120 Return: -386.11613005125045
INFO:tensorflow:Average training steps per second: 218.92
I0902 18:07:18.951838 140110082734080 replay_runner.py:36] Average training steps per second: 218.92
I0902 18:07:19.126794 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.79
INFO:tensorflow:Starting iteration 15

Steps executed: 220 Episode length: 99 Return: -580.981248058089974
INFO:tensorflow:Average training steps per second: 218.89
I0902 18:07:28.028811 140110082734080 replay_runner.py:36] Average training steps per second: 218.89
I0902 18:07:28.229520 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.46
INFO:tensorflow:Starting iteration 16

Steps executed: 275 Episode length: 96 Return: -437.429294221009372
INFO:tensorflow:Average training steps per second: 227.56
I0902 18:07:36.937132 140110082734080 replay_runner.py:36] Average training steps per second: 227.56
I0902 18:07:37.170047 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.06
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 129 Return: -312.68743755293782
INFO:tensorflow:Average training steps per second: 223.05
I0902 18:07:45.934754 140110082734080 replay_runner.py:36] Average training steps per second: 223.05
I0902 18:07:46.116344 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.91
INFO:tensorflow:Starting iteration 18

Steps executed: 220 Episode length: 123 Return: -316.33459032240122
INFO:tensorflow:Average training steps per second: 226.35
I0902 18:07:54.847253 140110082734080 replay_runner.py:36] Average training steps per second: 226.35
I0902 18:07:55.035216 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.04
INFO:tensorflow:Starting iteration 19

Steps executed: 221 Episode length: 85 Return: -412.530269018798952
INFO:tensorflow:Average training steps per second: 234.14
I0902 18:08:03.549083 140110082734080 replay_runner.py:36] Average training steps per second: 234.14
I0902 18:08:03.731512 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -440.33
INFO:tensorflow:Starting iteration 20

Steps executed: 241 Episode length: 119 Return: -216.71588858870112
INFO:tensorflow:Average training steps per second: 229.21
I0902 18:08:12.399104 140110082734080 replay_runner.py:36] Average training steps per second: 229.21
I0902 18:08:12.585036 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.85
INFO:tensorflow:Starting iteration 21

Steps executed: 230 Episode length: 142 Return: -106.80260935100257
INFO:tensorflow:Average training steps per second: 227.87
I0902 18:08:21.314650 140110082734080 replay_runner.py:36] Average training steps per second: 227.87
I0902 18:08:21.483811 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.74
INFO:tensorflow:Starting iteration 22

Steps executed: 313 Episode length: 213 Return: -80.236928528861927
INFO:tensorflow:Average training steps per second: 226.54
I0902 18:08:30.174248 140110082734080 replay_runner.py:36] Average training steps per second: 226.54
I0902 18:08:30.444825 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.32
INFO:tensorflow:Starting iteration 23
I0902 18:08:34.860930 140110082734080 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 225.39
I0902 18:08:39.298202 140110082734080 replay_runner.py:36] Average training steps per second: 225.39

Steps executed: 250 Episode length: 82 Return: -491.079146989993156
INFO:tensorflow:Starting iteration 24

Steps executed: 222 Episode length: 114 Return: -162.16636217598652
INFO:tensorflow:Average training steps per second: 221.07
I0902 18:08:48.319389 140110082734080 replay_runner.py:36] Average training steps per second: 221.07
I0902 18:08:48.504536 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.93
INFO:tensorflow:Starting iteration 25

Steps executed: 177 Episode length: 79 Return: -462.890648570632152
INFO:tensorflow:Average training steps per second: 225.53
I0902 18:08:57.214891 140110082734080 replay_runner.py:36] Average training steps per second: 225.53

Steps executed: 256 Episode length: 79 Return: -437.857751962699242
INFO:tensorflow:Starting iteration 26

Steps executed: 240 Episode length: 108 Return: -359.29924522581532
INFO:tensorflow:Average training steps per second: 227.70
I0902 18:09:05.973533 140110082734080 replay_runner.py:36] Average training steps per second: 227.70
I0902 18:09:06.178734 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.47
INFO:tensorflow:Starting iteration 27

Steps executed: 214 Episode length: 92 Return: -314.345143165857962
INFO:tensorflow:Average training steps per second: 229.47
I0902 18:09:14.799352 140110082734080 replay_runner.py:36] Average training steps per second: 229.47
I0902 18:09:14.993542 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.16
INFO:tensorflow:Starting iteration 28
I0902 18:09:19.352423 140110082734080 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 223.07

Steps executed: 318 Episode length: 130 Return: -204.43826741603892
I0902 18:09:24.099035 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.23
INFO:tensorflow:Starting iteration 29

Steps executed: 215 Episode length: 127 Return: -355.41513187221625
INFO:tensorflow:Average training steps per second: 227.08
I0902 18:09:32.748503 140110082734080 replay_runner.py:36] Average training steps per second: 227.08

Done fixed training!Episode length: 127 Return: -355.41513187221625