Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0905 19:01:58.488252 140074183452672 run_experiment.py:549] Creating TrainRunner ...
I0905 19:01:58.497218 140074183452672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:01:58.497358 140074183452672 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:01:58.497431 140074183452672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:01:58.497493 140074183452672 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:01:58.497570 140074183452672 dqn_agent.py:275] 	 update_period: 4
I0905 19:01:58.497717 140074183452672 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:01:58.497868 140074183452672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:01:58.497974 140074183452672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:01:58.498090 140074183452672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:01:58.498275 140074183452672 dqn_agent.py:280] 	 optimizer: adam
I0905 19:01:58.498408 140074183452672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:01:58.498515 140074183452672 dqn_agent.py:283] 	 seed: 1630868518497184
I0905 19:01:58.501516 140074183452672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:01:58.501678 140074183452672 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:01:58.501827 140074183452672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:01:58.501963 140074183452672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:01:58.502118 140074183452672 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:01:58.502218 140074183452672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:01:58.502426 140074183452672 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:01:58.502517 140074183452672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:01:58.502866 140074183452672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:01:58.544555 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:01:58.845648 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:01:58.855784 140074183452672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:01:58.862292 140074183452672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:01:58.862431 140074183452672 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:01:58.862504 140074183452672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:01:58.862566 140074183452672 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:01:58.862622 140074183452672 dqn_agent.py:275] 	 update_period: 4
I0905 19:01:58.862698 140074183452672 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:01:58.862776 140074183452672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:01:58.862868 140074183452672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:01:58.862946 140074183452672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:01:58.863014 140074183452672 dqn_agent.py:280] 	 optimizer: adam
I0905 19:01:58.863081 140074183452672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:01:58.863156 140074183452672 dqn_agent.py:283] 	 seed: 1630868518862261
I0905 19:01:58.864586 140074183452672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:01:58.864708 140074183452672 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:01:58.864796 140074183452672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:01:58.864859 140074183452672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:01:58.864916 140074183452672 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:01:58.864969 140074183452672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:01:58.865020 140074183452672 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:01:58.865071 140074183452672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:01:58.865126 140074183452672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:01:58.906652 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:01:58.926266 140074183452672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:01:58.926456 140074183452672 replay_runner.py:41] Starting iteration 0
Steps executed: 344 Episode length: 181 Return: -710.6978715109777
INFO:tensorflow:Average training steps per second: 193.57
I0905 19:02:04.092830 140074183452672 replay_runner.py:36] Average training steps per second: 193.57
I0905 19:02:05.319722 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.22
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 209 Return: -510.79048517300185
INFO:tensorflow:Average training steps per second: 310.24
I0905 19:02:12.156888 140074183452672 replay_runner.py:36] Average training steps per second: 310.24
I0905 19:02:12.359691 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.79
INFO:tensorflow:Starting iteration 2
I0905 19:02:15.814559 140074183452672 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 308.20

Steps executed: 1000 Episode length: 1000 Return: -229.96936334132175
I0905 19:02:21.098999 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.97
INFO:tensorflow:Starting iteration 3
I0905 19:02:24.491432 140074183452672 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 280.78

Steps executed: 1000 Episode length: 1000 Return: -190.86983452652063
I0905 19:02:29.484694 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.87
INFO:tensorflow:Starting iteration 4

Steps executed: 807 Episode length: 807 Return: -335.3977375960285563
INFO:tensorflow:Average training steps per second: 270.62
I0905 19:02:36.514011 140074183452672 replay_runner.py:36] Average training steps per second: 270.62
I0905 19:02:38.128692 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.40
INFO:tensorflow:Starting iteration 5
I0905 19:02:41.944006 140074183452672 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 264.95

Steps executed: 1000 Episode length: 1000 Return: -213.74196925038773
I0905 19:02:49.297072 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.74
INFO:tensorflow:Starting iteration 6
I0905 19:02:53.110816 140074183452672 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 265.50

Steps executed: 1000 Episode length: 1000 Return: -351.98062695896973
I0905 19:02:58.816070 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.98
INFO:tensorflow:Starting iteration 7
I0905 19:03:02.710719 140074183452672 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 283.58

Steps executed: 811 Episode length: 811 Return: -436.1846098946413773
I0905 19:03:07.859102 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.18
INFO:tensorflow:Starting iteration 8
I0905 19:03:11.820592 140074183452672 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 285.64

Steps executed: 905 Episode length: 905 Return: -434.0967226443134573
I0905 19:03:16.822030 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.10
INFO:tensorflow:Starting iteration 9
I0905 19:03:20.721703 140074183452672 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 280.73

Steps executed: 1000 Episode length: 1000 Return: -145.48975514915782
I0905 19:03:27.100565 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.49
INFO:tensorflow:Starting iteration 10
I0905 19:03:30.810760 140074183452672 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 271.11

Steps executed: 293 Episode length: 293 Return: -130.2253487784201782
I0905 19:03:34.818132 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.23
INFO:tensorflow:Starting iteration 11
I0905 19:03:38.695635 140074183452672 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 274.30

Steps executed: 466 Episode length: 466 Return: 203.29751398224911782
I0905 19:03:43.072594 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: 203.30
INFO:tensorflow:Starting iteration 12
I0905 19:03:47.087061 140074183452672 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 284.12

Steps executed: 418 Episode length: 418 Return: -72.49146278698971782
I0905 19:03:51.296452 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.49
INFO:tensorflow:Starting iteration 13
I0905 19:03:55.177108 140074183452672 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 284.63

Steps executed: 1000 Episode length: 1000 Return: 67.9971887268015582
I0905 19:04:00.951712 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.00
INFO:tensorflow:Starting iteration 14
I0905 19:04:04.944648 140074183452672 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 296.30

Steps executed: 974 Episode length: 974 Return: 115.46600142095595582
I0905 19:04:11.537468 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.47
INFO:tensorflow:Starting iteration 15
I0905 19:04:15.371605 140074183452672 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 281.21
I0905 19:04:18.927969 140074183452672 replay_runner.py:36] Average training steps per second: 281.21

Steps executed: 875 Episode length: 875 Return: 113.25747113886509582
INFO:tensorflow:Starting iteration 16
I0905 19:04:24.538561 140074183452672 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 261.11

Steps executed: 1000 Episode length: 1000 Return: -59.566505382194752
I0905 19:04:31.225225 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.57
INFO:tensorflow:Starting iteration 17
I0905 19:04:35.104902 140074183452672 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 254.70

Steps executed: 1000 Episode length: 1000 Return: -87.926517381808682
I0905 19:04:42.525681 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.93
INFO:tensorflow:Starting iteration 18

Steps executed: 184 Episode length: 184 Return: -37.61126423337088682
INFO:tensorflow:Average training steps per second: 266.68
I0905 19:04:50.290785 140074183452672 replay_runner.py:36] Average training steps per second: 266.68

Steps executed: 374 Episode length: 190 Return: -37.31181099122851682
INFO:tensorflow:Starting iteration 19

Steps executed: 165 Episode length: 165 Return: -102.2207159110835382
INFO:tensorflow:Average training steps per second: 254.26

Steps executed: 673 Episode length: 508 Return: -305.8376022641602382
I0905 19:04:59.594367 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.03
INFO:tensorflow:Starting iteration 20
I0905 19:05:03.416179 140074183452672 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 250.54

Steps executed: 1000 Episode length: 1000 Return: -11.793751944205752
I0905 19:05:09.607424 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -11.79
INFO:tensorflow:Starting iteration 21
I0905 19:05:13.464732 140074183452672 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 248.81

Steps executed: 1000 Episode length: 1000 Return: -134.19019541224057
I0905 19:05:20.396251 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.19
INFO:tensorflow:Starting iteration 22
I0905 19:05:24.259341 140074183452672 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 254.89

Steps executed: 975 Episode length: 975 Return: -373.6944528228502057
I0905 19:05:30.117924 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.69
INFO:tensorflow:Starting iteration 23

Steps executed: 238 Episode length: 238 Return: -175.8208442535240657
INFO:tensorflow:Average training steps per second: 244.56
I0905 19:05:37.914928 140074183452672 replay_runner.py:36] Average training steps per second: 244.56
I0905 19:05:38.169169 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.82
INFO:tensorflow:Starting iteration 24

Steps executed: 391 Episode length: 391 Return: -195.4297938140003357
INFO:tensorflow:Average training steps per second: 239.23
I0905 19:05:45.740368 140074183452672 replay_runner.py:36] Average training steps per second: 239.23
I0905 19:05:46.423202 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.43
INFO:tensorflow:Starting iteration 25
I0905 19:05:49.867657 140074183452672 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 237.51

Steps executed: 1000 Episode length: 1000 Return: -26.284617184390697
I0905 19:05:55.939899 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.28
INFO:tensorflow:Starting iteration 26
I0905 19:05:59.487511 140074183452672 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 250.36
I0905 19:06:03.482269 140074183452672 replay_runner.py:36] Average training steps per second: 250.36

Steps executed: 1000 Episode length: 1000 Return: 29.6657879130150527
INFO:tensorflow:Starting iteration 27
I0905 19:06:10.547798 140074183452672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 247.07
I0905 19:06:14.595569 140074183452672 replay_runner.py:36] Average training steps per second: 247.07

Steps executed: 274 Episode length: 274 Return: -223.6471126167082327
INFO:tensorflow:Starting iteration 28
I0905 19:06:18.651002 140074183452672 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 256.03
I0905 19:06:22.557122 140074183452672 replay_runner.py:36] Average training steps per second: 256.03

Steps executed: 565 Episode length: 412 Return: -162.4986375290292827
INFO:tensorflow:Starting iteration 29
I0905 19:06:27.122236 140074183452672 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 264.91
I0905 19:06:30.897419 140074183452672 replay_runner.py:36] Average training steps per second: 264.91


Done fixed training! Episode length: 1000 Return: 113.166729924666037