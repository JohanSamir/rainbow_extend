Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 23:54:16.953027 140720164866048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:54:16.968533 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:54:16.968713 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:54:16.968810 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:54:16.968890 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:54:16.968969 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:54:16.969048 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:54:16.969130 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:54:16.969214 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:54:16.969293 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:54:16.969370 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:54:16.969447 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:54:16.969530 140720164866048 dqn_agent.py:283] 	 seed: 1630626856968484
I0902 23:54:16.974790 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:54:16.974977 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:54:16.975129 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:54:16.975234 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:54:16.975333 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:54:16.975434 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:54:16.975545 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:54:16.975659 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:54:16.975784 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:54:17.034697 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:54:17.488439 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:54:17.501946 140720164866048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:54:17.510344 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:54:17.510544 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:54:17.510749 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:54:17.510847 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:54:17.510906 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:54:17.510976 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:54:17.511053 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:54:17.511121 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:54:17.511186 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:54:17.511276 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:54:17.511466 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:54:17.511607 140720164866048 dqn_agent.py:283] 	 seed: 1630626857510301
I0902 23:54:17.514686 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:54:17.514860 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:54:17.515014 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:54:17.515139 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:54:17.515222 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:54:17.515373 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:54:17.515490 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:54:17.515707 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:54:17.515819 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:54:17.550989 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:54:17.575552 140720164866048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:54:17.575907 140720164866048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 139.48
I0902 23:54:24.745752 140720164866048 replay_runner.py:36] Average training steps per second: 139.48
I0902 23:54:26.260966 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:54:26.506522 140720164866048 replay_runner.py:41] Starting iteration 1
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.22
I0902 23:54:31.935199 140720164866048 replay_runner.py:36] Average training steps per second: 184.22
I0902 23:54:32.249528 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.00
INFO:tensorflow:Starting iteration 2

Steps executed: 360 Episode length: 360 Return: -359.0
INFO:tensorflow:Average training steps per second: 187.26
I0902 23:54:37.833781 140720164866048 replay_runner.py:36] Average training steps per second: 187.26
I0902 23:54:38.301515 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3


Steps executed: 338 Episode length: 146 Return: -145.0
INFO:tensorflow:Average training steps per second: 189.22
I0902 23:54:43.833350 140720164866048 replay_runner.py:36] Average training steps per second: 189.22
I0902 23:54:44.127107 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.00
INFO:tensorflow:Starting iteration 4

Steps executed: 621 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.52
I0902 23:54:49.699527 140720164866048 replay_runner.py:36] Average training steps per second: 187.52
I0902 23:54:50.213823 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.00
INFO:tensorflow:Starting iteration 5

Steps executed: 242 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 188.79
I0902 23:54:55.752651 140720164866048 replay_runner.py:36] Average training steps per second: 188.79
I0902 23:54:55.965339 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 6

Steps executed: 281 Episode length: 178 Return: -177.0
INFO:tensorflow:Average training steps per second: 194.33
I0902 23:55:01.359684 140720164866048 replay_runner.py:36] Average training steps per second: 194.33
I0902 23:55:01.589317 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.50
INFO:tensorflow:Starting iteration 7

Steps executed: 234 Episode length: 234 Return: -233.0
INFO:tensorflow:Average training steps per second: 185.86
I0902 23:55:07.214797 140720164866048 replay_runner.py:36] Average training steps per second: 185.86
I0902 23:55:07.408628 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.00
INFO:tensorflow:Starting iteration 8
I0902 23:55:07.644992 140720164866048 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.12

Steps executed: 240 Episode length: 121 Return: -120.0
I0902 23:55:13.087320 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 9
I0902 23:55:13.329788 140720164866048 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 190.96
I0902 23:55:18.566841 140720164866048 replay_runner.py:36] Average training steps per second: 190.96

Steps executed: 295 Episode length: 115 Return: -114.0
INFO:tensorflow:Starting iteration 10

Steps executed: 231 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 188.04
I0902 23:55:24.365304 140720164866048 replay_runner.py:36] Average training steps per second: 188.04
I0902 23:55:24.566831 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 11

Steps executed: 273 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 188.82
I0902 23:55:30.091351 140720164866048 replay_runner.py:36] Average training steps per second: 188.82
I0902 23:55:30.321198 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 187.71
I0902 23:55:35.894179 140720164866048 replay_runner.py:36] Average training steps per second: 187.71
I0902 23:55:36.085975 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 13

Steps executed: 220 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 190.36
I0902 23:55:41.592089 140720164866048 replay_runner.py:36] Average training steps per second: 190.36
I0902 23:55:41.782413 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 14

Steps executed: 278 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 188.52
I0902 23:55:47.336564 140720164866048 replay_runner.py:36] Average training steps per second: 188.52
I0902 23:55:47.573280 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 15
I0902 23:55:47.813443 140720164866048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 196.69
I0902 23:55:52.897809 140720164866048 replay_runner.py:36] Average training steps per second: 196.69
I0902 23:55:53.058006 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 16


Steps executed: 243 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 185.87
I0902 23:55:58.667634 140720164866048 replay_runner.py:36] Average training steps per second: 185.87
I0902 23:55:58.854928 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 17

Steps executed: 236 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 199.50
I0902 23:56:04.089790 140720164866048 replay_runner.py:36] Average training steps per second: 199.50
I0902 23:56:04.275253 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 18

Steps executed: 312 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 197.43
I0902 23:56:09.573178 140720164866048 replay_runner.py:36] Average training steps per second: 197.43
I0902 23:56:09.818012 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 19

Steps executed: 209 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 189.92
I0902 23:56:15.352081 140720164866048 replay_runner.py:36] Average training steps per second: 189.92
I0902 23:56:15.525905 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 20
I0902 23:56:15.761662 140720164866048 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.43
I0902 23:56:20.905247 140720164866048 replay_runner.py:36] Average training steps per second: 194.43

Steps executed: 219 Episode length: 113 Return: -112.0
INFO:tensorflow:Starting iteration 21
I0902 23:56:21.327756 140720164866048 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 189.67
I0902 23:56:26.600569 140720164866048 replay_runner.py:36] Average training steps per second: 189.67

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 22

Steps executed: 175 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 187.86
I0902 23:56:32.617102 140720164866048 replay_runner.py:36] Average training steps per second: 187.86
I0902 23:56:32.842912 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 23


Steps executed: 278 Episode length: 195 Return: -194.0
INFO:tensorflow:Average training steps per second: 183.45
I0902 23:56:38.538331 140720164866048 replay_runner.py:36] Average training steps per second: 183.45
I0902 23:56:38.793691 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.00
INFO:tensorflow:Starting iteration 24

Steps executed: 202 Episode length: 202 Return: -201.0
INFO:tensorflow:Average training steps per second: 187.64
I0902 23:56:44.370861 140720164866048 replay_runner.py:36] Average training steps per second: 187.64
I0902 23:56:44.558902 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 25

Steps executed: 234 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 188.90
I0902 23:56:50.082399 140720164866048 replay_runner.py:36] Average training steps per second: 188.90
I0902 23:56:50.284348 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 26

Steps executed: 267 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 189.70
I0902 23:56:55.802191 140720164866048 replay_runner.py:36] Average training steps per second: 189.70
I0902 23:56:56.031010 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 27

Steps executed: 265 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 191.57
I0902 23:57:01.499238 140720164866048 replay_runner.py:36] Average training steps per second: 191.57
I0902 23:57:01.724699 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 28
I0902 23:57:01.964680 140720164866048 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 188.82
I0902 23:57:07.261118 140720164866048 replay_runner.py:36] Average training steps per second: 188.82

Steps executed: 260 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Starting iteration 29

Steps executed: 260 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 197.62
I0902 23:57:12.786280 140720164866048 replay_runner.py:36] Average training steps per second: 197.62

Done fixed training!Episode length: 90 Return: -89.0.0