I0902 23:09:47.380599 139900407642112 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.381389 139900407642112 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.492858 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.494790 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.494929 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.495046 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.495276 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.495388 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:47.495512 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.495651 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.495748 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.495855 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.495949 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.496049 139900407642112 dqn_agent.py:283] 	 seed: 1630624187492776
I0902 23:09:47.499138 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.499337 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:47.499511 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.499651 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.499755 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.499854 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.499949 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.500039 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.500130 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.416931 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
I0902 23:09:56.169493 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:56.187153 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:56.238458 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:56.238780 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:56.244401 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:56.244541 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:56.244660 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:56.244758 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:56.244907 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:56.245009 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:56.245127 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:56.245242 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:56.245354 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:56.245454 139900407642112 dqn_agent.py:283] 	 seed: 1630624196238368
I0902 23:09:56.247763 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:56.247962 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:56.248091 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:56.248241 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:56.248461 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:56.248704 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:56.248789 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:56.249083 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:56.249457 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:56.882369 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Training fixed agent 7, please be patient, may be a while...
I0902 23:09:56.925760 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:56.926435 139900407642112 replay_runner.py:41] Starting iteration 0
Steps executed: 247 Episode length: 90 Return: -383.520275555212447
INFO:tensorflow:Average training steps per second: 145.03
I0902 23:10:03.822906 139900407642112 replay_runner.py:36] Average training steps per second: 145.03
I0902 23:10:04.692251 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.82
INFO:tensorflow:Starting iteration 1

Steps executed: 330 Episode length: 181 Return: -456.99382232606814
INFO:tensorflow:Average training steps per second: 205.13
I0902 23:10:13.800406 139900407642112 replay_runner.py:36] Average training steps per second: 205.13
I0902 23:10:14.148407 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.73
INFO:tensorflow:Starting iteration 2

Steps executed: 379 Episode length: 379 Return: -119.90615489535547
INFO:tensorflow:Average training steps per second: 208.76
I0902 23:10:23.275179 139900407642112 replay_runner.py:36] Average training steps per second: 208.76
I0902 23:10:23.975603 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.91
INFO:tensorflow:Starting iteration 3
I0902 23:10:28.342715 139900407642112 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 208.86

Steps executed: 1000 Episode length: 1000 Return: -229.08813336988996
I0902 23:10:36.437861 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.09
INFO:tensorflow:Starting iteration 4
I0902 23:10:40.584442 139900407642112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 213.75

Steps executed: 1000 Episode length: 1000 Return: -246.29353483548716
I0902 23:10:47.483196 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.29
INFO:tensorflow:Starting iteration 5
I0902 23:10:51.719924 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.52

Steps executed: 739 Episode length: 739 Return: -334.0755458611046716
I0902 23:10:57.713062 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.08
INFO:tensorflow:Starting iteration 6
I0902 23:11:02.045120 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 217.92

Steps executed: 954 Episode length: 954 Return: -429.9269319994212716
I0902 23:11:08.598307 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.93
INFO:tensorflow:Starting iteration 7

Steps executed: 612 Episode length: 612 Return: -455.7333015549058416
INFO:tensorflow:Average training steps per second: 221.63
I0902 23:11:17.467503 139900407642112 replay_runner.py:36] Average training steps per second: 221.63
I0902 23:11:18.645813 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.73
INFO:tensorflow:Starting iteration 8

Steps executed: 645 Episode length: 645 Return: -350.1129946059378416
INFO:tensorflow:Average training steps per second: 219.83
I0902 23:11:27.498353 139900407642112 replay_runner.py:36] Average training steps per second: 219.83
I0902 23:11:28.589316 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.11
INFO:tensorflow:Starting iteration 9
I0902 23:11:32.713880 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 216.63

Steps executed: 1000 Episode length: 1000 Return: -135.81546719276266
I0902 23:11:39.818225 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.82
INFO:tensorflow:Starting iteration 10
I0902 23:11:44.096926 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.00

Steps executed: 453 Episode length: 453 Return: -214.6712004454683266
I0902 23:11:49.632264 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.67
INFO:tensorflow:Starting iteration 11
I0902 23:11:53.790995 139900407642112 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 219.64

Steps executed: 1000 Episode length: 1000 Return: -168.30276517956872
I0902 23:12:01.312778 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.30
INFO:tensorflow:Starting iteration 12
I0902 23:12:05.610911 139900407642112 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 218.26

Steps executed: 1000 Episode length: 1000 Return: -145.60923678308416
I0902 23:12:12.055770 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.61
INFO:tensorflow:Starting iteration 13
I0902 23:12:16.293680 139900407642112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 220.84

Steps executed: 1000 Episode length: 1000 Return: -121.79714171877063
I0902 23:12:23.754282 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.80
INFO:tensorflow:Starting iteration 14
I0902 23:12:28.093831 139900407642112 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 219.81

Steps executed: 664 Episode length: 664 Return: -106.3688722379125763
I0902 23:12:33.918240 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.37
INFO:tensorflow:Starting iteration 15
I0902 23:12:38.120523 139900407642112 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 224.14
I0902 23:12:42.582535 139900407642112 replay_runner.py:36] Average training steps per second: 224.14

Steps executed: 1000 Episode length: 1000 Return: -85.923374658065513
INFO:tensorflow:Starting iteration 16
I0902 23:12:49.594073 139900407642112 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 256.03

Steps executed: 1000 Episode length: 1000 Return: -110.96227619939692
I0902 23:12:56.449769 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.96
INFO:tensorflow:Starting iteration 17

Steps executed: 492 Episode length: 414 Return: -263.9728030213254692
INFO:tensorflow:Average training steps per second: 246.88
I0902 23:13:04.463994 139900407642112 replay_runner.py:36] Average training steps per second: 246.88
I0902 23:13:05.112749 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.34
INFO:tensorflow:Starting iteration 18

Steps executed: 242 Episode length: 242 Return: 234.68143674630554692
INFO:tensorflow:Average training steps per second: 222.87
I0902 23:13:14.002880 139900407642112 replay_runner.py:36] Average training steps per second: 222.87
I0902 23:13:14.279420 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 234.68
INFO:tensorflow:Starting iteration 19

Steps executed: 100 Episode length: 100 Return: -68.07630116643739692
INFO:tensorflow:Average training steps per second: 227.14

Steps executed: 1100 Episode length: 1000 Return: 90.7531869242278592
I0902 23:13:25.822164 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.34
INFO:tensorflow:Starting iteration 20

Steps executed: 338 Episode length: 199 Return: -80.35534036619043592
INFO:tensorflow:Average training steps per second: 226.42
I0902 23:13:34.462314 139900407642112 replay_runner.py:36] Average training steps per second: 226.42
I0902 23:13:34.809738 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.29
INFO:tensorflow:Starting iteration 21
I0902 23:13:38.970210 139900407642112 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 226.27

Steps executed: 368 Episode length: 368 Return: -50.69093323876660492
I0902 23:13:43.932715 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -50.69
INFO:tensorflow:Starting iteration 22

Steps executed: 332 Episode length: 141 Return: -106.9586528000009292
INFO:tensorflow:Average training steps per second: 225.05
I0902 23:13:52.708598 139900407642112 replay_runner.py:36] Average training steps per second: 225.05
I0902 23:13:53.013431 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.60
INFO:tensorflow:Starting iteration 23
I0902 23:13:57.342698 139900407642112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 224.34

Steps executed: 282 Episode length: 166 Return: -124.4651228641377892
I0902 23:14:02.091430 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.34
INFO:tensorflow:Starting iteration 24

Steps executed: 248 Episode length: 248 Return: 12.661521831107422892
INFO:tensorflow:Average training steps per second: 226.70
I0902 23:14:10.797892 139900407642112 replay_runner.py:36] Average training steps per second: 226.70
I0902 23:14:11.094708 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.66
INFO:tensorflow:Starting iteration 25
I0902 23:14:15.446150 139900407642112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 226.86

Steps executed: 305 Episode length: 305 Return: -211.1614844432463792
I0902 23:14:20.319935 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.16
INFO:tensorflow:Starting iteration 26
I0902 23:14:24.579071 139900407642112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 224.66
I0902 23:14:29.030809 139900407642112 replay_runner.py:36] Average training steps per second: 224.66

Steps executed: 480 Episode length: 480 Return: -234.1897209121738792
INFO:tensorflow:Starting iteration 27
I0902 23:14:34.175268 139900407642112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 222.79

Steps executed: 1000 Episode length: 1000 Return: 120.138119510837852
I0902 23:14:40.875960 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.14
INFO:tensorflow:Starting iteration 28
I0902 23:14:45.131923 139900407642112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 223.93

Steps executed: 1000 Episode length: 1000 Return: 95.0821995940446252
I0902 23:14:53.303040 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.08
INFO:tensorflow:Starting iteration 29
I0902 23:14:57.652565 139900407642112 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 236.67

Steps executed: 1000 Episode length: 1000 Return: -53.412635220156832

Done fixed training! Episode length: 1000 Return: -53.412635220156832