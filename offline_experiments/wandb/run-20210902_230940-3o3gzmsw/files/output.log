I0902 23:09:47.131218 140310902786048 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.131901 140310902786048 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.207326 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.208750 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.208835 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.208899 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.208966 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.209019 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:47.209079 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.209165 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.209225 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.209366 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.209443 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.209527 140310902786048 dqn_agent.py:283] 	 seed: 1630624187207247
I0902 23:09:47.211482 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.211677 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:47.211749 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.211851 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.211918 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.211977 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.212060 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.212163 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.212242 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.587180 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.020358 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.028486 140310902786048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.034462 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:53.034619 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.034693 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.034753 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.034840 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.034889 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:53.034961 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:53.035054 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.035125 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.035192 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.035243 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.035294 140310902786048 dqn_agent.py:283] 	 seed: 1630624193034421
I0902 23:09:53.037821 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:53.038008 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:53.038169 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:53.038360 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:53.038506 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:53.038634 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:53.038766 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 23:09:53.038890 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:53.039013 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:53.619928 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.722978 140310902786048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:53.723294 140310902786048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 117.78
I0902 23:10:02.213953 140310902786048 replay_runner.py:36] Average training steps per second: 117.78
Steps executed: 281 Episode length: 125 Return: -207.77498901884636
I0902 23:10:03.619001 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.67
INFO:tensorflow:Starting iteration 1

Steps executed: 138 Episode length: 138 Return: -273.13706253056556
INFO:tensorflow:Average training steps per second: 205.78

Steps executed: 234 Episode length: 96 Return: -195.282946013669326
I0902 23:10:12.804966 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.21
INFO:tensorflow:Starting iteration 2

Steps executed: 340 Episode length: 340 Return: -661.04999328588766
INFO:tensorflow:Average training steps per second: 206.38
I0902 23:10:21.960638 140310902786048 replay_runner.py:36] Average training steps per second: 206.38
I0902 23:10:22.529288 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -661.05
INFO:tensorflow:Starting iteration 3

Steps executed: 129 Episode length: 129 Return: -223.29080039693866
INFO:tensorflow:Average training steps per second: 209.69

Steps executed: 1129 Episode length: 1000 Return: -153.24171001512636
I0902 23:10:34.057749 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.27
INFO:tensorflow:Starting iteration 4

Steps executed: 374 Episode length: 374 Return: -186.8411632184951836
INFO:tensorflow:Average training steps per second: 213.37
I0902 23:10:43.068802 140310902786048 replay_runner.py:36] Average training steps per second: 213.37
I0902 23:10:43.647541 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.84
INFO:tensorflow:Starting iteration 5
I0902 23:10:47.905860 140310902786048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 221.61

Steps executed: 1000 Episode length: 1000 Return: -240.48217115770274
I0902 23:10:54.871155 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.48
INFO:tensorflow:Starting iteration 6

Steps executed: 613 Episode length: 613 Return: -165.5830152834497574
INFO:tensorflow:Average training steps per second: 222.55
I0902 23:11:03.633729 140310902786048 replay_runner.py:36] Average training steps per second: 222.55
I0902 23:11:04.950287 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.58
INFO:tensorflow:Starting iteration 7

Steps executed: 367 Episode length: 367 Return: -818.4646443128106574
INFO:tensorflow:Average training steps per second: 223.86
I0902 23:11:13.755298 140310902786048 replay_runner.py:36] Average training steps per second: 223.86
I0902 23:11:14.371795 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -818.46
INFO:tensorflow:Starting iteration 8
I0902 23:11:18.767634 140310902786048 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 239.68

Steps executed: 474 Episode length: 474 Return: -256.1911173886836574
I0902 23:11:23.618214 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.19
INFO:tensorflow:Starting iteration 9
I0902 23:11:28.066434 140310902786048 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 230.30

Steps executed: 678 Episode length: 678 Return: -382.1162264663345574
I0902 23:11:34.367916 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.12
INFO:tensorflow:Starting iteration 10
I0902 23:11:38.637717 140310902786048 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 230.60

Steps executed: 639 Episode length: 639 Return: -380.9433144716768474
I0902 23:11:44.120149 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.94
INFO:tensorflow:Starting iteration 11

Steps executed: 204 Episode length: 204 Return: -252.0341974455378474
INFO:tensorflow:Average training steps per second: 232.58
I0902 23:11:52.822561 140310902786048 replay_runner.py:36] Average training steps per second: 232.58
I0902 23:11:53.058295 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.03
INFO:tensorflow:Starting iteration 12

Steps executed: 750 Episode length: 750 Return: -568.1897472362366474
INFO:tensorflow:Average training steps per second: 227.51
I0902 23:12:01.776187 140310902786048 replay_runner.py:36] Average training steps per second: 227.51
I0902 23:12:03.189942 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.19
INFO:tensorflow:Starting iteration 13

Steps executed: 443 Episode length: 443 Return: -376.8292073740292474
INFO:tensorflow:Average training steps per second: 218.79
I0902 23:12:12.184866 140310902786048 replay_runner.py:36] Average training steps per second: 218.79
I0902 23:12:12.834271 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.83
INFO:tensorflow:Starting iteration 14
I0902 23:12:17.209926 140310902786048 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 220.45

Steps executed: 1000 Episode length: 1000 Return: -112.23338952844969
I0902 23:12:24.739372 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.23
INFO:tensorflow:Starting iteration 15
I0902 23:12:28.996126 140310902786048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 219.59

Steps executed: 416 Episode length: 416 Return: 205.99218206957215969
I0902 23:12:34.168810 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: 205.99
INFO:tensorflow:Starting iteration 16
I0902 23:12:38.533816 140310902786048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 221.31

Steps executed: 448 Episode length: 448 Return: -107.7416663959999769
I0902 23:12:43.907648 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.74
INFO:tensorflow:Starting iteration 17
I0902 23:12:47.883279 140310902786048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 280.31

Steps executed: 190 Episode length: 67 Return: -250.94464378404177769

Steps executed: 900 Episode length: 710 Return: -436.1259809867588669
INFO:tensorflow:Starting iteration 18
I0902 23:12:57.025672 140310902786048 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 252.41

Steps executed: 1000 Episode length: 1000 Return: -60.325242318436019
I0902 23:13:04.865017 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.33
INFO:tensorflow:Starting iteration 19

Steps executed: 212 Episode length: 149 Return: -248.5875101399250619
INFO:tensorflow:Average training steps per second: 227.59
I0902 23:13:13.476890 140310902786048 replay_runner.py:36] Average training steps per second: 227.59
I0902 23:13:13.654718 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.12
INFO:tensorflow:Starting iteration 20
I0902 23:13:17.928708 140310902786048 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 224.95

Steps executed: 495 Episode length: 495 Return: -753.4903630922121619
I0902 23:13:23.443218 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -753.49
INFO:tensorflow:Starting iteration 21

Steps executed: 414 Episode length: 414 Return: -337.4936167726109519
INFO:tensorflow:Average training steps per second: 225.74
I0902 23:13:32.221681 140310902786048 replay_runner.py:36] Average training steps per second: 225.74
I0902 23:13:32.868363 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.49
INFO:tensorflow:Starting iteration 22
I0902 23:13:37.161309 140310902786048 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 221.90

Steps executed: 1000 Episode length: 1000 Return: 10.4621889558812939
I0902 23:13:46.559148 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.46
INFO:tensorflow:Starting iteration 23

Steps executed: 78 Episode length: 78 Return: -562.972716740302312939
INFO:tensorflow:Average training steps per second: 225.90
I0902 23:13:55.365087 140310902786048 replay_runner.py:36] Average training steps per second: 225.90

Steps executed: 208 Episode length: 61 Return: -463.26451288367422939
INFO:tensorflow:Starting iteration 24

Steps executed: 457 Episode length: 366 Return: -270.5162508917207939
INFO:tensorflow:Average training steps per second: 224.22
I0902 23:14:04.359130 140310902786048 replay_runner.py:36] Average training steps per second: 224.22
I0902 23:14:05.022452 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.94
INFO:tensorflow:Starting iteration 25
I0902 23:14:09.407838 140310902786048 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 225.13

Steps executed: 1000 Episode length: 1000 Return: 4.38774580977173239
I0902 23:14:17.599091 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: 4.39
INFO:tensorflow:Starting iteration 26

Steps executed: 291 Episode length: 138 Return: -399.6216490325222839
INFO:tensorflow:Average training steps per second: 225.09
I0902 23:14:26.417118 140310902786048 replay_runner.py:36] Average training steps per second: 225.09
I0902 23:14:26.679692 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.28
INFO:tensorflow:Starting iteration 27

Steps executed: 150 Episode length: 150 Return: -620.1269109923198839
INFO:tensorflow:Average training steps per second: 225.22

Steps executed: 1150 Episode length: 1000 Return: -30.109711822474829
I0902 23:14:38.604957 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.12
INFO:tensorflow:Starting iteration 28
I0902 23:14:43.019338 140310902786048 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 223.96

Steps executed: 1000 Episode length: 1000 Return: 113.567147499722529
I0902 23:14:50.576476 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.57
INFO:tensorflow:Starting iteration 29

Steps executed: 333 Episode length: 177 Return: -34.80830763502203529
INFO:tensorflow:Average training steps per second: 237.73
I0902 23:14:59.149857 140310902786048 replay_runner.py:36] Average training steps per second: 237.73

Done fixed training!Episode length: 177 Return: -34.80830763502203529