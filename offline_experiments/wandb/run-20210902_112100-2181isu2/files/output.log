I0902 11:21:07.089481 139870285514752 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 11:21:07.090328 139870285514752 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 11:21:07.182051 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:07.183266 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:07.183526 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:07.183610 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:07.183672 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:07.183722 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:07.183786 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:07.183848 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:07.183901 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:07.184056 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:07.184123 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:07.184206 139870285514752 dqn_agent.py:283] 	 seed: 1630581667181994
I0902 11:21:07.185971 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:07.186124 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:07.186203 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:07.186266 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:07.186322 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:07.186379 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:07.186450 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:07.186515 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:07.186576 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 11:21:08.572975 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.914434 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.924184 139870285514752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:21:08.928292 139870285514752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:08.928440 139870285514752 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:08.928510 139870285514752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:08.928572 139870285514752 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:08.928627 139870285514752 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:08.928680 139870285514752 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:08.928761 139870285514752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:08.928856 139870285514752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:08.928911 139870285514752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:08.928961 139870285514752 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:08.929031 139870285514752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:08.929117 139870285514752 dqn_agent.py:283] 	 seed: 1630581668928258
I0902 11:21:08.930787 139870285514752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:08.930905 139870285514752 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:08.930979 139870285514752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:08.931046 139870285514752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:08.931102 139870285514752 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:08.931155 139870285514752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:08.931208 139870285514752 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:08.931258 139870285514752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:08.931308 139870285514752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.949456 139870285514752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.961680 139870285514752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:21:08.961908 139870285514752 replay_runner.py:41] Starting iteration 0
Steps executed: 233 Episode length: 233 Return: -176.45983196565163
INFO:tensorflow:Average training steps per second: 170.49
I0902 11:21:14.828171 139870285514752 replay_runner.py:36] Average training steps per second: 170.49
I0902 11:21:15.937433 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.46
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 103 Return: -263.14435210071927
INFO:tensorflow:Average training steps per second: 210.64
I0902 11:21:24.705464 139870285514752 replay_runner.py:36] Average training steps per second: 210.64
I0902 11:21:24.881557 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.76
INFO:tensorflow:Starting iteration 2

Steps executed: 269 Episode length: 269 Return: -200.68545294353817
INFO:tensorflow:Average training steps per second: 205.00
I0902 11:21:33.875136 139870285514752 replay_runner.py:36] Average training steps per second: 205.00
I0902 11:21:34.272047 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.69
INFO:tensorflow:Starting iteration 3

Steps executed: 144 Episode length: 144 Return: -304.35090348538483
INFO:tensorflow:Average training steps per second: 209.58

Steps executed: 946 Episode length: 802 Return: -191.39095277008346
I0902 11:21:45.069423 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.87
INFO:tensorflow:Starting iteration 4
I0902 11:21:49.199161 139870285514752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 217.52

Steps executed: 1000 Episode length: 1000 Return: -64.73011312963656
I0902 11:21:55.724304 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.73
INFO:tensorflow:Starting iteration 5
I0902 11:21:59.992726 139870285514752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 220.98

Steps executed: 1000 Episode length: 1000 Return: -135.90342472767676
I0902 11:22:09.465054 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.90
INFO:tensorflow:Starting iteration 6
I0902 11:22:13.701711 139870285514752 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 221.95

Steps executed: 1000 Episode length: 1000 Return: -111.55765897731258
I0902 11:22:20.272298 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.56
INFO:tensorflow:Starting iteration 7

Steps executed: 372 Episode length: 372 Return: -426.9509280402395558
INFO:tensorflow:Average training steps per second: 216.08
I0902 11:22:29.286420 139870285514752 replay_runner.py:36] Average training steps per second: 216.08
I0902 11:22:29.801188 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.95
INFO:tensorflow:Starting iteration 8
I0902 11:22:34.039192 139870285514752 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 226.39

Steps executed: 999 Episode length: 999 Return: -431.2969174092811558
I0902 11:22:40.851624 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.30
INFO:tensorflow:Starting iteration 9

Steps executed: 509 Episode length: 509 Return: -330.4312335696372458
INFO:tensorflow:Average training steps per second: 227.84
I0902 11:22:49.500148 139870285514752 replay_runner.py:36] Average training steps per second: 227.84
I0902 11:22:50.364979 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.43
INFO:tensorflow:Starting iteration 10
I0902 11:22:54.655611 139870285514752 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 228.63

Steps executed: 1000 Episode length: 1000 Return: -142.54935385860048
I0902 11:23:02.485072 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.55
INFO:tensorflow:Starting iteration 11
I0902 11:23:06.760486 139870285514752 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 230.16


Steps executed: 1103 Episode length: 1000 Return: -129.64640259766548
I0902 11:23:14.772864 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.01
INFO:tensorflow:Starting iteration 12
I0902 11:23:19.001254 139870285514752 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 227.29

Steps executed: 919 Episode length: 919 Return: -237.8997458581103548
I0902 11:23:25.734690 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.90
INFO:tensorflow:Starting iteration 13
I0902 11:23:30.025386 139870285514752 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 224.12
I0902 11:23:34.487739 139870285514752 replay_runner.py:36] Average training steps per second: 224.12

Steps executed: 523 Episode length: 523 Return: -365.1590758742831548
INFO:tensorflow:Starting iteration 14
I0902 11:23:39.580961 139870285514752 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 236.54
I0902 11:23:43.809823 139870285514752 replay_runner.py:36] Average training steps per second: 236.54

Steps executed: 1000 Episode length: 1000 Return: -59.810388345360158
INFO:tensorflow:Starting iteration 15

Steps executed: 473 Episode length: 473 Return: -294.2990582464600558
INFO:tensorflow:Average training steps per second: 249.20
I0902 11:23:55.697665 139870285514752 replay_runner.py:36] Average training steps per second: 249.20
I0902 11:23:56.487544 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.30
INFO:tensorflow:Starting iteration 16

Steps executed: 338 Episode length: 338 Return: -291.3285276030820558
INFO:tensorflow:Average training steps per second: 289.23
I0902 11:24:03.994989 139870285514752 replay_runner.py:36] Average training steps per second: 289.23
I0902 11:24:04.307780 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.33
INFO:tensorflow:Starting iteration 17
I0902 11:24:08.450841 139870285514752 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 258.77

Steps executed: 838 Episode length: 838 Return: -332.3453141337178558
I0902 11:24:14.846047 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.35
INFO:tensorflow:Starting iteration 18
I0902 11:24:19.290590 139870285514752 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 231.51

Steps executed: 1000 Episode length: 1000 Return: -179.32792186847388
I0902 11:24:25.641301 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.33
INFO:tensorflow:Starting iteration 19

Steps executed: 164 Episode length: 164 Return: -83.94720053648271388
INFO:tensorflow:Average training steps per second: 227.15

Steps executed: 1120 Episode length: 956 Return: -107.807640643612158
I0902 11:24:37.771876 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.88
INFO:tensorflow:Starting iteration 20

Steps executed: 281 Episode length: 175 Return: -57.03580722085444758
INFO:tensorflow:Average training steps per second: 224.39
I0902 11:24:46.242779 139870285514752 replay_runner.py:36] Average training steps per second: 224.39
I0902 11:24:46.518004 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.58
INFO:tensorflow:Starting iteration 21
I0902 11:24:50.771706 139870285514752 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 220.12
I0902 11:24:55.315192 139870285514752 replay_runner.py:36] Average training steps per second: 220.12

Steps executed: 229 Episode length: 229 Return: -465.9779180992559758
INFO:tensorflow:Starting iteration 22

Steps executed: 444 Episode length: 444 Return: -117.8467366795290658
INFO:tensorflow:Average training steps per second: 223.11
I0902 11:25:04.393678 139870285514752 replay_runner.py:36] Average training steps per second: 223.11
I0902 11:25:05.198006 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.85
INFO:tensorflow:Starting iteration 23

Steps executed: 290 Episode length: 290 Return: -137.3245610955782658
INFO:tensorflow:Average training steps per second: 227.26
I0902 11:25:13.963817 139870285514752 replay_runner.py:36] Average training steps per second: 227.26
I0902 11:25:14.328106 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.32
INFO:tensorflow:Starting iteration 24
I0902 11:25:18.652251 139870285514752 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 222.64

Steps executed: 1000 Episode length: 1000 Return: 29.8777711100177268
I0902 11:25:26.635444 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: 29.88
INFO:tensorflow:Starting iteration 25

Steps executed: 53 Episode length: 53 Return: -119.658112661355057268
INFO:tensorflow:Average training steps per second: 223.37

Steps executed: 1053 Episode length: 1000 Return: 52.6061439814934868
I0902 11:25:39.423943 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.53
INFO:tensorflow:Starting iteration 26

Steps executed: 309 Episode length: 157 Return: -575.7782472662573868
INFO:tensorflow:Average training steps per second: 226.80
I0902 11:25:48.268332 139870285514752 replay_runner.py:36] Average training steps per second: 226.80
I0902 11:25:48.566805 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.37
INFO:tensorflow:Starting iteration 27
I0902 11:25:52.976493 139870285514752 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 230.19

Steps executed: 635 Episode length: 635 Return: -54.78014895183892568
I0902 11:25:58.845991 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.78
INFO:tensorflow:Starting iteration 28
I0902 11:26:03.196250 139870285514752 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 229.36

Steps executed: 1000 Episode length: 1000 Return: -17.998968519830168
I0902 11:26:10.390188 139870285514752 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.00
INFO:tensorflow:Starting iteration 29

Steps executed: 232 Episode length: 173 Return: 30.986725787352015168
INFO:tensorflow:Average training steps per second: 226.30
I0902 11:26:19.008308 139870285514752 replay_runner.py:36] Average training steps per second: 226.30

Done fixed training!Episode length: 173 Return: 30.986725787352015168