Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 23:25:01.695176 139633860089856 run_experiment.py:549] Creating TrainRunner ...
I0902 23:25:01.705444 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:01.705719 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:01.705852 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:01.706002 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:01.706177 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:01.706323 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:01.706432 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:01.706523 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:01.706622 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:01.706718 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:01.706814 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:01.706925 139633860089856 dqn_agent.py:283] 	 seed: 1630625101705382
I0902 23:25:01.710117 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:01.710348 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:01.710492 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:01.710652 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:01.711071 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:01.711299 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:01.711406 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:01.711487 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:01.711633 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:01.756382 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:02.301529 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:02.317649 139633860089856 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:25:02.326939 139633860089856 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:02.327130 139633860089856 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:02.327241 139633860089856 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:02.327330 139633860089856 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:02.327407 139633860089856 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:02.327488 139633860089856 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:02.327569 139633860089856 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:02.327653 139633860089856 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:02.327913 139633860089856 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:02.328064 139633860089856 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:02.328204 139633860089856 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:02.328300 139633860089856 dqn_agent.py:283] 	 seed: 1630625102326898
I0902 23:25:02.332070 139633860089856 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:02.332392 139633860089856 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:02.332629 139633860089856 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:02.332807 139633860089856 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:02.333025 139633860089856 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:02.333201 139633860089856 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:02.333338 139633860089856 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:02.333470 139633860089856 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:02.333634 139633860089856 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:02.369158 139633860089856 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:02.393389 139633860089856 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:25:02.393625 139633860089856 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.02
I0902 23:25:09.149622 139633860089856 replay_runner.py:36] Average training steps per second: 148.02
Steps executed: 283 Episode length: 129 Return: 129.0
I0902 23:25:10.301293 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.75
INFO:tensorflow:Starting iteration 1

Steps executed: 294 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 199.51
I0902 23:25:15.500146 139633860089856 replay_runner.py:36] Average training steps per second: 199.51
I0902 23:25:15.683911 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 2

Steps executed: 354 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.79
I0902 23:25:20.890041 139633860089856 replay_runner.py:36] Average training steps per second: 204.79
I0902 23:25:21.126492 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.68
I0902 23:25:26.315713 139633860089856 replay_runner.py:36] Average training steps per second: 202.68
I0902 23:25:26.463063 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 23:25:26.661159 139633860089856 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 199.06
I0902 23:25:31.685297 139633860089856 replay_runner.py:36] Average training steps per second: 199.06
I0902 23:25:31.833408 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:25:32.009306 139633860089856 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 193.34
I0902 23:25:37.182353 139633860089856 replay_runner.py:36] Average training steps per second: 193.34
I0902 23:25:37.319133 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:25:37.507144 139633860089856 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 200.51
I0902 23:25:42.494997 139633860089856 replay_runner.py:36] Average training steps per second: 200.51
I0902 23:25:42.631118 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 362 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 192.17
I0902 23:25:48.031483 139633860089856 replay_runner.py:36] Average training steps per second: 192.17
I0902 23:25:48.273358 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.00
INFO:tensorflow:Starting iteration 8

Steps executed: 153 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 198.82
I0902 23:25:53.496954 139633860089856 replay_runner.py:36] Average training steps per second: 198.82

Steps executed: 310 Episode length: 157 Return: 157.0
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.81
I0902 23:25:59.104681 139633860089856 replay_runner.py:36] Average training steps per second: 192.81
I0902 23:25:59.234675 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 327 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 199.65
I0902 23:26:04.438411 139633860089856 replay_runner.py:36] Average training steps per second: 199.65
I0902 23:26:04.648979 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.90
I0902 23:26:10.078397 139633860089856 replay_runner.py:36] Average training steps per second: 190.90
I0902 23:26:10.221822 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 393 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.00
I0902 23:26:15.530665 139633860089856 replay_runner.py:36] Average training steps per second: 196.00
I0902 23:26:15.777475 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.50
INFO:tensorflow:Starting iteration 13

Steps executed: 261 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 189.77
I0902 23:26:21.235876 139633860089856 replay_runner.py:36] Average training steps per second: 189.77
I0902 23:26:21.424391 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 14

Steps executed: 355 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 195.07
I0902 23:26:26.740024 139633860089856 replay_runner.py:36] Average training steps per second: 195.07
I0902 23:26:26.972016 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.50
INFO:tensorflow:Starting iteration 15

Steps executed: 300 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 193.70
I0902 23:26:32.322621 139633860089856 replay_runner.py:36] Average training steps per second: 193.70
I0902 23:26:32.532955 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.83
I0902 23:26:37.784520 139633860089856 replay_runner.py:36] Average training steps per second: 197.83
I0902 23:26:37.940101 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:26:38.132511 139633860089856 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.05
I0902 23:26:43.259723 139633860089856 replay_runner.py:36] Average training steps per second: 195.05
I0902 23:26:43.402194 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:26:43.604873 139633860089856 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.33
I0902 23:26:48.724871 139633860089856 replay_runner.py:36] Average training steps per second: 195.33
I0902 23:26:48.857398 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:26:49.050574 139633860089856 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 194.00
I0902 23:26:54.205646 139633860089856 replay_runner.py:36] Average training steps per second: 194.00
I0902 23:26:54.349646 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:26:54.549869 139633860089856 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.16
I0902 23:26:59.727348 139633860089856 replay_runner.py:36] Average training steps per second: 193.16
I0902 23:26:59.868965 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:27:00.059739 139633860089856 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.01
I0902 23:27:05.110580 139633860089856 replay_runner.py:36] Average training steps per second: 198.01
I0902 23:27:05.261269 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:27:05.466272 139633860089856 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.44
I0902 23:27:10.636357 139633860089856 replay_runner.py:36] Average training steps per second: 193.44
I0902 23:27:10.775798 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 385 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.64
I0902 23:27:16.033221 139633860089856 replay_runner.py:36] Average training steps per second: 197.64
I0902 23:27:16.316729 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.22
I0902 23:27:21.668426 139633860089856 replay_runner.py:36] Average training steps per second: 194.22
I0902 23:27:21.802585 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:27:21.991204 139633860089856 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.51
I0902 23:27:27.106332 139633860089856 replay_runner.py:36] Average training steps per second: 195.51
I0902 23:27:27.247729 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:27:27.444926 139633860089856 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.54
I0902 23:27:32.585983 139633860089856 replay_runner.py:36] Average training steps per second: 194.54
I0902 23:27:32.723523 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:27:32.905494 139633860089856 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 203.34
I0902 23:27:37.823859 139633860089856 replay_runner.py:36] Average training steps per second: 203.34
I0902 23:27:37.953967 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:27:38.144718 139633860089856 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.60
I0902 23:27:43.283771 139633860089856 replay_runner.py:36] Average training steps per second: 194.60
I0902 23:27:43.417884 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.37
I0902 23:27:48.551123 139633860089856 replay_runner.py:36] Average training steps per second: 202.37
I0902 23:27:48.684491 139633860089856 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00