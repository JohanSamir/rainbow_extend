Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0828 10:37:46.812906 140078257940480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:37:46.825389 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:46.825641 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:46.825820 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:46.826007 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:46.826162 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:46.826328 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:37:46.826436 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:46.826542 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:46.826642 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:46.826742 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:46.827007 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:46.827360 140078257940480 dqn_agent.py:283] 	 seed: 1630147066825318
I0828 10:37:46.830729 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:46.830915 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:37:46.831100 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:46.831248 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:46.831346 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:46.831688 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:46.831913 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:46.832009 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:46.832194 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:46.871020 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:47.261207 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:47.276841 140078257940480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:37:47.286752 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:47.287004 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:47.287182 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:47.287386 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:47.287564 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:47.287691 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:37:47.287800 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:47.287908 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:47.288015 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:47.288121 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:47.288216 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:47.288298 140078257940480 dqn_agent.py:283] 	 seed: 1630147067286690
I0828 10:37:47.291290 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:47.291505 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:37:47.291613 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:47.291716 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:47.291812 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:47.291927 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:47.292020 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:47.292113 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:47.292204 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:47.370124 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.100000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:47.392651 140078257940480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:37:47.393175 140078257940480 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 160.69
I0828 10:37:53.616724 140078257940480 replay_runner.py:36] Average training steps per second: 160.69
Steps executed: 257 Episode length: 66 Return: -617.5177699032539
I0828 10:37:54.863339 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -581.19
INFO:tensorflow:Starting iteration 1

Steps executed: 230 Episode length: 87 Return: -565.8284720026561
INFO:tensorflow:Average training steps per second: 222.61
I0828 10:38:03.587993 140078257940480 replay_runner.py:36] Average training steps per second: 222.61
I0828 10:38:03.815958 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -577.99
INFO:tensorflow:Starting iteration 2

Steps executed: 209 Episode length: 84 Return: -213.108815409861082
INFO:tensorflow:Average training steps per second: 219.32
I0828 10:38:12.665034 140078257940480 replay_runner.py:36] Average training steps per second: 219.32
I0828 10:38:12.809129 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.23
INFO:tensorflow:Starting iteration 3

Steps executed: 299 Episode length: 103 Return: -65.518749909101562
INFO:tensorflow:Average training steps per second: 215.77
I0828 10:38:21.859167 140078257940480 replay_runner.py:36] Average training steps per second: 215.77
I0828 10:38:22.101176 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.55
INFO:tensorflow:Starting iteration 4

Steps executed: 272 Episode length: 105 Return: -351.99019396701482
INFO:tensorflow:Average training steps per second: 218.84
I0828 10:38:31.094671 140078257940480 replay_runner.py:36] Average training steps per second: 218.84
I0828 10:38:31.321220 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.79
INFO:tensorflow:Starting iteration 5

Steps executed: 243 Episode length: 81 Return: -256.688755481011072
INFO:tensorflow:Average training steps per second: 223.70
I0828 10:38:40.217487 140078257940480 replay_runner.py:36] Average training steps per second: 223.70
I0828 10:38:40.425306 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.56
INFO:tensorflow:Starting iteration 6

Steps executed: 243 Episode length: 84 Return: -539.465024297212572
INFO:tensorflow:Average training steps per second: 216.79
I0828 10:38:49.413680 140078257940480 replay_runner.py:36] Average training steps per second: 216.79
I0828 10:38:49.631720 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.49
INFO:tensorflow:Starting iteration 7

Steps executed: 227 Episode length: 81 Return: -419.093063628079172
INFO:tensorflow:Average training steps per second: 220.66
I0828 10:38:58.525759 140078257940480 replay_runner.py:36] Average training steps per second: 220.66
I0828 10:38:58.717229 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.97
INFO:tensorflow:Starting iteration 8

Steps executed: 263 Episode length: 69 Return: -241.958371726350522
INFO:tensorflow:Average training steps per second: 218.51
I0828 10:39:07.693345 140078257940480 replay_runner.py:36] Average training steps per second: 218.51
I0828 10:39:07.936589 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.75
INFO:tensorflow:Starting iteration 9

Steps executed: 247 Episode length: 88 Return: -361.479829986665372
INFO:tensorflow:Average training steps per second: 230.43
I0828 10:39:16.659162 140078257940480 replay_runner.py:36] Average training steps per second: 230.43
I0828 10:39:16.858066 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.19
INFO:tensorflow:Starting iteration 10

Steps executed: 282 Episode length: 114 Return: -458.71492634242872
INFO:tensorflow:Average training steps per second: 230.85
I0828 10:39:25.385683 140078257940480 replay_runner.py:36] Average training steps per second: 230.85
I0828 10:39:25.671053 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -661.18
INFO:tensorflow:Starting iteration 11

Steps executed: 243 Episode length: 243 Return: -279.75477491897936
INFO:tensorflow:Average training steps per second: 231.38
I0828 10:39:34.338788 140078257940480 replay_runner.py:36] Average training steps per second: 231.38
I0828 10:39:34.621440 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.75
INFO:tensorflow:Starting iteration 12

Steps executed: 295 Episode length: 295 Return: -484.34089655775796
INFO:tensorflow:Average training steps per second: 223.93
I0828 10:39:43.477165 140078257940480 replay_runner.py:36] Average training steps per second: 223.93
I0828 10:39:43.857119 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -484.34
INFO:tensorflow:Starting iteration 13

Steps executed: 216 Episode length: 77 Return: -559.963681149581966
INFO:tensorflow:Average training steps per second: 222.57
I0828 10:39:52.595644 140078257940480 replay_runner.py:36] Average training steps per second: 222.57
I0828 10:39:52.784263 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.13
INFO:tensorflow:Starting iteration 14

Steps executed: 217 Episode length: 85 Return: -406.112253236909366
INFO:tensorflow:Average training steps per second: 223.05
I0828 10:40:01.643878 140078257940480 replay_runner.py:36] Average training steps per second: 223.05
I0828 10:40:01.835288 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.75
INFO:tensorflow:Starting iteration 15
I0828 10:40:06.087437 140078257940480 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 216.34
I0828 10:40:10.710193 140078257940480 replay_runner.py:36] Average training steps per second: 216.34

Steps executed: 247 Episode length: 86 Return: -113.983771042454186
INFO:tensorflow:Starting iteration 16

Steps executed: 239 Episode length: 61 Return: -458.322312373426546
INFO:tensorflow:Average training steps per second: 233.68
I0828 10:40:19.673097 140078257940480 replay_runner.py:36] Average training steps per second: 233.68
I0828 10:40:19.872705 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -493.53
INFO:tensorflow:Starting iteration 17

Steps executed: 228 Episode length: 82 Return: -554.966411541610146
INFO:tensorflow:Average training steps per second: 225.02
I0828 10:40:28.505382 140078257940480 replay_runner.py:36] Average training steps per second: 225.02
I0828 10:40:28.693734 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.59
INFO:tensorflow:Starting iteration 18

Steps executed: 243 Episode length: 73 Return: -134.298946798545444
INFO:tensorflow:Average training steps per second: 217.26
I0828 10:40:37.672412 140078257940480 replay_runner.py:36] Average training steps per second: 217.26
I0828 10:40:37.913626 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -660.21
INFO:tensorflow:Starting iteration 19

Steps executed: 267 Episode length: 180 Return: -1337.7884870453984
INFO:tensorflow:Average training steps per second: 216.86
I0828 10:40:46.949028 140078257940480 replay_runner.py:36] Average training steps per second: 216.86
I0828 10:40:47.258378 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -878.61
INFO:tensorflow:Starting iteration 20

Steps executed: 252 Episode length: 77 Return: -133.142223923086166
INFO:tensorflow:Average training steps per second: 218.24
I0828 10:40:56.289377 140078257940480 replay_runner.py:36] Average training steps per second: 218.24
I0828 10:40:56.464174 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.46
INFO:tensorflow:Starting iteration 21

Steps executed: 281 Episode length: 98 Return: 30.86918408880115466
INFO:tensorflow:Average training steps per second: 219.12
I0828 10:41:05.455338 140078257940480 replay_runner.py:36] Average training steps per second: 219.12
I0828 10:41:05.723512 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.96
INFO:tensorflow:Starting iteration 22

Steps executed: 217 Episode length: 136 Return: -813.01628957253566
INFO:tensorflow:Average training steps per second: 217.14
I0828 10:41:14.739376 140078257940480 replay_runner.py:36] Average training steps per second: 217.14
I0828 10:41:14.961547 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -612.34
INFO:tensorflow:Starting iteration 23

Steps executed: 224 Episode length: 83 Return: -121.645361898943976
INFO:tensorflow:Average training steps per second: 218.12
I0828 10:41:23.852655 140078257940480 replay_runner.py:36] Average training steps per second: 218.12
I0828 10:41:24.054336 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.43
INFO:tensorflow:Starting iteration 24

Steps executed: 177 Episode length: 76 Return: -395.382544313930256
INFO:tensorflow:Average training steps per second: 217.31

Steps executed: 299 Episode length: 122 Return: -370.80629302893356
I0828 10:41:33.180815 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.70
INFO:tensorflow:Starting iteration 25

Steps executed: 229 Episode length: 99 Return: -429.951779014336166
INFO:tensorflow:Average training steps per second: 218.06
I0828 10:41:42.154941 140078257940480 replay_runner.py:36] Average training steps per second: 218.06
I0828 10:41:42.359759 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.49
INFO:tensorflow:Starting iteration 26
I0828 10:41:46.579420 140078257940480 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 219.48

Steps executed: 287 Episode length: 162 Return: -558.23529949927916
I0828 10:41:51.407661 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -654.97
INFO:tensorflow:Starting iteration 27

Steps executed: 221 Episode length: 75 Return: -229.078150745278916
INFO:tensorflow:Average training steps per second: 219.49
I0828 10:42:00.208261 140078257940480 replay_runner.py:36] Average training steps per second: 219.49
I0828 10:42:00.413450 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.81
INFO:tensorflow:Starting iteration 28
I0828 10:42:04.733130 140078257940480 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 220.11

Steps executed: 272 Episode length: 102 Return: -792.34913154778054
I0828 10:42:09.553490 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -915.33
INFO:tensorflow:Starting iteration 29

Steps executed: 244 Episode length: 77 Return: -128.819085789451694
INFO:tensorflow:Average training steps per second: 224.41
I0828 10:42:18.355454 140078257940480 replay_runner.py:36] Average training steps per second: 224.41

Done fixed training!Episode length: 77 Return: -128.819085789451694