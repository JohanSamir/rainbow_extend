Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 18:09:50.296756 140110082734080 run_experiment.py:549] Creating TrainRunner ...
I0902 18:09:50.307997 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:50.308270 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:50.308472 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:50.308609 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:50.308732 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:50.308874 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:09:50.309064 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:50.309197 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:50.309324 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:50.309445 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:50.309659 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:50.309821 140110082734080 dqn_agent.py:283] 	 seed: 1630606190307928
I0902 18:09:50.313349 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:50.313630 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:09:50.313812 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:50.313948 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:50.314116 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:50.314274 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:50.314400 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:50.314511 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:50.314683 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:50.351024 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:50.723844 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:50.736767 140110082734080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:09:50.746459 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:50.746737 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:50.746887 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:50.746994 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:50.747150 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:50.747354 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:09:50.747445 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:50.747543 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:50.747654 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:50.747753 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:50.747878 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:50.747978 140110082734080 dqn_agent.py:283] 	 seed: 1630606190746405
I0902 18:09:50.750357 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:50.750625 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:09:50.750781 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:50.750960 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:50.751185 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:50.751408 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:50.751675 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:50.751842 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:50.751977 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:50.819905 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:09:50.842837 140110082734080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:09:50.843115 140110082734080 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.42
I0902 18:09:56.962369 140110082734080 replay_runner.py:36] Average training steps per second: 163.42
Steps executed: 305 Episode length: 144 Return: -495.6121791852931
I0902 18:09:58.228074 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -579.65
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 207 Return: -137.68366131094206
INFO:tensorflow:Average training steps per second: 223.58
I0902 18:10:07.059797 140110082734080 replay_runner.py:36] Average training steps per second: 223.58
I0902 18:10:07.247853 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.68
INFO:tensorflow:Starting iteration 2

Steps executed: 246 Episode length: 154 Return: -243.97356925788444
INFO:tensorflow:Average training steps per second: 223.00
I0902 18:10:16.080527 140110082734080 replay_runner.py:36] Average training steps per second: 223.00
I0902 18:10:16.280901 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.10
INFO:tensorflow:Starting iteration 3

Steps executed: 236 Episode length: 139 Return: -244.49928892728457
INFO:tensorflow:Average training steps per second: 224.24
I0902 18:10:25.098964 140110082734080 replay_runner.py:36] Average training steps per second: 224.24
I0902 18:10:25.315129 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.20
INFO:tensorflow:Starting iteration 4

Steps executed: 263 Episode length: 136 Return: -210.62873363249364
INFO:tensorflow:Average training steps per second: 222.30
I0902 18:10:34.158423 140110082734080 replay_runner.py:36] Average training steps per second: 222.30
I0902 18:10:34.390980 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.86
INFO:tensorflow:Starting iteration 5

Steps executed: 223 Episode length: 91 Return: -509.523891031281154
INFO:tensorflow:Average training steps per second: 219.65
I0902 18:10:43.028690 140110082734080 replay_runner.py:36] Average training steps per second: 219.65
I0902 18:10:43.213576 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.25
INFO:tensorflow:Starting iteration 6
I0902 18:10:47.542877 140110082734080 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 227.38

Steps executed: 219 Episode length: 219 Return: -189.54044500101224
I0902 18:10:52.182841 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.54
INFO:tensorflow:Starting iteration 7

Steps executed: 262 Episode length: 121 Return: -357.03118417782485
INFO:tensorflow:Average training steps per second: 235.04
I0902 18:11:00.717170 140110082734080 replay_runner.py:36] Average training steps per second: 235.04
I0902 18:11:00.951711 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.26
INFO:tensorflow:Starting iteration 8

Steps executed: 228 Episode length: 106 Return: -281.11309353610345
INFO:tensorflow:Average training steps per second: 246.84
I0902 18:11:09.136620 140110082734080 replay_runner.py:36] Average training steps per second: 246.84
I0902 18:11:09.314872 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.48
INFO:tensorflow:Starting iteration 9

Steps executed: 279 Episode length: 160 Return: -149.12085250419233
INFO:tensorflow:Average training steps per second: 260.45
I0902 18:11:17.165352 140110082734080 replay_runner.py:36] Average training steps per second: 260.45
I0902 18:11:17.381887 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.16
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 78 Return: -285.694584029489873
INFO:tensorflow:Average training steps per second: 265.98
I0902 18:11:25.100952 140110082734080 replay_runner.py:36] Average training steps per second: 265.98
I0902 18:11:25.247216 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -338.05
INFO:tensorflow:Starting iteration 11

Steps executed: 238 Episode length: 119 Return: -223.28562157881134
INFO:tensorflow:Average training steps per second: 260.47
I0902 18:11:32.904569 140110082734080 replay_runner.py:36] Average training steps per second: 260.47
I0902 18:11:33.071640 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.01
INFO:tensorflow:Starting iteration 12

Steps executed: 250 Episode length: 104 Return: -62.866796977560427
INFO:tensorflow:Average training steps per second: 265.18
I0902 18:11:40.773203 140110082734080 replay_runner.py:36] Average training steps per second: 265.18
I0902 18:11:40.958624 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.55
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 105 Return: -101.31317234662095
INFO:tensorflow:Average training steps per second: 268.08
I0902 18:11:48.538635 140110082734080 replay_runner.py:36] Average training steps per second: 268.08
I0902 18:11:48.723317 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.50
INFO:tensorflow:Starting iteration 14

Steps executed: 229 Episode length: 163 Return: -535.35357967765395
INFO:tensorflow:Average training steps per second: 276.60
I0902 18:11:56.105393 140110082734080 replay_runner.py:36] Average training steps per second: 276.60
I0902 18:11:56.251821 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.86
INFO:tensorflow:Starting iteration 15

Steps executed: 272 Episode length: 86 Return: -347.075815945263675
INFO:tensorflow:Average training steps per second: 301.11
I0902 18:12:03.162306 140110082734080 replay_runner.py:36] Average training steps per second: 301.11
I0902 18:12:03.336971 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.82
INFO:tensorflow:Starting iteration 16

Steps executed: 209 Episode length: 91 Return: -95.9318233038093794
INFO:tensorflow:Average training steps per second: 320.71
I0902 18:12:09.900842 140110082734080 replay_runner.py:36] Average training steps per second: 320.71
I0902 18:12:10.015304 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.28
INFO:tensorflow:Starting iteration 17


Steps executed: 225 Episode length: 67 Return: 27.57673230086077975
INFO:tensorflow:Average training steps per second: 328.55
I0902 18:12:16.498601 140110082734080 replay_runner.py:36] Average training steps per second: 328.55
I0902 18:12:16.638484 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.86
INFO:tensorflow:Starting iteration 18

Steps executed: 247 Episode length: 67 Return: -142.637511069638445
INFO:tensorflow:Average training steps per second: 333.60
I0902 18:12:23.010291 140110082734080 replay_runner.py:36] Average training steps per second: 333.60
I0902 18:12:23.143757 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.64
INFO:tensorflow:Starting iteration 19

Steps executed: 255 Episode length: 83 Return: -274.600425509487655
INFO:tensorflow:Average training steps per second: 332.63
I0902 18:12:29.571578 140110082734080 replay_runner.py:36] Average training steps per second: 332.63
I0902 18:12:29.683534 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.25
INFO:tensorflow:Starting iteration 20

Steps executed: 58 Episode length: 58 Return: -154.9452204135373655
INFO:tensorflow:Average training steps per second: 316.96
I0902 18:12:36.211863 140110082734080 replay_runner.py:36] Average training steps per second: 316.96

Steps executed: 326 Episode length: 143 Return: -303.92032574950425
INFO:tensorflow:Starting iteration 21

Steps executed: 240 Episode length: 61 Return: -159.968793629957475
INFO:tensorflow:Average training steps per second: 335.55
I0902 18:12:42.752839 140110082734080 replay_runner.py:36] Average training steps per second: 335.55
I0902 18:12:42.867304 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.05
INFO:tensorflow:Starting iteration 22

Steps executed: 381 Episode length: 293 Return: -303.86778905769035
INFO:tensorflow:Average training steps per second: 339.22
I0902 18:12:49.190722 140110082734080 replay_runner.py:36] Average training steps per second: 339.22
I0902 18:12:49.459695 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.67
INFO:tensorflow:Starting iteration 23

Steps executed: 227 Episode length: 63 Return: -121.762848756478975
INFO:tensorflow:Average training steps per second: 337.08
I0902 18:12:55.828184 140110082734080 replay_runner.py:36] Average training steps per second: 337.08
I0902 18:12:55.940471 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.03
INFO:tensorflow:Starting iteration 24

Steps executed: 197 Episode length: 96 Return: -242.324369997336313
INFO:tensorflow:Average training steps per second: 351.27

Steps executed: 817 Episode length: 620 Return: -113.53415960186372
I0902 18:13:02.855270 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.37
INFO:tensorflow:Starting iteration 25

Steps executed: 361 Episode length: 169 Return: -138.55746178730542
INFO:tensorflow:Average training steps per second: 358.05
I0902 18:13:09.133415 140110082734080 replay_runner.py:36] Average training steps per second: 358.05
I0902 18:13:09.318003 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.76
INFO:tensorflow:Starting iteration 26

Steps executed: 138 Episode length: 138 Return: -211.45315453774143
INFO:tensorflow:Average training steps per second: 335.99

Steps executed: 842 Episode length: 704 Return: -378.42873225444185
I0902 18:13:16.790465 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.94
INFO:tensorflow:Starting iteration 27

Steps executed: 205 Episode length: 127 Return: -92.447449497532875
INFO:tensorflow:Average training steps per second: 348.06
I0902 18:13:23.141100 140110082734080 replay_runner.py:36] Average training steps per second: 348.06
I0902 18:13:23.258464 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.58
INFO:tensorflow:Starting iteration 28

Steps executed: 269 Episode length: 90 Return: -344.008673645663675
INFO:tensorflow:Average training steps per second: 342.73
I0902 18:13:29.570399 140110082734080 replay_runner.py:36] Average training steps per second: 342.73
I0902 18:13:29.704746 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -385.35
INFO:tensorflow:Starting iteration 29

Steps executed: 213 Episode length: 69 Return: -499.122664734173555
INFO:tensorflow:Average training steps per second: 350.32
I0902 18:13:35.997115 140110082734080 replay_runner.py:36] Average training steps per second: 350.32

Done fixed training!Episode length: 69 Return: -499.122664734173555