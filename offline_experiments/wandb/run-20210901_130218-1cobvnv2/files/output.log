I0901 13:02:25.090534 140162147342336 run_experiment.py:549] Creating TrainRunner ...
I0901 13:02:25.101065 140162147342336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:02:25.101393 140162147342336 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:02:25.101546 140162147342336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:02:25.101636 140162147342336 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:02:25.101748 140162147342336 dqn_agent.py:275] 	 update_period: 4
I0901 13:02:25.101863 140162147342336 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:02:25.102058 140162147342336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:02:25.102195 140162147342336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:02:25.102310 140162147342336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:02:25.102427 140162147342336 dqn_agent.py:280] 	 optimizer: adam
I0901 13:02:25.102517 140162147342336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:02:25.102608 140162147342336 dqn_agent.py:283] 	 seed: 1630501345100983
I0901 13:02:25.105261 140162147342336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:02:25.105482 140162147342336 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:02:25.105667 140162147342336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:02:25.105841 140162147342336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:02:25.105952 140162147342336 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:02:25.106161 140162147342336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:02:25.106297 140162147342336 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:02:25.106428 140162147342336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:02:25.106633 140162147342336 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0901 13:02:26.794261 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:27.435523 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:27.450662 140162147342336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:02:27.466445 140162147342336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:02:27.466866 140162147342336 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:02:27.467024 140162147342336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:02:27.467189 140162147342336 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:02:27.467307 140162147342336 dqn_agent.py:275] 	 update_period: 4
I0901 13:02:27.467456 140162147342336 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:02:27.467544 140162147342336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:02:27.467679 140162147342336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:02:27.468096 140162147342336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:02:27.468349 140162147342336 dqn_agent.py:280] 	 optimizer: adam
I0901 13:02:27.468506 140162147342336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:02:27.468672 140162147342336 dqn_agent.py:283] 	 seed: 1630501347466323
I0901 13:02:27.471439 140162147342336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:02:27.471597 140162147342336 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:02:27.471674 140162147342336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:02:27.471764 140162147342336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:02:27.471879 140162147342336 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:02:27.471985 140162147342336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:02:27.472079 140162147342336 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:02:27.472292 140162147342336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:02:27.472581 140162147342336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:02:27.513667 140162147342336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:27.539285 140162147342336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:02:27.539765 140162147342336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.27
I0901 13:02:34.520342 140162147342336 replay_runner.py:36] Average training steps per second: 143.27
Steps executed: 204 Episode length: 10 Return: 10.0
I0901 13:02:35.645459 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 187.79
I0901 13:02:41.167993 140162147342336 replay_runner.py:36] Average training steps per second: 187.79
I0901 13:02:41.298204 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 2

Steps executed: 149 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 192.20
I0901 13:02:46.686516 140162147342336 replay_runner.py:36] Average training steps per second: 192.20

Steps executed: 203 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Starting iteration 3

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.29
I0901 13:02:52.186384 140162147342336 replay_runner.py:36] Average training steps per second: 193.29
I0901 13:02:52.310923 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 4

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.06
I0901 13:02:57.617228 140162147342336 replay_runner.py:36] Average training steps per second: 195.06
I0901 13:02:57.741364 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 5

Steps executed: 10 Episode length: 10 Return: 10.00
INFO:tensorflow:Average training steps per second: 198.58

Steps executed: 207 Episode length: 9 Return: 9.0.0
I0901 13:03:03.094810 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 197.17
I0901 13:03:08.343835 140162147342336 replay_runner.py:36] Average training steps per second: 197.17
I0901 13:03:08.459717 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 7
I0901 13:03:08.637091 140162147342336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 205.79
I0901 13:03:13.496838 140162147342336 replay_runner.py:36] Average training steps per second: 205.79
I0901 13:03:13.619888 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.15
INFO:tensorflow:Starting iteration 8

Steps executed: 203 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 210.62
I0901 13:03:18.557015 140162147342336 replay_runner.py:36] Average training steps per second: 210.62
I0901 13:03:18.675863 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.82
I0901 13:03:23.672191 140162147342336 replay_runner.py:36] Average training steps per second: 207.82
I0901 13:03:23.845508 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 10

Steps executed: 299 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 214.26
I0901 13:03:28.681867 140162147342336 replay_runner.py:36] Average training steps per second: 214.26
I0901 13:03:28.812545 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 11

Steps executed: 236 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 204.80
I0901 13:03:33.874048 140162147342336 replay_runner.py:36] Average training steps per second: 204.80
I0901 13:03:34.066802 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 12


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 211.40
I0901 13:03:38.971407 140162147342336 replay_runner.py:36] Average training steps per second: 211.40
I0901 13:03:39.095112 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0901 13:03:39.276416 140162147342336 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 209.16
I0901 13:03:44.057795 140162147342336 replay_runner.py:36] Average training steps per second: 209.16
I0901 13:03:44.166862 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0901 13:03:44.337560 140162147342336 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 215.22

Steps executed: 142 Episode length: 142 Return: 142.0
I0901 13:03:49.162698 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 15

Steps executed: 279 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 211.79
I0901 13:03:54.067873 140162147342336 replay_runner.py:36] Average training steps per second: 211.79
I0901 13:03:54.196723 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.87
INFO:tensorflow:Starting iteration 16


Steps executed: 204 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 209.98
I0901 13:03:59.132378 140162147342336 replay_runner.py:36] Average training steps per second: 209.98
I0901 13:03:59.251784 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.74
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 15 Return: 15.0.0
INFO:tensorflow:Average training steps per second: 213.77
I0901 13:04:04.105317 140162147342336 replay_runner.py:36] Average training steps per second: 213.77
I0901 13:04:04.215655 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.33
INFO:tensorflow:Starting iteration 18

Steps executed: 204 Episode length: 13 Return: 13.0.0
INFO:tensorflow:Average training steps per second: 205.09
I0901 13:04:09.261607 140162147342336 replay_runner.py:36] Average training steps per second: 205.09
I0901 13:04:09.391701 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.33
INFO:tensorflow:Starting iteration 19

Steps executed: 208 Episode length: 12 Return: 12.0.0
INFO:tensorflow:Average training steps per second: 211.88
I0901 13:04:14.298704 140162147342336 replay_runner.py:36] Average training steps per second: 211.88
I0901 13:04:14.425679 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.24
INFO:tensorflow:Starting iteration 20

Steps executed: 203 Episode length: 10 Return: 10.0.0
INFO:tensorflow:Average training steps per second: 210.03
I0901 13:04:19.365196 140162147342336 replay_runner.py:36] Average training steps per second: 210.03
I0901 13:04:19.485976 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.94
INFO:tensorflow:Starting iteration 21

Steps executed: 212 Episode length: 16 Return: 16.0.0
INFO:tensorflow:Average training steps per second: 222.38
I0901 13:04:24.164597 140162147342336 replay_runner.py:36] Average training steps per second: 222.38
I0901 13:04:24.275110 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.14
INFO:tensorflow:Starting iteration 22

Steps executed: 281 Episode length: 89 Return: 89.0.0
INFO:tensorflow:Average training steps per second: 216.39
I0901 13:04:29.067463 140162147342336 replay_runner.py:36] Average training steps per second: 216.39
I0901 13:04:29.215974 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.67
INFO:tensorflow:Starting iteration 23
I0901 13:04:29.388096 140162147342336 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 231.21
I0901 13:04:33.713495 140162147342336 replay_runner.py:36] Average training steps per second: 231.21
I0901 13:04:33.891901 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 24


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 230.42
I0901 13:04:38.395525 140162147342336 replay_runner.py:36] Average training steps per second: 230.42
I0901 13:04:38.499351 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 13:04:38.665817 140162147342336 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 233.84
I0901 13:04:42.942492 140162147342336 replay_runner.py:36] Average training steps per second: 233.84
I0901 13:04:43.042466 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 13:04:43.200824 140162147342336 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 236.23
I0901 13:04:47.434311 140162147342336 replay_runner.py:36] Average training steps per second: 236.23
I0901 13:04:47.539515 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 13:04:47.704729 140162147342336 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 242.28
I0901 13:04:51.832569 140162147342336 replay_runner.py:36] Average training steps per second: 242.28
I0901 13:04:51.919671 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 338 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 251.06
I0901 13:04:56.055038 140162147342336 replay_runner.py:36] Average training steps per second: 251.06
I0901 13:04:56.226597 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 232.55
I0901 13:05:00.691916 140162147342336 replay_runner.py:36] Average training steps per second: 232.55
I0901 13:05:00.814798 140162147342336 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00