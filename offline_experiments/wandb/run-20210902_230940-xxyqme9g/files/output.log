I0902 23:09:47.293722 140561847887872 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.294343 140561847887872 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.356065 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.357286 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.357409 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.357517 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.357616 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.357704 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:47.357793 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.357884 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.357969 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.358083 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.358174 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.358257 140561847887872 dqn_agent.py:283] 	 seed: 1630624187356002
I0902 23:09:47.360337 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.360503 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:09:47.360607 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.360685 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.360763 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.360880 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.360966 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.361048 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.361124 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.795910 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 23:09:53.892007 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.966385 140561847887872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.992345 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:53.992577 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.994488 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.994987 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.995430 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.995875 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:53.996322 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:53.996816 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.997249 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.997702 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.998131 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.998615 140561847887872 dqn_agent.py:283] 	 seed: 1630624193992279
I0902 23:09:54.006108 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:54.007131 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:09:54.007763 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:54.008302 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:54.008983 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:54.009500 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:54.010006 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:54.010501 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:54.010922 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.541561 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.650824 140561847887872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:54.651141 140561847887872 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 113.75
I0902 23:10:03.442507 140561847887872 replay_runner.py:36] Average training steps per second: 113.75
I0902 23:10:04.586315 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:10:04.799095 140561847887872 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 190.74
I0902 23:10:10.042701 140561847887872 replay_runner.py:36] Average training steps per second: 190.74
I0902 23:10:10.503468 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 235 Episode length: 235 Return: -234.0
INFO:tensorflow:Average training steps per second: 190.26
I0902 23:10:16.002590 140561847887872 replay_runner.py:36] Average training steps per second: 190.26
I0902 23:10:16.179158 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.00
INFO:tensorflow:Starting iteration 3

Steps executed: 625 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 178.53
I0902 23:10:22.016191 140561847887872 replay_runner.py:36] Average training steps per second: 178.53
I0902 23:10:22.563902 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.64
I0902 23:10:27.973604 140561847887872 replay_runner.py:36] Average training steps per second: 193.64
I0902 23:10:28.438127 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:10:28.692950 140561847887872 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 184.26
I0902 23:10:34.120484 140561847887872 replay_runner.py:36] Average training steps per second: 184.26
I0902 23:10:34.524556 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 205 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 193.01
I0902 23:10:39.936865 140561847887872 replay_runner.py:36] Average training steps per second: 193.01
I0902 23:10:40.122304 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 7

Steps executed: 238 Episode length: 157 Return: -156.0
INFO:tensorflow:Average training steps per second: 187.64
I0902 23:10:45.710585 140561847887872 replay_runner.py:36] Average training steps per second: 187.64
I0902 23:10:45.897260 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 8
I0902 23:10:46.131509 140561847887872 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 192.79

Steps executed: 288 Episode length: 128 Return: -127.0
I0902 23:10:51.575861 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 9
I0902 23:10:51.831698 140561847887872 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 189.98
I0902 23:10:57.095987 140561847887872 replay_runner.py:36] Average training steps per second: 189.98

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 10

Steps executed: 288 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 196.11
I0902 23:11:02.818537 140561847887872 replay_runner.py:36] Average training steps per second: 196.11
I0902 23:11:03.075082 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 11

Steps executed: 315 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 193.89
I0902 23:11:08.490914 140561847887872 replay_runner.py:36] Average training steps per second: 193.89
I0902 23:11:08.752772 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 12

Steps executed: 232 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 195.57
I0902 23:11:14.103095 140561847887872 replay_runner.py:36] Average training steps per second: 195.57
I0902 23:11:14.311442 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 13
I0902 23:11:14.554956 140561847887872 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.34

Steps executed: 254 Episode length: 79 Return: -78.0.0
I0902 23:11:19.887558 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 14

Steps executed: 126 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 192.07

Steps executed: 626 Episode length: 500 Return: -500.0
I0902 23:11:25.914970 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.50
INFO:tensorflow:Starting iteration 15

Steps executed: 156 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 189.67
I0902 23:11:31.430435 140561847887872 replay_runner.py:36] Average training steps per second: 189.67

Steps executed: 231 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Starting iteration 16
I0902 23:11:31.878834 140561847887872 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 189.03
I0902 23:11:37.169461 140561847887872 replay_runner.py:36] Average training steps per second: 189.03
I0902 23:11:37.588201 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17


Steps executed: 92 Episode length: 92 Return: -91.00.0
INFO:tensorflow:Average training steps per second: 199.82
I0902 23:11:42.827327 140561847887872 replay_runner.py:36] Average training steps per second: 199.82
I0902 23:11:43.298281 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.50
INFO:tensorflow:Starting iteration 18


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.81
I0902 23:11:48.754666 140561847887872 replay_runner.py:36] Average training steps per second: 191.81
I0902 23:11:49.178004 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 247 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 199.25
I0902 23:11:54.437526 140561847887872 replay_runner.py:36] Average training steps per second: 199.25
I0902 23:11:54.654116 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 20

Steps executed: 267 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 189.90
I0902 23:12:00.169696 140561847887872 replay_runner.py:36] Average training steps per second: 189.90
I0902 23:12:00.382670 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 21

Steps executed: 583 Episode length: 386 Return: -385.0
INFO:tensorflow:Average training steps per second: 200.27
I0902 23:12:05.617024 140561847887872 replay_runner.py:36] Average training steps per second: 200.27
I0902 23:12:06.115306 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.33
INFO:tensorflow:Starting iteration 22

Steps executed: 211 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 187.50
I0902 23:12:11.689664 140561847887872 replay_runner.py:36] Average training steps per second: 187.50
I0902 23:12:11.870742 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 23

Steps executed: 256 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 197.36
I0902 23:12:17.178831 140561847887872 replay_runner.py:36] Average training steps per second: 197.36
I0902 23:12:17.405147 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 24

Steps executed: 259 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 192.35
I0902 23:12:22.859659 140561847887872 replay_runner.py:36] Average training steps per second: 192.35
I0902 23:12:23.062964 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 25

Steps executed: 305 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 195.65
I0902 23:12:28.411612 140561847887872 replay_runner.py:36] Average training steps per second: 195.65
I0902 23:12:28.677215 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 26

Steps executed: 252 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 192.89
I0902 23:12:34.091663 140561847887872 replay_runner.py:36] Average training steps per second: 192.89
I0902 23:12:34.300025 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 27
I0902 23:12:34.534241 140561847887872 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.46

Steps executed: 212 Episode length: 109 Return: -108.0
I0902 23:12:39.968554 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 201.32
I0902 23:12:45.185133 140561847887872 replay_runner.py:36] Average training steps per second: 201.32
I0902 23:12:45.357033 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 29
I0902 23:12:45.577304 140561847887872 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 239.57

Done fixed training!Episode length: 500 Return: -500.0
I0902 23:12:50.105911 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00