Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0901 13:05:02.565382 140315766171648 run_experiment.py:549] Creating TrainRunner ...
I0901 13:05:02.574984 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:05:02.575183 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:05:02.575309 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:05:02.575399 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:05:02.575532 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:05:02.575640 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:05:02.575711 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:05:02.575791 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:05:02.575927 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:05:02.576021 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:05:02.576103 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:05:02.576239 140315766171648 dqn_agent.py:283] 	 seed: 1630501502574932
I0901 13:05:02.579580 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:05:02.579737 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:05:02.579849 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:05:02.579915 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:05:02.579977 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:05:02.580059 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:05:02.580146 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:05:02.580203 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:05:02.580254 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:05:02.610859 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:02.899170 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:02.909836 140315766171648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:05:02.917342 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:05:02.917502 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:05:02.917582 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:05:02.917649 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:05:02.917710 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:05:02.917781 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:05:02.917864 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:05:02.917923 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:05:02.917980 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:05:02.918038 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:05:02.918134 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:05:02.918204 140315766171648 dqn_agent.py:283] 	 seed: 1630501502917305
I0901 13:05:02.920893 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:05:02.921082 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:05:02.921192 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:05:02.921277 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:05:02.921351 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:05:02.921441 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:05:02.921600 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:05:02.921724 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:05:02.921809 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:05:02.946934 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:05:02.966740 140315766171648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:05:02.966939 140315766171648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 199.36
I0901 13:05:07.983135 140315766171648 replay_runner.py:36] Average training steps per second: 199.36
Steps executed: 271 Episode length: 130 Return: -508.71820235501275
I0901 13:05:09.043084 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.96
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 203 Return: -36.886979943677446
INFO:tensorflow:Average training steps per second: 273.62
I0901 13:05:16.509162 140315766171648 replay_runner.py:36] Average training steps per second: 273.62
I0901 13:05:16.670753 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -36.89
INFO:tensorflow:Starting iteration 2

Steps executed: 276 Episode length: 86 Return: -253.578660869407466
INFO:tensorflow:Average training steps per second: 281.44
I0901 13:05:24.012635 140315766171648 replay_runner.py:36] Average training steps per second: 281.44
I0901 13:05:24.203927 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.59
INFO:tensorflow:Starting iteration 3

Steps executed: 267 Episode length: 124 Return: -319.06187616086826
INFO:tensorflow:Average training steps per second: 286.02
I0901 13:05:31.554587 140315766171648 replay_runner.py:36] Average training steps per second: 286.02
I0901 13:05:31.752053 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.33
INFO:tensorflow:Starting iteration 4

Steps executed: 293 Episode length: 112 Return: -0.4065814258512148
INFO:tensorflow:Average training steps per second: 277.32
I0901 13:05:39.150796 140315766171648 replay_runner.py:36] Average training steps per second: 277.32
I0901 13:05:39.362774 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -25.99
INFO:tensorflow:Starting iteration 5

Steps executed: 278 Episode length: 110 Return: -89.374864264362365
INFO:tensorflow:Average training steps per second: 294.24
I0901 13:05:46.510318 140315766171648 replay_runner.py:36] Average training steps per second: 294.24
I0901 13:05:46.697288 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.41
INFO:tensorflow:Starting iteration 6

Steps executed: 227 Episode length: 75 Return: -127.972812618828755
INFO:tensorflow:Average training steps per second: 303.40
I0901 13:05:53.671280 140315766171648 replay_runner.py:36] Average training steps per second: 303.40
I0901 13:05:53.797691 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.37
INFO:tensorflow:Starting iteration 7

Steps executed: 314 Episode length: 122 Return: -104.37742401767748
INFO:tensorflow:Average training steps per second: 312.65
I0901 13:06:00.633053 140315766171648 replay_runner.py:36] Average training steps per second: 312.65
I0901 13:06:00.858169 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.96
INFO:tensorflow:Starting iteration 8

Steps executed: 275 Episode length: 139 Return: -199.85420198553224
INFO:tensorflow:Average training steps per second: 311.59
I0901 13:06:07.664154 140315766171648 replay_runner.py:36] Average training steps per second: 311.59
I0901 13:06:07.857818 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.16
INFO:tensorflow:Starting iteration 9
I0901 13:06:11.455804 140315766171648 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 321.66

Steps executed: 388 Episode length: 200 Return: -267.40276979954684
I0901 13:06:14.825764 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.83
INFO:tensorflow:Starting iteration 10

Steps executed: 203 Episode length: 85 Return: -410.162772753097164
INFO:tensorflow:Average training steps per second: 326.44
I0901 13:06:21.459426 140315766171648 replay_runner.py:36] Average training steps per second: 326.44
I0901 13:06:21.587427 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.80
INFO:tensorflow:Starting iteration 11

Steps executed: 260 Episode length: 133 Return: -330.83552054163294
INFO:tensorflow:Average training steps per second: 337.99
I0901 13:06:28.112668 140315766171648 replay_runner.py:36] Average training steps per second: 337.99
I0901 13:06:28.287501 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.47
INFO:tensorflow:Starting iteration 12

Steps executed: 216 Episode length: 216 Return: -177.17782771306588
INFO:tensorflow:Average training steps per second: 336.56
I0901 13:06:34.831472 140315766171648 replay_runner.py:36] Average training steps per second: 336.56
I0901 13:06:34.993983 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.18
INFO:tensorflow:Starting iteration 13

Steps executed: 272 Episode length: 88 Return: -527.079916996875788
INFO:tensorflow:Average training steps per second: 336.49
I0901 13:06:41.536806 140315766171648 replay_runner.py:36] Average training steps per second: 336.49
I0901 13:06:41.687808 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.90
INFO:tensorflow:Starting iteration 14

Steps executed: 319 Episode length: 123 Return: -583.32549893219868
INFO:tensorflow:Average training steps per second: 343.38
I0901 13:06:48.168858 140315766171648 replay_runner.py:36] Average training steps per second: 343.38
I0901 13:06:48.342185 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.57
INFO:tensorflow:Starting iteration 15

Steps executed: 268 Episode length: 97 Return: 46.65569936789927438
INFO:tensorflow:Average training steps per second: 343.13
I0901 13:06:54.850076 140315766171648 replay_runner.py:36] Average training steps per second: 343.13
I0901 13:06:55.030915 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.41
INFO:tensorflow:Starting iteration 16

Steps executed: 238 Episode length: 119 Return: -545.97595523093635
INFO:tensorflow:Average training steps per second: 346.17
I0901 13:07:01.527366 140315766171648 replay_runner.py:36] Average training steps per second: 346.17
I0901 13:07:01.676953 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.13
INFO:tensorflow:Starting iteration 17

Steps executed: 256 Episode length: 66 Return: -277.286302049967904
INFO:tensorflow:Average training steps per second: 351.41
I0901 13:07:08.121525 140315766171648 replay_runner.py:36] Average training steps per second: 351.41
I0901 13:07:08.268653 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.35
INFO:tensorflow:Starting iteration 18


Steps executed: 285 Episode length: 102 Return: -273.46762681026754
INFO:tensorflow:Average training steps per second: 349.86
I0901 13:07:14.745321 140315766171648 replay_runner.py:36] Average training steps per second: 349.86
I0901 13:07:14.905599 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.63
INFO:tensorflow:Starting iteration 19

Steps executed: 205 Episode length: 65 Return: -435.466580923357476
INFO:tensorflow:Average training steps per second: 348.63
I0901 13:07:21.421942 140315766171648 replay_runner.py:36] Average training steps per second: 348.63
I0901 13:07:21.539017 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.60
INFO:tensorflow:Starting iteration 20

Steps executed: 212 Episode length: 92 Return: -312.735522194740046
INFO:tensorflow:Average training steps per second: 349.85
I0901 13:07:28.009258 140315766171648 replay_runner.py:36] Average training steps per second: 349.85
I0901 13:07:28.123289 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.63
INFO:tensorflow:Starting iteration 21
I0901 13:07:31.736947 140315766171648 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 342.96

Steps executed: 271 Episode length: 73 Return: -168.385364384097044
I0901 13:07:34.798304 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.59
INFO:tensorflow:Starting iteration 22

Steps executed: 269 Episode length: 114 Return: -242.69351631092014
INFO:tensorflow:Average training steps per second: 334.89
I0901 13:07:41.418353 140315766171648 replay_runner.py:36] Average training steps per second: 334.89
I0901 13:07:41.584214 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.95
INFO:tensorflow:Starting iteration 23

Steps executed: 344 Episode length: 160 Return: -41.925721157550676
INFO:tensorflow:Average training steps per second: 344.43
I0901 13:07:48.083942 140315766171648 replay_runner.py:36] Average training steps per second: 344.43
I0901 13:07:48.305634 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.91
INFO:tensorflow:Starting iteration 24
I0901 13:07:51.850855 140315766171648 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 348.21
I0901 13:07:54.722990 140315766171648 replay_runner.py:36] Average training steps per second: 348.21

Steps executed: 226 Episode length: 134 Return: -483.93741169107216
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 66 Return: -466.280871389316416
INFO:tensorflow:Average training steps per second: 340.83
I0901 13:08:01.412726 140315766171648 replay_runner.py:36] Average training steps per second: 340.83
I0901 13:08:01.531357 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.79
INFO:tensorflow:Starting iteration 26

Steps executed: 230 Episode length: 61 Return: -394.020641200997796
INFO:tensorflow:Average training steps per second: 345.13
I0901 13:08:08.018684 140315766171648 replay_runner.py:36] Average training steps per second: 345.13
I0901 13:08:08.134859 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.04
INFO:tensorflow:Starting iteration 27

Steps executed: 226 Episode length: 69 Return: -311.474606183375146
INFO:tensorflow:Average training steps per second: 335.58
I0901 13:08:14.449347 140315766171648 replay_runner.py:36] Average training steps per second: 335.58
I0901 13:08:14.576418 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.03
INFO:tensorflow:Starting iteration 28
I0901 13:08:17.959435 140315766171648 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 342.62
I0901 13:08:20.878470 140315766171648 replay_runner.py:36] Average training steps per second: 342.62

Steps executed: 255 Episode length: 113 Return: -162.03099847630023
INFO:tensorflow:Starting iteration 29

Steps executed: 210 Episode length: 85 Return: -143.339867436347051
INFO:tensorflow:Average training steps per second: 350.19
I0901 13:08:27.416814 140315766171648 replay_runner.py:36] Average training steps per second: 350.19

Done fixed training!Episode length: 85 Return: -143.339867436347051