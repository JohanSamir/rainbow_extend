I0828 10:18:36.979642 140618562066432 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:36.980229 140618562066432 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:37.061552 140618562066432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:37.062648 140618562066432 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:37.062739 140618562066432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:37.062809 140618562066432 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:37.062869 140618562066432 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:37.062982 140618562066432 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:37.063123 140618562066432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:37.063234 140618562066432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:37.063294 140618562066432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:37.063346 140618562066432 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:37.063398 140618562066432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:37.063451 140618562066432 dqn_agent.py:283] 	 seed: 1630145917061498
I0828 10:18:37.065158 140618562066432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:37.065308 140618562066432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:37.065379 140618562066432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:37.065443 140618562066432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:37.065506 140618562066432 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:37.065579 140618562066432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:37.065646 140618562066432 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:37.065742 140618562066432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:37.065824 140618562066432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.427305 140618562066432 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0828 10:18:38.763847 140618562066432 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.771744 140618562066432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.775727 140618562066432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.775858 140618562066432 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.775924 140618562066432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.776005 140618562066432 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.776067 140618562066432 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.776120 140618562066432 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:18:38.776243 140618562066432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.776298 140618562066432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.776352 140618562066432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.776434 140618562066432 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.776485 140618562066432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.776560 140618562066432 dqn_agent.py:283] 	 seed: 1630145918775697
I0828 10:18:38.777955 140618562066432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.778062 140618562066432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:18:38.778163 140618562066432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.778229 140618562066432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.778287 140618562066432 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.778378 140618562066432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.778454 140618562066432 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.778521 140618562066432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.778576 140618562066432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.797048 140618562066432 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.809638 140618562066432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.809808 140618562066432 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 175.43
I0828 10:18:44.510564 140618562066432 replay_runner.py:36] Average training steps per second: 175.43
Steps executed: 208 Episode length: 67 Return: -465.95153457792054
I0828 10:18:45.560529 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.09
INFO:tensorflow:Starting iteration 1

Steps executed: 75 Episode length: 75 Return: -633.131482470604954
INFO:tensorflow:Average training steps per second: 215.70
I0828 10:18:54.373419 140618562066432 replay_runner.py:36] Average training steps per second: 215.70

Steps executed: 204 Episode length: 57 Return: -461.23625449521344
INFO:tensorflow:Starting iteration 2

Steps executed: 257 Episode length: 76 Return: -40.139819744717855
INFO:tensorflow:Average training steps per second: 216.36
I0828 10:19:03.358503 140618562066432 replay_runner.py:36] Average training steps per second: 216.36
I0828 10:19:03.541620 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.53
INFO:tensorflow:Starting iteration 3

Steps executed: 138 Episode length: 67 Return: -466.72941637976195
INFO:tensorflow:Average training steps per second: 214.09
I0828 10:19:12.443242 140618562066432 replay_runner.py:36] Average training steps per second: 214.09

Steps executed: 252 Episode length: 62 Return: -540.35767595633295
INFO:tensorflow:Starting iteration 4

Steps executed: 229 Episode length: 53 Return: -445.49785617510753
INFO:tensorflow:Average training steps per second: 214.87
I0828 10:19:21.585608 140618562066432 replay_runner.py:36] Average training steps per second: 214.87
I0828 10:19:21.787842 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -505.83
INFO:tensorflow:Starting iteration 5
I0828 10:19:26.007709 140618562066432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 216.19

Steps executed: 257 Episode length: 64 Return: -535.30680701014266
I0828 10:19:30.871058 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -560.31
INFO:tensorflow:Starting iteration 6

Steps executed: 254 Episode length: 58 Return: -429.99222370208776
INFO:tensorflow:Average training steps per second: 219.06
I0828 10:19:39.631051 140618562066432 replay_runner.py:36] Average training steps per second: 219.06
I0828 10:19:39.861560 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -528.29
INFO:tensorflow:Starting iteration 7
I0828 10:19:44.115157 140618562066432 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 217.96

Steps executed: 209 Episode length: 78 Return: -499.06053577206594
I0828 10:19:48.888021 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.67
INFO:tensorflow:Starting iteration 8

Steps executed: 258 Episode length: 67 Return: -475.70696248293224
INFO:tensorflow:Average training steps per second: 218.58
I0828 10:19:57.758782 140618562066432 replay_runner.py:36] Average training steps per second: 218.58
I0828 10:19:57.961941 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.55
INFO:tensorflow:Starting iteration 9
I0828 10:20:02.226451 140618562066432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.26

Steps executed: 229 Episode length: 76 Return: -562.13992380113485
I0828 10:20:06.964195 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.93
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 66 Return: -570.20157320899085
INFO:tensorflow:Average training steps per second: 220.98
I0828 10:20:15.704077 140618562066432 replay_runner.py:36] Average training steps per second: 220.98
I0828 10:20:15.884816 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -585.23
INFO:tensorflow:Starting iteration 11

Steps executed: 227 Episode length: 61 Return: -461.34313869462243
INFO:tensorflow:Average training steps per second: 220.08
I0828 10:20:24.670490 140618562066432 replay_runner.py:36] Average training steps per second: 220.08
I0828 10:20:24.876266 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.76
INFO:tensorflow:Starting iteration 12

Steps executed: 206 Episode length: 72 Return: -715.75342906657543
INFO:tensorflow:Average training steps per second: 219.33
I0828 10:20:33.764462 140618562066432 replay_runner.py:36] Average training steps per second: 219.33
I0828 10:20:33.949741 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -629.32
INFO:tensorflow:Starting iteration 13

Steps executed: 189 Episode length: 56 Return: -374.08734147802137
INFO:tensorflow:Average training steps per second: 218.60
I0828 10:20:42.833948 140618562066432 replay_runner.py:36] Average training steps per second: 218.60

Steps executed: 246 Episode length: 57 Return: -334.65829055455467
INFO:tensorflow:Starting iteration 14

Steps executed: 201 Episode length: 72 Return: -655.42382058661467
INFO:tensorflow:Average training steps per second: 220.42
I0828 10:20:51.763135 140618562066432 replay_runner.py:36] Average training steps per second: 220.42
I0828 10:20:51.938874 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -598.60
INFO:tensorflow:Starting iteration 15

Steps executed: 209 Episode length: 61 Return: -144.45959229179197
INFO:tensorflow:Average training steps per second: 224.51
I0828 10:21:00.698867 140618562066432 replay_runner.py:36] Average training steps per second: 224.51
I0828 10:21:00.865811 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.86
INFO:tensorflow:Starting iteration 16

Steps executed: 217 Episode length: 70 Return: -567.78279773999047
INFO:tensorflow:Average training steps per second: 220.58
I0828 10:21:09.624900 140618562066432 replay_runner.py:36] Average training steps per second: 220.58
I0828 10:21:09.820659 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.01
INFO:tensorflow:Starting iteration 17

Steps executed: 211 Episode length: 126 Return: -982.3376735670305
INFO:tensorflow:Average training steps per second: 219.69
I0828 10:21:18.708483 140618562066432 replay_runner.py:36] Average training steps per second: 219.69
I0828 10:21:18.907282 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -989.27
INFO:tensorflow:Starting iteration 18

Steps executed: 239 Episode length: 63 Return: -404.01187049136746
INFO:tensorflow:Average training steps per second: 229.23
I0828 10:21:27.517242 140618562066432 replay_runner.py:36] Average training steps per second: 229.23
I0828 10:21:27.706092 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -467.01
INFO:tensorflow:Starting iteration 19

Steps executed: 274 Episode length: 81 Return: -715.98966791460256
INFO:tensorflow:Average training steps per second: 260.18
I0828 10:21:35.547381 140618562066432 replay_runner.py:36] Average training steps per second: 260.18
I0828 10:21:35.720489 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.85
INFO:tensorflow:Starting iteration 20

Steps executed: 217 Episode length: 71 Return: -551.84730709180876
INFO:tensorflow:Average training steps per second: 227.69
I0828 10:21:44.102971 140618562066432 replay_runner.py:36] Average training steps per second: 227.69
I0828 10:21:44.278743 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -533.80
INFO:tensorflow:Starting iteration 21

Steps executed: 125 Episode length: 58 Return: -605.51738630492926
INFO:tensorflow:Average training steps per second: 226.98
I0828 10:21:52.722165 140618562066432 replay_runner.py:36] Average training steps per second: 226.98

Steps executed: 265 Episode length: 77 Return: -601.11942029828746
INFO:tensorflow:Starting iteration 22

Steps executed: 242 Episode length: 66 Return: -667.41374632133366
INFO:tensorflow:Average training steps per second: 219.86
I0828 10:22:01.818460 140618562066432 replay_runner.py:36] Average training steps per second: 219.86
I0828 10:22:02.028445 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.30
INFO:tensorflow:Starting iteration 23
I0828 10:22:06.342348 140618562066432 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.94
I0828 10:22:10.828262 140618562066432 replay_runner.py:36] Average training steps per second: 222.94

Steps executed: 215 Episode length: 215 Return: -57.40846257436745
INFO:tensorflow:Starting iteration 24

Steps executed: 202 Episode length: 69 Return: -546.79489225431735
INFO:tensorflow:Average training steps per second: 221.96
I0828 10:22:19.773041 140618562066432 replay_runner.py:36] Average training steps per second: 221.96
I0828 10:22:19.937863 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -592.18
INFO:tensorflow:Starting iteration 25

Steps executed: 262 Episode length: 74 Return: -601.28379625106363
INFO:tensorflow:Average training steps per second: 222.11
I0828 10:22:28.774290 140618562066432 replay_runner.py:36] Average training steps per second: 222.11
I0828 10:22:28.990889 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -605.52
INFO:tensorflow:Starting iteration 26

Steps executed: 205 Episode length: 76 Return: -458.80447177309827
INFO:tensorflow:Average training steps per second: 219.86
I0828 10:22:37.757076 140618562066432 replay_runner.py:36] Average training steps per second: 219.86
I0828 10:22:37.930437 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -559.28
INFO:tensorflow:Starting iteration 27

Steps executed: 201 Episode length: 57 Return: -598.72564715116897
INFO:tensorflow:Average training steps per second: 224.47
I0828 10:22:46.685703 140618562066432 replay_runner.py:36] Average training steps per second: 224.47
I0828 10:22:46.872971 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -573.60
INFO:tensorflow:Starting iteration 28

Steps executed: 205 Episode length: 63 Return: -675.95049641262887
INFO:tensorflow:Average training steps per second: 221.35
I0828 10:22:55.645704 140618562066432 replay_runner.py:36] Average training steps per second: 221.35
I0828 10:22:55.822681 140618562066432 run_experiment.py:428] Average undiscounted return per evaluation episode: -627.26
INFO:tensorflow:Starting iteration 29

Steps executed: 274 Episode length: 92 Return: -478.566808432473956
INFO:tensorflow:Average training steps per second: 224.38
I0828 10:23:04.591915 140618562066432 replay_runner.py:36] Average training steps per second: 224.38

Done fixed training!Episode length: 92 Return: -478.566808432473956