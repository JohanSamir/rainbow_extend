Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
I0909 13:33:32.745002 140627910785024 run_experiment.py:549] Creating TrainRunner ...
I0909 13:33:32.753326 140627910785024 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:33:32.753465 140627910785024 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:33:32.753549 140627910785024 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:33:32.753619 140627910785024 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:33:32.753681 140627910785024 dqn_agent.py:275] 	 update_period: 4
I0909 13:33:32.753767 140627910785024 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:33:32.753850 140627910785024 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:33:32.753950 140627910785024 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:33:32.754028 140627910785024 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:33:32.754113 140627910785024 dqn_agent.py:280] 	 optimizer: adam
I0909 13:33:32.754206 140627910785024 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:33:32.754278 140627910785024 dqn_agent.py:283] 	 seed: 1631194412753295
I0909 13:33:32.756174 140627910785024 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:33:32.756294 140627910785024 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:33:32.756400 140627910785024 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:33:32.756477 140627910785024 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:33:32.756543 140627910785024 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:33:32.756629 140627910785024 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:33:32.756694 140627910785024 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:33:32.756812 140627910785024 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:33:32.756887 140627910785024 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:33:33.889148 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:33:34.102458 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:33:34.111913 140627910785024 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:33:34.117367 140627910785024 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:33:34.117505 140627910785024 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:33:34.117586 140627910785024 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:33:34.117654 140627910785024 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:33:34.117719 140627910785024 dqn_agent.py:275] 	 update_period: 4
I0909 13:33:34.117782 140627910785024 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:33:34.117875 140627910785024 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:33:34.117971 140627910785024 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:33:34.118039 140627910785024 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:33:34.118109 140627910785024 dqn_agent.py:280] 	 optimizer: adam
I0909 13:33:34.118176 140627910785024 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:33:34.118243 140627910785024 dqn_agent.py:283] 	 seed: 1631194414117338
I0909 13:33:34.119770 140627910785024 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:33:34.119896 140627910785024 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:33:34.119980 140627910785024 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:33:34.120049 140627910785024 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:33:34.120112 140627910785024 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:33:34.120173 140627910785024 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:33:34.120252 140627910785024 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:33:34.120324 140627910785024 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:33:34.120404 140627910785024 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:33:34.140396 140627910785024 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:33:34.152659 140627910785024 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:33:34.152809 140627910785024 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 217.78
I0909 13:33:38.744693 140627910785024 replay_runner.py:36] Average training steps per second: 217.78
I0909 13:33:39.551586 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:33:39.629387 140627910785024 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 303.59
I0909 13:33:42.923672 140627910785024 replay_runner.py:36] Average training steps per second: 303.59
I0909 13:33:43.092967 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:33:43.171377 140627910785024 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 307.68
I0909 13:33:46.421862 140627910785024 replay_runner.py:36] Average training steps per second: 307.68
I0909 13:33:46.594794 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:33:46.671844 140627910785024 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 309.03
I0909 13:33:49.907989 140627910785024 replay_runner.py:36] Average training steps per second: 309.03
I0909 13:33:50.068807 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:33:50.150437 140627910785024 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 311.03
I0909 13:33:53.366112 140627910785024 replay_runner.py:36] Average training steps per second: 311.03
I0909 13:33:53.543169 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:33:53.619355 140627910785024 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 310.40
I0909 13:33:56.841379 140627910785024 replay_runner.py:36] Average training steps per second: 310.40
I0909 13:33:57.011529 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6

Steps executed: 247 Episode length: 88 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 309.90
I0909 13:34:00.317180 140627910785024 replay_runner.py:36] Average training steps per second: 309.90
I0909 13:34:00.386316 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 7

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 307.79
I0909 13:34:03.715182 140627910785024 replay_runner.py:36] Average training steps per second: 307.79
I0909 13:34:03.892166 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:34:03.972744 140627910785024 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 310.87
I0909 13:34:07.189858 140627910785024 replay_runner.py:36] Average training steps per second: 310.87
I0909 13:34:07.356888 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 144 Episode length: 144 Return: -144.0
INFO:tensorflow:Average training steps per second: 313.61
I0909 13:34:10.623246 140627910785024 replay_runner.py:36] Average training steps per second: 313.61
I0909 13:34:10.712260 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 10


Steps executed: 244 Episode length: 156 Return: -156.0
INFO:tensorflow:Average training steps per second: 314.29
I0909 13:34:13.970892 140627910785024 replay_runner.py:36] Average training steps per second: 314.29
I0909 13:34:14.042317 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 11

Steps executed: 691 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 296.76
I0909 13:34:17.486147 140627910785024 replay_runner.py:36] Average training steps per second: 296.76
I0909 13:34:17.673403 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.50
INFO:tensorflow:Starting iteration 12

Steps executed: 236 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 309.56
I0909 13:34:20.985942 140627910785024 replay_runner.py:36] Average training steps per second: 309.56
I0909 13:34:21.047567 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 13

Steps executed: 220 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 317.38
I0909 13:34:24.274968 140627910785024 replay_runner.py:36] Average training steps per second: 317.38
I0909 13:34:24.332881 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 14

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 315.85
I0909 13:34:27.572741 140627910785024 replay_runner.py:36] Average training steps per second: 315.85
I0909 13:34:27.755862 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0909 13:34:27.837388 140627910785024 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 315.01
I0909 13:34:31.012294 140627910785024 replay_runner.py:36] Average training steps per second: 315.01
I0909 13:34:31.182399 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0909 13:34:31.259335 140627910785024 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 306.85
I0909 13:34:34.518600 140627910785024 replay_runner.py:36] Average training steps per second: 306.85
I0909 13:34:34.577822 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50

Steps executed: 211 Episode length: 105 Return: -105.0

Steps executed: 218 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 313.05
I0909 13:34:37.850867 140627910785024 replay_runner.py:36] Average training steps per second: 313.05
I0909 13:34:37.911795 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 18

Steps executed: 302 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 316.83
I0909 13:34:41.146067 140627910785024 replay_runner.py:36] Average training steps per second: 316.83
I0909 13:34:41.227418 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 19

Steps executed: 212 Episode length: 212 Return: -212.0
INFO:tensorflow:Average training steps per second: 314.08
I0909 13:34:44.490845 140627910785024 replay_runner.py:36] Average training steps per second: 314.08
I0909 13:34:44.548345 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.00
INFO:tensorflow:Starting iteration 20

Steps executed: 211 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 309.44
I0909 13:34:47.857096 140627910785024 replay_runner.py:36] Average training steps per second: 309.44
I0909 13:34:47.913241 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 21

Steps executed: 225 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 317.49
I0909 13:34:51.141237 140627910785024 replay_runner.py:36] Average training steps per second: 317.49
I0909 13:34:51.200183 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 22

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 313.80
I0909 13:34:54.461277 140627910785024 replay_runner.py:36] Average training steps per second: 313.80
I0909 13:34:54.516458 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 313.41
I0909 13:34:57.783362 140627910785024 replay_runner.py:36] Average training steps per second: 313.41
I0909 13:34:57.839831 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 314.82
I0909 13:35:01.093077 140627910785024 replay_runner.py:36] Average training steps per second: 314.82
I0909 13:35:01.146568 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 25

Steps executed: 252 Episode length: 126 Return: -126.0
INFO:tensorflow:Average training steps per second: 311.77
I0909 13:35:04.429514 140627910785024 replay_runner.py:36] Average training steps per second: 311.77
I0909 13:35:04.497247 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 319.27
I0909 13:35:07.704024 140627910785024 replay_runner.py:36] Average training steps per second: 319.27
I0909 13:35:07.765494 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 27

Steps executed: 253 Episode length: 163 Return: -163.0
INFO:tensorflow:Average training steps per second: 338.63
I0909 13:35:10.793194 140627910785024 replay_runner.py:36] Average training steps per second: 338.63
I0909 13:35:10.849472 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 28

Steps executed: 345 Episode length: 169 Return: -169.0
INFO:tensorflow:Average training steps per second: 346.48
I0909 13:35:13.802301 140627910785024 replay_runner.py:36] Average training steps per second: 346.48
I0909 13:35:13.875970 140627910785024 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 29

Steps executed: 212 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 333.90
I0909 13:35:16.936489 140627910785024 replay_runner.py:36] Average training steps per second: 333.90

Done fixed training!Episode length: 103 Return: -103.0