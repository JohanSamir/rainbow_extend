Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:21:51.342406 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:21:51.352484 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:21:51.352767 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:21:51.352910 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:21:51.353157 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:21:51.353302 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:21:51.353507 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:21:51.353623 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:21:51.353705 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:21:51.353836 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:21:51.354013 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:21:51.354214 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:21:51.354325 140635665344512 dqn_agent.py:283] 	 seed: 1630498911352401
I0901 12:21:51.356976 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:21:51.357141 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:21:51.357252 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:21:51.357337 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:21:51.357424 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:21:51.357562 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:21:51.357689 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:21:51.357752 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:21:51.357821 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:21:51.574260 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:21:52.149100 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:21:52.162997 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:21:52.171865 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:21:52.172084 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:21:52.172265 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:21:52.172438 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:21:52.172566 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:21:52.172650 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:21:52.172832 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:21:52.172942 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:21:52.173053 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:21:52.173147 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:21:52.173246 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:21:52.173352 140635665344512 dqn_agent.py:283] 	 seed: 1630498912171817
I0901 12:21:52.175739 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:21:52.175918 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:21:52.176015 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:21:52.176087 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:21:52.176195 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:21:52.176301 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:21:52.176457 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:21:52.176559 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:21:52.176650 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:21:52.216407 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:21:52.240454 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:21:52.240677 140635665344512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.47
I0901 12:21:58.976716 140635665344512 replay_runner.py:36] Average training steps per second: 148.47
Steps executed: 205 Episode length: 8 Return: 8.0.0
I0901 12:22:00.099448 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 48 Return: 48.0
INFO:tensorflow:Average training steps per second: 191.44
I0901 12:22:05.502476 140635665344512 replay_runner.py:36] Average training steps per second: 191.44
I0901 12:22:05.625797 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 52.25
INFO:tensorflow:Starting iteration 2

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 203.51
I0901 12:22:10.705193 140635665344512 replay_runner.py:36] Average training steps per second: 203.51
I0901 12:22:10.844473 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 201.49
I0901 12:22:15.993681 140635665344512 replay_runner.py:36] Average training steps per second: 201.49
I0901 12:22:16.145251 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 4

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.81
I0901 12:22:21.496177 140635665344512 replay_runner.py:36] Average training steps per second: 193.81
I0901 12:22:21.651085 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 5

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 198.66
I0901 12:22:26.875862 140635665344512 replay_runner.py:36] Average training steps per second: 198.66
I0901 12:22:27.033725 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 6

Steps executed: 205 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 187.72
I0901 12:22:32.538704 140635665344512 replay_runner.py:36] Average training steps per second: 187.72
I0901 12:22:32.696595 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.79
INFO:tensorflow:Starting iteration 7

Steps executed: 210 Episode length: 18 Return: 18.0
INFO:tensorflow:Average training steps per second: 193.96
I0901 12:22:38.049066 140635665344512 replay_runner.py:36] Average training steps per second: 193.96
I0901 12:22:38.204353 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.15
INFO:tensorflow:Starting iteration 8

Steps executed: 229 Episode length: 40 Return: 40.0
INFO:tensorflow:Average training steps per second: 187.56
I0901 12:22:43.728359 140635665344512 replay_runner.py:36] Average training steps per second: 187.56
I0901 12:22:43.898981 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 38.17
INFO:tensorflow:Starting iteration 9

Steps executed: 268 Episode length: 100 Return: 100.0
INFO:tensorflow:Average training steps per second: 197.81
I0901 12:22:49.156617 140635665344512 replay_runner.py:36] Average training steps per second: 197.81
I0901 12:22:49.337125 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 89.33
INFO:tensorflow:Starting iteration 10

Steps executed: 272 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 187.01
I0901 12:22:54.872422 140635665344512 replay_runner.py:36] Average training steps per second: 187.01
I0901 12:22:55.070067 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.67
INFO:tensorflow:Starting iteration 11

Steps executed: 296 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 195.75
I0901 12:23:00.372344 140635665344512 replay_runner.py:36] Average training steps per second: 195.75
I0901 12:23:00.589922 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 12

Steps executed: 234 Episode length: 65 Return: 65.0.0
INFO:tensorflow:Average training steps per second: 189.67
I0901 12:23:06.055378 140635665344512 replay_runner.py:36] Average training steps per second: 189.67
I0901 12:23:06.235273 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 58.50
INFO:tensorflow:Starting iteration 13

Steps executed: 256 Episode length: 94 Return: 94.0.0
INFO:tensorflow:Average training steps per second: 191.20
I0901 12:23:11.661901 140635665344512 replay_runner.py:36] Average training steps per second: 191.20
I0901 12:23:11.849741 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 85.33
INFO:tensorflow:Starting iteration 14

Steps executed: 244 Episode length: 47 Return: 47.0.0
INFO:tensorflow:Average training steps per second: 188.07
I0901 12:23:17.366192 140635665344512 replay_runner.py:36] Average training steps per second: 188.07
I0901 12:23:17.538714 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 48.80
INFO:tensorflow:Starting iteration 15

Steps executed: 254 Episode length: 80 Return: 80.0.0
INFO:tensorflow:Average training steps per second: 188.94
I0901 12:23:23.030365 140635665344512 replay_runner.py:36] Average training steps per second: 188.94
I0901 12:23:23.207009 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.67
INFO:tensorflow:Starting iteration 16

Steps executed: 263 Episode length: 74 Return: 74.0.0
INFO:tensorflow:Average training steps per second: 192.83
I0901 12:23:28.587582 140635665344512 replay_runner.py:36] Average training steps per second: 192.83
I0901 12:23:28.788170 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 65.75
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 36 Return: 36.0.0
INFO:tensorflow:Average training steps per second: 193.52
I0901 12:23:34.150581 140635665344512 replay_runner.py:36] Average training steps per second: 193.52
I0901 12:23:34.309095 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 37.50
INFO:tensorflow:Starting iteration 18

Steps executed: 234 Episode length: 76 Return: 76.0.0
INFO:tensorflow:Average training steps per second: 184.69
I0901 12:23:39.910650 140635665344512 replay_runner.py:36] Average training steps per second: 184.69
I0901 12:23:40.080870 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 78.00
INFO:tensorflow:Starting iteration 19

Steps executed: 227 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Average training steps per second: 185.55
I0901 12:23:45.667014 140635665344512 replay_runner.py:36] Average training steps per second: 185.55
I0901 12:23:45.843951 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 75.67
INFO:tensorflow:Starting iteration 20

Steps executed: 202 Episode length: 37 Return: 37.0.0
INFO:tensorflow:Average training steps per second: 192.64
I0901 12:23:51.238142 140635665344512 replay_runner.py:36] Average training steps per second: 192.64
I0901 12:23:51.379154 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 40.40
INFO:tensorflow:Starting iteration 21

Steps executed: 221 Episode length: 57 Return: 57.0.0
INFO:tensorflow:Average training steps per second: 182.87
I0901 12:23:57.020849 140635665344512 replay_runner.py:36] Average training steps per second: 182.87
I0901 12:23:57.180636 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 55.25
INFO:tensorflow:Starting iteration 22

Steps executed: 250 Episode length: 54 Return: 54.0.0
INFO:tensorflow:Average training steps per second: 193.75
I0901 12:24:02.534857 140635665344512 replay_runner.py:36] Average training steps per second: 193.75
I0901 12:24:02.717241 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.00
INFO:tensorflow:Starting iteration 23

Steps executed: 218 Episode length: 47 Return: 47.0.0
INFO:tensorflow:Average training steps per second: 182.57
I0901 12:24:08.377198 140635665344512 replay_runner.py:36] Average training steps per second: 182.57
I0901 12:24:08.528800 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.60
INFO:tensorflow:Starting iteration 24

Steps executed: 230 Episode length: 55 Return: 55.0.0
INFO:tensorflow:Average training steps per second: 191.84
I0901 12:24:13.928171 140635665344512 replay_runner.py:36] Average training steps per second: 191.84
I0901 12:24:14.099997 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 57.50
INFO:tensorflow:Starting iteration 25
I0901 12:24:14.298520 140635665344512 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 185.77

Steps executed: 236 Episode length: 42 Return: 42.0.0
I0901 12:24:19.853145 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.20
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 42 Return: 42.0.0
INFO:tensorflow:Average training steps per second: 187.86
I0901 12:24:25.364561 140635665344512 replay_runner.py:36] Average training steps per second: 187.86
I0901 12:24:25.521492 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.60
INFO:tensorflow:Starting iteration 27

Steps executed: 252 Episode length: 53 Return: 53.0.0
INFO:tensorflow:Average training steps per second: 190.96
I0901 12:24:30.950201 140635665344512 replay_runner.py:36] Average training steps per second: 190.96
I0901 12:24:31.141033 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.40
INFO:tensorflow:Starting iteration 28

Steps executed: 213 Episode length: 37 Return: 37.0.0
INFO:tensorflow:Average training steps per second: 188.29
I0901 12:24:36.649139 140635665344512 replay_runner.py:36] Average training steps per second: 188.29
I0901 12:24:36.802612 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 35.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 55 Return: 55.0.0
INFO:tensorflow:Average training steps per second: 193.71
I0901 12:24:42.162003 140635665344512 replay_runner.py:36] Average training steps per second: 193.71
I0901 12:24:42.341446 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 62.00