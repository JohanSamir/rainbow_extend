Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 13:00:04.593713 140583573075968 run_experiment.py:549] Creating TrainRunner ...
I0901 13:00:04.604270 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:04.604528 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:04.604635 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:04.604717 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:04.604813 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:04.604891 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:04.605167 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:04.605363 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:04.605523 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:04.605935 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:04.606188 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:04.606370 140583573075968 dqn_agent.py:283] 	 seed: 1630501204604196
I0901 13:00:04.610430 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:04.610693 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:04.610919 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:04.611070 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:04.611189 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:04.611294 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:04.611646 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:04.611819 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:04.611938 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:04.797990 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:05.291786 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:05.306560 140583573075968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:00:05.316106 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:05.316402 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:05.316545 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:05.316656 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:05.316896 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:05.317194 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:05.317291 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:05.317370 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:05.317441 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:05.317593 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:05.317690 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:05.317783 140583573075968 dqn_agent.py:283] 	 seed: 1630501205316046
I0901 13:00:05.321001 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:05.321269 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:05.321460 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:05.321847 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:05.322258 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:05.322548 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:05.323050 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:05.323213 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:05.323363 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:05.364569 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:05.389495 140583573075968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:00:05.390075 140583573075968 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 136.03
I0901 13:00:12.741872 140583573075968 replay_runner.py:36] Average training steps per second: 136.03
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 13:00:14.221803 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 13:00:14.440049 140583573075968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 190.16
I0901 13:00:19.699244 140583573075968 replay_runner.py:36] Average training steps per second: 190.16
I0901 13:00:20.127890 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 13:00:20.359171 140583573075968 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.41
I0901 13:00:25.639101 140583573075968 replay_runner.py:36] Average training steps per second: 189.41
I0901 13:00:26.114063 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 13:00:26.366333 140583573075968 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 181.99
I0901 13:00:31.861708 140583573075968 replay_runner.py:36] Average training steps per second: 181.99
I0901 13:00:32.282884 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 240 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 187.62
I0901 13:00:37.860061 140583573075968 replay_runner.py:36] Average training steps per second: 187.62
I0901 13:00:38.086373 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 5

Steps executed: 210 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 187.76
I0901 13:00:43.670433 140583573075968 replay_runner.py:36] Average training steps per second: 187.76
I0901 13:00:43.866602 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 6

Steps executed: 307 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 189.71
I0901 13:00:49.383177 140583573075968 replay_runner.py:36] Average training steps per second: 189.71
I0901 13:00:49.663031 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.33
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.06
I0901 13:00:55.232614 140583573075968 replay_runner.py:36] Average training steps per second: 188.06
I0901 13:00:55.706375 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 442 Episode length: 320 Return: -319.0
INFO:tensorflow:Average training steps per second: 184.55
I0901 13:01:01.384046 140583573075968 replay_runner.py:36] Average training steps per second: 184.55
I0901 13:01:01.796288 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.00
INFO:tensorflow:Starting iteration 9

Steps executed: 213 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 183.57
I0901 13:01:07.485982 140583573075968 replay_runner.py:36] Average training steps per second: 183.57
I0901 13:01:07.695063 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 10

Steps executed: 262 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 183.74
I0901 13:01:13.366593 140583573075968 replay_runner.py:36] Average training steps per second: 183.74
I0901 13:01:13.616051 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.14
I0901 13:01:19.249872 140583573075968 replay_runner.py:36] Average training steps per second: 186.14
I0901 13:01:19.693834 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 13:01:19.939192 140583573075968 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 182.37
I0901 13:01:25.423000 140583573075968 replay_runner.py:36] Average training steps per second: 182.37
I0901 13:01:25.877054 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 273 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 191.60
I0901 13:01:31.326825 140583573075968 replay_runner.py:36] Average training steps per second: 191.60
I0901 13:01:31.570248 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 14

Steps executed: 265 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 185.57
I0901 13:01:37.209156 140583573075968 replay_runner.py:36] Average training steps per second: 185.57
I0901 13:01:37.422663 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 15
I0901 13:01:37.659454 140583573075968 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.99

Steps executed: 222 Episode length: 138 Return: -137.0
I0901 13:01:43.009372 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 16

Steps executed: 215 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 198.59
I0901 13:01:48.294943 140583573075968 replay_runner.py:36] Average training steps per second: 198.59
I0901 13:01:48.482827 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.67
INFO:tensorflow:Starting iteration 17

Steps executed: 243 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 191.72
I0901 13:01:53.934588 140583573075968 replay_runner.py:36] Average training steps per second: 191.72
I0901 13:01:54.139129 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 18

Steps executed: 287 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 200.31
I0901 13:01:59.377172 140583573075968 replay_runner.py:36] Average training steps per second: 200.31
I0901 13:01:59.616999 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 19

Steps executed: 230 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 190.26
I0901 13:02:05.114598 140583573075968 replay_runner.py:36] Average training steps per second: 190.26
I0901 13:02:05.305740 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.67
INFO:tensorflow:Starting iteration 20
I0901 13:02:05.550461 140583573075968 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.95

Steps executed: 221 Episode length: 133 Return: -132.0
I0901 13:02:10.910639 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 21

Steps executed: 210 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 201.75
I0901 13:02:16.118130 140583573075968 replay_runner.py:36] Average training steps per second: 201.75
I0901 13:02:16.293566 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.88
I0901 13:02:21.749492 140583573075968 replay_runner.py:36] Average training steps per second: 190.88
I0901 13:02:22.200712 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 383 Episode length: 383 Return: -382.0
INFO:tensorflow:Average training steps per second: 198.01
I0901 13:02:27.492562 140583573075968 replay_runner.py:36] Average training steps per second: 198.01
I0901 13:02:27.831098 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.00
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 195.76
I0901 13:02:33.159642 140583573075968 replay_runner.py:36] Average training steps per second: 195.76
I0901 13:02:33.330837 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 198.45
I0901 13:02:38.610790 140583573075968 replay_runner.py:36] Average training steps per second: 198.45
I0901 13:02:38.826834 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 26

Steps executed: 244 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 199.40
I0901 13:02:44.092742 140583573075968 replay_runner.py:36] Average training steps per second: 199.40
I0901 13:02:44.298658 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 27

Steps executed: 240 Episode length: 146 Return: -145.0
INFO:tensorflow:Average training steps per second: 196.58
I0901 13:02:49.634851 140583573075968 replay_runner.py:36] Average training steps per second: 196.58
I0901 13:02:49.846607 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 28
I0901 13:02:50.076914 140583573075968 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 201.73
I0901 13:02:55.034421 140583573075968 replay_runner.py:36] Average training steps per second: 201.73

Steps executed: 257 Episode length: 103 Return: -102.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.96
I0901 13:03:00.476728 140583573075968 replay_runner.py:36] Average training steps per second: 200.96
I0901 13:03:00.860700 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00