Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0902 00:13:46.703310 140437416843264 run_experiment.py:549] Creating TrainRunner ...
I0902 00:13:46.712771 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:13:46.713005 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:13:46.713115 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:13:46.713227 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:13:46.713325 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0902 00:13:46.713417 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:13:46.713505 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:13:46.713594 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:13:46.713686 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:13:46.713845 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0902 00:13:46.714057 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:13:46.714178 140437416843264 dqn_agent.py:283] 	 seed: 1630541626712710
I0902 00:13:46.718544 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:13:46.718834 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:13:46.718982 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:13:46.719094 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:13:46.719232 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:13:46.719391 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:13:46.719576 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:13:46.719778 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:13:46.719916 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:13:46.764253 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:13:47.323132 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:13:47.339088 140437416843264 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:13:47.350540 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:13:47.350788 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:13:47.351054 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:13:47.351348 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:13:47.351498 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0902 00:13:47.351653 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:13:47.351782 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:13:47.351894 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:13:47.352081 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:13:47.352205 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0902 00:13:47.352309 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:13:47.352431 140437416843264 dqn_agent.py:283] 	 seed: 1630541627350472
I0902 00:13:47.355381 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:13:47.355598 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:13:47.355741 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:13:47.355876 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:13:47.355987 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:13:47.356097 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:13:47.356216 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:13:47.356306 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:13:47.356440 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:13:47.394614 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:13:47.419810 140437416843264 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:13:47.420058 140437416843264 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.36
I0902 00:13:54.299924 140437416843264 replay_runner.py:36] Average training steps per second: 145.36
Steps executed: 221 Episode length: 33 Return: 33.0
I0902 00:13:55.515011 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.42
INFO:tensorflow:Starting iteration 1

Steps executed: 344 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 196.55
I0902 00:14:00.793570 140437416843264 replay_runner.py:36] Average training steps per second: 196.55
I0902 00:14:01.042542 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 86.00
INFO:tensorflow:Starting iteration 2

Steps executed: 79 Episode length: 10 Return: 10.08.0
INFO:tensorflow:Average training steps per second: 195.90

Steps executed: 207 Episode length: 17 Return: 17.0.0
I0902 00:14:06.484323 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.94
INFO:tensorflow:Starting iteration 3
I0902 00:14:06.673098 140437416843264 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.24
I0902 00:14:11.667614 140437416843264 replay_runner.py:36] Average training steps per second: 200.24
I0902 00:14:11.866276 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 4

Steps executed: 270 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 197.93
I0902 00:14:17.108049 140437416843264 replay_runner.py:36] Average training steps per second: 197.93
I0902 00:14:17.295511 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 57.20
INFO:tensorflow:Starting iteration 5

Steps executed: 286 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 195.56

Steps executed: 201 Episode length: 66 Return: 66.0.0
I0902 00:14:22.738326 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 67.00
INFO:tensorflow:Starting iteration 6

Steps executed: 298 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 195.45
I0902 00:14:28.049014 140437416843264 replay_runner.py:36] Average training steps per second: 195.45
I0902 00:14:28.250458 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.75
I0902 00:14:33.653194 140437416843264 replay_runner.py:36] Average training steps per second: 193.75
I0902 00:14:33.802320 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 255 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 200.21
I0902 00:14:38.994243 140437416843264 replay_runner.py:36] Average training steps per second: 200.21
I0902 00:14:39.162294 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 9

Steps executed: 283 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 200.66
I0902 00:14:44.336374 140437416843264 replay_runner.py:36] Average training steps per second: 200.66
I0902 00:14:44.523407 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 203.41
I0902 00:14:49.627077 140437416843264 replay_runner.py:36] Average training steps per second: 203.41
I0902 00:14:49.777408 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 11
I0902 00:14:49.958501 140437416843264 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 201.56

Steps executed: 263 Episode length: 133 Return: 133.0
I0902 00:14:55.076356 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.50
INFO:tensorflow:Starting iteration 12

Steps executed: 299 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 215.64
I0902 00:14:59.884945 140437416843264 replay_runner.py:36] Average training steps per second: 215.64
I0902 00:15:00.070698 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 13

Steps executed: 247 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 208.48
I0902 00:15:05.135518 140437416843264 replay_runner.py:36] Average training steps per second: 208.48
I0902 00:15:05.266735 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.50
INFO:tensorflow:Starting iteration 14

Steps executed: 313 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 213.02
I0902 00:15:10.131265 140437416843264 replay_runner.py:36] Average training steps per second: 213.02
I0902 00:15:10.313579 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.15
I0902 00:15:15.486429 140437416843264 replay_runner.py:36] Average training steps per second: 200.15
I0902 00:15:15.612516 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 324 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.56
I0902 00:15:20.661365 140437416843264 replay_runner.py:36] Average training steps per second: 205.56
I0902 00:15:20.867822 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.31
I0902 00:15:25.915969 140437416843264 replay_runner.py:36] Average training steps per second: 205.31
I0902 00:15:26.049028 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 378 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 202.08
I0902 00:15:31.196480 140437416843264 replay_runner.py:36] Average training steps per second: 202.08
I0902 00:15:31.436182 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 19
I0902 00:15:31.619896 140437416843264 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 196.62
I0902 00:15:36.706344 140437416843264 replay_runner.py:36] Average training steps per second: 196.62

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 20
I0902 00:15:37.033159 140437416843264 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 204.30
I0902 00:15:41.928244 140437416843264 replay_runner.py:36] Average training steps per second: 204.30
I0902 00:15:42.067921 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:15:42.257579 140437416843264 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.75
I0902 00:15:47.289706 140437416843264 replay_runner.py:36] Average training steps per second: 198.75
I0902 00:15:47.423343 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:15:47.611874 140437416843264 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 201.14
I0902 00:15:52.584007 140437416843264 replay_runner.py:36] Average training steps per second: 201.14
I0902 00:15:52.713064 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:15:52.892532 140437416843264 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 196.00
I0902 00:15:57.995040 140437416843264 replay_runner.py:36] Average training steps per second: 196.00
I0902 00:15:58.130336 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 310 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 203.05
I0902 00:16:03.224889 140437416843264 replay_runner.py:36] Average training steps per second: 203.05
I0902 00:16:03.436684 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.60
I0902 00:16:08.636997 140437416843264 replay_runner.py:36] Average training steps per second: 199.60
I0902 00:16:08.794222 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:16:08.972831 140437416843264 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.09
I0902 00:16:14.047116 140437416843264 replay_runner.py:36] Average training steps per second: 197.09
I0902 00:16:14.199434 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:16:14.393876 140437416843264 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.15
I0902 00:16:19.492550 140437416843264 replay_runner.py:36] Average training steps per second: 196.15
I0902 00:16:19.630355 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 392 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.18
I0902 00:16:24.793538 140437416843264 replay_runner.py:36] Average training steps per second: 201.18
I0902 00:16:25.068748 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.30
I0902 00:16:30.386812 140437416843264 replay_runner.py:36] Average training steps per second: 195.30
I0902 00:16:30.517335 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00