Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 23:57:26.126688 140720164866048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:57:26.136527 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:57:26.136765 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:57:26.137075 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:57:26.137230 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:57:26.137368 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:57:26.137703 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:57:26.137846 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:57:26.138033 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:57:26.138174 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:57:26.138305 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:57:26.138660 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:57:26.138772 140720164866048 dqn_agent.py:283] 	 seed: 1630627046136456
I0902 23:57:26.143002 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:57:26.143259 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:57:26.143436 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:57:26.143651 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:57:26.143785 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:57:26.143929 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:57:26.144117 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:57:26.144201 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:57:26.144271 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:57:26.185844 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:57:26.675673 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:57:26.690757 140720164866048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:57:26.702095 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:57:26.702362 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:57:26.702482 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:57:26.702589 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:57:26.702700 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:57:26.703017 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:57:26.703249 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:57:26.703384 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:57:26.703534 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:57:26.703698 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:57:26.703838 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:57:26.703935 140720164866048 dqn_agent.py:283] 	 seed: 1630627046702021
I0902 23:57:26.707129 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:57:26.707314 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:57:26.707421 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:57:26.707503 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:57:26.707589 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:57:26.707692 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:57:26.707754 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:57:26.707807 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:57:26.707858 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:57:26.745170 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:57:26.769642 140720164866048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:57:26.769962 140720164866048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.87
I0902 23:57:33.721103 140720164866048 replay_runner.py:36] Average training steps per second: 143.87
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:57:35.169678 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:57:35.411583 140720164866048 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 195.25
I0902 23:57:40.533749 140720164866048 replay_runner.py:36] Average training steps per second: 195.25
I0902 23:57:40.952302 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 523 Episode length: 335 Return: -334.0
INFO:tensorflow:Average training steps per second: 201.27
I0902 23:57:46.158538 140720164866048 replay_runner.py:36] Average training steps per second: 201.27
I0902 23:57:46.593384 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.50
INFO:tensorflow:Starting iteration 3
I0902 23:57:46.834397 140720164866048 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.34

Steps executed: 337 Episode length: 142 Return: -141.0
I0902 23:57:52.124279 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.50
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.84
I0902 23:57:57.255637 140720164866048 replay_runner.py:36] Average training steps per second: 203.84
I0902 23:57:57.652093 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 428 Episode length: 242 Return: -241.0
INFO:tensorflow:Average training steps per second: 214.15
I0902 23:58:02.550752 140720164866048 replay_runner.py:36] Average training steps per second: 214.15
I0902 23:58:02.876135 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.00
INFO:tensorflow:Starting iteration 6
I0902 23:58:03.101953 140720164866048 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 210.38

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:58:08.232848 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 23:58:08.459329 140720164866048 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 214.51
I0902 23:58:13.121391 140720164866048 replay_runner.py:36] Average training steps per second: 214.51
I0902 23:58:13.472554 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:58:13.687856 140720164866048 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 213.36
I0902 23:58:18.375059 140720164866048 replay_runner.py:36] Average training steps per second: 213.36
I0902 23:58:18.753289 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 238 Episode length: 238 Return: -237.0
INFO:tensorflow:Average training steps per second: 212.89
I0902 23:58:23.678471 140720164866048 replay_runner.py:36] Average training steps per second: 212.89
I0902 23:58:23.853370 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.00
INFO:tensorflow:Starting iteration 10

Steps executed: 284 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 213.08
I0902 23:58:28.767395 140720164866048 replay_runner.py:36] Average training steps per second: 213.08
I0902 23:58:28.976043 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 11
I0902 23:58:29.203244 140720164866048 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 212.34

Steps executed: 226 Episode length: 113 Return: -112.0
I0902 23:58:34.079966 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 12

Steps executed: 288 Episode length: 141 Return: -140.0
INFO:tensorflow:Average training steps per second: 218.17
I0902 23:58:38.884473 140720164866048 replay_runner.py:36] Average training steps per second: 218.17
I0902 23:58:39.092297 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.00
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 209 Return: -208.0
INFO:tensorflow:Average training steps per second: 220.25
I0902 23:58:43.852932 140720164866048 replay_runner.py:36] Average training steps per second: 220.25
I0902 23:58:43.998066 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 221.58
I0902 23:58:48.721916 140720164866048 replay_runner.py:36] Average training steps per second: 221.58
I0902 23:58:49.047867 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 23:58:49.361780 140720164866048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 234.91
I0902 23:58:53.619109 140720164866048 replay_runner.py:36] Average training steps per second: 234.91
I0902 23:58:53.936395 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 23:58:54.150713 140720164866048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 236.54

Steps executed: 263 Episode length: 116 Return: -115.0
I0902 23:58:58.530969 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 17

Steps executed: 313 Episode length: 313 Return: -312.0
INFO:tensorflow:Average training steps per second: 243.16
I0902 23:59:02.834763 140720164866048 replay_runner.py:36] Average training steps per second: 243.16
I0902 23:59:03.039803 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.00
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 261.20
I0902 23:59:07.073239 140720164866048 replay_runner.py:36] Average training steps per second: 261.20
I0902 23:59:07.341795 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 268 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 239.67
I0902 23:59:11.708659 140720164866048 replay_runner.py:36] Average training steps per second: 239.67
I0902 23:59:11.885579 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 20

Steps executed: 241 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 272.37
I0902 23:59:15.755641 140720164866048 replay_runner.py:36] Average training steps per second: 272.37
I0902 23:59:15.904663 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 21

Steps executed: 312 Episode length: 312 Return: -311.0
INFO:tensorflow:Average training steps per second: 252.89
I0902 23:59:20.061728 140720164866048 replay_runner.py:36] Average training steps per second: 252.89
I0902 23:59:20.216451 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 259.29
I0902 23:59:24.241312 140720164866048 replay_runner.py:36] Average training steps per second: 259.29
I0902 23:59:24.552934 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 334 Episode length: 139 Return: -138.0
INFO:tensorflow:Average training steps per second: 269.91
I0902 23:59:28.458549 140720164866048 replay_runner.py:36] Average training steps per second: 269.91
I0902 23:59:28.627242 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.00
INFO:tensorflow:Starting iteration 24

Steps executed: 369 Episode length: 176 Return: -175.0
INFO:tensorflow:Average training steps per second: 255.68
I0902 23:59:32.719935 140720164866048 replay_runner.py:36] Average training steps per second: 255.68
I0902 23:59:32.961674 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.50
INFO:tensorflow:Starting iteration 25

Steps executed: 303 Episode length: 303 Return: -302.0
INFO:tensorflow:Average training steps per second: 294.67
I0902 23:59:36.550797 140720164866048 replay_runner.py:36] Average training steps per second: 294.67
I0902 23:59:36.702754 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.00
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 257.27
I0902 23:59:40.778433 140720164866048 replay_runner.py:36] Average training steps per second: 257.27
I0902 23:59:41.023396 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 204 Episode length: 204 Return: -203.0
INFO:tensorflow:Average training steps per second: 285.36
I0902 23:59:44.706735 140720164866048 replay_runner.py:36] Average training steps per second: 285.36
I0902 23:59:44.831549 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.00
INFO:tensorflow:Starting iteration 28

Steps executed: 265 Episode length: 265 Return: -264.0
INFO:tensorflow:Average training steps per second: 266.52
I0902 23:59:48.783307 140720164866048 replay_runner.py:36] Average training steps per second: 266.52
I0902 23:59:48.904152 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 281 Return: -280.0
INFO:tensorflow:Average training steps per second: 270.03
I0902 23:59:52.768354 140720164866048 replay_runner.py:36] Average training steps per second: 270.03
I0902 23:59:52.945757 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.00