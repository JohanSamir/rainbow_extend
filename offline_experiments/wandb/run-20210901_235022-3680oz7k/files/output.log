Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0901 23:50:29.005373 140035835951104 run_experiment.py:549] Creating TrainRunner ...
I0901 23:50:29.014958 140035835951104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:29.015306 140035835951104 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:29.015467 140035835951104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:29.015606 140035835951104 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:29.015787 140035835951104 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:29.015915 140035835951104 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:29.016062 140035835951104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:29.016258 140035835951104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:29.016399 140035835951104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:29.016534 140035835951104 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:29.016646 140035835951104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:29.016754 140035835951104 dqn_agent.py:283] 	 seed: 1630540229014874
I0901 23:50:29.019031 140035835951104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:29.019185 140035835951104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:50:29.019323 140035835951104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:29.019401 140035835951104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:29.019478 140035835951104 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:29.019545 140035835951104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:29.019594 140035835951104 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:29.019640 140035835951104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:29.019687 140035835951104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:29.060046 140035835951104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:29.918775 140035835951104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:29.934357 140035835951104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:50:29.942181 140035835951104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:29.942439 140035835951104 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:29.942597 140035835951104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:29.942789 140035835951104 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:29.942955 140035835951104 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:29.943099 140035835951104 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:29.943179 140035835951104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:29.943273 140035835951104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:29.943382 140035835951104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:29.943504 140035835951104 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:29.943625 140035835951104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:29.943709 140035835951104 dqn_agent.py:283] 	 seed: 1630540229942107
I0901 23:50:29.946491 140035835951104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:29.946701 140035835951104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:50:29.946892 140035835951104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:29.947059 140035835951104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:29.947210 140035835951104 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:29.947352 140035835951104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:29.947530 140035835951104 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:29.947651 140035835951104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:29.947950 140035835951104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:29.984016 140035835951104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:30.011157 140035835951104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:50:30.011538 140035835951104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.80
I0901 23:50:36.643514 140035835951104 replay_runner.py:36] Average training steps per second: 150.80
Steps executed: 283 Episode length: 148 Return: 148.0
I0901 23:50:37.758087 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 1
I0901 23:50:37.938845 140035835951104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 211.48
I0901 23:50:42.667762 140035835951104 replay_runner.py:36] Average training steps per second: 211.48

Steps executed: 368 Episode length: 194 Return: 194.0
INFO:tensorflow:Starting iteration 2

Steps executed: 314 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 193.84
I0901 23:50:48.248091 140035835951104 replay_runner.py:36] Average training steps per second: 193.84
I0901 23:50:48.472233 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 3

Steps executed: 317 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 210.39
I0901 23:50:53.411502 140035835951104 replay_runner.py:36] Average training steps per second: 210.39
I0901 23:50:53.618733 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 4

Steps executed: 283 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 194.64
I0901 23:50:58.935783 140035835951104 replay_runner.py:36] Average training steps per second: 194.64
I0901 23:50:59.126329 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.74
I0901 23:51:04.442288 140035835951104 replay_runner.py:36] Average training steps per second: 194.74
I0901 23:51:04.570844 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 299 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 193.46
I0901 23:51:09.917820 140035835951104 replay_runner.py:36] Average training steps per second: 193.46
I0901 23:51:10.146387 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.40
I0901 23:51:15.330589 140035835951104 replay_runner.py:36] Average training steps per second: 200.40
I0901 23:51:15.462683 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 181 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 192.41

Steps executed: 381 Episode length: 200 Return: 200.0
I0901 23:51:21.112037 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 9

Steps executed: 248 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 192.70
I0901 23:51:26.473211 140035835951104 replay_runner.py:36] Average training steps per second: 192.70
I0901 23:51:26.638926 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 10

Steps executed: 248 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 192.41
I0901 23:51:32.024519 140035835951104 replay_runner.py:36] Average training steps per second: 192.41
I0901 23:51:32.195595 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 11

Steps executed: 246 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 192.65
I0901 23:51:37.564363 140035835951104 replay_runner.py:36] Average training steps per second: 192.65
I0901 23:51:37.737770 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.00
INFO:tensorflow:Starting iteration 12

Steps executed: 121 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 190.48

Steps executed: 260 Episode length: 139 Return: 139.0
I0901 23:51:43.374959 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.00
INFO:tensorflow:Starting iteration 13

Steps executed: 253 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 194.26
I0901 23:51:48.713973 140035835951104 replay_runner.py:36] Average training steps per second: 194.26
I0901 23:51:48.888656 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.50
INFO:tensorflow:Starting iteration 14

Steps executed: 280 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 192.75
I0901 23:51:54.269385 140035835951104 replay_runner.py:36] Average training steps per second: 192.75
I0901 23:51:54.471021 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.00
INFO:tensorflow:Starting iteration 15

Steps executed: 284 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 187.54
I0901 23:52:00.004176 140035835951104 replay_runner.py:36] Average training steps per second: 187.54
I0901 23:52:00.195634 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.45
I0901 23:52:05.527776 140035835951104 replay_runner.py:36] Average training steps per second: 194.45
I0901 23:52:05.664494 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:52:05.848939 140035835951104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 187.57
I0901 23:52:11.180684 140035835951104 replay_runner.py:36] Average training steps per second: 187.57
I0901 23:52:11.326268 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:52:11.526921 140035835951104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 197.18
I0901 23:52:16.598941 140035835951104 replay_runner.py:36] Average training steps per second: 197.18
I0901 23:52:16.734351 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:52:16.924908 140035835951104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 185.87
I0901 23:52:22.305537 140035835951104 replay_runner.py:36] Average training steps per second: 185.87
I0901 23:52:22.452432 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:52:22.649224 140035835951104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.20
I0901 23:52:27.746655 140035835951104 replay_runner.py:36] Average training steps per second: 196.20
I0901 23:52:27.898995 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:52:28.104676 140035835951104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 190.90
I0901 23:52:33.343511 140035835951104 replay_runner.py:36] Average training steps per second: 190.90
I0901 23:52:33.484788 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 397 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.94
I0901 23:52:38.786759 140035835951104 replay_runner.py:36] Average training steps per second: 195.94
I0901 23:52:39.065063 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.64
I0901 23:52:44.563592 140035835951104 replay_runner.py:36] Average training steps per second: 188.64
I0901 23:52:44.706035 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:52:44.887353 140035835951104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 192.69
I0901 23:52:50.077872 140035835951104 replay_runner.py:36] Average training steps per second: 192.69
I0901 23:52:50.219374 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:52:50.415367 140035835951104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 199.97
I0901 23:52:55.416662 140035835951104 replay_runner.py:36] Average training steps per second: 199.97
I0901 23:52:55.565146 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:52:55.755877 140035835951104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 191.42
I0901 23:53:00.980544 140035835951104 replay_runner.py:36] Average training steps per second: 191.42
I0901 23:53:01.108168 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:53:01.292249 140035835951104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 195.78
I0901 23:53:06.400352 140035835951104 replay_runner.py:36] Average training steps per second: 195.78
I0901 23:53:06.545096 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:53:06.739564 140035835951104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 197.94
I0901 23:53:11.792138 140035835951104 replay_runner.py:36] Average training steps per second: 197.94
I0901 23:53:11.925729 140035835951104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 23:53:12.113451 140035835951104 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 186.77
I0901 23:53:17.468070 140035835951104 replay_runner.py:36] Average training steps per second: 186.77

Done fixed training!Episode length: 200 Return: 200.0