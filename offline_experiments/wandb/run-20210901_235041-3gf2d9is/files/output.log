Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0901 23:50:47.696349 139636266051584 run_experiment.py:549] Creating TrainRunner ...
I0901 23:50:47.706684 139636266051584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:47.707005 139636266051584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:47.707195 139636266051584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:47.707388 139636266051584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:47.707471 139636266051584 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:47.707614 139636266051584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:47.707762 139636266051584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:47.707931 139636266051584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:47.708031 139636266051584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:47.708104 139636266051584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:47.708264 139636266051584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:47.708344 139636266051584 dqn_agent.py:283] 	 seed: 1630540247706606
I0901 23:50:47.711858 139636266051584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:47.712132 139636266051584 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:50:47.712344 139636266051584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:47.712467 139636266051584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:47.712561 139636266051584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:47.712709 139636266051584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:47.712863 139636266051584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:47.713006 139636266051584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:47.713188 139636266051584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:47.755190 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:48.545522 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:48.561480 139636266051584 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:50:48.570031 139636266051584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:48.570329 139636266051584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:48.570524 139636266051584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:48.570668 139636266051584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:48.570857 139636266051584 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:48.571108 139636266051584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:48.571208 139636266051584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:48.571318 139636266051584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:48.571621 139636266051584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:48.571748 139636266051584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:48.571903 139636266051584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:48.572078 139636266051584 dqn_agent.py:283] 	 seed: 1630540248569980
I0901 23:50:48.574616 139636266051584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:48.574887 139636266051584 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:50:48.574994 139636266051584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:48.575112 139636266051584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:48.575194 139636266051584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:48.575276 139636266051584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:48.575386 139636266051584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:48.575491 139636266051584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:48.575614 139636266051584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:48.612333 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:48.634808 139636266051584 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:50:48.635065 139636266051584 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 157.13
I0901 23:50:54.999392 139636266051584 replay_runner.py:36] Average training steps per second: 157.13
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:50:56.459557 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:50:56.703404 139636266051584 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 199.13

Steps executed: 349 Episode length: 201 Return: -200.0
I0901 23:51:01.997202 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.50
INFO:tensorflow:Starting iteration 2
I0901 23:51:02.262092 139636266051584 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 205.22

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:51:07.575771 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:51:07.834393 139636266051584 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 198.50
I0901 23:51:12.872583 139636266051584 replay_runner.py:36] Average training steps per second: 198.50
I0901 23:51:13.259655 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:51:13.485454 139636266051584 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 200.58
I0901 23:51:18.471726 139636266051584 replay_runner.py:36] Average training steps per second: 200.58
I0901 23:51:18.889444 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:51:19.120855 139636266051584 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.03
I0901 23:51:24.196511 139636266051584 replay_runner.py:36] Average training steps per second: 197.03
I0901 23:51:24.592800 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 259 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 194.95
I0901 23:51:29.962132 139636266051584 replay_runner.py:36] Average training steps per second: 194.95
I0901 23:51:30.187206 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 7

Steps executed: 98 Episode length: 98 Return: -97.00.0
INFO:tensorflow:Average training steps per second: 199.08

Steps executed: 274 Episode length: 176 Return: -175.0
I0901 23:51:35.696020 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 8

Steps executed: 593 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.54
I0901 23:51:41.089338 139636266051584 replay_runner.py:36] Average training steps per second: 194.54
I0901 23:51:41.589664 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.32
I0901 23:51:46.934778 139636266051584 replay_runner.py:36] Average training steps per second: 196.32
I0901 23:51:47.345017 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 264 Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 197.00
I0901 23:51:52.665197 139636266051584 replay_runner.py:36] Average training steps per second: 197.00
I0901 23:51:52.890477 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.00
INFO:tensorflow:Starting iteration 11

Steps executed: 366 Episode length: 207 Return: -206.0
INFO:tensorflow:Average training steps per second: 196.35
I0901 23:51:58.222229 139636266051584 replay_runner.py:36] Average training steps per second: 196.35
I0901 23:51:58.549261 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.00
INFO:tensorflow:Starting iteration 12


Steps executed: 242 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 198.28
I0901 23:52:03.813972 139636266051584 replay_runner.py:36] Average training steps per second: 198.28
I0901 23:52:03.997601 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 13

Steps executed: 256 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 196.06
I0901 23:52:09.343462 139636266051584 replay_runner.py:36] Average training steps per second: 196.06
I0901 23:52:09.568808 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 14

Steps executed: 289 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 198.39
I0901 23:52:14.868945 139636266051584 replay_runner.py:36] Average training steps per second: 198.39
I0901 23:52:15.104586 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 15

Steps executed: 224 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 195.83
I0901 23:52:20.443876 139636266051584 replay_runner.py:36] Average training steps per second: 195.83
I0901 23:52:20.642428 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 16
I0901 23:52:20.888741 139636266051584 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 198.41

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:52:26.346981 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 247 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 193.04
I0901 23:52:31.763195 139636266051584 replay_runner.py:36] Average training steps per second: 193.04
I0901 23:52:31.986488 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 18

Steps executed: 264 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 199.54
I0901 23:52:37.247832 139636266051584 replay_runner.py:36] Average training steps per second: 199.54
I0901 23:52:37.459856 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 19

Steps executed: 527 Episode length: 456 Return: -455.0
INFO:tensorflow:Average training steps per second: 191.31
I0901 23:52:42.933717 139636266051584 replay_runner.py:36] Average training steps per second: 191.31
I0901 23:52:43.362049 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.50
INFO:tensorflow:Starting iteration 20

Steps executed: 356 Episode length: 157 Return: -156.0
INFO:tensorflow:Average training steps per second: 195.99
I0901 23:52:48.709255 139636266051584 replay_runner.py:36] Average training steps per second: 195.99
I0901 23:52:49.003502 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.67
INFO:tensorflow:Starting iteration 21

Steps executed: 332 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 201.89
I0901 23:52:54.192034 139636266051584 replay_runner.py:36] Average training steps per second: 201.89
I0901 23:52:54.495920 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.67
INFO:tensorflow:Starting iteration 22

Steps executed: 80 Episode length: 80 Return: -79.05.0
INFO:tensorflow:Average training steps per second: 194.21
I0901 23:52:59.877140 139636266051584 replay_runner.py:36] Average training steps per second: 194.21
I0901 23:53:00.186859 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.50
INFO:tensorflow:Starting iteration 23


Steps executed: 254 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 206.92
I0901 23:53:05.252733 139636266051584 replay_runner.py:36] Average training steps per second: 206.92
I0901 23:53:05.469732 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 24
I0901 23:53:05.718918 139636266051584 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.71
I0901 23:53:10.803063 139636266051584 replay_runner.py:36] Average training steps per second: 196.71
I0901 23:53:11.016163 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 25

Steps executed: 266 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 198.56
I0901 23:53:16.282380 139636266051584 replay_runner.py:36] Average training steps per second: 198.56
I0901 23:53:16.472312 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.00
INFO:tensorflow:Starting iteration 26

Steps executed: 213 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 203.96
I0901 23:53:21.610036 139636266051584 replay_runner.py:36] Average training steps per second: 203.96
I0901 23:53:21.812409 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 27


Steps executed: 209 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 194.19
I0901 23:53:27.195567 139636266051584 replay_runner.py:36] Average training steps per second: 194.19
I0901 23:53:27.365118 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 28
I0901 23:53:27.602980 139636266051584 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.87
I0901 23:53:32.460864 139636266051584 replay_runner.py:36] Average training steps per second: 205.87
I0901 23:53:32.871567 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.80


Done fixed training!Episode length: 500 Return: -500.0
I0901 23:53:38.452501 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.00