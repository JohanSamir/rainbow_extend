I0905 16:42:13.181971 140439533856768 run_experiment.py:549] Creating TrainRunner ...
I0905 16:42:13.191061 140439533856768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:13.191207 140439533856768 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:13.191281 140439533856768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:13.191343 140439533856768 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:13.191399 140439533856768 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:13.191471 140439533856768 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:13.191530 140439533856768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:13.191602 140439533856768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:13.191668 140439533856768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:13.191745 140439533856768 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:13.191833 140439533856768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:13.191882 140439533856768 dqn_agent.py:283] 	 seed: 1630860133191023
I0905 16:42:13.194264 140439533856768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:13.194420 140439533856768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:13.194523 140439533856768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:13.194606 140439533856768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:13.194690 140439533856768 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:13.194754 140439533856768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:13.194868 140439533856768 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:13.195025 140439533856768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:13.195157 140439533856768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:42:14.525886 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0905 16:42:15.295257 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:15.307853 140439533856768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:42:15.314346 140439533856768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:15.314518 140439533856768 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:15.314638 140439533856768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:15.314726 140439533856768 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:15.314959 140439533856768 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:15.315180 140439533856768 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:15.315493 140439533856768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:15.315701 140439533856768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:15.315822 140439533856768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:15.316045 140439533856768 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:15.316197 140439533856768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:15.316660 140439533856768 dqn_agent.py:283] 	 seed: 1630860135314306
I0905 16:42:15.319855 140439533856768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:15.320018 140439533856768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:15.320116 140439533856768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:15.320213 140439533856768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:15.320289 140439533856768 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:15.320495 140439533856768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:15.320577 140439533856768 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:15.320650 140439533856768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:15.320705 140439533856768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:42:15.344606 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:15.364221 140439533856768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:42:15.364434 140439533856768 replay_runner.py:41] Starting iteration 0
Steps executed: 215 Episode length: 97 Return: -294.601730567117446
INFO:tensorflow:Average training steps per second: 171.30
I0905 16:42:21.202570 140439533856768 replay_runner.py:36] Average training steps per second: 171.30
I0905 16:42:22.247909 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.81
INFO:tensorflow:Starting iteration 1

Steps executed: 301 Episode length: 148 Return: -165.82721401377614
INFO:tensorflow:Average training steps per second: 234.25
I0905 16:42:30.582585 140439533856768 replay_runner.py:36] Average training steps per second: 234.25
I0905 16:42:30.889382 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.22
INFO:tensorflow:Starting iteration 2
I0905 16:42:34.691512 140439533856768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 234.73

Steps executed: 288 Episode length: 288 Return: -305.76448209426576
I0905 16:42:39.363447 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.76
INFO:tensorflow:Starting iteration 3
I0905 16:42:43.307629 140439533856768 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 221.17

Steps executed: 1000 Episode length: 1000 Return: -194.89555282822477
I0905 16:42:51.255939 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.90
INFO:tensorflow:Starting iteration 4
I0905 16:42:55.107901 140439533856768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 233.02

Steps executed: 1000 Episode length: 1000 Return: -154.04556187696567
I0905 16:43:02.576042 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.05
INFO:tensorflow:Starting iteration 5
I0905 16:43:06.636750 140439533856768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 248.20

Steps executed: 753 Episode length: 753 Return: -457.1217438201350767
I0905 16:43:12.024423 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -457.12
INFO:tensorflow:Starting iteration 6
I0905 16:43:16.229068 140439533856768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 243.36

Steps executed: 955 Episode length: 955 Return: -399.3732690201485467
I0905 16:43:23.482149 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.37
INFO:tensorflow:Starting iteration 7

Steps executed: 163 Episode length: 163 Return: -201.4084069595595467
INFO:tensorflow:Average training steps per second: 246.74

Steps executed: 1163 Episode length: 1000 Return: -150.69877047575133
I0905 16:43:33.824129 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.05
INFO:tensorflow:Starting iteration 8

Steps executed: 377 Episode length: 377 Return: -525.8477213210847133
INFO:tensorflow:Average training steps per second: 245.24
I0905 16:43:41.931579 140439533856768 replay_runner.py:36] Average training steps per second: 245.24
I0905 16:43:42.439538 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -525.85
INFO:tensorflow:Starting iteration 9
I0905 16:43:46.540682 140439533856768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 237.35

Steps executed: 498 Episode length: 498 Return: -305.7449906467847133
I0905 16:43:51.464281 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.74
INFO:tensorflow:Starting iteration 10
I0905 16:43:55.491010 140439533856768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 243.71
I0905 16:43:59.594485 140439533856768 replay_runner.py:36] Average training steps per second: 243.71

Steps executed: 1000 Episode length: 1000 Return: -87.938096389853473
INFO:tensorflow:Starting iteration 11
I0905 16:44:05.251708 140439533856768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 235.37

Steps executed: 679 Episode length: 679 Return: -222.8896359157859673
I0905 16:44:10.628871 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.89
INFO:tensorflow:Starting iteration 12
I0905 16:44:14.439927 140439533856768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 225.31
I0905 16:44:18.878765 140439533856768 replay_runner.py:36] Average training steps per second: 225.31

Steps executed: 1000 Episode length: 1000 Return: -5.0768134513354943
INFO:tensorflow:Starting iteration 13

Steps executed: 232 Episode length: 232 Return: -42.44173699685107943
INFO:tensorflow:Average training steps per second: 229.56
I0905 16:44:29.384554 140439533856768 replay_runner.py:36] Average training steps per second: 229.56
I0905 16:44:29.679497 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.44
INFO:tensorflow:Starting iteration 14

Steps executed: 299 Episode length: 175 Return: -97.11280377752568643
INFO:tensorflow:Average training steps per second: 227.43
I0905 16:44:37.821464 140439533856768 replay_runner.py:36] Average training steps per second: 227.43
I0905 16:44:38.147698 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.78
INFO:tensorflow:Starting iteration 15
I0905 16:44:42.056568 140439533856768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 260.48

Steps executed: 588 Episode length: 588 Return: -105.1453359271820543
I0905 16:44:47.340987 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.15
INFO:tensorflow:Starting iteration 16
I0905 16:44:51.364284 140439533856768 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 254.18

Steps executed: 1000 Episode length: 1000 Return: -16.394945395086033
I0905 16:44:59.110865 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -16.39
INFO:tensorflow:Starting iteration 17
I0905 16:45:03.044607 140439533856768 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 242.16

Steps executed: 462 Episode length: 292 Return: -318.6328397685274033
I0905 16:45:07.851422 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.18
INFO:tensorflow:Starting iteration 18

Steps executed: 175 Episode length: 175 Return: -88.48964742599794033
INFO:tensorflow:Average training steps per second: 248.09

Steps executed: 760 Episode length: 585 Return: -153.9000575658309633
I0905 16:45:17.503954 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.19
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: -474.1986113262805633
INFO:tensorflow:Average training steps per second: 247.44
I0905 16:45:25.621438 140439533856768 replay_runner.py:36] Average training steps per second: 247.44
I0905 16:45:25.841637 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.20
INFO:tensorflow:Starting iteration 20

Steps executed: 366 Episode length: 185 Return: -58.50960279797156233
INFO:tensorflow:Average training steps per second: 247.75
I0905 16:45:33.919165 140439533856768 replay_runner.py:36] Average training steps per second: 247.75
I0905 16:45:34.311821 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -36.38
INFO:tensorflow:Starting iteration 21

Steps executed: 456 Episode length: 303 Return: -448.9357813805138433
INFO:tensorflow:Average training steps per second: 248.99
I0905 16:45:42.570459 140439533856768 replay_runner.py:36] Average training steps per second: 248.99
I0905 16:45:43.109236 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.48
INFO:tensorflow:Starting iteration 22

Steps executed: 159 Episode length: 159 Return: -114.1171637567724433
INFO:tensorflow:Average training steps per second: 266.70
I0905 16:45:51.170528 140439533856768 replay_runner.py:36] Average training steps per second: 266.70

Steps executed: 291 Episode length: 132 Return: -128.7883295090777633
INFO:tensorflow:Starting iteration 23

Steps executed: 311 Episode length: 311 Return: -136.1496022153944533
INFO:tensorflow:Average training steps per second: 248.68
I0905 16:45:59.643781 140439533856768 replay_runner.py:36] Average training steps per second: 248.68
I0905 16:46:00.019391 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.15
INFO:tensorflow:Starting iteration 24
I0905 16:46:03.854750 140439533856768 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 228.24

Steps executed: 671 Episode length: 671 Return: -279.1883658666624533
I0905 16:46:09.578329 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.19
INFO:tensorflow:Starting iteration 25

Steps executed: 162 Episode length: 162 Return: -34.59404740837823533
INFO:tensorflow:Average training steps per second: 228.33

Steps executed: 1162 Episode length: 1000 Return: 113.812405788007933
I0905 16:46:20.371187 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: 39.61
INFO:tensorflow:Starting iteration 26

Steps executed: 238 Episode length: 124 Return: -154.7668218830112933
INFO:tensorflow:Average training steps per second: 246.31
I0905 16:46:28.482259 140439533856768 replay_runner.py:36] Average training steps per second: 246.31
I0905 16:46:28.735721 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.91
INFO:tensorflow:Starting iteration 27

Steps executed: 130 Episode length: 130 Return: -18.64510713336841333
INFO:tensorflow:Average training steps per second: 259.48

Steps executed: 757 Episode length: 627 Return: 188.42859716537591333
I0905 16:46:37.872416 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.89
INFO:tensorflow:Starting iteration 28
I0905 16:46:41.823823 140439533856768 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 265.55


Steps executed: 1083 Episode length: 1000 Return: 132.955825872064083
I0905 16:46:48.515572 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.82
INFO:tensorflow:Starting iteration 29

Steps executed: 253 Episode length: 115 Return: -39.27138072639014883
INFO:tensorflow:Average training steps per second: 257.53
I0905 16:46:56.112173 140439533856768 replay_runner.py:36] Average training steps per second: 257.53

Done fixed training!Episode length: 115 Return: -39.27138072639014883