Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 12:36:42.503093 140457859885056 run_experiment.py:549] Creating TrainRunner ...
I0901 12:36:42.516140 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:36:42.516459 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:36:42.516686 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:36:42.516858 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:36:42.516996 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:36:42.517171 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:36:42.517262 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:36:42.517336 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:36:42.517466 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:36:42.517712 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:36:42.517824 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:36:42.517926 140457859885056 dqn_agent.py:283] 	 seed: 1630499802516062
I0901 12:36:42.521134 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:36:42.521377 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:36:42.521493 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:36:42.521585 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:36:42.521668 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:36:42.521744 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:36:42.521859 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:36:42.521938 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:36:42.522032 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:36:42.599714 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:36:43.197304 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:36:43.211477 140457859885056 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:36:43.220815 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:36:43.221109 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:36:43.221320 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:36:43.221457 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:36:43.221586 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:36:43.221698 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:36:43.222022 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:36:43.222257 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:36:43.222756 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:36:43.222947 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:36:43.223454 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:36:43.223787 140457859885056 dqn_agent.py:283] 	 seed: 1630499803220757
I0901 12:36:43.227253 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:36:43.227609 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:36:43.227753 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:36:43.227931 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:36:43.228040 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:36:43.228144 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:36:43.228239 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:36:43.228328 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:36:43.228419 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:36:43.269451 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:36:43.294505 140457859885056 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:36:43.294841 140457859885056 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.74
I0901 12:36:49.973532 140457859885056 replay_runner.py:36] Average training steps per second: 149.74
Steps executed: 202 Episode length: 10 Return: 10.0
I0901 12:36:51.210163 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.06
I0901 12:36:56.484998 140457859885056 replay_runner.py:36] Average training steps per second: 197.06
I0901 12:36:56.650242 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 2

Steps executed: 208 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 201.08
I0901 12:37:01.802470 140457859885056 replay_runner.py:36] Average training steps per second: 201.08
I0901 12:37:01.950705 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 3

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.50
I0901 12:37:07.248166 140457859885056 replay_runner.py:36] Average training steps per second: 195.50
I0901 12:37:07.374469 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 4

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 192.31
I0901 12:37:12.748083 140457859885056 replay_runner.py:36] Average training steps per second: 192.31
I0901 12:37:12.903469 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 5

Steps executed: 142 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 195.59
I0901 12:37:18.214255 140457859885056 replay_runner.py:36] Average training steps per second: 195.59

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Starting iteration 6

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.71
I0901 12:37:23.619110 140457859885056 replay_runner.py:36] Average training steps per second: 197.71
I0901 12:37:23.784390 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.00
INFO:tensorflow:Starting iteration 7

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.44
I0901 12:37:29.116014 140457859885056 replay_runner.py:36] Average training steps per second: 194.44
I0901 12:37:29.292034 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 8

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 191.22
I0901 12:37:34.723615 140457859885056 replay_runner.py:36] Average training steps per second: 191.22
I0901 12:37:34.872191 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 9

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 152.09
I0901 12:37:41.647241 140457859885056 replay_runner.py:36] Average training steps per second: 152.09
I0901 12:37:41.817075 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 200.18
I0901 12:37:47.006322 140457859885056 replay_runner.py:36] Average training steps per second: 200.18
I0901 12:37:47.153634 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 11

Steps executed: 85 Episode length: 85 Return: 85.00
INFO:tensorflow:Average training steps per second: 191.30

Steps executed: 247 Episode length: 90 Return: 90.0
I0901 12:37:52.769692 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 82.33
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 201.25
I0901 12:37:57.931861 140457859885056 replay_runner.py:36] Average training steps per second: 201.25
I0901 12:37:58.091127 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 191.18
I0901 12:38:03.518229 140457859885056 replay_runner.py:36] Average training steps per second: 191.18
I0901 12:38:03.677600 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 14

Steps executed: 231 Episode length: 40 Return: 40.0
INFO:tensorflow:Average training steps per second: 193.58
I0901 12:38:09.045028 140457859885056 replay_runner.py:36] Average training steps per second: 193.58
I0901 12:38:09.209437 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 46.20
INFO:tensorflow:Starting iteration 15
I0901 12:38:09.400621 140457859885056 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.85
I0901 12:38:14.430274 140457859885056 replay_runner.py:36] Average training steps per second: 198.85
I0901 12:38:14.583990 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 16

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 186.00
I0901 12:38:20.161018 140457859885056 replay_runner.py:36] Average training steps per second: 186.00
I0901 12:38:20.300477 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 17

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 191.87
I0901 12:38:25.707350 140457859885056 replay_runner.py:36] Average training steps per second: 191.87
I0901 12:38:25.863168 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 186.53
I0901 12:38:31.423467 140457859885056 replay_runner.py:36] Average training steps per second: 186.53
I0901 12:38:31.566140 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 19

Steps executed: 202 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 194.55
I0901 12:38:36.911293 140457859885056 replay_runner.py:36] Average training steps per second: 194.55
I0901 12:38:37.079268 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 20

Steps executed: 94 Episode length: 8 Return: 8.0.00
INFO:tensorflow:Average training steps per second: 188.33

Steps executed: 207 Episode length: 10 Return: 10.0
I0901 12:38:42.755560 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.47
I0901 12:38:48.067911 140457859885056 replay_runner.py:36] Average training steps per second: 195.47
I0901 12:38:48.245873 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 22

Steps executed: 240 Episode length: 84 Return: 84.0
INFO:tensorflow:Average training steps per second: 187.57
I0901 12:38:53.783315 140457859885056 replay_runner.py:36] Average training steps per second: 187.57
I0901 12:38:53.948957 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 80.00
INFO:tensorflow:Starting iteration 23

Steps executed: 207 Episode length: 55 Return: 55.0
INFO:tensorflow:Average training steps per second: 192.22
I0901 12:38:59.350222 140457859885056 replay_runner.py:36] Average training steps per second: 192.22
I0901 12:38:59.503078 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 51.75
INFO:tensorflow:Starting iteration 24
I0901 12:38:59.699076 140457859885056 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 193.07

Steps executed: 207 Episode length: 10 Return: 10.0
I0901 12:39:05.031370 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 190.25
I0901 12:39:10.483707 140457859885056 replay_runner.py:36] Average training steps per second: 190.25
I0901 12:39:10.633210 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 26

Steps executed: 229 Episode length: 49 Return: 49.0
INFO:tensorflow:Average training steps per second: 190.18
I0901 12:39:16.083809 140457859885056 replay_runner.py:36] Average training steps per second: 190.18
I0901 12:39:16.259554 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 57.25
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 190.16
I0901 12:39:21.720471 140457859885056 replay_runner.py:36] Average training steps per second: 190.16
I0901 12:39:21.871938 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.04
INFO:tensorflow:Starting iteration 28

Steps executed: 213 Episode length: 49 Return: 49.0
INFO:tensorflow:Average training steps per second: 194.41
I0901 12:39:27.212433 140457859885056 replay_runner.py:36] Average training steps per second: 194.41
I0901 12:39:27.373940 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 53.25
INFO:tensorflow:Starting iteration 29

Steps executed: 109 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 185.62
I0901 12:39:32.943890 140457859885056 replay_runner.py:36] Average training steps per second: 185.62

Done fixed training!Episode length: 10 Return: 10.0