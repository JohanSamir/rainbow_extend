I0902 00:27:36.583424 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:27:36.591518 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:36.591645 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:36.591725 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:36.591793 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:36.591850 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:36.591935 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:36.592020 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:36.592078 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:36.592149 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:36.592231 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:36.592310 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:36.592390 140053067847680 dqn_agent.py:283] 	 seed: 1630542456591484
I0902 00:27:36.595017 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:36.595226 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:36.595368 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:36.595456 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:36.595532 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:36.595626 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:36.595733 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:36.595837 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:36.595924 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:36.621519 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:36.881779 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:36.892034 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:27:36.899531 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:36.899676 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:36.899760 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:36.899837 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:36.899900 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:36.899959 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:36.900045 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:36.900143 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:36.900229 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:36.900307 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:36.900378 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:36.900465 140053067847680 dqn_agent.py:283] 	 seed: 1630542456899497
I0902 00:27:36.902019 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:36.902159 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:36.902240 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:36.902310 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:36.902373 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:36.902434 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:36.902509 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:36.902593 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:36.902666 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:36.928667 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:36.944509 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:27:36.944672 140053067847680 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 228.05
I0902 00:27:41.329806 140053067847680 replay_runner.py:36] Average training steps per second: 228.05
I0902 00:27:42.046849 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.98
Steps executed: 212 Episode length: 109 Return: -288.62024517061816
INFO:tensorflow:Starting iteration 1
I0902 00:27:45.462400 140053067847680 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 342.98
I0902 00:27:48.378490 140053067847680 replay_runner.py:36] Average training steps per second: 342.98

Steps executed: 259 Episode length: 156 Return: -418.16689726205926
INFO:tensorflow:Starting iteration 2
I0902 00:27:51.864638 140053067847680 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 333.15
I0902 00:27:54.866581 140053067847680 replay_runner.py:36] Average training steps per second: 333.15

Steps executed: 259 Episode length: 151 Return: -31.820728846825985
INFO:tensorflow:Starting iteration 3
I0902 00:27:58.322049 140053067847680 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 318.97
I0902 00:28:01.457447 140053067847680 replay_runner.py:36] Average training steps per second: 318.97

Steps executed: 248 Episode length: 248 Return: -239.80605651205033
INFO:tensorflow:Starting iteration 4
I0902 00:28:04.979170 140053067847680 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 338.85

Steps executed: 157 Episode length: 157 Return: -86.770713405502023

Steps executed: 674 Episode length: 517 Return: -240.77104438067563
INFO:tensorflow:Starting iteration 5
I0902 00:28:12.010493 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 345.77
I0902 00:28:14.902964 140053067847680 replay_runner.py:36] Average training steps per second: 345.77

Steps executed: 1000 Episode length: 1000 Return: -61.25552512152467
INFO:tensorflow:Starting iteration 6
I0902 00:28:20.028486 140053067847680 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 327.88
I0902 00:28:23.078676 140053067847680 replay_runner.py:36] Average training steps per second: 327.88

Steps executed: 1000 Episode length: 1000 Return: -146.3191751848533
INFO:tensorflow:Starting iteration 7
I0902 00:28:28.013061 140053067847680 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 331.21
I0902 00:28:31.032520 140053067847680 replay_runner.py:36] Average training steps per second: 331.21

Steps executed: 1000 Episode length: 1000 Return: -59.894698238954106
INFO:tensorflow:Starting iteration 8
I0902 00:28:36.822315 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 319.88

Steps executed: 1000 Episode length: 1000 Return: -161.84150383670036
I0902 00:28:41.865781 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.84
INFO:tensorflow:Starting iteration 9
I0902 00:28:45.111613 140053067847680 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 319.14

Steps executed: 664 Episode length: 664 Return: -801.4461593828045036
I0902 00:28:48.927712 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -801.45
INFO:tensorflow:Starting iteration 10
I0902 00:28:52.175213 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 323.92

Steps executed: 1000 Episode length: 1000 Return: -158.77958467731224
I0902 00:28:57.620032 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.78
INFO:tensorflow:Starting iteration 11
I0902 00:29:00.923209 140053067847680 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 331.47

Steps executed: 1000 Episode length: 1000 Return: -127.35697068125086
I0902 00:29:05.987396 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.36
INFO:tensorflow:Starting iteration 12
I0902 00:29:09.339907 140053067847680 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 322.97

Steps executed: 1000 Episode length: 1000 Return: -311.45134818938116
I0902 00:29:14.442013 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.45
INFO:tensorflow:Starting iteration 13

Steps executed: 297 Episode length: 113 Return: 22.494595498457116716
INFO:tensorflow:Average training steps per second: 319.83
I0902 00:29:20.908399 140053067847680 replay_runner.py:36] Average training steps per second: 319.83
I0902 00:29:21.086014 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.28
INFO:tensorflow:Starting iteration 14

Steps executed: 401 Episode length: 245 Return: -139.2170802644312716
INFO:tensorflow:Average training steps per second: 322.83
I0902 00:29:27.414943 140053067847680 replay_runner.py:36] Average training steps per second: 322.83
I0902 00:29:27.682205 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.37
INFO:tensorflow:Starting iteration 15

Steps executed: 250 Episode length: 250 Return: -28.15430301906535216
INFO:tensorflow:Average training steps per second: 332.56
I0902 00:29:34.027395 140053067847680 replay_runner.py:36] Average training steps per second: 332.56
I0902 00:29:34.251644 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -28.15
INFO:tensorflow:Starting iteration 16

Steps executed: 222 Episode length: 59 Return: -106.34953788142693216
INFO:tensorflow:Average training steps per second: 327.45
I0902 00:29:40.716840 140053067847680 replay_runner.py:36] Average training steps per second: 327.45
I0902 00:29:40.818231 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.94
INFO:tensorflow:Starting iteration 17

Steps executed: 234 Episode length: 106 Return: -880.6645105262397216
INFO:tensorflow:Average training steps per second: 327.32
I0902 00:29:47.244436 140053067847680 replay_runner.py:36] Average training steps per second: 327.32
I0902 00:29:47.391945 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -647.52
INFO:tensorflow:Starting iteration 18

Steps executed: 268 Episode length: 109 Return: -459.1478417489529416
INFO:tensorflow:Average training steps per second: 325.43
I0902 00:29:53.843019 140053067847680 replay_runner.py:36] Average training steps per second: 325.43
I0902 00:29:54.009901 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.81
INFO:tensorflow:Starting iteration 19
I0902 00:29:57.390152 140053067847680 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 318.47

Steps executed: 793 Episode length: 646 Return: 218.42052343827044516
I0902 00:30:01.468129 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: 91.64
INFO:tensorflow:Starting iteration 20

Steps executed: 293 Episode length: 98 Return: -116.34157684229395516
INFO:tensorflow:Average training steps per second: 320.78
I0902 00:30:07.924418 140053067847680 replay_runner.py:36] Average training steps per second: 320.78
I0902 00:30:08.094535 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.37
INFO:tensorflow:Starting iteration 21
I0902 00:30:11.395689 140053067847680 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 314.10
I0902 00:30:14.579684 140053067847680 replay_runner.py:36] Average training steps per second: 314.10

Steps executed: 351 Episode length: 351 Return: -63.96741877652980416
INFO:tensorflow:Starting iteration 22

Steps executed: 301 Episode length: 133 Return: -119.9491765097198516
INFO:tensorflow:Average training steps per second: 316.91
I0902 00:30:21.459797 140053067847680 replay_runner.py:36] Average training steps per second: 316.91
I0902 00:30:21.647284 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.79
INFO:tensorflow:Starting iteration 23

Steps executed: 346 Episode length: 160 Return: -348.2392800567326216
INFO:tensorflow:Average training steps per second: 325.18
I0902 00:30:28.059037 140053067847680 replay_runner.py:36] Average training steps per second: 325.18
I0902 00:30:28.279974 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.58
INFO:tensorflow:Starting iteration 24
I0902 00:30:31.550775 140053067847680 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 328.16

Steps executed: 1000 Episode length: 1000 Return: -400.92818733969085
I0902 00:30:36.427909 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.93
INFO:tensorflow:Starting iteration 25

Steps executed: 161 Episode length: 161 Return: -30.35814881879592585
INFO:tensorflow:Average training steps per second: 336.29

Steps executed: 828 Episode length: 667 Return: 189.76078728934164585
I0902 00:30:43.889396 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.70
INFO:tensorflow:Starting iteration 26

Steps executed: 245 Episode length: 71 Return: -52.833886687552799585
INFO:tensorflow:Average training steps per second: 350.33
I0902 00:30:50.071758 140053067847680 replay_runner.py:36] Average training steps per second: 350.33
I0902 00:30:50.235189 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -34.28
INFO:tensorflow:Starting iteration 27

Steps executed: 229 Episode length: 229 Return: -281.6453120244558585
INFO:tensorflow:Average training steps per second: 363.04
I0902 00:30:56.425602 140053067847680 replay_runner.py:36] Average training steps per second: 363.04
I0902 00:30:56.585466 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.65
INFO:tensorflow:Starting iteration 28
I0902 00:31:00.101079 140053067847680 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 368.09

Steps executed: 253 Episode length: 253 Return: -323.8736137111649585
I0902 00:31:03.006252 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.87
INFO:tensorflow:Starting iteration 29

Steps executed: 342 Episode length: 342 Return: -557.2583274292756585
INFO:tensorflow:Average training steps per second: 355.07
I0902 00:31:09.209858 140053067847680 replay_runner.py:36] Average training steps per second: 355.07

Done fixed training!Episode length: 342 Return: -557.2583274292756585