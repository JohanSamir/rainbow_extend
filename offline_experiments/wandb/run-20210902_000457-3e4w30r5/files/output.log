I0902 00:05:04.002068 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:05:04.013875 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:04.014168 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:04.014315 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:04.014477 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:04.014632 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:04.014797 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:04.014897 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:04.014990 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:04.015079 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:04.015146 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:04.015228 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:04.015323 139965167532032 dqn_agent.py:283] 	 seed: 1630541104013800
I0902 00:05:04.017792 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:04.018029 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:04.018165 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:04.018265 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:04.018396 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:04.018553 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:04.018677 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:04.018751 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:04.018832 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:04.052797 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:04.470937 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:04.515916 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:05:04.529430 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:04.530089 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:04.530303 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:04.530449 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:04.530632 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:04.530746 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:04.530847 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:04.530946 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:04.531044 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:04.531141 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:04.531238 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:04.531336 139965167532032 dqn_agent.py:283] 	 seed: 1630541104529357
I0902 00:05:04.533810 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:04.534002 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:04.534136 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:04.534351 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:04.534487 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:04.534588 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:04.534700 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:04.534830 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:04.534940 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:04.572541 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:04.592101 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:05:04.592296 139965167532032 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 168.06
I0902 00:05:10.542635 139965167532032 replay_runner.py:36] Average training steps per second: 168.06
Steps executed: 294 Episode length: 101 Return: -540.3292942935832
I0902 00:05:11.836234 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.24
INFO:tensorflow:Starting iteration 1

Steps executed: 256 Episode length: 81 Return: -409.27066226631655
INFO:tensorflow:Average training steps per second: 233.12
I0902 00:05:20.453436 139965167532032 replay_runner.py:36] Average training steps per second: 233.12
I0902 00:05:20.681758 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.21
INFO:tensorflow:Starting iteration 2
I0902 00:05:25.161024 139965167532032 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 224.05

Steps executed: 294 Episode length: 143 Return: -524.7884390627845
I0902 00:05:29.892280 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -575.58
INFO:tensorflow:Starting iteration 3

Steps executed: 212 Episode length: 117 Return: -453.3516102651445
INFO:tensorflow:Average training steps per second: 228.66
I0902 00:05:38.753496 139965167532032 replay_runner.py:36] Average training steps per second: 228.66
I0902 00:05:38.947159 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -503.41
INFO:tensorflow:Starting iteration 4

Steps executed: 236 Episode length: 121 Return: -194.73979581956657
INFO:tensorflow:Average training steps per second: 235.98
I0902 00:05:47.492825 139965167532032 replay_runner.py:36] Average training steps per second: 235.98
I0902 00:05:47.675788 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.73
INFO:tensorflow:Starting iteration 5
I0902 00:05:51.938536 139965167532032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 235.00

Steps executed: 974 Episode length: 974 Return: -326.68469295242297
I0902 00:05:59.263804 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.68
INFO:tensorflow:Starting iteration 6
I0902 00:06:03.562244 139965167532032 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 230.57

Steps executed: 270 Episode length: 270 Return: -216.52775176154103
I0902 00:06:08.235105 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.53
INFO:tensorflow:Starting iteration 7
I0902 00:06:12.550839 139965167532032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 226.68

Steps executed: 547 Episode length: 547 Return: -294.74980186217715
I0902 00:06:18.140863 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.75
INFO:tensorflow:Starting iteration 8
I0902 00:06:22.473070 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 221.97

Steps executed: 544 Episode length: 544 Return: -262.42856811061225
I0902 00:06:28.136846 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.43
INFO:tensorflow:Starting iteration 9
I0902 00:06:32.382016 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.15

Steps executed: 684 Episode length: 684 Return: -98.385669366021465
I0902 00:06:38.850023 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.39
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 153 Return: -107.02068626385064
INFO:tensorflow:Average training steps per second: 225.95
I0902 00:06:47.673604 139965167532032 replay_runner.py:36] Average training steps per second: 225.95
I0902 00:06:47.853996 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.80
INFO:tensorflow:Starting iteration 11

Steps executed: 313 Episode length: 162 Return: -166.37426354374617
INFO:tensorflow:Average training steps per second: 229.08
I0902 00:06:56.495765 139965167532032 replay_runner.py:36] Average training steps per second: 229.08
I0902 00:06:56.799166 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.73
INFO:tensorflow:Starting iteration 12
I0902 00:07:01.201101 139965167532032 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 224.87
I0902 00:07:05.648520 139965167532032 replay_runner.py:36] Average training steps per second: 224.87

Steps executed: 320 Episode length: 320 Return: -3.6524072691887717
INFO:tensorflow:Starting iteration 13
I0902 00:07:10.590240 139965167532032 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 222.77

Steps executed: 648 Episode length: 648 Return: -294.38717463631315
I0902 00:07:16.351895 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.39
INFO:tensorflow:Starting iteration 14

Steps executed: 302 Episode length: 144 Return: -159.93284056262104
INFO:tensorflow:Average training steps per second: 221.18
I0902 00:07:25.237893 139965167532032 replay_runner.py:36] Average training steps per second: 221.18
I0902 00:07:25.537822 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.02
INFO:tensorflow:Starting iteration 15
I0902 00:07:29.882194 139965167532032 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 225.87

Steps executed: 251 Episode length: 81 Return: -114.823118261571744
I0902 00:07:34.568683 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.30
INFO:tensorflow:Starting iteration 16

Steps executed: 207 Episode length: 98 Return: -310.245275358982555
INFO:tensorflow:Average training steps per second: 238.84
I0902 00:07:43.037187 139965167532032 replay_runner.py:36] Average training steps per second: 238.84
I0902 00:07:43.214006 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.30
INFO:tensorflow:Starting iteration 17
I0902 00:07:47.757309 139965167532032 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 240.04

Steps executed: 305 Episode length: 132 Return: -215.77860405853806
I0902 00:07:52.212016 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.97
INFO:tensorflow:Starting iteration 18

Steps executed: 314 Episode length: 314 Return: -227.79326948941957
INFO:tensorflow:Average training steps per second: 237.56
I0902 00:08:00.879241 139965167532032 replay_runner.py:36] Average training steps per second: 237.56
I0902 00:08:01.268399 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.79
INFO:tensorflow:Starting iteration 19

Steps executed: 223 Episode length: 223 Return: -518.04616105200997
INFO:tensorflow:Average training steps per second: 228.07
I0902 00:08:10.107123 139965167532032 replay_runner.py:36] Average training steps per second: 228.07
I0902 00:08:10.333755 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -518.05
INFO:tensorflow:Starting iteration 20

Steps executed: 272 Episode length: 138 Return: -141.79482053602342
INFO:tensorflow:Average training steps per second: 229.21
I0902 00:08:19.040934 139965167532032 replay_runner.py:36] Average training steps per second: 229.21
I0902 00:08:19.282289 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.87
INFO:tensorflow:Starting iteration 21
I0902 00:08:23.590702 139965167532032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 227.64

Steps executed: 363 Episode length: 213 Return: -152.00525353311272
I0902 00:08:28.333017 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.05
INFO:tensorflow:Starting iteration 22

Steps executed: 202 Episode length: 116 Return: -146.71874805753833
INFO:tensorflow:Average training steps per second: 225.55
I0902 00:08:37.259922 139965167532032 replay_runner.py:36] Average training steps per second: 225.55
I0902 00:08:37.408366 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.83
INFO:tensorflow:Starting iteration 23
I0902 00:08:41.720847 139965167532032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 227.90

Steps executed: 228 Episode length: 112 Return: -106.00995497806805
I0902 00:08:46.304127 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.72
INFO:tensorflow:Starting iteration 24

Steps executed: 266 Episode length: 69 Return: -45.7388980577712436
INFO:tensorflow:Average training steps per second: 223.86
I0902 00:08:55.037506 139965167532032 replay_runner.py:36] Average training steps per second: 223.86
I0902 00:08:55.249844 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.08
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 226 Return: -33.160402401727026
INFO:tensorflow:Average training steps per second: 235.58
I0902 00:09:03.752494 139965167532032 replay_runner.py:36] Average training steps per second: 235.58
I0902 00:09:03.993284 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.16
INFO:tensorflow:Starting iteration 26

Steps executed: 249 Episode length: 249 Return: -382.47246688348276
INFO:tensorflow:Average training steps per second: 231.17
I0902 00:09:12.673680 139965167532032 replay_runner.py:36] Average training steps per second: 231.17
I0902 00:09:12.986934 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.47
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 218 Return: -98.276532850876226
INFO:tensorflow:Average training steps per second: 224.71
I0902 00:09:21.784645 139965167532032 replay_runner.py:36] Average training steps per second: 224.71
I0902 00:09:22.058842 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.28
INFO:tensorflow:Starting iteration 28

Steps executed: 232 Episode length: 117 Return: -243.40091146463283
INFO:tensorflow:Average training steps per second: 225.36
I0902 00:09:30.892874 139965167532032 replay_runner.py:36] Average training steps per second: 225.36
I0902 00:09:31.120431 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.56
INFO:tensorflow:Starting iteration 29

Steps executed: 242 Episode length: 129 Return: -178.65818546687478
INFO:tensorflow:Average training steps per second: 224.74
I0902 00:09:39.993048 139965167532032 replay_runner.py:36] Average training steps per second: 224.74

Done fixed training!Episode length: 129 Return: -178.65818546687478