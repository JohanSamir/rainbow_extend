I0828 10:18:37.107786 139845548115968 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:37.108611 139845548115968 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:37.167764 139845548115968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:37.168817 139845548115968 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:37.168882 139845548115968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:37.168947 139845548115968 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:37.169007 139845548115968 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:37.169064 139845548115968 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:37.169118 139845548115968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:37.169174 139845548115968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:37.169271 139845548115968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:37.169381 139845548115968 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:37.169492 139845548115968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:37.169593 139845548115968 dqn_agent.py:283] 	 seed: 1630145917167713
I0828 10:18:37.171960 139845548115968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:37.172096 139845548115968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:37.172176 139845548115968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:37.172243 139845548115968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:37.172303 139845548115968 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:37.172395 139845548115968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:37.172458 139845548115968 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:37.172512 139845548115968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:37.172565 139845548115968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.571074 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0828 10:18:38.952598 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.960306 139845548115968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.964289 139845548115968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.964432 139845548115968 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.964512 139845548115968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.964573 139845548115968 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.964630 139845548115968 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.964707 139845548115968 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:38.964820 139845548115968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.964884 139845548115968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.964961 139845548115968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.965026 139845548115968 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.965103 139845548115968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.965176 139845548115968 dqn_agent.py:283] 	 seed: 1630145918964259
I0828 10:18:38.966602 139845548115968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.966708 139845548115968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:38.966778 139845548115968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.966855 139845548115968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.966917 139845548115968 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.966976 139845548115968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.967063 139845548115968 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.967144 139845548115968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.967198 139845548115968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.987587 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.999136 139845548115968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.999348 139845548115968 replay_runner.py:41] Starting iteration 0
Steps executed: 218 Episode length: 21 Return: 21.0
INFO:tensorflow:Average training steps per second: 152.13
I0828 10:18:45.573376 139845548115968 replay_runner.py:36] Average training steps per second: 152.13
I0828 10:18:46.293562 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.82
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 191.87
I0828 10:18:51.675363 139845548115968 replay_runner.py:36] Average training steps per second: 191.87
I0828 10:18:51.812457 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.68
INFO:tensorflow:Starting iteration 2

Steps executed: 211 Episode length: 19 Return: 19.0
INFO:tensorflow:Average training steps per second: 191.48
I0828 10:18:57.230709 139845548115968 replay_runner.py:36] Average training steps per second: 191.48
I0828 10:18:57.362718 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.58
INFO:tensorflow:Starting iteration 3
I0828 10:18:57.549170 139845548115968 replay_runner.py:41] Starting iteration 3

Steps executed: 242 Episode length: 78 Return: 78.0
I0828 10:19:02.868947 139845548115968 replay_runner.py:36] Average training steps per second: 187.99
I0828 10:19:03.040807 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 80.67
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 23 Return: 23.0
INFO:tensorflow:Average training steps per second: 198.03
I0828 10:19:08.294778 139845548115968 replay_runner.py:36] Average training steps per second: 198.03
I0828 10:19:08.444907 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.25
INFO:tensorflow:Starting iteration 5

Steps executed: 211 Episode length: 43 Return: 43.0
INFO:tensorflow:Average training steps per second: 183.61
I0828 10:19:14.095391 139845548115968 replay_runner.py:36] Average training steps per second: 183.61
I0828 10:19:14.224984 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 42.20
INFO:tensorflow:Starting iteration 6

Steps executed: 210 Episode length: 20 Return: 20.0
INFO:tensorflow:Average training steps per second: 196.29
I0828 10:19:19.507721 139845548115968 replay_runner.py:36] Average training steps per second: 196.29
I0828 10:19:19.664324 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.09
INFO:tensorflow:Starting iteration 7
I0828 10:19:19.868645 139845548115968 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 193.95

Steps executed: 289 Episode length: 98 Return: 98.0
I0828 10:19:25.215274 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 96.33
INFO:tensorflow:Starting iteration 8

Steps executed: 236 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 188.98
I0828 10:19:30.695747 139845548115968 replay_runner.py:36] Average training steps per second: 188.98
I0828 10:19:30.858792 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.83
I0828 10:19:35.844082 139845548115968 replay_runner.py:36] Average training steps per second: 208.83
I0828 10:19:35.992236 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 241 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 189.89
I0828 10:19:41.466082 139845548115968 replay_runner.py:36] Average training steps per second: 189.89
I0828 10:19:41.611785 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.50
INFO:tensorflow:Starting iteration 11

Steps executed: 279 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 198.26
I0828 10:19:46.839332 139845548115968 replay_runner.py:36] Average training steps per second: 198.26
I0828 10:19:47.042434 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 12

Steps executed: 204 Episode length: 26 Return: 26.0.0
INFO:tensorflow:Average training steps per second: 197.79
I0828 10:19:52.305805 139845548115968 replay_runner.py:36] Average training steps per second: 197.79
I0828 10:19:52.438239 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.27
I0828 10:19:57.877200 139845548115968 replay_runner.py:36] Average training steps per second: 190.27
I0828 10:19:58.015168 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0828 10:19:58.209368 139845548115968 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 205.54
I0828 10:20:03.075037 139845548115968 replay_runner.py:36] Average training steps per second: 205.54
I0828 10:20:03.237445 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0828 10:20:03.436274 139845548115968 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 190.79
I0828 10:20:08.678174 139845548115968 replay_runner.py:36] Average training steps per second: 190.79
I0828 10:20:08.809698 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 323 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 193.15
I0828 10:20:14.158334 139845548115968 replay_runner.py:36] Average training steps per second: 193.15
I0828 10:20:14.390335 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 17

Steps executed: 297 Episode length: 102 Return: 102.0
INFO:tensorflow:Average training steps per second: 199.61
I0828 10:20:19.607943 139845548115968 replay_runner.py:36] Average training steps per second: 199.61
I0828 10:20:19.793440 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 99.00
INFO:tensorflow:Starting iteration 18

Steps executed: 255 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 186.41
I0828 10:20:25.344077 139845548115968 replay_runner.py:36] Average training steps per second: 186.41
I0828 10:20:25.516313 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 19

Steps executed: 256 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 205.19
I0828 10:20:30.590691 139845548115968 replay_runner.py:36] Average training steps per second: 205.19
I0828 10:20:30.776948 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 20

Steps executed: 214 Episode length: 109 Return: 109.0
INFO:tensorflow:Average training steps per second: 194.13
I0828 10:20:36.138310 139845548115968 replay_runner.py:36] Average training steps per second: 194.13
I0828 10:20:36.273644 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.00
INFO:tensorflow:Starting iteration 21

Steps executed: 208 Episode length: 17 Return: 17.0.0
INFO:tensorflow:Average training steps per second: 195.07
I0828 10:20:41.592051 139845548115968 replay_runner.py:36] Average training steps per second: 195.07
I0828 10:20:41.735192 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.80
INFO:tensorflow:Starting iteration 22

Steps executed: 258 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 200.70
I0828 10:20:46.923975 139845548115968 replay_runner.py:36] Average training steps per second: 200.70
I0828 10:20:47.086483 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.00
INFO:tensorflow:Starting iteration 23

Steps executed: 251 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 188.97
I0828 10:20:52.560565 139845548115968 replay_runner.py:36] Average training steps per second: 188.97
I0828 10:20:52.728328 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 24

Steps executed: 270 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 202.85
I0828 10:20:57.856602 139845548115968 replay_runner.py:36] Average training steps per second: 202.85
I0828 10:20:58.040629 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 25
I0828 10:20:58.235388 139845548115968 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.81
I0828 10:21:03.395530 139845548115968 replay_runner.py:36] Average training steps per second: 193.81

Steps executed: 211 Episode length: 15 Return: 15.0.0
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 108 Return: 108.0
INFO:tensorflow:Average training steps per second: 193.21
I0828 10:21:08.883451 139845548115968 replay_runner.py:36] Average training steps per second: 193.21
I0828 10:21:09.034188 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.50
INFO:tensorflow:Starting iteration 27

Steps executed: 302 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 198.03
I0828 10:21:14.284907 139845548115968 replay_runner.py:36] Average training steps per second: 198.03
I0828 10:21:14.485110 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.33
INFO:tensorflow:Starting iteration 28

Steps executed: 209 Episode length: 17 Return: 17.0.0
INFO:tensorflow:Average training steps per second: 187.58
I0828 10:21:20.011864 139845548115968 replay_runner.py:36] Average training steps per second: 187.58
I0828 10:21:20.153520 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.93
INFO:tensorflow:Starting iteration 29

Steps executed: 283 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 207.98
I0828 10:21:25.153357 139845548115968 replay_runner.py:36] Average training steps per second: 207.98

Done fixed training!Episode length: 138 Return: 138.0