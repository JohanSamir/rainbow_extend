Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0905 18:52:29.470854 139630031558656 run_experiment.py:549] Creating TrainRunner ...
I0905 18:52:29.479202 139630031558656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:29.479398 139630031558656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:29.479482 139630031558656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:29.479553 139630031558656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:29.479615 139630031558656 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:29.479682 139630031558656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:29.479739 139630031558656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:29.479801 139630031558656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:29.479882 139630031558656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:29.479980 139630031558656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:29.480051 139630031558656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:29.480142 139630031558656 dqn_agent.py:283] 	 seed: 1630867949479152
I0905 18:52:29.482627 139630031558656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:29.482832 139630031558656 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:52:29.482986 139630031558656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:29.483159 139630031558656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:29.483296 139630031558656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:29.483425 139630031558656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:29.483640 139630031558656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:29.483728 139630031558656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:29.483803 139630031558656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:29.522768 139630031558656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:30.068165 139630031558656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:30.079684 139630031558656 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:52:30.089743 139630031558656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:30.090005 139630031558656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:30.090105 139630031558656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:30.090190 139630031558656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:30.090251 139630031558656 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:30.090353 139630031558656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:30.090416 139630031558656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:30.090556 139630031558656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:30.090628 139630031558656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:30.090687 139630031558656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:30.090764 139630031558656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:30.090845 139630031558656 dqn_agent.py:283] 	 seed: 1630867950089696
I0905 18:52:30.093161 139630031558656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:30.093301 139630031558656 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:52:30.093392 139630031558656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:30.093464 139630031558656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:30.093528 139630031558656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:30.093615 139630031558656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:30.093686 139630031558656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:30.093808 139630031558656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:30.093885 139630031558656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:30.129266 139630031558656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:30.153497 139630031558656 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:52:30.153779 139630031558656 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.82
I0905 18:52:37.107813 139630031558656 replay_runner.py:36] Average training steps per second: 143.82
I0905 18:52:38.418401 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1
I0905 18:52:38.625139 139630031558656 replay_runner.py:41] Starting iteration 1
Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 176.65
I0905 18:52:44.286470 139630031558656 replay_runner.py:36] Average training steps per second: 176.65
I0905 18:52:44.515086 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 2

Steps executed: 261 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 177.68
I0905 18:52:50.348479 139630031558656 replay_runner.py:36] Average training steps per second: 177.68
I0905 18:52:50.541946 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 175.04
I0905 18:52:56.474674 139630031558656 replay_runner.py:36] Average training steps per second: 175.04
I0905 18:52:56.662153 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0905 18:52:56.885194 139630031558656 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 170.07
I0905 18:53:02.766206 139630031558656 replay_runner.py:36] Average training steps per second: 170.07
I0905 18:53:02.973652 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.00
INFO:tensorflow:Starting iteration 5

Steps executed: 232 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 177.17
I0905 18:53:08.814417 139630031558656 replay_runner.py:36] Average training steps per second: 177.17
I0905 18:53:09.098227 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 6

Steps executed: 324 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 196.65
I0905 18:53:14.373065 139630031558656 replay_runner.py:36] Average training steps per second: 196.65
I0905 18:53:14.666188 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.50
INFO:tensorflow:Starting iteration 7

Steps executed: 319 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 176.51
I0905 18:53:20.552013 139630031558656 replay_runner.py:36] Average training steps per second: 176.51
I0905 18:53:20.812237 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 8

Steps executed: 296 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 174.23
I0905 18:53:26.776423 139630031558656 replay_runner.py:36] Average training steps per second: 174.23
I0905 18:53:27.014885 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 9


Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 173.09
I0905 18:53:33.009392 139630031558656 replay_runner.py:36] Average training steps per second: 173.09
I0905 18:53:33.350490 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 10

Steps executed: 116 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 173.49

Steps executed: 233 Episode length: 117 Return: 117.0
I0905 18:53:39.542152 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.50
INFO:tensorflow:Starting iteration 11

Steps executed: 217 Episode length: 111 Return: 111.0
INFO:tensorflow:Average training steps per second: 172.78
I0905 18:53:45.553131 139630031558656 replay_runner.py:36] Average training steps per second: 172.78
I0905 18:53:45.737738 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.50
INFO:tensorflow:Starting iteration 12

Steps executed: 265 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 173.22
I0905 18:53:51.721259 139630031558656 replay_runner.py:36] Average training steps per second: 173.22
I0905 18:53:51.961895 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 13

Steps executed: 293 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 172.37
I0905 18:53:57.982160 139630031558656 replay_runner.py:36] Average training steps per second: 172.37
I0905 18:53:58.251274 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 169.04
I0905 18:54:04.384774 139630031558656 replay_runner.py:36] Average training steps per second: 169.04
I0905 18:54:04.559760 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0905 18:54:04.777340 139630031558656 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 174.85
I0905 18:54:10.497197 139630031558656 replay_runner.py:36] Average training steps per second: 174.85
I0905 18:54:10.674049 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0905 18:54:10.890156 139630031558656 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 174.71
I0905 18:54:16.614422 139630031558656 replay_runner.py:36] Average training steps per second: 174.71
I0905 18:54:16.799444 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0905 18:54:16.997039 139630031558656 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 174.24
I0905 18:54:22.736989 139630031558656 replay_runner.py:36] Average training steps per second: 174.24
I0905 18:54:22.934839 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 325 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 173.14
I0905 18:54:28.903248 139630031558656 replay_runner.py:36] Average training steps per second: 173.14
I0905 18:54:29.192642 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 19

Steps executed: 326 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 170.71
I0905 18:54:35.277984 139630031558656 replay_runner.py:36] Average training steps per second: 170.71
I0905 18:54:35.558585 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 20

Steps executed: 163 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 174.22

Steps executed: 332 Episode length: 169 Return: 169.0
I0905 18:54:41.797850 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 170.50
I0905 18:54:47.883415 139630031558656 replay_runner.py:36] Average training steps per second: 170.50
I0905 18:54:48.064455 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 18:54:48.289658 139630031558656 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 173.14
I0905 18:54:54.066097 139630031558656 replay_runner.py:36] Average training steps per second: 173.14
I0905 18:54:54.244781 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0905 18:54:54.459423 139630031558656 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 172.90
I0905 18:55:00.243611 139630031558656 replay_runner.py:36] Average training steps per second: 172.90
I0905 18:55:00.417914 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 252 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 171.95
I0905 18:55:06.444784 139630031558656 replay_runner.py:36] Average training steps per second: 171.95
I0905 18:55:06.674450 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.00
INFO:tensorflow:Starting iteration 25

Steps executed: 283 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 175.22
I0905 18:55:12.602063 139630031558656 replay_runner.py:36] Average training steps per second: 175.22
I0905 18:55:12.855843 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 26

Steps executed: 284 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 172.44
I0905 18:55:18.852334 139630031558656 replay_runner.py:36] Average training steps per second: 172.44
I0905 18:55:19.125908 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 27

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 174.75
I0905 18:55:25.042580 139630031558656 replay_runner.py:36] Average training steps per second: 174.75
I0905 18:55:25.398035 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 28
I0905 18:55:25.596851 139630031558656 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 170.44

Steps executed: 261 Episode length: 131 Return: 131.0
I0905 18:55:31.695404 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 29
I0905 18:55:31.913996 139630031558656 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 180.56

Done fixed training!Episode length: 163 Return: 163.0
I0905 18:55:37.740002 139630031558656 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50