Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 00:10:24.373545 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:10:24.385997 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:24.386347 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:24.386627 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:24.386908 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:24.387060 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:24.387193 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:24.387347 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:24.387456 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:24.387560 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:24.387676 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:24.387790 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:24.387904 139644712736768 dqn_agent.py:283] 	 seed: 1630541424385931
I0902 00:10:24.391297 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:24.391498 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:24.391597 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:24.391674 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:24.391764 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:24.391844 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:24.391910 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:24.391972 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:24.392076 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:24.435653 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:24.845968 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:24.881876 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:10:24.893041 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:24.893331 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:24.893447 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:24.893606 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:24.893730 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:24.893808 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:24.894071 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:24.894253 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:24.894353 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:24.894432 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:24.894551 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:24.894672 139644712736768 dqn_agent.py:283] 	 seed: 1630541424892967
I0902 00:10:24.897745 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:24.897960 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:24.898156 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:24.898316 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:24.898588 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:24.898738 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:24.898889 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:24.898985 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:24.899101 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:24.932908 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:24.957865 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:10:24.958242 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 162.93
I0902 00:10:31.096100 139644712736768 replay_runner.py:36] Average training steps per second: 162.93
Steps executed: 201 Episode length: 112 Return: -373.6039446169675
I0902 00:10:32.679973 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.89
INFO:tensorflow:Starting iteration 1

Steps executed: 284 Episode length: 156 Return: -285.45621263987047
INFO:tensorflow:Average training steps per second: 233.88
I0902 00:10:41.279696 139644712736768 replay_runner.py:36] Average training steps per second: 233.88
I0902 00:10:41.537318 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.01
INFO:tensorflow:Starting iteration 2

Steps executed: 261 Episode length: 128 Return: -183.47607484205797
INFO:tensorflow:Average training steps per second: 228.85
I0902 00:10:50.247520 139644712736768 replay_runner.py:36] Average training steps per second: 228.85
I0902 00:10:50.489924 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.72
INFO:tensorflow:Starting iteration 3

Steps executed: 209 Episode length: 124 Return: -427.64060010225035
INFO:tensorflow:Average training steps per second: 228.53
I0902 00:10:59.210968 139644712736768 replay_runner.py:36] Average training steps per second: 228.53
I0902 00:10:59.405180 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.06
INFO:tensorflow:Starting iteration 4
I0902 00:11:03.784693 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 223.43

Steps executed: 833 Episode length: 833 Return: -478.27359194898975
I0902 00:11:10.823023 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.27
INFO:tensorflow:Starting iteration 5
I0902 00:11:15.224592 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.11

Steps executed: 676 Episode length: 676 Return: -359.82996907039435
I0902 00:11:20.843991 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.83
INFO:tensorflow:Starting iteration 6
I0902 00:11:25.143552 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.32

Steps executed: 719 Episode length: 719 Return: -292.94746017509397
I0902 00:11:31.450674 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.95
INFO:tensorflow:Starting iteration 7
I0902 00:11:35.832636 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 224.63

Steps executed: 1000 Episode length: 1000 Return: -294.678162083642
I0902 00:11:42.072254 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.68
INFO:tensorflow:Starting iteration 8
I0902 00:11:46.468908 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 222.50

Steps executed: 860 Episode length: 860 Return: -467.20641748886132
I0902 00:11:52.668212 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -467.21
INFO:tensorflow:Starting iteration 9
I0902 00:11:57.029102 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 234.13

Steps executed: 953 Episode length: 953 Return: -661.66703748281932
I0902 00:12:04.035140 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -661.67
INFO:tensorflow:Starting iteration 10
I0902 00:12:08.350080 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 234.95

Steps executed: 912 Episode length: 912 Return: -503.16461797599542
I0902 00:12:16.068209 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -503.16
INFO:tensorflow:Starting iteration 11
I0902 00:12:20.303243 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 226.13
I0902 00:12:24.725772 139644712736768 replay_runner.py:36] Average training steps per second: 226.13

Steps executed: 1000 Episode length: 1000 Return: 145.4876778435501
INFO:tensorflow:Starting iteration 12

Steps executed: 276 Episode length: 276 Return: 7.84981774582647101
INFO:tensorflow:Average training steps per second: 219.45
I0902 00:12:35.355758 139644712736768 replay_runner.py:36] Average training steps per second: 219.45
I0902 00:12:35.669585 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 7.85
INFO:tensorflow:Starting iteration 13
I0902 00:12:39.879503 139644712736768 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 217.49
I0902 00:12:44.477809 139644712736768 replay_runner.py:36] Average training steps per second: 217.49

Steps executed: 1000 Episode length: 1000 Return: -269.9633642416913
INFO:tensorflow:Starting iteration 14
I0902 00:12:53.011353 139644712736768 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 222.05

Steps executed: 522 Episode length: 522 Return: -348.625963549530313
I0902 00:12:58.451387 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.63
INFO:tensorflow:Starting iteration 15

Steps executed: 320 Episode length: 320 Return: -245.559286437849863
INFO:tensorflow:Average training steps per second: 220.72
I0902 00:13:07.414814 139644712736768 replay_runner.py:36] Average training steps per second: 220.72
I0902 00:13:07.892830 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.56
INFO:tensorflow:Starting iteration 16

Steps executed: 309 Episode length: 309 Return: -347.154866287734653
INFO:tensorflow:Average training steps per second: 222.61
I0902 00:13:16.694006 139644712736768 replay_runner.py:36] Average training steps per second: 222.61
I0902 00:13:17.109887 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.15
INFO:tensorflow:Starting iteration 17

Steps executed: 148 Episode length: 148 Return: -204.846254760448353
INFO:tensorflow:Average training steps per second: 220.85

Steps executed: 897 Episode length: 749 Return: -299.708852007763453
I0902 00:13:28.020687 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.28
INFO:tensorflow:Starting iteration 18

Steps executed: 286 Episode length: 135 Return: -506.234777651145353
INFO:tensorflow:Average training steps per second: 218.35
I0902 00:13:36.854062 139644712736768 replay_runner.py:36] Average training steps per second: 218.35
I0902 00:13:37.167455 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.45
INFO:tensorflow:Starting iteration 19

Steps executed: 216 Episode length: 57 Return: -165.5743590099143353
INFO:tensorflow:Average training steps per second: 221.16
I0902 00:13:46.043322 139644712736768 replay_runner.py:36] Average training steps per second: 221.16
I0902 00:13:46.249801 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.79
INFO:tensorflow:Starting iteration 20

Steps executed: 249 Episode length: 55 Return: -197.0065154396506853
INFO:tensorflow:Average training steps per second: 216.93
I0902 00:13:55.144707 139644712736768 replay_runner.py:36] Average training steps per second: 216.93
I0902 00:13:55.357350 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.51
INFO:tensorflow:Starting iteration 21

Steps executed: 227 Episode length: 109 Return: -342.047923285731143
INFO:tensorflow:Average training steps per second: 224.20
I0902 00:14:04.226145 139644712736768 replay_runner.py:36] Average training steps per second: 224.20
I0902 00:14:04.427232 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.93
INFO:tensorflow:Starting iteration 22

Steps executed: 242 Episode length: 55 Return: -183.1953364352066253
INFO:tensorflow:Average training steps per second: 229.93
I0902 00:14:13.128742 139644712736768 replay_runner.py:36] Average training steps per second: 229.93
I0902 00:14:13.357863 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.34
INFO:tensorflow:Starting iteration 23

Steps executed: 253 Episode length: 107 Return: -318.197895973740153
INFO:tensorflow:Average training steps per second: 222.88
I0902 00:14:22.257039 139644712736768 replay_runner.py:36] Average training steps per second: 222.88
I0902 00:14:22.499587 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.71
INFO:tensorflow:Starting iteration 24

Steps executed: 223 Episode length: 155 Return: -577.550758673647453
INFO:tensorflow:Average training steps per second: 221.26
I0902 00:14:31.304324 139644712736768 replay_runner.py:36] Average training steps per second: 221.26
I0902 00:14:31.502833 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.42
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 62 Return: -440.4246375631204453
INFO:tensorflow:Average training steps per second: 231.16
I0902 00:14:39.928448 139644712736768 replay_runner.py:36] Average training steps per second: 231.16
I0902 00:14:40.104916 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.74
INFO:tensorflow:Starting iteration 26
I0902 00:14:44.384908 139644712736768 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 228.53

Steps executed: 233 Episode length: 89 Return: -137.6869423307710253
I0902 00:14:48.956071 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.82
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 87 Return: -250.9781604541175453
INFO:tensorflow:Average training steps per second: 243.31
I0902 00:14:57.366093 139644712736768 replay_runner.py:36] Average training steps per second: 243.31
I0902 00:14:57.555557 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.69
INFO:tensorflow:Starting iteration 28

Steps executed: 204 Episode length: 64 Return: -134.1093805575720853
INFO:tensorflow:Average training steps per second: 241.22
I0902 00:15:05.912256 139644712736768 replay_runner.py:36] Average training steps per second: 241.22
I0902 00:15:06.098056 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.84
INFO:tensorflow:Starting iteration 29

Steps executed: 170 Episode length: 90 Return: -459.4957831960615853
INFO:tensorflow:Average training steps per second: 236.56
I0902 00:15:14.524821 139644712736768 replay_runner.py:36] Average training steps per second: 236.56


Done fixed training!Episode length: 96 Return: -328.4151332720111853