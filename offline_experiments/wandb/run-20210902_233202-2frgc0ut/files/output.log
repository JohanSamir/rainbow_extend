Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0902 23:32:08.942976 140720164866048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:32:08.954315 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:32:08.954642 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:32:08.954840 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:32:08.955310 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:32:08.955507 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:32:08.955693 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:32:08.955843 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:32:08.956019 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:32:08.956262 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:32:08.956457 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:32:08.956748 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:32:08.956931 140720164866048 dqn_agent.py:283] 	 seed: 1630625528954240
I0902 23:32:08.959691 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:32:08.959847 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:32:08.959959 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:32:08.960042 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:32:08.960126 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:32:08.960209 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:32:08.960293 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:32:08.960391 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:32:08.960474 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:32:09.002373 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:32:09.501565 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:32:09.516530 140720164866048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:32:09.529395 140720164866048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:32:09.529658 140720164866048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:32:09.529798 140720164866048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:32:09.529914 140720164866048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:32:09.530128 140720164866048 dqn_agent.py:275] 	 update_period: 4
I0902 23:32:09.530285 140720164866048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:32:09.530399 140720164866048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:32:09.530526 140720164866048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:32:09.530654 140720164866048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:32:09.530762 140720164866048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:32:09.530939 140720164866048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:32:09.531082 140720164866048 dqn_agent.py:283] 	 seed: 1630625529529339
I0902 23:32:09.533985 140720164866048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:32:09.534201 140720164866048 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:32:09.534362 140720164866048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:32:09.534497 140720164866048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:32:09.534692 140720164866048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:32:09.534820 140720164866048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:32:09.534963 140720164866048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:32:09.535081 140720164866048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:32:09.535184 140720164866048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:32:09.570941 140720164866048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:32:09.595132 140720164866048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:32:09.595500 140720164866048 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 138.14
I0902 23:32:16.835825 140720164866048 replay_runner.py:36] Average training steps per second: 138.14
I0902 23:32:18.383886 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:32:18.630432 140720164866048 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 184.70
I0902 23:32:24.044971 140720164866048 replay_runner.py:36] Average training steps per second: 184.70

Steps executed: 466 Episode length: 466 Return: -465.0
INFO:tensorflow:Starting iteration 2
I0902 23:32:24.699887 140720164866048 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 191.45
I0902 23:32:29.923720 140720164866048 replay_runner.py:36] Average training steps per second: 191.45
I0902 23:32:30.199039 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.50
INFO:tensorflow:Starting iteration 3

Steps executed: 317 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 188.55
I0902 23:32:35.745151 140720164866048 replay_runner.py:36] Average training steps per second: 188.55
I0902 23:32:35.978713 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.00
INFO:tensorflow:Starting iteration 4


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.05
I0902 23:32:41.269734 140720164866048 replay_runner.py:36] Average training steps per second: 198.05
I0902 23:32:41.707139 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:32:41.951104 140720164866048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 188.10
I0902 23:32:47.267900 140720164866048 replay_runner.py:36] Average training steps per second: 188.10
I0902 23:32:47.435580 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 6

Steps executed: 202 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 192.07
I0902 23:32:52.888626 140720164866048 replay_runner.py:36] Average training steps per second: 192.07
I0902 23:32:53.168299 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.00
INFO:tensorflow:Starting iteration 7


Steps executed: 83 Episode length: 83 Return: -82.05.0
INFO:tensorflow:Average training steps per second: 188.35
I0902 23:32:58.724139 140720164866048 replay_runner.py:36] Average training steps per second: 188.35
I0902 23:32:58.929399 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 8


Steps executed: 242 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 191.41
I0902 23:33:04.443960 140720164866048 replay_runner.py:36] Average training steps per second: 191.41
I0902 23:33:04.653191 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 9
I0902 23:33:04.901017 140720164866048 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 190.35
I0902 23:33:10.155031 140720164866048 replay_runner.py:36] Average training steps per second: 190.35
I0902 23:33:10.433528 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.00
INFO:tensorflow:Starting iteration 10

Steps executed: 316 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 189.35
I0902 23:33:15.962626 140720164866048 replay_runner.py:36] Average training steps per second: 189.35
I0902 23:33:16.366892 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11


Steps executed: 308 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 188.19
I0902 23:33:21.921178 140720164866048 replay_runner.py:36] Average training steps per second: 188.19
I0902 23:33:22.187793 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 12

Steps executed: 272 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 190.69
I0902 23:33:27.675306 140720164866048 replay_runner.py:36] Average training steps per second: 190.69
I0902 23:33:27.917042 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 13

Steps executed: 204 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 187.59
I0902 23:33:33.596350 140720164866048 replay_runner.py:36] Average training steps per second: 187.59
I0902 23:33:33.771364 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 14

Steps executed: 244 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 187.85
I0902 23:33:39.345133 140720164866048 replay_runner.py:36] Average training steps per second: 187.85
I0902 23:33:39.563110 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 15
I0902 23:33:39.816637 140720164866048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 196.72
I0902 23:33:44.900472 140720164866048 replay_runner.py:36] Average training steps per second: 196.72
I0902 23:33:45.093469 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 16


Steps executed: 210 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 189.32
I0902 23:33:50.609971 140720164866048 replay_runner.py:36] Average training steps per second: 189.32
I0902 23:33:50.794296 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 17

Steps executed: 303 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.50
I0902 23:33:56.014718 140720164866048 replay_runner.py:36] Average training steps per second: 200.50
I0902 23:33:56.264989 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 18

Steps executed: 256 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 189.73
I0902 23:34:01.778620 140720164866048 replay_runner.py:36] Average training steps per second: 189.73
I0902 23:34:01.966931 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 19

Steps executed: 259 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 192.49
I0902 23:34:07.390523 140720164866048 replay_runner.py:36] Average training steps per second: 192.49
I0902 23:34:07.602685 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 20

Steps executed: 123 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 191.69

Steps executed: 254 Episode length: 131 Return: -130.0
I0902 23:34:13.274034 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.49
I0902 23:34:18.796281 140720164866048 replay_runner.py:36] Average training steps per second: 189.49
I0902 23:34:19.216214 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 218 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 199.18
I0902 23:34:24.474408 140720164866048 replay_runner.py:36] Average training steps per second: 199.18
I0902 23:34:24.658456 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 23

Steps executed: 245 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 193.88
I0902 23:34:30.050185 140720164866048 replay_runner.py:36] Average training steps per second: 193.88
I0902 23:34:30.277551 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 198.08
I0902 23:34:35.577198 140720164866048 replay_runner.py:36] Average training steps per second: 198.08
I0902 23:34:35.732976 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.05
I0902 23:34:41.067331 140720164866048 replay_runner.py:36] Average training steps per second: 196.05
I0902 23:34:41.458011 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 223 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 193.21
I0902 23:34:46.923788 140720164866048 replay_runner.py:36] Average training steps per second: 193.21
I0902 23:34:47.111451 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 186.94
I0902 23:34:52.722031 140720164866048 replay_runner.py:36] Average training steps per second: 186.94
I0902 23:34:52.919350 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 28

Steps executed: 257 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 192.12
I0902 23:34:58.376398 140720164866048 replay_runner.py:36] Average training steps per second: 192.12
I0902 23:34:58.602459 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.28
I0902 23:35:04.153645 140720164866048 replay_runner.py:36] Average training steps per second: 188.28
I0902 23:35:04.659021 140720164866048 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.50