Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 00:27:11.797374 140252174653440 run_experiment.py:549] Creating TrainRunner ...
I0902 00:27:11.805426 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:11.805561 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:11.805634 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:11.805693 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:11.805749 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:11.805813 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:11.805891 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:11.805993 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:11.806062 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:11.806150 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:11.806233 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:11.806293 140252174653440 dqn_agent.py:283] 	 seed: 1630542431805388
I0902 00:27:11.807984 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:11.808100 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:11.808175 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:11.808234 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:11.808285 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:11.808358 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:11.808409 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:11.808459 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:11.808535 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:11.834915 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:12.099380 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:12.110443 140252174653440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:27:12.117177 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:12.117408 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:12.117607 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:12.117738 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:12.117861 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:12.118034 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:12.118152 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:12.118284 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:12.118409 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:12.118491 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:12.118593 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:12.118667 140252174653440 dqn_agent.py:283] 	 seed: 1630542432117137
I0902 00:27:12.120800 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:12.120918 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:12.121007 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:12.121080 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:12.121144 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:12.121224 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:12.121286 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:12.121377 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:12.121450 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:12.142288 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:12.157435 140252174653440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:27:12.157600 140252174653440 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 119 Return: -383.19621111176286
INFO:tensorflow:Average training steps per second: 241.05
I0902 00:27:16.306339 140252174653440 replay_runner.py:36] Average training steps per second: 241.05
I0902 00:27:17.105984 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.98
INFO:tensorflow:Starting iteration 1

Steps executed: 126 Episode length: 126 Return: -330.61486936265556
INFO:tensorflow:Average training steps per second: 356.00
I0902 00:27:23.243744 140252174653440 replay_runner.py:36] Average training steps per second: 356.00

Steps executed: 266 Episode length: 140 Return: -156.81679636971054
INFO:tensorflow:Starting iteration 2

Steps executed: 250 Episode length: 124 Return: -59.429424969617544
INFO:tensorflow:Average training steps per second: 374.07
I0902 00:27:29.545868 140252174653440 replay_runner.py:36] Average training steps per second: 374.07
I0902 00:27:29.694183 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.46
INFO:tensorflow:Starting iteration 3

Steps executed: 253 Episode length: 109 Return: -163.52757756600226
INFO:tensorflow:Average training steps per second: 352.00
I0902 00:27:36.018042 140252174653440 replay_runner.py:36] Average training steps per second: 352.00
I0902 00:27:36.179316 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.04
INFO:tensorflow:Starting iteration 4

Steps executed: 341 Episode length: 341 Return: -241.44731140946596
INFO:tensorflow:Average training steps per second: 350.91
I0902 00:27:42.464323 140252174653440 replay_runner.py:36] Average training steps per second: 350.91
I0902 00:27:42.727728 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.45
INFO:tensorflow:Starting iteration 5
I0902 00:27:46.204688 140252174653440 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 348.14

Steps executed: 1000 Episode length: 1000 Return: 1.2626810812001104
I0902 00:27:50.619987 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: 1.26
INFO:tensorflow:Starting iteration 6
I0902 00:27:54.092572 140252174653440 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 349.98

Steps executed: 1000 Episode length: 1000 Return: -136.42460358318763
I0902 00:27:58.471358 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.42
INFO:tensorflow:Starting iteration 7
I0902 00:28:01.961312 140252174653440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 356.09

Steps executed: 1000 Episode length: 1000 Return: -58.265272426696676
I0902 00:28:06.709286 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.27
INFO:tensorflow:Starting iteration 8
I0902 00:28:10.168041 140252174653440 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 346.17

Steps executed: 1000 Episode length: 1000 Return: -116.61393142062397
I0902 00:28:15.387596 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.61
INFO:tensorflow:Starting iteration 9
I0902 00:28:18.703474 140252174653440 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 350.98

Steps executed: 1000 Episode length: 1000 Return: -420.63860513791997
I0902 00:28:23.275601 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.64
INFO:tensorflow:Starting iteration 10
I0902 00:28:26.559645 140252174653440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 359.29

Steps executed: 1000 Episode length: 1000 Return: -22.270154762338155
I0902 00:28:31.454355 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.27
INFO:tensorflow:Starting iteration 11
I0902 00:28:34.747670 140252174653440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 370.04

Steps executed: 1000 Episode length: 1000 Return: -143.07270458245015
I0902 00:28:39.289668 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.07
INFO:tensorflow:Starting iteration 12

Steps executed: 412 Episode length: 412 Return: -382.3387879369457015
INFO:tensorflow:Average training steps per second: 376.17
I0902 00:28:45.259582 140252174653440 replay_runner.py:36] Average training steps per second: 376.17
I0902 00:28:45.799658 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.34
INFO:tensorflow:Starting iteration 13
I0902 00:28:49.269945 140252174653440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 368.51

Steps executed: 225 Episode length: 225 Return: -262.7190632349607015
I0902 00:28:52.154954 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.72
INFO:tensorflow:Starting iteration 14
I0902 00:28:55.658153 140252174653440 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 351.19

Steps executed: 1000 Episode length: 1000 Return: -99.567998822458535
I0902 00:29:00.778705 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.57
INFO:tensorflow:Starting iteration 15

Steps executed: 297 Episode length: 175 Return: -397.7519059641715635
INFO:tensorflow:Average training steps per second: 357.90
I0902 00:29:07.039724 140252174653440 replay_runner.py:36] Average training steps per second: 357.90
I0902 00:29:07.234953 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.13
INFO:tensorflow:Starting iteration 16

Steps executed: 282 Episode length: 152 Return: -154.8632927119801435
INFO:tensorflow:Average training steps per second: 344.49
I0902 00:29:13.570327 140252174653440 replay_runner.py:36] Average training steps per second: 344.49
I0902 00:29:13.723482 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.55
INFO:tensorflow:Starting iteration 17
I0902 00:29:17.055449 140252174653440 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 329.51

Steps executed: 253 Episode length: 65 Return: -144.27073752839826435
I0902 00:29:20.234450 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.96
INFO:tensorflow:Starting iteration 18

Steps executed: 292 Episode length: 117 Return: -107.3439318450238535
INFO:tensorflow:Average training steps per second: 343.54
I0902 00:29:26.496982 140252174653440 replay_runner.py:36] Average training steps per second: 343.54
I0902 00:29:26.688953 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.82
INFO:tensorflow:Starting iteration 19

Steps executed: 235 Episode length: 69 Return: -168.12403835391296535
INFO:tensorflow:Average training steps per second: 345.29
I0902 00:29:32.980804 140252174653440 replay_runner.py:36] Average training steps per second: 345.29
I0902 00:29:33.112335 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.55
INFO:tensorflow:Starting iteration 20

Steps executed: 314 Episode length: 153 Return: -111.6904855434729635
INFO:tensorflow:Average training steps per second: 344.59
I0902 00:29:39.503432 140252174653440 replay_runner.py:36] Average training steps per second: 344.59
I0902 00:29:39.709112 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.19
INFO:tensorflow:Starting iteration 21

Steps executed: 331 Episode length: 146 Return: -90.46066168965282735
INFO:tensorflow:Average training steps per second: 346.42
I0902 00:29:46.051963 140252174653440 replay_runner.py:36] Average training steps per second: 346.42
I0902 00:29:46.276228 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.55
INFO:tensorflow:Starting iteration 22

Steps executed: 495 Episode length: 495 Return: -28.71034707939964735
INFO:tensorflow:Average training steps per second: 337.10
I0902 00:29:52.669989 140252174653440 replay_runner.py:36] Average training steps per second: 337.10
I0902 00:29:53.370324 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -28.71
INFO:tensorflow:Starting iteration 23
I0902 00:29:56.746555 140252174653440 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 322.50

Steps executed: 263 Episode length: 263 Return: -57.82696882995019735
I0902 00:30:00.060463 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.83
INFO:tensorflow:Starting iteration 24

Steps executed: 151 Episode length: 151 Return: -61.87091731040113735
INFO:tensorflow:Average training steps per second: 320.70

Steps executed: 1011 Episode length: 860 Return: -721.193698466798435
I0902 00:30:08.726683 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.53
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 249 Return: 19.220415935551912435
INFO:tensorflow:Average training steps per second: 316.64
I0902 00:30:15.201164 140252174653440 replay_runner.py:36] Average training steps per second: 316.64
I0902 00:30:15.407081 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.22
INFO:tensorflow:Starting iteration 26

Steps executed: 218 Episode length: 127 Return: -70.69708679865074435
INFO:tensorflow:Average training steps per second: 323.48
I0902 00:30:21.821784 140252174653440 replay_runner.py:36] Average training steps per second: 323.48
I0902 00:30:21.958792 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.97
INFO:tensorflow:Starting iteration 27

Steps executed: 234 Episode length: 114 Return: -15.87972005647084535
INFO:tensorflow:Average training steps per second: 323.74
I0902 00:30:28.365986 140252174653440 replay_runner.py:36] Average training steps per second: 323.74
I0902 00:30:28.507891 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.89
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 86 Return: -314.13315205553454535
INFO:tensorflow:Average training steps per second: 329.91
I0902 00:30:34.770418 140252174653440 replay_runner.py:36] Average training steps per second: 329.91
I0902 00:30:34.896891 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.81
INFO:tensorflow:Starting iteration 29

Steps executed: 258 Episode length: 128 Return: -597.6461414444749535
INFO:tensorflow:Average training steps per second: 343.37
I0902 00:30:41.057627 140252174653440 replay_runner.py:36] Average training steps per second: 343.37

Done fixed training!Episode length: 128 Return: -597.6461414444749535