Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0901 12:45:20.495845 140240877414400 run_experiment.py:549] Creating TrainRunner ...
I0901 12:45:20.509851 140240877414400 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:45:20.510128 140240877414400 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:45:20.510288 140240877414400 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:45:20.510564 140240877414400 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:45:20.510807 140240877414400 dqn_agent.py:275] 	 update_period: 4
I0901 12:45:20.510952 140240877414400 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:45:20.511070 140240877414400 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:45:20.511202 140240877414400 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:45:20.511307 140240877414400 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:45:20.511415 140240877414400 dqn_agent.py:280] 	 optimizer: adam
I0901 12:45:20.511531 140240877414400 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:45:20.511631 140240877414400 dqn_agent.py:283] 	 seed: 1630500320509794
I0901 12:45:20.516304 140240877414400 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:45:20.516551 140240877414400 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:45:20.516695 140240877414400 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:45:20.516819 140240877414400 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:45:20.517007 140240877414400 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:45:20.517256 140240877414400 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:45:20.517410 140240877414400 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:45:20.517530 140240877414400 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:45:20.517652 140240877414400 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:45:20.564462 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:21.016724 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:21.033716 140240877414400 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:45:21.044154 140240877414400 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:45:21.044466 140240877414400 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:45:21.044691 140240877414400 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:45:21.044998 140240877414400 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:45:21.045191 140240877414400 dqn_agent.py:275] 	 update_period: 4
I0901 12:45:21.045598 140240877414400 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:45:21.045755 140240877414400 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:45:21.045901 140240877414400 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:45:21.046051 140240877414400 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:45:21.046196 140240877414400 dqn_agent.py:280] 	 optimizer: adam
I0901 12:45:21.046319 140240877414400 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:45:21.046421 140240877414400 dqn_agent.py:283] 	 seed: 1630500321044082
I0901 12:45:21.049732 140240877414400 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:45:21.049912 140240877414400 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:45:21.050513 140240877414400 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:45:21.050697 140240877414400 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:45:21.050794 140240877414400 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:45:21.051045 140240877414400 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:45:21.051383 140240877414400 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:45:21.051583 140240877414400 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:45:21.051911 140240877414400 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:45:21.088746 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:45:21.110889 140240877414400 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:45:21.111170 140240877414400 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.96
I0901 12:45:27.606746 140240877414400 replay_runner.py:36] Average training steps per second: 153.96
Steps executed: 217 Episode length: 131 Return: -394.5686648797701
I0901 12:45:28.873599 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.06
INFO:tensorflow:Starting iteration 1
I0901 12:45:33.240582 140240877414400 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 211.52

Steps executed: 261 Episode length: 124 Return: -269.90043500574837
I0901 12:45:38.241405 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.60
INFO:tensorflow:Starting iteration 2

Steps executed: 228 Episode length: 89 Return: -325.411923932046387
INFO:tensorflow:Average training steps per second: 215.77
I0901 12:45:47.271142 140240877414400 replay_runner.py:36] Average training steps per second: 215.77
I0901 12:45:47.475362 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.58
INFO:tensorflow:Starting iteration 3

Steps executed: 204 Episode length: 127 Return: -344.05661487465784
INFO:tensorflow:Average training steps per second: 215.17
I0901 12:45:56.406271 140240877414400 replay_runner.py:36] Average training steps per second: 215.17
I0901 12:45:56.597107 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.72
INFO:tensorflow:Starting iteration 4

Steps executed: 265 Episode length: 155 Return: -207.49985554343994
INFO:tensorflow:Average training steps per second: 219.79
I0901 12:46:05.527307 140240877414400 replay_runner.py:36] Average training steps per second: 219.79
I0901 12:46:05.790345 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.14
INFO:tensorflow:Starting iteration 5

Steps executed: 215 Episode length: 130 Return: -254.90780408555497
INFO:tensorflow:Average training steps per second: 222.81
I0901 12:46:14.624814 140240877414400 replay_runner.py:36] Average training steps per second: 222.81
I0901 12:46:14.821948 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.75
INFO:tensorflow:Starting iteration 6

Steps executed: 293 Episode length: 135 Return: -120.12597718161456
INFO:tensorflow:Average training steps per second: 219.97
I0901 12:46:23.708850 140240877414400 replay_runner.py:36] Average training steps per second: 219.97
I0901 12:46:23.968973 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.25
INFO:tensorflow:Starting iteration 7

Steps executed: 237 Episode length: 90 Return: -169.169547255396656
INFO:tensorflow:Average training steps per second: 224.28
I0901 12:46:32.658882 140240877414400 replay_runner.py:36] Average training steps per second: 224.28
I0901 12:46:32.868450 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.81
INFO:tensorflow:Starting iteration 8

Steps executed: 229 Episode length: 110 Return: -368.79538486799214
INFO:tensorflow:Average training steps per second: 215.87
I0901 12:46:41.926728 140240877414400 replay_runner.py:36] Average training steps per second: 215.87
I0901 12:46:42.136776 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.16
INFO:tensorflow:Starting iteration 9

Steps executed: 242 Episode length: 84 Return: -230.286974905873174
INFO:tensorflow:Average training steps per second: 218.03
I0901 12:46:51.136401 140240877414400 replay_runner.py:36] Average training steps per second: 218.03
I0901 12:46:51.374722 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.75
INFO:tensorflow:Starting iteration 10

Steps executed: 174 Episode length: 92 Return: -332.600992333102974
INFO:tensorflow:Average training steps per second: 221.03
I0901 12:47:00.270340 140240877414400 replay_runner.py:36] Average training steps per second: 221.03

Steps executed: 363 Episode length: 189 Return: -83.845031476841274
INFO:tensorflow:Starting iteration 11

Steps executed: 317 Episode length: 120 Return: -237.85554773562114
INFO:tensorflow:Average training steps per second: 220.44
I0901 12:47:09.590574 140240877414400 replay_runner.py:36] Average training steps per second: 220.44
I0901 12:47:09.828109 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.49
INFO:tensorflow:Starting iteration 12
I0901 12:47:14.133861 140240877414400 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 223.51

Steps executed: 216 Episode length: 216 Return: -239.01114059771538
I0901 12:47:18.837125 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.01
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 105 Return: -682.86497721470038
INFO:tensorflow:Average training steps per second: 225.76
I0901 12:47:27.731710 140240877414400 replay_runner.py:36] Average training steps per second: 225.76
I0901 12:47:27.979301 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -338.01
INFO:tensorflow:Starting iteration 14

Steps executed: 285 Episode length: 133 Return: -503.42234953687836
INFO:tensorflow:Average training steps per second: 223.22
I0901 12:47:36.759342 140240877414400 replay_runner.py:36] Average training steps per second: 223.22
I0901 12:47:37.026234 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.98
INFO:tensorflow:Starting iteration 15

Steps executed: 208 Episode length: 99 Return: -387.984670838718786
INFO:tensorflow:Average training steps per second: 228.39
I0901 12:47:45.785827 140240877414400 replay_runner.py:36] Average training steps per second: 228.39
I0901 12:47:45.969910 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.36
INFO:tensorflow:Starting iteration 16

Steps executed: 311 Episode length: 141 Return: -160.91164829638151
INFO:tensorflow:Average training steps per second: 223.17
I0901 12:47:54.807751 140240877414400 replay_runner.py:36] Average training steps per second: 223.17
I0901 12:47:55.078983 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.65
INFO:tensorflow:Starting iteration 17

Steps executed: 319 Episode length: 128 Return: -240.60398217518875
INFO:tensorflow:Average training steps per second: 225.88
I0901 12:48:03.940039 140240877414400 replay_runner.py:36] Average training steps per second: 225.88
I0901 12:48:04.266442 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.91
INFO:tensorflow:Starting iteration 18

Steps executed: 235 Episode length: 92 Return: 4.862914509974445315
INFO:tensorflow:Average training steps per second: 224.18
I0901 12:48:13.148144 140240877414400 replay_runner.py:36] Average training steps per second: 224.18
I0901 12:48:13.363283 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.60
INFO:tensorflow:Starting iteration 19

Steps executed: 155 Episode length: 90 Return: -395.484527105621215
INFO:tensorflow:Average training steps per second: 219.06
I0901 12:48:22.302882 140240877414400 replay_runner.py:36] Average training steps per second: 219.06

Steps executed: 229 Episode length: 74 Return: -262.768025123107465
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 76 Return: -125.263999029886655
INFO:tensorflow:Average training steps per second: 224.00
I0901 12:48:31.344756 140240877414400 replay_runner.py:36] Average training steps per second: 224.00
I0901 12:48:31.532973 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.94
INFO:tensorflow:Starting iteration 21

Steps executed: 255 Episode length: 86 Return: -804.206858004059145
INFO:tensorflow:Average training steps per second: 222.40
I0901 12:48:40.354913 140240877414400 replay_runner.py:36] Average training steps per second: 222.40
I0901 12:48:40.564927 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.81
INFO:tensorflow:Starting iteration 22

Steps executed: 211 Episode length: 101 Return: -285.62362495178415
INFO:tensorflow:Average training steps per second: 222.60
I0901 12:48:49.450868 140240877414400 replay_runner.py:36] Average training steps per second: 222.60
I0901 12:48:49.638025 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.78
INFO:tensorflow:Starting iteration 23

Steps executed: 333 Episode length: 178 Return: -341.29625422072604
INFO:tensorflow:Average training steps per second: 224.48
I0901 12:48:58.384563 140240877414400 replay_runner.py:36] Average training steps per second: 224.48
I0901 12:48:58.684357 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.75
INFO:tensorflow:Starting iteration 24

Steps executed: 219 Episode length: 77 Return: -609.349125618944574
INFO:tensorflow:Average training steps per second: 223.69
I0901 12:49:07.540874 140240877414400 replay_runner.py:36] Average training steps per second: 223.69
I0901 12:49:07.732290 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.89
INFO:tensorflow:Starting iteration 25

Steps executed: 208 Episode length: 156 Return: -140.65901450288706
INFO:tensorflow:Average training steps per second: 226.37
I0901 12:49:16.532375 140240877414400 replay_runner.py:36] Average training steps per second: 226.37
I0901 12:49:16.718896 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.52
INFO:tensorflow:Starting iteration 26

Steps executed: 214 Episode length: 69 Return: -262.799523271831566
INFO:tensorflow:Average training steps per second: 227.16
I0901 12:49:25.333162 140240877414400 replay_runner.py:36] Average training steps per second: 227.16
I0901 12:49:25.506659 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.29
INFO:tensorflow:Starting iteration 27

Steps executed: 214 Episode length: 73 Return: -147.357719152969666
INFO:tensorflow:Average training steps per second: 226.45
I0901 12:49:34.221709 140240877414400 replay_runner.py:36] Average training steps per second: 226.45
I0901 12:49:34.402688 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.57
INFO:tensorflow:Starting iteration 28

Steps executed: 225 Episode length: 63 Return: -128.373084872771446
INFO:tensorflow:Average training steps per second: 217.39
I0901 12:49:43.591528 140240877414400 replay_runner.py:36] Average training steps per second: 217.39
I0901 12:49:43.791769 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.38
INFO:tensorflow:Starting iteration 29

Steps executed: 238 Episode length: 76 Return: -525.975902339931646
INFO:tensorflow:Average training steps per second: 222.45
I0901 12:49:52.615177 140240877414400 replay_runner.py:36] Average training steps per second: 222.45

Done fixed training!Episode length: 76 Return: -525.975902339931646