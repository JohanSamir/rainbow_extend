Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0828 10:50:37.229322 139821415028736 run_experiment.py:549] Creating TrainRunner ...
I0828 10:50:37.236969 139821415028736 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:37.237076 139821415028736 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:37.237133 139821415028736 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:37.237204 139821415028736 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:37.237255 139821415028736 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:37.237323 139821415028736 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:37.237369 139821415028736 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:37.237463 139821415028736 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:37.237542 139821415028736 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:37.237601 139821415028736 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:37.237649 139821415028736 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:37.237707 139821415028736 dqn_agent.py:283] 	 seed: 1630147837236942
I0828 10:50:37.239160 139821415028736 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:37.239265 139821415028736 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:37.239355 139821415028736 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:37.239419 139821415028736 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:37.239490 139821415028736 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:37.239541 139821415028736 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:37.239589 139821415028736 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:37.239654 139821415028736 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:37.239733 139821415028736 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:37.261945 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:37.490258 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:37.499083 139821415028736 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:50:37.504671 139821415028736 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:37.504797 139821415028736 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:37.504881 139821415028736 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:37.504946 139821415028736 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:37.505002 139821415028736 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:37.505080 139821415028736 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:37.505171 139821415028736 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:37.505235 139821415028736 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:37.505289 139821415028736 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:37.505345 139821415028736 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:37.505410 139821415028736 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:37.505483 139821415028736 dqn_agent.py:283] 	 seed: 1630147837504643
I0828 10:50:37.506844 139821415028736 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:37.506970 139821415028736 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:37.507041 139821415028736 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:37.507103 139821415028736 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:37.507163 139821415028736 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:37.507233 139821415028736 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:37.507296 139821415028736 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:37.507372 139821415028736 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:37.507435 139821415028736 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:37.527036 139821415028736 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:37.542198 139821415028736 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:50:37.542358 139821415028736 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 275.35
I0828 10:50:41.174296 139821415028736 replay_runner.py:36] Average training steps per second: 275.35
I0828 10:50:42.033137 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.07
Steps executed: 205 Episode length: 205 Return: -154.06718133950497
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 86 Return: -210.750094968318937
INFO:tensorflow:Average training steps per second: 386.30
I0828 10:50:47.781550 139821415028736 replay_runner.py:36] Average training steps per second: 386.30
I0828 10:50:47.902239 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.68
INFO:tensorflow:Starting iteration 2

Steps executed: 383 Episode length: 261 Return: -33.093194615760396
INFO:tensorflow:Average training steps per second: 362.72
I0828 10:50:54.057471 139821415028736 replay_runner.py:36] Average training steps per second: 362.72
I0828 10:50:54.316875 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.37
INFO:tensorflow:Starting iteration 3

Steps executed: 245 Episode length: 82 Return: -446.384425490020296
INFO:tensorflow:Average training steps per second: 340.61
I0828 10:51:00.685586 139821415028736 replay_runner.py:36] Average training steps per second: 340.61
I0828 10:51:00.805470 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.79
INFO:tensorflow:Starting iteration 4

Steps executed: 223 Episode length: 127 Return: -416.43606356575576
INFO:tensorflow:Average training steps per second: 350.36
I0828 10:51:07.093873 139821415028736 replay_runner.py:36] Average training steps per second: 350.36
I0828 10:51:07.238485 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.59
INFO:tensorflow:Starting iteration 5

Steps executed: 251 Episode length: 134 Return: -406.49494462115975
INFO:tensorflow:Average training steps per second: 360.01
I0828 10:51:13.508626 139821415028736 replay_runner.py:36] Average training steps per second: 360.01
I0828 10:51:13.656376 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.66
INFO:tensorflow:Starting iteration 6

Steps executed: 225 Episode length: 87 Return: -372.688644791153545
INFO:tensorflow:Average training steps per second: 360.70
I0828 10:51:19.852387 139821415028736 replay_runner.py:36] Average training steps per second: 360.70
I0828 10:51:19.983582 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.98
INFO:tensorflow:Starting iteration 7

Steps executed: 291 Episode length: 154 Return: -288.32806976254375
INFO:tensorflow:Average training steps per second: 354.50
I0828 10:51:26.241446 139821415028736 replay_runner.py:36] Average training steps per second: 354.50
I0828 10:51:26.416794 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.32
INFO:tensorflow:Starting iteration 8

Steps executed: 270 Episode length: 157 Return: -427.81382650742475
INFO:tensorflow:Average training steps per second: 359.97
I0828 10:51:32.677163 139821415028736 replay_runner.py:36] Average training steps per second: 359.97
I0828 10:51:32.838279 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.31
INFO:tensorflow:Starting iteration 9

Steps executed: 414 Episode length: 238 Return: 5.37476532005338545
INFO:tensorflow:Average training steps per second: 354.57
I0828 10:51:39.199697 139821415028736 replay_runner.py:36] Average training steps per second: 354.57
I0828 10:51:39.521366 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.62
INFO:tensorflow:Starting iteration 10

Steps executed: 266 Episode length: 139 Return: -331.41036221299726
INFO:tensorflow:Average training steps per second: 354.83
I0828 10:51:45.840615 139821415028736 replay_runner.py:36] Average training steps per second: 354.83
I0828 10:51:46.001093 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.55
INFO:tensorflow:Starting iteration 11

Steps executed: 227 Episode length: 227 Return: -314.31633243238246
INFO:tensorflow:Average training steps per second: 352.62
I0828 10:51:52.355314 139821415028736 replay_runner.py:36] Average training steps per second: 352.62
I0828 10:51:52.500577 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.32
INFO:tensorflow:Starting iteration 12

Steps executed: 285 Episode length: 86 Return: -383.414375714491446
INFO:tensorflow:Average training steps per second: 341.79
I0828 10:51:58.913602 139821415028736 replay_runner.py:36] Average training steps per second: 341.79
I0828 10:51:59.051393 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.07
INFO:tensorflow:Starting iteration 13

Steps executed: 302 Episode length: 128 Return: -185.94550770385212
INFO:tensorflow:Average training steps per second: 344.11
I0828 10:52:05.423368 139821415028736 replay_runner.py:36] Average training steps per second: 344.11
I0828 10:52:05.581053 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.87
INFO:tensorflow:Starting iteration 14

Steps executed: 265 Episode length: 97 Return: -187.037076966015552
INFO:tensorflow:Average training steps per second: 337.91
I0828 10:52:12.011147 139821415028736 replay_runner.py:36] Average training steps per second: 337.91
I0828 10:52:12.153046 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.43
INFO:tensorflow:Starting iteration 15

Steps executed: 284 Episode length: 118 Return: -392.10840530769312
INFO:tensorflow:Average training steps per second: 341.23
I0828 10:52:18.528513 139821415028736 replay_runner.py:36] Average training steps per second: 341.23
I0828 10:52:18.680706 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.80
INFO:tensorflow:Starting iteration 16

Steps executed: 257 Episode length: 146 Return: -439.98127222466337
INFO:tensorflow:Average training steps per second: 339.75
I0828 10:52:25.067020 139821415028736 replay_runner.py:36] Average training steps per second: 339.75
I0828 10:52:25.206505 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.39
INFO:tensorflow:Starting iteration 17

Steps executed: 255 Episode length: 112 Return: -78.265945078760285
INFO:tensorflow:Average training steps per second: 325.97
I0828 10:52:31.690899 139821415028736 replay_runner.py:36] Average training steps per second: 325.97
I0828 10:52:31.824106 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.01
INFO:tensorflow:Starting iteration 18

Steps executed: 222 Episode length: 79 Return: -436.161005921230645
INFO:tensorflow:Average training steps per second: 335.78
I0828 10:52:38.224550 139821415028736 replay_runner.py:36] Average training steps per second: 335.78
I0828 10:52:38.348252 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.27
INFO:tensorflow:Starting iteration 19

Steps executed: 281 Episode length: 145 Return: -471.66821525671594
INFO:tensorflow:Average training steps per second: 341.41
I0828 10:52:44.681683 139821415028736 replay_runner.py:36] Average training steps per second: 341.41
I0828 10:52:44.838105 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -452.46
INFO:tensorflow:Starting iteration 20
I0828 10:52:48.276000 139821415028736 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 339.84

Steps executed: 1000 Episode length: 1000 Return: -75.83525984996864
I0828 10:52:53.812024 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.84
INFO:tensorflow:Starting iteration 21

Steps executed: 205 Episode length: 114 Return: -345.210797828787864
INFO:tensorflow:Average training steps per second: 348.95
I0828 10:53:00.116827 139821415028736 replay_runner.py:36] Average training steps per second: 348.95
I0828 10:53:00.240379 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.50
INFO:tensorflow:Starting iteration 22

Steps executed: 214 Episode length: 98 Return: -482.7662039601282164
INFO:tensorflow:Average training steps per second: 343.06
I0828 10:53:06.593763 139821415028736 replay_runner.py:36] Average training steps per second: 343.06
I0828 10:53:06.723712 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.88
INFO:tensorflow:Starting iteration 23

Steps executed: 209 Episode length: 114 Return: -380.736658061853464
INFO:tensorflow:Average training steps per second: 355.68
I0828 10:53:12.971753 139821415028736 replay_runner.py:36] Average training steps per second: 355.68
I0828 10:53:13.084439 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.63
INFO:tensorflow:Starting iteration 24

Steps executed: 212 Episode length: 110 Return: -198.845513292408444
INFO:tensorflow:Average training steps per second: 344.74
I0828 10:53:19.447443 139821415028736 replay_runner.py:36] Average training steps per second: 344.74
I0828 10:53:19.577241 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.05
INFO:tensorflow:Starting iteration 25

Steps executed: 321 Episode length: 226 Return: -248.205749255325464
INFO:tensorflow:Average training steps per second: 345.84
I0828 10:53:25.909054 139821415028736 replay_runner.py:36] Average training steps per second: 345.84
I0828 10:53:26.138554 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -422.32
INFO:tensorflow:Starting iteration 26

Steps executed: 251 Episode length: 109 Return: -306.079199931926764
INFO:tensorflow:Average training steps per second: 341.01
I0828 10:53:32.477783 139821415028736 replay_runner.py:36] Average training steps per second: 341.01
I0828 10:53:32.639818 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.29
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 111 Return: -146.596712212815934
INFO:tensorflow:Average training steps per second: 340.55
I0828 10:53:38.999615 139821415028736 replay_runner.py:36] Average training steps per second: 340.55
I0828 10:53:39.135563 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.82
INFO:tensorflow:Starting iteration 28
I0828 10:53:42.556183 139821415028736 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 353.22

Steps executed: 264 Episode length: 169 Return: -144.242617147488774
I0828 10:53:45.558615 139821415028736 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.71
INFO:tensorflow:Starting iteration 29

Steps executed: 284 Episode length: 104 Return: -387.255780119396434
INFO:tensorflow:Average training steps per second: 354.64
I0828 10:53:51.851441 139821415028736 replay_runner.py:36] Average training steps per second: 354.64

Done fixed training!Episode length: 104 Return: -387.255780119396434