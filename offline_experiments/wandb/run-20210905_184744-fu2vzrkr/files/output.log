I0905 18:47:51.446857 139980086712320 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.447607 139980086712320 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.520238 139980086712320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.521522 139980086712320 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.521604 139980086712320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.521667 139980086712320 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.521727 139980086712320 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.521813 139980086712320 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:51.521901 139980086712320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.522059 139980086712320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.522156 139980086712320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.522228 139980086712320 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.522298 139980086712320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.522368 139980086712320 dqn_agent.py:283] 	 seed: 1630867671520176
I0905 18:47:51.524151 139980086712320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.524294 139980086712320 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:51.524383 139980086712320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.524446 139980086712320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.524502 139980086712320 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.524581 139980086712320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.524671 139980086712320 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.524774 139980086712320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.524843 139980086712320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.683938 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0905 18:47:53.069074 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.110163 139980086712320 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:53.116914 139980086712320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:53.117089 139980086712320 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:53.117186 139980086712320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:53.117249 139980086712320 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:53.117309 139980086712320 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:53.117402 139980086712320 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:53.117463 139980086712320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:53.117563 139980086712320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:53.117647 139980086712320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:53.117732 139980086712320 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:53.117816 139980086712320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:53.117895 139980086712320 dqn_agent.py:283] 	 seed: 1630867673116871
I0905 18:47:53.119662 139980086712320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:53.119792 139980086712320 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:53.119863 139980086712320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:53.119938 139980086712320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:53.119994 139980086712320 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:53.120090 139980086712320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:53.120170 139980086712320 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:53.120227 139980086712320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:53.120301 139980086712320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:53.136997 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.147923 139980086712320 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:53.148117 139980086712320 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 309.61
I0905 18:47:56.378293 139980086712320 replay_runner.py:36] Average training steps per second: 309.61
Steps executed: 313 Episode length: 185 Return: -84.81256904561593
I0905 18:47:57.069576 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.09
INFO:tensorflow:Starting iteration 1

Steps executed: 273 Episode length: 160 Return: -315.92277100601234
INFO:tensorflow:Average training steps per second: 412.45
I0905 18:48:02.582480 139980086712320 replay_runner.py:36] Average training steps per second: 412.45
I0905 18:48:02.701162 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.02
INFO:tensorflow:Starting iteration 2

Steps executed: 249 Episode length: 136 Return: -309.09418343570364
INFO:tensorflow:Average training steps per second: 404.51
I0905 18:48:08.263823 139980086712320 replay_runner.py:36] Average training steps per second: 404.51
I0905 18:48:08.370680 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.91
INFO:tensorflow:Starting iteration 3

Steps executed: 230 Episode length: 83 Return: -230.872208876713134
INFO:tensorflow:Average training steps per second: 386.89
I0905 18:48:14.050750 139980086712320 replay_runner.py:36] Average training steps per second: 386.89
I0905 18:48:14.156213 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.09
INFO:tensorflow:Starting iteration 4

Steps executed: 265 Episode length: 142 Return: -226.74884111958897
INFO:tensorflow:Average training steps per second: 404.10
I0905 18:48:19.716479 139980086712320 replay_runner.py:36] Average training steps per second: 404.10
I0905 18:48:19.836606 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.30
INFO:tensorflow:Starting iteration 5

Steps executed: 308 Episode length: 157 Return: -300.74238045331417
INFO:tensorflow:Average training steps per second: 414.70
I0905 18:48:25.338176 139980086712320 replay_runner.py:36] Average training steps per second: 414.70
I0905 18:48:25.484068 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.65
INFO:tensorflow:Starting iteration 6

Steps executed: 212 Episode length: 136 Return: -224.78102808397574
INFO:tensorflow:Average training steps per second: 418.02
I0905 18:48:30.955553 139980086712320 replay_runner.py:36] Average training steps per second: 418.02
I0905 18:48:31.046870 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.47
INFO:tensorflow:Starting iteration 7

Steps executed: 248 Episode length: 91 Return: -479.167302734927834
INFO:tensorflow:Average training steps per second: 398.76
I0905 18:48:36.639016 139980086712320 replay_runner.py:36] Average training steps per second: 398.76
I0905 18:48:36.750632 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.93
INFO:tensorflow:Starting iteration 8

Steps executed: 248 Episode length: 160 Return: -317.99467419924684
INFO:tensorflow:Average training steps per second: 417.39
I0905 18:48:42.236845 139980086712320 replay_runner.py:36] Average training steps per second: 417.39
I0905 18:48:42.347939 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.52
INFO:tensorflow:Starting iteration 9

Steps executed: 225 Episode length: 129 Return: -152.29475495397082
INFO:tensorflow:Average training steps per second: 417.17
I0905 18:48:47.819165 139980086712320 replay_runner.py:36] Average training steps per second: 417.17
I0905 18:48:47.906727 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.83
INFO:tensorflow:Starting iteration 10

Steps executed: 290 Episode length: 105 Return: -33.430565169869036
INFO:tensorflow:Average training steps per second: 410.01
I0905 18:48:53.418120 139980086712320 replay_runner.py:36] Average training steps per second: 410.01
I0905 18:48:53.551230 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.90
INFO:tensorflow:Starting iteration 11

Steps executed: 268 Episode length: 77 Return: -183.930661639029426
INFO:tensorflow:Average training steps per second: 406.94
I0905 18:48:59.083542 139980086712320 replay_runner.py:36] Average training steps per second: 406.94
I0905 18:48:59.167574 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.29
INFO:tensorflow:Starting iteration 12

Steps executed: 244 Episode length: 134 Return: -546.68652422459956
INFO:tensorflow:Average training steps per second: 412.34
I0905 18:49:04.677436 139980086712320 replay_runner.py:36] Average training steps per second: 412.34
I0905 18:49:04.781524 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.62
INFO:tensorflow:Starting iteration 13

Steps executed: 256 Episode length: 256 Return: -437.71452398673036
INFO:tensorflow:Average training steps per second: 415.16
I0905 18:49:10.276961 139980086712320 replay_runner.py:36] Average training steps per second: 415.16
I0905 18:49:10.433625 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.71
INFO:tensorflow:Starting iteration 14

Steps executed: 351 Episode length: 176 Return: -42.228259471754235
INFO:tensorflow:Average training steps per second: 417.49
I0905 18:49:15.904767 139980086712320 replay_runner.py:36] Average training steps per second: 417.49
I0905 18:49:16.062143 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.50
INFO:tensorflow:Starting iteration 15

Steps executed: 248 Episode length: 248 Return: -382.09029714402075
INFO:tensorflow:Average training steps per second: 417.59
I0905 18:49:21.520352 139980086712320 replay_runner.py:36] Average training steps per second: 417.59
I0905 18:49:21.677361 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.09
INFO:tensorflow:Starting iteration 16

Steps executed: 202 Episode length: 121 Return: -458.59141165370676
INFO:tensorflow:Average training steps per second: 439.66
I0905 18:49:26.950746 139980086712320 replay_runner.py:36] Average training steps per second: 439.66
I0905 18:49:27.038125 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.08
INFO:tensorflow:Starting iteration 17

Steps executed: 265 Episode length: 75 Return: -366.824358683399456
INFO:tensorflow:Average training steps per second: 292.14
I0905 18:49:33.669411 139980086712320 replay_runner.py:36] Average training steps per second: 292.14
I0905 18:49:33.880227 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.75
INFO:tensorflow:Starting iteration 18

Steps executed: 254 Episode length: 93 Return: -346.027398583023343
INFO:tensorflow:Average training steps per second: 283.84
I0905 18:49:40.804872 139980086712320 replay_runner.py:36] Average training steps per second: 283.84
I0905 18:49:40.974122 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.93
INFO:tensorflow:Starting iteration 19

Steps executed: 371 Episode length: 231 Return: -14.781866457579412
INFO:tensorflow:Average training steps per second: 247.24
I0905 18:49:49.197890 139980086712320 replay_runner.py:36] Average training steps per second: 247.24
I0905 18:49:49.506104 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.04
INFO:tensorflow:Starting iteration 20

Steps executed: 399 Episode length: 399 Return: -1427.7009041505578
INFO:tensorflow:Average training steps per second: 239.16
I0905 18:49:57.916020 139980086712320 replay_runner.py:36] Average training steps per second: 239.16
I0905 18:49:58.414505 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -1427.70
INFO:tensorflow:Starting iteration 21

Steps executed: 326 Episode length: 187 Return: -990.62687547197958
INFO:tensorflow:Average training steps per second: 240.08
I0905 18:50:06.870574 139980086712320 replay_runner.py:36] Average training steps per second: 240.08
I0905 18:50:07.147592 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.69
INFO:tensorflow:Starting iteration 22
I0905 18:50:11.400764 139980086712320 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 241.14
I0905 18:50:15.548126 139980086712320 replay_runner.py:36] Average training steps per second: 241.14

Steps executed: 238 Episode length: 71 Return: -685.933935043636358
INFO:tensorflow:Starting iteration 23

Steps executed: 227 Episode length: 173 Return: -88.630537273898238
INFO:tensorflow:Average training steps per second: 240.00
I0905 18:50:24.057564 139980086712320 replay_runner.py:36] Average training steps per second: 240.00
I0905 18:50:24.235189 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.66
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 68 Return: -453.573221423628248
INFO:tensorflow:Average training steps per second: 242.59
I0905 18:50:32.621098 139980086712320 replay_runner.py:36] Average training steps per second: 242.59
I0905 18:50:32.776553 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -511.85
INFO:tensorflow:Starting iteration 25

Steps executed: 276 Episode length: 97 Return: -702.531844622262248
INFO:tensorflow:Average training steps per second: 239.11
I0905 18:50:41.222873 139980086712320 replay_runner.py:36] Average training steps per second: 239.11
I0905 18:50:41.412986 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -584.92
INFO:tensorflow:Starting iteration 26
I0905 18:50:45.597325 139980086712320 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 239.76

Steps executed: 325 Episode length: 154 Return: -571.09597861190358
I0905 18:50:50.019244 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.37
INFO:tensorflow:Starting iteration 27

Steps executed: 221 Episode length: 221 Return: -351.95417932181385
INFO:tensorflow:Average training steps per second: 243.09
I0905 18:50:58.358199 139980086712320 replay_runner.py:36] Average training steps per second: 243.09
I0905 18:50:58.541859 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.95
INFO:tensorflow:Starting iteration 28

Steps executed: 327 Episode length: 140 Return: -318.93858433104625
INFO:tensorflow:Average training steps per second: 240.54
I0905 18:51:06.844991 139980086712320 replay_runner.py:36] Average training steps per second: 240.54
I0905 18:51:07.117810 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.57
INFO:tensorflow:Starting iteration 29
I0905 18:51:11.395006 139980086712320 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 241.07
I0905 18:51:15.543562 139980086712320 replay_runner.py:36] Average training steps per second: 241.07


Done fixed training!Episode length: 103 Return: -279.95320493207735