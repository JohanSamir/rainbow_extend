Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0901 12:55:32.952498 140196630247424 run_experiment.py:549] Creating TrainRunner ...
I0901 12:55:32.961973 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:55:32.962238 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:55:32.962365 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:55:32.962471 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:55:32.962559 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:55:32.962645 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:55:32.962729 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:55:32.962834 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:55:32.963229 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:55:32.963464 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:55:32.963633 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:55:32.963792 140196630247424 dqn_agent.py:283] 	 seed: 1630500932961908
I0901 12:55:32.967200 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:55:32.967411 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:55:32.967556 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:55:32.967663 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:55:32.967756 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:55:32.967840 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:55:32.967923 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:55:32.968008 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:55:32.968142 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:55:33.011559 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:33.553905 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:33.568237 140196630247424 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:55:33.579315 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:55:33.579620 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:55:33.579793 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:55:33.579930 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:55:33.580070 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:55:33.580215 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:55:33.580537 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:55:33.580737 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:55:33.580896 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:55:33.581038 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:55:33.581148 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:55:33.581252 140196630247424 dqn_agent.py:283] 	 seed: 1630500933579259
I0901 12:55:33.584753 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:55:33.584980 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:55:33.585183 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:55:33.585300 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:55:33.585393 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:55:33.585622 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:55:33.585719 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:55:33.585799 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:55:33.585855 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:55:33.626809 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:55:33.700764 140196630247424 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:55:33.701165 140196630247424 replay_runner.py:41] Starting iteration 0
Steps executed: 282 Episode length: 93 Return: 93.0
INFO:tensorflow:Average training steps per second: 138.99
I0901 12:55:40.896275 140196630247424 replay_runner.py:36] Average training steps per second: 138.99
I0901 12:55:42.166905 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 94.00
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 190.15
I0901 12:55:47.606522 140196630247424 replay_runner.py:36] Average training steps per second: 190.15
I0901 12:55:47.745093 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 2

Steps executed: 210 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 190.79
I0901 12:55:53.174913 140196630247424 replay_runner.py:36] Average training steps per second: 190.79
I0901 12:55:53.327759 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.12
INFO:tensorflow:Starting iteration 3
I0901 12:55:53.521509 140196630247424 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 193.32

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 12:55:58.836490 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 242 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 188.42
I0901 12:56:04.332840 140196630247424 replay_runner.py:36] Average training steps per second: 188.42
I0901 12:56:04.507756 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.00
INFO:tensorflow:Starting iteration 5

Steps executed: 324 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 191.31
I0901 12:56:09.927036 140196630247424 replay_runner.py:36] Average training steps per second: 191.31
I0901 12:56:10.160881 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 6
I0901 12:56:10.360386 140196630247424 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 192.86
I0901 12:56:15.545825 140196630247424 replay_runner.py:36] Average training steps per second: 192.86
I0901 12:56:15.748579 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 7


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.42
I0901 12:56:21.135217 140196630247424 replay_runner.py:36] Average training steps per second: 192.42
I0901 12:56:21.271244 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0901 12:56:21.460305 140196630247424 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 194.21
I0901 12:56:26.609884 140196630247424 replay_runner.py:36] Average training steps per second: 194.21
I0901 12:56:26.748908 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0901 12:56:26.945173 140196630247424 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 191.76
I0901 12:56:32.160427 140196630247424 replay_runner.py:36] Average training steps per second: 191.76
I0901 12:56:32.299552 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 312 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 191.30
I0901 12:56:37.723884 140196630247424 replay_runner.py:36] Average training steps per second: 191.30
I0901 12:56:37.941400 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 11

Steps executed: 318 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 194.57
I0901 12:56:43.287875 140196630247424 replay_runner.py:36] Average training steps per second: 194.57
I0901 12:56:43.501204 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 12

Steps executed: 129 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 189.32
I0901 12:56:48.971627 140196630247424 replay_runner.py:36] Average training steps per second: 189.32

Steps executed: 268 Episode length: 139 Return: 139.0
INFO:tensorflow:Starting iteration 13

Steps executed: 265 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 193.27
I0901 12:56:54.510578 140196630247424 replay_runner.py:36] Average training steps per second: 193.27
I0901 12:56:54.693789 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 14

Steps executed: 353 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 186.23
I0901 12:57:00.266446 140196630247424 replay_runner.py:36] Average training steps per second: 186.23
I0901 12:57:00.496397 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 15

Steps executed: 300 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 191.93
I0901 12:57:05.890546 140196630247424 replay_runner.py:36] Average training steps per second: 191.93
I0901 12:57:06.111039 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 16
I0901 12:57:06.300034 140196630247424 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.47
I0901 12:57:11.496123 140196630247424 replay_runner.py:36] Average training steps per second: 192.47
I0901 12:57:11.714132 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 17


Steps executed: 176 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 188.35
I0901 12:57:17.219577 140196630247424 replay_runner.py:36] Average training steps per second: 188.35
I0901 12:57:17.461299 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 18


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.92
I0901 12:57:22.721426 140196630247424 replay_runner.py:36] Average training steps per second: 196.92
I0901 12:57:22.859668 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:57:23.050424 140196630247424 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.00
I0901 12:57:28.232064 140196630247424 replay_runner.py:36] Average training steps per second: 193.00
I0901 12:57:28.387605 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 383 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 191.45
I0901 12:57:33.802487 140196630247424 replay_runner.py:36] Average training steps per second: 191.45
I0901 12:57:34.083419 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.80
I0901 12:57:39.238439 140196630247424 replay_runner.py:36] Average training steps per second: 200.80
I0901 12:57:39.382813 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 12:57:39.577875 140196630247424 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 185.84
I0901 12:57:44.959387 140196630247424 replay_runner.py:36] Average training steps per second: 185.84
I0901 12:57:45.105883 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:57:45.303772 140196630247424 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 190.65
I0901 12:57:50.549219 140196630247424 replay_runner.py:36] Average training steps per second: 190.65
I0901 12:57:50.696119 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:57:50.893151 140196630247424 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 186.57
I0901 12:57:56.253581 140196630247424 replay_runner.py:36] Average training steps per second: 186.57
I0901 12:57:56.392941 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 320 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 185.77
I0901 12:58:01.975758 140196630247424 replay_runner.py:36] Average training steps per second: 185.77
I0901 12:58:02.208213 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.30
I0901 12:58:07.623692 140196630247424 replay_runner.py:36] Average training steps per second: 191.30
I0901 12:58:07.764551 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:58:07.959731 140196630247424 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 187.17
I0901 12:58:13.302825 140196630247424 replay_runner.py:36] Average training steps per second: 187.17
I0901 12:58:13.449834 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 339 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 189.89
I0901 12:58:18.915852 140196630247424 replay_runner.py:36] Average training steps per second: 189.89
I0901 12:58:19.164928 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.04
I0901 12:58:24.569911 140196630247424 replay_runner.py:36] Average training steps per second: 192.04
I0901 12:58:24.711641 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00