I0902 17:41:25.599051 139685444462592 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 17:41:25.599778 139685444462592 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 17:41:25.855330 139685444462592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:25.857120 139685444462592 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:25.857423 139685444462592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:25.857553 139685444462592 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:25.857656 139685444462592 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:25.857752 139685444462592 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:25.857851 139685444462592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:25.857995 139685444462592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:25.858093 139685444462592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:25.858185 139685444462592 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:25.858280 139685444462592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:25.858384 139685444462592 dqn_agent.py:283] 	 seed: 1630604485855242
I0902 17:41:25.861311 139685444462592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:25.861498 139685444462592 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:25.861642 139685444462592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:25.861842 139685444462592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:25.861961 139685444462592 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:25.862065 139685444462592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:25.862168 139685444462592 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:25.862266 139685444462592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:25.862373 139685444462592 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 17:41:28.363944 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.746078 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.755018 139685444462592 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:41:28.760950 139685444462592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:28.761130 139685444462592 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:28.761337 139685444462592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:28.761435 139685444462592 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:28.761544 139685444462592 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:28.761631 139685444462592 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:28.761689 139685444462592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:28.761770 139685444462592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:28.761836 139685444462592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:28.761909 139685444462592 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:28.761982 139685444462592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:28.762137 139685444462592 dqn_agent.py:283] 	 seed: 1630604488760908
I0902 17:41:28.763531 139685444462592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:28.763642 139685444462592 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:28.763746 139685444462592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:28.763815 139685444462592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:28.763875 139685444462592 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:28.763937 139685444462592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:28.764006 139685444462592 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:28.764082 139685444462592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:28.764156 139685444462592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:28.782175 139685444462592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.793121 139685444462592 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:41:28.793276 139685444462592 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 168.74
I0902 17:41:34.719669 139685444462592 replay_runner.py:36] Average training steps per second: 168.74
Steps executed: 213 Episode length: 133 Return: -844.7901403214711
I0902 17:41:35.568818 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.70
INFO:tensorflow:Starting iteration 1

Steps executed: 271 Episode length: 72 Return: -557.34027682892166
INFO:tensorflow:Average training steps per second: 214.06
I0902 17:41:44.482403 139685444462592 replay_runner.py:36] Average training steps per second: 214.06
I0902 17:41:44.726187 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -643.29
INFO:tensorflow:Starting iteration 2

Steps executed: 256 Episode length: 98 Return: -732.79107131460317
INFO:tensorflow:Average training steps per second: 210.58
I0902 17:41:53.607972 139685444462592 replay_runner.py:36] Average training steps per second: 210.58
I0902 17:41:53.806459 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.63
INFO:tensorflow:Starting iteration 3

Steps executed: 254 Episode length: 72 Return: -524.06202322762347
INFO:tensorflow:Average training steps per second: 212.59
I0902 17:42:02.713657 139685444462592 replay_runner.py:36] Average training steps per second: 212.59
I0902 17:42:02.934449 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.49
INFO:tensorflow:Starting iteration 4

Steps executed: 294 Episode length: 98 Return: -720.64354529947678
INFO:tensorflow:Average training steps per second: 214.38
I0902 17:42:11.831597 139685444462592 replay_runner.py:36] Average training steps per second: 214.38
I0902 17:42:12.066663 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.74
INFO:tensorflow:Starting iteration 5

Steps executed: 262 Episode length: 90 Return: -572.01244590378548
INFO:tensorflow:Average training steps per second: 214.51
I0902 17:42:20.994557 139685444462592 replay_runner.py:36] Average training steps per second: 214.51
I0902 17:42:21.223202 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -606.41
INFO:tensorflow:Starting iteration 6

Steps executed: 269 Episode length: 95 Return: -697.44808627431388
INFO:tensorflow:Average training steps per second: 217.29
I0902 17:42:30.046510 139685444462592 replay_runner.py:36] Average training steps per second: 217.29
I0902 17:42:30.288142 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.75
INFO:tensorflow:Starting iteration 7

Steps executed: 94 Episode length: 94 Return: -694.253655582383388
INFO:tensorflow:Average training steps per second: 211.12
I0902 17:42:39.237686 139685444462592 replay_runner.py:36] Average training steps per second: 211.12

Steps executed: 291 Episode length: 100 Return: -641.1225541354382
INFO:tensorflow:Starting iteration 8

Steps executed: 233 Episode length: 93 Return: -601.26668322879032
INFO:tensorflow:Average training steps per second: 216.06
I0902 17:42:48.342044 139685444462592 replay_runner.py:36] Average training steps per second: 216.06
I0902 17:42:48.543594 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.33
INFO:tensorflow:Starting iteration 9
I0902 17:42:52.791671 139685444462592 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 217.15
I0902 17:42:57.397094 139685444462592 replay_runner.py:36] Average training steps per second: 217.15

Steps executed: 204 Episode length: 116 Return: -681.5341025114424
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 93 Return: -688.99613365918911
INFO:tensorflow:Average training steps per second: 218.54
I0902 17:43:06.389192 139685444462592 replay_runner.py:36] Average training steps per second: 218.54
I0902 17:43:06.583889 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.33
INFO:tensorflow:Starting iteration 11

Steps executed: 86 Episode length: 86 Return: -612.389416979514711
INFO:tensorflow:Average training steps per second: 217.44
I0902 17:43:15.383295 139685444462592 replay_runner.py:36] Average training steps per second: 217.44

Steps executed: 245 Episode length: 95 Return: -687.21403800596346
INFO:tensorflow:Starting iteration 12

Steps executed: 204 Episode length: 83 Return: -600.16934655047434
INFO:tensorflow:Average training steps per second: 217.02
I0902 17:43:24.419118 139685444462592 replay_runner.py:36] Average training steps per second: 217.02
I0902 17:43:24.573055 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.00
INFO:tensorflow:Starting iteration 13

Steps executed: 82 Episode length: 82 Return: -640.814606598013434
INFO:tensorflow:Average training steps per second: 215.27
I0902 17:43:33.470021 139685444462592 replay_runner.py:36] Average training steps per second: 215.27

Steps executed: 274 Episode length: 97 Return: -722.24863227085034
INFO:tensorflow:Starting iteration 14

Steps executed: 231 Episode length: 87 Return: -688.21789343617243
INFO:tensorflow:Average training steps per second: 217.54
I0902 17:43:42.478068 139685444462592 replay_runner.py:36] Average training steps per second: 217.54
I0902 17:43:42.682320 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.41
INFO:tensorflow:Starting iteration 15

Steps executed: 185 Episode length: 96 Return: -689.19054860820153
INFO:tensorflow:Average training steps per second: 214.41
I0902 17:43:51.398831 139685444462592 replay_runner.py:36] Average training steps per second: 214.41

Steps executed: 297 Episode length: 112 Return: -552.1982235876502
INFO:tensorflow:Starting iteration 16

Steps executed: 213 Episode length: 54 Return: -90.949395707893442
INFO:tensorflow:Average training steps per second: 217.87
I0902 17:44:00.537909 139685444462592 replay_runner.py:36] Average training steps per second: 217.87
I0902 17:44:00.704430 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.24
INFO:tensorflow:Starting iteration 17

Steps executed: 256 Episode length: 70 Return: -606.05508763640992
INFO:tensorflow:Average training steps per second: 214.96
I0902 17:44:09.484426 139685444462592 replay_runner.py:36] Average training steps per second: 214.96
I0902 17:44:09.714843 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -641.68
INFO:tensorflow:Starting iteration 18
I0902 17:44:13.710483 139685444462592 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 241.67

Steps executed: 245 Episode length: 99 Return: -688.14519919040272
I0902 17:44:18.095866 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -604.78
INFO:tensorflow:Starting iteration 19

Steps executed: 243 Episode length: 64 Return: -131.85458334561395
INFO:tensorflow:Average training steps per second: 262.34
I0902 17:44:25.568855 139685444462592 replay_runner.py:36] Average training steps per second: 262.34
I0902 17:44:25.731653 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.27
INFO:tensorflow:Starting iteration 20

Steps executed: 244 Episode length: 70 Return: -506.96621569232707
INFO:tensorflow:Average training steps per second: 244.13
I0902 17:44:33.996666 139685444462592 replay_runner.py:36] Average training steps per second: 244.13
I0902 17:44:34.208943 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -606.94
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 95 Return: -666.03421777632837
INFO:tensorflow:Average training steps per second: 227.64
I0902 17:44:42.881850 139685444462592 replay_runner.py:36] Average training steps per second: 227.64
I0902 17:44:43.088864 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.12
INFO:tensorflow:Starting iteration 22

Steps executed: 276 Episode length: 89 Return: -490.70295720210427
INFO:tensorflow:Average training steps per second: 216.40
I0902 17:44:52.054791 139685444462592 replay_runner.py:36] Average training steps per second: 216.40
I0902 17:44:52.320019 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -622.21
INFO:tensorflow:Starting iteration 23

Steps executed: 258 Episode length: 64 Return: -594.66729472914812
INFO:tensorflow:Average training steps per second: 220.73
I0902 17:45:01.081138 139685444462592 replay_runner.py:36] Average training steps per second: 220.73
I0902 17:45:01.296964 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.31
INFO:tensorflow:Starting iteration 24

Steps executed: 232 Episode length: 84 Return: -683.70227170761432
INFO:tensorflow:Average training steps per second: 221.87
I0902 17:45:09.927131 139685444462592 replay_runner.py:36] Average training steps per second: 221.87
I0902 17:45:10.116798 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.50
INFO:tensorflow:Starting iteration 25

Steps executed: 243 Episode length: 77 Return: -536.17766065591742
INFO:tensorflow:Average training steps per second: 222.51
I0902 17:45:18.824777 139685444462592 replay_runner.py:36] Average training steps per second: 222.51
I0902 17:45:19.052159 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.58
INFO:tensorflow:Starting iteration 26

Steps executed: 221 Episode length: 117 Return: -616.2528778685999
INFO:tensorflow:Average training steps per second: 218.50
I0902 17:45:27.922522 139685444462592 replay_runner.py:36] Average training steps per second: 218.50
I0902 17:45:28.139322 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -603.58
INFO:tensorflow:Starting iteration 27

Steps executed: 227 Episode length: 74 Return: -625.59105835516389
INFO:tensorflow:Average training steps per second: 219.03
I0902 17:45:36.980612 139685444462592 replay_runner.py:36] Average training steps per second: 219.03
I0902 17:45:37.182521 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.07
INFO:tensorflow:Starting iteration 28

Steps executed: 221 Episode length: 77 Return: -542.51938634809389
INFO:tensorflow:Average training steps per second: 217.84
I0902 17:45:46.138978 139685444462592 replay_runner.py:36] Average training steps per second: 217.84
I0902 17:45:46.348391 139685444462592 run_experiment.py:428] Average undiscounted return per evaluation episode: -570.92
INFO:tensorflow:Starting iteration 29

Steps executed: 208 Episode length: 114 Return: -593.6392553538831
INFO:tensorflow:Average training steps per second: 220.82
I0902 17:45:55.208111 139685444462592 replay_runner.py:36] Average training steps per second: 220.82

Done fixed training!Episode length: 114 Return: -593.6392553538831