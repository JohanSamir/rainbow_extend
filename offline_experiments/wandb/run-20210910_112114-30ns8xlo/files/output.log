I0910 11:21:20.400981 140322240079872 run_experiment.py:549] Creating TrainRunner ...
I0910 11:21:20.407421 140322240079872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:20.407551 140322240079872 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:20.407629 140322240079872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:20.407690 140322240079872 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:20.407747 140322240079872 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:20.407832 140322240079872 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:20.407889 140322240079872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:20.407984 140322240079872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:20.408058 140322240079872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:20.408149 140322240079872 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:20.408202 140322240079872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:20.408253 140322240079872 dqn_agent.py:283] 	 seed: 1631272880407386
I0910 11:21:20.409956 140322240079872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:20.410068 140322240079872 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:20.410145 140322240079872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:20.410208 140322240079872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:20.410266 140322240079872 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:20.410342 140322240079872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:20.410452 140322240079872 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:20.410507 140322240079872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:20.410560 140322240079872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:20.433434 140322240079872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:20.452851 140322240079872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:20.453044 140322240079872 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:20.453123 140322240079872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:20.453226 140322240079872 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:20.453349 140322240079872 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:20.453458 140322240079872 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:20.453538 140322240079872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:20.453661 140322240079872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:20.453765 140322240079872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:20.453848 140322240079872 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:20.453985 140322240079872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:20.454069 140322240079872 dqn_agent.py:283] 	 seed: 1631272880452793
I0910 11:21:20.456161 140322240079872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:20.456341 140322240079872 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:20.456434 140322240079872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:20.456518 140322240079872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:20.456668 140322240079872 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:20.456750 140322240079872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:20.456878 140322240079872 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:20.456997 140322240079872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:20.457069 140322240079872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:20.486044 140322240079872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:20.507532 140322240079872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:21:20.507749 140322240079872 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 683445.33
I0910 11:21:20.509428 140322240079872 replay_runner.py:39] Average training steps per second: 683445.33
I0910 11:21:21.313700 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:21:21.405332 140322240079872 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 786481.16
I0910 11:21:21.406866 140322240079872 replay_runner.py:39] Average training steps per second: 786481.16
I0910 11:21:21.613720 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:21:21.700015 140322240079872 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 781935.87
I0910 11:21:21.701525 140322240079872 replay_runner.py:39] Average training steps per second: 781935.87
I0910 11:21:21.901122 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Loaded trained dqn in mountaincar
Training fixed agent 9, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 3
I0910 11:21:21.991926 140322240079872 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 830226.44
I0910 11:21:21.993486 140322240079872 replay_runner.py:39] Average training steps per second: 830226.44
I0910 11:21:22.173567 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:21:22.325925 140322240079872 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 719805.05
I0910 11:21:22.327552 140322240079872 replay_runner.py:39] Average training steps per second: 719805.05
I0910 11:21:22.546558 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:21:22.634237 140322240079872 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 815219.44
I0910 11:21:22.635732 140322240079872 replay_runner.py:39] Average training steps per second: 815219.44
I0910 11:21:22.827282 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:21:22.919886 140322240079872 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 784275.24
I0910 11:21:22.921404 140322240079872 replay_runner.py:39] Average training steps per second: 784275.24
I0910 11:21:23.130856 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:21:23.220720 140322240079872 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 833029.59
I0910 11:21:23.222187 140322240079872 replay_runner.py:39] Average training steps per second: 833029.59
I0910 11:21:23.453522 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:21:23.543474 140322240079872 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 809242.52
I0910 11:21:23.544975 140322240079872 replay_runner.py:39] Average training steps per second: 809242.52
I0910 11:21:23.774812 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:21:23.880841 140322240079872 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 434913.31
I0910 11:21:23.883455 140322240079872 replay_runner.py:39] Average training steps per second: 434913.31
I0910 11:21:24.097975 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:21:24.185665 140322240079872 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 814744.37
I0910 11:21:24.187132 140322240079872 replay_runner.py:39] Average training steps per second: 814744.37
I0910 11:21:24.357659 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:21:24.449997 140322240079872 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 814902.66
I0910 11:21:24.451455 140322240079872 replay_runner.py:39] Average training steps per second: 814902.66
I0910 11:21:24.631588 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:21:24.719864 140322240079872 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 807373.24
I0910 11:21:24.721326 140322240079872 replay_runner.py:39] Average training steps per second: 807373.24
I0910 11:21:24.897426 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:21:24.991564 140322240079872 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 734940.25
I0910 11:21:24.993281 140322240079872 replay_runner.py:39] Average training steps per second: 734940.25
I0910 11:21:25.206460 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:21:25.315191 140322240079872 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 714775.73
I0910 11:21:25.316843 140322240079872 replay_runner.py:39] Average training steps per second: 714775.73
I0910 11:21:25.530482 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:21:25.654505 140322240079872 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 828750.05
I0910 11:21:25.655942 140322240079872 replay_runner.py:39] Average training steps per second: 828750.05
I0910 11:21:25.904187 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:21:25.992179 140322240079872 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 840710.36
I0910 11:21:25.993629 140322240079872 replay_runner.py:39] Average training steps per second: 840710.36
I0910 11:21:26.171482 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:21:26.257539 140322240079872 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 806907.27
I0910 11:21:26.258997 140322240079872 replay_runner.py:39] Average training steps per second: 806907.27
I0910 11:21:26.427666 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:21:26.517395 140322240079872 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 793474.08
I0910 11:21:26.518895 140322240079872 replay_runner.py:39] Average training steps per second: 793474.08
I0910 11:21:26.700889 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:21:26.784181 140322240079872 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 858257.42
I0910 11:21:26.785651 140322240079872 replay_runner.py:39] Average training steps per second: 858257.42
I0910 11:21:26.952935 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:21:27.039202 140322240079872 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 801204.20
I0910 11:21:27.040705 140322240079872 replay_runner.py:39] Average training steps per second: 801204.20
I0910 11:21:27.204774 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:21:27.287861 140322240079872 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 795883.11
I0910 11:21:27.289392 140322240079872 replay_runner.py:39] Average training steps per second: 795883.11
I0910 11:21:27.452604 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:21:27.562107 140322240079872 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 342587.93
I0910 11:21:27.565560 140322240079872 replay_runner.py:39] Average training steps per second: 342587.93
I0910 11:21:27.761337 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:21:27.842920 140322240079872 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 844264.09

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:21:28.004206 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:21:28.083888 140322240079872 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 799371.83
I0910 11:21:28.085338 140322240079872 replay_runner.py:39] Average training steps per second: 799371.83
I0910 11:21:28.242594 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:21:28.320876 140322240079872 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 950873.72
I0910 11:21:28.322122 140322240079872 replay_runner.py:39] Average training steps per second: 950873.72
I0910 11:21:28.488075 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:21:28.566043 140322240079872 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 830062.14
I0910 11:21:28.567462 140322240079872 replay_runner.py:39] Average training steps per second: 830062.14
I0910 11:21:28.727414 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:21:28.804930 140322240079872 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 972028.74
I0910 11:21:28.806161 140322240079872 replay_runner.py:39] Average training steps per second: 972028.74
I0910 11:21:28.962329 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:21:29.041872 140322240079872 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 909827.33
I0910 11:21:29.043169 140322240079872 replay_runner.py:39] Average training steps per second: 909827.33
I0910 11:21:29.196447 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:21:29.277815 140322240079872 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 417302.16
I0910 11:21:29.280442 140322240079872 replay_runner.py:39] Average training steps per second: 417302.16
I0910 11:21:29.432426 140322240079872 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00