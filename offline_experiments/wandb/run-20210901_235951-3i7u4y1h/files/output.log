Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0901 23:59:57.963484 139636266051584 run_experiment.py:549] Creating TrainRunner ...
I0901 23:59:57.972189 139636266051584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:57.972510 139636266051584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:57.972749 139636266051584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:57.972849 139636266051584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:57.972945 139636266051584 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:57.973082 139636266051584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:57.973176 139636266051584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:57.973453 139636266051584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:57.973619 139636266051584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:57.973780 139636266051584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:57.974027 139636266051584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:57.974153 139636266051584 dqn_agent.py:283] 	 seed: 1630540797972114
I0901 23:59:57.976692 139636266051584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:57.976832 139636266051584 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:59:57.976922 139636266051584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:57.976995 139636266051584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:57.977059 139636266051584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:57.977121 139636266051584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:57.977211 139636266051584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:57.977273 139636266051584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:57.977391 139636266051584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:58.014681 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:58.423495 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:58.438564 139636266051584 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:59:58.470778 139636266051584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:59:58.471022 139636266051584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:59:58.471165 139636266051584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:59:58.471288 139636266051584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:59:58.471445 139636266051584 dqn_agent.py:275] 	 update_period: 4
I0901 23:59:58.471569 139636266051584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:59:58.471637 139636266051584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:59:58.471805 139636266051584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:59:58.471957 139636266051584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:59:58.472115 139636266051584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:59:58.472215 139636266051584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:59:58.472367 139636266051584 dqn_agent.py:283] 	 seed: 1630540798470713
I0901 23:59:58.474581 139636266051584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:59:58.474799 139636266051584 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:59:58.474943 139636266051584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:59:58.475075 139636266051584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:59:58.475174 139636266051584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:59:58.475304 139636266051584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:59:58.475500 139636266051584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:59:58.475595 139636266051584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:59:58.475666 139636266051584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:59:58.507310 139636266051584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:59:58.528831 139636266051584 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:59:58.529049 139636266051584 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 142.41
I0902 00:00:05.551296 139636266051584 replay_runner.py:36] Average training steps per second: 142.41
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:00:07.041043 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 395 Episode length: 395 Return: -394.0
INFO:tensorflow:Average training steps per second: 194.89
I0902 00:00:12.402719 139636266051584 replay_runner.py:36] Average training steps per second: 194.89
I0902 00:00:12.714861 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.13
I0902 00:00:18.000887 139636266051584 replay_runner.py:36] Average training steps per second: 198.13
I0902 00:00:18.409740 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 232 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 196.15
I0902 00:00:23.740655 139636266051584 replay_runner.py:36] Average training steps per second: 196.15
I0902 00:00:23.937630 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 4

Steps executed: 273 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 197.99
I0902 00:00:29.226495 139636266051584 replay_runner.py:36] Average training steps per second: 197.99
I0902 00:00:29.454601 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.30
I0902 00:00:34.816065 139636266051584 replay_runner.py:36] Average training steps per second: 195.30
I0902 00:00:35.234938 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 00:00:35.480062 139636266051584 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 200.05
I0902 00:00:40.479103 139636266051584 replay_runner.py:36] Average training steps per second: 200.05
I0902 00:00:40.716862 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 7


Steps executed: 206 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 191.69
I0902 00:00:46.182393 139636266051584 replay_runner.py:36] Average training steps per second: 191.69
I0902 00:00:46.350469 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 8
I0902 00:00:46.589287 139636266051584 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.34

Steps executed: 678 Episode length: 500 Return: -500.0
I0902 00:00:52.309352 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.33
INFO:tensorflow:Starting iteration 9
I0902 00:00:52.554399 139636266051584 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 195.00

Steps executed: 342 Episode length: 342 Return: -341.0
I0902 00:00:57.973931 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.66
I0902 00:01:03.307496 139636266051584 replay_runner.py:36] Average training steps per second: 196.66
I0902 00:01:03.739242 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 00:01:03.980011 139636266051584 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 194.23
I0902 00:01:09.129041 139636266051584 replay_runner.py:36] Average training steps per second: 194.23
I0902 00:01:09.537549 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 267 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 195.39
I0902 00:01:14.895666 139636266051584 replay_runner.py:36] Average training steps per second: 195.39
I0902 00:01:15.113439 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 13

Steps executed: 265 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 192.58
I0902 00:01:20.556971 139636266051584 replay_runner.py:36] Average training steps per second: 192.58
I0902 00:01:20.778009 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.50
INFO:tensorflow:Starting iteration 14

Steps executed: 72 Episode length: 72 Return: -71.07.0
INFO:tensorflow:Average training steps per second: 200.75

Steps executed: 258 Episode length: 106 Return: -105.0
I0902 00:01:26.205118 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 15

Steps executed: 217 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 200.55
I0902 00:01:31.440335 139636266051584 replay_runner.py:36] Average training steps per second: 200.55
I0902 00:01:31.617567 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.33
INFO:tensorflow:Starting iteration 16

Steps executed: 224 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 196.57
I0902 00:01:36.941335 139636266051584 replay_runner.py:36] Average training steps per second: 196.57
I0902 00:01:37.136372 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 17

Steps executed: 273 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 198.29
I0902 00:01:42.413671 139636266051584 replay_runner.py:36] Average training steps per second: 198.29
I0902 00:01:42.626254 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 18

Steps executed: 233 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 199.33
I0902 00:01:47.872971 139636266051584 replay_runner.py:36] Average training steps per second: 199.33
I0902 00:01:48.058141 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 19

Steps executed: 252 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 201.11
I0902 00:01:53.256101 139636266051584 replay_runner.py:36] Average training steps per second: 201.11
I0902 00:01:53.450341 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 20

Steps executed: 300 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 198.59
I0902 00:01:58.717962 139636266051584 replay_runner.py:36] Average training steps per second: 198.59
I0902 00:01:58.971178 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 21

Steps executed: 259 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 200.86
I0902 00:02:04.190274 139636266051584 replay_runner.py:36] Average training steps per second: 200.86
I0902 00:02:04.400427 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 22

Steps executed: 243 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 190.88
I0902 00:02:09.877759 139636266051584 replay_runner.py:36] Average training steps per second: 190.88
I0902 00:02:10.070382 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 200.98
I0902 00:02:15.285259 139636266051584 replay_runner.py:36] Average training steps per second: 200.98
I0902 00:02:15.467800 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 24

Steps executed: 242 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 194.96
I0902 00:02:20.839004 139636266051584 replay_runner.py:36] Average training steps per second: 194.96
I0902 00:02:21.039629 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 25

Steps executed: 208 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 203.55
I0902 00:02:26.193544 139636266051584 replay_runner.py:36] Average training steps per second: 203.55
I0902 00:02:26.373148 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 26

Steps executed: 264 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 192.01
I0902 00:02:31.825797 139636266051584 replay_runner.py:36] Average training steps per second: 192.01
I0902 00:02:32.033018 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 27

Steps executed: 235 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 209.11
I0902 00:02:37.256877 139636266051584 replay_runner.py:36] Average training steps per second: 209.11
I0902 00:02:37.467780 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 28

Steps executed: 258 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 202.67
I0902 00:02:42.654323 139636266051584 replay_runner.py:36] Average training steps per second: 202.67
I0902 00:02:42.845687 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 213.77
I0902 00:02:47.748386 139636266051584 replay_runner.py:36] Average training steps per second: 213.77
I0902 00:02:47.927201 139636266051584 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33