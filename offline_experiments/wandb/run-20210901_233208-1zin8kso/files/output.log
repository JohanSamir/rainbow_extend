Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0901 23:32:14.864273 140437416843264 run_experiment.py:549] Creating TrainRunner ...
I0901 23:32:14.870913 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:32:14.871071 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:32:14.871155 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:32:14.871223 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:32:14.871286 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:32:14.871349 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:32:14.871430 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:32:14.871534 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:32:14.871615 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:32:14.871676 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:32:14.871757 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:32:14.871831 140437416843264 dqn_agent.py:283] 	 seed: 1630539134870872
I0901 23:32:14.873676 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:32:14.873807 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:32:14.873896 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:32:14.873967 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:32:14.874050 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:32:14.874347 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:32:14.874675 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:32:14.874846 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:32:14.874977 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:32:14.905699 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:15.505411 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:15.521969 140437416843264 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:32:15.531220 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:32:15.531517 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:32:15.531649 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:32:15.531763 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:32:15.532031 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:32:15.532208 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:32:15.532365 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:32:15.532561 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:32:15.532701 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:32:15.532797 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:32:15.532902 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:32:15.532994 140437416843264 dqn_agent.py:283] 	 seed: 1630539135531159
I0901 23:32:15.535207 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:32:15.535327 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:32:15.535399 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:32:15.535466 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:32:15.535540 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:32:15.535637 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:32:15.535717 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:32:15.535790 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:32:15.535875 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:32:15.557773 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:32:15.574801 140437416843264 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:32:15.575059 140437416843264 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 158.17
I0901 23:32:21.897981 140437416843264 replay_runner.py:36] Average training steps per second: 158.17
Steps executed: 203 Episode length: 9 Return: 9.0.0
I0901 23:32:22.887372 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.67
INFO:tensorflow:Starting iteration 1
I0901 23:32:23.064407 140437416843264 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 201.27
I0901 23:32:28.033409 140437416843264 replay_runner.py:36] Average training steps per second: 201.27
I0901 23:32:28.176299 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.81
INFO:tensorflow:Starting iteration 2

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 186.78
I0901 23:32:33.718053 140437416843264 replay_runner.py:36] Average training steps per second: 186.78
I0901 23:32:33.958346 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.96
INFO:tensorflow:Starting iteration 3
I0901 23:32:34.207450 140437416843264 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 189.06
I0901 23:32:39.497256 140437416843264 replay_runner.py:36] Average training steps per second: 189.06
I0901 23:32:39.640636 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 4

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.21
I0901 23:32:44.875211 140437416843264 replay_runner.py:36] Average training steps per second: 198.21
I0901 23:32:45.005657 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 5

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 193.82
I0901 23:32:50.346733 140437416843264 replay_runner.py:36] Average training steps per second: 193.82
I0901 23:32:50.486774 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 6


Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 205.99
I0901 23:32:55.525860 140437416843264 replay_runner.py:36] Average training steps per second: 205.99
I0901 23:32:55.670808 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.71
INFO:tensorflow:Starting iteration 7
I0901 23:32:55.858744 140437416843264 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 197.67

Steps executed: 69 Episode length: 9 Return: 9.0.00
I0901 23:33:01.058373 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.71
INFO:tensorflow:Starting iteration 8

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 199.68
I0901 23:33:06.248648 140437416843264 replay_runner.py:36] Average training steps per second: 199.68
I0901 23:33:06.387448 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 9

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.35
I0901 23:33:11.672861 140437416843264 replay_runner.py:36] Average training steps per second: 196.35
I0901 23:33:11.805699 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.71
INFO:tensorflow:Starting iteration 10
I0901 23:33:11.990212 140437416843264 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 205.82
I0901 23:33:16.849560 140437416843264 replay_runner.py:36] Average training steps per second: 205.82
I0901 23:33:16.982409 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 11

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.74
I0901 23:33:22.289935 140437416843264 replay_runner.py:36] Average training steps per second: 195.74
I0901 23:33:22.420763 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 12

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 201.07
I0901 23:33:27.574898 140437416843264 replay_runner.py:36] Average training steps per second: 201.07
I0901 23:33:27.727124 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 13
I0901 23:33:27.929286 140437416843264 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 197.97
I0901 23:33:32.981367 140437416843264 replay_runner.py:36] Average training steps per second: 197.97
I0901 23:33:33.132301 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 14

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.32
I0901 23:33:38.493167 140437416843264 replay_runner.py:36] Average training steps per second: 194.32
I0901 23:33:38.634060 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 15


Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 199.67
I0901 23:33:43.835986 140437416843264 replay_runner.py:36] Average training steps per second: 199.67
I0901 23:33:43.981568 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 16

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.14
I0901 23:33:49.248558 140437416843264 replay_runner.py:36] Average training steps per second: 197.14
I0901 23:33:49.388412 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 17

Steps executed: 205 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 200.35
I0901 23:33:54.573832 140437416843264 replay_runner.py:36] Average training steps per second: 200.35
I0901 23:33:54.719671 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 18
I0901 23:33:54.911422 140437416843264 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 195.30
I0901 23:34:00.032231 140437416843264 replay_runner.py:36] Average training steps per second: 195.30
I0901 23:34:00.176005 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 19


Steps executed: 204 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 199.42
I0901 23:34:05.374918 140437416843264 replay_runner.py:36] Average training steps per second: 199.42
I0901 23:34:05.524490 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 20
I0901 23:34:05.721180 140437416843264 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.26
I0901 23:34:10.740229 140437416843264 replay_runner.py:36] Average training steps per second: 199.26
I0901 23:34:10.881896 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 199.42
I0901 23:34:16.084751 140437416843264 replay_runner.py:36] Average training steps per second: 199.42
I0901 23:34:16.222754 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 22


Steps executed: 57 Episode length: 8 Return: 8.0.00
INFO:tensorflow:Average training steps per second: 203.21
I0901 23:34:21.345786 140437416843264 replay_runner.py:36] Average training steps per second: 203.21
I0901 23:34:21.481095 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 23

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 198.37
I0901 23:34:26.698547 140437416843264 replay_runner.py:36] Average training steps per second: 198.37
I0901 23:34:26.834986 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 24

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 206.47
I0901 23:34:31.860018 140437416843264 replay_runner.py:36] Average training steps per second: 206.47
I0901 23:34:31.979630 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 25

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 200.20
I0901 23:34:37.157416 140437416843264 replay_runner.py:36] Average training steps per second: 200.20
I0901 23:34:37.310641 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.55
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 199.98
I0901 23:34:42.528961 140437416843264 replay_runner.py:36] Average training steps per second: 199.98
I0901 23:34:42.675940 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.13
I0901 23:34:47.943114 140437416843264 replay_runner.py:36] Average training steps per second: 197.13
I0901 23:34:48.079512 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 28

Steps executed: 206 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 196.56
I0901 23:34:53.355160 140437416843264 replay_runner.py:36] Average training steps per second: 196.56
I0901 23:34:53.502597 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 29

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.85
I0901 23:34:58.863577 140437416843264 replay_runner.py:36] Average training steps per second: 193.85

Done fixed training!Episode length: 9 Return: 9.0.0