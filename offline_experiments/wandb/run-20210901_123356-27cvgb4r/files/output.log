Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:34:03.223795 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:03.234278 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:03.234573 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:03.234822 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:03.235072 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:03.235209 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:03.235328 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:03.235446 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:03.235664 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:03.235803 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:03.235918 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:03.236098 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:03.236229 140635665344512 dqn_agent.py:283] 	 seed: 1630499643234214
I0901 12:34:03.239819 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:03.240036 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:34:03.240186 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:03.240364 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:03.240589 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:03.240711 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:03.240948 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:03.241107 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:03.241240 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:03.289693 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:03.939717 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:03.953882 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:03.964019 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:03.964333 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:03.964669 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:03.964854 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:03.965105 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:03.965298 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:03.965419 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:03.965535 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:03.965654 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:03.965763 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:03.965890 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:03.966007 140635665344512 dqn_agent.py:283] 	 seed: 1630499643963957
I0901 12:34:03.968699 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:03.968898 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:34:03.969027 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:03.969223 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:03.969388 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:03.969536 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:03.969669 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:03.969751 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:03.969823 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:04.034782 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:04.085913 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:04.086447 140635665344512 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 146.32
I0901 12:34:10.921468 140635665344512 replay_runner.py:36] Average training steps per second: 146.32
I0901 12:34:12.219451 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 192.56
I0901 12:34:17.600204 140635665344512 replay_runner.py:36] Average training steps per second: 192.56
I0901 12:34:17.751989 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 2

Steps executed: 253 Episode length: 61 Return: 61.0
INFO:tensorflow:Average training steps per second: 188.53
I0901 12:34:23.241657 140635665344512 replay_runner.py:36] Average training steps per second: 188.53
I0901 12:34:23.443053 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 63.25
INFO:tensorflow:Starting iteration 3

Steps executed: 197 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.75
I0901 12:34:28.770838 140635665344512 replay_runner.py:36] Average training steps per second: 194.75

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Starting iteration 4

Steps executed: 207 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 203.61
I0901 12:34:34.065235 140635665344512 replay_runner.py:36] Average training steps per second: 203.61
I0901 12:34:34.216076 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 195.88
I0901 12:34:39.503870 140635665344512 replay_runner.py:36] Average training steps per second: 195.88
I0901 12:34:39.642315 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 6

Steps executed: 125 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 193.47
I0901 12:34:44.998649 140635665344512 replay_runner.py:36] Average training steps per second: 193.47

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.63
I0901 12:34:50.415283 140635665344512 replay_runner.py:36] Average training steps per second: 197.63
I0901 12:34:50.551531 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 8

Steps executed: 226 Episode length: 73 Return: 73.0
INFO:tensorflow:Average training steps per second: 187.45
I0901 12:34:56.072409 140635665344512 replay_runner.py:36] Average training steps per second: 187.45
I0901 12:34:56.238217 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 75.33
INFO:tensorflow:Starting iteration 9

Steps executed: 211 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 191.15
I0901 12:35:01.666565 140635665344512 replay_runner.py:36] Average training steps per second: 191.15
I0901 12:35:01.825664 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.19
INFO:tensorflow:Starting iteration 10

Steps executed: 220 Episode length: 52 Return: 52.0
INFO:tensorflow:Average training steps per second: 181.68
I0901 12:35:07.523249 140635665344512 replay_runner.py:36] Average training steps per second: 181.68
I0901 12:35:07.685679 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 55.00
INFO:tensorflow:Starting iteration 11

Steps executed: 111 Episode length: 111 Return: 111.0
INFO:tensorflow:Average training steps per second: 187.50
I0901 12:35:13.213922 140635665344512 replay_runner.py:36] Average training steps per second: 187.50

Steps executed: 229 Episode length: 118 Return: 118.0
INFO:tensorflow:Starting iteration 12

Steps executed: 228 Episode length: 56 Return: 56.0.0
INFO:tensorflow:Average training steps per second: 181.05
I0901 12:35:19.136849 140635665344512 replay_runner.py:36] Average training steps per second: 181.05
I0901 12:35:19.305075 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 57.00
INFO:tensorflow:Starting iteration 13

Steps executed: 222 Episode length: 35 Return: 35.0.0
INFO:tensorflow:Average training steps per second: 182.80
I0901 12:35:24.969317 140635665344512 replay_runner.py:36] Average training steps per second: 182.80
I0901 12:35:25.150601 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 37.00
INFO:tensorflow:Starting iteration 14

Steps executed: 235 Episode length: 48 Return: 48.0.0
INFO:tensorflow:Average training steps per second: 185.40
I0901 12:35:30.749742 140635665344512 replay_runner.py:36] Average training steps per second: 185.40
I0901 12:35:30.941375 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.00
INFO:tensorflow:Starting iteration 15

Steps executed: 252 Episode length: 55 Return: 55.0.0
INFO:tensorflow:Average training steps per second: 181.77
I0901 12:35:36.633114 140635665344512 replay_runner.py:36] Average training steps per second: 181.77
I0901 12:35:36.822997 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.40
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 34 Return: 34.0.0
INFO:tensorflow:Average training steps per second: 188.16
I0901 12:35:42.320429 140635665344512 replay_runner.py:36] Average training steps per second: 188.16
I0901 12:35:42.484063 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.33
INFO:tensorflow:Starting iteration 17

Steps executed: 206 Episode length: 24 Return: 24.0.0
INFO:tensorflow:Average training steps per second: 181.83
I0901 12:35:48.174021 140635665344512 replay_runner.py:36] Average training steps per second: 181.83
I0901 12:35:48.336243 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.60
INFO:tensorflow:Starting iteration 18

Steps executed: 240 Episode length: 46 Return: 46.0.0
INFO:tensorflow:Average training steps per second: 181.90
I0901 12:35:54.030627 140635665344512 replay_runner.py:36] Average training steps per second: 181.90
I0901 12:35:54.226941 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 48.00
INFO:tensorflow:Starting iteration 19

Steps executed: 213 Episode length: 15 Return: 15.0.0
INFO:tensorflow:Average training steps per second: 190.52
I0901 12:35:59.687478 140635665344512 replay_runner.py:36] Average training steps per second: 190.52
I0901 12:35:59.865746 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.38
INFO:tensorflow:Starting iteration 20

Steps executed: 212 Episode length: 35 Return: 35.0.0
INFO:tensorflow:Average training steps per second: 180.41
I0901 12:36:05.592857 140635665344512 replay_runner.py:36] Average training steps per second: 180.41
I0901 12:36:05.757210 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 35.33
INFO:tensorflow:Starting iteration 21

Steps executed: 232 Episode length: 33 Return: 33.0.0
INFO:tensorflow:Average training steps per second: 183.46
I0901 12:36:11.411563 140635665344512 replay_runner.py:36] Average training steps per second: 183.46
I0901 12:36:11.597097 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 38.67
INFO:tensorflow:Starting iteration 22
I0901 12:36:11.806755 140635665344512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 179.79

Steps executed: 211 Episode length: 30 Return: 30.0.0
I0901 12:36:17.520210 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 30.14
INFO:tensorflow:Starting iteration 23

Steps executed: 231 Episode length: 32 Return: 32.0.0
INFO:tensorflow:Average training steps per second: 187.15
I0901 12:36:23.057689 140635665344512 replay_runner.py:36] Average training steps per second: 187.15
I0901 12:36:23.234539 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.00
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 55 Return: 55.0.0
INFO:tensorflow:Average training steps per second: 184.72
I0901 12:36:28.852437 140635665344512 replay_runner.py:36] Average training steps per second: 184.72
I0901 12:36:29.030753 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 55.25
INFO:tensorflow:Starting iteration 25

Steps executed: 238 Episode length: 43 Return: 43.0.0
INFO:tensorflow:Average training steps per second: 186.00
I0901 12:36:34.604570 140635665344512 replay_runner.py:36] Average training steps per second: 186.00
I0901 12:36:34.782203 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 39.67
INFO:tensorflow:Starting iteration 26

Steps executed: 219 Episode length: 48 Return: 48.0.0
INFO:tensorflow:Average training steps per second: 191.74
I0901 12:36:40.198914 140635665344512 replay_runner.py:36] Average training steps per second: 191.74
I0901 12:36:40.360481 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.80
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 28 Return: 28.0.0
INFO:tensorflow:Average training steps per second: 183.73
I0901 12:36:46.009153 140635665344512 replay_runner.py:36] Average training steps per second: 183.73
I0901 12:36:46.158789 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.67
INFO:tensorflow:Starting iteration 28
I0901 12:36:46.354096 140635665344512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 190.56

Steps executed: 200 Episode length: 37 Return: 37.0.0
I0901 12:36:51.758346 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 33.33
INFO:tensorflow:Starting iteration 29

Steps executed: 214 Episode length: 52 Return: 52.0.0
INFO:tensorflow:Average training steps per second: 186.49
I0901 12:36:57.322059 140635665344512 replay_runner.py:36] Average training steps per second: 186.49

Done fixed training!Episode length: 52 Return: 52.0.0