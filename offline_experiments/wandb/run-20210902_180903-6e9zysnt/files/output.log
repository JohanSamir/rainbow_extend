Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0902 18:09:10.087152 140228977166336 run_experiment.py:549] Creating TrainRunner ...
I0902 18:09:10.097688 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:10.097930 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:10.098030 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:10.098138 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:10.098257 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:10.098346 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:10.098435 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:10.098506 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:10.098589 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:10.098754 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:10.098834 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:10.098904 140228977166336 dqn_agent.py:283] 	 seed: 1630606150097627
I0902 18:09:10.100925 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:10.101082 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:10.101288 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:10.101434 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:10.101511 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:10.101577 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:10.101641 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:10.101709 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:10.101786 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:10.142466 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:10.607199 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:10.620490 140228977166336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:09:10.630769 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:09:10.631043 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:09:10.631157 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:09:10.631263 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:09:10.631340 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 18:09:10.631492 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:09:10.631614 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:09:10.631731 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:09:10.631997 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:09:10.632132 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 18:09:10.632210 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:09:10.632290 140228977166336 dqn_agent.py:283] 	 seed: 1630606150630720
I0902 18:09:10.634343 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:09:10.634497 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:09:10.634593 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:09:10.634691 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:09:10.634800 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:09:10.634879 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:09:10.634957 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:09:10.635046 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:09:10.635105 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:09:10.667422 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:09:10.689624 140228977166336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:09:10.689985 140228977166336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.26
I0902 18:09:17.671017 140228977166336 replay_runner.py:36] Average training steps per second: 143.26
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:09:19.173348 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 295 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 194.02
I0902 18:09:24.566031 140228977166336 replay_runner.py:36] Average training steps per second: 194.02
I0902 18:09:24.799062 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.50
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.64
I0902 18:09:30.040926 140228977166336 replay_runner.py:36] Average training steps per second: 199.64
I0902 18:09:30.456425 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 18:09:30.693131 140228977166336 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.08
I0902 18:09:35.793369 140228977166336 replay_runner.py:36] Average training steps per second: 196.08
I0902 18:09:36.204327 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 268 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 200.50
I0902 18:09:41.418587 140228977166336 replay_runner.py:36] Average training steps per second: 200.50
I0902 18:09:41.639476 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 5

Steps executed: 212 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 195.21
I0902 18:09:47.009220 140228977166336 replay_runner.py:36] Average training steps per second: 195.21
I0902 18:09:47.161731 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 6

Steps executed: 294 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 197.47
I0902 18:09:52.462715 140228977166336 replay_runner.py:36] Average training steps per second: 197.47
I0902 18:09:52.712808 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 7

Steps executed: 218 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 195.43
I0902 18:09:58.073219 140228977166336 replay_runner.py:36] Average training steps per second: 195.43
I0902 18:09:58.265678 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.67
I0902 18:10:03.589358 140228977166336 replay_runner.py:36] Average training steps per second: 196.67
I0902 18:10:04.020730 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 217 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 201.12
I0902 18:10:09.236986 140228977166336 replay_runner.py:36] Average training steps per second: 201.12
I0902 18:10:09.415449 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.03
I0902 18:10:14.764675 140228977166336 replay_runner.py:36] Average training steps per second: 196.03
I0902 18:10:15.179839 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 18:10:15.420804 140228977166336 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.69
I0902 18:10:20.479905 140228977166336 replay_runner.py:36] Average training steps per second: 197.69
I0902 18:10:20.895900 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 18:10:21.118439 140228977166336 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 193.85

Steps executed: 270 Episode length: 75 Return: -74.0.0
I0902 18:10:26.503575 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 13

Steps executed: 244 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 194.73
I0902 18:10:31.880522 140228977166336 replay_runner.py:36] Average training steps per second: 194.73
I0902 18:10:32.091494 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.88
I0902 18:10:37.325750 140228977166336 replay_runner.py:36] Average training steps per second: 199.88
I0902 18:10:37.742173 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 221 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 194.31
I0902 18:10:43.135921 140228977166336 replay_runner.py:36] Average training steps per second: 194.31
I0902 18:10:43.320985 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 16
I0902 18:10:43.561861 140228977166336 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 204.71

Steps executed: 265 Episode length: 84 Return: -83.0.0
I0902 18:10:48.678665 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 17

Steps executed: 81 Episode length: 81 Return: -80.00.0
INFO:tensorflow:Average training steps per second: 197.94
I0902 18:10:53.974982 140228977166336 replay_runner.py:36] Average training steps per second: 197.94
I0902 18:10:54.161892 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 18


Steps executed: 221 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 207.69
I0902 18:10:59.209357 140228977166336 replay_runner.py:36] Average training steps per second: 207.69
I0902 18:10:59.395857 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 19

Steps executed: 369 Episode length: 369 Return: -368.0
INFO:tensorflow:Average training steps per second: 217.35
I0902 18:11:04.232692 140228977166336 replay_runner.py:36] Average training steps per second: 217.35
I0902 18:11:04.514969 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.00
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 216.51
I0902 18:11:09.358358 140228977166336 replay_runner.py:36] Average training steps per second: 216.51
I0902 18:11:09.721368 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 244 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 228.57
I0902 18:11:14.312057 140228977166336 replay_runner.py:36] Average training steps per second: 228.57
I0902 18:11:14.490113 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 22

Steps executed: 224 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 225.02
I0902 18:11:19.157540 140228977166336 replay_runner.py:36] Average training steps per second: 225.02
I0902 18:11:19.307826 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 23

Steps executed: 203 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 230.88
I0902 18:11:23.847126 140228977166336 replay_runner.py:36] Average training steps per second: 230.88
I0902 18:11:23.999579 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 24
I0902 18:11:24.221084 140228977166336 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 239.65

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:11:28.748190 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 231 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 231.36
I0902 18:11:33.283323 140228977166336 replay_runner.py:36] Average training steps per second: 231.36
I0902 18:11:33.436407 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 26

Steps executed: 246 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 243.65
I0902 18:11:37.748059 140228977166336 replay_runner.py:36] Average training steps per second: 243.65
I0902 18:11:37.914084 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 27
I0902 18:11:38.128917 140228977166336 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 231.55

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:11:42.759496 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 696 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 243.07
I0902 18:11:47.078005 140228977166336 replay_runner.py:36] Average training steps per second: 243.07
I0902 18:11:47.570142 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 250.60
I0902 18:11:51.783245 140228977166336 replay_runner.py:36] Average training steps per second: 250.60
I0902 18:11:51.942575 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00