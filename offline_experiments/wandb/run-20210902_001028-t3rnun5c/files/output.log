Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 00:10:34.788514 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:10:34.801239 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:34.801572 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:34.801716 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:34.802318 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:34.802602 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:34.802773 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:34.802920 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:34.803066 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:34.803210 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:34.803338 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:34.803440 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:34.803560 140053067847680 dqn_agent.py:283] 	 seed: 1630541434801162
I0902 00:10:34.807006 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:34.807265 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:34.807458 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:34.807618 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:34.807735 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:34.807859 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:34.807977 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:34.808132 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:34.808385 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:34.848022 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:35.247374 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:35.262217 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:10:35.297995 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:35.298245 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:35.298513 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:35.298847 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:35.298962 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:35.299061 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:35.299142 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:35.299222 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:35.299319 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:35.299429 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:35.299639 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:35.299768 140053067847680 dqn_agent.py:283] 	 seed: 1630541435297934
I0902 00:10:35.303462 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:35.303775 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:35.304151 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:35.304325 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:35.304600 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:35.304780 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:35.304953 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:35.305084 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:35.305220 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:35.336381 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:35.361280 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:10:35.361891 140053067847680 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.94
I0902 00:10:41.425185 140053067847680 replay_runner.py:36] Average training steps per second: 164.94
Steps executed: 224 Episode length: 77 Return: -223.08833428527794
I0902 00:10:42.721967 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.13
INFO:tensorflow:Starting iteration 1

Steps executed: 284 Episode length: 93 Return: -414.61424333193484
INFO:tensorflow:Average training steps per second: 219.30
I0902 00:10:51.545210 140053067847680 replay_runner.py:36] Average training steps per second: 219.30
I0902 00:10:51.781139 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.50
INFO:tensorflow:Starting iteration 2

Steps executed: 230 Episode length: 116 Return: -438.28781888745397
INFO:tensorflow:Average training steps per second: 223.20
I0902 00:11:00.581845 140053067847680 replay_runner.py:36] Average training steps per second: 223.20
I0902 00:11:00.773764 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.89
INFO:tensorflow:Starting iteration 3

Steps executed: 281 Episode length: 281 Return: -485.98065107705117
INFO:tensorflow:Average training steps per second: 220.51
I0902 00:11:09.679179 140053067847680 replay_runner.py:36] Average training steps per second: 220.51
I0902 00:11:10.071834 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -485.98
INFO:tensorflow:Starting iteration 4

Steps executed: 477 Episode length: 477 Return: -308.32574177099224
INFO:tensorflow:Average training steps per second: 218.75
I0902 00:11:18.838533 140053067847680 replay_runner.py:36] Average training steps per second: 218.75
I0902 00:11:19.593947 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.33
INFO:tensorflow:Starting iteration 5
I0902 00:11:23.917092 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 220.60

Steps executed: 1000 Episode length: 1000 Return: -37.87041656069369
I0902 00:11:31.899137 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -37.87
INFO:tensorflow:Starting iteration 6

Steps executed: 664 Episode length: 664 Return: -325.969899376421159
INFO:tensorflow:Average training steps per second: 222.98
I0902 00:11:40.763632 140053067847680 replay_runner.py:36] Average training steps per second: 222.98
I0902 00:11:42.105447 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.97
INFO:tensorflow:Starting iteration 7

Steps executed: 494 Episode length: 494 Return: -210.509560449685159
INFO:tensorflow:Average training steps per second: 220.84
I0902 00:11:50.918987 140053067847680 replay_runner.py:36] Average training steps per second: 220.84
I0902 00:11:51.805499 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.51
INFO:tensorflow:Starting iteration 8

Steps executed: 310 Episode length: 310 Return: -117.200306932466359
INFO:tensorflow:Average training steps per second: 234.02
I0902 00:12:00.258964 140053067847680 replay_runner.py:36] Average training steps per second: 234.02
I0902 00:12:00.633681 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.20
INFO:tensorflow:Starting iteration 9
I0902 00:12:04.830309 140053067847680 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.09

Steps executed: 1000 Episode length: 1000 Return: -98.12934334473584
I0902 00:12:12.213809 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.13
INFO:tensorflow:Starting iteration 10
I0902 00:12:16.463815 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 223.88

Steps executed: 1000 Episode length: 1000 Return: -158.63297773816836
I0902 00:12:23.272017 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.63
INFO:tensorflow:Starting iteration 11
I0902 00:12:27.613548 140053067847680 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 227.83

Steps executed: 1000 Episode length: 1000 Return: -122.59283021415828
I0902 00:12:34.513688 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.59
INFO:tensorflow:Starting iteration 12

Steps executed: 244 Episode length: 157 Return: -304.2209731348838828
INFO:tensorflow:Average training steps per second: 217.59
I0902 00:12:43.489567 140053067847680 replay_runner.py:36] Average training steps per second: 217.59
I0902 00:12:43.730520 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.16
INFO:tensorflow:Starting iteration 13

Steps executed: 253 Episode length: 253 Return: -414.6603801899213828
INFO:tensorflow:Average training steps per second: 220.94
I0902 00:12:52.608467 140053067847680 replay_runner.py:36] Average training steps per second: 220.94
I0902 00:12:52.890372 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.66
INFO:tensorflow:Starting iteration 14

Steps executed: 291 Episode length: 185 Return: -108.3272053616924828
INFO:tensorflow:Average training steps per second: 222.54
I0902 00:13:01.786075 140053067847680 replay_runner.py:36] Average training steps per second: 222.54
I0902 00:13:02.049922 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.55
INFO:tensorflow:Starting iteration 15
I0902 00:13:06.259388 140053067847680 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 219.74
I0902 00:13:10.810704 140053067847680 replay_runner.py:36] Average training steps per second: 219.74

Steps executed: 217 Episode length: 101 Return: -728.9509356176419828
INFO:tensorflow:Starting iteration 16

Steps executed: 280 Episode length: 142 Return: -300.7903276182511828
INFO:tensorflow:Average training steps per second: 225.24
I0902 00:13:19.708346 140053067847680 replay_runner.py:36] Average training steps per second: 225.24
I0902 00:13:19.970207 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.93
INFO:tensorflow:Starting iteration 17
I0902 00:13:24.332871 140053067847680 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 219.80

Steps executed: 438 Episode length: 280 Return: -67.17805550838939828
I0902 00:13:29.419335 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.81
INFO:tensorflow:Starting iteration 18

Steps executed: 328 Episode length: 141 Return: -199.9297665469442528
INFO:tensorflow:Average training steps per second: 223.73
I0902 00:13:38.183914 140053067847680 replay_runner.py:36] Average training steps per second: 223.73
I0902 00:13:38.487439 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.56
INFO:tensorflow:Starting iteration 19

Steps executed: 289 Episode length: 176 Return: -600.3435747361202528
INFO:tensorflow:Average training steps per second: 217.54
I0902 00:13:47.480717 140053067847680 replay_runner.py:36] Average training steps per second: 217.54
I0902 00:13:47.763043 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.01
INFO:tensorflow:Starting iteration 20
I0902 00:13:52.133082 140053067847680 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 217.91
I0902 00:13:56.722889 140053067847680 replay_runner.py:36] Average training steps per second: 217.91

Steps executed: 344 Episode length: 214 Return: -483.3143382900052528
INFO:tensorflow:Starting iteration 21

Steps executed: 325 Episode length: 156 Return: -514.1681964119529528
INFO:tensorflow:Average training steps per second: 219.08
I0902 00:14:05.971468 140053067847680 replay_runner.py:36] Average training steps per second: 219.08
I0902 00:14:06.294421 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.97
INFO:tensorflow:Starting iteration 22
I0902 00:14:10.631978 140053067847680 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 219.99
I0902 00:14:15.178096 140053067847680 replay_runner.py:36] Average training steps per second: 219.99

Steps executed: 271 Episode length: 141 Return: -727.0767056573906528
INFO:tensorflow:Starting iteration 23

Steps executed: 444 Episode length: 272 Return: -453.3424619554603428
INFO:tensorflow:Average training steps per second: 217.12
I0902 00:14:24.369542 140053067847680 replay_runner.py:36] Average training steps per second: 217.12
I0902 00:14:24.894672 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.67
INFO:tensorflow:Starting iteration 24
I0902 00:14:28.991224 140053067847680 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 217.85

Steps executed: 278 Episode length: 94 Return: -355.39746983376034428
I0902 00:14:33.856227 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.96
INFO:tensorflow:Starting iteration 25

Steps executed: 312 Episode length: 137 Return: 35.092839197090234428
INFO:tensorflow:Average training steps per second: 229.20
I0902 00:14:42.603102 140053067847680 replay_runner.py:36] Average training steps per second: 229.20
I0902 00:14:42.879464 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.01
INFO:tensorflow:Starting iteration 26

Steps executed: 304 Episode length: 119 Return: -67.22353454997506328
INFO:tensorflow:Average training steps per second: 231.62
I0902 00:14:51.502283 140053067847680 replay_runner.py:36] Average training steps per second: 231.62
I0902 00:14:51.774389 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.15
INFO:tensorflow:Starting iteration 27

Steps executed: 233 Episode length: 77 Return: -685.16428745675726328
INFO:tensorflow:Average training steps per second: 242.29
I0902 00:15:00.186344 140053067847680 replay_runner.py:36] Average training steps per second: 242.29
I0902 00:15:00.408877 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -701.51
INFO:tensorflow:Starting iteration 28

Steps executed: 236 Episode length: 62 Return: -268.72057485873967328
INFO:tensorflow:Average training steps per second: 243.88
I0902 00:15:08.676706 140053067847680 replay_runner.py:36] Average training steps per second: 243.88
I0902 00:15:08.873196 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.48
INFO:tensorflow:Starting iteration 29
I0902 00:15:12.920806 140053067847680 replay_runner.py:41] Starting iteration 29

Steps executed: 266 Episode length: 84 Return: -869.17740432443057328
I0902 00:15:17.399732 140053067847680 replay_runner.py:36] Average training steps per second: 223.29

Done fixed training!Episode length: 84 Return: -869.17740432443057328