I0910 11:09:41.644675 140123951953920 run_experiment.py:549] Creating TrainRunner ...
I0910 11:09:41.649335 140123951953920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:09:41.649444 140123951953920 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:09:41.649503 140123951953920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:09:41.649552 140123951953920 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:09:41.649617 140123951953920 dqn_agent.py:275] 	 update_period: 4
I0910 11:09:41.649676 140123951953920 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:09:41.649719 140123951953920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:09:41.649788 140123951953920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:09:41.649869 140123951953920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:09:41.649939 140123951953920 dqn_agent.py:280] 	 optimizer: adam
I0910 11:09:41.649996 140123951953920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:09:41.650038 140123951953920 dqn_agent.py:283] 	 seed: 1631272181649308
I0910 11:09:41.651386 140123951953920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:09:41.651497 140123951953920 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:09:41.651562 140123951953920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:09:41.651620 140123951953920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:09:41.651668 140123951953920 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:09:41.651728 140123951953920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:09:41.651793 140123951953920 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:09:41.651881 140123951953920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:09:41.651950 140123951953920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:09:41.672466 140123951953920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0910 11:09:41.688262 140123951953920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:09:41.688380 140123951953920 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:09:41.688440 140123951953920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:09:41.688512 140123951953920 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:09:41.688600 140123951953920 dqn_agent.py:275] 	 update_period: 4
I0910 11:09:41.688656 140123951953920 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:09:41.688704 140123951953920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:09:41.688753 140123951953920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:09:41.688846 140123951953920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:09:41.688925 140123951953920 dqn_agent.py:280] 	 optimizer: adam
I0910 11:09:41.688975 140123951953920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:09:41.689036 140123951953920 dqn_agent.py:283] 	 seed: 1631272181688241
I0910 11:09:41.690338 140123951953920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:09:41.690439 140123951953920 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:09:41.690501 140123951953920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:09:41.690557 140123951953920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:09:41.690607 140123951953920 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:09:41.690664 140123951953920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:09:41.690727 140123951953920 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:09:41.690787 140123951953920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:09:41.690835 140123951953920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:09:41.709106 140123951953920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0910 11:09:41.720953 140123951953920 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:09:41.721094 140123951953920 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 994853.89
I0910 11:09:41.722223 140123951953920 replay_runner.py:39] Average training steps per second: 994853.89
I0910 11:09:42.421178 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:09:42.474440 140123951953920 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 861076.58
I0910 11:09:42.475821 140123951953920 replay_runner.py:39] Average training steps per second: 861076.58
I0910 11:09:42.637028 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:09:42.695553 140123951953920 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 850771.60
I0910 11:09:42.696948 140123951953920 replay_runner.py:39] Average training steps per second: 850771.60
I0910 11:09:42.862641 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:09:42.914546 140123951953920 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 874724.50
I0910 11:09:42.915889 140123951953920 replay_runner.py:39] Average training steps per second: 874724.50
I0910 11:09:43.072318 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:09:43.123732 140123951953920 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 818720.28
I0910 11:09:43.125190 140123951953920 replay_runner.py:39] Average training steps per second: 818720.28
Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:09:43.284465 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:09:43.335233 140123951953920 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 956075.68
I0910 11:09:43.336503 140123951953920 replay_runner.py:39] Average training steps per second: 956075.68
I0910 11:09:43.493003 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:09:43.545053 140123951953920 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 843415.24
I0910 11:09:43.546480 140123951953920 replay_runner.py:39] Average training steps per second: 843415.24
I0910 11:09:43.736244 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:09:43.788815 140123951953920 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 922027.70
I0910 11:09:43.790107 140123951953920 replay_runner.py:39] Average training steps per second: 922027.70
I0910 11:09:43.951481 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:09:44.003512 140123951953920 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 814744.37
I0910 11:09:44.005015 140123951953920 replay_runner.py:39] Average training steps per second: 814744.37
I0910 11:09:44.166243 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:09:44.219973 140123951953920 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 973608.17
I0910 11:09:44.221339 140123951953920 replay_runner.py:39] Average training steps per second: 973608.17
I0910 11:09:44.379555 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:09:44.432756 140123951953920 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 904919.96
I0910 11:09:44.434053 140123951953920 replay_runner.py:39] Average training steps per second: 904919.96
I0910 11:09:44.594208 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:09:44.647977 140123951953920 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 915986.90
I0910 11:09:44.649281 140123951953920 replay_runner.py:39] Average training steps per second: 915986.90
I0910 11:09:44.813994 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:09:44.866240 140123951953920 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 935184.84
I0910 11:09:44.867523 140123951953920 replay_runner.py:39] Average training steps per second: 935184.84
I0910 11:09:45.023514 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:09:45.078211 140123951953920 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 867129.21
I0910 11:09:45.079558 140123951953920 replay_runner.py:39] Average training steps per second: 867129.21
I0910 11:09:45.244125 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:09:45.297276 140123951953920 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 893165.25
I0910 11:09:45.298617 140123951953920 replay_runner.py:39] Average training steps per second: 893165.25
I0910 11:09:45.456356 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:09:45.509920 140123951953920 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 892025.52
I0910 11:09:45.511240 140123951953920 replay_runner.py:39] Average training steps per second: 892025.52
I0910 11:09:45.689856 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:09:45.744649 140123951953920 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 829733.73
I0910 11:09:45.746113 140123951953920 replay_runner.py:39] Average training steps per second: 829733.73
I0910 11:09:45.906264 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:09:45.959281 140123951953920 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 895644.67
I0910 11:09:45.960600 140123951953920 replay_runner.py:39] Average training steps per second: 895644.67
I0910 11:09:46.125768 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:09:46.179998 140123951953920 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 842568.10
I0910 11:09:46.181381 140123951953920 replay_runner.py:39] Average training steps per second: 842568.10
I0910 11:09:46.349701 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:09:46.405603 140123951953920 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 856504.80
I0910 11:09:46.407030 140123951953920 replay_runner.py:39] Average training steps per second: 856504.80
I0910 11:09:46.571124 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:09:46.624783 140123951953920 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 818241.12
I0910 11:09:46.626209 140123951953920 replay_runner.py:39] Average training steps per second: 818241.12
I0910 11:09:46.793123 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:09:46.846376 140123951953920 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 894307.89
I0910 11:09:46.847688 140123951953920 replay_runner.py:39] Average training steps per second: 894307.89
I0910 11:09:47.010235 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:09:47.065008 140123951953920 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 859840.92

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:09:47.234203 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:09:47.288571 140123951953920 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 923448.70
I0910 11:09:47.289868 140123951953920 replay_runner.py:39] Average training steps per second: 923448.70
I0910 11:09:47.448840 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:09:47.502180 140123951953920 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 900258.42
I0910 11:09:47.503512 140123951953920 replay_runner.py:39] Average training steps per second: 900258.42
I0910 11:09:47.670310 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:09:47.736603 140123951953920 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 841047.52
I0910 11:09:47.738005 140123951953920 replay_runner.py:39] Average training steps per second: 841047.52
I0910 11:09:47.906101 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:09:47.960553 140123951953920 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 864983.30
I0910 11:09:47.961917 140123951953920 replay_runner.py:39] Average training steps per second: 864983.30
I0910 11:09:48.163053 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:09:48.219419 140123951953920 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 913194.86
I0910 11:09:48.220710 140123951953920 replay_runner.py:39] Average training steps per second: 913194.86
I0910 11:09:48.429745 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:09:48.482918 140123951953920 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 855456.66
I0910 11:09:48.484290 140123951953920 replay_runner.py:39] Average training steps per second: 855456.66
I0910 11:09:48.652231 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:09:48.707424 140123951953920 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 755866.64
I0910 11:09:48.709016 140123951953920 replay_runner.py:39] Average training steps per second: 755866.64
I0910 11:09:48.882090 140123951953920 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00