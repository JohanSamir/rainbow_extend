I0909 13:27:38.559234 140252157974528 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 13:27:38.559776 140252157974528 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 13:27:38.661578 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:27:38.663214 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:27:38.663385 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:27:38.663524 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:27:38.663637 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:27:38.663738 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:27:38.663841 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:27:38.663939 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:27:38.664035 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:27:38.664129 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:27:38.664231 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:27:38.664456 140252157974528 dqn_agent.py:283] 	 seed: 1631194058661513
I0909 13:27:38.667536 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:27:38.667711 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:27:38.667807 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:27:38.667890 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:27:38.667970 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:27:38.668047 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:27:38.668106 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:27:38.668208 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:27:38.668290 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 13:27:41.310721 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:27:41.671934 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:27:41.798155 140252157974528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:27:41.804075 140252157974528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:27:41.804248 140252157974528 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:27:41.804338 140252157974528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:27:41.804401 140252157974528 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:27:41.804469 140252157974528 dqn_agent.py:275] 	 update_period: 4
I0909 13:27:41.804610 140252157974528 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:27:41.804683 140252157974528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:27:41.804744 140252157974528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:27:41.804806 140252157974528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:27:41.804887 140252157974528 dqn_agent.py:280] 	 optimizer: adam
I0909 13:27:41.805006 140252157974528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:27:41.805075 140252157974528 dqn_agent.py:283] 	 seed: 1631194061804032
I0909 13:27:41.806782 140252157974528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:27:41.806917 140252157974528 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:27:41.807234 140252157974528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:27:41.807380 140252157974528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:27:41.807512 140252157974528 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:27:41.807621 140252157974528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:27:41.807696 140252157974528 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:27:41.807767 140252157974528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:27:41.807851 140252157974528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:27:41.843136 140252157974528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:27:41.861938 140252157974528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:27:41.862104 140252157974528 replay_runner.py:41] Starting iteration 0
Steps executed: 229 Episode length: 229 Return: -229.0
INFO:tensorflow:Average training steps per second: 144.98
I0909 13:27:48.759997 140252157974528 replay_runner.py:36] Average training steps per second: 144.98
I0909 13:27:49.912917 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.00
INFO:tensorflow:Starting iteration 1

Steps executed: 245 Episode length: 245 Return: -245.0
INFO:tensorflow:Average training steps per second: 199.80
I0909 13:27:55.030512 140252157974528 replay_runner.py:36] Average training steps per second: 199.80
I0909 13:27:55.141969 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.00
INFO:tensorflow:Starting iteration 2
I0909 13:27:55.250953 140252157974528 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 200.22

Steps executed: 745 Episode length: 600 Return: -600.0
I0909 13:28:00.584762 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.50
INFO:tensorflow:Starting iteration 3

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 199.57
I0909 13:28:05.707360 140252157974528 replay_runner.py:36] Average training steps per second: 199.57
I0909 13:28:05.985662 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4

Steps executed: 204 Episode length: 204 Return: -204.0
INFO:tensorflow:Average training steps per second: 202.04
I0909 13:28:11.052129 140252157974528 replay_runner.py:36] Average training steps per second: 202.04
I0909 13:28:11.154054 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.00
INFO:tensorflow:Starting iteration 5
I0909 13:28:11.267879 140252157974528 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 201.26

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:28:16.501594 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:28:16.608457 140252157974528 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 201.74
I0909 13:28:21.565834 140252157974528 replay_runner.py:36] Average training steps per second: 201.74
I0909 13:28:21.849174 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 260 Episode length: 86 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 197.10
I0909 13:28:27.029265 140252157974528 replay_runner.py:36] Average training steps per second: 197.10
I0909 13:28:27.152908 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 8

Steps executed: 98 Episode length: 98 Return: -98.00.0
INFO:tensorflow:Average training steps per second: 198.60
I0909 13:28:32.292063 140252157974528 replay_runner.py:36] Average training steps per second: 198.60

Steps executed: 698 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 9

Steps executed: 693 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 197.02
I0909 13:28:37.773355 140252157974528 replay_runner.py:36] Average training steps per second: 197.02
I0909 13:28:38.067653 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.50
INFO:tensorflow:Starting iteration 10

Steps executed: 239 Episode length: 88 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 199.15
I0909 13:28:43.200831 140252157974528 replay_runner.py:36] Average training steps per second: 199.15
I0909 13:28:43.309105 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 11

Steps executed: 244 Episode length: 89 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 198.98
I0909 13:28:48.448747 140252157974528 replay_runner.py:36] Average training steps per second: 198.98
I0909 13:28:48.554923 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 12

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 196.93
I0909 13:28:53.745929 140252157974528 replay_runner.py:36] Average training steps per second: 196.93
I0909 13:28:54.025850 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13

Steps executed: 293 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 201.34
I0909 13:28:59.105104 140252157974528 replay_runner.py:36] Average training steps per second: 201.34
I0909 13:28:59.227680 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 14

Steps executed: 228 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 201.87
I0909 13:29:04.289783 140252157974528 replay_runner.py:36] Average training steps per second: 201.87
I0909 13:29:04.391839 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 200.67
I0909 13:29:09.485381 140252157974528 replay_runner.py:36] Average training steps per second: 200.67
I0909 13:29:09.581866 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 16
I0909 13:29:09.692724 140252157974528 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 200.18
I0909 13:29:14.688678 140252157974528 replay_runner.py:36] Average training steps per second: 200.18
I0909 13:29:14.789996 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 17


Steps executed: 230 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 199.61
I0909 13:29:19.912548 140252157974528 replay_runner.py:36] Average training steps per second: 199.61
I0909 13:29:20.016150 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 18

Steps executed: 225 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 198.62
I0909 13:29:25.165269 140252157974528 replay_runner.py:36] Average training steps per second: 198.62
I0909 13:29:25.261201 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 19

Steps executed: 319 Episode length: 201 Return: -201.0
INFO:tensorflow:Average training steps per second: 198.71
I0909 13:29:30.401488 140252157974528 replay_runner.py:36] Average training steps per second: 198.71
I0909 13:29:30.534978 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.50
INFO:tensorflow:Starting iteration 20

Steps executed: 231 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 199.37
I0909 13:29:35.653943 140252157974528 replay_runner.py:36] Average training steps per second: 199.37
I0909 13:29:35.765707 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 21

Steps executed: 323 Episode length: 162 Return: -162.0
INFO:tensorflow:Average training steps per second: 197.18
I0909 13:29:40.947600 140252157974528 replay_runner.py:36] Average training steps per second: 197.18
I0909 13:29:41.092621 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.50
INFO:tensorflow:Starting iteration 22

Steps executed: 267 Episode length: 181 Return: -181.0
INFO:tensorflow:Average training steps per second: 215.58
I0909 13:29:45.843287 140252157974528 replay_runner.py:36] Average training steps per second: 215.58
I0909 13:29:45.954824 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.50
INFO:tensorflow:Starting iteration 23

Steps executed: 362 Episode length: 181 Return: -181.0
INFO:tensorflow:Average training steps per second: 251.45
I0909 13:29:50.038470 140252157974528 replay_runner.py:36] Average training steps per second: 251.45
I0909 13:29:50.140333 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.00
INFO:tensorflow:Starting iteration 24

Steps executed: 209 Episode length: 209 Return: -209.0
INFO:tensorflow:Average training steps per second: 302.54
I0909 13:29:53.528232 140252157974528 replay_runner.py:36] Average training steps per second: 302.54
I0909 13:29:53.569733 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.00
INFO:tensorflow:Starting iteration 25

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 380.04
I0909 13:29:56.263505 140252157974528 replay_runner.py:36] Average training steps per second: 380.04
I0909 13:29:56.384054 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0909 13:29:56.449214 140252157974528 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 394.00
I0909 13:29:58.987558 140252157974528 replay_runner.py:36] Average training steps per second: 394.00

Steps executed: 231 Episode length: 115 Return: -115.0
INFO:tensorflow:Starting iteration 27

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 398.05
I0909 13:30:01.613158 140252157974528 replay_runner.py:36] Average training steps per second: 398.05
I0909 13:30:01.732827 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28

Steps executed: 234 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 402.06
I0909 13:30:04.284363 140252157974528 replay_runner.py:36] Average training steps per second: 402.06
I0909 13:30:04.332157 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 407.07
I0909 13:30:06.853609 140252157974528 replay_runner.py:36] Average training steps per second: 407.07
I0909 13:30:06.971503 140252157974528 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00