I0901 13:22:22.153425 139803418769408 run_experiment.py:549] Creating TrainRunner ...
I0901 13:22:22.161800 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:22.161955 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:22.162019 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:22.162076 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:22.162145 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:22.162242 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:22.162303 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:22.162403 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:22.162456 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:22.162548 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:22.162605 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:22.162666 139803418769408 dqn_agent.py:283] 	 seed: 1630502542161760
I0901 13:22:22.166154 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:22.166424 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:22.166591 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:22.166692 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:22.166770 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:22.166843 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:22.166946 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:22.167073 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:22.167177 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:22.299260 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:22.556400 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:22.564555 139803418769408 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:22:22.571272 139803418769408 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:22.571391 139803418769408 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:22.571477 139803418769408 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:22.571565 139803418769408 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:22.571749 139803418769408 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:22.571818 139803418769408 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:22.571890 139803418769408 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:22.571966 139803418769408 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:22.572084 139803418769408 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:22.572165 139803418769408 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:22.572228 139803418769408 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:22.572309 139803418769408 dqn_agent.py:283] 	 seed: 1630502542571246
I0901 13:22:22.573835 139803418769408 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:22.573966 139803418769408 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:22.574092 139803418769408 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:22.574178 139803418769408 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:22.574245 139803418769408 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:22.574323 139803418769408 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:22.574401 139803418769408 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:22.574482 139803418769408 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:22.574555 139803418769408 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:22.598431 139803418769408 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:22.613390 139803418769408 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:22:22.613533 139803418769408 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 232.09
I0901 13:22:26.922419 139803418769408 replay_runner.py:36] Average training steps per second: 232.09

Steps executed: 306 Episode length: 192 Return: -207.94050941720775
I0901 13:22:27.759239 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.77
INFO:tensorflow:Starting iteration 1

Steps executed: 299 Episode length: 101 Return: -231.48525952997807
INFO:tensorflow:Average training steps per second: 345.05
I0901 13:22:34.136250 139803418769408 replay_runner.py:36] Average training steps per second: 345.05
I0901 13:22:34.314186 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.37
INFO:tensorflow:Starting iteration 2
I0901 13:22:37.658297 139803418769408 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 323.88
I0901 13:22:40.746179 139803418769408 replay_runner.py:36] Average training steps per second: 323.88

Steps executed: 246 Episode length: 94 Return: -280.124341991240277
INFO:tensorflow:Starting iteration 3

Steps executed: 252 Episode length: 122 Return: -279.71937150582412
INFO:tensorflow:Average training steps per second: 359.38
I0901 13:22:46.941381 139803418769408 replay_runner.py:36] Average training steps per second: 359.38
I0901 13:22:47.083984 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.41
INFO:tensorflow:Starting iteration 4

Steps executed: 222 Episode length: 143 Return: -393.34658717816812
INFO:tensorflow:Average training steps per second: 328.94
I0901 13:22:53.487583 139803418769408 replay_runner.py:36] Average training steps per second: 328.94
I0901 13:22:53.629912 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.22
INFO:tensorflow:Starting iteration 5

Steps executed: 326 Episode length: 141 Return: -444.42506112830796
INFO:tensorflow:Average training steps per second: 327.91
I0901 13:22:59.981368 139803418769408 replay_runner.py:36] Average training steps per second: 327.91
I0901 13:23:00.185481 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.71
INFO:tensorflow:Starting iteration 6

Steps executed: 366 Episode length: 196 Return: -300.27394914748925
INFO:tensorflow:Average training steps per second: 328.66
I0901 13:23:06.495826 139803418769408 replay_runner.py:36] Average training steps per second: 328.66
I0901 13:23:06.777166 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.11
INFO:tensorflow:Starting iteration 7

Steps executed: 99 Episode length: 99 Return: -290.4287742340997925
INFO:tensorflow:Average training steps per second: 322.23

Steps executed: 616 Episode length: 517 Return: -1745.7650053760515
I0901 13:23:14.229254 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -1018.10
INFO:tensorflow:Starting iteration 8

Steps executed: 298 Episode length: 147 Return: -335.36323156505375
INFO:tensorflow:Average training steps per second: 319.47
I0901 13:23:20.805407 139803418769408 replay_runner.py:36] Average training steps per second: 319.47
I0901 13:23:21.020252 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.18
INFO:tensorflow:Starting iteration 9
I0901 13:23:24.527305 139803418769408 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 327.68
I0901 13:23:27.579438 139803418769408 replay_runner.py:36] Average training steps per second: 327.68

Steps executed: 403 Episode length: 403 Return: -368.41522971591115
INFO:tensorflow:Starting iteration 10

Steps executed: 760 Episode length: 641 Return: -1330.0545990392256
INFO:tensorflow:Average training steps per second: 322.60
I0901 13:23:34.529001 139803418769408 replay_runner.py:36] Average training steps per second: 322.60
I0901 13:23:35.612336 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.58
INFO:tensorflow:Starting iteration 11
I0901 13:23:38.983273 139803418769408 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 320.43

Steps executed: 1000 Episode length: 1000 Return: -97.86975790581005
I0901 13:23:44.737279 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.87
INFO:tensorflow:Starting iteration 12

Steps executed: 434 Episode length: 434 Return: -339.273331527856005
INFO:tensorflow:Average training steps per second: 324.68
I0901 13:23:51.290545 139803418769408 replay_runner.py:36] Average training steps per second: 324.68
I0901 13:23:51.767705 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.27
INFO:tensorflow:Starting iteration 13

Steps executed: 379 Episode length: 379 Return: -257.867243131801165
INFO:tensorflow:Average training steps per second: 311.08
I0901 13:23:58.478310 139803418769408 replay_runner.py:36] Average training steps per second: 311.08
I0901 13:23:58.882858 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.87
INFO:tensorflow:Starting iteration 14

Steps executed: 365 Episode length: 365 Return: -197.613454441208665
INFO:tensorflow:Average training steps per second: 322.34
I0901 13:24:05.473731 139803418769408 replay_runner.py:36] Average training steps per second: 322.34
I0901 13:24:05.795156 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.61
INFO:tensorflow:Starting iteration 15
I0901 13:24:09.226316 139803418769408 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 322.36

Steps executed: 673 Episode length: 673 Return: -435.528165293288165
I0901 13:24:13.353618 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.53
INFO:tensorflow:Starting iteration 16

Steps executed: 51 Episode length: 51 Return: -279.80258504910268165
INFO:tensorflow:Average training steps per second: 325.21

Steps executed: 527 Episode length: 476 Return: -375.069838181944255
I0901 13:24:20.513621 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.44
INFO:tensorflow:Starting iteration 17

Steps executed: 293 Episode length: 163 Return: -238.036377398944785
INFO:tensorflow:Average training steps per second: 328.50
I0901 13:24:27.085262 139803418769408 replay_runner.py:36] Average training steps per second: 328.50
I0901 13:24:27.237226 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.28
INFO:tensorflow:Starting iteration 18

Steps executed: 250 Episode length: 115 Return: -685.827858508716885
INFO:tensorflow:Average training steps per second: 316.43
I0901 13:24:33.853538 139803418769408 replay_runner.py:36] Average training steps per second: 316.43
I0901 13:24:33.991946 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.24
INFO:tensorflow:Starting iteration 19

Steps executed: 253 Episode length: 120 Return: -473.100436551096385
INFO:tensorflow:Average training steps per second: 311.91
I0901 13:24:40.629622 139803418769408 replay_runner.py:36] Average training steps per second: 311.91
I0901 13:24:40.791913 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -477.81
INFO:tensorflow:Starting iteration 20

Steps executed: 240 Episode length: 70 Return: -165.8576604891616585
INFO:tensorflow:Average training steps per second: 319.15
I0901 13:24:47.356628 139803418769408 replay_runner.py:36] Average training steps per second: 319.15
I0901 13:24:47.490582 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.40
INFO:tensorflow:Starting iteration 21
I0901 13:24:50.945191 139803418769408 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 312.23

Steps executed: 272 Episode length: 79 Return: -739.3074245176819585
I0901 13:24:54.320751 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -650.26
INFO:tensorflow:Starting iteration 22

Steps executed: 263 Episode length: 69 Return: -623.9133267544788585
INFO:tensorflow:Average training steps per second: 320.87
I0901 13:25:00.912484 139803418769408 replay_runner.py:36] Average training steps per second: 320.87
I0901 13:25:01.077797 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -574.41
INFO:tensorflow:Starting iteration 23

Steps executed: 271 Episode length: 107 Return: -99.9005417316222885
INFO:tensorflow:Average training steps per second: 326.68
I0901 13:25:07.628197 139803418769408 replay_runner.py:36] Average training steps per second: 326.68
I0901 13:25:07.785723 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.46
INFO:tensorflow:Starting iteration 24
I0901 13:25:11.319413 139803418769408 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 331.86

Steps executed: 286 Episode length: 97 Return: -573.8400490962074145
I0901 13:25:14.523701 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -582.49
INFO:tensorflow:Starting iteration 25

Steps executed: 273 Episode length: 94 Return: 13.974071266460825145
INFO:tensorflow:Average training steps per second: 327.10
I0901 13:25:21.130171 139803418769408 replay_runner.py:36] Average training steps per second: 327.10
I0901 13:25:21.307651 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.09
INFO:tensorflow:Starting iteration 26

Steps executed: 265 Episode length: 71 Return: -213.2260337142704245
INFO:tensorflow:Average training steps per second: 328.49
I0901 13:25:27.900928 139803418769408 replay_runner.py:36] Average training steps per second: 328.49
I0901 13:25:28.080368 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.79
INFO:tensorflow:Starting iteration 27

Steps executed: 298 Episode length: 125 Return: -179.844649549124345
INFO:tensorflow:Average training steps per second: 334.52
I0901 13:25:34.630789 139803418769408 replay_runner.py:36] Average training steps per second: 334.52
I0901 13:25:34.838813 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.42
INFO:tensorflow:Starting iteration 28

Steps executed: 239 Episode length: 129 Return: -411.235102034660645
INFO:tensorflow:Average training steps per second: 339.11
I0901 13:25:41.352768 139803418769408 replay_runner.py:36] Average training steps per second: 339.11
I0901 13:25:41.521161 139803418769408 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.22
INFO:tensorflow:Starting iteration 29

Steps executed: 268 Episode length: 100 Return: -514.961528887355845
INFO:tensorflow:Average training steps per second: 338.02
I0901 13:25:48.091637 139803418769408 replay_runner.py:36] Average training steps per second: 338.02

Done fixed training!Episode length: 100 Return: -514.961528887355845