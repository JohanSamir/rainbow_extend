Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0901 12:59:49.847910 140265790818304 run_experiment.py:549] Creating TrainRunner ...
I0901 12:59:49.860112 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:59:49.860400 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:59:49.860553 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:59:49.860666 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:59:49.860780 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 12:59:49.860906 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:59:49.861023 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:59:49.861137 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:59:49.861251 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:59:49.861396 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 12:59:49.861512 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:59:49.861671 140265790818304 dqn_agent.py:283] 	 seed: 1630501189860045
I0901 12:59:49.864647 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:59:49.864844 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:59:49.864984 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:59:49.865087 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:59:49.865185 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:59:49.865264 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:59:49.865359 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:59:49.865436 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:59:49.865516 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:59:49.907038 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:59:50.312792 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:59:50.328273 140265790818304 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:59:50.361009 140265790818304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:59:50.361330 140265790818304 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:59:50.361511 140265790818304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:59:50.361643 140265790818304 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:59:50.361763 140265790818304 dqn_agent.py:275] 	 update_period: 4
I0901 12:59:50.361891 140265790818304 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:59:50.362009 140265790818304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:59:50.362157 140265790818304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:59:50.362291 140265790818304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:59:50.362420 140265790818304 dqn_agent.py:280] 	 optimizer: adam
I0901 12:59:50.362553 140265790818304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:59:50.362670 140265790818304 dqn_agent.py:283] 	 seed: 1630501190360949
I0901 12:59:50.365803 140265790818304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:59:50.366008 140265790818304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:59:50.366151 140265790818304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:59:50.366254 140265790818304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:59:50.366342 140265790818304 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:59:50.366445 140265790818304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:59:50.366547 140265790818304 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:59:50.366721 140265790818304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:59:50.366827 140265790818304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:59:50.403387 140265790818304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:59:50.427141 140265790818304 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:59:50.427455 140265790818304 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 159.06
I0901 12:59:56.714849 140265790818304 replay_runner.py:36] Average training steps per second: 159.06
Steps executed: 232 Episode length: 106 Return: -363.1808178159487
I0901 12:59:57.948315 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.80
INFO:tensorflow:Starting iteration 1

Steps executed: 246 Episode length: 131 Return: -4.3109747488675372
INFO:tensorflow:Average training steps per second: 217.21
I0901 13:00:06.787296 140265790818304 replay_runner.py:36] Average training steps per second: 217.21
I0901 13:00:07.013261 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.94
INFO:tensorflow:Starting iteration 2

Steps executed: 240 Episode length: 78 Return: -297.021981221335652
INFO:tensorflow:Average training steps per second: 226.62
I0901 13:00:15.934237 140265790818304 replay_runner.py:36] Average training steps per second: 226.62
I0901 13:00:16.149309 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.99
INFO:tensorflow:Starting iteration 3

Steps executed: 228 Episode length: 99 Return: -704.414627635298472
INFO:tensorflow:Average training steps per second: 217.31
I0901 13:00:25.190923 140265790818304 replay_runner.py:36] Average training steps per second: 217.31
I0901 13:00:25.453982 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.13
INFO:tensorflow:Starting iteration 4

Steps executed: 225 Episode length: 90 Return: -428.764455921836542
INFO:tensorflow:Average training steps per second: 216.52
I0901 13:00:34.594719 140265790818304 replay_runner.py:36] Average training steps per second: 216.52
I0901 13:00:34.791840 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.29
INFO:tensorflow:Starting iteration 5

Steps executed: 245 Episode length: 79 Return: -229.860047318491352
INFO:tensorflow:Average training steps per second: 218.10
I0901 13:00:43.868063 140265790818304 replay_runner.py:36] Average training steps per second: 218.10
I0901 13:00:44.078043 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.93
INFO:tensorflow:Starting iteration 6

Steps executed: 202 Episode length: 202 Return: -258.33650486546972
INFO:tensorflow:Average training steps per second: 215.67
I0901 13:00:53.205401 140265790818304 replay_runner.py:36] Average training steps per second: 215.67
I0901 13:00:53.441123 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.34
INFO:tensorflow:Starting iteration 7

Steps executed: 201 Episode length: 84 Return: -205.999247102289334
INFO:tensorflow:Average training steps per second: 214.43
I0901 13:01:02.615388 140265790818304 replay_runner.py:36] Average training steps per second: 214.43
I0901 13:01:02.791036 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.92
INFO:tensorflow:Starting iteration 8

Steps executed: 298 Episode length: 211 Return: -587.33634491406494
INFO:tensorflow:Average training steps per second: 215.38
I0901 13:01:11.964650 140265790818304 replay_runner.py:36] Average training steps per second: 215.38
I0901 13:01:12.284847 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.24
INFO:tensorflow:Starting iteration 9

Steps executed: 240 Episode length: 119 Return: -153.01334646107983
INFO:tensorflow:Average training steps per second: 213.66
I0901 13:01:21.490957 140265790818304 replay_runner.py:36] Average training steps per second: 213.66
I0901 13:01:21.716750 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.60
INFO:tensorflow:Starting iteration 10

Steps executed: 258 Episode length: 61 Return: -491.075395628334733
INFO:tensorflow:Average training steps per second: 216.79
I0901 13:01:30.879044 140265790818304 replay_runner.py:36] Average training steps per second: 216.79
I0901 13:01:31.098002 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.23
INFO:tensorflow:Starting iteration 11

Steps executed: 242 Episode length: 87 Return: -276.896669686663633
INFO:tensorflow:Average training steps per second: 227.27
I0901 13:01:40.033441 140265790818304 replay_runner.py:36] Average training steps per second: 227.27
I0901 13:01:40.253071 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.74
INFO:tensorflow:Starting iteration 12

Steps executed: 215 Episode length: 69 Return: -421.833046985947253
INFO:tensorflow:Average training steps per second: 230.41
I0901 13:01:48.991833 140265790818304 replay_runner.py:36] Average training steps per second: 230.41
I0901 13:01:49.173586 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.10
INFO:tensorflow:Starting iteration 13
I0901 13:01:53.676901 140265790818304 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 231.98

Steps executed: 247 Episode length: 166 Return: -350.15977755352773
I0901 13:01:58.245535 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.33
INFO:tensorflow:Starting iteration 14

Steps executed: 230 Episode length: 108 Return: -195.40086800159293
INFO:tensorflow:Average training steps per second: 228.57
I0901 13:02:07.034317 140265790818304 replay_runner.py:36] Average training steps per second: 228.57
I0901 13:02:07.223697 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.75
INFO:tensorflow:Starting iteration 15

Steps executed: 236 Episode length: 81 Return: -695.442325232192483
INFO:tensorflow:Average training steps per second: 224.21
I0901 13:02:15.858621 140265790818304 replay_runner.py:36] Average training steps per second: 224.21
I0901 13:02:16.049781 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.78
INFO:tensorflow:Starting iteration 16

Steps executed: 222 Episode length: 91 Return: -470.443238138132133
INFO:tensorflow:Average training steps per second: 227.85
I0901 13:02:24.823020 140265790818304 replay_runner.py:36] Average training steps per second: 227.85
I0901 13:02:25.023585 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.16
INFO:tensorflow:Starting iteration 17
I0901 13:02:29.404540 140265790818304 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 228.91
I0901 13:02:33.773419 140265790818304 replay_runner.py:36] Average training steps per second: 228.91

Steps executed: 219 Episode length: 136 Return: -947.43819003131143
INFO:tensorflow:Starting iteration 18

Steps executed: 228 Episode length: 80 Return: -349.876809086532463
INFO:tensorflow:Average training steps per second: 223.16
I0901 13:02:42.802284 140265790818304 replay_runner.py:36] Average training steps per second: 223.16
I0901 13:02:42.967050 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.11
INFO:tensorflow:Starting iteration 19

Steps executed: 59 Episode length: 59 Return: -129.4398710957838463
INFO:tensorflow:Average training steps per second: 226.28
I0901 13:02:51.730437 140265790818304 replay_runner.py:36] Average training steps per second: 226.28

Steps executed: 255 Episode length: 58 Return: -152.127834969683473
INFO:tensorflow:Starting iteration 20

Steps executed: 222 Episode length: 77 Return: -131.204902265854463
INFO:tensorflow:Average training steps per second: 229.79
I0901 13:03:00.409526 140265790818304 replay_runner.py:36] Average training steps per second: 229.79
I0901 13:03:00.567402 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.76
INFO:tensorflow:Starting iteration 21

Steps executed: 211 Episode length: 83 Return: -170.536572857502563
INFO:tensorflow:Average training steps per second: 237.56
I0901 13:03:08.968730 140265790818304 replay_runner.py:36] Average training steps per second: 237.56
I0901 13:03:09.104632 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.15
INFO:tensorflow:Starting iteration 22

Steps executed: 233 Episode length: 74 Return: -379.345195400851853
INFO:tensorflow:Average training steps per second: 237.08
I0901 13:03:17.485853 140265790818304 replay_runner.py:36] Average training steps per second: 237.08
I0901 13:03:17.631314 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.73
INFO:tensorflow:Starting iteration 23

Steps executed: 217 Episode length: 84 Return: -184.049260015945663
INFO:tensorflow:Average training steps per second: 235.75
I0901 13:03:26.135033 140265790818304 replay_runner.py:36] Average training steps per second: 235.75
I0901 13:03:26.282476 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -379.50
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 64 Return: -571.379196900590663
INFO:tensorflow:Average training steps per second: 239.49
I0901 13:03:34.693380 140265790818304 replay_runner.py:36] Average training steps per second: 239.49
I0901 13:03:34.874881 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.41
INFO:tensorflow:Starting iteration 25

Steps executed: 224 Episode length: 73 Return: -330.605331327861733
INFO:tensorflow:Average training steps per second: 241.82
I0901 13:03:43.196004 140265790818304 replay_runner.py:36] Average training steps per second: 241.82
I0901 13:03:43.339561 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.05
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 52 Return: -126.081074679884133
INFO:tensorflow:Average training steps per second: 238.91
I0901 13:03:51.499264 140265790818304 replay_runner.py:36] Average training steps per second: 238.91
I0901 13:03:51.647638 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.76
INFO:tensorflow:Starting iteration 27

Steps executed: 206 Episode length: 69 Return: -634.075784562174733
INFO:tensorflow:Average training steps per second: 242.77
I0901 13:03:59.928272 140265790818304 replay_runner.py:36] Average training steps per second: 242.77
I0901 13:04:00.093189 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.18
INFO:tensorflow:Starting iteration 28

Steps executed: 56 Episode length: 56 Return: -552.3390749857781733
INFO:tensorflow:Average training steps per second: 241.93

Steps executed: 205 Episode length: 81 Return: -757.029095891167133
I0901 13:04:08.436862 140265790818304 run_experiment.py:428] Average undiscounted return per evaluation episode: -630.13
INFO:tensorflow:Starting iteration 29

Steps executed: 212 Episode length: 76 Return: -476.989591927821463
INFO:tensorflow:Average training steps per second: 240.23
I0901 13:04:16.685185 140265790818304 replay_runner.py:36] Average training steps per second: 240.23

Done fixed training!Episode length: 76 Return: -476.989591927821463