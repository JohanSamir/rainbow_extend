Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 23:37:36.060103 139650945370112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:37:36.068188 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:37:36.068479 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:37:36.068659 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:37:36.068813 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:37:36.068922 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:37:36.069020 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:37:36.069181 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:37:36.069320 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:37:36.069508 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:37:36.069652 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:37:36.069924 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:37:36.070046 139650945370112 dqn_agent.py:283] 	 seed: 1630625856068130
I0902 23:37:36.073246 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:37:36.073403 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:37:36.073536 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:37:36.073668 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:37:36.073764 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:37:36.073840 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:37:36.073916 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:37:36.073998 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:37:36.074061 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:37:36.111898 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:36.624699 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:36.641081 139650945370112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:37:36.650633 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:37:36.650887 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:37:36.651053 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:37:36.651169 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:37:36.651271 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:37:36.651364 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:37:36.651454 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:37:36.651601 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:37:36.651701 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:37:36.651796 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:37:36.651915 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:37:36.652005 139650945370112 dqn_agent.py:283] 	 seed: 1630625856650573
I0902 23:37:36.654783 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:37:36.655054 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:37:36.655263 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:37:36.655373 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:37:36.655661 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:37:36.655799 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:37:36.655926 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:37:36.656037 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:37:36.656155 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:37:36.685742 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:37:36.705302 139650945370112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:37:36.705626 139650945370112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.23
I0902 23:37:43.591672 139650945370112 replay_runner.py:36] Average training steps per second: 145.23
Steps executed: 202 Episode length: 9 Return: 9.0.0
I0902 23:37:44.750801 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 1

Steps executed: 317 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 191.36
I0902 23:37:50.165627 139650945370112 replay_runner.py:36] Average training steps per second: 191.36
I0902 23:37:50.378228 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 2
I0902 23:37:50.575923 139650945370112 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.85

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:37:55.866324 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:37:56.045231 139650945370112 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.23
I0902 23:38:01.194271 139650945370112 replay_runner.py:36] Average training steps per second: 194.23
I0902 23:38:01.339570 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 23:38:01.518083 139650945370112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 186.38
I0902 23:38:06.883797 139650945370112 replay_runner.py:36] Average training steps per second: 186.38
I0902 23:38:07.016553 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:38:07.205071 139650945370112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 191.66
I0902 23:38:12.423174 139650945370112 replay_runner.py:36] Average training steps per second: 191.66
I0902 23:38:12.563741 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:38:12.755607 139650945370112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 192.57
I0902 23:38:17.948759 139650945370112 replay_runner.py:36] Average training steps per second: 192.57
I0902 23:38:18.085879 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 368 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 190.43
I0902 23:38:23.517351 139650945370112 replay_runner.py:36] Average training steps per second: 190.43
I0902 23:38:23.781353 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 8

Steps executed: 356 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 185.85
I0902 23:38:29.348600 139650945370112 replay_runner.py:36] Average training steps per second: 185.85
I0902 23:38:29.603615 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 9

Steps executed: 286 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 192.62
I0902 23:38:34.994988 139650945370112 replay_runner.py:36] Average training steps per second: 192.62
I0902 23:38:35.206466 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 10

Steps executed: 285 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 182.73
I0902 23:38:40.876069 139650945370112 replay_runner.py:36] Average training steps per second: 182.73
I0902 23:38:41.060339 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 11

Steps executed: 353 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 188.55
I0902 23:38:46.554756 139650945370112 replay_runner.py:36] Average training steps per second: 188.55
I0902 23:38:46.807095 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 12

Steps executed: 356 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 189.34
I0902 23:38:52.286306 139650945370112 replay_runner.py:36] Average training steps per second: 189.34
I0902 23:38:52.520623 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 13

Steps executed: 146 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 184.93

Steps executed: 310 Episode length: 164 Return: 164.0
I0902 23:38:58.323339 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 14

Steps executed: 325 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 193.99
I0902 23:39:03.669481 139650945370112 replay_runner.py:36] Average training steps per second: 193.99
I0902 23:39:03.900771 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 15

Steps executed: 327 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 186.44
I0902 23:39:09.466060 139650945370112 replay_runner.py:36] Average training steps per second: 186.44
I0902 23:39:09.679611 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.40
I0902 23:39:15.291757 139650945370112 replay_runner.py:36] Average training steps per second: 184.40
I0902 23:39:15.446075 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 320 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 192.47
I0902 23:39:20.850508 139650945370112 replay_runner.py:36] Average training steps per second: 192.47
I0902 23:39:21.056284 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.38
I0902 23:39:26.672050 139650945370112 replay_runner.py:36] Average training steps per second: 184.38
I0902 23:39:26.828942 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:39:27.012394 139650945370112 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 196.12
I0902 23:39:32.111741 139650945370112 replay_runner.py:36] Average training steps per second: 196.12
I0902 23:39:32.245888 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 293 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 188.60
I0902 23:39:37.746046 139650945370112 replay_runner.py:36] Average training steps per second: 188.60
I0902 23:39:37.934154 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.02
I0902 23:39:43.419188 139650945370112 replay_runner.py:36] Average training steps per second: 190.02
I0902 23:39:43.557514 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:39:43.749863 139650945370112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.89
I0902 23:39:48.855097 139650945370112 replay_runner.py:36] Average training steps per second: 195.89
I0902 23:39:48.985280 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:39:49.175879 139650945370112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.77
I0902 23:39:54.363767 139650945370112 replay_runner.py:36] Average training steps per second: 192.77
I0902 23:39:54.492660 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:39:54.680532 139650945370112 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.52
I0902 23:39:59.743792 139650945370112 replay_runner.py:36] Average training steps per second: 197.52
I0902 23:39:59.876164 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:40:00.062479 139650945370112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 183.92
I0902 23:40:05.500094 139650945370112 replay_runner.py:36] Average training steps per second: 183.92
I0902 23:40:05.628934 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:40:05.810698 139650945370112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 187.56
I0902 23:40:11.142992 139650945370112 replay_runner.py:36] Average training steps per second: 187.56
I0902 23:40:11.284466 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:40:11.482689 139650945370112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 197.58
I0902 23:40:16.544265 139650945370112 replay_runner.py:36] Average training steps per second: 197.58
I0902 23:40:16.680239 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:40:16.868278 139650945370112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 189.24
I0902 23:40:22.152923 139650945370112 replay_runner.py:36] Average training steps per second: 189.24
I0902 23:40:22.278092 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.23
I0902 23:40:27.635310 139650945370112 replay_runner.py:36] Average training steps per second: 193.23
I0902 23:40:27.855430 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00