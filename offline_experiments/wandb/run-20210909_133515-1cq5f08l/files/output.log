I0909 13:35:20.733628 140419575785472 run_experiment.py:549] Creating TrainRunner ...
I0909 13:35:20.739743 140419575785472 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:20.739867 140419575785472 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:20.739933 140419575785472 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:20.739992 140419575785472 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:20.740046 140419575785472 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:20.740105 140419575785472 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:20.740160 140419575785472 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:20.740216 140419575785472 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:20.740303 140419575785472 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:20.740436 140419575785472 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:20.740551 140419575785472 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:20.740619 140419575785472 dqn_agent.py:283] 	 seed: 1631194520739712
I0909 13:35:20.742446 140419575785472 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:20.742578 140419575785472 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:20.742661 140419575785472 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:20.742732 140419575785472 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:20.742795 140419575785472 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:20.742854 140419575785472 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:20.742939 140419575785472 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:20.743025 140419575785472 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:20.743098 140419575785472 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:35:21.837475 140419575785472 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:21.989603 140419575785472 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:21.998578 140419575785472 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:35:22.002945 140419575785472 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:35:22.003077 140419575785472 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:35:22.003177 140419575785472 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:35:22.003257 140419575785472 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:35:22.003319 140419575785472 dqn_agent.py:275] 	 update_period: 4
I0909 13:35:22.003414 140419575785472 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:35:22.003472 140419575785472 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:35:22.003538 140419575785472 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:35:22.003593 140419575785472 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:35:22.003669 140419575785472 dqn_agent.py:280] 	 optimizer: adam
I0909 13:35:22.003724 140419575785472 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:35:22.003781 140419575785472 dqn_agent.py:283] 	 seed: 1631194522002916
I0909 13:35:22.005509 140419575785472 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:35:22.005633 140419575785472 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:35:22.005713 140419575785472 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:35:22.005783 140419575785472 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:35:22.005847 140419575785472 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:35:22.005915 140419575785472 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:35:22.005988 140419575785472 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:35:22.006079 140419575785472 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:35:22.006148 140419575785472 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:35:22.026635 140419575785472 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:35:22.041387 140419575785472 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:35:22.041532 140419575785472 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 215.37
I0909 13:35:26.684833 140419575785472 replay_runner.py:36] Average training steps per second: 215.37
I0909 13:35:27.629847 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:35:27.718230 140419575785472 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 282.79
I0909 13:35:31.254727 140419575785472 replay_runner.py:36] Average training steps per second: 282.79
I0909 13:35:31.473657 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:35:31.558160 140419575785472 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 261.60
I0909 13:35:35.381321 140419575785472 replay_runner.py:36] Average training steps per second: 261.60
I0909 13:35:35.622039 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:35:35.714477 140419575785472 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 263.30
I0909 13:35:39.513031 140419575785472 replay_runner.py:36] Average training steps per second: 263.30
I0909 13:35:39.755548 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:35:39.849732 140419575785472 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 263.37
I0909 13:35:43.647080 140419575785472 replay_runner.py:36] Average training steps per second: 263.37
I0909 13:35:43.880603 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:35:43.968450 140419575785472 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 260.37
I0909 13:35:47.809571 140419575785472 replay_runner.py:36] Average training steps per second: 260.37
I0909 13:35:48.043265 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:35:48.135268 140419575785472 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 262.96
I0909 13:35:51.938617 140419575785472 replay_runner.py:36] Average training steps per second: 262.96
I0909 13:35:52.176573 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:35:52.261387 140419575785472 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 265.45
I0909 13:35:56.029044 140419575785472 replay_runner.py:36] Average training steps per second: 265.45
I0909 13:35:56.281168 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:35:56.370386 140419575785472 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 262.16
I0909 13:36:00.185344 140419575785472 replay_runner.py:36] Average training steps per second: 262.16
I0909 13:36:00.438089 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:36:00.525432 140419575785472 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 198.93
I0909 13:36:05.552730 140419575785472 replay_runner.py:36] Average training steps per second: 198.93
I0909 13:36:05.802527 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:36:05.902487 140419575785472 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 260.42
I0909 13:36:09.742844 140419575785472 replay_runner.py:36] Average training steps per second: 260.42
I0909 13:36:09.981345 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 709 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.48
I0909 13:36:13.871248 140419575785472 replay_runner.py:36] Average training steps per second: 264.48
I0909 13:36:14.149167 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.50
INFO:tensorflow:Starting iteration 12

Steps executed: 407 Episode length: 214 Return: -214.0
INFO:tensorflow:Average training steps per second: 260.22
I0909 13:36:18.083263 140419575785472 replay_runner.py:36] Average training steps per second: 260.22
I0909 13:36:18.248828 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.50
INFO:tensorflow:Starting iteration 13

Steps executed: 236 Episode length: 118 Return: -118.0
INFO:tensorflow:Average training steps per second: 263.37
I0909 13:36:22.135970 140419575785472 replay_runner.py:36] Average training steps per second: 263.37
I0909 13:36:22.237892 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 14

Steps executed: 214 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 266.63
I0909 13:36:26.077886 140419575785472 replay_runner.py:36] Average training steps per second: 266.63
I0909 13:36:26.167656 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 15

Steps executed: 214 Episode length: 129 Return: -129.0
INFO:tensorflow:Average training steps per second: 266.20
I0909 13:36:30.036448 140419575785472 replay_runner.py:36] Average training steps per second: 266.20
I0909 13:36:30.138614 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 16

Steps executed: 241 Episode length: 122 Return: -122.0
INFO:tensorflow:Average training steps per second: 263.62
I0909 13:36:34.020878 140419575785472 replay_runner.py:36] Average training steps per second: 263.62
I0909 13:36:34.126740 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 17

Steps executed: 211 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 257.61
I0909 13:36:38.101904 140419575785472 replay_runner.py:36] Average training steps per second: 257.61
I0909 13:36:38.196875 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 18

Steps executed: 210 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 261.22
I0909 13:36:42.119249 140419575785472 replay_runner.py:36] Average training steps per second: 261.22
I0909 13:36:42.206780 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 19

Steps executed: 226 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 259.15
I0909 13:36:46.155031 140419575785472 replay_runner.py:36] Average training steps per second: 259.15
I0909 13:36:46.255421 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 20

Steps executed: 240 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 263.57
I0909 13:36:50.143434 140419575785472 replay_runner.py:36] Average training steps per second: 263.57
I0909 13:36:50.242035 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 21

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 259.91
I0909 13:36:54.182873 140419575785472 replay_runner.py:36] Average training steps per second: 259.91
I0909 13:36:54.435712 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22

Steps executed: 225 Episode length: 128 Return: -128.0
INFO:tensorflow:Average training steps per second: 257.44
I0909 13:36:58.417406 140419575785472 replay_runner.py:36] Average training steps per second: 257.44
I0909 13:36:58.514854 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 261.56
I0909 13:37:02.426649 140419575785472 replay_runner.py:36] Average training steps per second: 261.56
I0909 13:37:02.517149 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 102 Return: -102.0
INFO:tensorflow:Average training steps per second: 262.27
I0909 13:37:06.420660 140419575785472 replay_runner.py:36] Average training steps per second: 262.27
I0909 13:37:06.505332 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 25

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.20
I0909 13:37:10.384483 140419575785472 replay_runner.py:36] Average training steps per second: 264.20
I0909 13:37:10.633155 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 260.61
I0909 13:37:14.564472 140419575785472 replay_runner.py:36] Average training steps per second: 260.61
I0909 13:37:14.656121 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 122 Return: -122.0
INFO:tensorflow:Average training steps per second: 261.99
I0909 13:37:18.566060 140419575785472 replay_runner.py:36] Average training steps per second: 261.99
I0909 13:37:18.674906 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 28

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 272.33
I0909 13:37:22.435973 140419575785472 replay_runner.py:36] Average training steps per second: 272.33
I0909 13:37:22.517558 140419575785472 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 29
I0909 13:37:22.602299 140419575785472 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 285.79
I0909 13:37:26.101866 140419575785472 replay_runner.py:36] Average training steps per second: 285.79

Done fixed training!Episode length: 109 Return: -109.0