Loaded trained dqn in mountaincar
Training fixed agent 3, please be patient, may be a while...
I0909 14:06:10.922514 140283190306816 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 14:06:10.923046 140283190306816 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 14:06:10.975321 140283190306816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:10.976565 140283190306816 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:10.976653 140283190306816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:10.976711 140283190306816 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:10.976798 140283190306816 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:10.976884 140283190306816 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:10.977005 140283190306816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:10.977090 140283190306816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:10.977167 140283190306816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:10.977246 140283190306816 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:10.977313 140283190306816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:10.977381 140283190306816 dqn_agent.py:283] 	 seed: 1631196370975261
I0909 14:06:10.978867 140283190306816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:10.978988 140283190306816 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:10.979040 140283190306816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:10.979097 140283190306816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:10.979147 140283190306816 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:10.979194 140283190306816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:10.979252 140283190306816 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:10.979326 140283190306816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:10.979406 140283190306816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.215655 140283190306816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.423958 140283190306816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.432100 140283190306816 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 14:06:12.437017 140283190306816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 14:06:12.437160 140283190306816 dqn_agent.py:272] 	 gamma: 0.990000
I0909 14:06:12.437237 140283190306816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 14:06:12.437297 140283190306816 dqn_agent.py:274] 	 min_replay_history: 500
I0909 14:06:12.437352 140283190306816 dqn_agent.py:275] 	 update_period: 4
I0909 14:06:12.437421 140283190306816 dqn_agent.py:276] 	 target_update_period: 100
I0909 14:06:12.437509 140283190306816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 14:06:12.437609 140283190306816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 14:06:12.437684 140283190306816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 14:06:12.437769 140283190306816 dqn_agent.py:280] 	 optimizer: adam
I0909 14:06:12.437876 140283190306816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 14:06:12.437949 140283190306816 dqn_agent.py:283] 	 seed: 1631196372436991
I0909 14:06:12.439338 140283190306816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 14:06:12.439443 140283190306816 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 14:06:12.439506 140283190306816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 14:06:12.439560 140283190306816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 14:06:12.439610 140283190306816 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 14:06:12.439673 140283190306816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 14:06:12.439729 140283190306816 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 14:06:12.439796 140283190306816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 14:06:12.439882 140283190306816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 14:06:12.458047 140283190306816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 14:06:12.467946 140283190306816 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 14:06:12.468095 140283190306816 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 214.47
I0909 14:06:17.130821 140283190306816 replay_runner.py:36] Average training steps per second: 214.47
I0909 14:06:17.927041 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 14:06:18.015141 140283190306816 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 257.05
I0909 14:06:21.906351 140283190306816 replay_runner.py:36] Average training steps per second: 257.05
I0909 14:06:22.170202 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 14:06:22.260046 140283190306816 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 194.81
I0909 14:06:27.393608 140283190306816 replay_runner.py:36] Average training steps per second: 194.81
I0909 14:06:27.736840 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 14:06:27.825304 140283190306816 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 257.33
I0909 14:06:31.713336 140283190306816 replay_runner.py:36] Average training steps per second: 257.33
I0909 14:06:31.967988 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 14:06:32.076347 140283190306816 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 254.09
I0909 14:06:36.014814 140283190306816 replay_runner.py:36] Average training steps per second: 254.09
I0909 14:06:36.278842 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 14:06:36.371845 140283190306816 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 262.08
I0909 14:06:40.188107 140283190306816 replay_runner.py:36] Average training steps per second: 262.08
I0909 14:06:40.431600 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6

Steps executed: 695 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 254.77
I0909 14:06:44.452370 140283190306816 replay_runner.py:36] Average training steps per second: 254.77
I0909 14:06:44.745938 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.50
INFO:tensorflow:Starting iteration 7

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 263.34
I0909 14:06:48.636949 140283190306816 replay_runner.py:36] Average training steps per second: 263.34
I0909 14:06:48.888075 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 270 Episode length: 101 Return: -101.0
INFO:tensorflow:Average training steps per second: 263.14
I0909 14:06:52.783573 140283190306816 replay_runner.py:36] Average training steps per second: 263.14
I0909 14:06:52.900598 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 9

Steps executed: 235 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 258.14
I0909 14:06:56.886329 140283190306816 replay_runner.py:36] Average training steps per second: 258.14
I0909 14:06:56.991449 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 10
I0909 14:06:57.086414 140283190306816 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 263.63

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 14:07:01.140372 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 14:07:01.233047 140283190306816 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 264.70
I0909 14:07:05.011431 140283190306816 replay_runner.py:36] Average training steps per second: 264.70
I0909 14:07:05.278613 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0909 14:07:05.370860 140283190306816 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 256.04
I0909 14:07:09.276825 140283190306816 replay_runner.py:36] Average training steps per second: 256.04
I0909 14:07:09.533994 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13

Steps executed: 227 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 255.52
I0909 14:07:13.539696 140283190306816 replay_runner.py:36] Average training steps per second: 255.52
I0909 14:07:13.640588 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 14

Steps executed: 215 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 260.56
I0909 14:07:17.577035 140283190306816 replay_runner.py:36] Average training steps per second: 260.56
I0909 14:07:17.674147 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.90
I0909 14:07:21.540956 140283190306816 replay_runner.py:36] Average training steps per second: 264.90
I0909 14:07:21.798549 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0909 14:07:21.888694 140283190306816 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 261.41
I0909 14:07:25.714336 140283190306816 replay_runner.py:36] Average training steps per second: 261.41
I0909 14:07:25.974318 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17

Steps executed: 295 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 260.39
I0909 14:07:29.914561 140283190306816 replay_runner.py:36] Average training steps per second: 260.39
I0909 14:07:30.050156 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.33
INFO:tensorflow:Starting iteration 18

Steps executed: 254 Episode length: 126 Return: -126.0
INFO:tensorflow:Average training steps per second: 258.60
I0909 14:07:34.014495 140283190306816 replay_runner.py:36] Average training steps per second: 258.60
I0909 14:07:34.136151 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 19

Steps executed: 230 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 256.40
I0909 14:07:38.132441 140283190306816 replay_runner.py:36] Average training steps per second: 256.40
I0909 14:07:38.239104 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 20

Steps executed: 218 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 255.22
I0909 14:07:42.261573 140283190306816 replay_runner.py:36] Average training steps per second: 255.22
I0909 14:07:42.358777 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 21

Steps executed: 231 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 259.10
I0909 14:07:46.309861 140283190306816 replay_runner.py:36] Average training steps per second: 259.10
I0909 14:07:46.412300 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 22

Steps executed: 324 Episode length: 162 Return: -162.0
INFO:tensorflow:Average training steps per second: 255.93
I0909 14:07:50.408764 140283190306816 replay_runner.py:36] Average training steps per second: 255.93
I0909 14:07:50.545758 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.00
INFO:tensorflow:Starting iteration 23

Steps executed: 283 Episode length: 95 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 253.86
I0909 14:07:54.577636 140283190306816 replay_runner.py:36] Average training steps per second: 253.86
I0909 14:07:54.708917 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 24

Steps executed: 243 Episode length: 139 Return: -139.0
INFO:tensorflow:Average training steps per second: 261.43
I0909 14:07:58.632672 140283190306816 replay_runner.py:36] Average training steps per second: 261.43
I0909 14:07:58.741873 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 25

Steps executed: 211 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 261.98
I0909 14:08:02.653379 140283190306816 replay_runner.py:36] Average training steps per second: 261.98
I0909 14:08:02.743822 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 26

Steps executed: 320 Episode length: 125 Return: -125.0
INFO:tensorflow:Average training steps per second: 262.03
I0909 14:08:06.654405 140283190306816 replay_runner.py:36] Average training steps per second: 262.03
I0909 14:08:06.787152 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.67
INFO:tensorflow:Starting iteration 27

Steps executed: 306 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 260.15
I0909 14:08:10.728517 140283190306816 replay_runner.py:36] Average training steps per second: 260.15
I0909 14:08:10.866566 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 28

Steps executed: 295 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 255.93
I0909 14:08:14.866333 140283190306816 replay_runner.py:36] Average training steps per second: 255.93
I0909 14:08:14.978384 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 317.53
I0909 14:08:18.215602 140283190306816 replay_runner.py:36] Average training steps per second: 317.53
I0909 14:08:18.272804 140283190306816 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50