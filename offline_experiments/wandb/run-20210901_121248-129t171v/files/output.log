Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0901 12:12:55.026494 139983334602752 run_experiment.py:549] Creating TrainRunner ...
I0901 12:12:55.036129 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:55.036340 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:55.036498 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:55.036639 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:55.036787 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:55.036910 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:55.036990 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:55.037056 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:55.037120 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:55.037184 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:55.037257 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:55.037364 139983334602752 dqn_agent.py:283] 	 seed: 1630498375036076
I0901 12:12:55.041261 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:55.041523 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:12:55.041723 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:55.041862 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:55.041997 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:55.042089 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:55.042306 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:55.042450 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:55.042684 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:55.106864 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:55.592219 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:55.607550 139983334602752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:12:55.615640 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:55.615869 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:55.616009 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:55.616148 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:55.616245 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:55.616322 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:55.616382 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:55.616439 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:55.616700 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:55.616879 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:55.616973 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:55.617058 139983334602752 dqn_agent.py:283] 	 seed: 1630498375615566
I0901 12:12:55.619833 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:55.620072 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:12:55.620248 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:55.620523 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:55.620713 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:55.620860 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:55.621061 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:55.621249 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:55.621404 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:55.657481 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:55.680472 139983334602752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:12:55.680814 139983334602752 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 204 Return: -203.0
INFO:tensorflow:Average training steps per second: 137.91
I0901 12:13:02.932398 139983334602752 replay_runner.py:36] Average training steps per second: 137.91
I0901 12:13:04.219096 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.93
I0901 12:13:09.649427 139983334602752 replay_runner.py:36] Average training steps per second: 192.93
I0901 12:13:10.103021 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:13:10.355027 139983334602752 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.27
I0901 12:13:15.529528 139983334602752 replay_runner.py:36] Average training steps per second: 193.27
I0901 12:13:15.940886 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:13:16.190081 139983334602752 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 187.41
I0901 12:13:21.526340 139983334602752 replay_runner.py:36] Average training steps per second: 187.41
I0901 12:13:21.921399 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:13:22.156481 139983334602752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 192.02
I0901 12:13:27.364630 139983334602752 replay_runner.py:36] Average training steps per second: 192.02
I0901 12:13:27.806015 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 259 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 196.41
I0901 12:13:33.152348 139983334602752 replay_runner.py:36] Average training steps per second: 196.41
I0901 12:13:33.355840 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 6
I0901 12:13:33.592206 139983334602752 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 184.90

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:13:39.426527 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 195.19
I0901 12:13:44.794818 139983334602752 replay_runner.py:36] Average training steps per second: 195.19
I0901 12:13:44.971138 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 194.14
I0901 12:13:50.358074 139983334602752 replay_runner.py:36] Average training steps per second: 194.14
I0901 12:13:50.534683 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 9

Steps executed: 248 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 190.70
I0901 12:13:55.995334 139983334602752 replay_runner.py:36] Average training steps per second: 190.70
I0901 12:13:56.225782 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 204.96
I0901 12:14:01.362540 139983334602752 replay_runner.py:36] Average training steps per second: 204.96
I0901 12:14:01.804746 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:14:02.060937 139983334602752 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 192.30

Steps executed: 201 Episode length: 121 Return: -120.0
I0901 12:14:07.438619 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 12

Steps executed: 246 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 191.59
I0901 12:14:12.903643 139983334602752 replay_runner.py:36] Average training steps per second: 191.59
I0901 12:14:13.132288 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 13

Steps executed: 95 Episode length: 95 Return: -94.00.0
INFO:tensorflow:Average training steps per second: 196.45

Steps executed: 595 Episode length: 500 Return: -500.0
I0901 12:14:18.966608 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.00
INFO:tensorflow:Starting iteration 14

Steps executed: 284 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 208.38
I0901 12:14:23.997622 139983334602752 replay_runner.py:36] Average training steps per second: 208.38
I0901 12:14:24.214972 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 15

Steps executed: 602 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.10
I0901 12:14:29.649914 139983334602752 replay_runner.py:36] Average training steps per second: 192.10
I0901 12:14:30.142638 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.50
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 196.25
I0901 12:14:35.491359 139983334602752 replay_runner.py:36] Average training steps per second: 196.25
I0901 12:14:35.713051 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 17

Steps executed: 269 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 189.77
I0901 12:14:41.225777 139983334602752 replay_runner.py:36] Average training steps per second: 189.77
I0901 12:14:41.455835 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 18

Steps executed: 283 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 202.03
I0901 12:14:46.650067 139983334602752 replay_runner.py:36] Average training steps per second: 202.03
I0901 12:14:46.891405 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 19

Steps executed: 289 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 192.69
I0901 12:14:52.317144 139983334602752 replay_runner.py:36] Average training steps per second: 192.69
I0901 12:14:52.547571 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.33
INFO:tensorflow:Starting iteration 20

Steps executed: 226 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 184.55
I0901 12:14:58.210877 139983334602752 replay_runner.py:36] Average training steps per second: 184.55
I0901 12:14:58.405714 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33
INFO:tensorflow:Starting iteration 21

Steps executed: 249 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 196.40
I0901 12:15:03.739072 139983334602752 replay_runner.py:36] Average training steps per second: 196.40
I0901 12:15:03.953619 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 22
I0901 12:15:04.193028 139983334602752 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 194.40

Steps executed: 200 Episode length: 106 Return: -105.0
I0901 12:15:09.499226 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 23

Steps executed: 300 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 201.47
I0901 12:15:14.697218 139983334602752 replay_runner.py:36] Average training steps per second: 201.47
I0901 12:15:14.941639 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 24

Steps executed: 236 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 189.87
I0901 12:15:20.445636 139983334602752 replay_runner.py:36] Average training steps per second: 189.87
I0901 12:15:20.635500 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 25

Steps executed: 225 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 202.17
I0901 12:15:25.807955 139983334602752 replay_runner.py:36] Average training steps per second: 202.17
I0901 12:15:25.986562 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 26
I0901 12:15:26.223262 139983334602752 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 189.24

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:15:31.904107 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 219.37
I0901 12:15:36.688702 139983334602752 replay_runner.py:36] Average training steps per second: 219.37
I0901 12:15:36.831498 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 28

Steps executed: 269 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 206.84
I0901 12:15:41.872463 139983334602752 replay_runner.py:36] Average training steps per second: 206.84
I0901 12:15:42.087955 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 245.56
I0901 12:15:46.412627 139983334602752 replay_runner.py:36] Average training steps per second: 245.56
I0901 12:15:46.725656 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00