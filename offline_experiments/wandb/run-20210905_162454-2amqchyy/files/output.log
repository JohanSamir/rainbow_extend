I0905 16:25:00.443147 140017592051712 run_experiment.py:549] Creating TrainRunner ...
I0905 16:25:00.453452 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:00.453664 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:00.453828 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:00.454038 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:00.454154 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:00.454331 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:00.454461 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:00.454566 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:00.454671 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:00.454861 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:00.454977 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:25:00.455091 140017592051712 dqn_agent.py:283] 	 seed: 1630859100453401
I0905 16:25:00.458067 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:00.458242 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:00.458402 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:00.458624 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:00.458744 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:00.458907 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:00.459094 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:00.459206 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:00.459359 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:25:01.910457 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:02.304643 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:02.320535 140017592051712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:25:02.326446 140017592051712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:02.326578 140017592051712 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:02.326662 140017592051712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:02.326731 140017592051712 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:02.326792 140017592051712 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:02.326853 140017592051712 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:02.326936 140017592051712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:02.326998 140017592051712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:02.327081 140017592051712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:02.327161 140017592051712 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:02.327221 140017592051712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
Steps executed: 215 Episode length: 17 Return: 17.0
I0905 16:25:02.327300 140017592051712 dqn_agent.py:283] 	 seed: 1630859102326416
I0905 16:25:02.328871 140017592051712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:02.328989 140017592051712 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:02.329066 140017592051712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:02.329142 140017592051712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:02.329207 140017592051712 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:02.329268 140017592051712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:02.329343 140017592051712 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:02.329428 140017592051712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:02.329501 140017592051712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:25:02.348799 140017592051712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:02.361353 140017592051712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:25:02.361498 140017592051712 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 203.89
I0905 16:25:07.266397 140017592051712 replay_runner.py:36] Average training steps per second: 203.89
I0905 16:25:07.920115 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.54
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 364.23
I0905 16:25:10.797955 140017592051712 replay_runner.py:36] Average training steps per second: 364.23
I0905 16:25:10.858550 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 2
I0905 16:25:10.986315 140017592051712 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 365.79
I0905 16:25:13.720386 140017592051712 replay_runner.py:36] Average training steps per second: 365.79
I0905 16:25:13.782829 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 3

Steps executed: 209 Episode length: 18 Return: 18.0
INFO:tensorflow:Average training steps per second: 358.86
I0905 16:25:16.696269 140017592051712 replay_runner.py:36] Average training steps per second: 358.86
I0905 16:25:16.764083 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.08
INFO:tensorflow:Starting iteration 4

Steps executed: 378 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 349.73
I0905 16:25:19.747678 140017592051712 replay_runner.py:36] Average training steps per second: 349.73
I0905 16:25:19.860966 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 354.72
I0905 16:25:22.815108 140017592051712 replay_runner.py:36] Average training steps per second: 354.72
I0905 16:25:22.870252 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0905 16:25:22.994623 140017592051712 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 354.45
I0905 16:25:25.816204 140017592051712 replay_runner.py:36] Average training steps per second: 354.45
I0905 16:25:25.877383 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0905 16:25:26.007740 140017592051712 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 363.49
I0905 16:25:28.759251 140017592051712 replay_runner.py:36] Average training steps per second: 363.49
I0905 16:25:28.821400 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0905 16:25:28.950834 140017592051712 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 353.95
I0905 16:25:31.776415 140017592051712 replay_runner.py:36] Average training steps per second: 353.95
I0905 16:25:31.838374 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0905 16:25:31.971381 140017592051712 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 355.51
I0905 16:25:34.784557 140017592051712 replay_runner.py:36] Average training steps per second: 355.51
I0905 16:25:34.842123 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 359 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 364.95
I0905 16:25:37.712164 140017592051712 replay_runner.py:36] Average training steps per second: 364.95
I0905 16:25:37.807945 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50
INFO:tensorflow:Starting iteration 11

Steps executed: 376 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 359.79
I0905 16:25:40.713208 140017592051712 replay_runner.py:36] Average training steps per second: 359.79
I0905 16:25:40.816111 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 354.65
I0905 16:25:43.764004 140017592051712 replay_runner.py:36] Average training steps per second: 354.65
I0905 16:25:43.821090 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 359.45
I0905 16:25:46.729899 140017592051712 replay_runner.py:36] Average training steps per second: 359.45
I0905 16:25:46.841412 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 14

Steps executed: 319 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 360.62
I0905 16:25:49.745354 140017592051712 replay_runner.py:36] Average training steps per second: 360.62
I0905 16:25:49.838371 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.50
INFO:tensorflow:Starting iteration 15

Steps executed: 292 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 364.05
I0905 16:25:52.713862 140017592051712 replay_runner.py:36] Average training steps per second: 364.05
I0905 16:25:52.800832 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 16

Steps executed: 317 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 367.49
I0905 16:25:55.653346 140017592051712 replay_runner.py:36] Average training steps per second: 367.49
I0905 16:25:55.751750 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 17
I0905 16:25:55.882971 140017592051712 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 361.37

Steps executed: 317 Episode length: 167 Return: 167.0
I0905 16:25:58.736051 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 18

Steps executed: 322 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 364.85
I0905 16:26:01.600861 140017592051712 replay_runner.py:36] Average training steps per second: 364.85
I0905 16:26:01.714776 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 361.18
I0905 16:26:04.634312 140017592051712 replay_runner.py:36] Average training steps per second: 361.18
I0905 16:26:04.694987 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 350 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 354.34
I0905 16:26:07.655474 140017592051712 replay_runner.py:36] Average training steps per second: 354.34
I0905 16:26:07.765604 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 21
I0905 16:26:07.897297 140017592051712 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 352.89

Steps executed: 389 Episode length: 200 Return: 200.0
I0905 16:26:10.853752 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 22

Steps executed: 376 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 342.54
I0905 16:26:13.907912 140017592051712 replay_runner.py:36] Average training steps per second: 342.54
I0905 16:26:14.014346 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 23

Steps executed: 353 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 355.41
I0905 16:26:16.956672 140017592051712 replay_runner.py:36] Average training steps per second: 355.41
I0905 16:26:17.059710 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 24

Steps executed: 339 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 367.33
I0905 16:26:19.906341 140017592051712 replay_runner.py:36] Average training steps per second: 367.33
I0905 16:26:20.006092 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 366.66
I0905 16:26:22.858186 140017592051712 replay_runner.py:36] Average training steps per second: 366.66
I0905 16:26:22.917971 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0905 16:26:23.045765 140017592051712 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 354.47
I0905 16:26:25.867181 140017592051712 replay_runner.py:36] Average training steps per second: 354.47
I0905 16:26:25.925121 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:26:26.053426 140017592051712 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 353.48
I0905 16:26:28.882851 140017592051712 replay_runner.py:36] Average training steps per second: 353.48
I0905 16:26:28.941077 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 16:26:29.065315 140017592051712 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 359.43
I0905 16:26:31.847790 140017592051712 replay_runner.py:36] Average training steps per second: 359.43
I0905 16:26:31.902305 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 364.21
I0905 16:26:34.772287 140017592051712 replay_runner.py:36] Average training steps per second: 364.21
I0905 16:26:34.892639 140017592051712 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00