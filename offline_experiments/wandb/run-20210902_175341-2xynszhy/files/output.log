Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0902 17:53:47.719484 140665773373440 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:47.728679 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:47.728940 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:47.729102 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:47.729238 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:47.729380 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:47.729476 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:47.729552 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:47.729642 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:47.730097 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:47.730301 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:47.730463 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:47.730594 140665773373440 dqn_agent.py:283] 	 seed: 1630605227728619
I0902 17:53:47.733920 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:47.734081 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:47.734192 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:47.734342 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:47.734457 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:47.734601 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:47.734712 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:47.734787 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:47.734890 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:47.769592 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:48.204051 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:48.235420 140665773373440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:48.244537 140665773373440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:48.244757 140665773373440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:48.244915 140665773373440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:48.245064 140665773373440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:48.245203 140665773373440 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:48.245300 140665773373440 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:48.245409 140665773373440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:48.245491 140665773373440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:48.245617 140665773373440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:48.245733 140665773373440 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:48.245857 140665773373440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:48.245951 140665773373440 dqn_agent.py:283] 	 seed: 1630605228244483
I0902 17:53:48.248810 140665773373440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:48.249068 140665773373440 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:48.249219 140665773373440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:48.249354 140665773373440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:48.249483 140665773373440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:48.249611 140665773373440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:48.249999 140665773373440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:48.250214 140665773373440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:48.250325 140665773373440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:48.286155 140665773373440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:48.314433 140665773373440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:48.314792 140665773373440 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 140.42
I0902 17:53:55.436686 140665773373440 replay_runner.py:36] Average training steps per second: 140.42
I0902 17:53:56.949857 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:53:57.188342 140665773373440 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 199.27
I0902 17:54:02.207252 140665773373440 replay_runner.py:36] Average training steps per second: 199.27
I0902 17:54:02.627430 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:54:02.860436 140665773373440 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 195.90
I0902 17:54:07.965620 140665773373440 replay_runner.py:36] Average training steps per second: 195.90
I0902 17:54:08.364540 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:54:08.609077 140665773373440 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.65
I0902 17:54:13.694599 140665773373440 replay_runner.py:36] Average training steps per second: 196.65
I0902 17:54:14.102151 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:54:14.345993 140665773373440 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 200.06
I0902 17:54:19.345040 140665773373440 replay_runner.py:36] Average training steps per second: 200.06
I0902 17:54:19.755540 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:54:20.007257 140665773373440 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 195.25
I0902 17:54:25.129330 140665773373440 replay_runner.py:36] Average training steps per second: 195.25
I0902 17:54:25.565762 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:54:25.813491 140665773373440 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 191.97
I0902 17:54:31.023000 140665773373440 replay_runner.py:36] Average training steps per second: 191.97
I0902 17:54:31.459619 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 293 Episode length: 167 Return: -166.0
INFO:tensorflow:Average training steps per second: 190.80
I0902 17:54:36.950909 140665773373440 replay_runner.py:36] Average training steps per second: 190.80
I0902 17:54:37.200597 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.50
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.86
I0902 17:54:42.620884 140665773373440 replay_runner.py:36] Average training steps per second: 192.86
I0902 17:54:43.029762 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 242 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 195.37
I0902 17:54:48.398051 140665773373440 replay_runner.py:36] Average training steps per second: 195.37
I0902 17:54:48.607794 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 10
I0902 17:54:48.824971 140665773373440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 199.22

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:54:54.278316 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:54:54.521519 140665773373440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 194.85
I0902 17:54:59.654126 140665773373440 replay_runner.py:36] Average training steps per second: 194.85
I0902 17:55:00.087871 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:55:00.342308 140665773373440 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 198.17
I0902 17:55:05.388977 140665773373440 replay_runner.py:36] Average training steps per second: 198.17
I0902 17:55:05.834394 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:55:06.065916 140665773373440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 199.70
I0902 17:55:11.073787 140665773373440 replay_runner.py:36] Average training steps per second: 199.70
I0902 17:55:11.486449 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 658 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.28
I0902 17:55:16.825577 140665773373440 replay_runner.py:36] Average training steps per second: 196.28
I0902 17:55:17.378358 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.50
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.05
I0902 17:55:22.698992 140665773373440 replay_runner.py:36] Average training steps per second: 197.05
I0902 17:55:23.099575 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:55:23.343658 140665773373440 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 205.59
I0902 17:55:28.208333 140665773373440 replay_runner.py:36] Average training steps per second: 205.59
I0902 17:55:28.583683 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:55:28.809680 140665773373440 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 201.06
I0902 17:55:33.783672 140665773373440 replay_runner.py:36] Average training steps per second: 201.06
I0902 17:55:34.166142 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 267 Episode length: 147 Return: -146.0
INFO:tensorflow:Average training steps per second: 201.11
I0902 17:55:39.369167 140665773373440 replay_runner.py:36] Average training steps per second: 201.11
I0902 17:55:39.566369 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.50
INFO:tensorflow:Starting iteration 19

Steps executed: 241 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 203.10
I0902 17:55:44.728408 140665773373440 replay_runner.py:36] Average training steps per second: 203.10
I0902 17:55:44.928821 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.81
I0902 17:55:50.071555 140665773373440 replay_runner.py:36] Average training steps per second: 203.81
I0902 17:55:50.498458 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:55:50.738877 140665773373440 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 203.28
I0902 17:55:55.658729 140665773373440 replay_runner.py:36] Average training steps per second: 203.28
I0902 17:55:56.057618 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 303 Episode length: 174 Return: -173.0
INFO:tensorflow:Average training steps per second: 203.69
I0902 17:56:01.203141 140665773373440 replay_runner.py:36] Average training steps per second: 203.69
I0902 17:56:01.449788 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 23

Steps executed: 330 Episode length: 135 Return: -134.0
INFO:tensorflow:Average training steps per second: 218.63
I0902 17:56:06.269212 140665773373440 replay_runner.py:36] Average training steps per second: 218.63
I0902 17:56:06.514934 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 24

Steps executed: 278 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 207.64
I0902 17:56:11.571716 140665773373440 replay_runner.py:36] Average training steps per second: 207.64
I0902 17:56:11.785185 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 25

Steps executed: 209 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 215.79
I0902 17:56:16.718203 140665773373440 replay_runner.py:36] Average training steps per second: 215.79
I0902 17:56:16.880015 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 26
I0902 17:56:17.106054 140665773373440 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.07

Steps executed: 214 Episode length: 113 Return: -112.0
I0902 17:56:22.390091 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 27

Steps executed: 352 Episode length: 164 Return: -163.0
INFO:tensorflow:Average training steps per second: 200.48
I0902 17:56:27.622037 140665773373440 replay_runner.py:36] Average training steps per second: 200.48
I0902 17:56:27.921741 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.33
INFO:tensorflow:Starting iteration 28

Steps executed: 228 Episode length: 150 Return: -149.0
INFO:tensorflow:Average training steps per second: 199.20
I0902 17:56:33.186552 140665773373440 replay_runner.py:36] Average training steps per second: 199.20
I0902 17:56:33.381710 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: -199.0
INFO:tensorflow:Average training steps per second: 200.14
I0902 17:56:38.634300 140665773373440 replay_runner.py:36] Average training steps per second: 200.14
I0902 17:56:38.792433 140665773373440 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.00