Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0902 23:15:25.256632 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0902 23:15:25.269164 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:25.269495 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:25.269720 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:25.269839 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:25.269957 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:25.270081 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:25.270210 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:25.270408 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:25.270668 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:25.270817 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:25.270939 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:25.271101 139926926592000 dqn_agent.py:283] 	 seed: 1630624525269088
I0902 23:15:25.273376 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:25.273515 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:25.273607 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:25.273677 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:25.273769 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:25.273833 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:25.273920 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:25.273991 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:25.274050 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:25.308344 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:25.714673 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:25.729743 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:15:25.738437 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:25.738690 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:25.738865 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:25.738961 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:25.739193 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:25.739298 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:25.739375 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:25.739793 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:25.739946 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:25.740044 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:25.741036 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:25.746453 139926926592000 dqn_agent.py:283] 	 seed: 1630624525738388
I0902 23:15:25.776007 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:25.776283 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:25.776556 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:25.776746 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:25.776897 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:25.777021 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:25.777131 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:25.777265 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:25.777383 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:25.809437 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:25.841410 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:15:25.841976 139926926592000 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.65
I0902 23:15:31.843222 139926926592000 replay_runner.py:36] Average training steps per second: 166.65
Steps executed: 292 Episode length: 101 Return: -222.26452290867422
I0902 23:15:33.023891 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.94
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 61 Return: -127.117825621729482
INFO:tensorflow:Average training steps per second: 225.02
I0902 23:15:41.841863 139926926592000 replay_runner.py:36] Average training steps per second: 225.02
I0902 23:15:41.968358 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.74
INFO:tensorflow:Starting iteration 2

Steps executed: 258 Episode length: 64 Return: 51.47471027232646762
INFO:tensorflow:Average training steps per second: 233.80
I0902 23:15:50.411610 139926926592000 replay_runner.py:36] Average training steps per second: 233.80
I0902 23:15:50.583473 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.63
INFO:tensorflow:Starting iteration 3

Steps executed: 204 Episode length: 75 Return: -145.769357752376152
INFO:tensorflow:Average training steps per second: 251.71
I0902 23:15:58.660903 139926926592000 replay_runner.py:36] Average training steps per second: 251.71
I0902 23:15:58.818742 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.36
INFO:tensorflow:Starting iteration 4

Steps executed: 220 Episode length: 77 Return: -144.818480404241572
INFO:tensorflow:Average training steps per second: 235.43
I0902 23:16:07.221197 139926926592000 replay_runner.py:36] Average training steps per second: 235.43
I0902 23:16:07.368849 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.29
INFO:tensorflow:Starting iteration 5

Steps executed: 285 Episode length: 86 Return: -126.169257052593252
INFO:tensorflow:Average training steps per second: 227.69
I0902 23:16:15.891401 139926926592000 replay_runner.py:36] Average training steps per second: 227.69
I0902 23:16:16.080047 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.77
INFO:tensorflow:Starting iteration 6
I0902 23:16:20.394990 139926926592000 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 217.29

Steps executed: 245 Episode length: 89 Return: -102.278843780664672
I0902 23:16:25.158165 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.76
INFO:tensorflow:Starting iteration 7

Steps executed: 228 Episode length: 71 Return: -132.546240118064582
INFO:tensorflow:Average training steps per second: 216.03
I0902 23:16:33.867799 139926926592000 replay_runner.py:36] Average training steps per second: 216.03
I0902 23:16:34.023170 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.76
INFO:tensorflow:Starting iteration 8

Steps executed: 250 Episode length: 55 Return: -114.472597186149752
INFO:tensorflow:Average training steps per second: 216.55
I0902 23:16:42.752653 139926926592000 replay_runner.py:36] Average training steps per second: 216.55
I0902 23:16:42.921215 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.74
INFO:tensorflow:Starting iteration 9

Steps executed: 242 Episode length: 66 Return: -181.350161957492052
INFO:tensorflow:Average training steps per second: 217.41
I0902 23:16:51.377131 139926926592000 replay_runner.py:36] Average training steps per second: 217.41
I0902 23:16:51.547498 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.84
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 72 Return: -144.134631275423322
INFO:tensorflow:Average training steps per second: 220.45
I0902 23:17:00.251427 139926926592000 replay_runner.py:36] Average training steps per second: 220.45
I0902 23:17:00.395529 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.16
INFO:tensorflow:Starting iteration 11
I0902 23:17:04.731578 139926926592000 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 221.05

Steps executed: 220 Episode length: 78 Return: -179.676833374898882
I0902 23:17:09.403291 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.72
INFO:tensorflow:Starting iteration 12

Steps executed: 233 Episode length: 60 Return: -155.810012527126732
INFO:tensorflow:Average training steps per second: 219.10
I0902 23:17:18.268410 139926926592000 replay_runner.py:36] Average training steps per second: 219.10
I0902 23:17:18.424912 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.53
INFO:tensorflow:Starting iteration 13

Steps executed: 58 Episode length: 58 Return: -112.1635124948200532
INFO:tensorflow:Average training steps per second: 221.08
I0902 23:17:27.293331 139926926592000 replay_runner.py:36] Average training steps per second: 221.08

Steps executed: 243 Episode length: 64 Return: -137.771045603892652
INFO:tensorflow:Starting iteration 14

Steps executed: 230 Episode length: 78 Return: -151.133335756277832
INFO:tensorflow:Average training steps per second: 217.91
I0902 23:17:36.326981 139926926592000 replay_runner.py:36] Average training steps per second: 217.91
I0902 23:17:36.480524 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.14
INFO:tensorflow:Starting iteration 15

Steps executed: 85 Episode length: 85 Return: -150.6223259699697232
INFO:tensorflow:Average training steps per second: 220.83
I0902 23:17:45.402071 139926926592000 replay_runner.py:36] Average training steps per second: 220.83

Steps executed: 220 Episode length: 82 Return: -122.393339086856712
INFO:tensorflow:Starting iteration 16

Steps executed: 245 Episode length: 72 Return: -152.001305966115952
INFO:tensorflow:Average training steps per second: 215.32
I0902 23:17:54.546073 139926926592000 replay_runner.py:36] Average training steps per second: 215.32
I0902 23:17:54.711831 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.22
INFO:tensorflow:Starting iteration 17

Steps executed: 218 Episode length: 60 Return: -102.116228359152572
INFO:tensorflow:Average training steps per second: 231.70
I0902 23:18:02.875802 139926926592000 replay_runner.py:36] Average training steps per second: 231.70
I0902 23:18:03.025645 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.88
INFO:tensorflow:Starting iteration 18

Steps executed: 243 Episode length: 68 Return: -143.565621455370322
INFO:tensorflow:Average training steps per second: 219.35
I0902 23:18:11.913775 139926926592000 replay_runner.py:36] Average training steps per second: 219.35
I0902 23:18:12.074110 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.14
INFO:tensorflow:Starting iteration 19

Steps executed: 202 Episode length: 89 Return: -179.309825809820442
INFO:tensorflow:Average training steps per second: 217.80
I0902 23:18:20.961445 139926926592000 replay_runner.py:36] Average training steps per second: 217.80
I0902 23:18:21.100662 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.56
INFO:tensorflow:Starting iteration 20

Steps executed: 222 Episode length: 63 Return: -154.471247255824182
INFO:tensorflow:Average training steps per second: 218.89
I0902 23:18:30.059520 139926926592000 replay_runner.py:36] Average training steps per second: 218.89
I0902 23:18:30.214613 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.02
INFO:tensorflow:Starting iteration 21

Steps executed: 259 Episode length: 65 Return: -140.542652758122252
INFO:tensorflow:Average training steps per second: 223.64
I0902 23:18:39.033959 139926926592000 replay_runner.py:36] Average training steps per second: 223.64
I0902 23:18:39.206670 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.64
INFO:tensorflow:Starting iteration 22

Steps executed: 238 Episode length: 82 Return: -98.5861207663508652
INFO:tensorflow:Average training steps per second: 229.41
I0902 23:18:47.807400 139926926592000 replay_runner.py:36] Average training steps per second: 229.41
I0902 23:18:47.952271 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.24
INFO:tensorflow:Starting iteration 23

Steps executed: 207 Episode length: 80 Return: -109.838631465676712
INFO:tensorflow:Average training steps per second: 227.06
I0902 23:18:56.523072 139926926592000 replay_runner.py:36] Average training steps per second: 227.06
I0902 23:18:56.646055 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.57
INFO:tensorflow:Starting iteration 24

Steps executed: 207 Episode length: 52 Return: -79.2324917897640352
INFO:tensorflow:Average training steps per second: 235.57
I0902 23:19:04.987726 139926926592000 replay_runner.py:36] Average training steps per second: 235.57
I0902 23:19:05.114550 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.27
INFO:tensorflow:Starting iteration 25
I0902 23:19:09.185294 139926926592000 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 229.88

Steps executed: 228 Episode length: 92 Return: -2.53153717205526622
I0902 23:19:13.678693 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.58
INFO:tensorflow:Starting iteration 26

Steps executed: 238 Episode length: 83 Return: -162.825070436847682
INFO:tensorflow:Average training steps per second: 225.78
I0902 23:19:22.284501 139926926592000 replay_runner.py:36] Average training steps per second: 225.78
I0902 23:19:22.446497 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.34
INFO:tensorflow:Starting iteration 27

Steps executed: 229 Episode length: 81 Return: -106.091736800112132
INFO:tensorflow:Average training steps per second: 225.29
I0902 23:19:31.202776 139926926592000 replay_runner.py:36] Average training steps per second: 225.29
I0902 23:19:31.365373 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.13
INFO:tensorflow:Starting iteration 28

Steps executed: 202 Episode length: 63 Return: -137.649989995043142
INFO:tensorflow:Average training steps per second: 221.32
I0902 23:19:40.214993 139926926592000 replay_runner.py:36] Average training steps per second: 221.32
I0902 23:19:40.350422 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.57
INFO:tensorflow:Starting iteration 29

Steps executed: 202 Episode length: 69 Return: -163.208470391246152
INFO:tensorflow:Average training steps per second: 218.30
I0902 23:19:49.235925 139926926592000 replay_runner.py:36] Average training steps per second: 218.30

Done fixed training!Episode length: 69 Return: -163.208470391246152