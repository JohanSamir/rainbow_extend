Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 00:15:11.072706 140286289131520 run_experiment.py:549] Creating TrainRunner ...
I0902 00:15:11.082929 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:11.083198 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:11.083336 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:11.083466 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:11.083582 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:11.083692 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:15:11.083838 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:11.083933 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:11.084156 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:11.084318 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:11.084453 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:11.084643 140286289131520 dqn_agent.py:283] 	 seed: 1630541711082863
I0902 00:15:11.087890 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:11.088155 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:15:11.088307 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:11.088437 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:11.088602 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:11.088723 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:11.088872 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:11.089004 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:11.089118 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:11.134290 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:11.672255 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:11.686047 140286289131520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:15:11.695950 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:11.696229 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:11.696425 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:11.696673 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:11.696820 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:11.696947 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:15:11.697051 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:11.697230 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:11.697336 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:11.697443 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:11.697568 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:11.697697 140286289131520 dqn_agent.py:283] 	 seed: 1630541711695881
I0902 00:15:11.699491 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:11.699669 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:15:11.699777 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:11.699897 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:11.699965 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:11.700025 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:11.700100 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:11.700193 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:11.700295 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:11.734970 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:11.757231 140286289131520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:15:11.757527 140286289131520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.75
I0902 00:15:18.571966 140286289131520 replay_runner.py:36] Average training steps per second: 146.75
Steps executed: 206 Episode length: 9 Return: 9.0.0
I0902 00:15:19.739668 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.30
INFO:tensorflow:Starting iteration 1

Steps executed: 306 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.13
I0902 00:15:24.948061 140286289131520 replay_runner.py:36] Average training steps per second: 199.13
I0902 00:15:25.160638 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 2

Steps executed: 325 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 198.60
I0902 00:15:30.391117 140286289131520 replay_runner.py:36] Average training steps per second: 198.60
I0902 00:15:30.599312 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 3

Steps executed: 383 Episode length: 193 Return: 193.0
INFO:tensorflow:Average training steps per second: 193.35
I0902 00:15:35.981544 140286289131520 replay_runner.py:36] Average training steps per second: 193.35
I0902 00:15:36.247042 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 4

Steps executed: 294 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 196.13
I0902 00:15:41.534369 140286289131520 replay_runner.py:36] Average training steps per second: 196.13
I0902 00:15:41.732192 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 5

Steps executed: 302 Episode length: 103 Return: 103.0
INFO:tensorflow:Average training steps per second: 186.80
I0902 00:15:47.274355 140286289131520 replay_runner.py:36] Average training steps per second: 186.80
I0902 00:15:47.476090 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 100.67
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.59
I0902 00:15:52.778230 140286289131520 replay_runner.py:36] Average training steps per second: 195.59
I0902 00:15:52.911083 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 313 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 190.89
I0902 00:15:58.345539 140286289131520 replay_runner.py:36] Average training steps per second: 190.89
I0902 00:15:58.548984 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.34
I0902 00:16:03.857311 140286289131520 replay_runner.py:36] Average training steps per second: 195.34
I0902 00:16:03.988890 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 270 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 193.17
I0902 00:16:09.356436 140286289131520 replay_runner.py:36] Average training steps per second: 193.17
I0902 00:16:09.527720 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 10

Steps executed: 228 Episode length: 114 Return: 114.0
INFO:tensorflow:Average training steps per second: 191.20
I0902 00:16:14.940597 140286289131520 replay_runner.py:36] Average training steps per second: 191.20
I0902 00:16:15.105310 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.00
INFO:tensorflow:Starting iteration 11
I0902 00:16:15.300768 140286289131520 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 189.35
I0902 00:16:20.582381 140286289131520 replay_runner.py:36] Average training steps per second: 189.35
I0902 00:16:20.739277 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.00
INFO:tensorflow:Starting iteration 12

Steps executed: 235 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 191.07
I0902 00:16:26.164362 140286289131520 replay_runner.py:36] Average training steps per second: 191.07
I0902 00:16:26.326076 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 13

Steps executed: 367 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 194.30
I0902 00:16:31.665159 140286289131520 replay_runner.py:36] Average training steps per second: 194.30
I0902 00:16:31.891676 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 14

Steps executed: 231 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 200.21
I0902 00:16:37.071919 140286289131520 replay_runner.py:36] Average training steps per second: 200.21
I0902 00:16:37.232145 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.50
INFO:tensorflow:Starting iteration 15

Steps executed: 237 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 200.65
I0902 00:16:42.403413 140286289131520 replay_runner.py:36] Average training steps per second: 200.65
I0902 00:16:42.547464 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 16

Steps executed: 246 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 204.93
I0902 00:16:47.601519 140286289131520 replay_runner.py:36] Average training steps per second: 204.93
I0902 00:16:47.763641 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.37
I0902 00:16:52.839898 140286289131520 replay_runner.py:36] Average training steps per second: 204.37
I0902 00:16:52.952186 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 329 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.18
I0902 00:16:57.955464 140286289131520 replay_runner.py:36] Average training steps per second: 207.18
I0902 00:16:58.160906 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 19
I0902 00:16:58.342345 140286289131520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 208.47
I0902 00:17:03.139620 140286289131520 replay_runner.py:36] Average training steps per second: 208.47

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 20
I0902 00:17:03.417378 140286289131520 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 208.67
I0902 00:17:08.210011 140286289131520 replay_runner.py:36] Average training steps per second: 208.67
I0902 00:17:08.331124 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:17:08.512062 140286289131520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 213.34
I0902 00:17:13.199868 140286289131520 replay_runner.py:36] Average training steps per second: 213.34
I0902 00:17:13.319818 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:17:13.492974 140286289131520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 213.93
I0902 00:17:18.167825 140286289131520 replay_runner.py:36] Average training steps per second: 213.93
I0902 00:17:18.292765 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:17:18.471639 140286289131520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 217.61
I0902 00:17:23.067362 140286289131520 replay_runner.py:36] Average training steps per second: 217.61
I0902 00:17:23.184701 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 00:17:23.355087 140286289131520 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 214.50
I0902 00:17:28.017488 140286289131520 replay_runner.py:36] Average training steps per second: 214.50
I0902 00:17:28.144572 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 00:17:28.328774 140286289131520 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 219.72
I0902 00:17:32.880357 140286289131520 replay_runner.py:36] Average training steps per second: 219.72
I0902 00:17:32.999576 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:17:33.167718 140286289131520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 215.63
I0902 00:17:37.805608 140286289131520 replay_runner.py:36] Average training steps per second: 215.63
I0902 00:17:37.925183 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:17:38.103325 140286289131520 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 220.90
I0902 00:17:42.630514 140286289131520 replay_runner.py:36] Average training steps per second: 220.90
I0902 00:17:42.744517 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 00:17:42.918635 140286289131520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 215.53
I0902 00:17:47.558803 140286289131520 replay_runner.py:36] Average training steps per second: 215.53
I0902 00:17:47.669057 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 233.74
I0902 00:17:52.112402 140286289131520 replay_runner.py:36] Average training steps per second: 233.74
I0902 00:17:52.328820 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50