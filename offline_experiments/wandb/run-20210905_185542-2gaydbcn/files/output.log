Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0905 18:55:48.990107 140545451182080 run_experiment.py:549] Creating TrainRunner ...
I0905 18:55:48.998807 140545451182080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:48.999088 140545451182080 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:48.999200 140545451182080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:48.999286 140545451182080 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:48.999427 140545451182080 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:48.999528 140545451182080 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:48.999628 140545451182080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:48.999700 140545451182080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:48.999752 140545451182080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:48.999813 140545451182080 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:48.999889 140545451182080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:49.000229 140545451182080 dqn_agent.py:283] 	 seed: 1630868148998737
I0905 18:55:49.004829 140545451182080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:49.005125 140545451182080 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:49.005395 140545451182080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:49.005530 140545451182080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:49.005834 140545451182080 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:49.006048 140545451182080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:49.006210 140545451182080 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:49.006343 140545451182080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:49.006472 140545451182080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:49.063180 140545451182080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.628224 140545451182080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.642919 140545451182080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:55:49.651305 140545451182080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:49.651545 140545451182080 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:49.651695 140545451182080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:49.651825 140545451182080 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:49.651946 140545451182080 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:49.652066 140545451182080 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:49.652173 140545451182080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:49.652310 140545451182080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:49.652459 140545451182080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:49.652620 140545451182080 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:49.652764 140545451182080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:49.652873 140545451182080 dqn_agent.py:283] 	 seed: 1630868149651251
I0905 18:55:49.655780 140545451182080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:49.655970 140545451182080 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:49.656078 140545451182080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:49.656216 140545451182080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:49.656460 140545451182080 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:49.656580 140545451182080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:49.656691 140545451182080 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:49.657058 140545451182080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:49.657212 140545451182080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:49.706278 140545451182080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:49.735568 140545451182080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:55:49.735856 140545451182080 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 125.40
I0905 18:55:57.710601 140545451182080 replay_runner.py:36] Average training steps per second: 125.40
Steps executed: 208 Episode length: 10 Return: 10.0
I0905 18:55:59.204915 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 269 Episode length: 91 Return: 91.0
INFO:tensorflow:Average training steps per second: 175.00
I0905 18:56:05.143396 140545451182080 replay_runner.py:36] Average training steps per second: 175.00
I0905 18:56:05.386060 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 89.67
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 162.86
I0905 18:56:11.768516 140545451182080 replay_runner.py:36] Average training steps per second: 162.86
I0905 18:56:12.015374 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 238 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 162.71
I0905 18:56:18.360894 140545451182080 replay_runner.py:36] Average training steps per second: 162.71
I0905 18:56:18.671698 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 119.00
INFO:tensorflow:Starting iteration 4

Steps executed: 239 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 154.02
I0905 18:56:25.401265 140545451182080 replay_runner.py:36] Average training steps per second: 154.02
I0905 18:56:25.743993 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 119.50
INFO:tensorflow:Starting iteration 5

Steps executed: 221 Episode length: 110 Return: 110.0
INFO:tensorflow:Average training steps per second: 158.54
I0905 18:56:32.300613 140545451182080 replay_runner.py:36] Average training steps per second: 158.54
I0905 18:56:32.620351 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.50
INFO:tensorflow:Starting iteration 6

Steps executed: 229 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 155.57
I0905 18:56:39.307320 140545451182080 replay_runner.py:36] Average training steps per second: 155.57
I0905 18:56:39.568634 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 7

Steps executed: 234 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 153.92
I0905 18:56:46.301163 140545451182080 replay_runner.py:36] Average training steps per second: 153.92
I0905 18:56:46.588728 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.00
INFO:tensorflow:Starting iteration 8

Steps executed: 230 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 151.46
I0905 18:56:53.422937 140545451182080 replay_runner.py:36] Average training steps per second: 151.46
I0905 18:56:53.724978 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 115.00
INFO:tensorflow:Starting iteration 9

Steps executed: 226 Episode length: 112 Return: 112.0
INFO:tensorflow:Average training steps per second: 153.66
I0905 18:57:00.475538 140545451182080 replay_runner.py:36] Average training steps per second: 153.66
I0905 18:57:00.746328 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.00
INFO:tensorflow:Starting iteration 10

Steps executed: 221 Episode length: 112 Return: 112.0
INFO:tensorflow:Average training steps per second: 158.67
I0905 18:57:07.243201 140545451182080 replay_runner.py:36] Average training steps per second: 158.67
I0905 18:57:07.496934 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 110.50
INFO:tensorflow:Starting iteration 11

Steps executed: 228 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 155.05
I0905 18:57:14.198317 140545451182080 replay_runner.py:36] Average training steps per second: 155.05
I0905 18:57:14.437959 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.00
INFO:tensorflow:Starting iteration 12

Steps executed: 191 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 163.82

Steps executed: 344 Episode length: 153 Return: 153.0
I0905 18:57:21.280051 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 13

Steps executed: 244 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 152.86
I0905 18:57:28.053569 140545451182080 replay_runner.py:36] Average training steps per second: 152.86
I0905 18:57:28.397478 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.00
INFO:tensorflow:Starting iteration 14
I0905 18:57:28.611329 140545451182080 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 155.10

Steps executed: 398 Episode length: 200 Return: 200.0
I0905 18:57:35.738098 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 15

Steps executed: 294 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 155.33
I0905 18:57:42.439184 140545451182080 replay_runner.py:36] Average training steps per second: 155.33
I0905 18:57:42.866197 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 16

Steps executed: 344 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 150.75
I0905 18:57:49.748991 140545451182080 replay_runner.py:36] Average training steps per second: 150.75
I0905 18:57:50.267951 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 17
I0905 18:57:50.473161 140545451182080 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 156.72

Steps executed: 316 Episode length: 158 Return: 158.0
I0905 18:57:57.305872 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 18

Steps executed: 392 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 158.16
I0905 18:58:03.869752 140545451182080 replay_runner.py:36] Average training steps per second: 158.16
I0905 18:58:04.400185 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 157.92
I0905 18:58:10.972608 140545451182080 replay_runner.py:36] Average training steps per second: 157.92
I0905 18:58:11.250797 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 18:58:11.509536 140545451182080 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 153.02
I0905 18:58:18.045491 140545451182080 replay_runner.py:36] Average training steps per second: 153.02
I0905 18:58:18.399147 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 18:58:18.646133 140545451182080 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 160.54

Steps executed: 396 Episode length: 200 Return: 200.0
I0905 18:58:25.423088 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 22

Steps executed: 318 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 153.55
I0905 18:58:32.180854 140545451182080 replay_runner.py:36] Average training steps per second: 153.55
I0905 18:58:32.608147 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 156.50
I0905 18:58:39.236042 140545451182080 replay_runner.py:36] Average training steps per second: 156.50
I0905 18:58:39.494426 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0905 18:58:39.741313 140545451182080 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 152.25
I0905 18:58:46.310278 140545451182080 replay_runner.py:36] Average training steps per second: 152.25
I0905 18:58:46.584132 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0905 18:58:46.830573 140545451182080 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 146.31
I0905 18:58:53.665885 140545451182080 replay_runner.py:36] Average training steps per second: 146.31
I0905 18:58:53.961095 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0905 18:58:54.200666 140545451182080 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 153.94
I0905 18:59:00.697437 140545451182080 replay_runner.py:36] Average training steps per second: 153.94
I0905 18:59:00.963318 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 266 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 166.54
I0905 18:59:07.203547 140545451182080 replay_runner.py:36] Average training steps per second: 166.54
I0905 18:59:07.546789 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 28

Steps executed: 316 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 155.07
I0905 18:59:14.236559 140545451182080 replay_runner.py:36] Average training steps per second: 155.07
I0905 18:59:14.563576 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 29

Steps executed: 192 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 168.81

Done fixed training!Episode length: 200 Return: 200.0
I0905 18:59:21.166580 140545451182080 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00