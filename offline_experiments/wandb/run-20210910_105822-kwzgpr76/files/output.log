I0910 10:58:28.563939 140578188752896 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 10:58:28.564470 140578188752896 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 10:58:28.621052 140578188752896 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:28.622339 140578188752896 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:28.622426 140578188752896 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:28.622492 140578188752896 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:28.622605 140578188752896 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:28.622702 140578188752896 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:28.622862 140578188752896 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:28.622932 140578188752896 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:28.623028 140578188752896 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:28.623128 140578188752896 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:28.623209 140578188752896 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:28.623288 140578188752896 dqn_agent.py:283] 	 seed: 1631271508620983
I0910 10:58:28.625312 140578188752896 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:28.625461 140578188752896 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:28.625538 140578188752896 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:28.625593 140578188752896 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:28.625643 140578188752896 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:28.625712 140578188752896 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:28.625768 140578188752896 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:28.625899 140578188752896 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:28.625949 140578188752896 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 10, please be patient, may be a while...
I0910 10:58:33.334245 140578188752896 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:33.411019 140578188752896 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:33.411200 140578188752896 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:33.411337 140578188752896 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:33.411450 140578188752896 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:33.411538 140578188752896 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:33.411617 140578188752896 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:33.411684 140578188752896 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:33.411741 140578188752896 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:33.411814 140578188752896 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:33.411920 140578188752896 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:33.411992 140578188752896 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:33.412069 140578188752896 dqn_agent.py:283] 	 seed: 1631271513410974
I0910 10:58:33.413866 140578188752896 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:33.413981 140578188752896 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:33.414062 140578188752896 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:33.414152 140578188752896 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:33.414239 140578188752896 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:33.414302 140578188752896 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:33.414356 140578188752896 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:33.414431 140578188752896 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:33.414557 140578188752896 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:58:33.554435 140578188752896 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:33.595412 140578188752896 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 10:58:33.596256 140578188752896 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 705874.12
I0910 10:58:33.598001 140578188752896 replay_runner.py:39] Average training steps per second: 705874.12
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 10:58:34.414007 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 10:58:34.473820 140578188752896 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 859840.92
I0910 10:58:34.475220 140578188752896 replay_runner.py:39] Average training steps per second: 859840.92
I0910 10:58:34.675394 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 10:58:34.730817 140578188752896 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 834355.28
I0910 10:58:34.732365 140578188752896 replay_runner.py:39] Average training steps per second: 834355.28
I0910 10:58:34.903279 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 10:58:34.958223 140578188752896 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 804585.46
I0910 10:58:34.959794 140578188752896 replay_runner.py:39] Average training steps per second: 804585.46
I0910 10:58:35.158405 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 10:58:35.213195 140578188752896 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 790930.42
I0910 10:58:35.214693 140578188752896 replay_runner.py:39] Average training steps per second: 790930.42
I0910 10:58:35.404176 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 10:58:35.459440 140578188752896 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 816012.45
I0910 10:58:35.460901 140578188752896 replay_runner.py:39] Average training steps per second: 816012.45
I0910 10:58:35.668769 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 10:58:35.724579 140578188752896 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 828750.05
I0910 10:58:35.726038 140578188752896 replay_runner.py:39] Average training steps per second: 828750.05
I0910 10:58:36.080151 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 10:58:36.138729 140578188752896 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 818241.12
I0910 10:58:36.140188 140578188752896 replay_runner.py:39] Average training steps per second: 818241.12
I0910 10:58:36.325242 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 10:58:36.380504 140578188752896 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 853020.95
I0910 10:58:36.381929 140578188752896 replay_runner.py:39] Average training steps per second: 853020.95
I0910 10:58:36.565502 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 10:58:36.623658 140578188752896 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 828586.33
I0910 10:58:36.625098 140578188752896 replay_runner.py:39] Average training steps per second: 828586.33
I0910 10:58:36.807586 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 10:58:36.863470 140578188752896 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 824838.54
I0910 10:58:36.864968 140578188752896 replay_runner.py:39] Average training steps per second: 824838.54
I0910 10:58:37.058274 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 10:58:37.113699 140578188752896 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 829569.62
I0910 10:58:37.115137 140578188752896 replay_runner.py:39] Average training steps per second: 829569.62
I0910 10:58:37.336284 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 10:58:37.392027 140578188752896 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 693961.61
I0910 10:58:37.393741 140578188752896 replay_runner.py:39] Average training steps per second: 693961.61
I0910 10:58:37.612834 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 10:58:37.667377 140578188752896 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 824352.20
I0910 10:58:37.668827 140578188752896 replay_runner.py:39] Average training steps per second: 824352.20
I0910 10:58:37.863970 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 10:58:37.919284 140578188752896 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 838022.78
I0910 10:58:37.920709 140578188752896 replay_runner.py:39] Average training steps per second: 838022.78
I0910 10:58:38.122803 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 10:58:38.177484 140578188752896 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 828095.56
I0910 10:58:38.178912 140578188752896 replay_runner.py:39] Average training steps per second: 828095.56
I0910 10:58:38.382680 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 10:58:38.439655 140578188752896 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 823866.43
I0910 10:58:38.441246 140578188752896 replay_runner.py:39] Average training steps per second: 823866.43
I0910 10:58:38.643813 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 10:58:38.698474 140578188752896 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 781062.20
I0910 10:58:38.700005 140578188752896 replay_runner.py:39] Average training steps per second: 781062.20
I0910 10:58:38.894099 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 10:58:38.958918 140578188752896 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 735069.05
I0910 10:58:38.960549 140578188752896 replay_runner.py:39] Average training steps per second: 735069.05
I0910 10:58:39.152562 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 10:58:39.209845 140578188752896 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 782227.53
I0910 10:58:39.211385 140578188752896 replay_runner.py:39] Average training steps per second: 782227.53
I0910 10:58:39.408248 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 10:58:39.462340 140578188752896 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 846991.92
I0910 10:58:39.463784 140578188752896 replay_runner.py:39] Average training steps per second: 846991.92
I0910 10:58:39.637923 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 10:58:39.692614 140578188752896 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 824676.37
I0910 10:58:39.694080 140578188752896 replay_runner.py:39] Average training steps per second: 824676.37
I0910 10:58:39.876392 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 10:58:39.937833 140578188752896 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 762046.51
I0910 10:58:39.939384 140578188752896 replay_runner.py:39] Average training steps per second: 762046.51

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 23
I0910 10:58:40.197053 140578188752896 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 730460.47
I0910 10:58:40.198673 140578188752896 replay_runner.py:39] Average training steps per second: 730460.47
I0910 10:58:40.392030 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 10:58:40.446044 140578188752896 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 868385.92
I0910 10:58:40.447423 140578188752896 replay_runner.py:39] Average training steps per second: 868385.92
I0910 10:58:40.623197 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 10:58:40.678116 140578188752896 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 849049.39
I0910 10:58:40.679565 140578188752896 replay_runner.py:39] Average training steps per second: 849049.39
I0910 10:58:40.844042 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 10:58:40.895756 140578188752896 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 807528.69
I0910 10:58:40.897213 140578188752896 replay_runner.py:39] Average training steps per second: 807528.69
I0910 10:58:41.059080 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 10:58:41.110478 140578188752896 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 888059.28
I0910 10:58:41.111811 140578188752896 replay_runner.py:39] Average training steps per second: 888059.28
I0910 10:58:41.273248 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 10:58:41.322150 140578188752896 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 848705.79
I0910 10:58:41.323552 140578188752896 replay_runner.py:39] Average training steps per second: 848705.79
I0910 10:58:41.469970 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 10:58:41.521466 140578188752896 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 909827.33
I0910 10:58:41.522889 140578188752896 replay_runner.py:39] Average training steps per second: 909827.33
I0910 10:58:41.674471 140578188752896 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00