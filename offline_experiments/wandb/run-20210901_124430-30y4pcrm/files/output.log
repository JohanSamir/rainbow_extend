Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 12:44:37.197626 139847227246592 run_experiment.py:549] Creating TrainRunner ...
I0901 12:44:37.208421 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:44:37.208719 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:44:37.209396 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:44:37.209522 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:44:37.209630 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:44:37.209725 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:44:37.209964 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:44:37.210182 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:44:37.210329 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:44:37.210686 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:44:37.210797 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:44:37.210924 139847227246592 dqn_agent.py:283] 	 seed: 1630500277208340
I0901 12:44:37.213796 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:44:37.213936 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:44:37.214038 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:44:37.214140 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:44:37.214214 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:44:37.214289 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:44:37.214370 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:44:37.214463 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:44:37.214607 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:44:37.260404 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:37.742818 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:37.759084 139847227246592 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:44:37.768735 139847227246592 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:44:37.768993 139847227246592 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:44:37.769190 139847227246592 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:44:37.769315 139847227246592 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:44:37.769438 139847227246592 dqn_agent.py:275] 	 update_period: 4
I0901 12:44:37.769610 139847227246592 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:44:37.769699 139847227246592 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:44:37.769774 139847227246592 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:44:37.769895 139847227246592 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:44:37.770040 139847227246592 dqn_agent.py:280] 	 optimizer: adam
I0901 12:44:37.770254 139847227246592 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:44:37.770402 139847227246592 dqn_agent.py:283] 	 seed: 1630500277768686
I0901 12:44:37.773165 139847227246592 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:44:37.773322 139847227246592 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:44:37.773546 139847227246592 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:44:37.773673 139847227246592 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:44:37.773831 139847227246592 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:44:37.773941 139847227246592 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:44:37.774136 139847227246592 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:44:37.774256 139847227246592 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:44:37.774368 139847227246592 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:44:37.812244 139847227246592 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:37.835720 139847227246592 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:44:37.835933 139847227246592 replay_runner.py:41] Starting iteration 0
Steps executed: 345 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 136.19
I0901 12:44:45.178970 139847227246592 replay_runner.py:36] Average training steps per second: 136.19
I0901 12:44:46.531545 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.50
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.59
I0901 12:44:52.083123 139847227246592 replay_runner.py:36] Average training steps per second: 188.59
I0901 12:44:52.526605 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:44:52.765753 139847227246592 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 186.96
I0901 12:44:58.114781 139847227246592 replay_runner.py:36] Average training steps per second: 186.96
I0901 12:44:58.566191 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:44:58.817652 139847227246592 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 183.74
I0901 12:45:04.260633 139847227246592 replay_runner.py:36] Average training steps per second: 183.74
I0901 12:45:04.689390 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 658 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.66
I0901 12:45:10.101245 139847227246592 replay_runner.py:36] Average training steps per second: 193.66
I0901 12:45:10.676612 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.34
I0901 12:45:16.308915 139847227246592 replay_runner.py:36] Average training steps per second: 185.34
I0901 12:45:16.734057 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 224 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 181.48
I0901 12:45:22.488061 139847227246592 replay_runner.py:36] Average training steps per second: 181.48
I0901 12:45:22.692928 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 7

Steps executed: 254 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 186.18
I0901 12:45:28.327643 139847227246592 replay_runner.py:36] Average training steps per second: 186.18
I0901 12:45:28.548954 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 8

Steps executed: 272 Episode length: 163 Return: -162.0
INFO:tensorflow:Average training steps per second: 187.56
I0901 12:45:34.129466 139847227246592 replay_runner.py:36] Average training steps per second: 187.56
I0901 12:45:34.383141 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 9

Steps executed: 234 Episode length: 66 Return: -65.0.0
INFO:tensorflow:Average training steps per second: 185.85
I0901 12:45:40.015277 139847227246592 replay_runner.py:36] Average training steps per second: 185.85
I0901 12:45:40.230072 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 10

Steps executed: 261 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 188.71
I0901 12:45:45.774998 139847227246592 replay_runner.py:36] Average training steps per second: 188.71
I0901 12:45:46.013190 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.77
I0901 12:45:51.588198 139847227246592 replay_runner.py:36] Average training steps per second: 187.77
I0901 12:45:52.024995 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 239 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 184.76
I0901 12:45:57.678715 139847227246592 replay_runner.py:36] Average training steps per second: 184.76
I0901 12:45:57.898057 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 13
I0901 12:45:58.151147 139847227246592 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 188.38

Steps executed: 348 Episode length: 155 Return: -154.0
I0901 12:46:03.783225 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 14

Steps executed: 100 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 189.62
I0901 12:46:09.309983 139847227246592 replay_runner.py:36] Average training steps per second: 189.62

Steps executed: 206 Episode length: 106 Return: -105.0
INFO:tensorflow:Starting iteration 15

Steps executed: 280 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 190.74
I0901 12:46:14.969074 139847227246592 replay_runner.py:36] Average training steps per second: 190.74
I0901 12:46:15.205038 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.33
INFO:tensorflow:Starting iteration 16

Steps executed: 261 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 191.72
I0901 12:46:20.663232 139847227246592 replay_runner.py:36] Average training steps per second: 191.72
I0901 12:46:20.883782 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 17

Steps executed: 217 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 195.10
I0901 12:46:26.246867 139847227246592 replay_runner.py:36] Average training steps per second: 195.10
I0901 12:46:26.429460 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 18

Steps executed: 291 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 193.96
I0901 12:46:31.823462 139847227246592 replay_runner.py:36] Average training steps per second: 193.96
I0901 12:46:32.078939 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 19

Steps executed: 255 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 186.87
I0901 12:46:37.682316 139847227246592 replay_runner.py:36] Average training steps per second: 186.87
I0901 12:46:37.905789 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 20
I0901 12:46:38.151836 139847227246592 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.56

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:46:43.868194 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0901 12:46:44.116187 139847227246592 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.09

Steps executed: 244 Episode length: 105 Return: -104.0
I0901 12:46:49.539698 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 22
I0901 12:46:49.793182 139847227246592 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.39
I0901 12:46:55.046030 139847227246592 replay_runner.py:36] Average training steps per second: 190.39

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 23
I0901 12:46:55.708245 139847227246592 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 194.23
I0901 12:47:00.857320 139847227246592 replay_runner.py:36] Average training steps per second: 194.23
I0901 12:47:01.305498 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 267 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 192.23
I0901 12:47:06.751266 139847227246592 replay_runner.py:36] Average training steps per second: 192.23
I0901 12:47:06.991281 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 194.20
I0901 12:47:12.394977 139847227246592 replay_runner.py:36] Average training steps per second: 194.20
I0901 12:47:12.600949 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 26

Steps executed: 261 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 194.36
I0901 12:47:17.993562 139847227246592 replay_runner.py:36] Average training steps per second: 194.36
I0901 12:47:18.222683 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 27
I0901 12:47:18.472181 139847227246592 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.37

Steps executed: 296 Episode length: 100 Return: -99.00
I0901 12:47:24.000343 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 28

Steps executed: 277 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 193.66
I0901 12:47:29.404404 139847227246592 replay_runner.py:36] Average training steps per second: 193.66
I0901 12:47:29.618749 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 198.30
I0901 12:47:34.908958 139847227246592 replay_runner.py:36] Average training steps per second: 198.30
I0901 12:47:35.150749 139847227246592 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.50