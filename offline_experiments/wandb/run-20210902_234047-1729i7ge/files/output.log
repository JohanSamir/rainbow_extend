Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 23:40:54.440497 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:54.452255 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:54.452501 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:54.452602 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:54.452685 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:54.452836 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:54.452956 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:54.453036 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:54.453148 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:54.453293 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:54.453391 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:54.453481 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:54.453580 139900407642112 dqn_agent.py:283] 	 seed: 1630626054452194
I0902 23:40:54.456336 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:54.456616 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:54.457031 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:54.457153 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:54.457258 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:54.457385 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:54.457511 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:54.457594 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:54.457699 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:54.498281 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:54.893687 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:54.909247 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:54.918955 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:54.919215 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:54.919373 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:54.919517 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:54.919642 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:54.919810 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:54.919942 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:54.920062 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:54.920295 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:54.920481 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:54.920667 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:54.920763 139900407642112 dqn_agent.py:283] 	 seed: 1630626054918893
I0902 23:40:54.923233 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:54.923510 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:54.923791 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:54.924534 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:54.924688 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:54.924767 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:54.924826 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:54.924915 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:55.257831 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:55.331228 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:55.356623 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:55.356984 139900407642112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 162.58
I0902 23:41:01.508027 139900407642112 replay_runner.py:36] Average training steps per second: 162.58
Steps executed: 244 Episode length: 99 Return: -264.5866584897804
I0902 23:41:02.825443 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.43
INFO:tensorflow:Starting iteration 1

Steps executed: 224 Episode length: 91 Return: -599.47929355389497
INFO:tensorflow:Average training steps per second: 219.52
I0902 23:41:11.689377 139900407642112 replay_runner.py:36] Average training steps per second: 219.52
I0902 23:41:11.874428 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.57
INFO:tensorflow:Starting iteration 2

Steps executed: 206 Episode length: 206 Return: -844.4598635206586
INFO:tensorflow:Average training steps per second: 227.48
I0902 23:41:20.598409 139900407642112 replay_runner.py:36] Average training steps per second: 227.48
I0902 23:41:20.835117 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -844.46
INFO:tensorflow:Starting iteration 3

Steps executed: 323 Episode length: 323 Return: -335.0294909118826
INFO:tensorflow:Average training steps per second: 233.80
I0902 23:41:29.487815 139900407642112 replay_runner.py:36] Average training steps per second: 233.80
I0902 23:41:29.874354 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.03
INFO:tensorflow:Starting iteration 4
I0902 23:41:34.301090 139900407642112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 225.65

Steps executed: 1000 Episode length: 1000 Return: -69.9933459071627
I0902 23:41:42.013567 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.99
INFO:tensorflow:Starting iteration 5
I0902 23:41:46.459075 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.68

Steps executed: 1000 Episode length: 1000 Return: -72.35426615489642
I0902 23:41:53.730421 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.35
INFO:tensorflow:Starting iteration 6
I0902 23:41:58.016399 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 215.83

Steps executed: 1000 Episode length: 1000 Return: -230.56541956710421
I0902 23:42:04.970740 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.57
INFO:tensorflow:Starting iteration 7

Steps executed: 256 Episode length: 256 Return: -77.83556716970286421
INFO:tensorflow:Average training steps per second: 217.91
I0902 23:42:13.833148 139900407642112 replay_runner.py:36] Average training steps per second: 217.91
I0902 23:42:14.112874 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.84
INFO:tensorflow:Starting iteration 8
I0902 23:42:18.500790 139900407642112 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 218.23

Steps executed: 676 Episode length: 676 Return: -275.3675382776164421
I0902 23:42:24.658793 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.37
INFO:tensorflow:Starting iteration 9
I0902 23:42:28.949460 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.43

Steps executed: 1000 Episode length: 1000 Return: -255.50778870670462
I0902 23:42:36.114710 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.51
INFO:tensorflow:Starting iteration 10
I0902 23:42:40.538310 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 229.66

Steps executed: 1000 Episode length: 1000 Return: -141.42599124853507
I0902 23:42:48.727264 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.43
INFO:tensorflow:Starting iteration 11
I0902 23:42:53.117830 139900407642112 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 238.00

Steps executed: 1000 Episode length: 1000 Return: -198.95034487932028
I0902 23:43:00.472467 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.95
INFO:tensorflow:Starting iteration 12

Steps executed: 347 Episode length: 347 Return: -6.109088053560015028
INFO:tensorflow:Average training steps per second: 234.66
I0902 23:43:09.095769 139900407642112 replay_runner.py:36] Average training steps per second: 234.66
I0902 23:43:09.662512 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -6.11
INFO:tensorflow:Starting iteration 13
I0902 23:43:14.025218 139900407642112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 224.35

Steps executed: 256 Episode length: 256 Return: -368.1200769010995428
I0902 23:43:18.772856 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.12
INFO:tensorflow:Starting iteration 14

Steps executed: 221 Episode length: 221 Return: -12.74818144092624628
INFO:tensorflow:Average training steps per second: 224.01
I0902 23:43:27.633563 139900407642112 replay_runner.py:36] Average training steps per second: 224.01
I0902 23:43:27.869715 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -12.75
INFO:tensorflow:Starting iteration 15
I0902 23:43:32.211931 139900407642112 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 230.83

Steps executed: 269 Episode length: 121 Return: -233.7396949184981528
I0902 23:43:36.747006 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.10
INFO:tensorflow:Starting iteration 16

Steps executed: 223 Episode length: 223 Return: -86.91369448358041528
INFO:tensorflow:Average training steps per second: 226.70
I0902 23:43:45.510567 139900407642112 replay_runner.py:36] Average training steps per second: 226.70
I0902 23:43:45.759467 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.91
INFO:tensorflow:Starting iteration 17
I0902 23:43:50.044346 139900407642112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 226.12

Steps executed: 339 Episode length: 339 Return: -214.5300421144880528
I0902 23:43:54.957696 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.53
INFO:tensorflow:Starting iteration 18

Steps executed: 223 Episode length: 223 Return: 246.62104294351644528
INFO:tensorflow:Average training steps per second: 222.05
I0902 23:44:03.718945 139900407642112 replay_runner.py:36] Average training steps per second: 222.05
I0902 23:44:03.961462 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 246.62
INFO:tensorflow:Starting iteration 19
I0902 23:44:08.273858 139900407642112 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 224.01

Steps executed: 346 Episode length: 187 Return: -614.5671478621891528
I0902 23:44:13.111034 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -682.26
INFO:tensorflow:Starting iteration 20
I0902 23:44:17.355910 139900407642112 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 222.78

Steps executed: 1000 Episode length: 1000 Return: 69.0815862351657428
I0902 23:44:24.281066 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.08
INFO:tensorflow:Starting iteration 21
I0902 23:44:28.461465 139900407642112 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 223.57

Steps executed: 288 Episode length: 288 Return: -429.9130707359043428
I0902 23:44:33.300366 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.91
INFO:tensorflow:Starting iteration 22

Steps executed: 273 Episode length: 92 Return: -696.34285934631639428
INFO:tensorflow:Average training steps per second: 226.43
I0902 23:44:41.957233 139900407642112 replay_runner.py:36] Average training steps per second: 226.43
I0902 23:44:42.279565 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.40
INFO:tensorflow:Starting iteration 23
I0902 23:44:46.566313 139900407642112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 228.21

Steps executed: 333 Episode length: 185 Return: -69.35564388903711428
I0902 23:44:51.275408 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.43
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 221 Return: -55.19611556776171428
INFO:tensorflow:Average training steps per second: 231.74
I0902 23:44:59.876992 139900407642112 replay_runner.py:36] Average training steps per second: 231.74
I0902 23:45:00.114645 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -55.20
INFO:tensorflow:Starting iteration 25
I0902 23:45:04.384343 139900407642112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 221.81

Steps executed: 351 Episode length: 176 Return: 27.316173516580152428
I0902 23:45:09.182147 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.65
INFO:tensorflow:Starting iteration 26

Steps executed: 229 Episode length: 127 Return: -707.2347997674502428
INFO:tensorflow:Average training steps per second: 229.93
I0902 23:45:17.915909 139900407642112 replay_runner.py:36] Average training steps per second: 229.93
I0902 23:45:18.120611 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.58
INFO:tensorflow:Starting iteration 27

Steps executed: 117 Episode length: 117 Return: -235.0698265185058428
INFO:tensorflow:Average training steps per second: 235.73
I0902 23:45:26.799978 139900407642112 replay_runner.py:36] Average training steps per second: 235.73

Steps executed: 222 Episode length: 105 Return: -96.10677074210234428
INFO:tensorflow:Starting iteration 28

Steps executed: 319 Episode length: 153 Return: -61.89582113882653428
INFO:tensorflow:Average training steps per second: 227.79
I0902 23:45:35.720933 139900407642112 replay_runner.py:36] Average training steps per second: 227.79
I0902 23:45:36.042682 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.91
INFO:tensorflow:Starting iteration 29

Steps executed: 300 Episode length: 118 Return: -107.1860016607856528
INFO:tensorflow:Average training steps per second: 232.30
I0902 23:45:44.652347 139900407642112 replay_runner.py:36] Average training steps per second: 232.30

Done fixed training!Episode length: 118 Return: -107.1860016607856528