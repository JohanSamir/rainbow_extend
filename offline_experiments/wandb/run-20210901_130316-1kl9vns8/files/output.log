I0901 13:03:22.957811 139675548379136 run_experiment.py:549] Creating TrainRunner ...
I0901 13:03:22.967419 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:03:22.967678 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:03:22.967821 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:03:22.967945 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:03:22.968055 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 13:03:22.968176 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:03:22.968285 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:03:22.968391 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:03:22.968489 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:03:22.968700 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 13:03:22.968868 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:03:22.968998 139675548379136 dqn_agent.py:283] 	 seed: 1630501402967350
I0901 13:03:22.972383 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:03:22.972554 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:03:22.972657 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:03:22.972728 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:03:22.972799 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:03:22.972948 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:03:22.973025 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:03:22.973105 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:03:22.973177 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 13:03:24.489330 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:03:25.006553 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:03:25.020259 139675548379136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:03:25.028806 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:03:25.029067 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:03:25.029207 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:03:25.029302 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:03:25.029370 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 13:03:25.029430 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:03:25.029488 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:03:25.029546 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:03:25.029693 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:03:25.029836 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 13:03:25.029975 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:03:25.030067 139675548379136 dqn_agent.py:283] 	 seed: 1630501405028766
I0901 13:03:25.033308 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:03:25.033560 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:03:25.033712 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:03:25.033838 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:03:25.033991 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:03:25.034154 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:03:25.034224 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:03:25.034358 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:03:25.034510 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:03:25.069105 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:03:25.089810 139675548379136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:03:25.090181 139675548379136 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.49
I0901 13:03:31.779841 139675548379136 replay_runner.py:36] Average training steps per second: 149.49
Steps executed: 203 Episode length: 203 Return: -202.0
I0901 13:03:32.985362 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 211.90
I0901 13:03:37.936838 139675548379136 replay_runner.py:36] Average training steps per second: 211.90
I0901 13:03:38.298671 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 13:03:38.525768 139675548379136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 210.33
I0901 13:03:43.280651 139675548379136 replay_runner.py:36] Average training steps per second: 210.33
I0901 13:03:43.615585 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 13:03:43.830635 139675548379136 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 222.71
I0901 13:03:48.321275 139675548379136 replay_runner.py:36] Average training steps per second: 222.71
I0901 13:03:48.686189 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 13:03:48.915496 139675548379136 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 212.66
I0901 13:03:53.618188 139675548379136 replay_runner.py:36] Average training steps per second: 212.66
I0901 13:03:53.972293 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 13:03:54.192960 139675548379136 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 212.95
I0901 13:03:58.889388 139675548379136 replay_runner.py:36] Average training steps per second: 212.95
I0901 13:03:59.247032 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 672 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 223.50
I0901 13:04:03.945634 139675548379136 replay_runner.py:36] Average training steps per second: 223.50
I0901 13:04:04.405644 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.50
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 214.31
I0901 13:04:09.297473 139675548379136 replay_runner.py:36] Average training steps per second: 214.31
I0901 13:04:09.641710 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 13:04:09.859321 139675548379136 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 218.01
I0901 13:04:14.446738 139675548379136 replay_runner.py:36] Average training steps per second: 218.01
I0901 13:04:14.800784 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 13:04:15.031033 139675548379136 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 216.24
I0901 13:04:19.655951 139675548379136 replay_runner.py:36] Average training steps per second: 216.24
I0901 13:04:20.009173 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 604 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 229.58
I0901 13:04:24.579154 139675548379136 replay_runner.py:36] Average training steps per second: 229.58
I0901 13:04:24.973121 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.50
INFO:tensorflow:Starting iteration 11

Steps executed: 251 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 226.38
I0901 13:04:29.606590 139675548379136 replay_runner.py:36] Average training steps per second: 226.38
I0901 13:04:29.766301 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 12

Steps executed: 634 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 234.39
I0901 13:04:34.249636 139675548379136 replay_runner.py:36] Average training steps per second: 234.39
I0901 13:04:34.639417 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.67
INFO:tensorflow:Starting iteration 13

Steps executed: 211 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 230.84
I0901 13:04:39.185753 139675548379136 replay_runner.py:36] Average training steps per second: 230.84
I0901 13:04:39.327574 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 14

Steps executed: 201 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 242.13
I0901 13:04:43.672710 139675548379136 replay_runner.py:36] Average training steps per second: 242.13
I0901 13:04:43.794320 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 15

Steps executed: 237 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 233.29
I0901 13:04:48.281271 139675548379136 replay_runner.py:36] Average training steps per second: 233.29
I0901 13:04:48.451186 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 16

Steps executed: 234 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 249.78
I0901 13:04:52.679095 139675548379136 replay_runner.py:36] Average training steps per second: 249.78
I0901 13:04:52.834042 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 17

Steps executed: 65 Episode length: 65 Return: -64.0.00
INFO:tensorflow:Average training steps per second: 253.28
I0901 13:04:56.992547 139675548379136 replay_runner.py:36] Average training steps per second: 253.28
I0901 13:04:57.123210 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00

Steps executed: 204 Episode length: 139 Return: -138.0

Steps executed: 223 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 237.53
I0901 13:05:01.547535 139675548379136 replay_runner.py:36] Average training steps per second: 237.53
I0901 13:05:01.681388 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 19

Steps executed: 253 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 251.73
I0901 13:05:05.856611 139675548379136 replay_runner.py:36] Average training steps per second: 251.73
I0901 13:05:06.019682 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 20

Steps executed: 276 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 238.26
I0901 13:05:10.431363 139675548379136 replay_runner.py:36] Average training steps per second: 238.26
I0901 13:05:10.616389 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 21

Steps executed: 272 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 248.40
I0901 13:05:14.863318 139675548379136 replay_runner.py:36] Average training steps per second: 248.40
I0901 13:05:15.036174 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 22

Steps executed: 205 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 246.86
I0901 13:05:19.304529 139675548379136 replay_runner.py:36] Average training steps per second: 246.86
I0901 13:05:19.421858 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 23

Steps executed: 328 Episode length: 153 Return: -152.0
INFO:tensorflow:Average training steps per second: 253.34
I0901 13:05:23.568257 139675548379136 replay_runner.py:36] Average training steps per second: 253.34
I0901 13:05:23.783454 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.33
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 248.59
I0901 13:05:28.018452 139675548379136 replay_runner.py:36] Average training steps per second: 248.59
I0901 13:05:28.129422 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.67
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 248.61
I0901 13:05:32.352197 139675548379136 replay_runner.py:36] Average training steps per second: 248.61
I0901 13:05:32.507877 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 26

Steps executed: 238 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 253.28
I0901 13:05:36.762423 139675548379136 replay_runner.py:36] Average training steps per second: 253.28
I0901 13:05:36.893415 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 27

Steps executed: 83 Episode length: 83 Return: -82.00.0
INFO:tensorflow:Average training steps per second: 245.19
I0901 13:05:41.171203 139675548379136 replay_runner.py:36] Average training steps per second: 245.19

Steps executed: 270 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Starting iteration 28
I0901 13:05:41.517631 139675548379136 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 269.04

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 13:05:45.546506 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 257.17
I0901 13:05:49.639286 139675548379136 replay_runner.py:36] Average training steps per second: 257.17
I0901 13:05:49.784975 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67