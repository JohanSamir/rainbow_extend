Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0902 23:36:33.055819 140608500226048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:36:33.065401 140608500226048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:36:33.065696 140608500226048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:36:33.065795 140608500226048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:36:33.065866 140608500226048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:36:33.065963 140608500226048 dqn_agent.py:275] 	 update_period: 4
I0902 23:36:33.066035 140608500226048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:36:33.066097 140608500226048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:36:33.066153 140608500226048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:36:33.066269 140608500226048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:36:33.066428 140608500226048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:36:33.066522 140608500226048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:36:33.066613 140608500226048 dqn_agent.py:283] 	 seed: 1630625793065348
I0902 23:36:33.069355 140608500226048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:36:33.069611 140608500226048 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:36:33.069800 140608500226048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:36:33.069930 140608500226048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:36:33.070079 140608500226048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:36:33.070193 140608500226048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:36:33.070279 140608500226048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:36:33.070395 140608500226048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:36:33.070470 140608500226048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:36:33.109113 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:36:33.687130 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:36:33.698698 140608500226048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:36:33.707374 140608500226048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:36:33.707605 140608500226048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:36:33.707711 140608500226048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:36:33.707795 140608500226048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:36:33.707873 140608500226048 dqn_agent.py:275] 	 update_period: 4
I0902 23:36:33.708100 140608500226048 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:36:33.708235 140608500226048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:36:33.708356 140608500226048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:36:33.708461 140608500226048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:36:33.708554 140608500226048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:36:33.708656 140608500226048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:36:33.708954 140608500226048 dqn_agent.py:283] 	 seed: 1630625793707317
I0902 23:36:33.711445 140608500226048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:36:33.711625 140608500226048 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:36:33.711749 140608500226048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:36:33.711877 140608500226048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:36:33.711966 140608500226048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:36:33.712051 140608500226048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:36:33.712122 140608500226048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:36:33.712237 140608500226048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:36:33.712333 140608500226048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:36:33.740919 140608500226048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:36:33.761441 140608500226048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:36:33.761746 140608500226048 replay_runner.py:41] Starting iteration 0
Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 144.89
I0902 23:36:40.663773 140608500226048 replay_runner.py:36] Average training steps per second: 144.89
I0902 23:36:41.825623 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.86
INFO:tensorflow:Starting iteration 1

Steps executed: 236 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 203.68
I0902 23:36:46.921494 140608500226048 replay_runner.py:36] Average training steps per second: 203.68
I0902 23:36:47.085386 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.69
I0902 23:36:52.247919 140608500226048 replay_runner.py:36] Average training steps per second: 200.69
I0902 23:36:52.372943 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:36:52.556607 140608500226048 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 210.55
I0902 23:36:57.306536 140608500226048 replay_runner.py:36] Average training steps per second: 210.55
I0902 23:36:57.439156 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 374 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.80
I0902 23:37:02.506630 140608500226048 replay_runner.py:36] Average training steps per second: 204.80
I0902 23:37:02.747509 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 5

Steps executed: 338 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 202.78
I0902 23:37:07.862865 140608500226048 replay_runner.py:36] Average training steps per second: 202.78
I0902 23:37:08.098106 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 6

Steps executed: 320 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 197.21
I0902 23:37:13.362184 140608500226048 replay_runner.py:36] Average training steps per second: 197.21
I0902 23:37:13.573365 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.47
I0902 23:37:18.701868 140608500226048 replay_runner.py:36] Average training steps per second: 202.47
I0902 23:37:18.832295 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 338 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 205.44
I0902 23:37:23.903835 140608500226048 replay_runner.py:36] Average training steps per second: 205.44
I0902 23:37:24.116455 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 9

Steps executed: 175 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 212.12

Steps executed: 327 Episode length: 152 Return: 152.0
I0902 23:37:29.221974 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 10

Steps executed: 287 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 202.63
I0902 23:37:34.339904 140608500226048 replay_runner.py:36] Average training steps per second: 202.63
I0902 23:37:34.514971 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.50
INFO:tensorflow:Starting iteration 11

Steps executed: 382 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 201.51
I0902 23:37:39.666065 140608500226048 replay_runner.py:36] Average training steps per second: 201.51
I0902 23:37:39.910487 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.00
INFO:tensorflow:Starting iteration 12

Steps executed: 289 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 207.87
I0902 23:37:44.911804 140608500226048 replay_runner.py:36] Average training steps per second: 207.87
I0902 23:37:45.108776 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.43
I0902 23:37:50.356621 140608500226048 replay_runner.py:36] Average training steps per second: 201.43
I0902 23:37:50.521549 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 265 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 199.27
I0902 23:37:55.725775 140608500226048 replay_runner.py:36] Average training steps per second: 199.27
I0902 23:37:55.894784 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.98
I0902 23:38:01.027190 140608500226048 replay_runner.py:36] Average training steps per second: 201.98
I0902 23:38:01.176895 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:38:01.361878 140608500226048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.90
I0902 23:38:06.546223 140608500226048 replay_runner.py:36] Average training steps per second: 192.90
I0902 23:38:06.683511 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:38:06.868162 140608500226048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.67
I0902 23:38:11.876796 140608500226048 replay_runner.py:36] Average training steps per second: 199.67
I0902 23:38:12.013900 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:38:12.206765 140608500226048 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 200.86
I0902 23:38:17.185715 140608500226048 replay_runner.py:36] Average training steps per second: 200.86
I0902 23:38:17.321932 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:38:17.510982 140608500226048 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 197.89
I0902 23:38:22.564795 140608500226048 replay_runner.py:36] Average training steps per second: 197.89
I0902 23:38:22.699221 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 370 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.20
I0902 23:38:27.957614 140608500226048 replay_runner.py:36] Average training steps per second: 197.20
I0902 23:38:28.221974 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.06
I0902 23:38:33.473184 140608500226048 replay_runner.py:36] Average training steps per second: 198.06
I0902 23:38:33.608499 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:38:33.799372 140608500226048 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.32
I0902 23:38:39.026640 140608500226048 replay_runner.py:36] Average training steps per second: 191.32
I0902 23:38:39.176944 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:38:39.367371 140608500226048 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 199.57
I0902 23:38:44.378683 140608500226048 replay_runner.py:36] Average training steps per second: 199.57
I0902 23:38:44.513350 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:38:44.706848 140608500226048 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 190.06
I0902 23:38:49.968660 140608500226048 replay_runner.py:36] Average training steps per second: 190.06
I0902 23:38:50.095889 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:38:50.283678 140608500226048 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.40
I0902 23:38:55.249340 140608500226048 replay_runner.py:36] Average training steps per second: 201.40
I0902 23:38:55.388670 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:38:55.584431 140608500226048 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.18
I0902 23:39:00.734620 140608500226048 replay_runner.py:36] Average training steps per second: 194.18
I0902 23:39:00.859683 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 353 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 192.92
I0902 23:39:06.227244 140608500226048 replay_runner.py:36] Average training steps per second: 192.92
I0902 23:39:06.472931 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 28
I0902 23:39:06.669183 140608500226048 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 200.80

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:39:11.782059 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.05
I0902 23:39:17.207850 140608500226048 replay_runner.py:36] Average training steps per second: 191.05
I0902 23:39:17.345547 140608500226048 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00