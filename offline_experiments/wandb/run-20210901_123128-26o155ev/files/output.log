Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 12:31:35.256211 140583573075968 run_experiment.py:549] Creating TrainRunner ...
I0901 12:31:35.266879 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:35.267175 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:35.267404 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:35.267529 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:35.267676 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:35.267782 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:35.267928 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:35.268010 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:35.268095 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:35.268202 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:35.268289 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:35.268434 140583573075968 dqn_agent.py:283] 	 seed: 1630499495266803
I0901 12:31:35.272732 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:35.273032 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:35.273229 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:35.273561 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:35.273704 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:35.273882 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:35.274195 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:35.274394 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:35.274567 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:35.325405 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:35.816103 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:35.829907 140583573075968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:31:35.841083 140583573075968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:35.841393 140583573075968 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:35.841520 140583573075968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:35.841610 140583573075968 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:35.841723 140583573075968 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:35.841878 140583573075968 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:35.842061 140583573075968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:35.842220 140583573075968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:35.842415 140583573075968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:35.842505 140583573075968 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:35.842587 140583573075968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:35.842704 140583573075968 dqn_agent.py:283] 	 seed: 1630499495841013
I0901 12:31:35.845516 140583573075968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:35.845680 140583573075968 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:35.845784 140583573075968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:35.846082 140583573075968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:35.846374 140583573075968 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:35.846530 140583573075968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:35.846909 140583573075968 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:35.847176 140583573075968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:35.847347 140583573075968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:35.887505 140583573075968 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:35.910538 140583573075968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:31:35.910886 140583573075968 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 139.42
I0901 12:31:43.084072 140583573075968 replay_runner.py:36] Average training steps per second: 139.42
I0901 12:31:44.541519 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:31:44.790528 140583573075968 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 195.55
I0901 12:31:49.904787 140583573075968 replay_runner.py:36] Average training steps per second: 195.55
I0901 12:31:50.330476 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:31:50.568544 140583573075968 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 191.91
I0901 12:31:55.779840 140583573075968 replay_runner.py:36] Average training steps per second: 191.91
I0901 12:31:56.222831 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 474 Episode length: 474 Return: -473.0
INFO:tensorflow:Average training steps per second: 194.77
I0901 12:32:01.598181 140583573075968 replay_runner.py:36] Average training steps per second: 194.77
I0901 12:32:02.028811 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.04
I0901 12:32:07.509586 140583573075968 replay_runner.py:36] Average training steps per second: 191.04
I0901 12:32:07.927146 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:32:08.173154 140583573075968 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 192.46
I0901 12:32:13.369239 140583573075968 replay_runner.py:36] Average training steps per second: 192.46
I0901 12:32:13.819171 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 213 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 200.93
I0901 12:32:19.053944 140583573075968 replay_runner.py:36] Average training steps per second: 200.93
I0901 12:32:19.231354 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 7

Steps executed: 206 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 189.31
I0901 12:32:24.759967 140583573075968 replay_runner.py:36] Average training steps per second: 189.31
I0901 12:32:24.941758 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.12
I0901 12:32:30.312521 140583573075968 replay_runner.py:36] Average training steps per second: 195.12
I0901 12:32:30.768220 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 296 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 193.91
I0901 12:32:36.153754 140583573075968 replay_runner.py:36] Average training steps per second: 193.91
I0901 12:32:36.396548 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.03
I0901 12:32:41.811526 140583573075968 replay_runner.py:36] Average training steps per second: 193.03
I0901 12:32:42.249394 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 430 Episode length: 430 Return: -429.0
INFO:tensorflow:Average training steps per second: 196.04
I0901 12:32:47.603790 140583573075968 replay_runner.py:36] Average training steps per second: 196.04
I0901 12:32:47.994520 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.00
INFO:tensorflow:Starting iteration 12

Steps executed: 231 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 187.76
I0901 12:32:53.554636 140583573075968 replay_runner.py:36] Average training steps per second: 187.76
I0901 12:32:53.771007 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.66
I0901 12:32:59.275300 140583573075968 replay_runner.py:36] Average training steps per second: 189.66
I0901 12:32:59.712894 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 119 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 196.63
I0901 12:33:05.032281 140583573075968 replay_runner.py:36] Average training steps per second: 196.63

Steps executed: 230 Episode length: 111 Return: -110.0
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.51
I0901 12:33:10.745116 140583573075968 replay_runner.py:36] Average training steps per second: 189.51
I0901 12:33:11.169619 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 245 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 189.90
I0901 12:33:16.672520 140583573075968 replay_runner.py:36] Average training steps per second: 189.90
I0901 12:33:16.908024 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 17

Steps executed: 215 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 195.00
I0901 12:33:22.285527 140583573075968 replay_runner.py:36] Average training steps per second: 195.00
I0901 12:33:22.458230 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.67
INFO:tensorflow:Starting iteration 18

Steps executed: 304 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 192.26
I0901 12:33:27.903350 140583573075968 replay_runner.py:36] Average training steps per second: 192.26
I0901 12:33:28.164921 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.33
INFO:tensorflow:Starting iteration 19
I0901 12:33:28.413664 140583573075968 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 201.51

Steps executed: 253 Episode length: 129 Return: -128.0
I0901 12:33:33.595553 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 20

Steps executed: 65 Episode length: 65 Return: -64.08.0
INFO:tensorflow:Average training steps per second: 196.23
I0901 12:33:38.963889 140583573075968 replay_runner.py:36] Average training steps per second: 196.23

Steps executed: 565 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.61
I0901 12:33:44.736534 140583573075968 replay_runner.py:36] Average training steps per second: 197.61
I0901 12:33:45.178738 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 293 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 202.87
I0901 12:33:50.359509 140583573075968 replay_runner.py:36] Average training steps per second: 202.87
I0901 12:33:50.606153 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 23

Steps executed: 266 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 201.39
I0901 12:33:55.871691 140583573075968 replay_runner.py:36] Average training steps per second: 201.39
I0901 12:33:56.086970 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 24

Steps executed: 205 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 207.94
I0901 12:34:01.129195 140583573075968 replay_runner.py:36] Average training steps per second: 207.94
I0901 12:34:01.292231 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 25

Steps executed: 260 Episode length: 66 Return: -65.0.0
INFO:tensorflow:Average training steps per second: 199.03
I0901 12:34:06.554253 140583573075968 replay_runner.py:36] Average training steps per second: 199.03
I0901 12:34:06.771303 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 26

Steps executed: 339 Episode length: 163 Return: -162.0
INFO:tensorflow:Average training steps per second: 196.96
I0901 12:34:12.080425 140583573075968 replay_runner.py:36] Average training steps per second: 196.96
I0901 12:34:12.398878 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.50
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.63
I0901 12:34:17.766031 140583573075968 replay_runner.py:36] Average training steps per second: 195.63
I0901 12:34:18.221667 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 245 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 187.50
I0901 12:34:23.799977 140583573075968 replay_runner.py:36] Average training steps per second: 187.50
I0901 12:34:24.025886 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 29

Steps executed: 252 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 195.58

Done fixed training!Episode length: 74 Return: -73.0.0
I0901 12:34:29.579496 140583573075968 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00