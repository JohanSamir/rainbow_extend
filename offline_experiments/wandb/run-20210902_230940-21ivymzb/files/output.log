I0902 23:09:47.358834 140006414895104 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.359443 140006414895104 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.434391 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.435728 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.435812 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.435885 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.435945 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.436031 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:47.436090 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.436214 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.436295 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.436434 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.436502 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.436579 140006414895104 dqn_agent.py:283] 	 seed: 1630624187434324
I0902 23:09:47.438889 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.439045 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:47.439121 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.439186 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.439244 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.439321 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.439419 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.439492 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.439560 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
I0902 23:09:52.629725 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.167449 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.185902 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.197729 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:53.197953 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.198137 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.198258 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.198422 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.198548 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:53.198637 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
Training fixed agent 9, please be patient, may be a while...
I0902 23:09:53.198758 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.198900 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.199039 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.199205 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.199358 140006414895104 dqn_agent.py:283] 	 seed: 1630624193197679
I0902 23:09:53.202669 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:53.202933 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:53.203106 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:53.203261 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:53.203412 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:53.203713 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:53.203961 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:53.204211 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:53.209169 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:53.640912 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.749741 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:53.750270 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 113.70
I0902 23:10:02.545802 140006414895104 replay_runner.py:36] Average training steps per second: 113.70
Steps executed: 290 Episode length: 148 Return: -364.52666316645223
I0902 23:10:03.861467 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.19
INFO:tensorflow:Starting iteration 1
I0902 23:10:07.995416 140006414895104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 199.85

Steps executed: 292 Episode length: 164 Return: -309.37154239849623
I0902 23:10:13.308651 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.61
INFO:tensorflow:Starting iteration 2

Steps executed: 280 Episode length: 144 Return: -169.09710451298724
INFO:tensorflow:Average training steps per second: 201.43
I0902 23:10:22.630629 140006414895104 replay_runner.py:36] Average training steps per second: 201.43
I0902 23:10:22.886991 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.21
INFO:tensorflow:Starting iteration 3
I0902 23:10:27.271179 140006414895104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 207.95

Steps executed: 1000 Episode length: 1000 Return: -136.37672300333404
I0902 23:10:35.452457 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.38
INFO:tensorflow:Starting iteration 4
I0902 23:10:39.761401 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 209.72

Steps executed: 1000 Episode length: 1000 Return: -101.68248060232992
I0902 23:10:47.808228 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.68
INFO:tensorflow:Starting iteration 5
I0902 23:10:52.175256 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.65

Steps executed: 1000 Episode length: 1000 Return: -138.14910072560787
I0902 23:10:59.983992 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.15
INFO:tensorflow:Starting iteration 6
I0902 23:11:04.417797 140006414895104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.36

Steps executed: 897 Episode length: 897 Return: -762.3774792921929787
I0902 23:11:11.574639 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -762.38
INFO:tensorflow:Starting iteration 7

Steps executed: 341 Episode length: 341 Return: -919.4896586933659787
INFO:tensorflow:Average training steps per second: 228.10
I0902 23:11:20.274624 140006414895104 replay_runner.py:36] Average training steps per second: 228.10
I0902 23:11:20.703061 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -919.49
INFO:tensorflow:Starting iteration 8
I0902 23:11:25.005147 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 219.94

Steps executed: 471 Episode length: 471 Return: -278.4043274667805787
I0902 23:11:30.218927 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.40
INFO:tensorflow:Starting iteration 9

Steps executed: 244 Episode length: 244 Return: -441.3778336807146787
INFO:tensorflow:Average training steps per second: 223.25
I0902 23:11:39.032076 140006414895104 replay_runner.py:36] Average training steps per second: 223.25
I0902 23:11:39.310775 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.38
INFO:tensorflow:Starting iteration 10
I0902 23:11:43.670551 140006414895104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 217.98

Steps executed: 829 Episode length: 829 Return: -285.8494138819542787
I0902 23:11:50.373183 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.85
INFO:tensorflow:Starting iteration 11
I0902 23:11:54.705580 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 215.21

Steps executed: 323 Episode length: 323 Return: -302.0758595698640687
I0902 23:11:59.797035 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.08
INFO:tensorflow:Starting iteration 12
I0902 23:12:04.080960 140006414895104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 216.54
I0902 23:12:08.699933 140006414895104 replay_runner.py:36] Average training steps per second: 216.54

Steps executed: 484 Episode length: 484 Return: -181.7273153117925687
INFO:tensorflow:Starting iteration 13
I0902 23:12:13.837350 140006414895104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 219.52

Steps executed: 1000 Episode length: 1000 Return: -154.88054661416847
I0902 23:12:21.211992 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.88
INFO:tensorflow:Starting iteration 14

Steps executed: 511 Episode length: 511 Return: -196.9500829146335847
INFO:tensorflow:Average training steps per second: 220.77
I0902 23:12:29.960479 140006414895104 replay_runner.py:36] Average training steps per second: 220.77
I0902 23:12:30.889324 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.95
INFO:tensorflow:Starting iteration 15

Steps executed: 388 Episode length: 388 Return: -9.891318460184806847
INFO:tensorflow:Average training steps per second: 223.14
I0902 23:12:39.770949 140006414895104 replay_runner.py:36] Average training steps per second: 223.14
I0902 23:12:40.511718 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -9.89
INFO:tensorflow:Starting iteration 16

Steps executed: 448 Episode length: 294 Return: -175.4748068964359847
INFO:tensorflow:Average training steps per second: 270.91
I0902 23:12:48.471329 140006414895104 replay_runner.py:36] Average training steps per second: 270.91
I0902 23:12:48.887589 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.41
INFO:tensorflow:Starting iteration 17

Steps executed: 321 Episode length: 321 Return: -724.9875702718945847
INFO:tensorflow:Average training steps per second: 245.32
I0902 23:12:56.822675 140006414895104 replay_runner.py:36] Average training steps per second: 245.32
I0902 23:12:57.218747 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -724.99
INFO:tensorflow:Starting iteration 18

Steps executed: 407 Episode length: 208 Return: -4.086588720006489847
INFO:tensorflow:Average training steps per second: 232.00
I0902 23:13:05.848515 140006414895104 replay_runner.py:36] Average training steps per second: 232.00
I0902 23:13:06.230812 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.42
INFO:tensorflow:Starting iteration 19

Steps executed: 229 Episode length: 229 Return: -250.3780482200191847
INFO:tensorflow:Average training steps per second: 219.28
I0902 23:13:15.218740 140006414895104 replay_runner.py:36] Average training steps per second: 219.28
I0902 23:13:15.457112 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.38
INFO:tensorflow:Starting iteration 20

Steps executed: 252 Episode length: 76 Return: -224.63673736437298447
INFO:tensorflow:Average training steps per second: 222.58
I0902 23:13:24.174237 140006414895104 replay_runner.py:36] Average training steps per second: 222.58
I0902 23:13:24.413025 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.52
INFO:tensorflow:Starting iteration 21
I0902 23:13:28.787716 140006414895104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 220.07

Steps executed: 1000 Episode length: 1000 Return: 133.423732565418657
I0902 23:13:35.465411 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.42
INFO:tensorflow:Starting iteration 22

Steps executed: 316 Episode length: 316 Return: -447.1488009659138657
INFO:tensorflow:Average training steps per second: 221.97
I0902 23:13:44.378954 140006414895104 replay_runner.py:36] Average training steps per second: 221.97
I0902 23:13:44.793519 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.15
INFO:tensorflow:Starting iteration 23
I0902 23:13:49.146919 140006414895104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.07

Steps executed: 296 Episode length: 126 Return: -297.1727085693046657
I0902 23:13:53.942969 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.57
INFO:tensorflow:Starting iteration 24
I0902 23:13:58.241197 140006414895104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 219.44

Steps executed: 680 Episode length: 680 Return: -387.0309828462175757
I0902 23:14:04.860435 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.03
INFO:tensorflow:Starting iteration 25
I0902 23:14:09.258763 140006414895104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 221.45

Steps executed: 282 Episode length: 130 Return: -115.1882451133315957
I0902 23:14:14.052336 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -614.46
INFO:tensorflow:Starting iteration 26

Steps executed: 207 Episode length: 106 Return: -1050.413635353401357
INFO:tensorflow:Average training steps per second: 220.01
I0902 23:14:22.834196 140006414895104 replay_runner.py:36] Average training steps per second: 220.01
I0902 23:14:23.030709 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.57
INFO:tensorflow:Starting iteration 27
I0902 23:14:27.369487 140006414895104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 222.01

Steps executed: 214 Episode length: 214 Return: -159.2025501461516857
I0902 23:14:32.122214 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.20
INFO:tensorflow:Starting iteration 28

Steps executed: 239 Episode length: 159 Return: -238.1909034573944857
INFO:tensorflow:Average training steps per second: 223.84
I0902 23:14:41.021649 140006414895104 replay_runner.py:36] Average training steps per second: 223.84
I0902 23:14:41.230917 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.13
INFO:tensorflow:Starting iteration 29

Steps executed: 204 Episode length: 59 Return: -126.50701822112134857
INFO:tensorflow:Average training steps per second: 220.56
I0902 23:14:50.152586 140006414895104 replay_runner.py:36] Average training steps per second: 220.56

Done fixed training!Episode length: 59 Return: -126.50701822112134857