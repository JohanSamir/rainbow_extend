Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0902 23:40:30.796007 140527680751616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:30.806310 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:30.806541 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:30.806644 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:30.806728 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:30.806830 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:30.806953 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:40:30.807015 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:30.807098 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:30.807189 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:30.807266 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:30.807374 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:30.807462 140527680751616 dqn_agent.py:283] 	 seed: 1630626030806250
I0902 23:40:30.810397 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:30.810549 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:40:30.810881 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:30.811221 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:30.811356 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:30.811463 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:30.811570 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:30.811684 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:30.812006 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:30.851350 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:31.265372 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:31.277847 140527680751616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:31.305110 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:31.305473 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:31.305604 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:31.305733 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:31.305890 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:31.306028 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:40:31.306198 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:31.306339 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:31.306517 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:31.306607 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:31.306999 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:31.307139 140527680751616 dqn_agent.py:283] 	 seed: 1630626031305033
I0902 23:40:31.309447 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:31.309624 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:40:31.309790 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:31.309934 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:31.310053 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:31.310157 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:31.310248 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:31.310368 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:31.310495 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:31.340880 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:31.363025 140527680751616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:31.363265 140527680751616 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.76
I0902 23:40:38.271326 140527680751616 replay_runner.py:36] Average training steps per second: 144.76
Steps executed: 318 Episode length: 318 Return: -317.0
I0902 23:40:39.460509 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.00
INFO:tensorflow:Starting iteration 1
I0902 23:40:39.681677 140527680751616 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 207.68
I0902 23:40:44.497112 140527680751616 replay_runner.py:36] Average training steps per second: 207.68
I0902 23:40:44.924543 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 206.72
I0902 23:40:50.013880 140527680751616 replay_runner.py:36] Average training steps per second: 206.72
I0902 23:40:50.410513 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:40:50.642359 140527680751616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.21
I0902 23:40:55.739318 140527680751616 replay_runner.py:36] Average training steps per second: 196.21
I0902 23:40:56.052237 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.33
INFO:tensorflow:Starting iteration 4

Steps executed: 343 Episode length: 147 Return: -146.0
INFO:tensorflow:Average training steps per second: 198.91
I0902 23:41:01.310623 140527680751616 replay_runner.py:36] Average training steps per second: 198.91
I0902 23:41:01.567145 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 5


Steps executed: 239 Episode length: 145 Return: -144.0
INFO:tensorflow:Average training steps per second: 193.30
I0902 23:41:06.992175 140527680751616 replay_runner.py:36] Average training steps per second: 193.30
I0902 23:41:07.202053 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 6
I0902 23:41:07.437291 140527680751616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.28
I0902 23:41:12.558513 140527680751616 replay_runner.py:36] Average training steps per second: 195.28
I0902 23:41:12.978652 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 208.27
I0902 23:41:18.053592 140527680751616 replay_runner.py:36] Average training steps per second: 208.27
I0902 23:41:18.279827 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 8


Steps executed: 209 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 198.58
I0902 23:41:23.559719 140527680751616 replay_runner.py:36] Average training steps per second: 198.58
I0902 23:41:23.728443 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 9

Steps executed: 231 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 199.15
I0902 23:41:28.985362 140527680751616 replay_runner.py:36] Average training steps per second: 199.15
I0902 23:41:29.172763 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 10
I0902 23:41:29.404048 140527680751616 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 195.13

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:41:34.968560 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 248 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 196.96
I0902 23:41:40.286311 140527680751616 replay_runner.py:36] Average training steps per second: 196.96
I0902 23:41:40.484431 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 196.55
I0902 23:41:45.808690 140527680751616 replay_runner.py:36] Average training steps per second: 196.55
I0902 23:41:46.019845 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 13

Steps executed: 271 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 198.46
I0902 23:41:51.316078 140527680751616 replay_runner.py:36] Average training steps per second: 198.46
I0902 23:41:51.537985 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 14

Steps executed: 273 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 199.32
I0902 23:41:56.788827 140527680751616 replay_runner.py:36] Average training steps per second: 199.32
I0902 23:41:57.029706 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.50
INFO:tensorflow:Starting iteration 15

Steps executed: 297 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 195.21
I0902 23:42:02.398978 140527680751616 replay_runner.py:36] Average training steps per second: 195.21
I0902 23:42:02.652383 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 16

Steps executed: 375 Episode length: 187 Return: -186.0
INFO:tensorflow:Average training steps per second: 201.50
I0902 23:42:07.852045 140527680751616 replay_runner.py:36] Average training steps per second: 201.50
I0902 23:42:08.158974 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 17

Steps executed: 218 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 197.96
I0902 23:42:13.450523 140527680751616 replay_runner.py:36] Average training steps per second: 197.96
I0902 23:42:13.633577 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.67
INFO:tensorflow:Starting iteration 18

Steps executed: 282 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 198.26
I0902 23:42:18.919996 140527680751616 replay_runner.py:36] Average training steps per second: 198.26
I0902 23:42:19.170344 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 19

Steps executed: 321 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 198.28
I0902 23:42:24.442518 140527680751616 replay_runner.py:36] Average training steps per second: 198.28
I0902 23:42:24.707925 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 196.67
I0902 23:42:30.026907 140527680751616 replay_runner.py:36] Average training steps per second: 196.67
I0902 23:42:30.228382 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 21

Steps executed: 256 Episode length: 165 Return: -164.0
INFO:tensorflow:Average training steps per second: 200.75
I0902 23:42:35.451416 140527680751616 replay_runner.py:36] Average training steps per second: 200.75
I0902 23:42:35.660133 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 22
I0902 23:42:35.886465 140527680751616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.40

Steps executed: 228 Episode length: 64 Return: -63.0.0
I0902 23:42:41.128651 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00
INFO:tensorflow:Starting iteration 23

Steps executed: 286 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 207.60
I0902 23:42:46.191116 140527680751616 replay_runner.py:36] Average training steps per second: 207.60
I0902 23:42:46.417055 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 24

Steps executed: 277 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 195.42
I0902 23:42:51.768386 140527680751616 replay_runner.py:36] Average training steps per second: 195.42
I0902 23:42:51.973803 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.33
INFO:tensorflow:Starting iteration 25

Steps executed: 176 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 206.75

Steps executed: 247 Episode length: 71 Return: -70.0.0
I0902 23:42:57.246047 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.08
I0902 23:43:02.662915 140527680751616 replay_runner.py:36] Average training steps per second: 193.08
I0902 23:43:03.078094 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 622 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 204.88
I0902 23:43:08.187924 140527680751616 replay_runner.py:36] Average training steps per second: 204.88
I0902 23:43:08.698711 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.50
INFO:tensorflow:Starting iteration 28

Steps executed: 256 Episode length: 79 Return: -78.000
INFO:tensorflow:Average training steps per second: 198.22
I0902 23:43:13.982465 140527680751616 replay_runner.py:36] Average training steps per second: 198.22
I0902 23:43:14.192276 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 29

Steps executed: 100 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 204.90

Done fixed training!Episode length: 82 Return: -81.000
I0902 23:43:19.563145 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33