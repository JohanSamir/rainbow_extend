Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 23:25:03.779765 140170650351616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:25:03.789063 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:03.789301 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:03.789510 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:03.789631 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:03.789736 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:03.789842 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:03.789945 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:03.790076 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:03.790188 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:03.790366 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:03.790494 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:03.790624 140170650351616 dqn_agent.py:283] 	 seed: 1630625103789011
I0902 23:25:03.794859 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:03.795200 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:03.795583 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:03.795819 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:03.796029 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:03.796167 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:03.796305 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:03.796493 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:03.796983 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:03.838918 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:04.417321 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:04.432760 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:25:04.442824 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:04.443060 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:04.443231 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:04.443354 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:04.443475 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:04.443590 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:04.443803 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:04.443928 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:04.444088 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:04.444200 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:04.444377 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:04.444503 140170650351616 dqn_agent.py:283] 	 seed: 1630625104442762
I0902 23:25:04.447371 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:04.447601 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:04.447806 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:04.447978 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:04.448096 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:04.448206 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:04.448332 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:04.448623 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:04.448779 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:04.485255 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:04.510478 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:25:04.511303 140170650351616 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.78
I0902 23:25:11.100072 140170650351616 replay_runner.py:36] Average training steps per second: 151.78
Steps executed: 262 Episode length: 133 Return: 133.0
I0902 23:25:12.262645 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 1
I0902 23:25:12.433896 140170650351616 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 205.50

Steps executed: 356 Episode length: 196 Return: 196.0
I0902 23:25:17.503118 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.34
I0902 23:25:22.703108 140170650351616 replay_runner.py:36] Average training steps per second: 199.34
I0902 23:25:22.841610 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:25:23.019883 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.66
I0902 23:25:28.003971 140170650351616 replay_runner.py:36] Average training steps per second: 200.66
I0902 23:25:28.136108 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 23:25:28.318902 140170650351616 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.61
I0902 23:25:33.405412 140170650351616 replay_runner.py:36] Average training steps per second: 196.61
I0902 23:25:33.551047 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:25:33.744401 140170650351616 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.09
I0902 23:25:38.844597 140170650351616 replay_runner.py:36] Average training steps per second: 196.09
I0902 23:25:38.972902 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:25:39.147676 140170650351616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 200.97
I0902 23:25:44.123937 140170650351616 replay_runner.py:36] Average training steps per second: 200.97
I0902 23:25:44.261131 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 23:25:44.441392 140170650351616 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.06
I0902 23:25:49.490855 140170650351616 replay_runner.py:36] Average training steps per second: 198.06

Steps executed: 346 Episode length: 156 Return: 156.0
INFO:tensorflow:Starting iteration 8

Steps executed: 350 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 197.89
I0902 23:25:54.934113 140170650351616 replay_runner.py:36] Average training steps per second: 197.89
I0902 23:25:55.178832 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 9

Steps executed: 275 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 193.76
I0902 23:26:00.537299 140170650351616 replay_runner.py:36] Average training steps per second: 193.76
I0902 23:26:00.720216 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 10

Steps executed: 273 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 194.96
I0902 23:26:06.040839 140170650351616 replay_runner.py:36] Average training steps per second: 194.96
I0902 23:26:06.230258 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 11

Steps executed: 139 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 192.11
I0902 23:26:11.625299 140170650351616 replay_runner.py:36] Average training steps per second: 192.11

Steps executed: 280 Episode length: 141 Return: 141.0
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.08
I0902 23:26:16.969051 140170650351616 replay_runner.py:36] Average training steps per second: 201.08
I0902 23:26:17.099737 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13
I0902 23:26:17.288249 140170650351616 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 189.90
I0902 23:26:22.554670 140170650351616 replay_runner.py:36] Average training steps per second: 189.90
I0902 23:26:22.696268 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0902 23:26:22.875929 140170650351616 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 198.11

Steps executed: 305 Episode length: 167 Return: 167.0
I0902 23:26:28.122304 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.65
I0902 23:26:33.524746 140170650351616 replay_runner.py:36] Average training steps per second: 191.65
I0902 23:26:33.660003 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:26:33.846205 140170650351616 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.37
I0902 23:26:38.938994 140170650351616 replay_runner.py:36] Average training steps per second: 196.37
I0902 23:26:39.078079 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 367 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.62
I0902 23:26:44.520506 140170650351616 replay_runner.py:36] Average training steps per second: 189.62
I0902 23:26:44.762754 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.63
I0902 23:26:49.989204 140170650351616 replay_runner.py:36] Average training steps per second: 198.63
I0902 23:26:50.129570 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:26:50.422235 140170650351616 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 190.84
I0902 23:26:55.662498 140170650351616 replay_runner.py:36] Average training steps per second: 190.84
I0902 23:26:55.807504 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:26:55.995269 140170650351616 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 198.36
I0902 23:27:01.036848 140170650351616 replay_runner.py:36] Average training steps per second: 198.36
I0902 23:27:01.167218 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:27:01.350472 140170650351616 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.14
I0902 23:27:06.555537 140170650351616 replay_runner.py:36] Average training steps per second: 192.14
I0902 23:27:06.699295 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:27:06.891342 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 197.40
I0902 23:27:11.957578 140170650351616 replay_runner.py:36] Average training steps per second: 197.40
I0902 23:27:12.082953 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:27:12.268435 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.14
I0902 23:27:17.500681 140170650351616 replay_runner.py:36] Average training steps per second: 191.14
I0902 23:27:17.637216 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:27:17.836348 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 193.22
I0902 23:27:23.012912 140170650351616 replay_runner.py:36] Average training steps per second: 193.22
I0902 23:27:23.139041 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:27:23.312685 140170650351616 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.24
I0902 23:27:28.461400 140170650351616 replay_runner.py:36] Average training steps per second: 194.24
I0902 23:27:28.594271 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:27:28.771602 140170650351616 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.94
I0902 23:27:33.824225 140170650351616 replay_runner.py:36] Average training steps per second: 197.94
I0902 23:27:33.955589 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:27:34.133667 140170650351616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 200.26
I0902 23:27:39.127623 140170650351616 replay_runner.py:36] Average training steps per second: 200.26
I0902 23:27:39.263524 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:27:39.455491 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.16
I0902 23:27:44.606359 140170650351616 replay_runner.py:36] Average training steps per second: 194.16
I0902 23:27:44.722502 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.05
I0902 23:27:49.798531 140170650351616 replay_runner.py:36] Average training steps per second: 204.05
I0902 23:27:49.928960 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00