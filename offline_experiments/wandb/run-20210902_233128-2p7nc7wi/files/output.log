Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0902 23:31:34.803907 140717981808640 run_experiment.py:549] Creating TrainRunner ...
I0902 23:31:34.814363 140717981808640 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:34.814731 140717981808640 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:34.814905 140717981808640 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:34.815116 140717981808640 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:34.815229 140717981808640 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:34.815339 140717981808640 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:34.815483 140717981808640 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:34.815658 140717981808640 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:34.815899 140717981808640 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:34.816117 140717981808640 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:34.816358 140717981808640 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:34.816522 140717981808640 dqn_agent.py:283] 	 seed: 1630625494814297
I0902 23:31:34.819582 140717981808640 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:34.819782 140717981808640 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:34.819893 140717981808640 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:34.819977 140717981808640 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:34.820109 140717981808640 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:34.820204 140717981808640 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:34.820374 140717981808640 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:34.820444 140717981808640 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:34.820528 140717981808640 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:34.864125 140717981808640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:35.692976 140717981808640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:35.708297 140717981808640 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:31:35.716667 140717981808640 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:35.716930 140717981808640 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:35.717421 140717981808640 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:35.717558 140717981808640 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:35.717701 140717981808640 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:35.717803 140717981808640 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:35.718003 140717981808640 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:35.718114 140717981808640 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:35.718366 140717981808640 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:35.718661 140717981808640 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:35.718835 140717981808640 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:35.718938 140717981808640 dqn_agent.py:283] 	 seed: 1630625495716615
I0902 23:31:35.721700 140717981808640 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:35.721863 140717981808640 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:35.721999 140717981808640 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:35.722090 140717981808640 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:35.722177 140717981808640 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:35.722247 140717981808640 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:35.722517 140717981808640 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:35.722727 140717981808640 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:35.722833 140717981808640 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:35.759588 140717981808640 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:35.784687 140717981808640 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:31:35.785036 140717981808640 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.93
I0902 23:31:42.499759 140717981808640 replay_runner.py:36] Average training steps per second: 148.93
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:31:44.030793 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:31:44.269546 140717981808640 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.05
I0902 23:31:49.344863 140717981808640 replay_runner.py:36] Average training steps per second: 197.05
I0902 23:31:49.741340 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 232 Episode length: 232 Return: -231.0
INFO:tensorflow:Average training steps per second: 198.44
I0902 23:31:55.020679 140717981808640 replay_runner.py:36] Average training steps per second: 198.44
I0902 23:31:55.212981 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.00
INFO:tensorflow:Starting iteration 3
I0902 23:31:55.463155 140717981808640 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.82
I0902 23:32:00.596669 140717981808640 replay_runner.py:36] Average training steps per second: 194.82
I0902 23:32:00.774890 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 4

Steps executed: 226 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 194.47
I0902 23:32:06.164044 140717981808640 replay_runner.py:36] Average training steps per second: 194.47
I0902 23:32:06.569820 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.79
I0902 23:32:11.941073 140717981808640 replay_runner.py:36] Average training steps per second: 194.79
I0902 23:32:12.363912 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 23:32:12.611358 140717981808640 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.13
I0902 23:32:17.633504 140717981808640 replay_runner.py:36] Average training steps per second: 199.13
I0902 23:32:18.054495 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 23:32:18.297683 140717981808640 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 192.15
I0902 23:32:23.502334 140717981808640 replay_runner.py:36] Average training steps per second: 192.15
I0902 23:32:23.927629 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:32:24.166204 140717981808640 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.75
I0902 23:32:29.249300 140717981808640 replay_runner.py:36] Average training steps per second: 196.75
I0902 23:32:29.669254 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.00
INFO:tensorflow:Starting iteration 9

Steps executed: 501 Episode length: 306 Return: -305.0
INFO:tensorflow:Average training steps per second: 191.82
I0902 23:32:35.128276 140717981808640 replay_runner.py:36] Average training steps per second: 191.82
I0902 23:32:35.357442 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 10

Steps executed: 276 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 203.16
I0902 23:32:40.525550 140717981808640 replay_runner.py:36] Average training steps per second: 203.16

Steps executed: 219 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Starting iteration 11

Steps executed: 257 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 191.30
I0902 23:32:46.190596 140717981808640 replay_runner.py:36] Average training steps per second: 191.30
I0902 23:32:46.404847 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 12

Steps executed: 261 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 199.90
I0902 23:32:51.647275 140717981808640 replay_runner.py:36] Average training steps per second: 199.90
I0902 23:32:51.864175 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.73
I0902 23:32:57.363165 140717981808640 replay_runner.py:36] Average training steps per second: 189.73
I0902 23:32:57.789809 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 259 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 196.83
I0902 23:33:03.103919 140717981808640 replay_runner.py:36] Average training steps per second: 196.83
I0902 23:33:03.307285 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 15
I0902 23:33:03.546614 140717981808640 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 194.32

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:33:09.129196 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 310 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 192.08
I0902 23:33:14.593385 140717981808640 replay_runner.py:36] Average training steps per second: 192.08
I0902 23:33:14.847882 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.33
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.42
I0902 23:33:20.212005 140717981808640 replay_runner.py:36] Average training steps per second: 195.42
I0902 23:33:20.641664 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 274 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 195.65
I0902 23:33:25.998776 140717981808640 replay_runner.py:36] Average training steps per second: 195.65
I0902 23:33:26.223132 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 19

Steps executed: 273 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 194.07
I0902 23:33:31.620135 140717981808640 replay_runner.py:36] Average training steps per second: 194.07
I0902 23:33:31.849543 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 20

Steps executed: 270 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 190.44
I0902 23:33:37.339374 140717981808640 replay_runner.py:36] Average training steps per second: 190.44
I0902 23:33:37.557203 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 21

Steps executed: 297 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 193.95
I0902 23:33:42.950136 140717981808640 replay_runner.py:36] Average training steps per second: 193.95
I0902 23:33:43.188264 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 22

Steps executed: 264 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 202.55
I0902 23:33:48.362373 140717981808640 replay_runner.py:36] Average training steps per second: 202.55
I0902 23:33:48.579213 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 23

Steps executed: 303 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 199.87
I0902 23:33:53.826597 140717981808640 replay_runner.py:36] Average training steps per second: 199.87
I0902 23:33:54.055664 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 24

Steps executed: 616 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.05
I0902 23:33:59.289933 140717981808640 replay_runner.py:36] Average training steps per second: 200.05
I0902 23:33:59.808378 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.50
INFO:tensorflow:Starting iteration 25

Steps executed: 102 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 203.38

Steps executed: 215 Episode length: 113 Return: -112.0
I0902 23:34:05.139110 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 26

Steps executed: 201 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 194.46
I0902 23:34:10.526416 140717981808640 replay_runner.py:36] Average training steps per second: 194.46
I0902 23:34:10.695701 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 27

Steps executed: 255 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 195.01
I0902 23:34:16.059617 140717981808640 replay_runner.py:36] Average training steps per second: 195.01
I0902 23:34:16.275094 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 28

Steps executed: 239 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 202.84
I0902 23:34:21.450148 140717981808640 replay_runner.py:36] Average training steps per second: 202.84
I0902 23:34:21.637467 140717981808640 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 29

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 205.46
I0902 23:34:26.744400 140717981808640 replay_runner.py:36] Average training steps per second: 205.46

Done fixed training!Episode length: 500 Return: -500.0