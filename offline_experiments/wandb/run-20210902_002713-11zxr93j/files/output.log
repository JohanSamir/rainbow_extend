I0902 00:27:19.869153 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:27:19.877603 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:19.877780 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:19.877855 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:19.877900 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:19.877954 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:19.877998 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:19.878065 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:19.878123 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:19.878172 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:19.878250 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:19.878333 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:19.878391 140183943698432 dqn_agent.py:283] 	 seed: 1630542439877564
I0902 00:27:19.880151 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:19.880267 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:19.880339 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:19.880412 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:19.880467 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:19.880540 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:19.880621 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:19.880676 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:19.880728 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:19.908523 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:20.155639 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:20.164575 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:27:20.170357 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:20.170485 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:20.170582 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:20.170645 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:20.170701 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:20.170801 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:20.170879 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:20.170956 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:20.171031 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:20.171085 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:20.171156 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:20.171208 140183943698432 dqn_agent.py:283] 	 seed: 1630542440170312
I0902 00:27:20.172650 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:20.172764 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:20.172864 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:20.172927 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:20.172983 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:20.173061 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:20.173144 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:20.173227 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:20.173304 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:20.194789 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:20.210021 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:27:20.210196 140183943698432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 259.52
I0902 00:27:24.063620 140183943698432 replay_runner.py:36] Average training steps per second: 259.52
I0902 00:27:24.894190 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.75
Steps executed: 287 Episode length: 93 Return: -569.406374882425924
INFO:tensorflow:Starting iteration 1
I0902 00:27:28.192619 140183943698432 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 352.37
I0902 00:27:31.030881 140183943698432 replay_runner.py:36] Average training steps per second: 352.37

Steps executed: 317 Episode length: 156 Return: -437.23745771250066
INFO:tensorflow:Starting iteration 2
I0902 00:27:34.696854 140183943698432 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 335.41
I0902 00:27:37.678602 140183943698432 replay_runner.py:36] Average training steps per second: 335.41

Steps executed: 469 Episode length: 469 Return: -368.35168144709365
INFO:tensorflow:Starting iteration 3

Steps executed: 377 Episode length: 213 Return: -543.33737070898793
INFO:tensorflow:Average training steps per second: 343.15
I0902 00:27:44.614618 140183943698432 replay_runner.py:36] Average training steps per second: 343.15
I0902 00:27:44.854683 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -433.75
INFO:tensorflow:Starting iteration 4
I0902 00:27:48.248383 140183943698432 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 341.94

Steps executed: 522 Episode length: 522 Return: -192.05127631019454
I0902 00:27:51.729170 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.05
INFO:tensorflow:Starting iteration 5
I0902 00:27:55.162262 140183943698432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 358.18

Steps executed: 1000 Episode length: 1000 Return: -309.6183114174037
I0902 00:27:59.998779 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.62
INFO:tensorflow:Starting iteration 6

Steps executed: 1000 Episode length: 1000 Return: -89.72109889442406
INFO:tensorflow:Average training steps per second: 362.85
I0902 00:28:06.207751 140183943698432 replay_runner.py:36] Average training steps per second: 362.85
I0902 00:28:07.565042 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.72
INFO:tensorflow:Starting iteration 7
I0902 00:28:10.995576 140183943698432 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 340.78

Steps executed: 1000 Episode length: 1000 Return: -190.63997200124203
I0902 00:28:16.560689 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.64
INFO:tensorflow:Starting iteration 8
I0902 00:28:19.850212 140183943698432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 335.66

Steps executed: 1000 Episode length: 1000 Return: -97.491727222545563
I0902 00:28:24.686746 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.49
INFO:tensorflow:Starting iteration 9
I0902 00:28:27.881279 140183943698432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 326.79

Steps executed: 1000 Episode length: 1000 Return: -70.871547257984593
I0902 00:28:33.974839 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.87
INFO:tensorflow:Starting iteration 10

Steps executed: 51 Episode length: 51 Return: -128.308011788716674593
INFO:tensorflow:Average training steps per second: 322.82

Steps executed: 1051 Episode length: 1000 Return: -188.90188361612184
I0902 00:28:42.085137 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.60
INFO:tensorflow:Starting iteration 11

Steps executed: 277 Episode length: 277 Return: -369.8229769719188184
INFO:tensorflow:Average training steps per second: 321.24
I0902 00:28:48.459506 140183943698432 replay_runner.py:36] Average training steps per second: 321.24
I0902 00:28:48.675605 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.82
INFO:tensorflow:Starting iteration 12
I0902 00:28:51.908396 140183943698432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 327.05

Steps executed: 1000 Episode length: 1000 Return: -137.45388555100232
I0902 00:28:56.230652 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.45
INFO:tensorflow:Starting iteration 13
I0902 00:28:59.525546 140183943698432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 331.86
I0902 00:29:02.539171 140183943698432 replay_runner.py:36] Average training steps per second: 331.86

Steps executed: 801 Episode length: 801 Return: -170.9486055591487732
INFO:tensorflow:Starting iteration 14

Steps executed: 256 Episode length: 63 Return: -196.49520296177654732
INFO:tensorflow:Average training steps per second: 333.71
I0902 00:29:10.457166 140183943698432 replay_runner.py:36] Average training steps per second: 333.71
I0902 00:29:10.589735 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.71
INFO:tensorflow:Starting iteration 15

Steps executed: 267 Episode length: 140 Return: -316.6768250180234732
INFO:tensorflow:Average training steps per second: 350.54
I0902 00:29:16.881155 140183943698432 replay_runner.py:36] Average training steps per second: 350.54
I0902 00:29:17.037795 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.14
INFO:tensorflow:Starting iteration 16
I0902 00:29:20.571421 140183943698432 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 352.52

Steps executed: 823 Episode length: 823 Return: -430.6871902933414732
I0902 00:29:25.029874 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.69
INFO:tensorflow:Starting iteration 17

Steps executed: 271 Episode length: 143 Return: -635.6019090155926732
INFO:tensorflow:Average training steps per second: 357.44
I0902 00:29:31.368928 140183943698432 replay_runner.py:36] Average training steps per second: 357.44
I0902 00:29:31.523185 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.43
INFO:tensorflow:Starting iteration 18
I0902 00:29:35.005936 140183943698432 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 344.36
I0902 00:29:37.910269 140183943698432 replay_runner.py:36] Average training steps per second: 344.36

Steps executed: 316 Episode length: 127 Return: -7.070519304344302232
INFO:tensorflow:Starting iteration 19

Steps executed: 223 Episode length: 223 Return: -271.9209547878572232
INFO:tensorflow:Average training steps per second: 348.49
I0902 00:29:44.430004 140183943698432 replay_runner.py:36] Average training steps per second: 348.49
I0902 00:29:44.582551 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.92
INFO:tensorflow:Starting iteration 20

Steps executed: 267 Episode length: 129 Return: -299.9677549377851332
INFO:tensorflow:Average training steps per second: 340.11
I0902 00:29:50.993202 140183943698432 replay_runner.py:36] Average training steps per second: 340.11
I0902 00:29:51.154138 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.99
INFO:tensorflow:Starting iteration 21

Steps executed: 249 Episode length: 136 Return: -107.6081218549962832
INFO:tensorflow:Average training steps per second: 350.17
I0902 00:29:57.489241 140183943698432 replay_runner.py:36] Average training steps per second: 350.17
I0902 00:29:57.640427 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.78
INFO:tensorflow:Starting iteration 22

Steps executed: 170 Episode length: 116 Return: -140.2473433829818532
INFO:tensorflow:Average training steps per second: 367.04

Steps executed: 291 Episode length: 121 Return: -137.4180744763684532
I0902 00:30:04.019883 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.95
INFO:tensorflow:Starting iteration 23

Steps executed: 281 Episode length: 155 Return: -185.0008202031542632
INFO:tensorflow:Average training steps per second: 361.57
I0902 00:30:10.314769 140183943698432 replay_runner.py:36] Average training steps per second: 361.57
I0902 00:30:10.459313 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.38
INFO:tensorflow:Starting iteration 24

Steps executed: 224 Episode length: 74 Return: -428.95267344981613632
INFO:tensorflow:Average training steps per second: 356.74
I0902 00:30:16.777396 140183943698432 replay_runner.py:36] Average training steps per second: 356.74
I0902 00:30:16.886347 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.09
INFO:tensorflow:Starting iteration 25

Steps executed: 287 Episode length: 135 Return: -451.8836869692945632
INFO:tensorflow:Average training steps per second: 331.03
I0902 00:30:23.361731 140183943698432 replay_runner.py:36] Average training steps per second: 331.03
I0902 00:30:23.519926 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.56
INFO:tensorflow:Starting iteration 26

Steps executed: 231 Episode length: 177 Return: -110.7618349353629432
INFO:tensorflow:Average training steps per second: 345.33
I0902 00:30:29.844052 140183943698432 replay_runner.py:36] Average training steps per second: 345.33
I0902 00:30:29.959638 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.98
INFO:tensorflow:Starting iteration 27

Steps executed: 210 Episode length: 210 Return: -519.6179894974321432
INFO:tensorflow:Average training steps per second: 336.48
I0902 00:30:36.311643 140183943698432 replay_runner.py:36] Average training steps per second: 336.48
I0902 00:30:36.422793 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -519.62
INFO:tensorflow:Starting iteration 28

Steps executed: 241 Episode length: 101 Return: -119.5500491196626732
INFO:tensorflow:Average training steps per second: 335.03
I0902 00:30:42.703508 140183943698432 replay_runner.py:36] Average training steps per second: 335.03
I0902 00:30:42.828383 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.19
INFO:tensorflow:Starting iteration 29

Steps executed: 216 Episode length: 153 Return: -370.6690681607089732
INFO:tensorflow:Average training steps per second: 362.20
I0902 00:30:48.956993 140183943698432 replay_runner.py:36] Average training steps per second: 362.20

Done fixed training!Episode length: 153 Return: -370.6690681607089732