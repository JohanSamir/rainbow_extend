Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0901 12:47:35.320384 140606607828992 run_experiment.py:549] Creating TrainRunner ...
I0901 12:47:35.330237 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:35.330446 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:35.330547 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:35.330735 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:35.330808 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:35.330877 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:35.330955 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:35.331087 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:35.331173 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:35.331247 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:35.331321 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:35.331395 140606607828992 dqn_agent.py:283] 	 seed: 1630500455330179
I0901 12:47:35.334315 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:35.334544 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:35.334784 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:35.334921 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:35.335068 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:35.335171 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:35.335274 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:35.335448 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:35.335619 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:35.480915 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:35.924802 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:35.938548 140606607828992 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:47:35.949449 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:35.949700 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:35.949839 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:35.949974 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:35.950124 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:35.950248 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:35.950353 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:35.950465 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:35.950618 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:35.950736 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:35.950912 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:35.951029 140606607828992 dqn_agent.py:283] 	 seed: 1630500455949394
I0901 12:47:35.953719 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:35.953914 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:35.954041 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:35.954210 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:35.954337 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:35.954448 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:35.954561 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:35.954943 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:35.955123 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:35.987341 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:36.009603 140606607828992 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:47:36.009862 140606607828992 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 142.14
I0901 12:47:43.045423 140606607828992 replay_runner.py:36] Average training steps per second: 142.14
I0901 12:47:44.528563 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:47:44.758361 140606607828992 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.53
I0901 12:47:49.847161 140606607828992 replay_runner.py:36] Average training steps per second: 196.53
I0901 12:47:50.243006 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:47:50.481663 140606607828992 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 199.12
I0901 12:47:55.504432 140606607828992 replay_runner.py:36] Average training steps per second: 199.12
I0901 12:47:55.919826 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:47:56.165606 140606607828992 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 195.87
I0901 12:48:01.271578 140606607828992 replay_runner.py:36] Average training steps per second: 195.87
I0901 12:48:01.683861 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:48:01.935284 140606607828992 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.77

Steps executed: 633 Episode length: 500 Return: -500.0
I0901 12:48:07.534072 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.00
INFO:tensorflow:Starting iteration 5
I0901 12:48:07.784279 140606607828992 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.24

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:48:13.289295 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 292 Episode length: 141 Return: -140.0
INFO:tensorflow:Average training steps per second: 198.67
I0901 12:48:18.567303 140606607828992 replay_runner.py:36] Average training steps per second: 198.67
I0901 12:48:18.828051 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 7

Steps executed: 264 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 188.35
I0901 12:48:24.368608 140606607828992 replay_runner.py:36] Average training steps per second: 188.35
I0901 12:48:24.591724 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 8

Steps executed: 229 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 194.04
I0901 12:48:29.991543 140606607828992 replay_runner.py:36] Average training steps per second: 194.04
I0901 12:48:30.187349 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 9

Steps executed: 274 Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 197.65
I0901 12:48:35.496802 140606607828992 replay_runner.py:36] Average training steps per second: 197.65
I0901 12:48:35.731400 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 10

Steps executed: 272 Episode length: 153 Return: -152.0
INFO:tensorflow:Average training steps per second: 195.00
I0901 12:48:41.109884 140606607828992 replay_runner.py:36] Average training steps per second: 195.00
I0901 12:48:41.343111 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.38
I0901 12:48:46.602092 140606607828992 replay_runner.py:36] Average training steps per second: 199.38
I0901 12:48:47.050198 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 316 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 199.22
I0901 12:48:52.310281 140606607828992 replay_runner.py:36] Average training steps per second: 199.22
I0901 12:48:52.571522 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.00
INFO:tensorflow:Starting iteration 13

Steps executed: 228 Episode length: 228 Return: -227.0
INFO:tensorflow:Average training steps per second: 195.43
I0901 12:48:57.940961 140606607828992 replay_runner.py:36] Average training steps per second: 195.43
I0901 12:48:58.135626 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.00
INFO:tensorflow:Starting iteration 14
I0901 12:48:58.386805 140606607828992 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 196.32
I0901 12:49:03.480978 140606607828992 replay_runner.py:36] Average training steps per second: 196.32

Steps executed: 204 Episode length: 107 Return: -106.0
INFO:tensorflow:Starting iteration 15

Steps executed: 357 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 194.48
I0901 12:49:09.050499 140606607828992 replay_runner.py:36] Average training steps per second: 194.48
I0901 12:49:09.341424 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.50
INFO:tensorflow:Starting iteration 16

Steps executed: 219 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 196.64
I0901 12:49:14.663241 140606607828992 replay_runner.py:36] Average training steps per second: 196.64
I0901 12:49:14.859720 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 17

Steps executed: 234 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 206.70
I0901 12:49:19.945038 140606607828992 replay_runner.py:36] Average training steps per second: 206.70
I0901 12:49:20.128332 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 18

Steps executed: 274 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 196.78
I0901 12:49:25.453030 140606607828992 replay_runner.py:36] Average training steps per second: 196.78
I0901 12:49:25.658751 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 206.82
I0901 12:49:30.727509 140606607828992 replay_runner.py:36] Average training steps per second: 206.82
I0901 12:49:31.135756 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0901 12:49:31.440232 140606607828992 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.69
I0901 12:49:36.498966 140606607828992 replay_runner.py:36] Average training steps per second: 197.69
I0901 12:49:36.878704 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 210 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 191.07
I0901 12:49:42.352374 140606607828992 replay_runner.py:36] Average training steps per second: 191.07
I0901 12:49:42.530011 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 22

Steps executed: 205 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 200.31
I0901 12:49:47.767565 140606607828992 replay_runner.py:36] Average training steps per second: 200.31
I0901 12:49:47.932818 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 23
I0901 12:49:48.174490 140606607828992 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.60
I0901 12:49:53.287508 140606607828992 replay_runner.py:36] Average training steps per second: 195.60

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 24

Steps executed: 202 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 197.58
I0901 12:49:59.003510 140606607828992 replay_runner.py:36] Average training steps per second: 197.58
I0901 12:49:59.180914 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.64
I0901 12:50:04.361768 140606607828992 replay_runner.py:36] Average training steps per second: 202.64
I0901 12:50:04.771449 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 271 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 194.03
I0901 12:50:10.168938 140606607828992 replay_runner.py:36] Average training steps per second: 194.03
I0901 12:50:10.398230 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 27
I0901 12:50:10.646945 140606607828992 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 194.75

Steps executed: 288 Episode length: 90 Return: -89.0.0
I0901 12:50:16.035740 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 28

Steps executed: 279 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 201.85
I0901 12:50:21.240326 140606607828992 replay_runner.py:36] Average training steps per second: 201.85
I0901 12:50:21.472539 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 194.72
I0901 12:50:26.845966 140606607828992 replay_runner.py:36] Average training steps per second: 194.72
I0901 12:50:27.046223 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00