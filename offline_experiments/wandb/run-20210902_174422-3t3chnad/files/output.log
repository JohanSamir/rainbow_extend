Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0902 17:44:28.830850 140224194521088 run_experiment.py:549] Creating TrainRunner ...
I0902 17:44:28.843049 140224194521088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:28.843209 140224194521088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:28.843282 140224194521088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:28.843343 140224194521088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:28.843398 140224194521088 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:28.843532 140224194521088 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:28.843591 140224194521088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:28.843663 140224194521088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:28.843744 140224194521088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:28.843812 140224194521088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:28.843887 140224194521088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:28.843965 140224194521088 dqn_agent.py:283] 	 seed: 1630604668843011
I0902 17:44:28.845684 140224194521088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:28.845795 140224194521088 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:28.845870 140224194521088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:28.845935 140224194521088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:28.845992 140224194521088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:28.846070 140224194521088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:28.846132 140224194521088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:28.846216 140224194521088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:28.846287 140224194521088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:28.874390 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:29.323039 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:29.335398 140224194521088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:44:29.345000 140224194521088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:44:29.345216 140224194521088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:44:29.345324 140224194521088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:44:29.345385 140224194521088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:44:29.345441 140224194521088 dqn_agent.py:275] 	 update_period: 4
I0902 17:44:29.345524 140224194521088 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:44:29.345669 140224194521088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:44:29.345730 140224194521088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:44:29.345801 140224194521088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:44:29.345880 140224194521088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:44:29.345966 140224194521088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:44:29.346029 140224194521088 dqn_agent.py:283] 	 seed: 1630604669344950
I0902 17:44:29.347883 140224194521088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:44:29.348027 140224194521088 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:44:29.348188 140224194521088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:44:29.348278 140224194521088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:44:29.348396 140224194521088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:44:29.348466 140224194521088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:44:29.348564 140224194521088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:44:29.348643 140224194521088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:44:29.348726 140224194521088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:44:29.377457 140224194521088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=5.000000
I0902 17:44:29.395882 140224194521088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:44:29.396063 140224194521088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.18
I0902 17:44:36.099721 140224194521088 replay_runner.py:36] Average training steps per second: 149.18
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:44:37.473152 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:44:37.716951 140224194521088 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.94
I0902 17:44:42.693953 140224194521088 replay_runner.py:36] Average training steps per second: 200.94
I0902 17:44:43.096007 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:44:43.350263 140224194521088 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 206.95
I0902 17:44:48.183013 140224194521088 replay_runner.py:36] Average training steps per second: 206.95
I0902 17:44:48.628482 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:44:48.888663 140224194521088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.83
I0902 17:44:53.944093 140224194521088 replay_runner.py:36] Average training steps per second: 197.83
I0902 17:44:54.330980 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:44:54.572881 140224194521088 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 201.96
I0902 17:44:59.524704 140224194521088 replay_runner.py:36] Average training steps per second: 201.96
I0902 17:44:59.959893 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:45:00.221503 140224194521088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 209.75
I0902 17:45:04.989420 140224194521088 replay_runner.py:36] Average training steps per second: 209.75
I0902 17:45:05.394444 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:45:05.626649 140224194521088 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 198.64
I0902 17:45:10.661309 140224194521088 replay_runner.py:36] Average training steps per second: 198.64
I0902 17:45:11.067173 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:45:11.306698 140224194521088 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 205.44
I0902 17:45:16.174709 140224194521088 replay_runner.py:36] Average training steps per second: 205.44
I0902 17:45:16.604041 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:45:16.861468 140224194521088 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 201.30
I0902 17:45:21.829505 140224194521088 replay_runner.py:36] Average training steps per second: 201.30
I0902 17:45:22.211276 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:45:22.447397 140224194521088 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 199.69
I0902 17:45:27.455455 140224194521088 replay_runner.py:36] Average training steps per second: 199.69
I0902 17:45:27.881244 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:45:28.127371 140224194521088 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 206.67
I0902 17:45:32.966460 140224194521088 replay_runner.py:36] Average training steps per second: 206.67
I0902 17:45:33.374206 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:45:33.624640 140224194521088 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 198.42
I0902 17:45:38.665252 140224194521088 replay_runner.py:36] Average training steps per second: 198.42
I0902 17:45:39.071496 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:45:39.308441 140224194521088 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 202.32
I0902 17:45:44.251518 140224194521088 replay_runner.py:36] Average training steps per second: 202.32
I0902 17:45:44.686437 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:45:44.937243 140224194521088 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 204.93
I0902 17:45:49.817228 140224194521088 replay_runner.py:36] Average training steps per second: 204.93
I0902 17:45:50.225736 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:45:50.463493 140224194521088 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 197.73
I0902 17:45:55.521253 140224194521088 replay_runner.py:36] Average training steps per second: 197.73
I0902 17:45:55.934662 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:45:56.176290 140224194521088 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 214.02
I0902 17:46:00.849149 140224194521088 replay_runner.py:36] Average training steps per second: 214.02
I0902 17:46:01.212062 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 17:46:01.437129 140224194521088 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 217.11
I0902 17:46:06.043638 140224194521088 replay_runner.py:36] Average training steps per second: 217.11
I0902 17:46:06.435443 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 17:46:06.681438 140224194521088 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 197.01
I0902 17:46:11.757507 140224194521088 replay_runner.py:36] Average training steps per second: 197.01
I0902 17:46:12.136816 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 17:46:12.384294 140224194521088 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 202.01
I0902 17:46:17.335029 140224194521088 replay_runner.py:36] Average training steps per second: 202.01
I0902 17:46:17.755029 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 17:46:17.996688 140224194521088 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 203.56
I0902 17:46:22.909706 140224194521088 replay_runner.py:36] Average training steps per second: 203.56
I0902 17:46:23.294909 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 17:46:23.525727 140224194521088 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.10
I0902 17:46:28.599728 140224194521088 replay_runner.py:36] Average training steps per second: 197.10
I0902 17:46:29.005997 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 17:46:29.242027 140224194521088 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 203.06
I0902 17:46:34.167185 140224194521088 replay_runner.py:36] Average training steps per second: 203.06
I0902 17:46:34.569011 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 17:46:34.804054 140224194521088 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.71
I0902 17:46:39.888856 140224194521088 replay_runner.py:36] Average training steps per second: 196.71
I0902 17:46:40.273777 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 17:46:40.516126 140224194521088 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 201.11
I0902 17:46:45.489237 140224194521088 replay_runner.py:36] Average training steps per second: 201.11
I0902 17:46:45.917782 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:46:46.169371 140224194521088 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 203.92
I0902 17:46:51.073729 140224194521088 replay_runner.py:36] Average training steps per second: 203.92
I0902 17:46:51.471073 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 17:46:51.713809 140224194521088 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.78
I0902 17:46:56.770421 140224194521088 replay_runner.py:36] Average training steps per second: 197.78
I0902 17:46:57.171846 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 17:46:57.409950 140224194521088 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 207.88
I0902 17:47:02.220816 140224194521088 replay_runner.py:36] Average training steps per second: 207.88
I0902 17:47:02.640475 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 17:47:02.886516 140224194521088 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 205.72
I0902 17:47:07.747913 140224194521088 replay_runner.py:36] Average training steps per second: 205.72
I0902 17:47:08.105575 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0902 17:47:08.329557 140224194521088 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 228.97
I0902 17:47:12.697614 140224194521088 replay_runner.py:36] Average training steps per second: 228.97
I0902 17:47:13.062063 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 214.49
I0902 17:47:17.952764 140224194521088 replay_runner.py:36] Average training steps per second: 214.49
I0902 17:47:18.323898 140224194521088 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00