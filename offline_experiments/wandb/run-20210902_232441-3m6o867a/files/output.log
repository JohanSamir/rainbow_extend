I0902 23:24:47.869529 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:24:47.880028 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:47.880218 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:47.880296 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:47.880373 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:47.880432 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:47.880487 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:47.880546 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:47.880599 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:47.880652 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:47.880703 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:47.880762 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:47.880814 139900407642112 dqn_agent.py:283] 	 seed: 1630625087879978
I0902 23:24:47.883705 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:47.884004 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:47.884183 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:47.884342 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:47.884514 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:47.884777 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:47.884910 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:47.885068 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:47.885149 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:49.385953 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 23:24:49.816757 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:49.833899 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:24:49.855741 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:49.856407 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:49.856619 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:49.856768 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:49.856865 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:49.856994 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:49.857420 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:49.857630 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:49.876585 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:49.877532 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:49.878185 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:49.878412 139900407642112 dqn_agent.py:283] 	 seed: 1630625089855676
I0902 23:24:49.882241 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:49.882373 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:49.882779 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:49.883111 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:49.884080 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:49.884222 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:49.884400 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:49.884601 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:49.884736 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:49.931529 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:49.953010 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:24:49.953349 139900407642112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 174.88
I0902 23:24:55.671725 139900407642112 replay_runner.py:36] Average training steps per second: 174.88
I0902 23:24:57.286829 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.92
Steps executed: 305 Episode length: 151 Return: -358.75113605427634
INFO:tensorflow:Starting iteration 1

Steps executed: 248 Episode length: 128 Return: -178.74425943417708
INFO:tensorflow:Average training steps per second: 228.88
I0902 23:25:05.903565 139900407642112 replay_runner.py:36] Average training steps per second: 228.88
I0902 23:25:06.111012 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.35
INFO:tensorflow:Starting iteration 2
I0902 23:25:10.379848 139900407642112 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 230.25
I0902 23:25:14.723623 139900407642112 replay_runner.py:36] Average training steps per second: 230.25

Steps executed: 226 Episode length: 117 Return: -348.70563363844156
INFO:tensorflow:Starting iteration 3
I0902 23:25:18.984799 139900407642112 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 236.00

Steps executed: 617 Episode length: 617 Return: -94.759332919597646
I0902 23:25:24.531578 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.76
INFO:tensorflow:Starting iteration 4
I0902 23:25:28.736160 139900407642112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 232.26

Steps executed: 1000 Episode length: 1000 Return: -108.30396223240832
I0902 23:25:38.229614 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.30
INFO:tensorflow:Starting iteration 5
I0902 23:25:42.442319 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 222.99

Steps executed: 1000 Episode length: 1000 Return: -203.59736479772242
I0902 23:25:49.008041 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.60
INFO:tensorflow:Starting iteration 6
I0902 23:25:53.263214 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 214.73

Steps executed: 1000 Episode length: 1000 Return: -205.61646590557353
I0902 23:26:01.255902 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.62
INFO:tensorflow:Starting iteration 7
I0902 23:26:05.579073 139900407642112 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 218.89

Steps executed: 1000 Episode length: 1000 Return: -172.63268496521093
I0902 23:26:12.146790 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.63
INFO:tensorflow:Starting iteration 8
I0902 23:26:16.384718 139900407642112 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 220.71

Steps executed: 1000 Episode length: 1000 Return: -242.05555972147403
I0902 23:26:23.518643 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.06
INFO:tensorflow:Starting iteration 9
I0902 23:26:27.683199 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 221.77

Steps executed: 1000 Episode length: 1000 Return: -182.28584432211235
I0902 23:26:35.767733 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.29
INFO:tensorflow:Starting iteration 10
I0902 23:26:40.017213 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 217.19

Steps executed: 1000 Episode length: 1000 Return: -87.170269289308695
I0902 23:26:47.480284 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.17
INFO:tensorflow:Starting iteration 11
I0902 23:26:51.763345 139900407642112 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 217.38

Steps executed: 1000 Episode length: 1000 Return: -247.93533828632036
I0902 23:27:00.108787 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.94
INFO:tensorflow:Starting iteration 12
I0902 23:27:04.484543 139900407642112 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 218.63

Steps executed: 1000 Episode length: 1000 Return: -98.241691676933246
I0902 23:27:13.154818 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.24
INFO:tensorflow:Starting iteration 13
I0902 23:27:17.582237 139900407642112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 226.79

Steps executed: 258 Episode length: 258 Return: -64.33347333810153246
I0902 23:27:22.346724 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.33
INFO:tensorflow:Starting iteration 14
I0902 23:27:26.631666 139900407642112 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 225.14
I0902 23:27:31.073744 139900407642112 replay_runner.py:36] Average training steps per second: 225.14

Steps executed: 930 Episode length: 930 Return: 143.71022576985345246
INFO:tensorflow:Starting iteration 15
I0902 23:27:38.330746 139900407642112 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 218.19

Steps executed: 1000 Episode length: 1000 Return: -75.616971302545726
I0902 23:27:45.896819 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.62
INFO:tensorflow:Starting iteration 16

Steps executed: 52 Episode length: 52 Return: -178.594470664654545726
INFO:tensorflow:Average training steps per second: 231.81

Steps executed: 980 Episode length: 928 Return: -238.1157972065154826
I0902 23:27:57.049209 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.36
INFO:tensorflow:Starting iteration 17
I0902 23:28:01.290235 139900407642112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 227.17

Steps executed: 584 Episode length: 584 Return: -52.57209302753099826
I0902 23:28:07.179055 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.57
INFO:tensorflow:Starting iteration 18
I0902 23:28:11.528206 139900407642112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 231.19

Steps executed: 1000 Episode length: 1000 Return: 15.3737407522763326
I0902 23:28:18.650563 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.37
INFO:tensorflow:Starting iteration 19

Steps executed: 259 Episode length: 130 Return: -268.5928158713618426
INFO:tensorflow:Average training steps per second: 233.42
I0902 23:28:27.187005 139900407642112 replay_runner.py:36] Average training steps per second: 233.42
I0902 23:28:27.434476 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.53
INFO:tensorflow:Starting iteration 20

Steps executed: 145 Episode length: 66 Return: -2.3341332862983258426
INFO:tensorflow:Average training steps per second: 229.66
I0902 23:28:36.031898 139900407642112 replay_runner.py:36] Average training steps per second: 229.66

Steps executed: 1145 Episode length: 1000 Return: 130.101655733016326
INFO:tensorflow:Starting iteration 21

Steps executed: 376 Episode length: 202 Return: 50.086847381815320426
INFO:tensorflow:Average training steps per second: 219.93
I0902 23:28:47.383329 139900407642112 replay_runner.py:36] Average training steps per second: 219.93
I0902 23:28:47.781496 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -34.12
INFO:tensorflow:Starting iteration 22
I0902 23:28:52.080424 139900407642112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 221.82

Steps executed: 550 Episode length: 550 Return: -613.6407907346824426
I0902 23:28:57.612051 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -613.64
INFO:tensorflow:Starting iteration 23
I0902 23:29:01.958536 139900407642112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.33
I0902 23:29:06.457108 139900407642112 replay_runner.py:36] Average training steps per second: 222.33

Steps executed: 253 Episode length: 171 Return: -341.7562633660721426
INFO:tensorflow:Starting iteration 24

Steps executed: 326 Episode length: 165 Return: -320.5984410732459726
INFO:tensorflow:Average training steps per second: 223.44
I0902 23:29:15.433128 139900407642112 replay_runner.py:36] Average training steps per second: 223.44
I0902 23:29:15.743704 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.03
INFO:tensorflow:Starting iteration 25

Steps executed: 706 Episode length: 571 Return: 192.93379474540188726
INFO:tensorflow:Average training steps per second: 222.26
I0902 23:29:24.607219 139900407642112 replay_runner.py:36] Average training steps per second: 222.26
I0902 23:29:26.170820 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.24
INFO:tensorflow:Starting iteration 26

Steps executed: 353 Episode length: 199 Return: -75.73242500276784726
INFO:tensorflow:Average training steps per second: 222.79
I0902 23:29:34.829347 139900407642112 replay_runner.py:36] Average training steps per second: 222.79
I0902 23:29:35.197305 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.86
INFO:tensorflow:Starting iteration 27

Steps executed: 286 Episode length: 127 Return: -8.632778888639862726
INFO:tensorflow:Average training steps per second: 217.34
I0902 23:29:43.828121 139900407642112 replay_runner.py:36] Average training steps per second: 217.34
I0902 23:29:44.065779 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.47
INFO:tensorflow:Starting iteration 28
I0902 23:29:48.418257 139900407642112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 230.17

Steps executed: 1000 Episode length: 1000 Return: 47.2400710181159346
I0902 23:29:55.480520 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: 47.24
INFO:tensorflow:Starting iteration 29

Steps executed: 220 Episode length: 65 Return: -512.10907999298719346
INFO:tensorflow:Average training steps per second: 228.21
I0902 23:30:04.182757 139900407642112 replay_runner.py:36] Average training steps per second: 228.21

Done fixed training!Episode length: 65 Return: -512.10907999298719346