Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 17:53:18.366759 140537039579136 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:18.376017 140537039579136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:18.376227 140537039579136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:18.376574 140537039579136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:18.376703 140537039579136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:18.376843 140537039579136 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:18.377331 140537039579136 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:18.377672 140537039579136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:18.377858 140537039579136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:18.377971 140537039579136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:18.378300 140537039579136 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:18.378435 140537039579136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:18.378644 140537039579136 dqn_agent.py:283] 	 seed: 1630605198375959
I0902 17:53:18.381535 140537039579136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:18.381678 140537039579136 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:18.381769 140537039579136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:18.381840 140537039579136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:18.381903 140537039579136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:18.381978 140537039579136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:18.382062 140537039579136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:18.382163 140537039579136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:18.382289 140537039579136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:18.419848 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:19.246731 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:19.260720 140537039579136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:19.268217 140537039579136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:19.268531 140537039579136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:19.268715 140537039579136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:19.268814 140537039579136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:19.268906 140537039579136 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:19.269049 140537039579136 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:19.269360 140537039579136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:19.269654 140537039579136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:19.269869 140537039579136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:19.270056 140537039579136 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:19.270189 140537039579136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:19.270315 140537039579136 dqn_agent.py:283] 	 seed: 1630605199268150
I0902 17:53:19.272397 140537039579136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:19.272521 140537039579136 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:19.272611 140537039579136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:19.272681 140537039579136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:19.272744 140537039579136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:19.272844 140537039579136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:19.272945 140537039579136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:19.273018 140537039579136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:19.273090 140537039579136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:19.305374 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:19.326591 140537039579136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:19.326864 140537039579136 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.65
I0902 17:53:25.965485 140537039579136 replay_runner.py:36] Average training steps per second: 150.65
Steps executed: 208 Episode length: 9 Return: 9.0.0
I0902 17:53:27.169985 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1
I0902 17:53:27.367784 140537039579136 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 198.11
I0902 17:53:32.415972 140537039579136 replay_runner.py:36] Average training steps per second: 198.11
I0902 17:53:32.578724 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 2

Steps executed: 205 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 205.26
I0902 17:53:37.637369 140537039579136 replay_runner.py:36] Average training steps per second: 205.26
I0902 17:53:37.774682 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 209.51
I0902 17:53:42.729552 140537039579136 replay_runner.py:36] Average training steps per second: 209.51
I0902 17:53:42.857509 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 4

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 206.64

Steps executed: 208 Episode length: 9 Return: 9.0.0
I0902 17:53:48.030476 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 5

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 205.90
I0902 17:53:53.063807 140537039579136 replay_runner.py:36] Average training steps per second: 205.90
I0902 17:53:53.203127 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 6

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 201.69
I0902 17:53:58.352572 140537039579136 replay_runner.py:36] Average training steps per second: 201.69
I0902 17:53:58.490079 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 7
I0902 17:53:58.669305 140537039579136 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.34
I0902 17:54:03.763109 140537039579136 replay_runner.py:36] Average training steps per second: 196.34
I0902 17:54:03.910485 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 8


Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 202.46
I0902 17:54:09.049086 140537039579136 replay_runner.py:36] Average training steps per second: 202.46
I0902 17:54:09.189537 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 9

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.56
I0902 17:54:14.552273 140537039579136 replay_runner.py:36] Average training steps per second: 193.56
I0902 17:54:14.696061 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.37
I0902 17:54:19.934075 140537039579136 replay_runner.py:36] Average training steps per second: 198.37
I0902 17:54:20.080971 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 11

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.92
I0902 17:54:25.319595 140537039579136 replay_runner.py:36] Average training steps per second: 197.92
I0902 17:54:25.464176 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 12

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 190.37
I0902 17:54:30.906356 140537039579136 replay_runner.py:36] Average training steps per second: 190.37
I0902 17:54:31.063909 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 13
I0902 17:54:31.263003 140537039579136 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 196.81

Steps executed: 200 Episode length: 10 Return: 10.0
I0902 17:54:36.485721 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 14

Steps executed: 321 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 192.49
I0902 17:54:41.886952 140537039579136 replay_runner.py:36] Average training steps per second: 192.49
I0902 17:54:42.115498 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.16
I0902 17:54:47.333504 140537039579136 replay_runner.py:36] Average training steps per second: 199.16
I0902 17:54:47.470494 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 17:54:47.658358 140537039579136 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.42
I0902 17:54:52.750149 140537039579136 replay_runner.py:36] Average training steps per second: 196.42
I0902 17:54:52.882913 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 163 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 196.33
I0902 17:54:58.162461 140537039579136 replay_runner.py:36] Average training steps per second: 196.33
I0902 17:54:58.377222 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 18


Steps executed: 340 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 198.71
I0902 17:55:03.609494 140537039579136 replay_runner.py:36] Average training steps per second: 198.71
I0902 17:55:03.838461 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 19

Steps executed: 359 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 197.23
I0902 17:55:09.110888 140537039579136 replay_runner.py:36] Average training steps per second: 197.23
I0902 17:55:09.358352 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50
INFO:tensorflow:Starting iteration 20
I0902 17:55:09.536502 140537039579136 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 201.49

Steps executed: 360 Episode length: 184 Return: 184.0
I0902 17:55:14.737481 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 21

Steps executed: 358 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 196.71
I0902 17:55:20.022647 140537039579136 replay_runner.py:36] Average training steps per second: 196.71
I0902 17:55:20.264585 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 22

Steps executed: 330 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 198.62
I0902 17:55:25.495065 140537039579136 replay_runner.py:36] Average training steps per second: 198.62
I0902 17:55:25.699691 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 23
I0902 17:55:25.886452 140537039579136 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 207.60

Steps executed: 355 Episode length: 191 Return: 191.0
I0902 17:55:30.978502 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.50
INFO:tensorflow:Starting iteration 24

Steps executed: 330 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 201.05
I0902 17:55:36.145570 140537039579136 replay_runner.py:36] Average training steps per second: 201.05
I0902 17:55:36.351880 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.43
I0902 17:55:41.500337 140537039579136 replay_runner.py:36] Average training steps per second: 201.43
I0902 17:55:41.626924 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 17:55:41.809136 140537039579136 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.07
I0902 17:55:46.884013 140537039579136 replay_runner.py:36] Average training steps per second: 197.07
I0902 17:55:47.010422 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 17:55:47.199573 140537039579136 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 199.59
I0902 17:55:52.210285 140537039579136 replay_runner.py:36] Average training steps per second: 199.59
I0902 17:55:52.345264 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 17:55:52.538248 140537039579136 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 202.11
I0902 17:55:57.486226 140537039579136 replay_runner.py:36] Average training steps per second: 202.11
I0902 17:55:57.616828 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.89
I0902 17:56:02.785319 140537039579136 replay_runner.py:36] Average training steps per second: 200.89
I0902 17:56:02.904403 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00