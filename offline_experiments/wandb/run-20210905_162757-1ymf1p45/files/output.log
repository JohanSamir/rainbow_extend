I0905 16:28:03.264464 139803301922816 run_experiment.py:549] Creating TrainRunner ...
I0905 16:28:03.275379 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:28:03.275613 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:28:03.275709 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:28:03.275817 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:28:03.275930 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:28:03.276045 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:28:03.276143 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:28:03.276281 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:28:03.276400 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:28:03.276481 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:28:03.276568 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:28:03.276622 139803301922816 dqn_agent.py:283] 	 seed: 1630859283275328
I0905 16:28:03.278445 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:28:03.278561 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:28:03.278639 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:28:03.278706 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:28:03.278785 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:28:03.278861 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:28:03.278972 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:28:03.279059 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:28:03.279148 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
I0905 16:28:04.899622 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:28:05.235167 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:28:05.245432 139803301922816 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:28:05.252480 139803301922816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:28:05.252638 139803301922816 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:28:05.252714 139803301922816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:28:05.252847 139803301922816 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:28:05.252908 139803301922816 dqn_agent.py:275] 	 update_period: 4
I0905 16:28:05.253011 139803301922816 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:28:05.253066 139803301922816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:28:05.253154 139803301922816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:28:05.253241 139803301922816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:28:05.253317 139803301922816 dqn_agent.py:280] 	 optimizer: adam
I0905 16:28:05.253398 139803301922816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:28:05.253467 139803301922816 dqn_agent.py:283] 	 seed: 1630859285252441
I0905 16:28:05.264675 139803301922816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:28:05.264892 139803301922816 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:28:05.265058 139803301922816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:28:05.265151 139803301922816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:28:05.265261 139803301922816 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:28:05.265358 139803301922816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:28:05.265423 139803301922816 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:28:05.265792 139803301922816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:28:05.266009 139803301922816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:28:05.305254 139803301922816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:28:05.321396 139803301922816 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:28:05.321658 139803301922816 replay_runner.py:41] Starting iteration 0
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 205.45
I0905 16:28:10.189425 139803301922816 replay_runner.py:36] Average training steps per second: 205.45
Steps executed: 298 Episode length: 298 Return: -72.4655195036541
I0905 16:28:11.212450 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.47
INFO:tensorflow:Starting iteration 1

Steps executed: 254 Episode length: 123 Return: -184.64771221104746
INFO:tensorflow:Average training steps per second: 304.72
I0905 16:28:18.238963 139803301922816 replay_runner.py:36] Average training steps per second: 304.72
I0905 16:28:18.404186 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.71
INFO:tensorflow:Starting iteration 2

Steps executed: 471 Episode length: 314 Return: -211.53631480265446
INFO:tensorflow:Average training steps per second: 299.72
I0905 16:28:25.501190 139803301922816 replay_runner.py:36] Average training steps per second: 299.72
I0905 16:28:25.816306 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.61
INFO:tensorflow:Starting iteration 3
I0905 16:28:29.538322 139803301922816 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 299.19

Steps executed: 261 Episode length: 154 Return: -499.96015522322256
I0905 16:28:33.030916 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.59
INFO:tensorflow:Starting iteration 4

Steps executed: 605 Episode length: 425 Return: -243.85661409499772
INFO:tensorflow:Average training steps per second: 302.05
I0905 16:28:40.043387 139803301922816 replay_runner.py:36] Average training steps per second: 302.05
I0905 16:28:40.744675 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.00
INFO:tensorflow:Starting iteration 5
I0905 16:28:44.472634 139803301922816 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 296.81

Steps executed: 647 Episode length: 647 Return: -419.61744734469372
I0905 16:28:49.144940 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.62
INFO:tensorflow:Starting iteration 6

Steps executed: 231 Episode length: 231 Return: -958.33914313605982
INFO:tensorflow:Average training steps per second: 305.02
I0905 16:28:56.087064 139803301922816 replay_runner.py:36] Average training steps per second: 305.02
I0905 16:28:56.294427 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -958.34
INFO:tensorflow:Starting iteration 7
I0905 16:28:59.949508 139803301922816 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 312.68

Steps executed: 918 Episode length: 918 Return: -687.39062986127682
I0905 16:29:05.486846 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -687.39
INFO:tensorflow:Starting iteration 8

Steps executed: 300 Episode length: 300 Return: -1580.9568803905245
INFO:tensorflow:Average training steps per second: 302.21
I0905 16:29:12.439062 139803301922816 replay_runner.py:36] Average training steps per second: 302.21
I0905 16:29:12.682431 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -1580.96
INFO:tensorflow:Starting iteration 9
I0905 16:29:16.511407 139803301922816 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 268.62

Steps executed: 1000 Episode length: 1000 Return: -117.66562390835097
I0905 16:29:24.455767 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.67
INFO:tensorflow:Starting iteration 10
I0905 16:29:28.459100 139803301922816 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 232.49

Steps executed: 828 Episode length: 828 Return: -643.5876594533745097
I0905 16:29:34.303450 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -643.59
INFO:tensorflow:Starting iteration 11

Steps executed: 262 Episode length: 262 Return: -498.0310584297149697
INFO:tensorflow:Average training steps per second: 235.71
I0905 16:29:42.736493 139803301922816 replay_runner.py:36] Average training steps per second: 235.71
I0905 16:29:43.029799 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.03
INFO:tensorflow:Starting iteration 12
I0905 16:29:47.245966 139803301922816 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 232.50

Steps executed: 1000 Episode length: 1000 Return: -92.342983327707477
I0905 16:29:53.814374 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.34
INFO:tensorflow:Starting iteration 13
I0905 16:29:58.119707 139803301922816 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 231.41

Steps executed: 1000 Episode length: 1000 Return: -77.028542121358647
I0905 16:30:05.315309 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.03
INFO:tensorflow:Starting iteration 14

Steps executed: 337 Episode length: 163 Return: -236.7863222501226847
INFO:tensorflow:Average training steps per second: 236.68
I0905 16:30:13.717672 139803301922816 replay_runner.py:36] Average training steps per second: 236.68
I0905 16:30:14.005132 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.61
INFO:tensorflow:Starting iteration 15

Steps executed: 342 Episode length: 342 Return: -152.0087314427052847
INFO:tensorflow:Average training steps per second: 235.43
I0905 16:30:22.566368 139803301922816 replay_runner.py:36] Average training steps per second: 235.43
I0905 16:30:22.907498 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.01
INFO:tensorflow:Starting iteration 16
I0905 16:30:27.141532 139803301922816 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 233.96

Steps executed: 527 Episode length: 527 Return: -274.5424192908061847
I0905 16:30:32.294970 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.54
INFO:tensorflow:Starting iteration 17

Steps executed: 78 Episode length: 78 Return: -64.1389738133664261847
INFO:tensorflow:Average training steps per second: 236.12
I0905 16:30:40.769315 139803301922816 replay_runner.py:36] Average training steps per second: 236.12

Steps executed: 486 Episode length: 408 Return: -291.5840890098401847
INFO:tensorflow:Starting iteration 18

Steps executed: 228 Episode length: 150 Return: -288.0608907738465847
INFO:tensorflow:Average training steps per second: 235.14
I0905 16:30:49.944814 139803301922816 replay_runner.py:36] Average training steps per second: 235.14
I0905 16:30:50.105018 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.08
INFO:tensorflow:Starting iteration 19

Steps executed: 204 Episode length: 204 Return: -474.9937160934881647
INFO:tensorflow:Average training steps per second: 237.39
I0905 16:30:58.567063 139803301922816 replay_runner.py:36] Average training steps per second: 237.39
I0905 16:30:58.769555 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.99
INFO:tensorflow:Starting iteration 20

Steps executed: 214 Episode length: 214 Return: -361.0820030696768647
INFO:tensorflow:Average training steps per second: 239.18
I0905 16:31:07.207371 139803301922816 replay_runner.py:36] Average training steps per second: 239.18
I0905 16:31:07.409689 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.08
INFO:tensorflow:Starting iteration 21

Steps executed: 265 Episode length: 134 Return: -97.15970246191492647
INFO:tensorflow:Average training steps per second: 232.70
I0905 16:31:15.956820 139803301922816 replay_runner.py:36] Average training steps per second: 232.70
I0905 16:31:16.165842 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.21
INFO:tensorflow:Starting iteration 22

Steps executed: 505 Episode length: 310 Return: -360.4969544705261647
INFO:tensorflow:Average training steps per second: 235.53
I0905 16:31:24.697363 139803301922816 replay_runner.py:36] Average training steps per second: 235.53
I0905 16:31:25.228602 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.77
INFO:tensorflow:Starting iteration 23

Steps executed: 227 Episode length: 103 Return: -348.0140464824001647
INFO:tensorflow:Average training steps per second: 235.58
I0905 16:31:33.733816 139803301922816 replay_runner.py:36] Average training steps per second: 235.58
I0905 16:31:33.913005 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.46
INFO:tensorflow:Starting iteration 24

Steps executed: 250 Episode length: 250 Return: -175.0979987169914647
INFO:tensorflow:Average training steps per second: 238.54
I0905 16:31:42.130529 139803301922816 replay_runner.py:36] Average training steps per second: 238.54
I0905 16:31:42.419675 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.10
INFO:tensorflow:Starting iteration 25

Steps executed: 228 Episode length: 121 Return: -352.6935353097823747
INFO:tensorflow:Average training steps per second: 253.76
I0905 16:31:50.474044 139803301922816 replay_runner.py:36] Average training steps per second: 253.76
I0905 16:31:50.632721 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.75
INFO:tensorflow:Starting iteration 26

Steps executed: 248 Episode length: 119 Return: -256.6166326584178447
INFO:tensorflow:Average training steps per second: 233.51
I0905 16:31:59.124091 139803301922816 replay_runner.py:36] Average training steps per second: 233.51
I0905 16:31:59.297896 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.59
INFO:tensorflow:Starting iteration 27

Steps executed: 288 Episode length: 130 Return: -266.6210065499526447
INFO:tensorflow:Average training steps per second: 203.05
I0905 16:32:08.497222 139803301922816 replay_runner.py:36] Average training steps per second: 203.05
I0905 16:32:08.761735 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.59
INFO:tensorflow:Starting iteration 28

Steps executed: 286 Episode length: 128 Return: -651.2660979352898447
INFO:tensorflow:Average training steps per second: 189.17
I0905 16:32:18.655797 139803301922816 replay_runner.py:36] Average training steps per second: 189.17
I0905 16:32:18.981551 139803301922816 run_experiment.py:428] Average undiscounted return per evaluation episode: -557.81
INFO:tensorflow:Starting iteration 29
I0905 16:32:24.081020 139803301922816 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 176.69
I0905 16:32:29.741312 139803301922816 replay_runner.py:36] Average training steps per second: 176.69


Done fixed training!Episode length: 185 Return: -444.0748266115965647