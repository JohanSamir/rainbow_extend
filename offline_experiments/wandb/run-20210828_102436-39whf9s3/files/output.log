Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0828 10:24:43.356181 140088388143104 run_experiment.py:549] Creating TrainRunner ...
I0828 10:24:43.363330 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:43.363529 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:43.363595 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:43.363658 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:43.363714 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:43.363770 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:43.363822 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:43.363874 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:43.363925 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:43.363976 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:43.364026 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:43.364077 140088388143104 dqn_agent.py:283] 	 seed: 1630146283363272
I0828 10:24:43.366912 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:43.367059 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:24:43.367171 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:43.367240 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:43.367302 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:43.367357 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:43.367415 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:43.367466 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:43.367517 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:43.398303 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:43.807889 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:43.827888 140088388143104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:24:43.838539 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:43.838814 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:43.838944 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:43.839076 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:43.839533 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:43.839808 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:43.840071 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:43.840321 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:43.840642 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:43.840914 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:43.842243 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:43.842439 140088388143104 dqn_agent.py:283] 	 seed: 1630146283838477
I0828 10:24:43.857039 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:43.857244 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:24:43.857366 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:43.857473 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:43.857572 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:43.857666 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:43.857760 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:43.858186 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:43.858350 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:43.928163 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:43.949342 140088388143104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:24:43.949855 140088388143104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.39
I0828 10:24:50.644102 140088388143104 replay_runner.py:36] Average training steps per second: 149.39
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:24:51.992331 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:24:52.216734 140088388143104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.18
I0828 10:24:57.288589 140088388143104 replay_runner.py:36] Average training steps per second: 197.18
I0828 10:24:57.706436 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:24:57.953912 140088388143104 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 199.93
I0828 10:25:02.956067 140088388143104 replay_runner.py:36] Average training steps per second: 199.93
I0828 10:25:03.368577 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0828 10:25:03.610616 140088388143104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 195.37
I0828 10:25:08.729687 140088388143104 replay_runner.py:36] Average training steps per second: 195.37
I0828 10:25:09.132735 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0828 10:25:09.371812 140088388143104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 201.10
I0828 10:25:14.345125 140088388143104 replay_runner.py:36] Average training steps per second: 201.10
I0828 10:25:14.778087 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0828 10:25:15.031599 140088388143104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 200.02
I0828 10:25:20.031615 140088388143104 replay_runner.py:36] Average training steps per second: 200.02
I0828 10:25:20.446365 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 332 Episode length: 332 Return: -331.0
INFO:tensorflow:Average training steps per second: 195.53
I0828 10:25:25.805130 140088388143104 replay_runner.py:36] Average training steps per second: 195.53
I0828 10:25:26.076803 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.00
INFO:tensorflow:Starting iteration 7

Steps executed: 294 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 198.78
I0828 10:25:31.334636 140088388143104 replay_runner.py:36] Average training steps per second: 198.78
I0828 10:25:31.581163 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.00
INFO:tensorflow:Starting iteration 8

Steps executed: 168 Episode length: 168 Return: -167.0
INFO:tensorflow:Average training steps per second: 194.30
I0828 10:25:36.967189 140088388143104 replay_runner.py:36] Average training steps per second: 194.30

Steps executed: 377 Episode length: 209 Return: -208.0
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.65
I0828 10:25:42.560491 140088388143104 replay_runner.py:36] Average training steps per second: 197.65
I0828 10:25:42.976099 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 312 Episode length: 312 Return: -311.0
INFO:tensorflow:Average training steps per second: 200.48
I0828 10:25:48.214181 140088388143104 replay_runner.py:36] Average training steps per second: 200.48
I0828 10:25:48.476690 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 11

Steps executed: 348 Episode length: 348 Return: -347.0
INFO:tensorflow:Average training steps per second: 199.44
I0828 10:25:53.742715 140088388143104 replay_runner.py:36] Average training steps per second: 199.44
I0828 10:25:54.056158 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.00
INFO:tensorflow:Starting iteration 12
I0828 10:25:54.309046 140088388143104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 198.26

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:25:59.779371 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:26:00.025908 140088388143104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 199.35
I0828 10:26:05.042797 140088388143104 replay_runner.py:36] Average training steps per second: 199.35
I0828 10:26:05.455668 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:26:05.701660 140088388143104 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.41
I0828 10:26:10.716997 140088388143104 replay_runner.py:36] Average training steps per second: 199.41
I0828 10:26:11.130735 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:26:11.371503 140088388143104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 200.56
I0828 10:26:16.357874 140088388143104 replay_runner.py:36] Average training steps per second: 200.56
I0828 10:26:16.775576 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:26:17.015115 140088388143104 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.78
I0828 10:26:22.071798 140088388143104 replay_runner.py:36] Average training steps per second: 197.78
I0828 10:26:22.474485 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:26:22.710243 140088388143104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.72
I0828 10:26:27.717866 140088388143104 replay_runner.py:36] Average training steps per second: 199.72
I0828 10:26:28.132545 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:26:28.365428 140088388143104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 196.16
I0828 10:26:33.463836 140088388143104 replay_runner.py:36] Average training steps per second: 196.16
I0828 10:26:33.874488 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:26:34.103079 140088388143104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 197.58
I0828 10:26:39.164656 140088388143104 replay_runner.py:36] Average training steps per second: 197.58
I0828 10:26:39.578874 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:26:39.823498 140088388143104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 199.17
I0828 10:26:44.844806 140088388143104 replay_runner.py:36] Average training steps per second: 199.17
I0828 10:26:45.248313 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:26:45.491216 140088388143104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.46
I0828 10:26:50.581708 140088388143104 replay_runner.py:36] Average training steps per second: 196.46
I0828 10:26:50.992865 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:26:51.230025 140088388143104 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 199.25
I0828 10:26:56.249347 140088388143104 replay_runner.py:36] Average training steps per second: 199.25
I0828 10:26:56.671870 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:26:56.922765 140088388143104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 205.55
I0828 10:27:01.788091 140088388143104 replay_runner.py:36] Average training steps per second: 205.55
I0828 10:27:02.192606 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:27:02.431348 140088388143104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 199.44
I0828 10:27:07.445814 140088388143104 replay_runner.py:36] Average training steps per second: 199.44
I0828 10:27:07.868421 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:27:08.110712 140088388143104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 206.67
I0828 10:27:12.949575 140088388143104 replay_runner.py:36] Average training steps per second: 206.67
I0828 10:27:13.345201 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:27:13.587124 140088388143104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.80
I0828 10:27:18.643039 140088388143104 replay_runner.py:36] Average training steps per second: 197.80
I0828 10:27:19.021280 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:27:19.241872 140088388143104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 215.15
I0828 10:27:23.890432 140088388143104 replay_runner.py:36] Average training steps per second: 215.15
I0828 10:27:24.303501 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:27:24.575965 140088388143104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 212.75
I0828 10:27:29.276760 140088388143104 replay_runner.py:36] Average training steps per second: 212.75
I0828 10:27:29.608246 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 206.23
I0828 10:27:34.672278 140088388143104 replay_runner.py:36] Average training steps per second: 206.23
I0828 10:27:35.066703 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00