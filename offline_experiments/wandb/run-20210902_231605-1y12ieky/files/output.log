Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 23:16:12.474482 140561847887872 run_experiment.py:549] Creating TrainRunner ...
I0902 23:16:12.484788 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:16:12.485055 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:16:12.485197 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:16:12.485319 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:16:12.485457 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:16:12.485571 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:16:12.485690 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:16:12.485856 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:16:12.486021 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:16:12.486342 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:16:12.486519 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:16:12.486650 140561847887872 dqn_agent.py:283] 	 seed: 1630624572484723
I0902 23:16:12.490060 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:16:12.490309 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:16:12.490515 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:16:12.490649 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:16:12.490762 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:16:12.490873 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:16:12.490983 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:16:12.491108 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:16:12.491251 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:16:12.527435 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:16:12.949763 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:16:12.980402 140561847887872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:16:12.988093 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:16:12.988433 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:16:12.988546 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:16:12.988658 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:16:12.988750 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:16:12.988833 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:16:12.988922 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:16:12.989000 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:16:12.989079 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:16:12.989163 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:16:12.989237 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:16:12.989326 140561847887872 dqn_agent.py:283] 	 seed: 1630624572988041
I0902 23:16:12.991404 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:16:12.991552 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:16:12.991648 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:16:12.991734 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:16:12.991815 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:16:12.991894 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:16:12.991999 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:16:12.992111 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:16:12.992212 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:16:13.018137 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:16:13.037488 140561847887872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:16:13.037736 140561847887872 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.43
I0902 23:16:19.914397 140561847887872 replay_runner.py:36] Average training steps per second: 145.43
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:16:21.439584 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:16:21.685422 140561847887872 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 192.36
I0902 23:16:26.884487 140561847887872 replay_runner.py:36] Average training steps per second: 192.36
I0902 23:16:27.290997 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 23:16:27.524022 140561847887872 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.04
I0902 23:16:32.704721 140561847887872 replay_runner.py:36] Average training steps per second: 193.04
I0902 23:16:33.132206 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:16:33.379886 140561847887872 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.05
I0902 23:16:38.481062 140561847887872 replay_runner.py:36] Average training steps per second: 196.05
I0902 23:16:38.914142 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 23:16:39.165749 140561847887872 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 189.08
I0902 23:16:44.455405 140561847887872 replay_runner.py:36] Average training steps per second: 189.08
I0902 23:16:44.879475 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:16:45.117884 140561847887872 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 191.71
I0902 23:16:50.334400 140561847887872 replay_runner.py:36] Average training steps per second: 191.71
I0902 23:16:50.768449 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 23:16:51.010568 140561847887872 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.56
I0902 23:16:56.177189 140561847887872 replay_runner.py:36] Average training steps per second: 193.56
I0902 23:16:56.600965 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 23:16:56.845887 140561847887872 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.25
I0902 23:17:02.102932 140561847887872 replay_runner.py:36] Average training steps per second: 190.25
I0902 23:17:02.515465 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:17:02.768207 140561847887872 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.15
I0902 23:17:08.000406 140561847887872 replay_runner.py:36] Average training steps per second: 191.15
I0902 23:17:08.426013 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 23:17:08.678751 140561847887872 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.32
I0902 23:17:13.852095 140561847887872 replay_runner.py:36] Average training steps per second: 193.32
I0902 23:17:14.263776 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 23:17:14.510668 140561847887872 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 189.18
I0902 23:17:19.797096 140561847887872 replay_runner.py:36] Average training steps per second: 189.18
I0902 23:17:20.243953 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 23:17:20.469537 140561847887872 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 191.34
I0902 23:17:25.696335 140561847887872 replay_runner.py:36] Average training steps per second: 191.34
I0902 23:17:26.135530 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 23:17:26.384103 140561847887872 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 193.68
I0902 23:17:31.547598 140561847887872 replay_runner.py:36] Average training steps per second: 193.68
I0902 23:17:31.966555 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 23:17:32.211966 140561847887872 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.58
I0902 23:17:37.325600 140561847887872 replay_runner.py:36] Average training steps per second: 195.58
I0902 23:17:37.766381 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 23:17:38.009995 140561847887872 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 196.92
I0902 23:17:43.088491 140561847887872 replay_runner.py:36] Average training steps per second: 196.92
I0902 23:17:43.511884 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 23:17:43.760077 140561847887872 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.03
I0902 23:17:49.051172 140561847887872 replay_runner.py:36] Average training steps per second: 189.03
I0902 23:17:49.463517 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0902 23:17:49.703140 140561847887872 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.89
I0902 23:17:54.887873 140561847887872 replay_runner.py:36] Average training steps per second: 192.89
I0902 23:17:55.317073 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0902 23:17:55.573209 140561847887872 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 194.49
I0902 23:18:00.715378 140561847887872 replay_runner.py:36] Average training steps per second: 194.49
I0902 23:18:01.146181 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0902 23:18:01.390098 140561847887872 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.97
I0902 23:18:06.545885 140561847887872 replay_runner.py:36] Average training steps per second: 193.97
I0902 23:18:06.970946 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 23:18:07.212924 140561847887872 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.48
I0902 23:18:12.436001 140561847887872 replay_runner.py:36] Average training steps per second: 191.48
I0902 23:18:12.877076 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0902 23:18:13.125642 140561847887872 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 187.01
I0902 23:18:18.473491 140561847887872 replay_runner.py:36] Average training steps per second: 187.01
I0902 23:18:18.911791 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0902 23:18:19.162300 140561847887872 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.67
I0902 23:18:24.353274 140561847887872 replay_runner.py:36] Average training steps per second: 192.67
I0902 23:18:24.781032 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 23:18:25.031523 140561847887872 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.76
I0902 23:18:30.246973 140561847887872 replay_runner.py:36] Average training steps per second: 191.76
I0902 23:18:30.691665 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 23:18:30.942658 140561847887872 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.56
I0902 23:18:36.163545 140561847887872 replay_runner.py:36] Average training steps per second: 191.56
I0902 23:18:36.591771 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 23:18:36.839057 140561847887872 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.93
I0902 23:18:41.891774 140561847887872 replay_runner.py:36] Average training steps per second: 197.93
I0902 23:18:42.288173 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 23:18:42.531173 140561847887872 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 202.94
I0902 23:18:47.459055 140561847887872 replay_runner.py:36] Average training steps per second: 202.94
I0902 23:18:47.836118 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 23:18:48.068033 140561847887872 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 202.74
I0902 23:18:53.001138 140561847887872 replay_runner.py:36] Average training steps per second: 202.74
I0902 23:18:53.376272 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 23:18:53.601035 140561847887872 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 201.74
I0902 23:18:58.558274 140561847887872 replay_runner.py:36] Average training steps per second: 201.74
I0902 23:18:58.927130 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0902 23:18:59.158681 140561847887872 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 208.45
I0902 23:19:03.956553 140561847887872 replay_runner.py:36] Average training steps per second: 208.45
I0902 23:19:04.333268 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 208.11
I0902 23:19:09.373426 140561847887872 replay_runner.py:36] Average training steps per second: 208.11
I0902 23:19:09.720205 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00