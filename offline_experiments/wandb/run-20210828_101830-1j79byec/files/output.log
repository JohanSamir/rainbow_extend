I0828 10:18:36.945426 139857739204608 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0828 10:18:36.945954 139857739204608 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0828 10:18:37.006374 139857739204608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:37.007448 139857739204608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:37.007522 139857739204608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:37.007605 139857739204608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:37.007666 139857739204608 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:37.007720 139857739204608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:37.007814 139857739204608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:37.007935 139857739204608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:37.008020 139857739204608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:37.008085 139857739204608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:37.008153 139857739204608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:37.008229 139857739204608 dqn_agent.py:283] 	 seed: 1630145917006316
I0828 10:18:37.010008 139857739204608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:37.010202 139857739204608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:37.010291 139857739204608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:37.010360 139857739204608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:37.010425 139857739204608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:37.010484 139857739204608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:37.010542 139857739204608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:37.010595 139857739204608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:37.010668 139857739204608 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0828 10:18:38.437041 139857739204608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.886924 139857739204608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.895040 139857739204608 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:18:38.899314 139857739204608 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:18:38.899449 139857739204608 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:18:38.899560 139857739204608 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:18:38.899647 139857739204608 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:18:38.899726 139857739204608 dqn_agent.py:275] 	 update_period: 4
I0828 10:18:38.899809 139857739204608 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:18:38.899891 139857739204608 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:18:38.899974 139857739204608 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:18:38.900055 139857739204608 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:18:38.900142 139857739204608 dqn_agent.py:280] 	 optimizer: adam
I0828 10:18:38.900223 139857739204608 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:18:38.900304 139857739204608 dqn_agent.py:283] 	 seed: 1630145918899286
I0828 10:18:38.902054 139857739204608 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:18:38.902191 139857739204608 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:18:38.902292 139857739204608 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:18:38.902373 139857739204608 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:18:38.902452 139857739204608 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:18:38.902534 139857739204608 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:18:38.902616 139857739204608 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:18:38.902697 139857739204608 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:18:38.902777 139857739204608 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:18:38.944174 139857739204608 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:18:38.958321 139857739204608 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:18:38.958614 139857739204608 replay_runner.py:41] Starting iteration 0
Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 155.69
I0828 10:18:45.382130 139857739204608 replay_runner.py:36] Average training steps per second: 155.69
I0828 10:18:46.139306 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 14 Return: 14.0
INFO:tensorflow:Average training steps per second: 194.86
I0828 10:18:51.423777 139857739204608 replay_runner.py:36] Average training steps per second: 194.86
I0828 10:18:51.579344 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.62
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 19 Return: 19.0
INFO:tensorflow:Average training steps per second: 192.90
I0828 10:18:56.950026 139857739204608 replay_runner.py:36] Average training steps per second: 192.90
I0828 10:18:57.078376 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.40
INFO:tensorflow:Starting iteration 3

Steps executed: 193 Episode length: 12 Return: 12.0
INFO:tensorflow:Average training steps per second: 190.01

Steps executed: 206 Episode length: 13 Return: 13.0
I0828 10:19:02.691600 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.44
INFO:tensorflow:Starting iteration 4

Steps executed: 205 Episode length: 20 Return: 20.0
INFO:tensorflow:Average training steps per second: 201.93
I0828 10:19:07.849395 139857739204608 replay_runner.py:36] Average training steps per second: 201.93
I0828 10:19:07.989533 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.50
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.33
I0828 10:19:13.522854 139857739204608 replay_runner.py:36] Average training steps per second: 187.33
I0828 10:19:13.653783 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 363 Episode length: 186 Return: 186.0
INFO:tensorflow:Average training steps per second: 200.45
I0828 10:19:18.829068 139857739204608 replay_runner.py:36] Average training steps per second: 200.45
I0828 10:19:19.089533 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.72
I0828 10:19:24.157242 139857739204608 replay_runner.py:36] Average training steps per second: 205.72
I0828 10:19:24.282450 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 241 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 195.17
I0828 10:19:29.591205 139857739204608 replay_runner.py:36] Average training steps per second: 195.17
I0828 10:19:29.764206 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.71
I0828 10:19:34.809628 139857739204608 replay_runner.py:36] Average training steps per second: 205.71
I0828 10:19:34.938432 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0828 10:19:35.125178 139857739204608 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 187.88
I0828 10:19:40.448229 139857739204608 replay_runner.py:36] Average training steps per second: 187.88
I0828 10:19:40.578507 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11
I0828 10:19:40.764938 139857739204608 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 202.27
I0828 10:19:45.709376 139857739204608 replay_runner.py:36] Average training steps per second: 202.27
I0828 10:19:45.855430 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12
I0828 10:19:46.061431 139857739204608 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.31
I0828 10:19:51.182342 139857739204608 replay_runner.py:36] Average training steps per second: 195.31
I0828 10:19:51.314733 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 339 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 196.31
I0828 10:19:56.595992 139857739204608 replay_runner.py:36] Average training steps per second: 196.31
I0828 10:19:56.835565 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 14

Steps executed: 216 Episode length: 20 Return: 20.0.0
INFO:tensorflow:Average training steps per second: 205.28
I0828 10:20:01.914770 139857739204608 replay_runner.py:36] Average training steps per second: 205.28
I0828 10:20:02.060537 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.62
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.71
I0828 10:20:07.536948 139857739204608 replay_runner.py:36] Average training steps per second: 188.71
I0828 10:20:07.678205 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0828 10:20:07.872565 139857739204608 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 202.89
I0828 10:20:12.801834 139857739204608 replay_runner.py:36] Average training steps per second: 202.89
I0828 10:20:12.955162 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0828 10:20:13.163036 139857739204608 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.51
I0828 10:20:18.278528 139857739204608 replay_runner.py:36] Average training steps per second: 195.51
I0828 10:20:18.398845 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0828 10:20:18.580276 139857739204608 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.49
I0828 10:20:23.618788 139857739204608 replay_runner.py:36] Average training steps per second: 198.49
I0828 10:20:23.763113 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0828 10:20:23.965481 139857739204608 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 200.96
I0828 10:20:28.942150 139857739204608 replay_runner.py:36] Average training steps per second: 200.96
I0828 10:20:29.068846 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0828 10:20:29.253538 139857739204608 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.52
I0828 10:20:34.530553 139857739204608 replay_runner.py:36] Average training steps per second: 189.52
I0828 10:20:34.660378 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0828 10:20:34.851933 139857739204608 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 204.58
I0828 10:20:39.740675 139857739204608 replay_runner.py:36] Average training steps per second: 204.58
I0828 10:20:39.888809 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0828 10:20:40.087064 139857739204608 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.44
I0828 10:20:45.178351 139857739204608 replay_runner.py:36] Average training steps per second: 196.44
I0828 10:20:45.304300 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0828 10:20:45.492581 139857739204608 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 199.77
I0828 10:20:50.498688 139857739204608 replay_runner.py:36] Average training steps per second: 199.77
I0828 10:20:50.643565 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0828 10:20:50.848531 139857739204608 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 203.38
I0828 10:20:55.766044 139857739204608 replay_runner.py:36] Average training steps per second: 203.38
I0828 10:20:55.903814 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0828 10:20:56.095399 139857739204608 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.46
I0828 10:21:01.264791 139857739204608 replay_runner.py:36] Average training steps per second: 193.46
I0828 10:21:01.403279 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0828 10:21:01.593766 139857739204608 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 204.45
I0828 10:21:06.485517 139857739204608 replay_runner.py:36] Average training steps per second: 204.45
I0828 10:21:06.627985 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0828 10:21:06.826818 139857739204608 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.05
I0828 10:21:12.088944 139857739204608 replay_runner.py:36] Average training steps per second: 190.05
I0828 10:21:12.222729 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0828 10:21:12.413750 139857739204608 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.81
I0828 10:21:17.521346 139857739204608 replay_runner.py:36] Average training steps per second: 195.81
I0828 10:21:17.670813 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.44
I0828 10:21:22.834774 139857739204608 replay_runner.py:36] Average training steps per second: 201.44
I0828 10:21:22.961411 139857739204608 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00