I0910 11:03:08.839080 139727337109504 run_experiment.py:549] Creating TrainRunner ...
I0910 11:03:08.847309 139727337109504 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:03:08.847467 139727337109504 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:03:08.847549 139727337109504 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:03:08.847618 139727337109504 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:03:08.847680 139727337109504 dqn_agent.py:275] 	 update_period: 4
I0910 11:03:08.847769 139727337109504 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:03:08.847858 139727337109504 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:03:08.847960 139727337109504 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:03:08.848050 139727337109504 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:03:08.848123 139727337109504 dqn_agent.py:280] 	 optimizer: adam
I0910 11:03:08.848203 139727337109504 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:03:08.848286 139727337109504 dqn_agent.py:283] 	 seed: 1631271788847260
I0910 11:03:08.850081 139727337109504 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:03:08.850208 139727337109504 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:03:08.850304 139727337109504 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:03:08.850385 139727337109504 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:03:08.850463 139727337109504 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:03:08.850554 139727337109504 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:03:08.850652 139727337109504 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:03:08.850733 139727337109504 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:03:08.850814 139727337109504 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:03:08.876568 139727337109504 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:03:08.897422 139727337109504 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:03:08.897589 139727337109504 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:03:08.897703 139727337109504 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:03:08.897779 139727337109504 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:03:08.897842 139727337109504 dqn_agent.py:275] 	 update_period: 4
I0910 11:03:08.897902 139727337109504 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:03:08.898013 139727337109504 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:03:08.898077 139727337109504 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:03:08.898154 139727337109504 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:03:08.898234 139727337109504 dqn_agent.py:280] 	 optimizer: adam
I0910 11:03:08.898320 139727337109504 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:03:08.898408 139727337109504 dqn_agent.py:283] 	 seed: 1631271788897384
I0910 11:03:08.899940 139727337109504 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:03:08.900070 139727337109504 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:03:08.900140 139727337109504 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:03:08.900219 139727337109504 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:03:08.900283 139727337109504 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:03:08.900360 139727337109504 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:03:08.900418 139727337109504 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:03:08.900521 139727337109504 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:03:08.900583 139727337109504 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:03:08.921386 139727337109504 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:03:08.938096 139727337109504 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:03:08.938289 139727337109504 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 740781.35
I0910 11:03:08.939779 139727337109504 replay_runner.py:39] Average training steps per second: 740781.35
I0910 11:03:09.818401 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:03:09.909587 139727337109504 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 780190.48
I0910 11:03:09.911126 139727337109504 replay_runner.py:39] Average training steps per second: 780190.48
I0910 11:03:10.006076 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.00
INFO:tensorflow:Starting iteration 2
I0910 11:03:10.091615 139727337109504 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 559762.98
I0910 11:03:10.093765 139727337109504 replay_runner.py:39] Average training steps per second: 559762.98
I0910 11:03:10.258623 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:03:10.323095 139727337109504 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 847334.14
I0910 11:03:10.324514 139727337109504 replay_runner.py:39] Average training steps per second: 847334.14
Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:03:10.422564 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.00
INFO:tensorflow:Starting iteration 4
I0910 11:03:10.488987 139727337109504 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 826789.67
I0910 11:03:10.490461 139727337109504 replay_runner.py:39] Average training steps per second: 826789.67
I0910 11:03:10.575974 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.00
INFO:tensorflow:Starting iteration 5
I0910 11:03:10.642638 139727337109504 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 832038.09
I0910 11:03:10.644098 139727337109504 replay_runner.py:39] Average training steps per second: 832038.09
I0910 11:03:10.811547 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:03:10.895281 139727337109504 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 806596.92
I0910 11:03:10.896788 139727337109504 replay_runner.py:39] Average training steps per second: 806596.92
I0910 11:03:10.998106 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.00
INFO:tensorflow:Starting iteration 7
I0910 11:03:11.063268 139727337109504 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 864626.67
I0910 11:03:11.064641 139727337109504 replay_runner.py:39] Average training steps per second: 864626.67
I0910 11:03:11.231585 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:03:11.299182 139727337109504 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 839868.64
I0910 11:03:11.300623 139727337109504 replay_runner.py:39] Average training steps per second: 839868.64
I0910 11:03:11.393286 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.00
INFO:tensorflow:Starting iteration 9
I0910 11:03:11.460909 139727337109504 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 829077.68
I0910 11:03:11.462349 139727337109504 replay_runner.py:39] Average training steps per second: 829077.68
I0910 11:03:11.553732 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.00
INFO:tensorflow:Starting iteration 10
I0910 11:03:11.620807 139727337109504 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 659585.47
I0910 11:03:11.622573 139727337109504 replay_runner.py:39] Average training steps per second: 659585.47
I0910 11:03:11.709913 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.00
INFO:tensorflow:Starting iteration 11
I0910 11:03:11.777688 139727337109504 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 804739.83
I0910 11:03:11.779170 139727337109504 replay_runner.py:39] Average training steps per second: 804739.83
I0910 11:03:11.908467 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.00
INFO:tensorflow:Starting iteration 12
I0910 11:03:11.975805 139727337109504 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 791527.46
I0910 11:03:11.977320 139727337109504 replay_runner.py:39] Average training steps per second: 791527.46
I0910 11:03:12.068049 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 13
I0910 11:03:12.131535 139727337109504 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 898330.26
I0910 11:03:12.132874 139727337109504 replay_runner.py:39] Average training steps per second: 898330.26
I0910 11:03:12.224857 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.00
INFO:tensorflow:Starting iteration 14
I0910 11:03:12.291564 139727337109504 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 756957.95


Steps executed: 314 Episode length: 314 Return: -314.0
I0910 11:03:12.410231 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.00
INFO:tensorflow:Starting iteration 15
I0910 11:03:12.477668 139727337109504 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 786038.98
I0910 11:03:12.479197 139727337109504 replay_runner.py:39] Average training steps per second: 786038.98
I0910 11:03:12.566523 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 16
I0910 11:03:12.632584 139727337109504 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 824190.21
I0910 11:03:12.634009 139727337109504 replay_runner.py:39] Average training steps per second: 824190.21
I0910 11:03:12.717716 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.00
INFO:tensorflow:Starting iteration 17
I0910 11:03:12.783343 139727337109504 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 815219.44
I0910 11:03:12.784801 139727337109504 replay_runner.py:39] Average training steps per second: 815219.44
I0910 11:03:12.886250 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.00
INFO:tensorflow:Starting iteration 18
I0910 11:03:12.948290 139727337109504 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 809554.91
I0910 11:03:12.949809 139727337109504 replay_runner.py:39] Average training steps per second: 809554.91
I0910 11:03:13.037232 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 19
I0910 11:03:13.100525 139727337109504 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 966875.06
I0910 11:03:13.101764 139727337109504 replay_runner.py:39] Average training steps per second: 966875.06
I0910 11:03:13.187045 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.00
INFO:tensorflow:Starting iteration 20
I0910 11:03:13.250254 139727337109504 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 883755.58
I0910 11:03:13.251587 139727337109504 replay_runner.py:39] Average training steps per second: 883755.58
I0910 11:03:13.420999 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:03:13.485416 139727337109504 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 891456.75
I0910 11:03:13.486745 139727337109504 replay_runner.py:39] Average training steps per second: 891456.75
I0910 11:03:13.577202 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.00
INFO:tensorflow:Starting iteration 22
I0910 11:03:13.637361 139727337109504 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 802123.54
I0910 11:03:13.638824 139727337109504 replay_runner.py:39] Average training steps per second: 802123.54
I0910 11:03:13.722948 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.00
INFO:tensorflow:Starting iteration 23
I0910 11:03:13.786538 139727337109504 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 833526.23
I0910 11:03:13.787946 139727337109504 replay_runner.py:39] Average training steps per second: 833526.23
I0910 11:03:13.874758 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.00
INFO:tensorflow:Starting iteration 24
I0910 11:03:13.945242 139727337109504 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 893545.80
I0910 11:03:13.946613 139727337109504 replay_runner.py:39] Average training steps per second: 893545.80
I0910 11:03:14.066511 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.00
INFO:tensorflow:Starting iteration 25
I0910 11:03:14.128004 139727337109504 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 783689.09
I0910 11:03:14.129528 139727337109504 replay_runner.py:39] Average training steps per second: 783689.09
I0910 11:03:14.211464 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.00
INFO:tensorflow:Starting iteration 26
I0910 11:03:14.275246 139727337109504 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 889566.07
I0910 11:03:14.276596 139727337109504 replay_runner.py:39] Average training steps per second: 889566.07

Done fixed training!Episode length: 322 Return: -322.0
INFO:tensorflow:Starting iteration 27
I0910 11:03:14.429725 139727337109504 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 954987.25
I0910 11:03:14.431018 139727337109504 replay_runner.py:39] Average training steps per second: 954987.25
I0910 11:03:14.602545 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:03:14.675422 139727337109504 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 801816.86
I0910 11:03:14.676916 139727337109504 replay_runner.py:39] Average training steps per second: 801816.86
I0910 11:03:14.802274 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.00
INFO:tensorflow:Starting iteration 29
I0910 11:03:14.936449 139727337109504 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 153104.73
I0910 11:03:14.943928 139727337109504 replay_runner.py:39] Average training steps per second: 153104.73
I0910 11:03:15.057359 139727337109504 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.00