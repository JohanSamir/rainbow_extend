I0910 10:58:28.437585 140174634145792 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 10:58:28.438132 140174634145792 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 10:58:28.491586 140174634145792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:28.492665 140174634145792 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:28.492738 140174634145792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:28.492802 140174634145792 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:28.492911 140174634145792 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:28.492969 140174634145792 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:28.493132 140174634145792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:28.493248 140174634145792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:28.493338 140174634145792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:28.493390 140174634145792 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:28.493498 140174634145792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:28.493564 140174634145792 dqn_agent.py:283] 	 seed: 1631271508491531
I0910 10:58:28.495241 140174634145792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:28.495379 140174634145792 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:28.495438 140174634145792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:28.495496 140174634145792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:28.495550 140174634145792 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:28.495601 140174634145792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:28.495652 140174634145792 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:28.495700 140174634145792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:28.495748 140174634145792 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 10, please be patient, may be a while...
I0910 10:58:31.237216 140174634145792 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:31.319104 140174634145792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:31.319280 140174634145792 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:31.319355 140174634145792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:31.319416 140174634145792 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:31.319493 140174634145792 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:31.319579 140174634145792 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:31.319634 140174634145792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:31.319696 140174634145792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:31.319771 140174634145792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:31.319834 140174634145792 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:31.319916 140174634145792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:31.319982 140174634145792 dqn_agent.py:283] 	 seed: 1631271511319059
I0910 10:58:31.321540 140174634145792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:31.321664 140174634145792 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:31.321734 140174634145792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:31.321806 140174634145792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:31.321870 140174634145792 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:31.321928 140174634145792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:31.321999 140174634145792 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:31.322077 140174634145792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:31.322167 140174634145792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:58:31.341670 140174634145792 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:31.353433 140174634145792 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 10:58:31.353681 140174634145792 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 428033.88
I0910 10:58:31.356407 140174634145792 replay_runner.py:39] Average training steps per second: 428033.88
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 10:58:32.473693 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 10:58:32.562106 140174634145792 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 807839.75
I0910 10:58:32.563608 140174634145792 replay_runner.py:39] Average training steps per second: 807839.75
I0910 10:58:32.795509 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 10:58:32.856310 140174634145792 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 319176.93
I0910 10:58:32.859825 140174634145792 replay_runner.py:39] Average training steps per second: 319176.93
I0910 10:58:33.313348 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 10:58:33.392557 140174634145792 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 356597.86
I0910 10:58:33.395854 140174634145792 replay_runner.py:39] Average training steps per second: 356597.86
I0910 10:58:33.686226 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 10:58:33.750166 140174634145792 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 622947.27
I0910 10:58:33.752033 140174634145792 replay_runner.py:39] Average training steps per second: 622947.27
I0910 10:58:33.939136 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 10:58:33.993399 140174634145792 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 813164.79
I0910 10:58:33.994865 140174634145792 replay_runner.py:39] Average training steps per second: 813164.79
I0910 10:58:34.236577 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 10:58:34.292331 140174634145792 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 760940.49
I0910 10:58:34.293906 140174634145792 replay_runner.py:39] Average training steps per second: 760940.49
I0910 10:58:34.523804 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 10:58:34.590111 140174634145792 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 748581.83
I0910 10:58:34.591688 140174634145792 replay_runner.py:39] Average training steps per second: 748581.83
I0910 10:58:34.765805 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 10:58:34.819744 140174634145792 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 791527.46
I0910 10:58:34.821244 140174634145792 replay_runner.py:39] Average training steps per second: 791527.46
I0910 10:58:35.011578 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 10:58:35.066301 140174634145792 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 786038.98
I0910 10:58:35.067834 140174634145792 replay_runner.py:39] Average training steps per second: 786038.98
I0910 10:58:35.277041 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 10:58:35.332725 140174634145792 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 736618.19
I0910 10:58:35.334347 140174634145792 replay_runner.py:39] Average training steps per second: 736618.19
I0910 10:58:35.526050 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 10:58:35.582102 140174634145792 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 730333.28
I0910 10:58:35.583750 140174634145792 replay_runner.py:39] Average training steps per second: 730333.28
I0910 10:58:35.777919 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 10:58:35.832886 140174634145792 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 791676.86
I0910 10:58:35.834382 140174634145792 replay_runner.py:39] Average training steps per second: 791676.86
I0910 10:58:36.019283 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 10:58:36.074882 140174634145792 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 805512.58
I0910 10:58:36.076381 140174634145792 replay_runner.py:39] Average training steps per second: 805512.58
I0910 10:58:36.292239 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 10:58:36.353489 140174634145792 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 792874.10
I0910 10:58:36.355089 140174634145792 replay_runner.py:39] Average training steps per second: 792874.10
I0910 10:58:36.590080 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 10:58:36.644544 140174634145792 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 793173.98
I0910 10:58:36.646054 140174634145792 replay_runner.py:39] Average training steps per second: 793173.98
I0910 10:58:36.868669 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 10:58:36.928637 140174634145792 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 753558.03
I0910 10:58:36.930214 140174634145792 replay_runner.py:39] Average training steps per second: 753558.03
I0910 10:58:37.125264 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 10:58:37.179220 140174634145792 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 771579.10
I0910 10:58:37.180777 140174634145792 replay_runner.py:39] Average training steps per second: 771579.10
I0910 10:58:37.385447 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 10:58:37.442832 140174634145792 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 715141.35
I0910 10:58:37.444557 140174634145792 replay_runner.py:39] Average training steps per second: 715141.35
I0910 10:58:37.625201 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 10:58:37.678682 140174634145792 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 798003.04
I0910 10:58:37.680156 140174634145792 replay_runner.py:39] Average training steps per second: 798003.04
I0910 10:58:37.881106 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 10:58:37.936557 140174634145792 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 792874.10
I0910 10:58:37.938074 140174634145792 replay_runner.py:39] Average training steps per second: 792874.10
I0910 10:58:38.152333 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 10:58:38.215318 140174634145792 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 596968.97
I0910 10:58:38.217267 140174634145792 replay_runner.py:39] Average training steps per second: 596968.97
I0910 10:58:38.391055 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 10:58:38.451206 140174634145792 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 773286.14
I0910 10:58:38.452820 140174634145792 replay_runner.py:39] Average training steps per second: 773286.14
I0910 10:58:38.683310 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 10:58:38.738168 140174634145792 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 785303.13
I0910 10:58:38.739674 140174634145792 replay_runner.py:39] Average training steps per second: 785303.13
I0910 10:58:38.926236 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 10:58:38.979930 140174634145792 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 781644.43
I0910 10:58:38.981408 140174634145792 replay_runner.py:39] Average training steps per second: 781644.43
I0910 10:58:39.170980 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 10:58:39.227424 140174634145792 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 732501.57
I0910 10:58:39.229044 140174634145792 replay_runner.py:39] Average training steps per second: 732501.57
I0910 10:58:39.444241 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 10:58:39.498141 140174634145792 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 784715.43
I0910 10:58:39.499627 140174634145792 replay_runner.py:39] Average training steps per second: 784715.43
I0910 10:58:39.685975 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 10:58:39.744009 140174634145792 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 673243.02
I0910 10:58:39.745765 140174634145792 replay_runner.py:39] Average training steps per second: 673243.02
I0910 10:58:39.925485 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 10:58:39.982200 140174634145792 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 730969.68

Done fixed training!Episode length: 600 Return: -600.0
I0910 10:58:40.164552 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 10:58:40.216893 140174634145792 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 784568.65
I0910 10:58:40.218385 140174634145792 replay_runner.py:39] Average training steps per second: 784568.65
I0910 10:58:40.384105 140174634145792 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00