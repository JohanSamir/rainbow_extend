Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:47:12.118512 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:47:12.129836 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:12.130125 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:12.130280 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:12.130494 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:12.130620 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:12.130739 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:12.130852 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:12.130973 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:12.131072 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:12.131180 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:12.131289 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:12.131407 140320049072128 dqn_agent.py:283] 	 seed: 1630500432129774
I0901 12:47:12.134435 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:12.134617 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:12.134819 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:12.134993 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:12.135118 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:12.135253 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:12.135429 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:12.135566 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:12.135698 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:12.289486 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:12.763708 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:12.777498 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:47:12.786504 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:12.786800 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:12.786962 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:12.787054 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:12.787180 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:12.787314 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:12.787418 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:12.787502 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:12.787574 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:12.787649 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:12.787751 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:12.787849 140320049072128 dqn_agent.py:283] 	 seed: 1630500432786457
I0901 12:47:12.790050 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:12.790293 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:12.790412 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:12.790525 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:12.790760 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:12.790919 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:12.791070 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:12.791165 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:12.791292 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:12.826838 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:12.851765 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:47:12.852075 140320049072128 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 143.86
I0901 12:47:19.804036 140320049072128 replay_runner.py:36] Average training steps per second: 143.86
I0901 12:47:21.289455 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:47:21.531315 140320049072128 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 202.54
I0901 12:47:26.469134 140320049072128 replay_runner.py:36] Average training steps per second: 202.54
I0901 12:47:26.953022 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:47:27.186810 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 199.42
I0901 12:47:32.201818 140320049072128 replay_runner.py:36] Average training steps per second: 199.42
I0901 12:47:32.593477 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:47:32.834182 140320049072128 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.58
I0901 12:47:37.820261 140320049072128 replay_runner.py:36] Average training steps per second: 200.58
I0901 12:47:38.279443 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:47:38.517866 140320049072128 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 198.72
I0901 12:47:43.550485 140320049072128 replay_runner.py:36] Average training steps per second: 198.72
I0901 12:47:43.940820 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:47:44.185875 140320049072128 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 195.34
I0901 12:47:49.305697 140320049072128 replay_runner.py:36] Average training steps per second: 195.34
I0901 12:47:49.730722 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 249 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 202.84
I0901 12:47:54.890570 140320049072128 replay_runner.py:36] Average training steps per second: 202.84
I0901 12:47:55.112017 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 7

Steps executed: 265 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 198.35
I0901 12:48:00.400860 140320049072128 replay_runner.py:36] Average training steps per second: 198.35
I0901 12:48:00.620504 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 8
I0901 12:48:00.864516 140320049072128 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.04

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:48:06.326462 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 210 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 197.57
I0901 12:48:11.631103 140320049072128 replay_runner.py:36] Average training steps per second: 197.57
I0901 12:48:11.810002 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 10

Steps executed: 280 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 195.10
I0901 12:48:17.185697 140320049072128 replay_runner.py:36] Average training steps per second: 195.10
I0901 12:48:17.437109 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.00
INFO:tensorflow:Starting iteration 11

Steps executed: 307 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 193.12
I0901 12:48:22.851161 140320049072128 replay_runner.py:36] Average training steps per second: 193.12
I0901 12:48:23.120189 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.33
INFO:tensorflow:Starting iteration 12

Steps executed: 216 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 196.58
I0901 12:48:28.437241 140320049072128 replay_runner.py:36] Average training steps per second: 196.58
I0901 12:48:28.623727 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 13

Steps executed: 256 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 196.83
I0901 12:48:33.954243 140320049072128 replay_runner.py:36] Average training steps per second: 196.83
I0901 12:48:34.166993 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 14

Steps executed: 253 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 191.26
I0901 12:48:39.638890 140320049072128 replay_runner.py:36] Average training steps per second: 191.26
I0901 12:48:39.852319 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.50
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.12
I0901 12:48:45.197610 140320049072128 replay_runner.py:36] Average training steps per second: 196.12
I0901 12:48:45.619711 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 246 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 201.31
I0901 12:48:50.825026 140320049072128 replay_runner.py:36] Average training steps per second: 201.31
I0901 12:48:51.031143 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 17

Steps executed: 247 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 200.45
I0901 12:48:56.261985 140320049072128 replay_runner.py:36] Average training steps per second: 200.45
I0901 12:48:56.479158 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 18

Steps executed: 306 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 200.25
I0901 12:49:01.726352 140320049072128 replay_runner.py:36] Average training steps per second: 200.25
I0901 12:49:01.979310 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 19

Steps executed: 296 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 194.73
I0901 12:49:07.365648 140320049072128 replay_runner.py:36] Average training steps per second: 194.73
I0901 12:49:07.605555 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.00
INFO:tensorflow:Starting iteration 20

Steps executed: 217 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 198.52
I0901 12:49:12.878988 140320049072128 replay_runner.py:36] Average training steps per second: 198.52
I0901 12:49:13.055835 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 21
I0901 12:49:13.295637 140320049072128 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 200.02

Steps executed: 256 Episode length: 94 Return: -93.0.0
I0901 12:49:18.489243 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 22

Steps executed: 240 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 207.93
I0901 12:49:23.521732 140320049072128 replay_runner.py:36] Average training steps per second: 207.93
I0901 12:49:23.728462 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 23

Steps executed: 238 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 209.11
I0901 12:49:28.738672 140320049072128 replay_runner.py:36] Average training steps per second: 209.11
I0901 12:49:28.928930 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 208.36
I0901 12:49:33.971682 140320049072128 replay_runner.py:36] Average training steps per second: 208.36
I0901 12:49:34.134688 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 25

Steps executed: 272 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 203.13
I0901 12:49:39.291038 140320049072128 replay_runner.py:36] Average training steps per second: 203.13
I0901 12:49:39.524723 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 26

Steps executed: 279 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 189.43
I0901 12:49:45.054973 140320049072128 replay_runner.py:36] Average training steps per second: 189.43
I0901 12:49:45.277860 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 27
I0901 12:49:45.508776 140320049072128 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 199.42
I0901 12:49:50.523640 140320049072128 replay_runner.py:36] Average training steps per second: 199.42

Steps executed: 291 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Starting iteration 28

Steps executed: 221 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 204.14
I0901 12:49:55.904413 140320049072128 replay_runner.py:36] Average training steps per second: 204.14
I0901 12:49:56.083679 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 29
I0901 12:49:56.319183 140320049072128 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 203.49
I0901 12:50:01.233955 140320049072128 replay_runner.py:36] Average training steps per second: 203.49

Done fixed training!Episode length: 81 Return: -80.0.0