I0910 11:23:37.237927 140647269918720 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 11:23:37.238440 140647269918720 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 11:23:37.289629 140647269918720 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:37.290696 140647269918720 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:37.290809 140647269918720 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:37.290873 140647269918720 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:37.290931 140647269918720 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:37.291000 140647269918720 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:37.291063 140647269918720 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:37.291116 140647269918720 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:37.291199 140647269918720 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:37.291318 140647269918720 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:37.291394 140647269918720 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:37.291463 140647269918720 dqn_agent.py:283] 	 seed: 1631273017289578
I0910 11:23:37.293053 140647269918720 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:37.293180 140647269918720 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:37.293275 140647269918720 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:37.293335 140647269918720 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:37.293389 140647269918720 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:37.293461 140647269918720 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:37.293527 140647269918720 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:37.293590 140647269918720 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:37.293652 140647269918720 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.519670 140647269918720 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.594566 140647269918720 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:38.594743 140647269918720 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:38.594815 140647269918720 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:38.594874 140647269918720 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:38.594927 140647269918720 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:38.594999 140647269918720 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:38.595089 140647269918720 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:38.595170 140647269918720 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:38.595243 140647269918720 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:38.595318 140647269918720 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:38.595383 140647269918720 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:38.595446 140647269918720 dqn_agent.py:283] 	 seed: 1631273018594519
I0910 11:23:38.597041 140647269918720 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:38.597161 140647269918720 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:38.597231 140647269918720 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:38.597301 140647269918720 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:38.597403 140647269918720 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:38.597467 140647269918720 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:38.597543 140647269918720 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:38.597628 140647269918720 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:38.597702 140647269918720 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.618872 140647269918720 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.631225 140647269918720 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:23:38.631387 140647269918720 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 781498.79
I0910 11:23:38.632774 140647269918720 replay_runner.py:39] Average training steps per second: 781498.79
Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
I0910 11:23:39.365650 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:23:39.422119 140647269918720 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 788254.84
I0910 11:23:39.423651 140647269918720 replay_runner.py:39] Average training steps per second: 788254.84
I0910 11:23:39.582615 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:23:39.635174 140647269918720 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 743802.80
I0910 11:23:39.636760 140647269918720 replay_runner.py:39] Average training steps per second: 743802.80
I0910 11:23:39.807175 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:23:39.859737 140647269918720 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 750591.27
I0910 11:23:39.861323 140647269918720 replay_runner.py:39] Average training steps per second: 750591.27
I0910 11:23:40.021798 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:23:40.073650 140647269918720 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 785891.70
I0910 11:23:40.075166 140647269918720 replay_runner.py:39] Average training steps per second: 785891.70
I0910 11:23:40.235426 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:23:40.291441 140647269918720 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 741567.19
I0910 11:23:40.293033 140647269918720 replay_runner.py:39] Average training steps per second: 741567.19
I0910 11:23:40.455629 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:23:40.507816 140647269918720 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 774285.40
I0910 11:23:40.509361 140647269918720 replay_runner.py:39] Average training steps per second: 774285.40
I0910 11:23:40.677894 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:23:40.733915 140647269918720 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 681225.27
I0910 11:23:40.735652 140647269918720 replay_runner.py:39] Average training steps per second: 681225.27
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:23:40.908641 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:23:40.961115 140647269918720 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 751128.94
I0910 11:23:40.962695 140647269918720 replay_runner.py:39] Average training steps per second: 751128.94
I0910 11:23:41.127270 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:23:41.179694 140647269918720 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 765663.38
I0910 11:23:41.181239 140647269918720 replay_runner.py:39] Average training steps per second: 765663.38
I0910 11:23:41.370737 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:23:41.423110 140647269918720 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 779465.53
I0910 11:23:41.424645 140647269918720 replay_runner.py:39] Average training steps per second: 779465.53
I0910 11:23:41.590859 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:23:41.642948 140647269918720 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 827605.37
I0910 11:23:41.644384 140647269918720 replay_runner.py:39] Average training steps per second: 827605.37
I0910 11:23:41.821072 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:23:41.872413 140647269918720 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 762739.41
I0910 11:23:41.873965 140647269918720 replay_runner.py:39] Average training steps per second: 762739.41
I0910 11:23:42.039418 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:23:42.091366 140647269918720 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 747914.41
I0910 11:23:42.092953 140647269918720 replay_runner.py:39] Average training steps per second: 747914.41
I0910 11:23:42.255413 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:23:42.311279 140647269918720 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 748448.25
I0910 11:23:42.312930 140647269918720 replay_runner.py:39] Average training steps per second: 748448.25
I0910 11:23:42.491189 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:23:42.545086 140647269918720 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 685792.02
I0910 11:23:42.546825 140647269918720 replay_runner.py:39] Average training steps per second: 685792.02
I0910 11:23:42.726420 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:23:42.779468 140647269918720 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 748581.83
I0910 11:23:42.781058 140647269918720 replay_runner.py:39] Average training steps per second: 748581.83
I0910 11:23:42.971527 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:23:43.026805 140647269918720 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 700334.61
I0910 11:23:43.028530 140647269918720 replay_runner.py:39] Average training steps per second: 700334.61
I0910 11:23:43.207217 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:23:43.266312 140647269918720 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 724404.84
I0910 11:23:43.267932 140647269918720 replay_runner.py:39] Average training steps per second: 724404.84
I0910 11:23:43.450681 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:23:43.504818 140647269918720 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 696959.79
I0910 11:23:43.506511 140647269918720 replay_runner.py:39] Average training steps per second: 696959.79
I0910 11:23:43.688835 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:23:43.742038 140647269918720 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 747647.77
I0910 11:23:43.743617 140647269918720 replay_runner.py:39] Average training steps per second: 747647.77
I0910 11:23:43.919888 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:23:43.970966 140647269918720 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 747248.17
I0910 11:23:43.972561 140647269918720 replay_runner.py:39] Average training steps per second: 747248.17
I0910 11:23:44.137682 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:23:44.187932 140647269918720 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 782957.63
I0910 11:23:44.189442 140647269918720 replay_runner.py:39] Average training steps per second: 782957.63
I0910 11:23:44.365744 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:23:44.421017 140647269918720 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 757504.79
I0910 11:23:44.422591 140647269918720 replay_runner.py:39] Average training steps per second: 757504.79
I0910 11:23:44.591108 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:23:44.643736 140647269918720 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 759424.95
I0910 11:23:44.645285 140647269918720 replay_runner.py:39] Average training steps per second: 759424.95
I0910 11:23:44.813712 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:23:44.866884 140647269918720 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 744066.70
I0910 11:23:44.868479 140647269918720 replay_runner.py:39] Average training steps per second: 744066.70
I0910 11:23:45.037529 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:23:45.090321 140647269918720 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 751128.94
I0910 11:23:45.091859 140647269918720 replay_runner.py:39] Average training steps per second: 751128.94
I0910 11:23:45.258705 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:23:45.329545 140647269918720 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 731607.19
I0910 11:23:45.331142 140647269918720 replay_runner.py:39] Average training steps per second: 731607.19
I0910 11:23:45.507628 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:23:45.561269 140647269918720 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 735971.92
I0910 11:23:45.562888 140647269918720 replay_runner.py:39] Average training steps per second: 735971.92
I0910 11:23:45.732488 140647269918720 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:23:45.786604 140647269918720 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 766222.87
I0910 11:23:45.788154 140647269918720 replay_runner.py:39] Average training steps per second: 766222.87

Done fixed training!Episode length: 600 Return: -600.0