Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 17:55:51.751389 139977662982144 run_experiment.py:549] Creating TrainRunner ...
I0902 17:55:51.764092 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:51.764277 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:51.764374 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:51.764437 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:51.764495 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:51.764573 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:51.764670 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:51.764810 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:51.764934 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:51.765041 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:51.765183 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:51.765416 139977662982144 dqn_agent.py:283] 	 seed: 1630605351764024
I0902 17:55:51.768809 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:51.768984 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:51.769115 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:51.769220 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:51.769356 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:51.769448 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:51.769534 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:51.769699 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:51.769793 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:51.815526 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:52.230137 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:52.267931 139977662982144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:55:52.278212 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:52.278452 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:52.278642 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:52.278781 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:52.278871 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:52.279056 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:52.279268 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:52.279382 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:52.279563 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:52.279832 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:52.279942 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:52.280040 139977662982144 dqn_agent.py:283] 	 seed: 1630605352278134
I0902 17:55:52.282353 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:52.282523 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:52.282668 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:52.282778 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:52.282985 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:52.283077 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:52.283168 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:52.283291 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:52.283404 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:52.316676 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:52.338580 139977662982144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:55:52.339023 139977662982144 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.85
I0902 17:55:58.368927 139977662982144 replay_runner.py:36] Average training steps per second: 165.85
I0902 17:55:59.979778 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.97
Steps executed: 272 Episode length: 97 Return: -554.927294123417842
INFO:tensorflow:Starting iteration 1
I0902 17:56:04.312806 139977662982144 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 240.65
I0902 17:56:08.468689 139977662982144 replay_runner.py:36] Average training steps per second: 240.65

Steps executed: 295 Episode length: 119 Return: -258.41681931353742
INFO:tensorflow:Starting iteration 2
I0902 17:56:13.146990 139977662982144 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 235.15
I0902 17:56:17.400172 139977662982144 replay_runner.py:36] Average training steps per second: 235.15

Steps executed: 290 Episode length: 104 Return: -551.77243221101082
INFO:tensorflow:Starting iteration 3
I0902 17:56:22.073540 139977662982144 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 224.77
I0902 17:56:26.523006 139977662982144 replay_runner.py:36] Average training steps per second: 224.77

Steps executed: 223 Episode length: 115 Return: -360.93126288433416
INFO:tensorflow:Starting iteration 4

Steps executed: 299 Episode length: 191 Return: -185.84138756043524
INFO:tensorflow:Average training steps per second: 221.97
I0902 17:56:35.605635 139977662982144 replay_runner.py:36] Average training steps per second: 221.97
I0902 17:56:35.876470 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.99
INFO:tensorflow:Starting iteration 5

Steps executed: 320 Episode length: 134 Return: -494.42427969538716
INFO:tensorflow:Average training steps per second: 232.07
I0902 17:56:44.472619 139977662982144 replay_runner.py:36] Average training steps per second: 232.07
I0902 17:56:44.723010 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.36
INFO:tensorflow:Starting iteration 6

Steps executed: 165 Episode length: 165 Return: -526.47164832427146
INFO:tensorflow:Average training steps per second: 222.53

Steps executed: 385 Episode length: 220 Return: -712.23742821282366
I0902 17:56:53.733233 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -619.35
INFO:tensorflow:Starting iteration 7

Steps executed: 229 Episode length: 128 Return: -443.80013355144723
INFO:tensorflow:Average training steps per second: 219.13
I0902 17:57:02.560590 139977662982144 replay_runner.py:36] Average training steps per second: 219.13
I0902 17:57:02.784538 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.49
INFO:tensorflow:Starting iteration 8
I0902 17:57:07.156967 139977662982144 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 214.60

Steps executed: 296 Episode length: 193 Return: -570.19607542159616
I0902 17:57:12.117369 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.35
INFO:tensorflow:Starting iteration 9

Steps executed: 214 Episode length: 94 Return: -427.707095987932616
INFO:tensorflow:Average training steps per second: 219.68
I0902 17:57:21.036260 139977662982144 replay_runner.py:36] Average training steps per second: 219.68
I0902 17:57:21.220339 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.89
INFO:tensorflow:Starting iteration 10

Steps executed: 239 Episode length: 133 Return: -624.55980035333134
INFO:tensorflow:Average training steps per second: 220.84
I0902 17:57:30.147187 139977662982144 replay_runner.py:36] Average training steps per second: 220.84
I0902 17:57:30.379829 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -549.23
INFO:tensorflow:Starting iteration 11

Steps executed: 285 Episode length: 186 Return: -391.41868489785664
INFO:tensorflow:Average training steps per second: 216.18
I0902 17:57:39.371638 139977662982144 replay_runner.py:36] Average training steps per second: 216.18
I0902 17:57:39.659309 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.46
INFO:tensorflow:Starting iteration 12

Steps executed: 238 Episode length: 104 Return: -473.77916893486184
INFO:tensorflow:Average training steps per second: 220.81
I0902 17:57:48.564596 139977662982144 replay_runner.py:36] Average training steps per second: 220.81
I0902 17:57:48.789783 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -528.12
INFO:tensorflow:Starting iteration 13

Steps executed: 268 Episode length: 185 Return: -764.79887084292684
INFO:tensorflow:Average training steps per second: 221.39
I0902 17:57:57.651367 139977662982144 replay_runner.py:36] Average training steps per second: 221.39
I0902 17:57:57.912422 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -585.43
INFO:tensorflow:Starting iteration 14

Steps executed: 287 Episode length: 104 Return: -684.17091499058764
INFO:tensorflow:Average training steps per second: 212.86
I0902 17:58:07.026205 139977662982144 replay_runner.py:36] Average training steps per second: 212.86
I0902 17:58:07.285397 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -603.87
INFO:tensorflow:Starting iteration 15

Steps executed: 251 Episode length: 81 Return: -365.374986677533624
INFO:tensorflow:Average training steps per second: 219.93
I0902 17:58:16.224696 139977662982144 replay_runner.py:36] Average training steps per second: 219.93
I0902 17:58:16.463104 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.78
INFO:tensorflow:Starting iteration 16

Steps executed: 120 Episode length: 120 Return: -227.72492432234274
INFO:tensorflow:Average training steps per second: 216.46
I0902 17:58:25.453066 139977662982144 replay_runner.py:36] Average training steps per second: 216.46

Steps executed: 264 Episode length: 144 Return: -235.63277854145634
INFO:tensorflow:Starting iteration 17

Steps executed: 389 Episode length: 196 Return: -180.97407351373235
INFO:tensorflow:Average training steps per second: 221.52
I0902 17:58:34.579372 139977662982144 replay_runner.py:36] Average training steps per second: 221.52
I0902 17:58:34.934443 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.36
INFO:tensorflow:Starting iteration 18

Steps executed: 387 Episode length: 223 Return: -339.26699605268835
INFO:tensorflow:Average training steps per second: 217.51
I0902 17:58:43.901682 139977662982144 replay_runner.py:36] Average training steps per second: 217.51
I0902 17:58:44.294086 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.04
INFO:tensorflow:Starting iteration 19

Steps executed: 211 Episode length: 211 Return: -470.82460396282755
INFO:tensorflow:Average training steps per second: 220.22
I0902 17:58:53.197293 139977662982144 replay_runner.py:36] Average training steps per second: 220.22
I0902 17:58:53.426679 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.82
INFO:tensorflow:Starting iteration 20

Steps executed: 287 Episode length: 112 Return: -658.73511285382655
INFO:tensorflow:Average training steps per second: 223.42
I0902 17:59:02.242651 139977662982144 replay_runner.py:36] Average training steps per second: 223.42
I0902 17:59:02.500751 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -552.40
INFO:tensorflow:Starting iteration 21

Steps executed: 145 Episode length: 145 Return: -597.16321080590525
INFO:tensorflow:Average training steps per second: 210.47
I0902 17:59:11.463471 139977662982144 replay_runner.py:36] Average training steps per second: 210.47

Steps executed: 413 Episode length: 268 Return: -24.193826835130315
INFO:tensorflow:Starting iteration 22

Steps executed: 247 Episode length: 103 Return: -697.87823582651175
INFO:tensorflow:Average training steps per second: 221.81
I0902 17:59:20.511842 139977662982144 replay_runner.py:36] Average training steps per second: 221.81
I0902 17:59:20.732605 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.54
INFO:tensorflow:Starting iteration 23

Steps executed: 301 Episode length: 102 Return: -598.67804861789755
INFO:tensorflow:Average training steps per second: 223.42
I0902 17:59:29.543953 139977662982144 replay_runner.py:36] Average training steps per second: 223.42
I0902 17:59:29.805624 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.43
INFO:tensorflow:Starting iteration 24

Steps executed: 329 Episode length: 154 Return: -229.27821043459514
INFO:tensorflow:Average training steps per second: 216.40
I0902 17:59:38.701560 139977662982144 replay_runner.py:36] Average training steps per second: 216.40
I0902 17:59:39.041783 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.32
INFO:tensorflow:Starting iteration 25

Steps executed: 324 Episode length: 129 Return: -237.80918368057266
INFO:tensorflow:Average training steps per second: 225.32
I0902 17:59:47.737389 139977662982144 replay_runner.py:36] Average training steps per second: 225.32
I0902 17:59:48.037996 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.25
INFO:tensorflow:Starting iteration 26

Steps executed: 268 Episode length: 131 Return: -226.41118904557536
INFO:tensorflow:Average training steps per second: 217.45
I0902 17:59:57.066668 139977662982144 replay_runner.py:36] Average training steps per second: 217.45
I0902 17:59:57.307892 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.12
INFO:tensorflow:Starting iteration 27

Steps executed: 95 Episode length: 95 Return: -667.7293713818017536
INFO:tensorflow:Average training steps per second: 218.27

Steps executed: 299 Episode length: 114 Return: -654.23445853121566
I0902 18:00:06.348051 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.81
INFO:tensorflow:Starting iteration 28

Steps executed: 256 Episode length: 137 Return: -392.49961810757975
INFO:tensorflow:Average training steps per second: 227.81
I0902 18:00:14.937513 139977662982144 replay_runner.py:36] Average training steps per second: 227.81
I0902 18:00:15.161036 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.75
INFO:tensorflow:Starting iteration 29

Steps executed: 262 Episode length: 158 Return: -50.156371394048955
INFO:tensorflow:Average training steps per second: 223.99
I0902 18:00:23.886450 139977662982144 replay_runner.py:36] Average training steps per second: 223.99

Done fixed training!Episode length: 158 Return: -50.156371394048955