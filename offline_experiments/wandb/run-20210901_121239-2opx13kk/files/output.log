Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:12:45.983889 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:12:46.002144 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:46.002424 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:46.002571 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:46.002697 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:46.002800 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:46.002886 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:46.002971 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:46.003064 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:46.003156 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:46.003244 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:46.003333 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:46.003824 140635665344512 dqn_agent.py:283] 	 seed: 1630498366002055
I0901 12:12:46.007075 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:46.007278 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:12:46.007446 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:46.007588 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:46.007786 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:46.007894 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:46.007997 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:46.008097 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:46.008195 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:46.060863 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:46.499954 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:46.517207 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:12:46.526536 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:46.526776 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:46.526922 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:46.527047 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:46.527191 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:46.527395 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:46.527509 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:46.527647 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:46.527769 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:46.527925 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:46.528088 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:46.528213 140635665344512 dqn_agent.py:283] 	 seed: 1630498366526481
I0901 12:12:46.531064 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:46.531297 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:12:46.531488 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:46.531689 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:46.531825 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:46.531970 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:46.532093 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:46.532216 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:46.532394 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:46.568698 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:46.591439 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:12:46.591748 140635665344512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.46
I0901 12:12:53.151429 140635665344512 replay_runner.py:36] Average training steps per second: 152.46
Steps executed: 207 Episode length: 10 Return: 10.0
I0901 12:12:54.174028 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 28 Return: 28.0
INFO:tensorflow:Average training steps per second: 198.63
I0901 12:12:59.391461 140635665344512 replay_runner.py:36] Average training steps per second: 198.63
I0901 12:12:59.530511 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 29.57
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.09
I0901 12:13:04.915698 140635665344512 replay_runner.py:36] Average training steps per second: 192.09
I0901 12:13:05.047620 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 334 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 190.34
I0901 12:13:10.487042 140635665344512 replay_runner.py:36] Average training steps per second: 190.34
I0901 12:13:10.727296 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.82
I0901 12:13:15.989703 140635665344512 replay_runner.py:36] Average training steps per second: 196.82
I0901 12:13:16.124741 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 12:13:16.314885 140635665344512 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.13
I0901 12:13:21.602715 140635665344512 replay_runner.py:36] Average training steps per second: 189.13
I0901 12:13:21.735404 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 353 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 198.07
I0901 12:13:26.976574 140635665344512 replay_runner.py:36] Average training steps per second: 198.07
I0901 12:13:27.214000 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 7

Steps executed: 344 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 195.80
I0901 12:13:32.522243 140635665344512 replay_runner.py:36] Average training steps per second: 195.80
I0901 12:13:32.742585 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 8

Steps executed: 314 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 187.68
I0901 12:13:38.254857 140635665344512 replay_runner.py:36] Average training steps per second: 187.68
I0901 12:13:38.482231 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 9
I0901 12:13:38.672908 140635665344512 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 199.09
I0901 12:13:43.696202 140635665344512 replay_runner.py:36] Average training steps per second: 199.09
I0901 12:13:43.924265 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 10


Steps executed: 282 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 193.99
I0901 12:13:49.272738 140635665344512 replay_runner.py:36] Average training steps per second: 193.99
I0901 12:13:49.451495 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 11

Steps executed: 275 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 191.27
I0901 12:13:54.854090 140635665344512 replay_runner.py:36] Average training steps per second: 191.27
I0901 12:13:55.056371 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 12

Steps executed: 348 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 198.57
I0901 12:14:00.285171 140635665344512 replay_runner.py:36] Average training steps per second: 198.57
I0901 12:14:00.511713 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 13
I0901 12:14:00.703186 140635665344512 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 192.84

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 12:14:06.040287 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0901 12:14:06.234019 140635665344512 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 198.20
I0901 12:14:11.279868 140635665344512 replay_runner.py:36] Average training steps per second: 198.20
I0901 12:14:11.425821 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 12:14:11.604041 140635665344512 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.80
I0901 12:14:16.872967 140635665344512 replay_runner.py:36] Average training steps per second: 189.80
I0901 12:14:17.006244 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 12:14:17.192792 140635665344512 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 209.21
I0901 12:14:21.972974 140635665344512 replay_runner.py:36] Average training steps per second: 209.21
I0901 12:14:22.102911 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 341 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 203.60
I0901 12:14:27.198441 140635665344512 replay_runner.py:36] Average training steps per second: 203.60
I0901 12:14:27.418724 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 18

Steps executed: 293 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 203.39
I0901 12:14:32.514567 140635665344512 replay_runner.py:36] Average training steps per second: 203.39
I0901 12:14:32.700314 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 19
I0901 12:14:32.878314 140635665344512 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 190.75

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 12:14:38.262275 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:14:38.451470 140635665344512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.53
I0901 12:14:43.592411 140635665344512 replay_runner.py:36] Average training steps per second: 194.53
I0901 12:14:43.717686 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 343 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 194.57
I0901 12:14:49.033293 140635665344512 replay_runner.py:36] Average training steps per second: 194.57
I0901 12:14:49.259946 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 22
I0901 12:14:49.450898 140635665344512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 204.64

Steps executed: 388 Episode length: 200 Return: 200.0
I0901 12:14:54.614245 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.88
I0901 12:14:59.940862 140635665344512 replay_runner.py:36] Average training steps per second: 194.88
I0901 12:15:00.075744 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 306 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 198.41
I0901 12:15:05.305641 140635665344512 replay_runner.py:36] Average training steps per second: 198.41
I0901 12:15:05.526712 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.89
I0901 12:15:10.854681 140635665344512 replay_runner.py:36] Average training steps per second: 194.89
I0901 12:15:10.987531 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 189 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 194.38
I0901 12:15:16.313213 140635665344512 replay_runner.py:36] Average training steps per second: 194.38

Steps executed: 364 Episode length: 175 Return: 175.0
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.31
I0901 12:15:21.843142 140635665344512 replay_runner.py:36] Average training steps per second: 197.31
I0901 12:15:21.974991 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:15:22.162024 140635665344512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 202.46
I0901 12:15:27.101832 140635665344512 replay_runner.py:36] Average training steps per second: 202.46
I0901 12:15:27.253419 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.21
I0901 12:15:32.656947 140635665344512 replay_runner.py:36] Average training steps per second: 192.21
I0901 12:15:32.781356 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00