Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0901 13:26:31.273570 140298343233536 run_experiment.py:549] Creating TrainRunner ...
I0901 13:26:31.279839 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:26:31.279942 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:26:31.280002 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:26:31.280049 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:26:31.280117 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:26:31.280188 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:26:31.280288 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:26:31.280465 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:26:31.280541 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:26:31.280634 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:26:31.280710 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:26:31.280828 140298343233536 dqn_agent.py:283] 	 seed: 1630502791279815
I0901 13:26:31.282991 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:26:31.283109 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:26:31.283185 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:26:31.283250 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:26:31.283308 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:26:31.283385 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:26:31.283448 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:26:31.283536 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:26:31.283605 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:26:32.126077 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:32.351048 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:32.358536 140298343233536 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:26:32.363415 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:26:32.363525 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:26:32.363577 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:26:32.363651 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:26:32.363698 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:26:32.363750 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:26:32.363795 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:26:32.363874 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:26:32.363944 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:26:32.364025 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:26:32.364103 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:26:32.364162 140298343233536 dqn_agent.py:283] 	 seed: 1630502792363392
I0901 13:26:32.365525 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:26:32.365641 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:26:32.365711 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:26:32.365775 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:26:32.365832 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:26:32.365925 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:26:32.365995 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:26:32.366051 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:26:32.366135 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:26:32.383458 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:26:32.394870 140298343233536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:26:32.394998 140298343233536 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 251.13
I0901 13:26:36.377188 140298343233536 replay_runner.py:36] Average training steps per second: 251.13
Steps executed: 203 Episode length: 115 Return: -153.8586274076714
I0901 13:26:37.124722 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.97
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 96 Return: -670.17046833177955
INFO:tensorflow:Average training steps per second: 373.65
I0901 13:26:42.983991 140298343233536 replay_runner.py:36] Average training steps per second: 373.65
I0901 13:26:43.092963 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.28
INFO:tensorflow:Starting iteration 2

Steps executed: 340 Episode length: 173 Return: -44.68027480645267
INFO:tensorflow:Average training steps per second: 351.61
I0901 13:26:49.199150 140298343233536 replay_runner.py:36] Average training steps per second: 351.61
I0901 13:26:49.388383 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.45
INFO:tensorflow:Starting iteration 3
I0901 13:26:52.591815 140298343233536 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 353.82
I0901 13:26:55.418385 140298343233536 replay_runner.py:36] Average training steps per second: 353.82

Steps executed: 205 Episode length: 125 Return: -321.7897271707018
INFO:tensorflow:Starting iteration 4
I0901 13:26:58.696123 140298343233536 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 354.54
I0901 13:27:01.516935 140298343233536 replay_runner.py:36] Average training steps per second: 354.54

Steps executed: 223 Episode length: 104 Return: -85.40830851946578
INFO:tensorflow:Starting iteration 5
I0901 13:27:04.843226 140298343233536 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 382.36
I0901 13:27:07.458830 140298343233536 replay_runner.py:36] Average training steps per second: 382.36

Steps executed: 270 Episode length: 149 Return: -244.40327908756225
INFO:tensorflow:Starting iteration 6

Steps executed: 404 Episode length: 215 Return: -190.01568035141418
INFO:tensorflow:Average training steps per second: 365.39
I0901 13:27:13.594414 140298343233536 replay_runner.py:36] Average training steps per second: 365.39
I0901 13:27:13.831653 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.81
INFO:tensorflow:Starting iteration 7

Steps executed: 218 Episode length: 76 Return: -282.872044901545243
INFO:tensorflow:Average training steps per second: 367.25
I0901 13:27:19.811753 140298343233536 replay_runner.py:36] Average training steps per second: 367.25
I0901 13:27:19.934339 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.26
INFO:tensorflow:Starting iteration 8

Steps executed: 255 Episode length: 131 Return: -238.49805773809504
INFO:tensorflow:Average training steps per second: 373.39
I0901 13:27:25.866649 140298343233536 replay_runner.py:36] Average training steps per second: 373.39
I0901 13:27:25.990430 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.82
INFO:tensorflow:Starting iteration 9

Steps executed: 209 Episode length: 149 Return: -239.36891682163258
INFO:tensorflow:Average training steps per second: 372.57
I0901 13:27:31.916973 140298343233536 replay_runner.py:36] Average training steps per second: 372.57
I0901 13:27:32.020244 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.23
INFO:tensorflow:Starting iteration 10

Steps executed: 305 Episode length: 106 Return: -243.77154710709954
INFO:tensorflow:Average training steps per second: 368.42
I0901 13:27:37.983110 140298343233536 replay_runner.py:36] Average training steps per second: 368.42
I0901 13:27:38.136918 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.22
INFO:tensorflow:Starting iteration 11

Steps executed: 240 Episode length: 124 Return: -204.53778261978832
INFO:tensorflow:Average training steps per second: 371.53
I0901 13:27:44.096391 140298343233536 replay_runner.py:36] Average training steps per second: 371.53
I0901 13:27:44.213351 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.06
INFO:tensorflow:Starting iteration 12

Steps executed: 289 Episode length: 144 Return: -215.40857961456607
INFO:tensorflow:Average training steps per second: 365.28
I0901 13:27:50.190430 140298343233536 replay_runner.py:36] Average training steps per second: 365.28
I0901 13:27:50.352701 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.04
INFO:tensorflow:Starting iteration 13

Steps executed: 239 Episode length: 63 Return: -143.258434768262657
INFO:tensorflow:Average training steps per second: 367.44
I0901 13:27:56.320347 140298343233536 replay_runner.py:36] Average training steps per second: 367.44
I0901 13:27:56.414415 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.50
INFO:tensorflow:Starting iteration 14

Steps executed: 274 Episode length: 135 Return: -288.86481145823637
INFO:tensorflow:Average training steps per second: 368.41
I0901 13:28:02.420793 140298343233536 replay_runner.py:36] Average training steps per second: 368.41
I0901 13:28:02.554044 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.25
INFO:tensorflow:Starting iteration 15

Steps executed: 269 Episode length: 93 Return: -190.261360895957347
INFO:tensorflow:Average training steps per second: 363.85
I0901 13:28:08.540199 140298343233536 replay_runner.py:36] Average training steps per second: 363.85
I0901 13:28:08.656140 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.52
INFO:tensorflow:Starting iteration 16

Steps executed: 245 Episode length: 54 Return: -135.635492869739157
INFO:tensorflow:Average training steps per second: 362.73
I0901 13:28:14.623416 140298343233536 replay_runner.py:36] Average training steps per second: 362.73
I0901 13:28:14.715061 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.44
INFO:tensorflow:Starting iteration 17

Steps executed: 260 Episode length: 72 Return: -141.357376569244627
INFO:tensorflow:Average training steps per second: 372.11
I0901 13:28:20.610876 140298343233536 replay_runner.py:36] Average training steps per second: 372.11
I0901 13:28:20.724967 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.34
INFO:tensorflow:Starting iteration 18

Steps executed: 296 Episode length: 105 Return: -342.94706554718323
INFO:tensorflow:Average training steps per second: 374.37
I0901 13:28:26.614240 140298343233536 replay_runner.py:36] Average training steps per second: 374.37
I0901 13:28:26.763227 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.42
INFO:tensorflow:Starting iteration 19

Steps executed: 212 Episode length: 90 Return: -218.356189284151363
INFO:tensorflow:Average training steps per second: 369.30
I0901 13:28:32.726055 140298343233536 replay_runner.py:36] Average training steps per second: 369.30
I0901 13:28:32.803861 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.25
INFO:tensorflow:Starting iteration 20

Steps executed: 247 Episode length: 131 Return: -976.64138533424633
INFO:tensorflow:Average training steps per second: 370.80
I0901 13:28:38.656957 140298343233536 replay_runner.py:36] Average training steps per second: 370.80
I0901 13:28:38.784847 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.09
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 71 Return: -148.673920836452533
INFO:tensorflow:Average training steps per second: 369.15
I0901 13:28:44.730532 140298343233536 replay_runner.py:36] Average training steps per second: 369.15
I0901 13:28:44.823523 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.05
INFO:tensorflow:Starting iteration 22

Steps executed: 333 Episode length: 147 Return: -496.83668792083574
INFO:tensorflow:Average training steps per second: 373.32
I0901 13:28:50.695060 140298343233536 replay_runner.py:36] Average training steps per second: 373.32
I0901 13:28:50.897629 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.01
INFO:tensorflow:Starting iteration 23

Steps executed: 247 Episode length: 171 Return: -523.73175653512374
INFO:tensorflow:Average training steps per second: 371.76
I0901 13:28:56.840167 140298343233536 replay_runner.py:36] Average training steps per second: 371.76
I0901 13:28:56.964272 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.78
INFO:tensorflow:Starting iteration 24

Steps executed: 292 Episode length: 113 Return: -459.05759673304284
INFO:tensorflow:Average training steps per second: 362.84
I0901 13:29:02.923644 140298343233536 replay_runner.py:36] Average training steps per second: 362.84
I0901 13:29:03.047082 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.25
INFO:tensorflow:Starting iteration 25

Steps executed: 250 Episode length: 61 Return: -478.218899200123534
INFO:tensorflow:Average training steps per second: 371.52
I0901 13:29:08.954757 140298343233536 replay_runner.py:36] Average training steps per second: 371.52
I0901 13:29:09.080846 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.30
INFO:tensorflow:Starting iteration 26

Steps executed: 256 Episode length: 62 Return: -176.888626289124154
INFO:tensorflow:Average training steps per second: 373.36
I0901 13:29:14.904725 140298343233536 replay_runner.py:36] Average training steps per second: 373.36
I0901 13:29:15.044070 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.97
INFO:tensorflow:Starting iteration 27

Steps executed: 254 Episode length: 65 Return: -186.926634227420244
INFO:tensorflow:Average training steps per second: 389.16
I0901 13:29:20.756039 140298343233536 replay_runner.py:36] Average training steps per second: 389.16
I0901 13:29:20.867257 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.52
INFO:tensorflow:Starting iteration 28

Steps executed: 262 Episode length: 65 Return: -552.556933326917934
INFO:tensorflow:Average training steps per second: 393.35
I0901 13:29:26.571917 140298343233536 replay_runner.py:36] Average training steps per second: 393.35
I0901 13:29:26.684539 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.69
INFO:tensorflow:Starting iteration 29

Steps executed: 230 Episode length: 51 Return: -126.272863633904174
INFO:tensorflow:Average training steps per second: 403.98
I0901 13:29:32.311390 140298343233536 replay_runner.py:36] Average training steps per second: 403.98

Done fixed training!Episode length: 51 Return: -126.272863633904174