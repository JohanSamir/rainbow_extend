Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0901 13:04:45.838283 140240877414400 run_experiment.py:549] Creating TrainRunner ...
I0901 13:04:45.848001 140240877414400 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:04:45.848265 140240877414400 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:04:45.848392 140240877414400 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:04:45.848479 140240877414400 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:04:45.848556 140240877414400 dqn_agent.py:275] 	 update_period: 4
I0901 13:04:45.848655 140240877414400 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:04:45.848788 140240877414400 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:04:45.848883 140240877414400 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:04:45.848959 140240877414400 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:04:45.849024 140240877414400 dqn_agent.py:280] 	 optimizer: adam
I0901 13:04:45.849091 140240877414400 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:04:45.849153 140240877414400 dqn_agent.py:283] 	 seed: 1630501485847945
I0901 13:04:45.851372 140240877414400 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:04:45.851571 140240877414400 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:04:45.851690 140240877414400 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:04:45.851763 140240877414400 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:04:45.851870 140240877414400 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:04:45.852065 140240877414400 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:04:45.852292 140240877414400 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:04:45.852445 140240877414400 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:04:45.852630 140240877414400 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:04:45.886994 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:46.222181 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:46.235508 140240877414400 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:04:46.244022 140240877414400 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:04:46.244238 140240877414400 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:04:46.244338 140240877414400 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:04:46.244423 140240877414400 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:04:46.244544 140240877414400 dqn_agent.py:275] 	 update_period: 4
I0901 13:04:46.244812 140240877414400 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:04:46.244946 140240877414400 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:04:46.245026 140240877414400 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:04:46.245140 140240877414400 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:04:46.245227 140240877414400 dqn_agent.py:280] 	 optimizer: adam
I0901 13:04:46.245338 140240877414400 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:04:46.245588 140240877414400 dqn_agent.py:283] 	 seed: 1630501486243975
I0901 13:04:46.247984 140240877414400 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:04:46.248183 140240877414400 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:04:46.248375 140240877414400 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:04:46.248473 140240877414400 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:04:46.248551 140240877414400 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:04:46.248626 140240877414400 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:04:46.248700 140240877414400 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:04:46.248839 140240877414400 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:04:46.248953 140240877414400 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:04:46.277260 140240877414400 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:46.295406 140240877414400 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:04:46.295718 140240877414400 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 196.57
I0901 13:04:51.383585 140240877414400 replay_runner.py:36] Average training steps per second: 196.57
Steps executed: 245 Episode length: 140 Return: -191.59469276475134
I0901 13:04:52.294103 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.22
INFO:tensorflow:Starting iteration 1

Steps executed: 536 Episode length: 407 Return: 218.793828104245221
INFO:tensorflow:Average training steps per second: 279.58
I0901 13:04:59.665637 140240877414400 replay_runner.py:36] Average training steps per second: 279.58
I0901 13:05:00.237204 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.50
INFO:tensorflow:Starting iteration 2

Steps executed: 336 Episode length: 180 Return: -21.957428733969721
INFO:tensorflow:Average training steps per second: 281.91
I0901 13:05:07.599410 140240877414400 replay_runner.py:36] Average training steps per second: 281.91
I0901 13:05:07.862855 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -52.05
INFO:tensorflow:Starting iteration 3

Steps executed: 264 Episode length: 139 Return: -513.78271324593674
INFO:tensorflow:Average training steps per second: 284.20
I0901 13:05:15.264543 140240877414400 replay_runner.py:36] Average training steps per second: 284.20
I0901 13:05:15.471219 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.27
INFO:tensorflow:Starting iteration 4

Steps executed: 320 Episode length: 136 Return: -179.34782352847594
INFO:tensorflow:Average training steps per second: 300.10
I0901 13:05:22.651640 140240877414400 replay_runner.py:36] Average training steps per second: 300.10
I0901 13:05:22.877392 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.45
INFO:tensorflow:Starting iteration 5

Steps executed: 261 Episode length: 119 Return: -167.76963294090594
INFO:tensorflow:Average training steps per second: 299.46
I0901 13:05:30.084644 140240877414400 replay_runner.py:36] Average training steps per second: 299.46
I0901 13:05:30.254649 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.83
INFO:tensorflow:Starting iteration 6

Steps executed: 253 Episode length: 133 Return: -246.32572630603022
INFO:tensorflow:Average training steps per second: 297.83
I0901 13:05:37.505869 140240877414400 replay_runner.py:36] Average training steps per second: 297.83
I0901 13:05:37.673639 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.35
INFO:tensorflow:Starting iteration 7

Steps executed: 223 Episode length: 94 Return: -381.412170968085382
INFO:tensorflow:Average training steps per second: 311.67
I0901 13:05:44.743389 140240877414400 replay_runner.py:36] Average training steps per second: 311.67
I0901 13:05:44.861061 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.38
INFO:tensorflow:Starting iteration 8
I0901 13:05:48.648645 140240877414400 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 308.34

Steps executed: 243 Episode length: 85 Return: -329.830821280974132
I0901 13:05:52.004040 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.95
INFO:tensorflow:Starting iteration 9

Steps executed: 277 Episode length: 83 Return: -267.879856153171262
INFO:tensorflow:Average training steps per second: 323.18
I0901 13:05:58.830718 140240877414400 replay_runner.py:36] Average training steps per second: 323.18
I0901 13:05:58.974473 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.49
INFO:tensorflow:Starting iteration 10

Steps executed: 222 Episode length: 85 Return: -359.874250939465873
INFO:tensorflow:Average training steps per second: 329.16
I0901 13:06:05.686649 140240877414400 replay_runner.py:36] Average training steps per second: 329.16
I0901 13:06:05.808415 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.51
INFO:tensorflow:Starting iteration 11

Steps executed: 242 Episode length: 68 Return: -232.915212019782363
INFO:tensorflow:Average training steps per second: 325.24
I0901 13:06:12.536061 140240877414400 replay_runner.py:36] Average training steps per second: 325.24
I0901 13:06:12.647631 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.85
INFO:tensorflow:Starting iteration 12

Steps executed: 236 Episode length: 79 Return: 34.40251114386325383
INFO:tensorflow:Average training steps per second: 331.72
I0901 13:06:19.248657 140240877414400 replay_runner.py:36] Average training steps per second: 331.72
I0901 13:06:19.375510 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.47
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 61 Return: -320.193032449188933
INFO:tensorflow:Average training steps per second: 327.48
I0901 13:06:25.936358 140240877414400 replay_runner.py:36] Average training steps per second: 327.48
I0901 13:06:26.028595 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.60
INFO:tensorflow:Starting iteration 14

Steps executed: 211 Episode length: 70 Return: -195.422968244478033
INFO:tensorflow:Average training steps per second: 326.47
I0901 13:06:32.586848 140240877414400 replay_runner.py:36] Average training steps per second: 326.47
I0901 13:06:32.706894 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.25
INFO:tensorflow:Starting iteration 15

Steps executed: 396 Episode length: 211 Return: -409.85421720302014
INFO:tensorflow:Average training steps per second: 324.87
I0901 13:06:39.255493 140240877414400 replay_runner.py:36] Average training steps per second: 324.87
I0901 13:06:39.477158 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.07
INFO:tensorflow:Starting iteration 16
I0901 13:06:42.948154 140240877414400 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 328.31
I0901 13:06:45.994332 140240877414400 replay_runner.py:36] Average training steps per second: 328.31

Steps executed: 304 Episode length: 134 Return: -70.626996562865444
INFO:tensorflow:Starting iteration 17

Steps executed: 217 Episode length: 104 Return: -550.13831415684963
INFO:tensorflow:Average training steps per second: 326.00
I0901 13:06:52.648723 140240877414400 replay_runner.py:36] Average training steps per second: 326.00
I0901 13:06:52.761530 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.19
INFO:tensorflow:Starting iteration 18

Steps executed: 223 Episode length: 92 Return: -640.071621656994333
INFO:tensorflow:Average training steps per second: 319.61
I0901 13:06:59.312053 140240877414400 replay_runner.py:36] Average training steps per second: 319.61
I0901 13:06:59.439009 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.11
INFO:tensorflow:Starting iteration 19

Steps executed: 297 Episode length: 118 Return: -439.80609612435163
INFO:tensorflow:Average training steps per second: 318.48
I0901 13:07:05.975431 140240877414400 replay_runner.py:36] Average training steps per second: 318.48
I0901 13:07:06.129695 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.69
INFO:tensorflow:Starting iteration 20

Steps executed: 432 Episode length: 432 Return: -565.19163367389243
INFO:tensorflow:Average training steps per second: 318.58
I0901 13:07:12.681694 140240877414400 replay_runner.py:36] Average training steps per second: 318.58
I0901 13:07:13.116337 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -565.19
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 64 Return: -150.226232324981243
INFO:tensorflow:Average training steps per second: 312.68
I0901 13:07:19.717542 140240877414400 replay_runner.py:36] Average training steps per second: 312.68
I0901 13:07:19.814962 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.93
INFO:tensorflow:Starting iteration 22

Steps executed: 211 Episode length: 91 Return: -808.292187084463243
INFO:tensorflow:Average training steps per second: 316.80
I0901 13:07:26.389461 140240877414400 replay_runner.py:36] Average training steps per second: 316.80
I0901 13:07:26.504714 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -610.27
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 94 Return: -32.2013866177469243
INFO:tensorflow:Average training steps per second: 319.23
I0901 13:07:33.049855 140240877414400 replay_runner.py:36] Average training steps per second: 319.23
I0901 13:07:33.154885 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.69
INFO:tensorflow:Starting iteration 24

Steps executed: 244 Episode length: 115 Return: -163.65076940967882
INFO:tensorflow:Average training steps per second: 322.12
I0901 13:07:39.676806 140240877414400 replay_runner.py:36] Average training steps per second: 322.12
I0901 13:07:39.803835 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.83
INFO:tensorflow:Starting iteration 25

Steps executed: 268 Episode length: 81 Return: -495.553263024780732
INFO:tensorflow:Average training steps per second: 317.16
I0901 13:07:46.383847 140240877414400 replay_runner.py:36] Average training steps per second: 317.16
I0901 13:07:46.522574 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.33
INFO:tensorflow:Starting iteration 26

Steps executed: 213 Episode length: 68 Return: -446.629007592433942
INFO:tensorflow:Average training steps per second: 332.84
I0901 13:07:52.951185 140240877414400 replay_runner.py:36] Average training steps per second: 332.84
I0901 13:07:53.068801 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -512.37
INFO:tensorflow:Starting iteration 27

Steps executed: 270 Episode length: 78 Return: -122.208427865195332
INFO:tensorflow:Average training steps per second: 327.18
I0901 13:07:59.558425 140240877414400 replay_runner.py:36] Average training steps per second: 327.18
I0901 13:07:59.684610 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.89
INFO:tensorflow:Starting iteration 28

Steps executed: 54 Episode length: 54 Return: -89.70542758571416332
INFO:tensorflow:Average training steps per second: 324.68

Steps executed: 203 Episode length: 76 Return: -114.257352758366522
I0901 13:08:06.315903 140240877414400 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.73
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 60 Return: -529.630479726553972
INFO:tensorflow:Average training steps per second: 341.30
I0901 13:08:12.502227 140240877414400 replay_runner.py:36] Average training steps per second: 341.30

Done fixed training!Episode length: 60 Return: -529.630479726553972