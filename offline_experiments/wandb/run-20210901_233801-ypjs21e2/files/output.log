I0901 23:38:07.684088 140437416843264 run_experiment.py:549] Creating TrainRunner ...
I0901 23:38:07.694393 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:38:07.694582 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:38:07.694693 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:38:07.694785 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:38:07.694858 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:38:07.694918 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:38:07.695021 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:38:07.695096 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:38:07.695152 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:38:07.695221 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:38:07.695306 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:38:07.695400 140437416843264 dqn_agent.py:283] 	 seed: 1630539487694344
I0901 23:38:07.698630 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:38:07.699002 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:38:07.699177 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:38:07.699305 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:38:07.699446 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:38:07.699544 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:38:07.699644 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:38:07.699818 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:38:07.699968 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0901 23:38:09.314466 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:38:09.926128 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:38:09.940488 140437416843264 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:38:09.949494 140437416843264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:38:09.949699 140437416843264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:38:09.949807 140437416843264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:38:09.949871 140437416843264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:38:09.949963 140437416843264 dqn_agent.py:275] 	 update_period: 4
I0901 23:38:09.950086 140437416843264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:38:09.950425 140437416843264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:38:09.950717 140437416843264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:38:09.950954 140437416843264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:38:09.951081 140437416843264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:38:09.951199 140437416843264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:38:09.951312 140437416843264 dqn_agent.py:283] 	 seed: 1630539489949441
I0901 23:38:09.953955 140437416843264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:38:09.954152 140437416843264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:38:09.954327 140437416843264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:38:09.954630 140437416843264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:38:09.954794 140437416843264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:38:09.954885 140437416843264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:38:09.954965 140437416843264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:38:09.955058 140437416843264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:38:09.955173 140437416843264 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:38:09.986396 140437416843264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:38:10.007962 140437416843264 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:38:10.008173 140437416843264 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.28
I0901 23:38:16.208550 140437416843264 replay_runner.py:36] Average training steps per second: 161.28
Steps executed: 201 Episode length: 8 Return: 8.0.0
I0901 23:38:17.423057 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 281 Episode length: 92 Return: 92.0
INFO:tensorflow:Average training steps per second: 216.70
I0901 23:38:22.234559 140437416843264 replay_runner.py:36] Average training steps per second: 216.70
I0901 23:38:22.405786 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.67
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.67
I0901 23:38:27.482454 140437416843264 replay_runner.py:36] Average training steps per second: 204.67
I0901 23:38:27.599199 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 367 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 215.51
I0901 23:38:32.409023 140437416843264 replay_runner.py:36] Average training steps per second: 215.51
I0901 23:38:32.626360 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 4

Steps executed: 364 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 201.44
I0901 23:38:37.767693 140437416843264 replay_runner.py:36] Average training steps per second: 201.44
I0901 23:38:37.995635 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 5

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.52
I0901 23:38:43.160128 140437416843264 replay_runner.py:36] Average training steps per second: 200.52
I0901 23:38:43.432207 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 6

Steps executed: 337 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 199.26
I0901 23:38:48.648193 140437416843264 replay_runner.py:36] Average training steps per second: 199.26
I0901 23:38:48.879532 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.50
INFO:tensorflow:Starting iteration 7

Steps executed: 301 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 193.40
I0901 23:38:54.234993 140437416843264 replay_runner.py:36] Average training steps per second: 193.40
I0901 23:38:54.429869 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 8
I0901 23:38:54.608840 140437416843264 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 201.79
I0901 23:38:59.564941 140437416843264 replay_runner.py:36] Average training steps per second: 201.79

Steps executed: 325 Episode length: 178 Return: 178.0
INFO:tensorflow:Starting iteration 9

Steps executed: 362 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 199.16
I0901 23:39:05.009183 140437416843264 replay_runner.py:36] Average training steps per second: 199.16
I0901 23:39:05.239808 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.00
INFO:tensorflow:Starting iteration 10

Steps executed: 327 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 201.22
I0901 23:39:10.395963 140437416843264 replay_runner.py:36] Average training steps per second: 201.22
I0901 23:39:10.601967 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 11
I0901 23:39:10.786304 140437416843264 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 197.09

Steps executed: 347 Episode length: 157 Return: 157.0
I0901 23:39:16.108778 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 12

Steps executed: 368 Episode length: 196 Return: 196.0
INFO:tensorflow:Average training steps per second: 202.99
I0901 23:39:21.218230 140437416843264 replay_runner.py:36] Average training steps per second: 202.99
I0901 23:39:21.460539 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 13

Steps executed: 364 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.23
I0901 23:39:26.888285 140437416843264 replay_runner.py:36] Average training steps per second: 190.23
I0901 23:39:27.129709 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 14

Steps executed: 314 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 196.11
I0901 23:39:32.414796 140437416843264 replay_runner.py:36] Average training steps per second: 196.11
I0901 23:39:32.635080 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.01
I0901 23:39:38.089872 140437416843264 replay_runner.py:36] Average training steps per second: 190.01
I0901 23:39:38.223571 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:39:38.408575 140437416843264 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.70
I0901 23:39:43.467310 140437416843264 replay_runner.py:36] Average training steps per second: 197.70
I0901 23:39:43.603033 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 301 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 197.48
I0901 23:39:48.849384 140437416843264 replay_runner.py:36] Average training steps per second: 197.48
I0901 23:39:49.043988 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 18

Steps executed: 328 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 195.23
I0901 23:39:54.349496 140437416843264 replay_runner.py:36] Average training steps per second: 195.23
I0901 23:39:54.574939 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 19
I0901 23:39:54.754667 140437416843264 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 201.40

Steps executed: 379 Episode length: 196 Return: 196.0
I0901 23:39:59.991389 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 20

Steps executed: 341 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 189.28
I0901 23:40:05.470193 140437416843264 replay_runner.py:36] Average training steps per second: 189.28
I0901 23:40:05.715844 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 21

Steps executed: 354 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 192.75
I0901 23:40:11.096349 140437416843264 replay_runner.py:36] Average training steps per second: 192.75
I0901 23:40:11.341280 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 22

Steps executed: 328 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 199.99
I0901 23:40:16.538214 140437416843264 replay_runner.py:36] Average training steps per second: 199.99
I0901 23:40:16.751668 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.13
I0901 23:40:22.222610 140437416843264 replay_runner.py:36] Average training steps per second: 189.13
I0901 23:40:22.361881 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:40:22.542892 140437416843264 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.10
I0901 23:40:27.616750 140437416843264 replay_runner.py:36] Average training steps per second: 197.10
I0901 23:40:27.770524 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:40:27.970328 140437416843264 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.86
I0901 23:40:33.129361 140437416843264 replay_runner.py:36] Average training steps per second: 193.86
I0901 23:40:33.260606 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:40:33.436061 140437416843264 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.04
I0901 23:40:38.511608 140437416843264 replay_runner.py:36] Average training steps per second: 197.04
I0901 23:40:38.701256 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:40:38.900343 140437416843264 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 197.54
I0901 23:40:43.963029 140437416843264 replay_runner.py:36] Average training steps per second: 197.54
I0901 23:40:44.088536 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 340 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 191.72
I0901 23:40:49.474333 140437416843264 replay_runner.py:36] Average training steps per second: 191.72
I0901 23:40:49.703266 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.15
I0901 23:40:54.820918 140437416843264 replay_runner.py:36] Average training steps per second: 203.15
I0901 23:40:54.963418 140437416843264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00