Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0901 12:47:28.764416 139816666404864 run_experiment.py:549] Creating TrainRunner ...
I0901 12:47:28.774522 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:28.774847 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:28.775001 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:28.775196 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:28.775381 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:28.775475 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:28.775644 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:28.775781 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:28.775874 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:28.775998 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:28.776079 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:28.776219 139816666404864 dqn_agent.py:283] 	 seed: 1630500448774441
I0901 12:47:28.779517 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:28.779726 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:28.779900 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:28.780039 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:28.780129 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:28.780198 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:28.780263 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:28.780324 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:28.780399 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:28.931170 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:29.424141 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:29.436967 139816666404864 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:47:29.445758 139816666404864 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:47:29.445983 139816666404864 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:47:29.446090 139816666404864 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:47:29.446228 139816666404864 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:47:29.446305 139816666404864 dqn_agent.py:275] 	 update_period: 4
I0901 12:47:29.446387 139816666404864 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:47:29.446514 139816666404864 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:47:29.446611 139816666404864 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:47:29.446687 139816666404864 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:47:29.446760 139816666404864 dqn_agent.py:280] 	 optimizer: adam
I0901 12:47:29.446847 139816666404864 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:47:29.446929 139816666404864 dqn_agent.py:283] 	 seed: 1630500449445705
I0901 12:47:29.449081 139816666404864 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:47:29.449291 139816666404864 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:47:29.449475 139816666404864 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:47:29.449673 139816666404864 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:47:29.449769 139816666404864 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:47:29.449869 139816666404864 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:47:29.450178 139816666404864 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:47:29.450334 139816666404864 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:47:29.450458 139816666404864 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:47:29.483975 139816666404864 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:47:29.507355 139816666404864 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:47:29.507548 139816666404864 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 144.71
I0901 12:47:36.417923 139816666404864 replay_runner.py:36] Average training steps per second: 144.71
I0901 12:47:37.964211 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:47:38.205595 139816666404864 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.78
I0901 12:47:43.186991 139816666404864 replay_runner.py:36] Average training steps per second: 200.78
I0901 12:47:43.598333 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:47:43.837760 139816666404864 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 194.61
I0901 12:47:48.976819 139816666404864 replay_runner.py:36] Average training steps per second: 194.61
I0901 12:47:49.387997 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:47:49.628509 139816666404864 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 199.86
I0901 12:47:54.632408 139816666404864 replay_runner.py:36] Average training steps per second: 199.86
I0901 12:47:55.071406 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:47:55.307215 139816666404864 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 198.36
I0901 12:48:00.348961 139816666404864 replay_runner.py:36] Average training steps per second: 198.36
I0901 12:48:00.752744 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:48:01.057086 139816666404864 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.59
I0901 12:48:06.118579 139816666404864 replay_runner.py:36] Average training steps per second: 197.59
I0901 12:48:06.531773 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:48:06.779165 139816666404864 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.58
I0901 12:48:11.866613 139816666404864 replay_runner.py:36] Average training steps per second: 196.58
I0901 12:48:12.285552 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 225 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 197.77
I0901 12:48:17.589143 139816666404864 replay_runner.py:36] Average training steps per second: 197.77
I0901 12:48:17.791909 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 8

Steps executed: 236 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 190.87
I0901 12:48:23.278316 139816666404864 replay_runner.py:36] Average training steps per second: 190.87
I0901 12:48:23.497216 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 9
I0901 12:48:23.742701 139816666404864 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.18

Steps executed: 317 Episode length: 235 Return: -234.0
I0901 12:48:29.192377 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.50
INFO:tensorflow:Starting iteration 10

Steps executed: 208 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 199.68
I0901 12:48:34.447531 139816666404864 replay_runner.py:36] Average training steps per second: 199.68
I0901 12:48:34.625938 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 11

Steps executed: 121 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 194.74
I0901 12:48:40.007753 139816666404864 replay_runner.py:36] Average training steps per second: 194.74

Steps executed: 621 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 12

Steps executed: 230 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 199.00
I0901 12:48:45.798638 139816666404864 replay_runner.py:36] Average training steps per second: 199.00
I0901 12:48:45.998752 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 198.57
I0901 12:48:51.285019 139816666404864 replay_runner.py:36] Average training steps per second: 198.57
I0901 12:48:51.445004 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 14

Steps executed: 202 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 198.31
I0901 12:48:56.724348 139816666404864 replay_runner.py:36] Average training steps per second: 198.31
I0901 12:48:56.901017 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 15

Steps executed: 274 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 198.35
I0901 12:49:02.191130 139816666404864 replay_runner.py:36] Average training steps per second: 198.35
I0901 12:49:02.426662 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 16

Steps executed: 239 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 193.11
I0901 12:49:07.856345 139816666404864 replay_runner.py:36] Average training steps per second: 193.11
I0901 12:49:08.065932 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.90
I0901 12:49:13.367399 139816666404864 replay_runner.py:36] Average training steps per second: 197.90
I0901 12:49:13.806713 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 263 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 206.54
I0901 12:49:18.902298 139816666404864 replay_runner.py:36] Average training steps per second: 206.54
I0901 12:49:19.101222 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.35
I0901 12:49:24.345781 139816666404864 replay_runner.py:36] Average training steps per second: 199.35
I0901 12:49:24.776386 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 251 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 205.26
I0901 12:49:29.881439 139816666404864 replay_runner.py:36] Average training steps per second: 205.26
I0901 12:49:30.087823 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 21

Steps executed: 293 Episode length: 145 Return: -144.0
INFO:tensorflow:Average training steps per second: 197.66
I0901 12:49:35.382369 139816666404864 replay_runner.py:36] Average training steps per second: 197.66
I0901 12:49:35.626883 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.50
INFO:tensorflow:Starting iteration 22

Steps executed: 84 Episode length: 84 Return: -83.04.0
INFO:tensorflow:Average training steps per second: 198.03
I0901 12:49:40.902714 139816666404864 replay_runner.py:36] Average training steps per second: 198.03

Steps executed: 207 Episode length: 123 Return: -122.0
INFO:tensorflow:Starting iteration 23

Steps executed: 252 Episode length: 252 Return: -251.0
INFO:tensorflow:Average training steps per second: 196.38
I0901 12:49:46.446026 139816666404864 replay_runner.py:36] Average training steps per second: 196.38
I0901 12:49:46.657674 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.00
INFO:tensorflow:Starting iteration 24

Steps executed: 257 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 193.50
I0901 12:49:52.076175 139816666404864 replay_runner.py:36] Average training steps per second: 193.50
I0901 12:49:52.296269 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 25

Steps executed: 216 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 201.32
I0901 12:49:57.490074 139816666404864 replay_runner.py:36] Average training steps per second: 201.32
I0901 12:49:57.666635 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 26

Steps executed: 259 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 203.07
I0901 12:50:02.836888 139816666404864 replay_runner.py:36] Average training steps per second: 203.07
I0901 12:50:03.046089 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.50
INFO:tensorflow:Starting iteration 27

Steps executed: 276 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 200.59
I0901 12:50:08.283215 139816666404864 replay_runner.py:36] Average training steps per second: 200.59
I0901 12:50:08.521591 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 28

Steps executed: 272 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 193.68
I0901 12:50:13.935797 139816666404864 replay_runner.py:36] Average training steps per second: 193.68
I0901 12:50:14.180559 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 195.16
I0901 12:50:19.535613 139816666404864 replay_runner.py:36] Average training steps per second: 195.16
I0901 12:50:19.780307 139816666404864 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.50