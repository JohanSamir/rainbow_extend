Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0828 10:42:09.708789 140455557396480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:42:09.720261 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:42:09.720530 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:42:09.720732 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:42:09.720914 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:42:09.721058 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:42:09.721344 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:42:09.721491 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:42:09.721626 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:42:09.721743 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:42:09.721849 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:42:09.721922 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:42:09.722058 140455557396480 dqn_agent.py:283] 	 seed: 1630147329720201
I0828 10:42:09.725596 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:42:09.725718 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:42:09.725792 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:42:09.725871 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:42:09.725932 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:42:09.725996 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:42:09.726098 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:42:09.726183 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:42:09.726300 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:42:09.762315 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:42:10.126863 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:42:10.141963 140455557396480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:42:10.152378 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:42:10.152554 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:42:10.152641 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:42:10.152702 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:42:10.152786 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:42:10.152887 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:42:10.152948 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:42:10.153028 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:42:10.153117 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:42:10.153177 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:42:10.153242 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:42:10.153310 140455557396480 dqn_agent.py:283] 	 seed: 1630147330152336
I0828 10:42:10.156037 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:42:10.156337 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:42:10.156545 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:42:10.156713 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:42:10.156856 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:42:10.157006 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:42:10.157118 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:42:10.157230 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:42:10.157319 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:42:10.188459 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:42:10.252859 140455557396480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:42:10.253233 140455557396480 replay_runner.py:41] Starting iteration 0
Steps executed: 284 Episode length: 204 Return: -754.9474041074149
INFO:tensorflow:Average training steps per second: 174.33
I0828 10:42:15.989833 140455557396480 replay_runner.py:36] Average training steps per second: 174.33
I0828 10:42:17.226915 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -695.15
INFO:tensorflow:Starting iteration 1

Steps executed: 283 Episode length: 192 Return: -578.3185922767709
INFO:tensorflow:Average training steps per second: 244.17
I0828 10:42:25.477804 140455557396480 replay_runner.py:36] Average training steps per second: 244.17
I0828 10:42:25.735757 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -563.16
INFO:tensorflow:Starting iteration 2

Steps executed: 258 Episode length: 258 Return: -94.25244904490066
INFO:tensorflow:Average training steps per second: 237.91
I0828 10:42:34.187546 140455557396480 replay_runner.py:36] Average training steps per second: 237.91
I0828 10:42:34.515598 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.25
INFO:tensorflow:Starting iteration 3
I0828 10:42:38.685997 140455557396480 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 244.43
I0828 10:42:42.777523 140455557396480 replay_runner.py:36] Average training steps per second: 244.43

Steps executed: 1000 Episode length: 1000 Return: -140.5378681323664
INFO:tensorflow:Starting iteration 4
I0828 10:42:49.738623 140455557396480 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 241.82

Steps executed: 1000 Episode length: 1000 Return: -165.12576251513906
I0828 10:42:56.454296 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.13
INFO:tensorflow:Starting iteration 5

Steps executed: 259 Episode length: 259 Return: -270.5289691451506506
INFO:tensorflow:Average training steps per second: 239.26
I0828 10:43:04.996579 140455557396480 replay_runner.py:36] Average training steps per second: 239.26
I0828 10:43:05.272537 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.53
INFO:tensorflow:Starting iteration 6

Steps executed: 253 Episode length: 253 Return: -165.5397437891294306
INFO:tensorflow:Average training steps per second: 236.16
I0828 10:43:13.689770 140455557396480 replay_runner.py:36] Average training steps per second: 236.16
I0828 10:43:13.974209 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.54
INFO:tensorflow:Starting iteration 7

Steps executed: 143 Episode length: 143 Return: -345.5768100237334306
INFO:tensorflow:Average training steps per second: 242.40

Steps executed: 980 Episode length: 837 Return: -261.3095807959784306
I0828 10:43:24.452033 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.44
INFO:tensorflow:Starting iteration 8

Steps executed: 280 Episode length: 280 Return: -119.0785159644299306
INFO:tensorflow:Average training steps per second: 235.28
I0828 10:43:32.847683 140455557396480 replay_runner.py:36] Average training steps per second: 235.28
I0828 10:43:33.153432 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.08
INFO:tensorflow:Starting iteration 9

Steps executed: 72 Episode length: 72 Return: -146.018845360761769306
INFO:tensorflow:Average training steps per second: 237.98

Steps executed: 254 Episode length: 182 Return: -119.9380829086193206
I0828 10:43:41.774835 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.98
INFO:tensorflow:Starting iteration 10

Steps executed: 519 Episode length: 519 Return: -26.52442400549236406
INFO:tensorflow:Average training steps per second: 227.43
I0828 10:43:50.457158 140455557396480 replay_runner.py:36] Average training steps per second: 227.43
I0828 10:43:51.449785 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.52
INFO:tensorflow:Starting iteration 11

Steps executed: 315 Episode length: 315 Return: -266.8485142405646706
INFO:tensorflow:Average training steps per second: 233.60
I0828 10:43:59.975425 140455557396480 replay_runner.py:36] Average training steps per second: 233.60
I0828 10:44:00.416527 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.85
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 237 Return: -92.26527031482442706
INFO:tensorflow:Average training steps per second: 228.40
I0828 10:44:09.148713 140455557396480 replay_runner.py:36] Average training steps per second: 228.40
I0828 10:44:09.427300 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.27
INFO:tensorflow:Starting iteration 13

Steps executed: 388 Episode length: 316 Return: -152.8520531584672706
INFO:tensorflow:Average training steps per second: 224.26
I0828 10:44:18.264553 140455557396480 replay_runner.py:36] Average training steps per second: 224.26
I0828 10:44:18.763383 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.95
INFO:tensorflow:Starting iteration 14

Steps executed: 177 Episode length: 177 Return: -24.69998372922464706
INFO:tensorflow:Average training steps per second: 227.14
I0828 10:44:27.490204 140455557396480 replay_runner.py:36] Average training steps per second: 227.14

Steps executed: 402 Episode length: 225 Return: -4.487154912676956506
INFO:tensorflow:Starting iteration 15

Steps executed: 234 Episode length: 69 Return: -1.1300780913646946506
INFO:tensorflow:Average training steps per second: 225.12
I0828 10:44:36.662892 140455557396480 replay_runner.py:36] Average training steps per second: 225.12
I0828 10:44:36.844334 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.16
INFO:tensorflow:Starting iteration 16
I0828 10:44:41.081998 140455557396480 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 228.46

Steps executed: 549 Episode length: 549 Return: -9.546261188233146506
I0828 10:44:46.543400 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -9.55
INFO:tensorflow:Starting iteration 17

Steps executed: 220 Episode length: 220 Return: -18.84819044718925306
INFO:tensorflow:Average training steps per second: 230.88
I0828 10:44:55.067857 140455557396480 replay_runner.py:36] Average training steps per second: 230.88
I0828 10:44:55.312870 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.85
INFO:tensorflow:Starting iteration 18
I0828 10:44:59.548438 140455557396480 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 232.76
I0828 10:45:03.845261 140455557396480 replay_runner.py:36] Average training steps per second: 232.76

Steps executed: 1000 Episode length: 1000 Return: 144.807028517961906
INFO:tensorflow:Starting iteration 19

Steps executed: 271 Episode length: 129 Return: 24.430535033993166906
INFO:tensorflow:Average training steps per second: 241.71
I0828 10:45:14.476927 140455557396480 replay_runner.py:36] Average training steps per second: 241.71
I0828 10:45:14.680689 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.60
INFO:tensorflow:Starting iteration 20

Steps executed: 358 Episode length: 221 Return: -0.445842584865658866
INFO:tensorflow:Average training steps per second: 245.85
I0828 10:45:22.869340 140455557396480 replay_runner.py:36] Average training steps per second: 245.85
I0828 10:45:23.177553 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.32
INFO:tensorflow:Starting iteration 21

Steps executed: 144 Episode length: 144 Return: -80.92518451896986866
INFO:tensorflow:Average training steps per second: 260.31

Steps executed: 1144 Episode length: 1000 Return: -11.579328691697857
I0828 10:45:33.248375 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.25
INFO:tensorflow:Starting iteration 22

Steps executed: 445 Episode length: 445 Return: 197.65665107655522857
INFO:tensorflow:Average training steps per second: 273.98
I0828 10:45:40.998924 140455557396480 replay_runner.py:36] Average training steps per second: 273.98
I0828 10:45:41.717802 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.66
INFO:tensorflow:Starting iteration 23

Steps executed: 220 Episode length: 91 Return: -386.22735745194562857
INFO:tensorflow:Average training steps per second: 281.97
I0828 10:45:49.298332 140455557396480 replay_runner.py:36] Average training steps per second: 281.97
I0828 10:45:49.451327 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.15
INFO:tensorflow:Starting iteration 24

Steps executed: 254 Episode length: 83 Return: -81.502931665845642857
INFO:tensorflow:Average training steps per second: 275.50
I0828 10:45:56.976552 140455557396480 replay_runner.py:36] Average training steps per second: 275.50
I0828 10:45:57.164323 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.60
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 320 Return: 200.27335869922388857
INFO:tensorflow:Average training steps per second: 284.19
I0828 10:46:04.529286 140455557396480 replay_runner.py:36] Average training steps per second: 284.19
I0828 10:46:04.996449 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: 97.28
INFO:tensorflow:Starting iteration 26
I0828 10:46:08.666221 140455557396480 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 292.72

Steps executed: 537 Episode length: 426 Return: -174.5211428433538657
I0828 10:46:12.673568 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.68
INFO:tensorflow:Starting iteration 27

Steps executed: 213 Episode length: 93 Return: -15.530646767619146257
INFO:tensorflow:Average training steps per second: 313.11
I0828 10:46:19.515073 140455557396480 replay_runner.py:36] Average training steps per second: 313.11
I0828 10:46:19.641601 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -17.41
INFO:tensorflow:Starting iteration 28
I0828 10:46:22.994140 140455557396480 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 327.68
I0828 10:46:26.046205 140455557396480 replay_runner.py:36] Average training steps per second: 327.68

Steps executed: 299 Episode length: 216 Return: -560.9127293099925257
INFO:tensorflow:Starting iteration 29
I0828 10:46:29.576771 140455557396480 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 329.89

Steps executed: 342 Episode length: 152 Return: -311.9009089208136657

Done fixed training!Episode length: 152 Return: -311.9009089208136657