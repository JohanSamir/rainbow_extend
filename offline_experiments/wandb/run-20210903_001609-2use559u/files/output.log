I0903 00:16:15.674618 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0903 00:16:15.683519 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:16:15.683722 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:16:15.683811 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:16:15.683882 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:16:15.683945 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:16:15.684033 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:16:15.684116 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:16:15.684240 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:16:15.684412 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:16:15.684511 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:16:15.684624 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:16:15.684700 140006414895104 dqn_agent.py:283] 	 seed: 1630628175683468
I0903 00:16:15.687019 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:16:15.687144 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:16:15.687224 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:16:15.687402 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:16:15.687476 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:16:15.687601 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:16:15.687676 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:16:15.687735 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:16:15.687814 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:16:15.713497 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:16.005043 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:16.014704 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:16:16.020918 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:16:16.021050 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:16:16.021127 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:16:16.021191 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:16:16.021249 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0903 00:16:16.021321 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:16:16.021380 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:16:16.021463 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:16:16.021533 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:16:16.021590 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0903 00:16:16.021676 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:16:16.021754 140006414895104 dqn_agent.py:283] 	 seed: 1630628176020891
I0903 00:16:16.023190 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:16:16.023422 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:16:16.023531 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:16:16.023626 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:16:16.023718 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:16:16.023795 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:16:16.023892 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:16:16.024004 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:16:16.024085 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:16:16.044648 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:16:16.061989 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:16:16.062292 140006414895104 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 243.30
I0903 00:16:20.172784 140006414895104 replay_runner.py:36] Average training steps per second: 243.30
I0903 00:16:21.000155 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.57
Steps executed: 228 Episode length: 160 Return: -178.29191575258716
INFO:tensorflow:Starting iteration 1
I0903 00:16:24.457564 140006414895104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 334.61
I0903 00:16:27.446377 140006414895104 replay_runner.py:36] Average training steps per second: 334.61

Steps executed: 318 Episode length: 150 Return: -561.89619396091217
INFO:tensorflow:Starting iteration 2

Steps executed: 291 Episode length: 176 Return: -518.35227861596457
INFO:tensorflow:Average training steps per second: 329.67
I0903 00:16:34.093403 140006414895104 replay_runner.py:36] Average training steps per second: 329.67
I0903 00:16:34.289470 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.85
INFO:tensorflow:Starting iteration 3

Steps executed: 214 Episode length: 81 Return: -754.173390240059547
INFO:tensorflow:Average training steps per second: 320.39
I0903 00:16:40.783713 140006414895104 replay_runner.py:36] Average training steps per second: 320.39
I0903 00:16:40.922101 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -723.47
INFO:tensorflow:Starting iteration 4
I0903 00:16:44.280362 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 326.42
I0903 00:16:47.344183 140006414895104 replay_runner.py:36] Average training steps per second: 326.42

Steps executed: 200 Episode length: 93 Return: -454.554177456905057
INFO:tensorflow:Starting iteration 5
I0903 00:16:50.883098 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 334.95
I0903 00:16:53.868892 140006414895104 replay_runner.py:36] Average training steps per second: 334.95

Steps executed: 352 Episode length: 258 Return: -157.36964069886187
INFO:tensorflow:Starting iteration 6

Steps executed: 518 Episode length: 450 Return: -522.80374389953827
INFO:tensorflow:Average training steps per second: 336.00
I0903 00:17:00.613312 140006414895104 replay_runner.py:36] Average training steps per second: 336.00
I0903 00:17:01.302904 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -575.51
INFO:tensorflow:Starting iteration 7

Steps executed: 202 Episode length: 202 Return: -478.10484677375927
INFO:tensorflow:Average training steps per second: 322.44
I0903 00:17:07.839455 140006414895104 replay_runner.py:36] Average training steps per second: 322.44
I0903 00:17:07.975586 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.10
INFO:tensorflow:Starting iteration 8

Steps executed: 251 Episode length: 251 Return: -785.82142592265137
INFO:tensorflow:Average training steps per second: 329.32
I0903 00:17:14.463057 140006414895104 replay_runner.py:36] Average training steps per second: 329.32
I0903 00:17:14.677868 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -785.82
INFO:tensorflow:Starting iteration 9
I0903 00:17:18.111879 140006414895104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 325.18

Steps executed: 1000 Episode length: 1000 Return: -217.48654008582946
I0903 00:17:23.279740 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.49
INFO:tensorflow:Starting iteration 10

Steps executed: 1000 Episode length: 1000 Return: -130.76366439924828
INFO:tensorflow:Average training steps per second: 315.67
I0903 00:17:29.791656 140006414895104 replay_runner.py:36] Average training steps per second: 315.67
I0903 00:17:31.085642 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.76
INFO:tensorflow:Starting iteration 11
I0903 00:17:34.466599 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 314.59
I0903 00:17:37.645630 140006414895104 replay_runner.py:36] Average training steps per second: 314.59

Steps executed: 241 Episode length: 165 Return: -95.11943620781943828
INFO:tensorflow:Starting iteration 12

Steps executed: 253 Episode length: 120 Return: -507.3245931281118828
INFO:tensorflow:Average training steps per second: 313.79
I0903 00:17:44.292114 140006414895104 replay_runner.py:36] Average training steps per second: 313.79
I0903 00:17:44.464556 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -506.77
INFO:tensorflow:Starting iteration 13

Steps executed: 262 Episode length: 130 Return: -179.4221028755612528
INFO:tensorflow:Average training steps per second: 309.27
I0903 00:17:51.025057 140006414895104 replay_runner.py:36] Average training steps per second: 309.27
I0903 00:17:51.174213 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.16
INFO:tensorflow:Starting iteration 14
I0903 00:17:54.418308 140006414895104 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 295.14

Steps executed: 263 Episode length: 128 Return: -201.2342240990894228
I0903 00:17:58.002148 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.57
INFO:tensorflow:Starting iteration 15

Steps executed: 205 Episode length: 102 Return: -481.8035353689894628
INFO:tensorflow:Average training steps per second: 301.96
I0903 00:18:04.506220 140006414895104 replay_runner.py:36] Average training steps per second: 301.96
I0903 00:18:04.628485 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.82
INFO:tensorflow:Starting iteration 16

Steps executed: 340 Episode length: 234 Return: -155.6751038531528228
INFO:tensorflow:Average training steps per second: 303.31
I0903 00:18:11.141071 140006414895104 replay_runner.py:36] Average training steps per second: 303.31
I0903 00:18:11.393550 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.85
INFO:tensorflow:Starting iteration 17

Steps executed: 354 Episode length: 157 Return: -283.6670169797828228
INFO:tensorflow:Average training steps per second: 297.19
I0903 00:18:17.962118 140006414895104 replay_runner.py:36] Average training steps per second: 297.19
I0903 00:18:18.204721 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.94
INFO:tensorflow:Starting iteration 18

Steps executed: 235 Episode length: 88 Return: -428.09173811336774228
INFO:tensorflow:Average training steps per second: 297.97
I0903 00:18:24.747211 140006414895104 replay_runner.py:36] Average training steps per second: 297.97
I0903 00:18:24.916799 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -523.28
INFO:tensorflow:Starting iteration 19

Steps executed: 170 Episode length: 170 Return: -148.8575458323516228
INFO:tensorflow:Average training steps per second: 298.25
I0903 00:18:31.456297 140006414895104 replay_runner.py:36] Average training steps per second: 298.25

Steps executed: 304 Episode length: 134 Return: -568.3451450777837228
INFO:tensorflow:Starting iteration 20

Steps executed: 239 Episode length: 119 Return: -105.6286235864027128
INFO:tensorflow:Average training steps per second: 293.59
I0903 00:18:38.240337 140006414895104 replay_runner.py:36] Average training steps per second: 293.59
I0903 00:18:38.389451 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.46
INFO:tensorflow:Starting iteration 21

Steps executed: 257 Episode length: 149 Return: -121.9566896896073428
INFO:tensorflow:Average training steps per second: 299.89
I0903 00:18:44.899154 140006414895104 replay_runner.py:36] Average training steps per second: 299.89
I0903 00:18:45.057586 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.67
INFO:tensorflow:Starting iteration 22

Steps executed: 114 Episode length: 114 Return: -9.588558928237546428
INFO:tensorflow:Average training steps per second: 285.76
I0903 00:18:51.656230 140006414895104 replay_runner.py:36] Average training steps per second: 285.76

Steps executed: 222 Episode length: 108 Return: -525.8865868039833428
INFO:tensorflow:Starting iteration 23

Steps executed: 224 Episode length: 109 Return: -163.7421515085394228
INFO:tensorflow:Average training steps per second: 299.70
I0903 00:18:58.177464 140006414895104 replay_runner.py:36] Average training steps per second: 299.70
I0903 00:18:58.318667 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.57
INFO:tensorflow:Starting iteration 24

Steps executed: 225 Episode length: 135 Return: -501.3635081655872228
INFO:tensorflow:Average training steps per second: 322.96
I0903 00:19:04.624129 140006414895104 replay_runner.py:36] Average training steps per second: 322.96
I0903 00:19:04.760957 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.63
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 155 Return: -583.7649969929602228
INFO:tensorflow:Average training steps per second: 314.75
I0903 00:19:11.231695 140006414895104 replay_runner.py:36] Average training steps per second: 314.75
I0903 00:19:11.359563 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -485.93
INFO:tensorflow:Starting iteration 26

Steps executed: 252 Episode length: 91 Return: -631.54589873062094228
INFO:tensorflow:Average training steps per second: 318.84
I0903 00:19:17.683986 140006414895104 replay_runner.py:36] Average training steps per second: 318.84
I0903 00:19:17.816415 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -559.08
INFO:tensorflow:Starting iteration 27

Steps executed: 253 Episode length: 74 Return: -198.79230913159637428
INFO:tensorflow:Average training steps per second: 313.38
I0903 00:19:24.160072 140006414895104 replay_runner.py:36] Average training steps per second: 313.38
I0903 00:19:24.350735 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.74
INFO:tensorflow:Starting iteration 28

Steps executed: 221 Episode length: 69 Return: -570.10537449708943428
INFO:tensorflow:Average training steps per second: 321.04
I0903 00:19:30.625228 140006414895104 replay_runner.py:36] Average training steps per second: 321.04
I0903 00:19:30.751792 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.00
INFO:tensorflow:Starting iteration 29

Steps executed: 323 Episode length: 195 Return: -760.3238178835629428
INFO:tensorflow:Average training steps per second: 323.80
I0903 00:19:37.134951 140006414895104 replay_runner.py:36] Average training steps per second: 323.80

Done fixed training!Episode length: 195 Return: -760.3238178835629428