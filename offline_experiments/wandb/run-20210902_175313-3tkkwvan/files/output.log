Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0902 17:53:20.153799 140196143368192 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:20.165730 140196143368192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:20.166138 140196143368192 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:20.166366 140196143368192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:20.166534 140196143368192 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:20.166724 140196143368192 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:20.166914 140196143368192 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:20.167157 140196143368192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:20.167315 140196143368192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:20.167452 140196143368192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:20.167569 140196143368192 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:20.167697 140196143368192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:20.167994 140196143368192 dqn_agent.py:283] 	 seed: 1630605200165465
I0902 17:53:20.170630 140196143368192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:20.170751 140196143368192 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:20.170840 140196143368192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:20.170914 140196143368192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:20.170972 140196143368192 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:20.171024 140196143368192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:20.171098 140196143368192 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:20.171151 140196143368192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:20.171201 140196143368192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:20.217404 140196143368192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:20.759257 140196143368192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:20.775043 140196143368192 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:20.784661 140196143368192 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:20.784924 140196143368192 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:20.785077 140196143368192 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:20.785208 140196143368192 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:20.785329 140196143368192 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:20.785458 140196143368192 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:20.785581 140196143368192 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:20.785735 140196143368192 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:20.785858 140196143368192 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:20.785982 140196143368192 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:20.786106 140196143368192 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:20.786228 140196143368192 dqn_agent.py:283] 	 seed: 1630605200784603
I0902 17:53:20.789190 140196143368192 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:20.789436 140196143368192 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:20.789576 140196143368192 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:20.789716 140196143368192 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:20.789889 140196143368192 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:20.790098 140196143368192 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:20.790302 140196143368192 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:20.790600 140196143368192 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:20.790734 140196143368192 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:20.825461 140196143368192 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:20.848488 140196143368192 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:20.848756 140196143368192 replay_runner.py:41] Starting iteration 0
Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 142.31
I0902 17:53:27.876048 140196143368192 replay_runner.py:36] Average training steps per second: 142.31
I0902 17:53:29.056861 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 197.21
I0902 17:53:34.320016 140196143368192 replay_runner.py:36] Average training steps per second: 197.21
I0902 17:53:34.455368 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 206.66
I0902 17:53:39.473969 140196143368192 replay_runner.py:36] Average training steps per second: 206.66
I0902 17:53:39.602245 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 3

Steps executed: 218 Episode length: 36 Return: 36.0
INFO:tensorflow:Average training steps per second: 199.94
I0902 17:53:44.782700 140196143368192 replay_runner.py:36] Average training steps per second: 199.94
I0902 17:53:44.909469 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 43.60
INFO:tensorflow:Starting iteration 4


Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 201.23
I0902 17:53:50.060678 140196143368192 replay_runner.py:36] Average training steps per second: 201.23
I0902 17:53:50.198356 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 5

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 191.78
I0902 17:53:55.594015 140196143368192 replay_runner.py:36] Average training steps per second: 191.78
I0902 17:53:55.731168 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 6
I0902 17:53:55.920014 140196143368192 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.40
I0902 17:54:01.012191 140196143368192 replay_runner.py:36] Average training steps per second: 196.40
I0902 17:54:01.150801 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 7

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 193.99
I0902 17:54:06.507933 140196143368192 replay_runner.py:36] Average training steps per second: 193.99
I0902 17:54:06.633416 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 8

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 194.19
I0902 17:54:11.985763 140196143368192 replay_runner.py:36] Average training steps per second: 194.19

Steps executed: 113 Episode length: 10 Return: 10.0
INFO:tensorflow:Starting iteration 9


Steps executed: 203 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 194.41
I0902 17:54:17.459498 140196143368192 replay_runner.py:36] Average training steps per second: 194.41
I0902 17:54:17.597684 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 10

Steps executed: 207 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 190.70
I0902 17:54:23.011484 140196143368192 replay_runner.py:36] Average training steps per second: 190.70
I0902 17:54:23.155451 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 11

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 196.24
I0902 17:54:28.423989 140196143368192 replay_runner.py:36] Average training steps per second: 196.24
I0902 17:54:28.584448 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 12
I0902 17:54:28.783101 140196143368192 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 188.07
I0902 17:54:34.100818 140196143368192 replay_runner.py:36] Average training steps per second: 188.07
I0902 17:54:34.248375 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27

Steps executed: 204 Episode length: 9 Return: 9.0.0
I0902 17:54:34.447604 140196143368192 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 190.38
I0902 17:54:39.701022 140196143368192 replay_runner.py:36] Average training steps per second: 190.38
I0902 17:54:39.840290 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 14

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 187.36
I0902 17:54:45.356562 140196143368192 replay_runner.py:36] Average training steps per second: 187.36
I0902 17:54:45.494140 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 22.44
INFO:tensorflow:Starting iteration 15

Steps executed: 202 Episode length: 29 Return: 29.0
INFO:tensorflow:Average training steps per second: 191.75
I0902 17:54:50.889411 140196143368192 replay_runner.py:36] Average training steps per second: 191.75
I0902 17:54:51.029980 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.25
I0902 17:54:56.421721 140196143368192 replay_runner.py:36] Average training steps per second: 192.25
I0902 17:54:56.561869 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 17:54:56.764046 140196143368192 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 190.09

Steps executed: 378 Episode length: 186 Return: 186.0
I0902 17:55:02.280267 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 18
I0902 17:55:02.471144 140196143368192 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 192.99
I0902 17:55:07.653094 140196143368192 replay_runner.py:36] Average training steps per second: 192.99
I0902 17:55:07.907345 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 19

Steps executed: 375 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.47
I0902 17:55:13.213486 140196143368192 replay_runner.py:36] Average training steps per second: 195.47
I0902 17:55:13.460463 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 20

Steps executed: 374 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.57
I0902 17:55:18.784245 140196143368192 replay_runner.py:36] Average training steps per second: 194.57
I0902 17:55:19.022529 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 21

Steps executed: 340 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 192.56

Steps executed: 164 Episode length: 164 Return: 164.0
I0902 17:55:24.616019 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 22

Steps executed: 331 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 208.39
I0902 17:55:29.598952 140196143368192 replay_runner.py:36] Average training steps per second: 208.39
I0902 17:55:29.779615 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 23

Steps executed: 306 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 195.00
I0902 17:55:35.090184 140196143368192 replay_runner.py:36] Average training steps per second: 195.00
I0902 17:55:35.263111 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 195.79
I0902 17:55:40.546744 140196143368192 replay_runner.py:36] Average training steps per second: 195.79
I0902 17:55:40.755796 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 25

Steps executed: 338 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 195.25
I0902 17:55:46.059952 140196143368192 replay_runner.py:36] Average training steps per second: 195.25
I0902 17:55:46.282945 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.00
INFO:tensorflow:Starting iteration 26

Steps executed: 362 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 201.91
I0902 17:55:51.413683 140196143368192 replay_runner.py:36] Average training steps per second: 201.91
I0902 17:55:51.546485 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.35
I0902 17:55:56.719105 140196143368192 replay_runner.py:36] Average training steps per second: 200.35
I0902 17:55:56.954204 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 28


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.45
I0902 17:56:02.262866 140196143368192 replay_runner.py:36] Average training steps per second: 195.45
I0902 17:56:02.392616 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 216.29
I0902 17:56:07.198022 140196143368192 replay_runner.py:36] Average training steps per second: 216.29
I0902 17:56:07.337376 140196143368192 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00