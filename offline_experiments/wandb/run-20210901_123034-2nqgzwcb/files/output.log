Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 12:30:40.773574 140457859885056 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:40.784508 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:40.784872 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:40.785059 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:40.785206 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:40.785327 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:40.785443 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:30:40.785582 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:40.785657 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:40.785723 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:40.785787 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:40.785859 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:40.785924 140457859885056 dqn_agent.py:283] 	 seed: 1630499440784435
I0901 12:30:40.789381 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:40.789707 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:30:40.789868 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:40.790004 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:40.790202 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:40.790301 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:40.790533 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:40.791061 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:40.791301 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:40.833688 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:41.424315 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:41.439918 140457859885056 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:41.451328 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:41.451640 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:41.451826 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:41.451964 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:41.452044 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:41.452147 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:30:41.452269 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:41.452389 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:41.452617 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:41.452792 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:41.452934 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:41.453105 140457859885056 dqn_agent.py:283] 	 seed: 1630499441451262
I0901 12:30:41.456453 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:41.456633 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:30:41.456749 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:41.456901 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:41.457194 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:41.457304 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:41.457408 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:41.457485 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:41.457615 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:41.496126 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:41.519632 140457859885056 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:41.519884 140457859885056 replay_runner.py:41] Starting iteration 0
Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 141.09
I0901 12:30:48.607834 140457859885056 replay_runner.py:36] Average training steps per second: 141.09
I0901 12:30:49.719060 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 207.15
I0901 12:30:54.732208 140457859885056 replay_runner.py:36] Average training steps per second: 207.15
I0901 12:30:54.875664 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 2

Steps executed: 223 Episode length: 78 Return: 78.0
INFO:tensorflow:Average training steps per second: 205.16
I0901 12:30:59.928861 140457859885056 replay_runner.py:36] Average training steps per second: 205.16
I0901 12:31:00.084811 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.33
INFO:tensorflow:Starting iteration 3

Steps executed: 224 Episode length: 59 Return: 59.0
INFO:tensorflow:Average training steps per second: 209.05
I0901 12:31:05.054693 140457859885056 replay_runner.py:36] Average training steps per second: 209.05
I0901 12:31:05.213865 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 56.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.16
I0901 12:31:10.414664 140457859885056 replay_runner.py:36] Average training steps per second: 199.16
I0901 12:31:10.559628 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 223 Episode length: 63 Return: 63.0.0
INFO:tensorflow:Average training steps per second: 199.15
I0901 12:31:15.764600 140457859885056 replay_runner.py:36] Average training steps per second: 199.15
I0901 12:31:15.913985 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.33
INFO:tensorflow:Starting iteration 6

Steps executed: 285 Episode length: 91 Return: 91.0.0
INFO:tensorflow:Average training steps per second: 198.03
I0901 12:31:21.148413 140457859885056 replay_runner.py:36] Average training steps per second: 198.03
I0901 12:31:21.340773 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.00
INFO:tensorflow:Starting iteration 7

Steps executed: 235 Episode length: 67 Return: 67.0.0
INFO:tensorflow:Average training steps per second: 206.62
I0901 12:31:26.375710 140457859885056 replay_runner.py:36] Average training steps per second: 206.62
I0901 12:31:26.532628 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 78.33
INFO:tensorflow:Starting iteration 8

Steps executed: 225 Episode length: 70 Return: 70.0.0
INFO:tensorflow:Average training steps per second: 203.73
I0901 12:31:31.632812 140457859885056 replay_runner.py:36] Average training steps per second: 203.73
I0901 12:31:31.784026 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 75.00
INFO:tensorflow:Starting iteration 9

Steps executed: 223 Episode length: 66 Return: 66.0.0
INFO:tensorflow:Average training steps per second: 203.26
I0901 12:31:36.913791 140457859885056 replay_runner.py:36] Average training steps per second: 203.26
I0901 12:31:37.073370 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.33
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 56 Return: 56.0.0
INFO:tensorflow:Average training steps per second: 205.11
I0901 12:31:42.164337 140457859885056 replay_runner.py:36] Average training steps per second: 205.11
I0901 12:31:42.318794 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 60.00
INFO:tensorflow:Starting iteration 11

Steps executed: 229 Episode length: 102 Return: 102.0
INFO:tensorflow:Average training steps per second: 200.48
I0901 12:31:47.491873 140457859885056 replay_runner.py:36] Average training steps per second: 200.48
I0901 12:31:47.644540 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 12

Steps executed: 346 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 200.37
I0901 12:31:52.825847 140457859885056 replay_runner.py:36] Average training steps per second: 200.37
I0901 12:31:53.074137 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 13

Steps executed: 212 Episode length: 67 Return: 67.0.0
INFO:tensorflow:Average training steps per second: 190.57
I0901 12:31:58.503391 140457859885056 replay_runner.py:36] Average training steps per second: 190.57
I0901 12:31:58.655169 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.67
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.41
I0901 12:32:03.991737 140457859885056 replay_runner.py:36] Average training steps per second: 194.41
I0901 12:32:04.139692 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 12:32:04.341836 140457859885056 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 195.41
I0901 12:32:09.459668 140457859885056 replay_runner.py:36] Average training steps per second: 195.41
I0901 12:32:09.595139 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 320 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 190.88
I0901 12:32:15.026563 140457859885056 replay_runner.py:36] Average training steps per second: 190.88
I0901 12:32:15.251278 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 17
I0901 12:32:15.445764 140457859885056 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.71
I0901 12:32:20.453649 140457859885056 replay_runner.py:36] Average training steps per second: 199.71
I0901 12:32:20.671514 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.00
INFO:tensorflow:Starting iteration 18


Steps executed: 296 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 192.34
I0901 12:32:26.056908 140457859885056 replay_runner.py:36] Average training steps per second: 192.34
I0901 12:32:26.250777 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 19

Steps executed: 302 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 194.89
I0901 12:32:31.573235 140457859885056 replay_runner.py:36] Average training steps per second: 194.89
I0901 12:32:31.791296 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 20
I0901 12:32:31.989177 140457859885056 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.11

Steps executed: 277 Episode length: 138 Return: 138.0
I0901 12:32:37.285919 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 21

Steps executed: 315 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 191.71
I0901 12:32:42.675976 140457859885056 replay_runner.py:36] Average training steps per second: 191.71
I0901 12:32:42.896889 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 22

Steps executed: 308 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 195.67
I0901 12:32:48.202508 140457859885056 replay_runner.py:36] Average training steps per second: 195.67
I0901 12:32:48.435693 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 23

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.35
I0901 12:32:53.844336 140457859885056 replay_runner.py:36] Average training steps per second: 191.35
I0901 12:32:54.121534 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 24

Steps executed: 300 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 193.42
I0901 12:32:59.479285 140457859885056 replay_runner.py:36] Average training steps per second: 193.42
I0901 12:32:59.688400 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.11
I0901 12:33:04.879858 140457859885056 replay_runner.py:36] Average training steps per second: 200.11
I0901 12:33:05.019760 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 364 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 193.76
I0901 12:33:10.377832 140457859885056 replay_runner.py:36] Average training steps per second: 193.76
I0901 12:33:10.642279 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.76
I0901 12:33:16.021315 140457859885056 replay_runner.py:36] Average training steps per second: 193.76
I0901 12:33:16.169086 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:33:16.368649 140457859885056 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 191.44
I0901 12:33:21.592761 140457859885056 replay_runner.py:36] Average training steps per second: 191.44
I0901 12:33:21.726179 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 12:33:21.914520 140457859885056 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 196.78

Done fixed training!Episode length: 200 Return: 200.0
I0901 12:33:27.150086 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00