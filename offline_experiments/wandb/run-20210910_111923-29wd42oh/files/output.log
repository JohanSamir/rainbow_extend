Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
Steps executed: 118 Episode length: 118 Return: -118.0
I0910 11:19:29.248714 140336719366144 run_experiment.py:549] Creating TrainRunner ...
I0910 11:19:29.255499 140336719366144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:29.255644 140336719366144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:29.255725 140336719366144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:29.255785 140336719366144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:29.255853 140336719366144 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:29.255935 140336719366144 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:29.256022 140336719366144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:29.256086 140336719366144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:29.256163 140336719366144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:29.256251 140336719366144 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:29.256358 140336719366144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:29.256427 140336719366144 dqn_agent.py:283] 	 seed: 1631272769255461
I0910 11:19:29.258184 140336719366144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:29.258304 140336719366144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:29.258384 140336719366144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:29.258448 140336719366144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:29.258506 140336719366144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:29.258562 140336719366144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:29.258634 140336719366144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:29.258702 140336719366144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:29.258765 140336719366144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:29.283718 140336719366144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:29.303509 140336719366144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:29.303678 140336719366144 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:29.303758 140336719366144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:29.303833 140336719366144 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:29.303890 140336719366144 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:29.303944 140336719366144 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:29.303995 140336719366144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:29.304075 140336719366144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:29.304140 140336719366144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:29.304188 140336719366144 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:29.304256 140336719366144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:29.304385 140336719366144 dqn_agent.py:283] 	 seed: 1631272769303470
I0910 11:19:29.305857 140336719366144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:29.305967 140336719366144 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:29.306054 140336719366144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:29.306163 140336719366144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:29.306223 140336719366144 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:29.306298 140336719366144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:29.306356 140336719366144 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:29.306430 140336719366144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:29.306498 140336719366144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:29.326642 140336719366144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:29.342110 140336719366144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:19:29.342288 140336719366144 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 814111.80
I0910 11:19:29.343636 140336719366144 replay_runner.py:39] Average training steps per second: 814111.80
I0910 11:19:30.401761 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 1
I0910 11:19:30.468087 140336719366144 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 411327.25
I0910 11:19:30.470995 140336719366144 replay_runner.py:39] Average training steps per second: 411327.25
I0910 11:19:30.546279 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 2
I0910 11:19:30.585636 140336719366144 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 787662.72
I0910 11:19:30.587128 140336719366144 replay_runner.py:39] Average training steps per second: 787662.72
I0910 11:19:30.654578 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 3
I0910 11:19:30.694103 140336719366144 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 801970.17
I0910 11:19:30.695566 140336719366144 replay_runner.py:39] Average training steps per second: 801970.17

Steps executed: 242 Episode length: 120 Return: -120.0
INFO:tensorflow:Starting iteration 4
I0910 11:19:30.809115 140336719366144 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 334234.12
I0910 11:19:30.812473 140336719366144 replay_runner.py:39] Average training steps per second: 334234.12
I0910 11:19:31.005233 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 5
I0910 11:19:31.064438 140336719366144 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 475598.59
I0910 11:19:31.066975 140336719366144 replay_runner.py:39] Average training steps per second: 475598.59
I0910 11:19:31.188196 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 6
I0910 11:19:31.279923 140336719366144 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 453144.34
I0910 11:19:31.282443 140336719366144 replay_runner.py:39] Average training steps per second: 453144.34
I0910 11:19:31.398394 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 7
I0910 11:19:31.439020 140336719366144 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 775000.74
I0910 11:19:31.440567 140336719366144 replay_runner.py:39] Average training steps per second: 775000.74
I0910 11:19:31.538550 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 8
I0910 11:19:31.622055 140336719366144 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 385045.81
I0910 11:19:31.625093 140336719366144 replay_runner.py:39] Average training steps per second: 385045.81
I0910 11:19:31.705404 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 9
I0910 11:19:31.749873 140336719366144 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 348075.02
I0910 11:19:31.753246 140336719366144 replay_runner.py:39] Average training steps per second: 348075.02
I0910 11:19:31.906806 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 10
I0910 11:19:31.948551 140336719366144 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 763433.56
I0910 11:19:31.950117 140336719366144 replay_runner.py:39] Average training steps per second: 763433.56
I0910 11:19:32.220380 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:19:32.263010 140336719366144 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 334554.04
I0910 11:19:32.266405 140336719366144 replay_runner.py:39] Average training steps per second: 334554.04
I0910 11:19:32.415046 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 12
I0910 11:19:32.476107 140336719366144 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 399876.44
I0910 11:19:32.478963 140336719366144 replay_runner.py:39] Average training steps per second: 399876.44
I0910 11:19:32.588129 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 13
I0910 11:19:32.643772 140336719366144 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 420144.65
I0910 11:19:32.646494 140336719366144 replay_runner.py:39] Average training steps per second: 420144.65
I0910 11:19:32.730042 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 14
I0910 11:19:32.772127 140336719366144 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 741698.32

Steps executed: 243 Episode length: 121 Return: -121.0
I0910 11:19:32.854373 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 15
I0910 11:19:32.895143 140336719366144 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 845114.65
I0910 11:19:32.896550 140336719366144 replay_runner.py:39] Average training steps per second: 845114.65
I0910 11:19:32.964820 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 16
I0910 11:19:33.006081 140336719366144 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 777442.82
I0910 11:19:33.007604 140336719366144 replay_runner.py:39] Average training steps per second: 777442.82
I0910 11:19:33.077575 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 17
I0910 11:19:33.118757 140336719366144 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 772716.29
I0910 11:19:33.120320 140336719366144 replay_runner.py:39] Average training steps per second: 772716.29
I0910 11:19:33.303841 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:19:33.354686 140336719366144 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 789293.19
I0910 11:19:33.356193 140336719366144 replay_runner.py:39] Average training steps per second: 789293.19
I0910 11:19:33.526262 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:19:33.569325 140336719366144 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 337271.15
I0910 11:19:33.572647 140336719366144 replay_runner.py:39] Average training steps per second: 337271.15
I0910 11:19:33.869594 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.50
INFO:tensorflow:Starting iteration 20
I0910 11:19:33.910451 140336719366144 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 835185.98
I0910 11:19:33.911904 140336719366144 replay_runner.py:39] Average training steps per second: 835185.98
I0910 11:19:33.984478 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 21
I0910 11:19:34.043914 140336719366144 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 398168.22
I0910 11:19:34.046732 140336719366144 replay_runner.py:39] Average training steps per second: 398168.22
I0910 11:19:34.146426 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 22
I0910 11:19:34.190786 140336719366144 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 677484.09
I0910 11:19:34.192506 140336719366144 replay_runner.py:39] Average training steps per second: 677484.09
I0910 11:19:34.281852 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.00
INFO:tensorflow:Starting iteration 23
I0910 11:19:34.325155 140336719366144 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 746450.26
I0910 11:19:34.326736 140336719366144 replay_runner.py:39] Average training steps per second: 746450.26
I0910 11:19:34.564037 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.00
INFO:tensorflow:Starting iteration 24
I0910 11:19:34.604903 140336719366144 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 811905.54
I0910 11:19:34.606363 140336719366144 replay_runner.py:39] Average training steps per second: 811905.54
I0910 11:19:34.675355 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 25
I0910 11:19:34.717949 140336719366144 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 770728.41

Done fixed training!Episode length: 123 Return: -123.0
I0910 11:19:34.908133 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:19:34.950771 140336719366144 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 765383.94
I0910 11:19:34.952322 140336719366144 replay_runner.py:39] Average training steps per second: 765383.94
I0910 11:19:35.020492 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 27
I0910 11:19:35.061908 140336719366144 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 658963.71
I0910 11:19:35.063832 140336719366144 replay_runner.py:39] Average training steps per second: 658963.71
I0910 11:19:35.130898 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 28
I0910 11:19:35.172665 140336719366144 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 773001.11
I0910 11:19:35.174210 140336719366144 replay_runner.py:39] Average training steps per second: 773001.11
I0910 11:19:35.415499 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.00
INFO:tensorflow:Starting iteration 29
I0910 11:19:35.456857 140336719366144 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 753422.67
I0910 11:19:35.458428 140336719366144 replay_runner.py:39] Average training steps per second: 753422.67
I0910 11:19:35.535545 140336719366144 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50