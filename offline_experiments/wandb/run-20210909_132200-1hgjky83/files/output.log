Loaded trained dqn in mountaincar
Training fixed agent 5, please be patient, may be a while...
I0909 13:22:06.063264 139651903387648 run_experiment.py:549] Creating TrainRunner ...
I0909 13:22:06.068520 139651903387648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:06.068647 139651903387648 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:06.068707 139651903387648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:06.068763 139651903387648 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:06.068814 139651903387648 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:06.068863 139651903387648 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:06.068931 139651903387648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:06.069039 139651903387648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:06.069089 139651903387648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:06.069148 139651903387648 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:06.069218 139651903387648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:06.069279 139651903387648 dqn_agent.py:283] 	 seed: 1631193726068490
I0909 13:22:06.070640 139651903387648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:06.070736 139651903387648 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:06.070811 139651903387648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:06.070904 139651903387648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:06.070959 139651903387648 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:06.071016 139651903387648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:06.071085 139651903387648 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:06.071153 139651903387648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:06.071221 139651903387648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:06.320888 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:06.457449 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:06.464911 139651903387648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:22:06.469227 139651903387648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:06.469338 139651903387648 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:06.469400 139651903387648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:06.469450 139651903387648 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:06.469526 139651903387648 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:06.469595 139651903387648 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:06.469671 139651903387648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:06.469729 139651903387648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:06.469786 139651903387648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:06.469846 139651903387648 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:06.469915 139651903387648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:06.469994 139651903387648 dqn_agent.py:283] 	 seed: 1631193726469204
I0909 13:22:06.471291 139651903387648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:06.471401 139651903387648 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:06.471470 139651903387648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:06.471532 139651903387648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:06.471591 139651903387648 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:06.471683 139651903387648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:06.471752 139651903387648 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:06.471817 139651903387648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:06.471880 139651903387648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:06.488430 139651903387648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:06.498967 139651903387648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:22:06.499123 139651903387648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 213.21
I0909 13:22:11.189534 139651903387648 replay_runner.py:36] Average training steps per second: 213.21
I0909 13:22:12.107199 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:22:12.187759 139651903387648 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 270.90
I0909 13:22:15.879616 139651903387648 replay_runner.py:36] Average training steps per second: 270.90
I0909 13:22:16.116102 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:22:16.204481 139651903387648 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 270.05
I0909 13:22:19.907730 139651903387648 replay_runner.py:36] Average training steps per second: 270.05
I0909 13:22:20.140860 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:22:20.226469 139651903387648 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 257.54
I0909 13:22:24.109646 139651903387648 replay_runner.py:36] Average training steps per second: 257.54
I0909 13:22:24.347514 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:22:24.436239 139651903387648 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 267.35
I0909 13:22:28.177043 139651903387648 replay_runner.py:36] Average training steps per second: 267.35
I0909 13:22:28.417694 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:22:28.513751 139651903387648 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 266.95
I0909 13:22:32.260221 139651903387648 replay_runner.py:36] Average training steps per second: 266.95
I0909 13:22:32.505066 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:22:32.595688 139651903387648 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 267.29
I0909 13:22:36.337359 139651903387648 replay_runner.py:36] Average training steps per second: 267.29
I0909 13:22:36.572935 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 265 Episode length: 87 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 264.90
I0909 13:22:40.435712 139651903387648 replay_runner.py:36] Average training steps per second: 264.90
I0909 13:22:40.554474 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 8

Steps executed: 764 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 263.96
I0909 13:22:44.434268 139651903387648 replay_runner.py:36] Average training steps per second: 263.96
I0909 13:22:44.741039 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.00
INFO:tensorflow:Starting iteration 9

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.38
I0909 13:22:48.600667 139651903387648 replay_runner.py:36] Average training steps per second: 265.38
I0909 13:22:48.841139 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:22:48.933404 139651903387648 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 263.92
I0909 13:22:52.722882 139651903387648 replay_runner.py:36] Average training steps per second: 263.92
I0909 13:22:52.971499 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:22:53.063044 139651903387648 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 265.42
I0909 13:22:56.831054 139651903387648 replay_runner.py:36] Average training steps per second: 265.42
I0909 13:22:57.076591 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 683 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.07
I0909 13:23:00.953442 139651903387648 replay_runner.py:36] Average training steps per second: 264.07
I0909 13:23:01.244539 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.50
INFO:tensorflow:Starting iteration 13

Steps executed: 213 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 258.09
I0909 13:23:05.233408 139651903387648 replay_runner.py:36] Average training steps per second: 258.09
I0909 13:23:05.326422 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 14

Steps executed: 211 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 264.79
I0909 13:23:09.194922 139651903387648 replay_runner.py:36] Average training steps per second: 264.79
I0909 13:23:09.284756 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.57
I0909 13:23:13.159719 139651903387648 replay_runner.py:36] Average training steps per second: 265.57
I0909 13:23:13.400015 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 227 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 267.34
I0909 13:23:17.233266 139651903387648 replay_runner.py:36] Average training steps per second: 267.34
I0909 13:23:17.319738 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 17

Steps executed: 233 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 265.97
I0909 13:23:21.171475 139651903387648 replay_runner.py:36] Average training steps per second: 265.97
I0909 13:23:21.271523 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 18

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 255.58
I0909 13:23:25.274874 139651903387648 replay_runner.py:36] Average training steps per second: 255.58
I0909 13:23:25.515052 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19

Steps executed: 212 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 251.47
I0909 13:23:29.587036 139651903387648 replay_runner.py:36] Average training steps per second: 251.47
I0909 13:23:29.672094 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 260.74
I0909 13:23:33.598256 139651903387648 replay_runner.py:36] Average training steps per second: 260.74
I0909 13:23:33.678715 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 21

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 258.61
I0909 13:23:37.638019 139651903387648 replay_runner.py:36] Average training steps per second: 258.61
I0909 13:23:37.881449 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22

Steps executed: 220 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 264.72
I0909 13:23:41.754830 139651903387648 replay_runner.py:36] Average training steps per second: 264.72
I0909 13:23:41.852337 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 23

Steps executed: 234 Episode length: 125 Return: -125.0
INFO:tensorflow:Average training steps per second: 263.31
I0909 13:23:45.760849 139651903387648 replay_runner.py:36] Average training steps per second: 263.31
I0909 13:23:45.865435 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 24

Steps executed: 231 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 261.10
I0909 13:23:49.790776 139651903387648 replay_runner.py:36] Average training steps per second: 261.10
I0909 13:23:49.885615 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 25

Steps executed: 244 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 264.45
I0909 13:23:53.757877 139651903387648 replay_runner.py:36] Average training steps per second: 264.45
I0909 13:23:53.857734 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 26

Steps executed: 249 Episode length: 125 Return: -125.0
INFO:tensorflow:Average training steps per second: 267.53
I0909 13:23:57.688158 139651903387648 replay_runner.py:36] Average training steps per second: 267.53
I0909 13:23:57.793142 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 268.52
I0909 13:24:01.610940 139651903387648 replay_runner.py:36] Average training steps per second: 268.52
I0909 13:24:01.708099 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 28

Steps executed: 328 Episode length: 169 Return: -169.0
INFO:tensorflow:Average training steps per second: 267.78
I0909 13:24:05.542376 139651903387648 replay_runner.py:36] Average training steps per second: 267.78
I0909 13:24:05.681958 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 129 Return: -129.0
INFO:tensorflow:Average training steps per second: 270.39
I0909 13:24:09.472160 139651903387648 replay_runner.py:36] Average training steps per second: 270.39
I0909 13:24:09.565938 139651903387648 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00