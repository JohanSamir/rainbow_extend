Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 11:31:17.090896 139669628516352 run_experiment.py:549] Creating TrainRunner ...
I0902 11:31:17.098143 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:17.098289 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:17.098371 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:17.098439 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:17.098513 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:17.098623 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:17.098815 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:17.098952 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:17.099072 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:17.099151 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:17.099221 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:17.099303 139669628516352 dqn_agent.py:283] 	 seed: 1630582277098090
I0902 11:31:17.101125 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:17.101256 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:17.101341 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:17.101422 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:17.101482 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:17.101586 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:17.101658 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:17.101729 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:17.101799 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:17.246088 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:17.447816 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:17.456165 139669628516352 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:31:17.461275 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:31:17.461413 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:31:17.461475 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:31:17.461517 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:31:17.461566 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:31:17.461611 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:31:17.461656 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:31:17.461715 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:31:17.461787 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:31:17.461853 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:31:17.461917 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:31:17.461982 139669628516352 dqn_agent.py:283] 	 seed: 1630582277461246
I0902 11:31:17.463210 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:31:17.463314 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:31:17.463363 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:31:17.463407 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:31:17.463458 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:31:17.463527 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:31:17.463603 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:31:17.463669 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:31:17.463728 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:31:17.490073 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:31:17.505067 139669628516352 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:31:17.505184 139669628516352 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 197.12
I0902 11:31:22.578376 139669628516352 replay_runner.py:36] Average training steps per second: 197.12
Steps executed: 230 Episode length: 230 Return: -195.05216679591535
I0902 11:31:23.369298 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.05
INFO:tensorflow:Starting iteration 1

Steps executed: 231 Episode length: 231 Return: -79.997483127685535
INFO:tensorflow:Average training steps per second: 329.12
I0902 11:31:29.575109 139669628516352 replay_runner.py:36] Average training steps per second: 329.12
I0902 11:31:29.732532 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 2
I0902 11:31:33.034636 139669628516352 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 322.76

Steps executed: 803 Episode length: 803 Return: -425.13901514991895
I0902 11:31:37.322819 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.14
INFO:tensorflow:Starting iteration 3

Steps executed: 458 Episode length: 458 Return: -294.08176250606135
INFO:tensorflow:Average training steps per second: 325.08
I0902 11:31:43.839475 139669628516352 replay_runner.py:36] Average training steps per second: 325.08
I0902 11:31:44.309667 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.08
INFO:tensorflow:Starting iteration 4
I0902 11:31:47.700630 139669628516352 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 309.69

Steps executed: 1000 Episode length: 1000 Return: -118.17649238127886
I0902 11:31:53.102917 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.18
INFO:tensorflow:Starting iteration 5
I0902 11:31:56.513775 139669628516352 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 315.90

Steps executed: 1000 Episode length: 1000 Return: -149.82565576467756
I0902 11:32:01.603277 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.83
INFO:tensorflow:Starting iteration 6

Steps executed: 458 Episode length: 458 Return: -331.5876524911825556
INFO:tensorflow:Average training steps per second: 322.98
I0902 11:32:08.071674 139669628516352 replay_runner.py:36] Average training steps per second: 322.98
I0902 11:32:08.598631 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.59
INFO:tensorflow:Starting iteration 7
I0902 11:32:11.975452 139669628516352 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 328.64

Steps executed: 344 Episode length: 147 Return: -42.93018601027244556
I0902 11:32:15.248870 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.41
INFO:tensorflow:Starting iteration 8
I0902 11:32:18.585611 139669628516352 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 322.46

Steps executed: 1000 Episode length: 1000 Return: -232.18482521831896
I0902 11:32:24.143017 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.18
INFO:tensorflow:Starting iteration 9
I0902 11:32:27.602630 139669628516352 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 342.10

Steps executed: 1000 Episode length: 1000 Return: -119.36000448217867
I0902 11:32:33.404892 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.36
INFO:tensorflow:Starting iteration 10
I0902 11:32:36.717200 139669628516352 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 318.08

Steps executed: 883 Episode length: 883 Return: 158.71442106680075867
I0902 11:32:41.402376 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.71
INFO:tensorflow:Starting iteration 11

Steps executed: 442 Episode length: 442 Return: -238.6602689318954267
INFO:tensorflow:Average training steps per second: 325.20
I0902 11:32:47.762372 139669628516352 replay_runner.py:36] Average training steps per second: 325.20
I0902 11:32:48.277048 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.66
INFO:tensorflow:Starting iteration 12
I0902 11:32:51.668615 139669628516352 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 345.36

Steps executed: 1000 Episode length: 1000 Return: -763.61485435073597
I0902 11:32:56.908478 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -763.61
INFO:tensorflow:Starting iteration 13
I0902 11:33:00.244338 139669628516352 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 311.14
I0902 11:33:03.458578 139669628516352 replay_runner.py:36] Average training steps per second: 311.14

Steps executed: 1000 Episode length: 1000 Return: -222.61834088947052
INFO:tensorflow:Starting iteration 14
I0902 11:33:08.598218 139669628516352 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 309.53
I0902 11:33:11.829208 139669628516352 replay_runner.py:36] Average training steps per second: 309.53

Steps executed: 1000 Episode length: 1000 Return: -89.462798059817542
INFO:tensorflow:Starting iteration 15

Steps executed: 314 Episode length: 314 Return: -69.72149890735477542
INFO:tensorflow:Average training steps per second: 326.46
I0902 11:33:19.933134 139669628516352 replay_runner.py:36] Average training steps per second: 326.46
I0902 11:33:20.253623 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.72
INFO:tensorflow:Starting iteration 16
I0902 11:33:23.599860 139669628516352 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 322.80

Steps executed: 1000 Episode length: 1000 Return: -94.963674391985262
I0902 11:33:28.803319 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.96
INFO:tensorflow:Starting iteration 17
I0902 11:33:32.276987 139669628516352 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 322.27

Steps executed: 1000 Episode length: 1000 Return: -182.59844181354958
I0902 11:33:37.751456 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.60
INFO:tensorflow:Starting iteration 18
I0902 11:33:41.314165 139669628516352 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 350.68

Steps executed: 1000 Episode length: 1000 Return: -39.640722054304778
I0902 11:33:46.409799 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -39.64
INFO:tensorflow:Starting iteration 19
I0902 11:33:49.793115 139669628516352 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 345.93

Steps executed: 1000 Episode length: 1000 Return: -68.913658585124428
I0902 11:33:54.419113 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -68.91
INFO:tensorflow:Starting iteration 20
I0902 11:33:57.779537 139669628516352 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 336.03
I0902 11:34:00.755809 139669628516352 replay_runner.py:36] Average training steps per second: 336.03

Steps executed: 384 Episode length: 384 Return: -38.48058401121651428
INFO:tensorflow:Starting iteration 21

Steps executed: 592 Episode length: 592 Return: 248.93456175681328428
INFO:tensorflow:Average training steps per second: 342.21
I0902 11:34:07.604521 139669628516352 replay_runner.py:36] Average training steps per second: 342.21
I0902 11:34:08.352641 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 248.93
INFO:tensorflow:Starting iteration 22
I0902 11:34:11.874141 139669628516352 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 336.18

Steps executed: 1000 Episode length: 1000 Return: 118.090489325235018
I0902 11:34:16.526571 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.09
INFO:tensorflow:Starting iteration 23

Steps executed: 349 Episode length: 349 Return: 233.88773698653233018
INFO:tensorflow:Average training steps per second: 352.87
I0902 11:34:22.947250 139669628516352 replay_runner.py:36] Average training steps per second: 352.87
I0902 11:34:23.254473 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 233.89
INFO:tensorflow:Starting iteration 24

Steps executed: 239 Episode length: 239 Return: -340.8689628498783018
INFO:tensorflow:Average training steps per second: 349.98
I0902 11:34:29.674196 139669628516352 replay_runner.py:36] Average training steps per second: 349.98
I0902 11:34:29.842512 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.87
INFO:tensorflow:Starting iteration 25
I0902 11:34:33.273536 139669628516352 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 318.41

Steps executed: 911 Episode length: 911 Return: 155.52577342835684018
I0902 11:34:37.835615 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.53
INFO:tensorflow:Starting iteration 26

Steps executed: 264 Episode length: 194 Return: -132.4582081673227418
INFO:tensorflow:Average training steps per second: 342.61
I0902 11:34:44.180363 139669628516352 replay_runner.py:36] Average training steps per second: 342.61
I0902 11:34:44.318797 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.84
INFO:tensorflow:Starting iteration 27
I0902 11:34:47.661394 139669628516352 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 342.78
I0902 11:34:50.579070 139669628516352 replay_runner.py:36] Average training steps per second: 342.78

Steps executed: 638 Episode length: 638 Return: 223.01745634439573418
INFO:tensorflow:Starting iteration 28

Steps executed: 1000 Episode length: 1000 Return: 95.8348715581174618
INFO:tensorflow:Average training steps per second: 344.08
I0902 11:34:57.894903 139669628516352 replay_runner.py:36] Average training steps per second: 344.08
I0902 11:34:59.460285 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 95.83
INFO:tensorflow:Starting iteration 29
I0902 11:35:02.890677 139669628516352 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 383.78

Steps executed: 976 Episode length: 976 Return: -402.4755687383032618

Done fixed training!Episode length: 976 Return: -402.4755687383032618