I0905 16:42:13.152442 139967707396096 run_experiment.py:549] Creating TrainRunner ...
I0905 16:42:13.162317 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:13.162457 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:13.162531 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:13.162593 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:13.162648 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:13.162795 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:13.162871 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:13.162950 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:13.163031 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:13.163097 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:13.163160 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:13.163227 139967707396096 dqn_agent.py:283] 	 seed: 1630860133162282
I0905 16:42:13.164965 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:13.165078 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:13.165153 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:13.165216 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:13.165272 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:13.165329 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:13.165404 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:13.165472 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:13.165534 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:42:14.465795 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 16:42:15.282943 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:15.293346 139967707396096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:42:15.299974 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:15.300110 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:15.300186 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:15.300246 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:15.300302 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:15.300399 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:15.300481 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:15.300565 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:15.300632 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:15.300687 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:15.300759 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:15.300812 139967707396096 dqn_agent.py:283] 	 seed: 1630860135299943
I0905 16:42:15.302349 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:15.302551 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:15.302714 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:15.302864 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:15.303072 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:15.303201 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:15.303309 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:15.303406 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:15.303718 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:42:15.329292 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:15.347052 139967707396096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:42:15.347251 139967707396096 replay_runner.py:41] Starting iteration 0
Steps executed: 275 Episode length: 275 Return: -284.89890330357173
INFO:tensorflow:Average training steps per second: 179.26
I0905 16:42:20.926122 139967707396096 replay_runner.py:36] Average training steps per second: 179.26
I0905 16:42:22.092902 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.90
INFO:tensorflow:Starting iteration 1

Steps executed: 356 Episode length: 250 Return: -144.34245356586586
INFO:tensorflow:Average training steps per second: 235.69
I0905 16:42:30.259768 139967707396096 replay_runner.py:36] Average training steps per second: 235.69
I0905 16:42:30.671335 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.69
INFO:tensorflow:Starting iteration 2
I0905 16:42:34.671547 139967707396096 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 231.73

Steps executed: 1000 Episode length: 1000 Return: -187.73644590412587
I0905 16:42:41.584588 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.74
INFO:tensorflow:Starting iteration 3
I0905 16:42:45.647354 139967707396096 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 227.31

Steps executed: 1000 Episode length: 1000 Return: -108.76057997618014
I0905 16:42:53.810145 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.76
INFO:tensorflow:Starting iteration 4
I0905 16:42:58.012480 139967707396096 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 259.44

Steps executed: 1000 Episode length: 1000 Return: -257.29017529518994
I0905 16:43:05.500037 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.29
INFO:tensorflow:Starting iteration 5
I0905 16:43:09.557232 139967707396096 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 258.86

Steps executed: 1000 Episode length: 1000 Return: -394.01495780916694
I0905 16:43:16.371217 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.01
INFO:tensorflow:Starting iteration 6
I0905 16:43:20.492739 139967707396096 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 247.68

Steps executed: 1000 Episode length: 1000 Return: -287.23160494726716
I0905 16:43:26.633397 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.23
INFO:tensorflow:Starting iteration 7

Steps executed: 159 Episode length: 159 Return: -200.3179805233167716
INFO:tensorflow:Average training steps per second: 270.38

Steps executed: 763 Episode length: 604 Return: -253.9507517983840616
I0905 16:43:35.612159 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.13
INFO:tensorflow:Starting iteration 8

Steps executed: 305 Episode length: 155 Return: -119.2092223063357516
INFO:tensorflow:Average training steps per second: 254.36
I0905 16:43:43.761685 139967707396096 replay_runner.py:36] Average training steps per second: 254.36
I0905 16:43:44.076953 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.56
INFO:tensorflow:Starting iteration 9
I0905 16:43:48.239416 139967707396096 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 254.90

Steps executed: 901 Episode length: 901 Return: -336.9086834089325516
I0905 16:43:54.898895 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.91
INFO:tensorflow:Starting iteration 10

Steps executed: 321 Episode length: 183 Return: -256.8367633157713516
INFO:tensorflow:Average training steps per second: 269.54
I0905 16:44:02.844278 139967707396096 replay_runner.py:36] Average training steps per second: 269.54
I0905 16:44:03.138184 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.45
INFO:tensorflow:Starting iteration 11

Steps executed: 271 Episode length: 271 Return: -163.0959725476727216
INFO:tensorflow:Average training steps per second: 246.76
I0905 16:44:11.513566 139967707396096 replay_runner.py:36] Average training steps per second: 246.76
I0905 16:44:11.805781 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.10
INFO:tensorflow:Starting iteration 12

Steps executed: 221 Episode length: 135 Return: -106.8591748400728716
INFO:tensorflow:Average training steps per second: 235.21
I0905 16:44:20.035301 139967707396096 replay_runner.py:36] Average training steps per second: 235.21
I0905 16:44:20.243593 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.43
INFO:tensorflow:Starting iteration 13

Steps executed: 550 Episode length: 550 Return: -375.7566940570420716
INFO:tensorflow:Average training steps per second: 231.70
I0905 16:44:28.329927 139967707396096 replay_runner.py:36] Average training steps per second: 231.70
I0905 16:44:29.227555 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.76
INFO:tensorflow:Starting iteration 14
I0905 16:44:33.024935 139967707396096 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 233.06

Steps executed: 1000 Episode length: 1000 Return: -166.00622621521538
I0905 16:44:40.838989 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.01
INFO:tensorflow:Starting iteration 15

Steps executed: 235 Episode length: 235 Return: -231.5591037603824738
INFO:tensorflow:Average training steps per second: 227.88
I0905 16:44:49.086687 139967707396096 replay_runner.py:36] Average training steps per second: 227.88
I0905 16:44:49.334743 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.56
INFO:tensorflow:Starting iteration 16

Steps executed: 232 Episode length: 116 Return: -221.0367423827826238
INFO:tensorflow:Average training steps per second: 239.06
I0905 16:44:57.475079 139967707396096 replay_runner.py:36] Average training steps per second: 239.06
I0905 16:44:57.725814 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.39
INFO:tensorflow:Starting iteration 17

Steps executed: 287 Episode length: 134 Return: -253.6318841813383638
INFO:tensorflow:Average training steps per second: 256.53
I0905 16:45:05.636256 139967707396096 replay_runner.py:36] Average training steps per second: 256.53
I0905 16:45:05.920542 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.04
INFO:tensorflow:Starting iteration 18

Steps executed: 342 Episode length: 189 Return: -430.1492030956135538
INFO:tensorflow:Average training steps per second: 261.76
I0905 16:45:13.969406 139967707396096 replay_runner.py:36] Average training steps per second: 261.76
I0905 16:45:14.358389 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.61
INFO:tensorflow:Starting iteration 19

Steps executed: 226 Episode length: 81 Return: -30.065112659570687738
INFO:tensorflow:Average training steps per second: 239.98
I0905 16:45:22.727190 139967707396096 replay_runner.py:36] Average training steps per second: 239.98
I0905 16:45:22.945508 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.07
INFO:tensorflow:Starting iteration 20
I0905 16:45:27.118267 139967707396096 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 254.97
I0905 16:45:31.040666 139967707396096 replay_runner.py:36] Average training steps per second: 254.97

Steps executed: 356 Episode length: 229 Return: -628.7426931623422738
INFO:tensorflow:Starting iteration 21

Steps executed: 284 Episode length: 179 Return: -65.13460226008942738
INFO:tensorflow:Average training steps per second: 232.77
I0905 16:45:39.877621 139967707396096 replay_runner.py:36] Average training steps per second: 232.77
I0905 16:45:40.182329 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.81
INFO:tensorflow:Starting iteration 22

Steps executed: 317 Episode length: 184 Return: -72.69612484651572738
INFO:tensorflow:Average training steps per second: 229.73
I0905 16:45:48.575280 139967707396096 replay_runner.py:36] Average training steps per second: 229.73
I0905 16:45:48.947433 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.52
INFO:tensorflow:Starting iteration 23
I0905 16:45:52.890643 139967707396096 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 228.51
I0905 16:45:57.267456 139967707396096 replay_runner.py:36] Average training steps per second: 228.51

Steps executed: 280 Episode length: 280 Return: -668.2570944924785738
INFO:tensorflow:Starting iteration 24

Steps executed: 401 Episode length: 318 Return: -639.5987194418617738
INFO:tensorflow:Average training steps per second: 231.14
I0905 16:46:05.774480 139967707396096 replay_runner.py:36] Average training steps per second: 231.14
I0905 16:46:06.413233 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.61
INFO:tensorflow:Starting iteration 25

Steps executed: 507 Episode length: 403 Return: 263.32291749968067838
INFO:tensorflow:Average training steps per second: 252.46
I0905 16:46:14.312708 139967707396096 replay_runner.py:36] Average training steps per second: 252.46
I0905 16:46:15.205994 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: 66.58
INFO:tensorflow:Starting iteration 26

Steps executed: 185 Episode length: 98 Return: 19.1298628891289367838
INFO:tensorflow:Average training steps per second: 261.24
I0905 16:46:22.996238 139967707396096 replay_runner.py:36] Average training steps per second: 261.24

Steps executed: 374 Episode length: 189 Return: -103.7691228674334738
INFO:tensorflow:Starting iteration 27
I0905 16:46:27.306869 139967707396096 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 250.71
I0905 16:46:31.295941 139967707396096 replay_runner.py:36] Average training steps per second: 250.71

Steps executed: 328 Episode length: 129 Return: -384.9026513065523738
INFO:tensorflow:Starting iteration 28

Steps executed: 269 Episode length: 106 Return: -193.5176119631004238
INFO:tensorflow:Average training steps per second: 227.87
I0905 16:46:39.787528 139967707396096 replay_runner.py:36] Average training steps per second: 227.87
I0905 16:46:40.061600 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -462.16
INFO:tensorflow:Starting iteration 29
I0905 16:46:43.694811 139967707396096 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 247.11
I0905 16:46:47.741982 139967707396096 replay_runner.py:36] Average training steps per second: 247.11


Done fixed training!Episode length: 107 Return: -166.5324317467892238