I0905 16:24:41.578111 140199535331328 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:41.585219 140199535331328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:41.585340 140199535331328 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:41.585412 140199535331328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:41.585472 140199535331328 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:41.585528 140199535331328 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:41.585617 140199535331328 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:41.585730 140199535331328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:41.585819 140199535331328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:41.585901 140199535331328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:41.585995 140199535331328 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:41.586055 140199535331328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:41.586126 140199535331328 dqn_agent.py:283] 	 seed: 1630859081585186
I0905 16:24:41.587707 140199535331328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:41.587818 140199535331328 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:41.587914 140199535331328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:41.587986 140199535331328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:41.588086 140199535331328 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:41.588170 140199535331328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:41.588250 140199535331328 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:41.588331 140199535331328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:41.588408 140199535331328 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:42.920081 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:43.232136 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:43.239900 140199535331328 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:43.246024 140199535331328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:43.246155 140199535331328 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:43.246237 140199535331328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:43.246296 140199535331328 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:43.246351 140199535331328 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:43.246429 140199535331328 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:43.246541 140199535331328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:43.246634 140199535331328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:43.246703 140199535331328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:43.246780 140199535331328 dqn_agent.py:280] 	 optimizer: adam
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0905 16:24:43.246843 140199535331328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:43.246894 140199535331328 dqn_agent.py:283] 	 seed: 1630859083245998
I0905 16:24:43.248489 140199535331328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:43.248599 140199535331328 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:43.248673 140199535331328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:43.248735 140199535331328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:43.248798 140199535331328 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:43.248889 140199535331328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:43.248970 140199535331328 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:43.249044 140199535331328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:43.249120 140199535331328 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:43.266655 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:43.278121 140199535331328 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:43.278267 140199535331328 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 289.70
I0905 16:24:46.730371 140199535331328 replay_runner.py:36] Average training steps per second: 289.70
Steps executed: 276 Episode length: 84 Return: -599.56190469238719
I0905 16:24:47.459281 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -495.19
INFO:tensorflow:Starting iteration 1

Steps executed: 271 Episode length: 143 Return: -180.61659611929895
INFO:tensorflow:Average training steps per second: 414.12
I0905 16:24:52.974313 140199535331328 replay_runner.py:36] Average training steps per second: 414.12
I0905 16:24:53.106830 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.49
INFO:tensorflow:Starting iteration 2

Steps executed: 279 Episode length: 147 Return: -321.42948336585055
INFO:tensorflow:Average training steps per second: 385.36
I0905 16:24:58.806566 140199535331328 replay_runner.py:36] Average training steps per second: 385.36
I0905 16:24:58.995132 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.51
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 81 Return: -242.385986061957564
INFO:tensorflow:Average training steps per second: 321.33
I0905 16:25:05.378222 140199535331328 replay_runner.py:36] Average training steps per second: 321.33
I0905 16:25:05.460576 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.62
INFO:tensorflow:Starting iteration 4
I0905 16:25:08.762941 140199535331328 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 400.87

Steps executed: 244 Episode length: 75 Return: -328.614883996975264
I0905 16:25:11.347146 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.83
INFO:tensorflow:Starting iteration 5

Steps executed: 301 Episode length: 105 Return: -215.90027014871964
INFO:tensorflow:Average training steps per second: 397.50
I0905 16:25:17.010050 140199535331328 replay_runner.py:36] Average training steps per second: 397.50
I0905 16:25:17.140362 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.03
INFO:tensorflow:Starting iteration 6

Steps executed: 234 Episode length: 70 Return: -254.796221276842894
INFO:tensorflow:Average training steps per second: 396.96
I0905 16:25:22.793912 140199535331328 replay_runner.py:36] Average training steps per second: 396.96
I0905 16:25:22.869931 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.66
INFO:tensorflow:Starting iteration 7

Steps executed: 210 Episode length: 124 Return: -197.10917501203596
INFO:tensorflow:Average training steps per second: 392.27
I0905 16:25:28.561460 140199535331328 replay_runner.py:36] Average training steps per second: 392.27
I0905 16:25:28.645689 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.35
INFO:tensorflow:Starting iteration 8

Steps executed: 614 Episode length: 525 Return: -186.54058458042437
INFO:tensorflow:Average training steps per second: 405.53
I0905 16:25:34.236623 140199535331328 replay_runner.py:36] Average training steps per second: 405.53
I0905 16:25:34.908711 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.12
INFO:tensorflow:Starting iteration 9

Steps executed: 690 Episode length: 690 Return: -196.65499928655066
INFO:tensorflow:Average training steps per second: 409.70
I0905 16:25:40.534343 140199535331328 replay_runner.py:36] Average training steps per second: 409.70
I0905 16:25:41.298222 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.65
INFO:tensorflow:Starting iteration 10

Steps executed: 400 Episode length: 400 Return: -498.57559629086614
INFO:tensorflow:Average training steps per second: 396.03
I0905 16:25:46.971168 140199535331328 replay_runner.py:36] Average training steps per second: 396.03
I0905 16:25:47.275928 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.58
INFO:tensorflow:Starting iteration 11

Steps executed: 91 Episode length: 91 Return: -295.6626562886047614
INFO:tensorflow:Average training steps per second: 391.36

Steps executed: 791 Episode length: 700 Return: -193.27825670668174
I0905 16:25:54.002378 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.47
INFO:tensorflow:Starting iteration 12
I0905 16:25:57.109256 140199535331328 replay_runner.py:41] Starting iteration 12

Steps executed: 226 Episode length: 126 Return: -20.674335859158234
I0905 16:25:59.559929 140199535331328 replay_runner.py:36] Average training steps per second: 408.11
I0905 16:25:59.669705 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.76
INFO:tensorflow:Starting iteration 13

Steps executed: 244 Episode length: 244 Return: -265.27766283100924
INFO:tensorflow:Average training steps per second: 398.02
I0905 16:26:05.287804 140199535331328 replay_runner.py:36] Average training steps per second: 398.02
I0905 16:26:05.439335 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.28
INFO:tensorflow:Starting iteration 14
I0905 16:26:08.594430 140199535331328 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 398.96

Steps executed: 765 Episode length: 765 Return: -210.63871944062624
I0905 16:26:12.131822 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.64
INFO:tensorflow:Starting iteration 15

Steps executed: 854 Episode length: 854 Return: -226.92153597069938
INFO:tensorflow:Average training steps per second: 394.94
I0905 16:26:17.887718 140199535331328 replay_runner.py:36] Average training steps per second: 394.94
I0905 16:26:19.022833 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.92
INFO:tensorflow:Starting iteration 16
I0905 16:26:22.148857 140199535331328 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 407.45

Steps executed: 1000 Episode length: 1000 Return: -60.78259507812788
I0905 16:26:26.259768 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.78
INFO:tensorflow:Starting iteration 17

Steps executed: 209 Episode length: 209 Return: 27.98560943406222688
INFO:tensorflow:Average training steps per second: 403.30
I0905 16:26:31.918140 140199535331328 replay_runner.py:36] Average training steps per second: 403.30
I0905 16:26:32.037542 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: 27.99
INFO:tensorflow:Starting iteration 18
I0905 16:26:35.142116 140199535331328 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 401.46
I0905 16:26:37.633257 140199535331328 replay_runner.py:36] Average training steps per second: 401.46

Steps executed: 250 Episode length: 74 Return: -201.5443904212036288
INFO:tensorflow:Starting iteration 19
I0905 16:26:40.946032 140199535331328 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 380.80

Steps executed: 1000 Episode length: 1000 Return: -70.16510247879856
I0905 16:26:45.270636 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.17
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 59 Return: -391.6105613544367956
INFO:tensorflow:Average training steps per second: 357.57
I0905 16:26:51.376571 140199535331328 replay_runner.py:36] Average training steps per second: 357.57
I0905 16:26:51.476250 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.65
INFO:tensorflow:Starting iteration 21

Steps executed: 505 Episode length: 364 Return: -274.482716078867656
INFO:tensorflow:Average training steps per second: 313.65
I0905 16:26:57.981686 140199535331328 replay_runner.py:36] Average training steps per second: 313.65
I0905 16:26:58.334947 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.22
INFO:tensorflow:Starting iteration 22
I0905 16:27:01.794622 140199535331328 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 329.17

Steps executed: 674 Episode length: 674 Return: -315.705747858130056
I0905 16:27:06.122217 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.71
INFO:tensorflow:Starting iteration 23

Steps executed: 262 Episode length: 81 Return: -449.6227856332437056
INFO:tensorflow:Average training steps per second: 308.11
I0905 16:27:13.046459 140199535331328 replay_runner.py:36] Average training steps per second: 308.11
I0905 16:27:13.199419 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.09
INFO:tensorflow:Starting iteration 24

Steps executed: 212 Episode length: 65 Return: -390.5703390089617356
INFO:tensorflow:Average training steps per second: 300.12
I0905 16:27:20.248181 140199535331328 replay_runner.py:36] Average training steps per second: 300.12
I0905 16:27:20.369460 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.21
INFO:tensorflow:Starting iteration 25
I0905 16:27:24.087453 140199535331328 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 294.19
I0905 16:27:27.487298 140199535331328 replay_runner.py:36] Average training steps per second: 294.19

Steps executed: 306 Episode length: 163 Return: -77.4020536967792956
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 169 Return: -140.493465756986866
INFO:tensorflow:Average training steps per second: 302.76
I0905 16:27:34.666455 140199535331328 replay_runner.py:36] Average training steps per second: 302.76
I0905 16:27:34.822788 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.65
INFO:tensorflow:Starting iteration 27
I0905 16:27:38.494184 140199535331328 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 306.62
I0905 16:27:41.756211 140199535331328 replay_runner.py:36] Average training steps per second: 306.62

Steps executed: 225 Episode length: 225 Return: 21.70132878673998866
INFO:tensorflow:Starting iteration 28

Steps executed: 281 Episode length: 106 Return: -370.386853389209556
INFO:tensorflow:Average training steps per second: 304.65
I0905 16:27:48.905519 140199535331328 replay_runner.py:36] Average training steps per second: 304.65
I0905 16:27:49.048648 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.05
INFO:tensorflow:Starting iteration 29

Steps executed: 289 Episode length: 153 Return: -290.569743101648456
INFO:tensorflow:Average training steps per second: 313.59
I0905 16:27:55.929175 140199535331328 replay_runner.py:36] Average training steps per second: 313.59

Done fixed training!Episode length: 153 Return: -290.569743101648456