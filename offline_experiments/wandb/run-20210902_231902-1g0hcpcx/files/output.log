I0902 23:19:09.278525 139758623574016 run_experiment.py:549] Creating TrainRunner ...
I0902 23:19:09.288845 139758623574016 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:09.289100 139758623574016 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:09.289275 139758623574016 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:09.289448 139758623574016 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:09.289629 139758623574016 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:09.289760 139758623574016 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:19:09.289889 139758623574016 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:09.290003 139758623574016 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:09.290140 139758623574016 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:09.290248 139758623574016 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:09.290390 139758623574016 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:09.290505 139758623574016 dqn_agent.py:283] 	 seed: 1630624749288781
I0902 23:19:09.293807 139758623574016 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:09.294048 139758623574016 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:19:09.294200 139758623574016 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:09.294327 139758623574016 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:09.294441 139758623574016 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:09.294566 139758623574016 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:09.294673 139758623574016 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:09.294781 139758623574016 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:09.294938 139758623574016 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0902 23:19:10.838229 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:11.331659 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:11.345149 139758623574016 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:19:11.353478 139758623574016 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:11.353749 139758623574016 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:11.353889 139758623574016 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:11.354022 139758623574016 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:11.354117 139758623574016 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:11.354200 139758623574016 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:19:11.354285 139758623574016 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:11.354387 139758623574016 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:11.354470 139758623574016 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:11.354559 139758623574016 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:11.354656 139758623574016 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:11.354735 139758623574016 dqn_agent.py:283] 	 seed: 1630624751353426
I0902 23:19:11.357642 139758623574016 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:11.357921 139758623574016 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:19:11.358124 139758623574016 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:11.358229 139758623574016 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:11.358354 139758623574016 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:11.358446 139758623574016 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:11.358549 139758623574016 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:11.358638 139758623574016 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:11.358800 139758623574016 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:19:11.390293 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:11.410430 139758623574016 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:19:11.410743 139758623574016 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 152.25
I0902 23:19:17.979171 139758623574016 replay_runner.py:36] Average training steps per second: 152.25
Steps executed: 202 Episode length: 9 Return: 9.0.0
I0902 23:19:19.026874 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 191.48
I0902 23:19:24.430725 139758623574016 replay_runner.py:36] Average training steps per second: 191.48
I0902 23:19:24.578780 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 2

Steps executed: 210 Episode length: 97 Return: 97.0.0
INFO:tensorflow:Average training steps per second: 192.71
I0902 23:19:29.951079 139758623574016 replay_runner.py:36] Average training steps per second: 192.71
I0902 23:19:30.100946 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 105.00
INFO:tensorflow:Starting iteration 3

Steps executed: 328 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 190.72
I0902 23:19:35.542546 139758623574016 replay_runner.py:36] Average training steps per second: 190.72
I0902 23:19:35.758870 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.16
I0902 23:19:41.146468 139758623574016 replay_runner.py:36] Average training steps per second: 192.16
I0902 23:19:41.279534 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 327 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 187.16
I0902 23:19:46.804796 139758623574016 replay_runner.py:36] Average training steps per second: 187.16
I0902 23:19:47.039895 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 6

Steps executed: 298 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 197.97
I0902 23:19:52.282847 139758623574016 replay_runner.py:36] Average training steps per second: 197.97
I0902 23:19:52.465555 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.57
I0902 23:19:57.762263 139758623574016 replay_runner.py:36] Average training steps per second: 195.57
I0902 23:19:57.907892 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0902 23:19:58.103364 139758623574016 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 192.35

Steps executed: 315 Episode length: 152 Return: 152.0
I0902 23:20:03.513880 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.86
I0902 23:20:08.924276 139758623574016 replay_runner.py:36] Average training steps per second: 191.86
I0902 23:20:09.074632 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 326 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 186.09
I0902 23:20:14.636040 139758623574016 replay_runner.py:36] Average training steps per second: 186.09
I0902 23:20:14.865906 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 11

Steps executed: 293 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 192.30
I0902 23:20:20.258195 139758623574016 replay_runner.py:36] Average training steps per second: 192.30
I0902 23:20:20.471110 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 12

Steps executed: 368 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 183.83
I0902 23:20:26.108360 139758623574016 replay_runner.py:36] Average training steps per second: 183.83
I0902 23:20:26.363962 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 13

Steps executed: 349 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 189.74
I0902 23:20:31.824062 139758623574016 replay_runner.py:36] Average training steps per second: 189.74
I0902 23:20:32.072288 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.10
I0902 23:20:37.560396 139758623574016 replay_runner.py:36] Average training steps per second: 189.10
I0902 23:20:37.693489 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 344 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 187.18
I0902 23:20:43.224801 139758623574016 replay_runner.py:36] Average training steps per second: 187.18
I0902 23:20:43.468490 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.00
INFO:tensorflow:Starting iteration 16

Steps executed: 364 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 189.83
I0902 23:20:48.914245 139758623574016 replay_runner.py:36] Average training steps per second: 189.83
I0902 23:20:49.174541 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.39
I0902 23:20:54.560089 139758623574016 replay_runner.py:36] Average training steps per second: 192.39
I0902 23:20:54.696901 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:20:54.885643 139758623574016 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 187.93
I0902 23:21:00.207607 139758623574016 replay_runner.py:36] Average training steps per second: 187.93
I0902 23:21:00.347640 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:21:00.544808 139758623574016 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.62
I0902 23:21:05.709808 139758623574016 replay_runner.py:36] Average training steps per second: 193.62
I0902 23:21:05.853430 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:21:06.038882 139758623574016 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 187.72

Steps executed: 385 Episode length: 194 Return: 194.0
I0902 23:21:11.624521 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.08
I0902 23:21:17.028548 139758623574016 replay_runner.py:36] Average training steps per second: 192.08
I0902 23:21:17.168082 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:21:17.363891 139758623574016 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 186.58
I0902 23:21:22.724176 139758623574016 replay_runner.py:36] Average training steps per second: 186.58
I0902 23:21:22.857337 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:21:23.050060 139758623574016 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 184.40
I0902 23:21:28.473434 139758623574016 replay_runner.py:36] Average training steps per second: 184.40
I0902 23:21:28.612417 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:21:28.808564 139758623574016 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 192.37
I0902 23:21:34.007139 139758623574016 replay_runner.py:36] Average training steps per second: 192.37
I0902 23:21:34.144205 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:21:34.339246 139758623574016 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 187.34
I0902 23:21:39.677900 139758623574016 replay_runner.py:36] Average training steps per second: 187.34
I0902 23:21:39.803996 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:21:39.983947 139758623574016 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.83
I0902 23:21:45.117276 139758623574016 replay_runner.py:36] Average training steps per second: 194.83
I0902 23:21:45.251352 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:21:45.443109 139758623574016 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 201.01
I0902 23:21:50.418464 139758623574016 replay_runner.py:36] Average training steps per second: 201.01
I0902 23:21:50.535058 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:21:50.717116 139758623574016 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.47
I0902 23:21:55.886783 139758623574016 replay_runner.py:36] Average training steps per second: 193.47
I0902 23:21:56.012655 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.60
I0902 23:22:01.145079 139758623574016 replay_runner.py:36] Average training steps per second: 201.60
I0902 23:22:01.282296 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00