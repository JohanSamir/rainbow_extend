Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0901 12:48:49.941248 140457859885056 run_experiment.py:549] Creating TrainRunner ...
I0901 12:48:49.951259 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:48:49.951584 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:48:49.951790 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:48:49.951936 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:48:49.952086 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:48:49.952230 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:48:49.952355 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:48:49.952495 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:48:49.952655 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:48:49.952790 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:48:49.952910 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:48:49.953026 140457859885056 dqn_agent.py:283] 	 seed: 1630500529951185
I0901 12:48:49.956744 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:48:49.956970 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:48:49.957113 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:48:49.957241 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:48:49.957382 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:48:49.957498 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:48:49.957616 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:48:49.957832 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:48:49.957948 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:48:50.118414 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:48:50.644192 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:48:50.658886 140457859885056 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:48:50.669245 140457859885056 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:48:50.669564 140457859885056 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:48:50.669683 140457859885056 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:48:50.669767 140457859885056 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:48:50.669855 140457859885056 dqn_agent.py:275] 	 update_period: 4
I0901 12:48:50.670107 140457859885056 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:48:50.670425 140457859885056 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:48:50.670589 140457859885056 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:48:50.670681 140457859885056 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:48:50.670778 140457859885056 dqn_agent.py:280] 	 optimizer: adam
I0901 12:48:50.670930 140457859885056 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:48:50.671017 140457859885056 dqn_agent.py:283] 	 seed: 1630500530669194
I0901 12:48:50.673778 140457859885056 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:48:50.673971 140457859885056 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:48:50.674070 140457859885056 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:48:50.674176 140457859885056 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:48:50.674294 140457859885056 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:48:50.674352 140457859885056 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:48:50.674464 140457859885056 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:48:50.674566 140457859885056 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:48:50.674645 140457859885056 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:48:50.709011 140457859885056 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:48:50.727985 140457859885056 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:48:50.728230 140457859885056 replay_runner.py:41] Starting iteration 0
Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 141.86
I0901 12:48:57.777838 140457859885056 replay_runner.py:36] Average training steps per second: 141.86
I0901 12:48:58.982480 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.89
I0901 12:49:04.223047 140457859885056 replay_runner.py:36] Average training steps per second: 197.89
I0901 12:49:04.372304 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 2
I0901 12:49:04.560888 140457859885056 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.75
I0901 12:49:09.749320 140457859885056 replay_runner.py:36] Average training steps per second: 192.75
I0901 12:49:09.898775 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.60
INFO:tensorflow:Starting iteration 3

Steps executed: 228 Episode length: 43 Return: 43.0
INFO:tensorflow:Average training steps per second: 196.75
I0901 12:49:15.167679 140457859885056 replay_runner.py:36] Average training steps per second: 196.75
I0901 12:49:15.301666 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 106.50
INFO:tensorflow:Starting iteration 4

Steps executed: 213 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 209.95
I0901 12:49:20.248689 140457859885056 replay_runner.py:36] Average training steps per second: 209.95
I0901 12:49:20.385051 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 103.50
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 94 Return: 94.0.0
INFO:tensorflow:Average training steps per second: 198.86
I0901 12:49:25.600002 140457859885056 replay_runner.py:36] Average training steps per second: 198.86

Steps executed: 240 Episode length: 137 Return: 137.0
INFO:tensorflow:Starting iteration 6

Steps executed: 244 Episode length: 124 Return: 124.0
INFO:tensorflow:Average training steps per second: 212.62
I0901 12:49:30.626502 140457859885056 replay_runner.py:36] Average training steps per second: 212.62
I0901 12:49:30.782818 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.00
INFO:tensorflow:Starting iteration 7
I0901 12:49:30.971083 140457859885056 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 204.51


Steps executed: 229 Episode length: 114 Return: 114.0
I0901 12:49:36.011681 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.50
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.34
I0901 12:49:41.258796 140457859885056 replay_runner.py:36] Average training steps per second: 197.34
I0901 12:49:41.409076 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0901 12:49:41.608078 140457859885056 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 197.96
I0901 12:49:46.660227 140457859885056 replay_runner.py:36] Average training steps per second: 197.96
I0901 12:49:46.797612 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 340 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 195.40
I0901 12:49:52.107460 140457859885056 replay_runner.py:36] Average training steps per second: 195.40
I0901 12:49:52.344674 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 11

Steps executed: 374 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 204.50
I0901 12:49:57.429207 140457859885056 replay_runner.py:36] Average training steps per second: 204.50
I0901 12:49:57.677777 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 12

Steps executed: 307 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 204.71
I0901 12:50:02.750971 140457859885056 replay_runner.py:36] Average training steps per second: 204.71
I0901 12:50:02.957469 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 13
I0901 12:50:03.145944 140457859885056 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 203.01
I0901 12:50:08.072170 140457859885056 replay_runner.py:36] Average training steps per second: 203.01

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 14

Steps executed: 280 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 195.67
I0901 12:50:13.533251 140457859885056 replay_runner.py:36] Average training steps per second: 195.67
I0901 12:50:13.731911 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.00
INFO:tensorflow:Starting iteration 15
I0901 12:50:13.931761 140457859885056 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.10
I0901 12:50:18.979997 140457859885056 replay_runner.py:36] Average training steps per second: 198.10
I0901 12:50:19.203362 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 16

Steps executed: 331 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 206.09
I0901 12:50:24.243155 140457859885056 replay_runner.py:36] Average training steps per second: 206.09
I0901 12:50:24.376196 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.67
I0901 12:50:29.626919 140457859885056 replay_runner.py:36] Average training steps per second: 197.67

Steps executed: 281 Episode length: 136 Return: 136.0
INFO:tensorflow:Starting iteration 18
I0901 12:50:30.002060 140457859885056 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 216.04
I0901 12:50:34.631251 140457859885056 replay_runner.py:36] Average training steps per second: 216.04
I0901 12:50:34.759202 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.37
I0901 12:50:40.165698 140457859885056 replay_runner.py:36] Average training steps per second: 191.37
I0901 12:50:40.391825 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.50
INFO:tensorflow:Starting iteration 20

Steps executed: 357 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 201.93
I0901 12:50:45.527115 140457859885056 replay_runner.py:36] Average training steps per second: 201.93
I0901 12:50:45.755620 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 21

Steps executed: 332 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 194.78
I0901 12:50:51.082662 140457859885056 replay_runner.py:36] Average training steps per second: 194.78
I0901 12:50:51.345952 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 22

Steps executed: 354 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 199.86
I0901 12:50:56.539443 140457859885056 replay_runner.py:36] Average training steps per second: 199.86
I0901 12:50:56.685554 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.40
I0901 12:51:02.136259 140457859885056 replay_runner.py:36] Average training steps per second: 190.40
I0901 12:51:02.340544 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 24


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.44
I0901 12:51:07.678078 140457859885056 replay_runner.py:36] Average training steps per second: 194.44
I0901 12:51:07.808235 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 12:51:07.998830 140457859885056 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 192.21
I0901 12:51:13.201811 140457859885056 replay_runner.py:36] Average training steps per second: 192.21
I0901 12:51:13.342293 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 12:51:13.537680 140457859885056 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.43
I0901 12:51:18.681216 140457859885056 replay_runner.py:36] Average training steps per second: 194.43
I0901 12:51:18.826916 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:51:19.022506 140457859885056 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.66
I0901 12:51:24.186793 140457859885056 replay_runner.py:36] Average training steps per second: 193.66
I0901 12:51:24.328011 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:51:24.520012 140457859885056 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 193.81
I0901 12:51:29.680081 140457859885056 replay_runner.py:36] Average training steps per second: 193.81
I0901 12:51:29.823648 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 190.56
I0901 12:51:35.265542 140457859885056 replay_runner.py:36] Average training steps per second: 190.56
I0901 12:51:35.512479 140457859885056 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00