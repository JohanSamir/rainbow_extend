Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:24:55.421972 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:24:55.432480 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:24:55.432802 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:24:55.432984 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:24:55.433115 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:24:55.433244 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:24:55.433386 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:24:55.433585 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:24:55.433682 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:24:55.433851 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:24:55.433938 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:24:55.434103 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:24:55.434263 140635665344512 dqn_agent.py:283] 	 seed: 1630499095432401
I0901 12:24:55.436802 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:24:55.436953 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:24:55.437084 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:24:55.437219 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:24:55.437334 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:24:55.437448 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:24:55.437539 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:24:55.437633 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:24:55.437737 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:24:55.500125 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:24:56.023137 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:24:56.037343 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:24:56.046050 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:24:56.046274 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:24:56.046453 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:24:56.046901 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:24:56.047065 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:24:56.047231 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:24:56.047387 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:24:56.047538 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:24:56.047637 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:24:56.047734 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:24:56.047834 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:24:56.047927 140635665344512 dqn_agent.py:283] 	 seed: 1630499096046001
I0901 12:24:56.050942 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:24:56.051170 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:24:56.051362 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:24:56.051500 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:24:56.051595 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:24:56.051714 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:24:56.051850 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:24:56.052016 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:24:56.052090 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:24:56.087521 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:24:56.109088 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:24:56.109424 140635665344512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.21
I0901 12:25:02.949342 140635665344512 replay_runner.py:36] Average training steps per second: 146.21
Steps executed: 201 Episode length: 9 Return: 9.0.0
I0901 12:25:04.022631 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 200.58
I0901 12:25:09.194168 140635665344512 replay_runner.py:36] Average training steps per second: 200.58
I0901 12:25:09.334498 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.00
INFO:tensorflow:Starting iteration 2

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.86
I0901 12:25:14.573052 140635665344512 replay_runner.py:36] Average training steps per second: 197.86
I0901 12:25:14.717511 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.96
INFO:tensorflow:Starting iteration 3

Steps executed: 205 Episode length: 16 Return: 16.0
INFO:tensorflow:Average training steps per second: 201.73
I0901 12:25:19.861312 140635665344512 replay_runner.py:36] Average training steps per second: 201.73
I0901 12:25:19.994247 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 14.64
INFO:tensorflow:Starting iteration 4

Steps executed: 283 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 192.27
I0901 12:25:25.376022 140635665344512 replay_runner.py:36] Average training steps per second: 192.27
I0901 12:25:25.558594 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 5

Steps executed: 271 Episode length: 105 Return: 105.0
INFO:tensorflow:Average training steps per second: 196.62
I0901 12:25:30.824442 140635665344512 replay_runner.py:36] Average training steps per second: 196.62
I0901 12:25:31.017076 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.33
INFO:tensorflow:Starting iteration 6

Steps executed: 207 Episode length: 11 Return: 11.0.0
INFO:tensorflow:Average training steps per second: 190.93
I0901 12:25:36.448978 140635665344512 replay_runner.py:36] Average training steps per second: 190.93
I0901 12:25:36.594857 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 7

Steps executed: 221 Episode length: 76 Return: 76.0.0
INFO:tensorflow:Average training steps per second: 186.87
I0901 12:25:42.142227 140635665344512 replay_runner.py:36] Average training steps per second: 186.87
I0901 12:25:42.293629 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 73.67
INFO:tensorflow:Starting iteration 8

Steps executed: 204 Episode length: 78 Return: 78.0.0
INFO:tensorflow:Average training steps per second: 187.80
I0901 12:25:47.806548 140635665344512 replay_runner.py:36] Average training steps per second: 187.80
I0901 12:25:47.941291 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.00
INFO:tensorflow:Starting iteration 9
I0901 12:25:48.136060 140635665344512 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 188.20

Steps executed: 200 Episode length: 108 Return: 108.0
I0901 12:25:53.587469 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 100.00
INFO:tensorflow:Starting iteration 10

Steps executed: 237 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Average training steps per second: 184.65
I0901 12:25:59.203837 140635665344512 replay_runner.py:36] Average training steps per second: 184.65
I0901 12:25:59.369343 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.00
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 46 Return: 46.0.0
INFO:tensorflow:Average training steps per second: 182.85
I0901 12:26:05.022380 140635665344512 replay_runner.py:36] Average training steps per second: 182.85
I0901 12:26:05.169744 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.75
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.58
I0901 12:26:10.664633 140635665344512 replay_runner.py:36] Average training steps per second: 188.58
I0901 12:26:10.812932 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.96
I0901 12:26:16.333095 140635665344512 replay_runner.py:36] Average training steps per second: 187.96
I0901 12:26:16.606202 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 14

Steps executed: 323 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 183.09
I0901 12:26:22.251089 140635665344512 replay_runner.py:36] Average training steps per second: 183.09
I0901 12:26:22.475785 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 15

Steps executed: 281 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 186.89
I0901 12:26:28.027371 140635665344512 replay_runner.py:36] Average training steps per second: 186.89
I0901 12:26:28.231316 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 16

Steps executed: 283 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 182.87
I0901 12:26:33.902769 140635665344512 replay_runner.py:36] Average training steps per second: 182.87
I0901 12:26:34.106249 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.96
I0901 12:26:39.652419 140635665344512 replay_runner.py:36] Average training steps per second: 186.96
I0901 12:26:39.802594 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 12:26:39.996151 140635665344512 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 191.90

Steps executed: 331 Episode length: 153 Return: 153.0
I0901 12:26:45.457427 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.50
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 182.07
I0901 12:26:51.132865 140635665344512 replay_runner.py:36] Average training steps per second: 182.07
I0901 12:26:51.272234 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:26:51.639726 140635665344512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 173.60
I0901 12:26:57.400597 140635665344512 replay_runner.py:36] Average training steps per second: 173.60
I0901 12:26:57.543756 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 12:26:57.740115 140635665344512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 189.57
I0901 12:27:03.015557 140635665344512 replay_runner.py:36] Average training steps per second: 189.57
I0901 12:27:03.163303 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.20
I0901 12:27:08.691488 140635665344512 replay_runner.py:36] Average training steps per second: 187.20
I0901 12:27:08.966511 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.35
I0901 12:27:14.400946 140635665344512 replay_runner.py:36] Average training steps per second: 190.35
I0901 12:27:14.548553 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 375 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.92
I0901 12:27:20.149372 140635665344512 replay_runner.py:36] Average training steps per second: 184.92
I0901 12:27:20.415451 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 25

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.84
I0901 12:27:25.883135 140635665344512 replay_runner.py:36] Average training steps per second: 189.84
I0901 12:27:26.170023 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 26
I0901 12:27:26.349748 140635665344512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 189.55
I0901 12:27:31.625706 140635665344512 replay_runner.py:36] Average training steps per second: 189.55

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 27
I0901 12:27:31.966412 140635665344512 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.70
I0901 12:27:37.238203 140635665344512 replay_runner.py:36] Average training steps per second: 189.70
I0901 12:27:37.409120 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:27:37.599130 140635665344512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 190.42
I0901 12:27:42.851060 140635665344512 replay_runner.py:36] Average training steps per second: 190.42
I0901 12:27:43.002068 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.93
I0901 12:27:48.495192 140635665344512 replay_runner.py:36] Average training steps per second: 188.93
I0901 12:27:48.629594 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00