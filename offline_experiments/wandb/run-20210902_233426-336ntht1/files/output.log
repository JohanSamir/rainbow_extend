Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 23:34:33.493248 139650945370112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:34:33.502498 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:33.502779 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:33.502984 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:33.503133 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:33.503238 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:33.503522 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:33.503668 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:33.503758 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:33.503976 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:33.504173 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:33.504556 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:33.504717 139650945370112 dqn_agent.py:283] 	 seed: 1630625673502432
I0902 23:34:33.508808 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:33.509179 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:33.509364 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:33.509486 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:33.509606 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:33.509687 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:33.509793 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:33.509867 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:33.510036 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:33.550209 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:34.093713 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:34.106137 139650945370112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:34:34.114905 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:34:34.115105 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:34:34.115186 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:34:34.115248 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:34:34.115347 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:34:34.115418 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:34:34.115543 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:34:34.115603 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:34:34.115688 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:34:34.115942 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:34:34.116034 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:34:34.116083 139650945370112 dqn_agent.py:283] 	 seed: 1630625674114854
I0902 23:34:34.119328 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:34:34.119596 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:34:34.119769 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:34:34.119890 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:34:34.120028 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:34:34.120121 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:34:34.120278 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:34:34.120433 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:34:34.120619 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:34:34.152308 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:34:34.173955 139650945370112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:34:34.174252 139650945370112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.95
I0902 23:34:40.888161 139650945370112 replay_runner.py:36] Average training steps per second: 148.95
I0902 23:34:42.102265 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 1
I0902 23:34:42.294153 139650945370112 replay_runner.py:41] Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.00
I0902 23:34:47.557685 139650945370112 replay_runner.py:36] Average training steps per second: 190.00
I0902 23:34:47.695557 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2

Steps executed: 105 Episode length: 105 Return: 105.0
INFO:tensorflow:Average training steps per second: 192.50
I0902 23:34:53.083988 139650945370112 replay_runner.py:36] Average training steps per second: 192.50
I0902 23:34:53.240417 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.00
INFO:tensorflow:Starting iteration 3


Steps executed: 302 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 192.75
I0902 23:34:58.624484 139650945370112 replay_runner.py:36] Average training steps per second: 192.75
I0902 23:34:58.828563 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 4

Steps executed: 367 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 187.55
I0902 23:35:04.351980 139650945370112 replay_runner.py:36] Average training steps per second: 187.55
I0902 23:35:04.581346 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 5

Steps executed: 392 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.28
I0902 23:35:09.832131 139650945370112 replay_runner.py:36] Average training steps per second: 197.28
I0902 23:35:10.086281 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 6
I0902 23:35:10.272570 139650945370112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 189.95
I0902 23:35:15.537497 139650945370112 replay_runner.py:36] Average training steps per second: 189.95
I0902 23:35:15.779886 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 7

Steps executed: 339 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.61
I0902 23:35:21.072947 139650945370112 replay_runner.py:36] Average training steps per second: 195.61
I0902 23:35:21.259923 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 8

Steps executed: 281 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 190.53
I0902 23:35:26.738004 139650945370112 replay_runner.py:36] Average training steps per second: 190.53
I0902 23:35:26.921593 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 9

Steps executed: 276 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 190.75
I0902 23:35:32.407431 139650945370112 replay_runner.py:36] Average training steps per second: 190.75
I0902 23:35:32.570829 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.00
INFO:tensorflow:Starting iteration 10

Steps executed: 246 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 189.64
I0902 23:35:38.026901 139650945370112 replay_runner.py:36] Average training steps per second: 189.64
I0902 23:35:38.191112 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.50
INFO:tensorflow:Starting iteration 11


Steps executed: 288 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 186.35
I0902 23:35:43.743320 139650945370112 replay_runner.py:36] Average training steps per second: 186.35
I0902 23:35:43.932403 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.00
INFO:tensorflow:Starting iteration 12

Steps executed: 235 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 189.28
I0902 23:35:49.401974 139650945370112 replay_runner.py:36] Average training steps per second: 189.28
I0902 23:35:49.571393 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.25
I0902 23:35:55.134675 139650945370112 replay_runner.py:36] Average training steps per second: 186.25
I0902 23:35:55.270889 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0902 23:35:55.465849 139650945370112 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 189.01
I0902 23:36:00.756994 139650945370112 replay_runner.py:36] Average training steps per second: 189.01
I0902 23:36:00.889483 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.84
I0902 23:36:06.296236 139650945370112 replay_runner.py:36] Average training steps per second: 191.84
I0902 23:36:06.555704 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.39
I0902 23:36:12.034807 139650945370112 replay_runner.py:36] Average training steps per second: 189.39
I0902 23:36:12.168424 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:36:12.429769 139650945370112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 187.49
I0902 23:36:17.763739 139650945370112 replay_runner.py:36] Average training steps per second: 187.49
I0902 23:36:17.903569 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:36:18.100125 139650945370112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 192.11
I0902 23:36:23.306066 139650945370112 replay_runner.py:36] Average training steps per second: 192.11
I0902 23:36:23.455410 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:36:23.643286 139650945370112 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 187.55
I0902 23:36:28.975604 139650945370112 replay_runner.py:36] Average training steps per second: 187.55
I0902 23:36:29.122800 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:36:29.317362 139650945370112 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.12
I0902 23:36:34.416561 139650945370112 replay_runner.py:36] Average training steps per second: 196.12
I0902 23:36:34.550093 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:36:34.731470 139650945370112 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 187.78
I0902 23:36:40.057335 139650945370112 replay_runner.py:36] Average training steps per second: 187.78
I0902 23:36:40.197160 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.54
I0902 23:36:45.423467 139650945370112 replay_runner.py:36] Average training steps per second: 198.54
I0902 23:36:45.696684 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.17
I0902 23:36:51.105364 139650945370112 replay_runner.py:36] Average training steps per second: 191.17
I0902 23:36:51.232568 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:36:51.415657 139650945370112 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 201.43
I0902 23:36:56.380622 139650945370112 replay_runner.py:36] Average training steps per second: 201.43
I0902 23:36:56.518013 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:36:56.706774 139650945370112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 198.09
I0902 23:37:01.755448 139650945370112 replay_runner.py:36] Average training steps per second: 198.09
I0902 23:37:01.881809 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:37:02.068887 139650945370112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.61
I0902 23:37:07.155530 139650945370112 replay_runner.py:36] Average training steps per second: 196.61
I0902 23:37:07.298538 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:37:07.495409 139650945370112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.37
I0902 23:37:12.748728 139650945370112 replay_runner.py:36] Average training steps per second: 190.37
I0902 23:37:12.885733 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:37:13.079472 139650945370112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.04
I0902 23:37:18.233429 139650945370112 replay_runner.py:36] Average training steps per second: 194.04
I0902 23:37:18.362533 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.13
I0902 23:37:23.710869 139650945370112 replay_runner.py:36] Average training steps per second: 194.13
I0902 23:37:23.842082 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00