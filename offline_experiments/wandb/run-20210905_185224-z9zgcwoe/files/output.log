Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0905 18:52:31.293765 140076563105792 run_experiment.py:549] Creating TrainRunner ...
I0905 18:52:31.303827 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:31.304063 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:31.304164 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:31.304246 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:31.304340 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:31.304422 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:31.304490 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:31.304571 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:31.304623 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:31.304783 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:31.304874 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:31.304968 140076563105792 dqn_agent.py:283] 	 seed: 1630867951303749
I0905 18:52:31.306999 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:31.307136 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:52:31.307240 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:31.307314 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:31.307379 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:31.307585 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:31.307671 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:31.307765 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:31.307860 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:31.351487 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:31.854493 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:31.868865 140076563105792 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:52:31.879002 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:31.879352 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:31.879575 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:31.879735 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:31.879949 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:31.880142 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:31.880298 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:31.880519 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:31.880698 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:31.880830 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:31.880967 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:31.881139 140076563105792 dqn_agent.py:283] 	 seed: 1630867951878921
I0905 18:52:31.882979 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:31.883095 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:52:31.883209 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:31.883276 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:31.883334 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:31.883390 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:31.883489 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:31.883571 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:31.883644 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:31.920850 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:31.944927 140076563105792 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:52:31.945539 140076563105792 replay_runner.py:41] Starting iteration 0
Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 136.31
I0905 18:52:39.282251 140076563105792 replay_runner.py:36] Average training steps per second: 136.31
I0905 18:52:40.567553 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 1

Steps executed: 384 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 175.38
I0905 18:52:46.457439 140076563105792 replay_runner.py:36] Average training steps per second: 175.38
I0905 18:52:46.774499 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 2
I0905 18:52:46.983258 140076563105792 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 172.00

Steps executed: 330 Episode length: 148 Return: 148.0
I0905 18:52:53.084343 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 172.20
I0905 18:52:59.113343 140076563105792 replay_runner.py:36] Average training steps per second: 172.20
I0905 18:52:59.287662 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 243 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 171.68
I0905 18:53:05.306962 140076563105792 replay_runner.py:36] Average training steps per second: 171.68
I0905 18:53:05.515013 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.50
INFO:tensorflow:Starting iteration 5

Steps executed: 228 Episode length: 115 Return: 115.0
INFO:tensorflow:Average training steps per second: 173.36
I0905 18:53:11.506065 140076563105792 replay_runner.py:36] Average training steps per second: 173.36
I0905 18:53:11.707983 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.00
INFO:tensorflow:Starting iteration 6

Steps executed: 267 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 171.55
I0905 18:53:17.749622 140076563105792 replay_runner.py:36] Average training steps per second: 171.55
I0905 18:53:17.972815 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.50
INFO:tensorflow:Starting iteration 7

Steps executed: 334 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 174.82
I0905 18:53:23.911194 140076563105792 replay_runner.py:36] Average training steps per second: 174.82
I0905 18:53:24.191515 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 8

Steps executed: 264 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 171.69
I0905 18:53:30.240020 140076563105792 replay_runner.py:36] Average training steps per second: 171.69
I0905 18:53:30.493379 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 9

Steps executed: 283 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 175.23
I0905 18:53:36.428470 140076563105792 replay_runner.py:36] Average training steps per second: 175.23
I0905 18:53:36.701895 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 10

Steps executed: 238 Episode length: 114 Return: 114.0
INFO:tensorflow:Average training steps per second: 171.13
I0905 18:53:42.776041 140076563105792 replay_runner.py:36] Average training steps per second: 171.13
I0905 18:53:42.995420 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 119.00
INFO:tensorflow:Starting iteration 11

Steps executed: 284 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 176.18
I0905 18:53:48.889078 140076563105792 replay_runner.py:36] Average training steps per second: 176.18
I0905 18:53:49.150140 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 12
I0905 18:53:49.371670 140076563105792 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 171.70

Steps executed: 378 Episode length: 199 Return: 199.0
I0905 18:53:55.519715 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 13
I0905 18:53:55.733445 140076563105792 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 176.65

Steps executed: 264 Episode length: 132 Return: 132.0
I0905 18:54:01.632387 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 173.62
I0905 18:54:07.603251 140076563105792 replay_runner.py:36] Average training steps per second: 173.62
I0905 18:54:07.775764 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0905 18:54:07.993086 140076563105792 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 175.01
I0905 18:54:13.707610 140076563105792 replay_runner.py:36] Average training steps per second: 175.01
I0905 18:54:13.895292 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 366 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 174.60
I0905 18:54:19.841536 140076563105792 replay_runner.py:36] Average training steps per second: 174.60
I0905 18:54:20.166563 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 179.90
I0905 18:54:25.940057 140076563105792 replay_runner.py:36] Average training steps per second: 179.90
I0905 18:54:26.123655 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 18:54:26.344728 140076563105792 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 174.64
I0905 18:54:32.071388 140076563105792 replay_runner.py:36] Average training steps per second: 174.64
I0905 18:54:32.265073 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 300 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 172.73
I0905 18:54:38.287870 140076563105792 replay_runner.py:36] Average training steps per second: 172.73
I0905 18:54:38.557266 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 174.61
I0905 18:54:44.497255 140076563105792 replay_runner.py:36] Average training steps per second: 174.61
I0905 18:54:44.672022 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 18:54:44.890020 140076563105792 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 178.32
I0905 18:54:50.498212 140076563105792 replay_runner.py:36] Average training steps per second: 178.32
I0905 18:54:50.673008 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 315 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 179.86
I0905 18:54:56.448254 140076563105792 replay_runner.py:36] Average training steps per second: 179.86
I0905 18:54:56.730415 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 23

Steps executed: 347 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 171.39
I0905 18:55:02.785025 140076563105792 replay_runner.py:36] Average training steps per second: 171.39
I0905 18:55:03.063945 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 24

Steps executed: 387 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 170.86
I0905 18:55:09.106661 140076563105792 replay_runner.py:36] Average training steps per second: 170.86
I0905 18:55:09.439442 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 25


Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 172.41
I0905 18:55:15.455833 140076563105792 replay_runner.py:36] Average training steps per second: 172.41
I0905 18:55:15.805095 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 173.49
I0905 18:55:21.780395 140076563105792 replay_runner.py:36] Average training steps per second: 173.49
I0905 18:55:21.958920 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 345 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 173.10
I0905 18:55:27.923214 140076563105792 replay_runner.py:36] Average training steps per second: 173.10
I0905 18:55:28.229869 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 178.68
I0905 18:55:34.049213 140076563105792 replay_runner.py:36] Average training steps per second: 178.68
I0905 18:55:34.209616 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 182.64
I0905 18:55:39.880416 140076563105792 replay_runner.py:36] Average training steps per second: 182.64
I0905 18:55:40.042818 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00