Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 00:24:15.321931 139929824643072 run_experiment.py:549] Creating TrainRunner ...
I0902 00:24:15.329463 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:24:15.329665 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:24:15.329854 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:24:15.329949 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:24:15.330066 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:24:15.330173 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:24:15.330269 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:24:15.330382 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:24:15.330442 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:24:15.330494 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:24:15.330546 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:24:15.330617 139929824643072 dqn_agent.py:283] 	 seed: 1630542255329424
I0902 00:24:15.332380 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:24:15.332496 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:24:15.332570 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:24:15.332631 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:24:15.332689 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:24:15.332760 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:24:15.332825 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:24:15.332898 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:24:15.332963 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:24:15.358383 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:24:15.593454 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:24:15.601997 139929824643072 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:24:15.608472 139929824643072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:24:15.608587 139929824643072 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:24:15.608668 139929824643072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:24:15.608728 139929824643072 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:24:15.608789 139929824643072 dqn_agent.py:275] 	 update_period: 4
I0902 00:24:15.608851 139929824643072 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:24:15.608908 139929824643072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:24:15.608965 139929824643072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:24:15.609044 139929824643072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:24:15.609143 139929824643072 dqn_agent.py:280] 	 optimizer: adam
I0902 00:24:15.609216 139929824643072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:24:15.609277 139929824643072 dqn_agent.py:283] 	 seed: 1630542255608448
I0902 00:24:15.611652 139929824643072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:24:15.611833 139929824643072 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:24:15.612013 139929824643072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:24:15.612103 139929824643072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:24:15.612190 139929824643072 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:24:15.612267 139929824643072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:24:15.612374 139929824643072 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:24:15.612486 139929824643072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:24:15.612579 139929824643072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:24:15.632043 139929824643072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:24:15.645801 139929824643072 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:24:15.645941 139929824643072 replay_runner.py:41] Starting iteration 0
Steps executed: 296 Episode length: 152 Return: -517.94159226474633
INFO:tensorflow:Average training steps per second: 237.74
I0902 00:24:19.852502 139929824643072 replay_runner.py:36] Average training steps per second: 237.74
I0902 00:24:20.681736 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.89
INFO:tensorflow:Starting iteration 1

Steps executed: 253 Episode length: 151 Return: -422.37442536597837
INFO:tensorflow:Average training steps per second: 338.70
I0902 00:24:26.947329 139929824643072 replay_runner.py:36] Average training steps per second: 338.70
I0902 00:24:27.096601 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.28
INFO:tensorflow:Starting iteration 2

Steps executed: 306 Episode length: 131 Return: -103.99562663864413
INFO:tensorflow:Average training steps per second: 351.77
I0902 00:24:33.303894 139929824643072 replay_runner.py:36] Average training steps per second: 351.77
I0902 00:24:33.491827 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.69
INFO:tensorflow:Starting iteration 3
I0902 00:24:36.901110 139929824643072 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 351.63
I0902 00:24:39.745366 139929824643072 replay_runner.py:36] Average training steps per second: 351.63

Steps executed: 795 Episode length: 649 Return: -562.42903833208843
INFO:tensorflow:Starting iteration 4
I0902 00:24:43.958317 139929824643072 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 340.60

Steps executed: 1000 Episode length: 1000 Return: -94.93448058978146
I0902 00:24:48.048406 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.93
INFO:tensorflow:Starting iteration 5
I0902 00:24:51.392001 139929824643072 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 331.96

Steps executed: 1000 Episode length: 1000 Return: -29.12778767827913
I0902 00:24:57.300986 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -29.13
INFO:tensorflow:Starting iteration 6
I0902 00:25:00.655154 139929824643072 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 340.19

Steps executed: 1000 Episode length: 1000 Return: -199.9419170351353
I0902 00:25:06.202420 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.94
INFO:tensorflow:Starting iteration 7
I0902 00:25:09.578865 139929824643072 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 335.40

Steps executed: 1000 Episode length: 1000 Return: -135.16851739136126
I0902 00:25:14.061598 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.17
INFO:tensorflow:Starting iteration 8

Steps executed: 221 Episode length: 221 Return: -281.8269574094387126
INFO:tensorflow:Average training steps per second: 331.43
I0902 00:25:20.395929 139929824643072 replay_runner.py:36] Average training steps per second: 331.43
I0902 00:25:20.571670 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.83
INFO:tensorflow:Starting iteration 9

Steps executed: 298 Episode length: 298 Return: 265.62867454429587126
INFO:tensorflow:Average training steps per second: 338.96
I0902 00:25:26.877559 139929824643072 replay_runner.py:36] Average training steps per second: 338.96
I0902 00:25:27.130414 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: 265.63
INFO:tensorflow:Starting iteration 10

Steps executed: 307 Episode length: 307 Return: -501.4322405816020626
INFO:tensorflow:Average training steps per second: 326.44
I0902 00:25:33.529765 139929824643072 replay_runner.py:36] Average training steps per second: 326.44
I0902 00:25:33.772024 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -501.43
INFO:tensorflow:Starting iteration 11

Steps executed: 392 Episode length: 201 Return: -275.6609631162729726
INFO:tensorflow:Average training steps per second: 327.94
I0902 00:25:40.007938 139929824643072 replay_runner.py:36] Average training steps per second: 327.94
I0902 00:25:40.270447 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.57
INFO:tensorflow:Starting iteration 12
I0902 00:25:43.565577 139929824643072 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 330.54

Steps executed: 1000 Episode length: 1000 Return: -62.450821198423416
I0902 00:25:49.347781 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.45
INFO:tensorflow:Starting iteration 13
I0902 00:25:52.656183 139929824643072 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 330.38

Steps executed: 1000 Episode length: 1000 Return: -113.74212690567904
I0902 00:25:57.441987 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.74
INFO:tensorflow:Starting iteration 14

Steps executed: 225 Episode length: 225 Return: -19.79495064614846504
INFO:tensorflow:Average training steps per second: 343.20
I0902 00:26:03.826646 139929824643072 replay_runner.py:36] Average training steps per second: 343.20
I0902 00:26:03.962398 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -19.79
INFO:tensorflow:Starting iteration 15

Steps executed: 386 Episode length: 250 Return: -40.13607815363656504
INFO:tensorflow:Average training steps per second: 349.76
I0902 00:26:10.299395 139929824643072 replay_runner.py:36] Average training steps per second: 349.76
I0902 00:26:10.541269 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.61
INFO:tensorflow:Starting iteration 16

Steps executed: 332 Episode length: 165 Return: -102.8670770169090404
INFO:tensorflow:Average training steps per second: 346.75
I0902 00:26:16.923486 139929824643072 replay_runner.py:36] Average training steps per second: 346.75
I0902 00:26:17.137543 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.71
INFO:tensorflow:Starting iteration 17
I0902 00:26:20.601960 139929824643072 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 345.08

Steps executed: 369 Episode length: 216 Return: -53.38287755054533804
I0902 00:26:23.727713 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.81
INFO:tensorflow:Starting iteration 18

Steps executed: 217 Episode length: 217 Return: -364.3704866825131604
INFO:tensorflow:Average training steps per second: 331.25
I0902 00:26:30.134613 139929824643072 replay_runner.py:36] Average training steps per second: 331.25
I0902 00:26:30.297721 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.37
INFO:tensorflow:Starting iteration 19

Steps executed: 318 Episode length: 134 Return: -161.9816847623726504
INFO:tensorflow:Average training steps per second: 322.15
I0902 00:26:36.743026 139929824643072 replay_runner.py:36] Average training steps per second: 322.15
I0902 00:26:36.952384 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.77
INFO:tensorflow:Starting iteration 20

Steps executed: 273 Episode length: 119 Return: -227.6253354208446404
INFO:tensorflow:Average training steps per second: 328.31
I0902 00:26:43.346649 139929824643072 replay_runner.py:36] Average training steps per second: 328.31
I0902 00:26:43.494332 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.77
INFO:tensorflow:Starting iteration 21

Steps executed: 430 Episode length: 430 Return: -248.1504953688843804
INFO:tensorflow:Average training steps per second: 330.06
I0902 00:26:49.840034 139929824643072 replay_runner.py:36] Average training steps per second: 330.06
I0902 00:26:50.381371 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.15
INFO:tensorflow:Starting iteration 22

Steps executed: 228 Episode length: 83 Return: -149.58656648055882804
INFO:tensorflow:Average training steps per second: 354.75
I0902 00:26:56.483342 139929824643072 replay_runner.py:36] Average training steps per second: 354.75
I0902 00:26:56.607841 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.11
INFO:tensorflow:Starting iteration 23

Steps executed: 234 Episode length: 97 Return: -466.32649853799734804
INFO:tensorflow:Average training steps per second: 370.44
I0902 00:27:02.656769 139929824643072 replay_runner.py:36] Average training steps per second: 370.44
I0902 00:27:02.763192 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.03
INFO:tensorflow:Starting iteration 24

Steps executed: 224 Episode length: 224 Return: -472.3124122286842804
INFO:tensorflow:Average training steps per second: 360.53
I0902 00:27:08.872616 139929824643072 replay_runner.py:36] Average training steps per second: 360.53
I0902 00:27:09.076725 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -472.31
INFO:tensorflow:Starting iteration 25

Steps executed: 251 Episode length: 62 Return: -136.48569638869142604
INFO:tensorflow:Average training steps per second: 351.35
I0902 00:27:15.153036 139929824643072 replay_runner.py:36] Average training steps per second: 351.35
I0902 00:27:15.271872 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.72
INFO:tensorflow:Starting iteration 26

Steps executed: 245 Episode length: 128 Return: -486.5459971577534604
INFO:tensorflow:Average training steps per second: 368.06
I0902 00:27:21.393610 139929824643072 replay_runner.py:36] Average training steps per second: 368.06
I0902 00:27:21.525954 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -682.65
INFO:tensorflow:Starting iteration 27

Steps executed: 275 Episode length: 76 Return: -146.87763343504307604
INFO:tensorflow:Average training steps per second: 363.84
I0902 00:27:27.615984 139929824643072 replay_runner.py:36] Average training steps per second: 363.84
I0902 00:27:27.713724 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.14
INFO:tensorflow:Starting iteration 28

Steps executed: 235 Episode length: 101 Return: -547.9186528697455604
INFO:tensorflow:Average training steps per second: 337.62
I0902 00:27:34.027884 139929824643072 replay_runner.py:36] Average training steps per second: 337.62
I0902 00:27:34.160739 139929824643072 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.62
INFO:tensorflow:Starting iteration 29

Steps executed: 208 Episode length: 150 Return: -701.9702745523117604
INFO:tensorflow:Average training steps per second: 338.66
I0902 00:27:40.478854 139929824643072 replay_runner.py:36] Average training steps per second: 338.66

Done fixed training!Episode length: 150 Return: -701.9702745523117604