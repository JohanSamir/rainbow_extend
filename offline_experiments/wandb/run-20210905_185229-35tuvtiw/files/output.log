Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0905 18:52:35.666149 140681815287808 run_experiment.py:549] Creating TrainRunner ...
I0905 18:52:35.675443 140681815287808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:35.675777 140681815287808 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:35.675942 140681815287808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:35.676123 140681815287808 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:35.676349 140681815287808 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:35.676562 140681815287808 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:35.676794 140681815287808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:35.677091 140681815287808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:35.677299 140681815287808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:35.677601 140681815287808 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:35.677824 140681815287808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:35.678149 140681815287808 dqn_agent.py:283] 	 seed: 1630867955675363
I0905 18:52:35.686153 140681815287808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:35.686552 140681815287808 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:52:35.686687 140681815287808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:35.686783 140681815287808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:35.686861 140681815287808 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:35.686984 140681815287808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:35.687189 140681815287808 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:35.687330 140681815287808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:35.687453 140681815287808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:35.737766 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:36.218734 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:36.233804 140681815287808 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:52:36.241742 140681815287808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:36.241988 140681815287808 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:36.242096 140681815287808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:36.242234 140681815287808 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:36.242403 140681815287808 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:36.242527 140681815287808 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:36.242650 140681815287808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:36.242729 140681815287808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:36.242801 140681815287808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:36.242868 140681815287808 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:36.242962 140681815287808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:36.243078 140681815287808 dqn_agent.py:283] 	 seed: 1630867956241679
I0905 18:52:36.245750 140681815287808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:36.245954 140681815287808 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:52:36.246090 140681815287808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:36.246213 140681815287808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:36.246312 140681815287808 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:36.246646 140681815287808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:36.246846 140681815287808 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:36.246989 140681815287808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:36.247106 140681815287808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:36.284863 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:36.309779 140681815287808 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:52:36.310026 140681815287808 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 128.44
I0905 18:52:44.096389 140681815287808 replay_runner.py:36] Average training steps per second: 128.44
Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:52:45.779406 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 18:52:46.041568 140681815287808 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 174.91
I0905 18:52:51.759416 140681815287808 replay_runner.py:36] Average training steps per second: 174.91
I0905 18:52:52.327749 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0905 18:52:52.601282 140681815287808 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 172.78
I0905 18:52:58.389542 140681815287808 replay_runner.py:36] Average training steps per second: 172.78
I0905 18:52:58.926212 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0905 18:52:59.160404 140681815287808 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 175.31
I0905 18:53:04.865335 140681815287808 replay_runner.py:36] Average training steps per second: 175.31
I0905 18:53:05.375306 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0905 18:53:05.644232 140681815287808 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 172.73
I0905 18:53:11.434109 140681815287808 replay_runner.py:36] Average training steps per second: 172.73
I0905 18:53:11.967783 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 18:53:12.207397 140681815287808 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 174.25
I0905 18:53:17.946979 140681815287808 replay_runner.py:36] Average training steps per second: 174.25
I0905 18:53:18.476835 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 246 Episode length: 140 Return: -139.0
INFO:tensorflow:Average training steps per second: 173.92
I0905 18:53:24.465237 140681815287808 replay_runner.py:36] Average training steps per second: 173.92
I0905 18:53:24.737739 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 7

Steps executed: 602 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 172.65
I0905 18:53:30.805711 140681815287808 replay_runner.py:36] Average training steps per second: 172.65
I0905 18:53:31.443854 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.50
INFO:tensorflow:Starting iteration 8
I0905 18:53:31.724708 140681815287808 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 174.11

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:53:38.026356 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0905 18:53:38.302687 140681815287808 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 170.72
I0905 18:53:44.160840 140681815287808 replay_runner.py:36] Average training steps per second: 170.72
I0905 18:53:44.666090 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 201 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 174.64
I0905 18:53:50.664715 140681815287808 replay_runner.py:36] Average training steps per second: 174.64
I0905 18:53:50.879995 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 11

Steps executed: 215 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 174.14
I0905 18:53:56.881511 140681815287808 replay_runner.py:36] Average training steps per second: 174.14
I0905 18:53:57.106460 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 178.99
I0905 18:54:02.961290 140681815287808 replay_runner.py:36] Average training steps per second: 178.99
I0905 18:54:03.530221 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0905 18:54:03.806857 140681815287808 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 174.47

Steps executed: 230 Episode length: 121 Return: -120.0
I0905 18:54:09.797995 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 14

Steps executed: 273 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 170.50
I0905 18:54:15.917357 140681815287808 replay_runner.py:36] Average training steps per second: 170.50
I0905 18:54:16.217468 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 15

Steps executed: 263 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 175.81
I0905 18:54:22.183843 140681815287808 replay_runner.py:36] Average training steps per second: 175.81
I0905 18:54:22.479108 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 16

Steps executed: 272 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 174.02
I0905 18:54:28.503570 140681815287808 replay_runner.py:36] Average training steps per second: 174.02
I0905 18:54:28.823000 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 17

Steps executed: 236 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 170.39
I0905 18:54:34.975312 140681815287808 replay_runner.py:36] Average training steps per second: 170.39
I0905 18:54:35.242755 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 18

Steps executed: 260 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 173.31
I0905 18:54:41.286113 140681815287808 replay_runner.py:36] Average training steps per second: 173.31
I0905 18:54:41.558628 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 19

Steps executed: 159 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 173.98
I0905 18:54:47.569825 140681815287808 replay_runner.py:36] Average training steps per second: 173.98

Steps executed: 247 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Starting iteration 20
I0905 18:54:48.136210 140681815287808 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 172.28

Steps executed: 205 Episode length: 100 Return: -99.00
I0905 18:54:54.166731 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 173.55
I0905 18:55:00.202489 140681815287808 replay_runner.py:36] Average training steps per second: 173.55
I0905 18:55:00.722135 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 258 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 172.22
I0905 18:55:06.804619 140681815287808 replay_runner.py:36] Average training steps per second: 172.22
I0905 18:55:07.100025 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 170.41
I0905 18:55:13.246602 140681815287808 replay_runner.py:36] Average training steps per second: 170.41
I0905 18:55:13.786036 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0905 18:55:14.060460 140681815287808 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 169.82
I0905 18:55:19.949509 140681815287808 replay_runner.py:36] Average training steps per second: 169.82
I0905 18:55:20.491612 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0905 18:55:20.752008 140681815287808 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 173.71
I0905 18:55:26.509490 140681815287808 replay_runner.py:36] Average training steps per second: 173.71
I0905 18:55:27.070501 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 302 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 175.37
I0905 18:55:33.049054 140681815287808 replay_runner.py:36] Average training steps per second: 175.37
I0905 18:55:33.374557 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 27
I0905 18:55:33.651240 140681815287808 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 181.90
I0905 18:55:39.149194 140681815287808 replay_runner.py:36] Average training steps per second: 181.90
I0905 18:55:39.656409 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28


Steps executed: 211 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 195.83
I0905 18:55:45.010550 140681815287808 replay_runner.py:36] Average training steps per second: 195.83
I0905 18:55:45.191428 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 186.90
I0905 18:55:50.766160 140681815287808 replay_runner.py:36] Average training steps per second: 186.90
I0905 18:55:50.985419 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00