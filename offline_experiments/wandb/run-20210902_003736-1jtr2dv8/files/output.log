I0902 00:37:42.246416 140413705484288 run_experiment.py:549] Creating TrainRunner ...
I0902 00:37:42.253490 140413705484288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:37:42.253716 140413705484288 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:37:42.253921 140413705484288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:37:42.254021 140413705484288 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:37:42.254186 140413705484288 dqn_agent.py:275] 	 update_period: 4
I0902 00:37:42.254326 140413705484288 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:37:42.254535 140413705484288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:37:42.254648 140413705484288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:37:42.254792 140413705484288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:37:42.254916 140413705484288 dqn_agent.py:280] 	 optimizer: adam
I0902 00:37:42.255019 140413705484288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:37:42.255091 140413705484288 dqn_agent.py:283] 	 seed: 1630543062253451
I0902 00:37:42.258195 140413705484288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:37:42.258356 140413705484288 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:37:42.258500 140413705484288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:37:42.258672 140413705484288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:37:42.258767 140413705484288 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:37:42.258840 140413705484288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:37:42.258974 140413705484288 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:37:42.259082 140413705484288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:37:42.259157 140413705484288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:37:42.284833 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:37:42.550697 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:37:42.560244 140413705484288 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:37:42.566858 140413705484288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:37:42.567002 140413705484288 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:37:42.567078 140413705484288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:37:42.567154 140413705484288 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:37:42.567210 140413705484288 dqn_agent.py:275] 	 update_period: 4
I0902 00:37:42.567290 140413705484288 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:37:42.567344 140413705484288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:37:42.567436 140413705484288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:37:42.567492 140413705484288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:37:42.567558 140413705484288 dqn_agent.py:280] 	 optimizer: adam
I0902 00:37:42.567672 140413705484288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:37:42.567769 140413705484288 dqn_agent.py:283] 	 seed: 1630543062566825
I0902 00:37:42.569507 140413705484288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:37:42.569653 140413705484288 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:37:42.569756 140413705484288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:37:42.569846 140413705484288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:37:42.569931 140413705484288 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:37:42.570021 140413705484288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:37:42.570155 140413705484288 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:37:42.570239 140413705484288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:37:42.570324 140413705484288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:37:42.594337 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:37:42.610743 140413705484288 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:37:42.610987 140413705484288 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 229.61
I0902 00:37:46.966429 140413705484288 replay_runner.py:36] Average training steps per second: 229.61
I0902 00:37:47.770333 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -572.88
Steps executed: 223 Episode length: 80 Return: -766.9838543835751
INFO:tensorflow:Starting iteration 1

Steps executed: 229 Episode length: 82 Return: -379.9157975240147
INFO:tensorflow:Average training steps per second: 326.56
I0902 00:37:54.226679 140413705484288 replay_runner.py:36] Average training steps per second: 326.56
I0902 00:37:54.347353 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.38
INFO:tensorflow:Starting iteration 2

Steps executed: 205 Episode length: 122 Return: -543.8072669973317
INFO:tensorflow:Average training steps per second: 342.64
I0902 00:38:00.479046 140413705484288 replay_runner.py:36] Average training steps per second: 342.64
I0902 00:38:00.607109 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -632.30
INFO:tensorflow:Starting iteration 3

Steps executed: 274 Episode length: 80 Return: -765.53488479205943
INFO:tensorflow:Average training steps per second: 348.23
I0902 00:38:06.828948 140413705484288 replay_runner.py:36] Average training steps per second: 348.23
I0902 00:38:06.978100 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.62
INFO:tensorflow:Starting iteration 4

Steps executed: 230 Episode length: 95 Return: -394.65694951996585
INFO:tensorflow:Average training steps per second: 335.35
I0902 00:38:13.195198 140413705484288 replay_runner.py:36] Average training steps per second: 335.35
I0902 00:38:13.323519 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -583.91
INFO:tensorflow:Starting iteration 5

Steps executed: 222 Episode length: 81 Return: -627.89170434351895
INFO:tensorflow:Average training steps per second: 354.44
I0902 00:38:19.324685 140413705484288 replay_runner.py:36] Average training steps per second: 354.44
I0902 00:38:19.447677 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.31
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 72 Return: -628.65180961702985
INFO:tensorflow:Average training steps per second: 339.12
I0902 00:38:25.738678 140413705484288 replay_runner.py:36] Average training steps per second: 339.12
I0902 00:38:25.830329 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.99
INFO:tensorflow:Starting iteration 7

Steps executed: 234 Episode length: 101 Return: -754.5912151854094
INFO:tensorflow:Average training steps per second: 336.86
I0902 00:38:32.105942 140413705484288 replay_runner.py:36] Average training steps per second: 336.86
I0902 00:38:32.232589 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -663.24
INFO:tensorflow:Starting iteration 8

Steps executed: 384 Episode length: 194 Return: -103.79404463365854
INFO:tensorflow:Average training steps per second: 330.13
I0902 00:38:38.557999 140413705484288 replay_runner.py:36] Average training steps per second: 330.13
I0902 00:38:38.761398 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.58
INFO:tensorflow:Starting iteration 9

Steps executed: 381 Episode length: 247 Return: -394.94737653253797
INFO:tensorflow:Average training steps per second: 336.69
I0902 00:38:45.110299 140413705484288 replay_runner.py:36] Average training steps per second: 336.69
I0902 00:38:45.364663 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.35
INFO:tensorflow:Starting iteration 10

Steps executed: 309 Episode length: 219 Return: -437.61605124626927
INFO:tensorflow:Average training steps per second: 345.42
I0902 00:38:51.669986 140413705484288 replay_runner.py:36] Average training steps per second: 345.42
I0902 00:38:51.879497 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.81
INFO:tensorflow:Starting iteration 11

Steps executed: 232 Episode length: 112 Return: -355.31498696621213
INFO:tensorflow:Average training steps per second: 346.46
I0902 00:38:58.187475 140413705484288 replay_runner.py:36] Average training steps per second: 346.46
I0902 00:38:58.321024 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.79
INFO:tensorflow:Starting iteration 12

Steps executed: 264 Episode length: 74 Return: -513.025324422414295
INFO:tensorflow:Average training steps per second: 339.83
I0902 00:39:04.701243 140413705484288 replay_runner.py:36] Average training steps per second: 339.83
I0902 00:39:04.859813 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.46
INFO:tensorflow:Starting iteration 13

Steps executed: 244 Episode length: 73 Return: -108.457528857174525
INFO:tensorflow:Average training steps per second: 335.47
I0902 00:39:11.285897 140413705484288 replay_runner.py:36] Average training steps per second: 335.47
I0902 00:39:11.429936 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.67
INFO:tensorflow:Starting iteration 14

Steps executed: 285 Episode length: 91 Return: -177.201161420542925
INFO:tensorflow:Average training steps per second: 350.18
I0902 00:39:17.706365 140413705484288 replay_runner.py:36] Average training steps per second: 350.18
I0902 00:39:17.870593 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.32
INFO:tensorflow:Starting iteration 15

Steps executed: 137 Episode length: 137 Return: -85.336857702695585
INFO:tensorflow:Average training steps per second: 351.61

Steps executed: 247 Episode length: 110 Return: -121.43463648281494
I0902 00:39:24.346549 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.39
INFO:tensorflow:Starting iteration 16

Steps executed: 472 Episode length: 275 Return: -324.50400293188934
INFO:tensorflow:Average training steps per second: 348.49
I0902 00:39:30.675233 140413705484288 replay_runner.py:36] Average training steps per second: 348.49
I0902 00:39:31.039550 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -555.84
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 88 Return: -384.814079534115144
INFO:tensorflow:Average training steps per second: 344.28
I0902 00:39:37.386247 140413705484288 replay_runner.py:36] Average training steps per second: 344.28
I0902 00:39:37.523805 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.28
INFO:tensorflow:Starting iteration 18

Steps executed: 297 Episode length: 141 Return: -208.71970839326235
INFO:tensorflow:Average training steps per second: 353.75
I0902 00:39:43.825442 140413705484288 replay_runner.py:36] Average training steps per second: 353.75
I0902 00:39:43.988973 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.02
INFO:tensorflow:Starting iteration 19

Steps executed: 252 Episode length: 198 Return: -353.32613543515777
INFO:tensorflow:Average training steps per second: 354.27
I0902 00:39:50.275155 140413705484288 replay_runner.py:36] Average training steps per second: 354.27
I0902 00:39:50.416118 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.20
INFO:tensorflow:Starting iteration 20

Steps executed: 211 Episode length: 75 Return: -530.629510329588177
INFO:tensorflow:Average training steps per second: 355.65
I0902 00:39:56.693971 140413705484288 replay_runner.py:36] Average training steps per second: 355.65
I0902 00:39:56.796530 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.11
INFO:tensorflow:Starting iteration 21

Steps executed: 262 Episode length: 118 Return: -822.31855041810247
INFO:tensorflow:Average training steps per second: 354.50
I0902 00:40:03.103224 140413705484288 replay_runner.py:36] Average training steps per second: 354.50
I0902 00:40:03.247593 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.03
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 101 Return: -563.16489394687247
INFO:tensorflow:Average training steps per second: 336.39
I0902 00:40:09.713076 140413705484288 replay_runner.py:36] Average training steps per second: 336.39
I0902 00:40:09.813440 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -560.48
INFO:tensorflow:Starting iteration 23

Steps executed: 117 Episode length: 117 Return: -655.15059709186117
INFO:tensorflow:Average training steps per second: 354.17
I0902 00:40:16.106333 140413705484288 replay_runner.py:36] Average training steps per second: 354.17

Steps executed: 268 Episode length: 151 Return: -1161.9372795275845
INFO:tensorflow:Starting iteration 24
I0902 00:40:19.753534 140413705484288 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 350.56

Steps executed: 236 Episode length: 54 Return: -363.585034492858145
I0902 00:40:22.738047 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -527.26
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 87 Return: -387.984182025180345
INFO:tensorflow:Average training steps per second: 343.22
I0902 00:40:29.109790 140413705484288 replay_runner.py:36] Average training steps per second: 343.22
I0902 00:40:29.227303 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -393.31
INFO:tensorflow:Starting iteration 26

Steps executed: 267 Episode length: 82 Return: -500.190867187538345
INFO:tensorflow:Average training steps per second: 340.90
I0902 00:40:35.598665 140413705484288 replay_runner.py:36] Average training steps per second: 340.90
I0902 00:40:35.722792 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.51
INFO:tensorflow:Starting iteration 27

Steps executed: 218 Episode length: 58 Return: -355.087210316823765
INFO:tensorflow:Average training steps per second: 340.81
I0902 00:40:42.069125 140413705484288 replay_runner.py:36] Average training steps per second: 340.81
I0902 00:40:42.192677 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.10
INFO:tensorflow:Starting iteration 28
I0902 00:40:45.604064 140413705484288 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 342.93
I0902 00:40:48.520424 140413705484288 replay_runner.py:36] Average training steps per second: 342.93

Steps executed: 284 Episode length: 89 Return: -348.817005920971245
INFO:tensorflow:Starting iteration 29

Steps executed: 248 Episode length: 85 Return: -281.670771084435565
INFO:tensorflow:Average training steps per second: 334.07
I0902 00:40:55.052788 140413705484288 replay_runner.py:36] Average training steps per second: 334.07

Done fixed training!Episode length: 85 Return: -281.670771084435565