Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 23:47:33.207513 140561847887872 run_experiment.py:549] Creating TrainRunner ...
I0902 23:47:33.217996 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:47:33.218291 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:47:33.218463 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:47:33.218588 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:47:33.218722 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:47:33.219047 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:47:33.219228 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:47:33.219490 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:47:33.219701 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:47:33.219812 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:47:33.220116 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:47:33.220250 140561847887872 dqn_agent.py:283] 	 seed: 1630626453217924
I0902 23:47:33.224132 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:47:33.224391 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:47:33.224522 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:47:33.224633 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:47:33.224721 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:47:33.224843 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:47:33.224939 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:47:33.225029 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:47:33.225116 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:47:33.269122 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:47:33.787959 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:47:33.802505 140561847887872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:47:33.813175 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:47:33.813428 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:47:33.813573 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:47:33.813827 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:47:33.813978 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:47:33.814065 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:47:33.814183 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:47:33.814484 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:47:33.814635 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:47:33.814718 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:47:33.814825 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:47:33.814911 140561847887872 dqn_agent.py:283] 	 seed: 1630626453813110
I0902 23:47:33.817063 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:47:33.817229 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:47:33.817358 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:47:33.817460 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:47:33.817558 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:47:33.817667 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:47:33.817816 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:47:33.818089 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:47:33.818374 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:47:33.853739 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:47:33.878369 140561847887872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:47:33.878690 140561847887872 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 141.96
I0902 23:47:40.923707 140561847887872 replay_runner.py:36] Average training steps per second: 141.96
I0902 23:47:42.476658 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 322 Episode length: 322 Return: -321.0
INFO:tensorflow:Average training steps per second: 188.71
I0902 23:47:48.027815 140561847887872 replay_runner.py:36] Average training steps per second: 188.71
I0902 23:47:48.306262 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.00
INFO:tensorflow:Starting iteration 2

Steps executed: 282 Episode length: 282 Return: -281.0
INFO:tensorflow:Average training steps per second: 186.23
I0902 23:47:53.908657 140561847887872 replay_runner.py:36] Average training steps per second: 186.23
I0902 23:47:54.152918 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.73
I0902 23:47:59.561645 140561847887872 replay_runner.py:36] Average training steps per second: 193.73
I0902 23:48:00.001760 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 23:48:00.250418 140561847887872 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 188.82
I0902 23:48:05.547376 140561847887872 replay_runner.py:36] Average training steps per second: 188.82
I0902 23:48:05.981478 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 307 Episode length: 199 Return: -198.0
INFO:tensorflow:Average training steps per second: 183.75
I0902 23:48:11.766212 140561847887872 replay_runner.py:36] Average training steps per second: 183.75
I0902 23:48:12.026415 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.13
I0902 23:48:17.343922 140561847887872 replay_runner.py:36] Average training steps per second: 197.13
I0902 23:48:17.742830 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 23:48:17.978522 140561847887872 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 185.92
I0902 23:48:23.357469 140561847887872 replay_runner.py:36] Average training steps per second: 185.92
I0902 23:48:23.770422 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:48:24.009290 140561847887872 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.10
I0902 23:48:29.083475 140561847887872 replay_runner.py:36] Average training steps per second: 197.10
I0902 23:48:29.528327 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 23:48:29.775240 140561847887872 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 186.17
I0902 23:48:35.147093 140561847887872 replay_runner.py:36] Average training steps per second: 186.17
I0902 23:48:35.570037 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 108 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 189.78

Steps executed: 608 Episode length: 500 Return: -500.0
I0902 23:48:41.595038 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.50
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 193.23
I0902 23:48:47.017666 140561847887872 replay_runner.py:36] Average training steps per second: 193.23
I0902 23:48:47.190769 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.17
I0902 23:48:52.613511 140561847887872 replay_runner.py:36] Average training steps per second: 193.17
I0902 23:48:53.023087 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 261 Episode length: 86 Return: -85.000
INFO:tensorflow:Average training steps per second: 197.77
I0902 23:48:58.320356 140561847887872 replay_runner.py:36] Average training steps per second: 197.77
I0902 23:48:58.543593 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.00
INFO:tensorflow:Starting iteration 14

Steps executed: 208 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 196.33
I0902 23:49:03.883592 140561847887872 replay_runner.py:36] Average training steps per second: 196.33
I0902 23:49:04.052297 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 15

Steps executed: 431 Episode length: 310 Return: -309.0
INFO:tensorflow:Average training steps per second: 192.25
I0902 23:49:09.593144 140561847887872 replay_runner.py:36] Average training steps per second: 192.25
I0902 23:49:09.948591 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.50
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.29
I0902 23:49:15.360201 140561847887872 replay_runner.py:36] Average training steps per second: 193.29
I0902 23:49:15.770870 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 254 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 190.41
I0902 23:49:21.265318 140561847887872 replay_runner.py:36] Average training steps per second: 190.41
I0902 23:49:21.471988 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 18

Steps executed: 217 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 189.07
I0902 23:49:27.000666 140561847887872 replay_runner.py:36] Average training steps per second: 189.07
I0902 23:49:27.186045 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 19

Steps executed: 233 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 198.01
I0902 23:49:32.493557 140561847887872 replay_runner.py:36] Average training steps per second: 198.01
I0902 23:49:32.695670 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 20

Steps executed: 235 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 188.31
I0902 23:49:38.254034 140561847887872 replay_runner.py:36] Average training steps per second: 188.31
I0902 23:49:38.442923 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 21

Steps executed: 234 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 198.87
I0902 23:49:43.706767 140561847887872 replay_runner.py:36] Average training steps per second: 198.87
I0902 23:49:43.906125 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 22
I0902 23:49:44.153342 140561847887872 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 189.84

Steps executed: 245 Episode length: 75 Return: -74.0.0
I0902 23:49:49.614919 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 23

Steps executed: 337 Episode length: 337 Return: -336.0
INFO:tensorflow:Average training steps per second: 194.85
I0902 23:49:54.975932 140561847887872 replay_runner.py:36] Average training steps per second: 194.85
I0902 23:49:55.269580 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.00
INFO:tensorflow:Starting iteration 24

Steps executed: 276 Episode length: 86 Return: -85.000
INFO:tensorflow:Average training steps per second: 197.88
I0902 23:50:00.567793 140561847887872 replay_runner.py:36] Average training steps per second: 197.88
I0902 23:50:00.795529 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.92
I0902 23:50:06.239399 140561847887872 replay_runner.py:36] Average training steps per second: 191.92
I0902 23:50:06.626896 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 310 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 196.67
I0902 23:50:11.947272 140561847887872 replay_runner.py:36] Average training steps per second: 196.67
I0902 23:50:12.207665 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.33
INFO:tensorflow:Starting iteration 27
I0902 23:50:12.449574 140561847887872 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 189.34

Steps executed: 269 Episode length: 90 Return: -89.000
I0902 23:50:17.958171 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 28
I0902 23:50:18.190083 140561847887872 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 186.97
I0902 23:50:23.538977 140561847887872 replay_runner.py:36] Average training steps per second: 186.97

Steps executed: 230 Episode length: 70 Return: -69.000
INFO:tensorflow:Starting iteration 29

Steps executed: 236 Episode length: 87 Return: -86.000
INFO:tensorflow:Average training steps per second: 199.17
I0902 23:50:28.989034 140561847887872 replay_runner.py:36] Average training steps per second: 199.17

Done fixed training!Episode length: 87 Return: -86.000