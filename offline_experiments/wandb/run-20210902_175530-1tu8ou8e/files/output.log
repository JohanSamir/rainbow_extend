Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 17:55:36.859644 140110082734080 run_experiment.py:549] Creating TrainRunner ...
I0902 17:55:36.869716 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:36.869969 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:36.870149 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:36.870304 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:36.870396 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:36.870472 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:36.870587 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:36.870702 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:36.870978 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:36.871103 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:36.871240 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:36.871353 140110082734080 dqn_agent.py:283] 	 seed: 1630605336869654
I0902 17:55:36.874215 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:36.874416 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:36.874513 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:36.874591 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:36.874660 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:36.874741 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:36.874871 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:36.875024 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:36.875159 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:36.911566 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:37.287918 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:37.302625 140110082734080 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:55:37.309759 140110082734080 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:55:37.309959 140110082734080 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:55:37.310104 140110082734080 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:55:37.310271 140110082734080 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:55:37.310357 140110082734080 dqn_agent.py:275] 	 update_period: 4
I0902 17:55:37.310449 140110082734080 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:55:37.310565 140110082734080 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:55:37.310817 140110082734080 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:55:37.311044 140110082734080 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:55:37.311281 140110082734080 dqn_agent.py:280] 	 optimizer: adam
I0902 17:55:37.311405 140110082734080 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:55:37.311539 140110082734080 dqn_agent.py:283] 	 seed: 1630605337309711
I0902 17:55:37.314206 140110082734080 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:55:37.314454 140110082734080 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:55:37.314562 140110082734080 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:55:37.314677 140110082734080 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:55:37.314795 140110082734080 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:55:37.314899 140110082734080 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:55:37.315022 140110082734080 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:55:37.315150 140110082734080 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:55:37.315287 140110082734080 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:55:37.362576 140110082734080 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=1.000000
I0902 17:55:37.403478 140110082734080 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:55:37.403697 140110082734080 replay_runner.py:41] Starting iteration 0
Steps executed: 64 Episode length: 64 Return: -160.906691526883
INFO:tensorflow:Average training steps per second: 169.58

Steps executed: 205 Episode length: 65 Return: -176.15387242443725
I0902 17:55:44.472430 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.85
INFO:tensorflow:Starting iteration 1

Steps executed: 278 Episode length: 119 Return: -121.32341633471665
INFO:tensorflow:Average training steps per second: 230.27
I0902 17:55:53.109143 140110082734080 replay_runner.py:36] Average training steps per second: 230.27
I0902 17:55:53.327107 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.56
INFO:tensorflow:Starting iteration 2

Steps executed: 285 Episode length: 104 Return: -139.22353253500935
INFO:tensorflow:Average training steps per second: 229.90
I0902 17:56:02.008771 140110082734080 replay_runner.py:36] Average training steps per second: 229.90
I0902 17:56:02.246823 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.75
INFO:tensorflow:Starting iteration 3

Steps executed: 253 Episode length: 142 Return: -174.39884741870015
INFO:tensorflow:Average training steps per second: 237.02
I0902 17:56:10.589866 140110082734080 replay_runner.py:36] Average training steps per second: 237.02
I0902 17:56:10.784203 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.11
INFO:tensorflow:Starting iteration 4

Steps executed: 208 Episode length: 208 Return: -266.52597047962415
INFO:tensorflow:Average training steps per second: 232.27
I0902 17:56:19.259660 140110082734080 replay_runner.py:36] Average training steps per second: 232.27
I0902 17:56:19.476218 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.53
INFO:tensorflow:Starting iteration 5

Steps executed: 202 Episode length: 91 Return: -172.660438602198445
INFO:tensorflow:Average training steps per second: 237.23
I0902 17:56:27.962039 140110082734080 replay_runner.py:36] Average training steps per second: 237.23
I0902 17:56:28.132225 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.96
INFO:tensorflow:Starting iteration 6
I0902 17:56:32.300039 140110082734080 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 229.24

Steps executed: 279 Episode length: 148 Return: -383.57763414806695
I0902 17:56:36.919126 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.31
INFO:tensorflow:Starting iteration 7

Steps executed: 273 Episode length: 161 Return: -183.86692766643965
INFO:tensorflow:Average training steps per second: 244.91
I0902 17:56:45.275126 140110082734080 replay_runner.py:36] Average training steps per second: 244.91
I0902 17:56:45.488211 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.71
INFO:tensorflow:Starting iteration 8

Steps executed: 250 Episode length: 111 Return: -281.98853402768304
INFO:tensorflow:Average training steps per second: 217.91
I0902 17:56:54.410679 140110082734080 replay_runner.py:36] Average training steps per second: 217.91
I0902 17:56:54.606550 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.54
INFO:tensorflow:Starting iteration 9

Steps executed: 294 Episode length: 206 Return: -255.08093838080117
INFO:tensorflow:Average training steps per second: 230.89
I0902 17:57:03.246350 140110082734080 replay_runner.py:36] Average training steps per second: 230.89
I0902 17:57:03.549054 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.36
INFO:tensorflow:Starting iteration 10

Steps executed: 240 Episode length: 96 Return: -249.512925123485537
INFO:tensorflow:Average training steps per second: 228.15
I0902 17:57:12.153270 140110082734080 replay_runner.py:36] Average training steps per second: 228.15
I0902 17:57:12.358548 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.63
INFO:tensorflow:Starting iteration 11

Steps executed: 328 Episode length: 225 Return: -484.52593606280135
INFO:tensorflow:Average training steps per second: 225.16
I0902 17:57:21.185817 140110082734080 replay_runner.py:36] Average training steps per second: 225.16
I0902 17:57:21.491905 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -475.35
INFO:tensorflow:Starting iteration 12

Steps executed: 356 Episode length: 157 Return: -535.25325170482016
INFO:tensorflow:Average training steps per second: 226.52
I0902 17:57:30.192447 140110082734080 replay_runner.py:36] Average training steps per second: 226.52
I0902 17:57:30.533178 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.76
INFO:tensorflow:Starting iteration 13

Steps executed: 354 Episode length: 166 Return: -167.73307314093324
INFO:tensorflow:Average training steps per second: 218.77
I0902 17:57:39.553875 140110082734080 replay_runner.py:36] Average training steps per second: 218.77
I0902 17:57:39.888536 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.65
INFO:tensorflow:Starting iteration 14

Steps executed: 222 Episode length: 96 Return: -200.105625662773924
INFO:tensorflow:Average training steps per second: 224.44
I0902 17:57:48.639921 140110082734080 replay_runner.py:36] Average training steps per second: 224.44
I0902 17:57:48.840613 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.13
INFO:tensorflow:Starting iteration 15

Steps executed: 241 Episode length: 161 Return: -370.57390542289164
INFO:tensorflow:Average training steps per second: 224.48
I0902 17:57:57.661736 140110082734080 replay_runner.py:36] Average training steps per second: 224.48
I0902 17:57:57.896912 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.72
INFO:tensorflow:Starting iteration 16
I0902 17:58:02.312901 140110082734080 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 226.82

Steps executed: 350 Episode length: 188 Return: -134.92840880037144
I0902 17:58:07.036898 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.87
INFO:tensorflow:Starting iteration 17

Steps executed: 234 Episode length: 234 Return: -148.70143364072266
INFO:tensorflow:Average training steps per second: 228.26
I0902 17:58:15.797615 140110082734080 replay_runner.py:36] Average training steps per second: 228.26
I0902 17:58:16.037381 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.70
INFO:tensorflow:Starting iteration 18
I0902 17:58:20.433603 140110082734080 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 227.34
I0902 17:58:24.832772 140110082734080 replay_runner.py:36] Average training steps per second: 227.34

Steps executed: 231 Episode length: 231 Return: -677.27721169402386
INFO:tensorflow:Starting iteration 19

Steps executed: 253 Episode length: 163 Return: -118.63209680658485
INFO:tensorflow:Average training steps per second: 234.12
I0902 17:58:33.453998 140110082734080 replay_runner.py:36] Average training steps per second: 234.12
I0902 17:58:33.691515 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.95
INFO:tensorflow:Starting iteration 20

Steps executed: 212 Episode length: 212 Return: -165.93545462320043
INFO:tensorflow:Average training steps per second: 223.43
I0902 17:58:42.488108 140110082734080 replay_runner.py:36] Average training steps per second: 223.43
I0902 17:58:42.703943 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.94
INFO:tensorflow:Starting iteration 21

Steps executed: 322 Episode length: 174 Return: -101.09086614040163
INFO:tensorflow:Average training steps per second: 231.35
I0902 17:58:51.441150 140110082734080 replay_runner.py:36] Average training steps per second: 231.35
I0902 17:58:51.727760 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.17
INFO:tensorflow:Starting iteration 22

Steps executed: 277 Episode length: 171 Return: -234.88236109432634
INFO:tensorflow:Average training steps per second: 232.82
I0902 17:59:00.446397 140110082734080 replay_runner.py:36] Average training steps per second: 232.82
I0902 17:59:00.679716 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.19
INFO:tensorflow:Starting iteration 23
I0902 17:59:04.880539 140110082734080 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 241.27
I0902 17:59:09.026118 140110082734080 replay_runner.py:36] Average training steps per second: 241.27

Steps executed: 295 Episode length: 145 Return: -224.45699081750715
INFO:tensorflow:Starting iteration 24

Steps executed: 292 Episode length: 193 Return: -344.19169697602915
INFO:tensorflow:Average training steps per second: 238.69
I0902 17:59:17.806421 140110082734080 replay_runner.py:36] Average training steps per second: 238.69
I0902 17:59:18.084084 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.36
INFO:tensorflow:Starting iteration 25

Steps executed: 285 Episode length: 124 Return: -155.80502098358815
INFO:tensorflow:Average training steps per second: 234.40
I0902 17:59:26.731174 140110082734080 replay_runner.py:36] Average training steps per second: 234.40
I0902 17:59:26.982846 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -203.19
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 112 Return: -139.28738513074146
INFO:tensorflow:Average training steps per second: 228.76
I0902 17:59:35.707938 140110082734080 replay_runner.py:36] Average training steps per second: 228.76
I0902 17:59:35.915037 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.60
INFO:tensorflow:Starting iteration 27

Steps executed: 201 Episode length: 201 Return: -451.36454879713646
INFO:tensorflow:Average training steps per second: 238.04
I0902 17:59:44.517226 140110082734080 replay_runner.py:36] Average training steps per second: 238.04
I0902 17:59:44.709067 140110082734080 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.36
INFO:tensorflow:Starting iteration 28
I0902 17:59:49.043784 140110082734080 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 244.81
I0902 17:59:53.128843 140110082734080 replay_runner.py:36] Average training steps per second: 244.81

Steps executed: 236 Episode length: 236 Return: -230.82936569605744
INFO:tensorflow:Starting iteration 29

Steps executed: 283 Episode length: 122 Return: -207.73616556495608
INFO:tensorflow:Average training steps per second: 242.64
I0902 18:00:01.869049 140110082734080 replay_runner.py:36] Average training steps per second: 242.64

Done fixed training!Episode length: 122 Return: -207.73616556495608