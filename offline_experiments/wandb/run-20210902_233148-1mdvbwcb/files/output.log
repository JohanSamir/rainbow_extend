Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0902 23:31:55.209416 140561847887872 run_experiment.py:549] Creating TrainRunner ...
I0902 23:31:55.219307 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:55.219581 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:55.219719 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:55.219849 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:55.219964 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:55.220073 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:55.220231 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:55.220412 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:55.220535 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:55.220645 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:55.220758 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:55.220889 140561847887872 dqn_agent.py:283] 	 seed: 1630625515219227
I0902 23:31:55.223926 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:55.224131 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:55.224265 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:55.224396 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:55.224506 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:55.224618 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:55.224717 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:55.224820 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:55.224901 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:55.267356 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:55.751821 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:55.765257 140561847887872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:31:55.774286 140561847887872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:31:55.774554 140561847887872 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:31:55.774806 140561847887872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:31:55.774972 140561847887872 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:31:55.775101 140561847887872 dqn_agent.py:275] 	 update_period: 4
I0902 23:31:55.775299 140561847887872 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:31:55.775452 140561847887872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:31:55.775534 140561847887872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:31:55.775664 140561847887872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:31:55.775784 140561847887872 dqn_agent.py:280] 	 optimizer: adam
I0902 23:31:55.775913 140561847887872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:31:55.776007 140561847887872 dqn_agent.py:283] 	 seed: 1630625515774233
I0902 23:31:55.778246 140561847887872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:31:55.778432 140561847887872 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:31:55.778671 140561847887872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:31:55.778831 140561847887872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:31:55.778944 140561847887872 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:31:55.779114 140561847887872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:31:55.779344 140561847887872 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:31:55.779489 140561847887872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:31:55.779617 140561847887872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:31:55.816289 140561847887872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:31:55.839509 140561847887872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:31:55.839721 140561847887872 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 139.59
I0902 23:32:03.003659 140561847887872 replay_runner.py:36] Average training steps per second: 139.59
I0902 23:32:04.541971 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:32:04.782302 140561847887872 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 188.58
I0902 23:32:10.085638 140561847887872 replay_runner.py:36] Average training steps per second: 188.58
I0902 23:32:10.510868 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 23:32:10.742409 140561847887872 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.86
I0902 23:32:16.009831 140561847887872 replay_runner.py:36] Average training steps per second: 189.86
I0902 23:32:16.405829 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 630 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.95
I0902 23:32:21.960940 140561847887872 replay_runner.py:36] Average training steps per second: 187.95
I0902 23:32:22.522434 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.50
INFO:tensorflow:Starting iteration 4

Steps executed: 403 Episode length: 238 Return: -237.0
INFO:tensorflow:Average training steps per second: 193.36
I0902 23:32:27.936738 140561847887872 replay_runner.py:36] Average training steps per second: 193.36
I0902 23:32:28.275252 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.50
INFO:tensorflow:Starting iteration 5

Steps executed: 659 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.82
I0902 23:32:33.894277 140561847887872 replay_runner.py:36] Average training steps per second: 185.82
I0902 23:32:34.447297 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.00
INFO:tensorflow:Starting iteration 6

Steps executed: 385 Episode length: 221 Return: -220.0
INFO:tensorflow:Average training steps per second: 195.68
I0902 23:32:39.798701 140561847887872 replay_runner.py:36] Average training steps per second: 195.68
I0902 23:32:40.104092 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.33
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.84
I0902 23:32:45.596010 140561847887872 replay_runner.py:36] Average training steps per second: 189.84
I0902 23:32:45.996204 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 230 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 195.91
I0902 23:32:51.342824 140561847887872 replay_runner.py:36] Average training steps per second: 195.91
I0902 23:32:51.539527 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 9

Steps executed: 108 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 188.94

Steps executed: 256 Episode length: 63 Return: -62.0.0
I0902 23:32:57.293882 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 10

Steps executed: 332 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 190.44
I0902 23:33:02.795346 140561847887872 replay_runner.py:36] Average training steps per second: 190.44
I0902 23:33:03.048257 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.67
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.41
I0902 23:33:08.331123 140561847887872 replay_runner.py:36] Average training steps per second: 198.41
I0902 23:33:08.758616 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 327 Episode length: 130 Return: -129.0
INFO:tensorflow:Average training steps per second: 189.28
I0902 23:33:14.284796 140561847887872 replay_runner.py:36] Average training steps per second: 189.28
I0902 23:33:14.567156 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 13

Steps executed: 201 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 192.25
I0902 23:33:19.996115 140561847887872 replay_runner.py:36] Average training steps per second: 192.25
I0902 23:33:20.172261 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 14

Steps executed: 245 Episode length: 62 Return: -61.0.0
INFO:tensorflow:Average training steps per second: 192.34
I0902 23:33:25.612778 140561847887872 replay_runner.py:36] Average training steps per second: 192.34
I0902 23:33:25.814257 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 15

Steps executed: 77 Episode length: 77 Return: -76.00.0
INFO:tensorflow:Average training steps per second: 186.96

Steps executed: 256 Episode length: 78 Return: -77.0.0
I0902 23:33:31.633744 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 16
I0902 23:33:31.865359 140561847887872 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 191.12

Steps executed: 318 Episode length: 137 Return: -136.0
I0902 23:33:37.363627 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 17

Steps executed: 233 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 194.61
I0902 23:33:42.732684 140561847887872 replay_runner.py:36] Average training steps per second: 194.61
I0902 23:33:42.920893 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 18

Steps executed: 225 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 196.17
I0902 23:33:48.251317 140561847887872 replay_runner.py:36] Average training steps per second: 196.17
I0902 23:33:48.436527 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 19

Steps executed: 257 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 194.08
I0902 23:33:53.826065 140561847887872 replay_runner.py:36] Average training steps per second: 194.08
I0902 23:33:54.018416 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 20

Steps executed: 319 Episode length: 140 Return: -139.0
INFO:tensorflow:Average training steps per second: 188.93
I0902 23:33:59.541791 140561847887872 replay_runner.py:36] Average training steps per second: 188.93
I0902 23:33:59.794360 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.33
INFO:tensorflow:Starting iteration 21

Steps executed: 254 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 196.32
I0902 23:34:05.123488 140561847887872 replay_runner.py:36] Average training steps per second: 196.32
I0902 23:34:05.333949 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 22

Steps executed: 235 Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 193.23
I0902 23:34:10.759752 140561847887872 replay_runner.py:36] Average training steps per second: 193.23
I0902 23:34:10.951807 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.25
I0902 23:34:16.360748 140561847887872 replay_runner.py:36] Average training steps per second: 193.25
I0902 23:34:16.782784 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 258 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 198.14
I0902 23:34:22.069302 140561847887872 replay_runner.py:36] Average training steps per second: 198.14
I0902 23:34:22.287847 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 25
I0902 23:34:22.516857 140561847887872 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 203.10

Steps executed: 233 Episode length: 81 Return: -80.0.0
I0902 23:34:27.679668 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 26

Steps executed: 247 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 200.58
I0902 23:34:32.894196 140561847887872 replay_runner.py:36] Average training steps per second: 200.58
I0902 23:34:33.087198 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 27

Steps executed: 262 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 199.84
I0902 23:34:38.323704 140561847887872 replay_runner.py:36] Average training steps per second: 199.84
I0902 23:34:38.528030 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 28

Steps executed: 279 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 196.31
I0902 23:34:43.855805 140561847887872 replay_runner.py:36] Average training steps per second: 196.31
I0902 23:34:44.073441 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 29

Steps executed: 101 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 192.30

Done fixed training!Episode length: 500 Return: -500.0
I0902 23:34:50.025360 140561847887872 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.00