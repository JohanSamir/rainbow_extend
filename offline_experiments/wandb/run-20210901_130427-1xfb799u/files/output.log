Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0901 13:04:33.636739 140298343233536 run_experiment.py:549] Creating TrainRunner ...
I0901 13:04:33.647131 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:04:33.647327 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:04:33.647424 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:04:33.647527 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:04:33.647619 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:04:33.647692 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:04:33.647791 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:04:33.647907 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:04:33.648006 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:04:33.648084 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:04:33.648145 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:04:33.648247 140298343233536 dqn_agent.py:283] 	 seed: 1630501473647079
I0901 13:04:33.650762 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:04:33.650966 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:04:33.651107 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:04:33.651179 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:04:33.651244 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:04:33.651336 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:04:33.651398 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:04:33.651457 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:04:33.651574 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:04:33.687228 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:33.995452 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:34.008310 140298343233536 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:04:34.016751 140298343233536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:04:34.016921 140298343233536 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:04:34.016999 140298343233536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:04:34.017130 140298343233536 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:04:34.017406 140298343233536 dqn_agent.py:275] 	 update_period: 4
I0901 13:04:34.017501 140298343233536 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:04:34.017600 140298343233536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:04:34.017771 140298343233536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:04:34.017977 140298343233536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:04:34.018061 140298343233536 dqn_agent.py:280] 	 optimizer: adam
I0901 13:04:34.018153 140298343233536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:04:34.018270 140298343233536 dqn_agent.py:283] 	 seed: 1630501474016715
I0901 13:04:34.020537 140298343233536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:04:34.020693 140298343233536 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:04:34.020791 140298343233536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:04:34.020883 140298343233536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:04:34.020964 140298343233536 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:04:34.021075 140298343233536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:04:34.021155 140298343233536 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:04:34.021262 140298343233536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:04:34.021350 140298343233536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:04:34.048614 140298343233536 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:04:34.067974 140298343233536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:04:34.068225 140298343233536 replay_runner.py:41] Starting iteration 0
Steps executed: 217 Episode length: 124 Return: -284.9854240985959
INFO:tensorflow:Average training steps per second: 188.23
I0901 13:04:39.381153 140298343233536 replay_runner.py:36] Average training steps per second: 188.23
I0901 13:04:40.378641 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.35
INFO:tensorflow:Starting iteration 1

Steps executed: 258 Episode length: 133 Return: -480.14409692814235
INFO:tensorflow:Average training steps per second: 272.79
I0901 13:04:47.878570 140298343233536 replay_runner.py:36] Average training steps per second: 272.79
I0901 13:04:48.084022 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.81
INFO:tensorflow:Starting iteration 2

Steps executed: 298 Episode length: 116 Return: -328.11812441422815
INFO:tensorflow:Average training steps per second: 287.41
I0901 13:04:55.383205 140298343233536 replay_runner.py:36] Average training steps per second: 287.41
I0901 13:04:55.571245 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.68
INFO:tensorflow:Starting iteration 3

Steps executed: 274 Episode length: 84 Return: -382.571846757655685
INFO:tensorflow:Average training steps per second: 275.76
I0901 13:05:03.075481 140298343233536 replay_runner.py:36] Average training steps per second: 275.76
I0901 13:05:03.270958 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.16
INFO:tensorflow:Starting iteration 4

Steps executed: 227 Episode length: 74 Return: -288.065793001295965
INFO:tensorflow:Average training steps per second: 268.88
I0901 13:05:10.782814 140298343233536 replay_runner.py:36] Average training steps per second: 268.88
I0901 13:05:10.923542 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.00
INFO:tensorflow:Starting iteration 5

Steps executed: 267 Episode length: 143 Return: -69.187593586550225
INFO:tensorflow:Average training steps per second: 269.72
I0901 13:05:18.425124 140298343233536 replay_runner.py:36] Average training steps per second: 269.72
I0901 13:05:18.624724 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.84
INFO:tensorflow:Starting iteration 6

Steps executed: 254 Episode length: 69 Return: -119.851308694630295
INFO:tensorflow:Average training steps per second: 270.56
I0901 13:05:26.035495 140298343233536 replay_runner.py:36] Average training steps per second: 270.56
I0901 13:05:26.192726 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.82
INFO:tensorflow:Starting iteration 7
I0901 13:05:29.900314 140298343233536 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 275.17

Steps executed: 202 Episode length: 202 Return: -133.72856274970525
I0901 13:05:33.717221 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.73
INFO:tensorflow:Starting iteration 8

Steps executed: 267 Episode length: 73 Return: -303.163089415745165
INFO:tensorflow:Average training steps per second: 280.64
I0901 13:05:40.986199 140298343233536 replay_runner.py:36] Average training steps per second: 280.64
I0901 13:05:41.138634 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.58
INFO:tensorflow:Starting iteration 9

Steps executed: 276 Episode length: 82 Return: -322.880120144610314
INFO:tensorflow:Average training steps per second: 285.33
I0901 13:05:48.281145 140298343233536 replay_runner.py:36] Average training steps per second: 285.33
I0901 13:05:48.448830 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.98
INFO:tensorflow:Starting iteration 10

Steps executed: 234 Episode length: 77 Return: -216.058042947045754
INFO:tensorflow:Average training steps per second: 294.56
I0901 13:05:55.401704 140298343233536 replay_runner.py:36] Average training steps per second: 294.56
I0901 13:05:55.539345 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.53
INFO:tensorflow:Starting iteration 11

Steps executed: 414 Episode length: 294 Return: -101.32195599085107
INFO:tensorflow:Average training steps per second: 288.44
I0901 13:06:02.549081 140298343233536 replay_runner.py:36] Average training steps per second: 288.44
I0901 13:06:02.942254 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.55
INFO:tensorflow:Starting iteration 12

Steps executed: 81 Episode length: 81 Return: -243.0620311738825307
INFO:tensorflow:Average training steps per second: 298.93

Steps executed: 275 Episode length: 87 Return: -279.707747279158815
I0901 13:06:09.907102 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.01
INFO:tensorflow:Starting iteration 13

Steps executed: 210 Episode length: 65 Return: -324.236708729892145
INFO:tensorflow:Average training steps per second: 298.90
I0901 13:06:16.721838 140298343233536 replay_runner.py:36] Average training steps per second: 298.90
I0901 13:06:16.829623 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.63
INFO:tensorflow:Starting iteration 14
I0901 13:06:20.221667 140298343233536 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 304.33
I0901 13:06:23.507854 140298343233536 replay_runner.py:36] Average training steps per second: 304.33

Steps executed: 211 Episode length: 53 Return: -129.016790332531835
INFO:tensorflow:Starting iteration 15

Steps executed: 207 Episode length: 104 Return: -94.557794989910115
INFO:tensorflow:Average training steps per second: 303.04
I0901 13:06:30.327251 140298343233536 replay_runner.py:36] Average training steps per second: 303.04
I0901 13:06:30.448715 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.00
INFO:tensorflow:Starting iteration 16

Steps executed: 222 Episode length: 137 Return: -211.36351435614765
INFO:tensorflow:Average training steps per second: 305.94
I0901 13:06:37.099095 140298343233536 replay_runner.py:36] Average training steps per second: 305.94
I0901 13:06:37.242089 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.08
INFO:tensorflow:Starting iteration 17

Steps executed: 216 Episode length: 76 Return: -497.012178975799955
INFO:tensorflow:Average training steps per second: 308.52
I0901 13:06:43.836377 140298343233536 replay_runner.py:36] Average training steps per second: 308.52
I0901 13:06:43.973547 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.96
INFO:tensorflow:Starting iteration 18

Steps executed: 367 Episode length: 220 Return: -781.73099555966816
INFO:tensorflow:Average training steps per second: 310.66
I0901 13:06:50.575031 140298343233536 replay_runner.py:36] Average training steps per second: 310.66
I0901 13:06:50.855082 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.24
INFO:tensorflow:Starting iteration 19

Steps executed: 211 Episode length: 69 Return: -359.332659705180736
INFO:tensorflow:Average training steps per second: 306.56
I0901 13:06:57.477471 140298343233536 replay_runner.py:36] Average training steps per second: 306.56
I0901 13:06:57.590559 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.64
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 87 Return: -463.113490474382736
INFO:tensorflow:Average training steps per second: 306.46
I0901 13:07:04.204745 140298343233536 replay_runner.py:36] Average training steps per second: 306.46
I0901 13:07:04.364180 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -655.38
INFO:tensorflow:Starting iteration 21

Steps executed: 230 Episode length: 145 Return: -315.69879332994756
INFO:tensorflow:Average training steps per second: 314.55
I0901 13:07:10.886572 140298343233536 replay_runner.py:36] Average training steps per second: 314.55
I0901 13:07:11.011285 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.54
INFO:tensorflow:Starting iteration 22

Steps executed: 249 Episode length: 79 Return: -359.976068271745936
INFO:tensorflow:Average training steps per second: 306.36
I0901 13:07:17.621654 140298343233536 replay_runner.py:36] Average training steps per second: 306.36
I0901 13:07:17.775817 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.71
INFO:tensorflow:Starting iteration 23

Steps executed: 232 Episode length: 73 Return: -512.034312464049736
INFO:tensorflow:Average training steps per second: 314.23
I0901 13:07:24.314464 140298343233536 replay_runner.py:36] Average training steps per second: 314.23
I0901 13:07:24.457956 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.49
INFO:tensorflow:Starting iteration 24

Steps executed: 253 Episode length: 72 Return: -457.301533501859354
INFO:tensorflow:Average training steps per second: 314.15
I0901 13:07:30.971635 140298343233536 replay_runner.py:36] Average training steps per second: 314.15
I0901 13:07:31.147821 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.36
INFO:tensorflow:Starting iteration 25

Steps executed: 258 Episode length: 70 Return: -351.739396107508478
INFO:tensorflow:Average training steps per second: 310.80
I0901 13:07:37.724990 140298343233536 replay_runner.py:36] Average training steps per second: 310.80
I0901 13:07:37.895923 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.90
INFO:tensorflow:Starting iteration 26

Steps executed: 284 Episode length: 114 Return: -541.55915796482538
INFO:tensorflow:Average training steps per second: 313.76
I0901 13:07:44.449259 140298343233536 replay_runner.py:36] Average training steps per second: 313.76
I0901 13:07:44.633515 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -573.20
INFO:tensorflow:Starting iteration 27

Steps executed: 213 Episode length: 79 Return: -711.412645100330638
INFO:tensorflow:Average training steps per second: 319.66
I0901 13:07:51.140993 140298343233536 replay_runner.py:36] Average training steps per second: 319.66
I0901 13:07:51.268295 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.06
INFO:tensorflow:Starting iteration 28

Steps executed: 234 Episode length: 50 Return: -412.155583130382078
INFO:tensorflow:Average training steps per second: 311.90
I0901 13:07:57.813817 140298343233536 replay_runner.py:36] Average training steps per second: 311.90
I0901 13:07:57.996995 140298343233536 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.92
INFO:tensorflow:Starting iteration 29

Steps executed: 215 Episode length: 79 Return: -427.614368067973648
INFO:tensorflow:Average training steps per second: 315.42
I0901 13:08:04.468825 140298343233536 replay_runner.py:36] Average training steps per second: 315.42

Done fixed training!Episode length: 79 Return: -427.614368067973648