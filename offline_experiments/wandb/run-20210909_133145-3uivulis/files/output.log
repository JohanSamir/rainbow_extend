Loaded trained dqn in mountaincar
Training fixed agent 10, please be patient, may be a while...
I0909 13:31:51.020901 140037799155712 run_experiment.py:549] Creating TrainRunner ...
I0909 13:31:51.026562 140037799155712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:51.026686 140037799155712 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:51.026742 140037799155712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:51.026826 140037799155712 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:51.026895 140037799155712 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:51.026955 140037799155712 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:51.027002 140037799155712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:51.027092 140037799155712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:51.027170 140037799155712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:51.027248 140037799155712 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:51.027301 140037799155712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:51.027369 140037799155712 dqn_agent.py:283] 	 seed: 1631194311026532
I0909 13:31:51.028828 140037799155712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:51.028934 140037799155712 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:51.029028 140037799155712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:51.029118 140037799155712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:51.029177 140037799155712 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:51.029229 140037799155712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:51.029302 140037799155712 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:51.029349 140037799155712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:51.029439 140037799155712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:52.123234 140037799155712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:52.293450 140037799155712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:52.301185 140037799155712 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:31:52.305761 140037799155712 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:31:52.305891 140037799155712 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:31:52.305990 140037799155712 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:31:52.306091 140037799155712 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:31:52.306157 140037799155712 dqn_agent.py:275] 	 update_period: 4
I0909 13:31:52.306210 140037799155712 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:31:52.306308 140037799155712 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:31:52.306399 140037799155712 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:31:52.306498 140037799155712 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:31:52.306590 140037799155712 dqn_agent.py:280] 	 optimizer: adam
I0909 13:31:52.306650 140037799155712 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:31:52.306737 140037799155712 dqn_agent.py:283] 	 seed: 1631194312305733
I0909 13:31:52.308063 140037799155712 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:31:52.308163 140037799155712 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:31:52.308226 140037799155712 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:31:52.308281 140037799155712 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:31:52.308345 140037799155712 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:31:52.308424 140037799155712 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:31:52.308513 140037799155712 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:31:52.308587 140037799155712 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:31:52.308663 140037799155712 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:31:52.326141 140037799155712 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:31:52.337363 140037799155712 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:31:52.337509 140037799155712 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 290.28
I0909 13:31:55.782662 140037799155712 replay_runner.py:36] Average training steps per second: 290.28
I0909 13:31:56.434546 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:31:56.499784 140037799155712 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 385.97
I0909 13:31:59.090848 140037799155712 replay_runner.py:36] Average training steps per second: 385.97
I0909 13:31:59.214417 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:31:59.277066 140037799155712 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 387.49
I0909 13:32:01.858027 140037799155712 replay_runner.py:36] Average training steps per second: 387.49
I0909 13:32:01.980295 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:32:02.047877 140037799155712 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 387.83

Steps executed: 754 Episode length: 600 Return: -600.0
I0909 13:32:04.788014 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.00
INFO:tensorflow:Starting iteration 4

Steps executed: 290 Episode length: 177 Return: -177.0
INFO:tensorflow:Average training steps per second: 387.91
I0909 13:32:07.431113 140037799155712 replay_runner.py:36] Average training steps per second: 387.91
I0909 13:32:07.493415 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 5

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 383.22
I0909 13:32:10.166773 140037799155712 replay_runner.py:36] Average training steps per second: 383.22
I0909 13:32:10.290208 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6

Steps executed: 227 Episode length: 227 Return: -227.0
INFO:tensorflow:Average training steps per second: 387.79
I0909 13:32:12.933087 140037799155712 replay_runner.py:36] Average training steps per second: 387.79
I0909 13:32:12.979961 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.00
INFO:tensorflow:Starting iteration 7

Steps executed: 693 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 390.09
I0909 13:32:15.610615 140037799155712 replay_runner.py:36] Average training steps per second: 390.09
I0909 13:32:15.757628 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.50
INFO:tensorflow:Starting iteration 8

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 387.87
I0909 13:32:18.401090 140037799155712 replay_runner.py:36] Average training steps per second: 387.87
I0909 13:32:18.524041 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:32:18.586966 140037799155712 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 385.99
I0909 13:32:21.177969 140037799155712 replay_runner.py:36] Average training steps per second: 385.99
I0909 13:32:21.305196 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:32:21.371268 140037799155712 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 389.72
I0909 13:32:23.937419 140037799155712 replay_runner.py:36] Average training steps per second: 389.72
I0909 13:32:24.061610 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 300 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 392.25
I0909 13:32:26.675962 140037799155712 replay_runner.py:36] Average training steps per second: 392.25
I0909 13:32:26.741816 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 12

Steps executed: 799 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 387.52
I0909 13:32:29.388102 140037799155712 replay_runner.py:36] Average training steps per second: 387.52
I0909 13:32:29.550226 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.33
INFO:tensorflow:Starting iteration 13

Steps executed: 236 Episode length: 121 Return: -121.0
INFO:tensorflow:Average training steps per second: 394.44
I0909 13:32:32.150205 140037799155712 replay_runner.py:36] Average training steps per second: 394.44
I0909 13:32:32.199815 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 14
I0909 13:32:32.263450 140037799155712 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 372.60
I0909 13:32:34.947602 140037799155712 replay_runner.py:36] Average training steps per second: 372.60

Steps executed: 232 Episode length: 114 Return: -114.0
INFO:tensorflow:Starting iteration 15

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 383.35
I0909 13:32:37.675717 140037799155712 replay_runner.py:36] Average training steps per second: 383.35
I0909 13:32:37.719638 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 16

Steps executed: 304 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 387.59
I0909 13:32:40.364156 140037799155712 replay_runner.py:36] Average training steps per second: 387.59
I0909 13:32:40.432541 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.33
INFO:tensorflow:Starting iteration 17
I0909 13:32:40.497124 140037799155712 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 391.00

Steps executed: 249 Episode length: 164 Return: -164.0
I0909 13:32:43.108428 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 18

Steps executed: 296 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 389.70
I0909 13:32:45.739338 140037799155712 replay_runner.py:36] Average training steps per second: 389.70
I0909 13:32:45.802385 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 19

Steps executed: 303 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 391.04
I0909 13:32:48.425268 140037799155712 replay_runner.py:36] Average training steps per second: 391.04
I0909 13:32:48.489311 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 20
I0909 13:32:48.554174 140037799155712 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 386.64
I0909 13:32:51.140826 140037799155712 replay_runner.py:36] Average training steps per second: 386.64

Steps executed: 200 Episode length: 101 Return: -101.0
INFO:tensorflow:Starting iteration 21

Steps executed: 217 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 384.35
I0909 13:32:53.859627 140037799155712 replay_runner.py:36] Average training steps per second: 384.35
I0909 13:32:53.905911 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 22
I0909 13:32:53.969419 140037799155712 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 382.30
I0909 13:32:56.585402 140037799155712 replay_runner.py:36] Average training steps per second: 382.30
I0909 13:32:56.632507 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 23
I0909 13:32:56.698192 140037799155712 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 387.99

Steps executed: 215 Episode length: 108 Return: -108.0
I0909 13:32:59.321831 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 24

Steps executed: 234 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 389.16
I0909 13:33:01.956283 140037799155712 replay_runner.py:36] Average training steps per second: 389.16
I0909 13:33:02.005582 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 25

Steps executed: 210 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 395.07
I0909 13:33:04.600947 140037799155712 replay_runner.py:36] Average training steps per second: 395.07
I0909 13:33:04.645231 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 26
I0909 13:33:04.709683 140037799155712 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 385.02
I0909 13:33:07.307154 140037799155712 replay_runner.py:36] Average training steps per second: 385.02

Steps executed: 212 Episode length: 106 Return: -106.0
INFO:tensorflow:Starting iteration 27

Steps executed: 294 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 386.22
I0909 13:33:10.009827 140037799155712 replay_runner.py:36] Average training steps per second: 386.22
I0909 13:33:10.075637 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 28

Steps executed: 283 Episode length: 88 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 387.40
I0909 13:33:12.722629 140037799155712 replay_runner.py:36] Average training steps per second: 387.40
I0909 13:33:12.784400 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 392.31
I0909 13:33:15.397621 140037799155712 replay_runner.py:36] Average training steps per second: 392.31
I0909 13:33:15.443243 140037799155712 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50