Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:34:32.268957 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:32.278590 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:32.278901 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:32.279105 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:32.279288 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:32.279470 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:32.279628 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:32.279775 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:32.279902 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:32.280004 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:32.280116 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:32.280216 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:32.280316 140320049072128 dqn_agent.py:283] 	 seed: 1630499672278516
I0901 12:34:32.283148 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:32.283303 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:32.283405 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:32.283491 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:32.283583 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:32.283748 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:32.283936 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:32.284060 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:32.284164 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:32.327739 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:32.783646 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:32.797020 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:32.835091 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:32.835408 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:32.835583 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:32.835747 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:32.835830 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:32.835921 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:32.836053 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:32.836155 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:32.836299 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:32.836533 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:32.836622 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:32.836700 140320049072128 dqn_agent.py:283] 	 seed: 1630499672835036
I0901 12:34:32.838696 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:32.838857 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:32.838937 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:32.839000 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:32.839087 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:32.839144 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:32.839198 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:32.839422 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:32.839521 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:32.876430 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:32.898498 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:32.898727 140320049072128 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.74
I0901 12:34:39.808136 140320049072128 replay_runner.py:36] Average training steps per second: 144.74
I0901 12:34:41.380637 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:34:41.616710 140320049072128 replay_runner.py:41] Starting iteration 1
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.27
I0901 12:34:46.845431 140320049072128 replay_runner.py:36] Average training steps per second: 191.27
I0901 12:34:47.279814 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:34:47.534015 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 200.32
I0901 12:34:52.526380 140320049072128 replay_runner.py:36] Average training steps per second: 200.32
I0901 12:34:52.934726 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:34:53.165699 140320049072128 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 187.88
I0901 12:34:58.488572 140320049072128 replay_runner.py:36] Average training steps per second: 187.88
I0901 12:34:58.881407 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:34:59.115758 140320049072128 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 191.28
I0901 12:35:04.344231 140320049072128 replay_runner.py:36] Average training steps per second: 191.28
I0901 12:35:04.800115 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:35:05.060910 140320049072128 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 187.53
I0901 12:35:10.393816 140320049072128 replay_runner.py:36] Average training steps per second: 187.53
I0901 12:35:10.818043 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:35:11.057660 140320049072128 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 184.32
I0901 12:35:16.483474 140320049072128 replay_runner.py:36] Average training steps per second: 184.32
I0901 12:35:16.932378 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:35:17.174579 140320049072128 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 199.25

Steps executed: 253 Episode length: 253 Return: -252.0
I0901 12:35:22.429333 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.00
INFO:tensorflow:Starting iteration 8
I0901 12:35:22.684453 140320049072128 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 182.91

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:35:28.586786 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 12:35:28.814816 140320049072128 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 185.37
I0901 12:35:34.209750 140320049072128 replay_runner.py:36] Average training steps per second: 185.37
I0901 12:35:34.690637 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:35:34.956984 140320049072128 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 190.79
I0901 12:35:40.198662 140320049072128 replay_runner.py:36] Average training steps per second: 190.79
I0901 12:35:40.629919 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:35:40.880592 140320049072128 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 186.17

Steps executed: 495 Episode length: 495 Return: -494.0
I0901 12:35:46.688465 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.00
INFO:tensorflow:Starting iteration 12
I0901 12:35:46.938695 140320049072128 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 188.52

Steps executed: 692 Episode length: 500 Return: -500.0
I0901 12:35:52.929433 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.50
INFO:tensorflow:Starting iteration 13

Steps executed: 79 Episode length: 79 Return: -78.00.0
INFO:tensorflow:Average training steps per second: 191.75

Steps executed: 251 Episode length: 82 Return: -81.0.0
I0901 12:35:58.624529 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 14

Steps executed: 315 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 189.16
I0901 12:36:04.155469 140320049072128 replay_runner.py:36] Average training steps per second: 189.16
I0901 12:36:04.464034 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 15
I0901 12:36:04.690745 140320049072128 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.46
I0901 12:36:09.969410 140320049072128 replay_runner.py:36] Average training steps per second: 189.46

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 16
I0901 12:36:10.676638 140320049072128 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 181.39
I0901 12:36:16.190291 140320049072128 replay_runner.py:36] Average training steps per second: 181.39
I0901 12:36:16.391227 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 17

Steps executed: 227 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 195.32

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:36:22.212606 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 318 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 186.73
I0901 12:36:27.826391 140320049072128 replay_runner.py:36] Average training steps per second: 186.73
I0901 12:36:28.120567 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 19

Steps executed: 248 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 189.63
I0901 12:36:33.646010 140320049072128 replay_runner.py:36] Average training steps per second: 189.63
I0901 12:36:33.889359 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 20

Steps executed: 327 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 189.40
I0901 12:36:39.414207 140320049072128 replay_runner.py:36] Average training steps per second: 189.40
I0901 12:36:39.727567 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 21

Steps executed: 216 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 188.53
I0901 12:36:45.286766 140320049072128 replay_runner.py:36] Average training steps per second: 188.53
I0901 12:36:45.489978 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.33
I0901 12:36:50.911299 140320049072128 replay_runner.py:36] Average training steps per second: 193.33
I0901 12:36:51.381325 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 12:36:51.634807 140320049072128 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.98
I0901 12:36:56.817322 140320049072128 replay_runner.py:36] Average training steps per second: 192.98
I0901 12:36:57.251966 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 12:36:57.489841 140320049072128 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 200.27
I0901 12:37:02.483573 140320049072128 replay_runner.py:36] Average training steps per second: 200.27
I0901 12:37:02.925235 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 199.45
I0901 12:37:08.179744 140320049072128 replay_runner.py:36] Average training steps per second: 199.45
I0901 12:37:08.381991 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.21
I0901 12:37:13.929562 140320049072128 replay_runner.py:36] Average training steps per second: 189.21
I0901 12:37:14.396355 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 304 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 196.98
I0901 12:37:19.772633 140320049072128 replay_runner.py:36] Average training steps per second: 196.98
I0901 12:37:20.027445 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.33
INFO:tensorflow:Starting iteration 28

Steps executed: 601 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.22
I0901 12:37:25.604580 140320049072128 replay_runner.py:36] Average training steps per second: 187.22
I0901 12:37:26.127374 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 191.91
I0901 12:37:31.582439 140320049072128 replay_runner.py:36] Average training steps per second: 191.91
I0901 12:37:31.813393 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00