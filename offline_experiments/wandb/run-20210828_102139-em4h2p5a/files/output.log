Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0828 10:21:45.451044 140527252379648 run_experiment.py:549] Creating TrainRunner ...
I0828 10:21:45.460465 140527252379648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:45.460762 140527252379648 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:45.460904 140527252379648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:45.461024 140527252379648 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:45.461177 140527252379648 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:45.461290 140527252379648 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:45.461475 140527252379648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:45.461588 140527252379648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:45.461757 140527252379648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:45.461902 140527252379648 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:45.462034 140527252379648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:45.462172 140527252379648 dqn_agent.py:283] 	 seed: 1630146105460404
I0828 10:21:45.465328 140527252379648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:45.465559 140527252379648 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:21:45.465715 140527252379648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:45.465881 140527252379648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:45.466058 140527252379648 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:45.466217 140527252379648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:45.466412 140527252379648 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:45.466550 140527252379648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:45.466671 140527252379648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:45.503163 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:45.875799 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:45.887066 140527252379648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:21:45.894078 140527252379648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:45.894249 140527252379648 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:45.894324 140527252379648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:45.894386 140527252379648 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:45.894443 140527252379648 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:45.894518 140527252379648 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:45.894615 140527252379648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:45.894694 140527252379648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:45.894748 140527252379648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:45.894845 140527252379648 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:45.894922 140527252379648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:45.895002 140527252379648 dqn_agent.py:283] 	 seed: 1630146105894042
I0828 10:21:45.896682 140527252379648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:45.896888 140527252379648 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:21:45.897103 140527252379648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:45.897224 140527252379648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:45.897337 140527252379648 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:45.897556 140527252379648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:45.897657 140527252379648 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:45.897761 140527252379648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:45.897843 140527252379648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:45.928048 140527252379648 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:45.984416 140527252379648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:21:45.984793 140527252379648 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 142.12
I0828 10:21:53.021167 140527252379648 replay_runner.py:36] Average training steps per second: 142.12
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:21:54.500559 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:21:54.719916 140527252379648 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 195.23
I0828 10:21:59.842564 140527252379648 replay_runner.py:36] Average training steps per second: 195.23
I0828 10:22:00.022297 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 2


Steps executed: 310 Episode length: 161 Return: -160.0
INFO:tensorflow:Average training steps per second: 199.16
I0828 10:22:05.313647 140527252379648 replay_runner.py:36] Average training steps per second: 199.16
I0828 10:22:05.572302 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.00
INFO:tensorflow:Starting iteration 3

Steps executed: 147 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 194.14
I0828 10:22:10.969796 140527252379648 replay_runner.py:36] Average training steps per second: 194.14
I0828 10:22:11.171130 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 4

Steps executed: 231 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 200.61
I0828 10:22:16.408377 140527252379648 replay_runner.py:36] Average training steps per second: 200.61
I0828 10:22:16.835820 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.05
I0828 10:22:22.186002 140527252379648 replay_runner.py:36] Average training steps per second: 196.05
I0828 10:22:22.375480 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 6

Steps executed: 236 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 191.37
I0828 10:22:27.829380 140527252379648 replay_runner.py:36] Average training steps per second: 191.37
I0828 10:22:28.102783 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.33
INFO:tensorflow:Starting iteration 7

Steps executed: 316 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 202.21

Steps executed: 276 Episode length: 152 Return: -151.0
I0828 10:22:33.526256 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.00
INFO:tensorflow:Starting iteration 8
I0828 10:22:33.757886 140527252379648 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 189.28
I0828 10:22:39.041438 140527252379648 replay_runner.py:36] Average training steps per second: 189.28

Steps executed: 300 Episode length: 191 Return: -190.0
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.94
I0828 10:22:44.607447 140527252379648 replay_runner.py:36] Average training steps per second: 195.94
I0828 10:22:45.024849 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:22:45.279704 140527252379648 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 198.99
I0828 10:22:50.305569 140527252379648 replay_runner.py:36] Average training steps per second: 198.99
I0828 10:22:50.689888 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:22:50.930126 140527252379648 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 188.85
I0828 10:22:56.225604 140527252379648 replay_runner.py:36] Average training steps per second: 188.85
I0828 10:22:56.641365 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0828 10:22:56.886062 140527252379648 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 197.24
I0828 10:23:01.956511 140527252379648 replay_runner.py:36] Average training steps per second: 197.24
I0828 10:23:02.389274 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:23:02.640410 140527252379648 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.77
I0828 10:23:07.775056 140527252379648 replay_runner.py:36] Average training steps per second: 194.77
I0828 10:23:08.161650 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:23:08.396130 140527252379648 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 208.58
I0828 10:23:13.191735 140527252379648 replay_runner.py:36] Average training steps per second: 208.58
I0828 10:23:13.568257 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:23:13.795703 140527252379648 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 191.04
I0828 10:23:19.030811 140527252379648 replay_runner.py:36] Average training steps per second: 191.04
I0828 10:23:19.412074 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:23:19.663359 140527252379648 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 200.73
I0828 10:23:24.645611 140527252379648 replay_runner.py:36] Average training steps per second: 200.73
I0828 10:23:25.065925 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:23:25.313223 140527252379648 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 192.04
I0828 10:23:30.520974 140527252379648 replay_runner.py:36] Average training steps per second: 192.04
I0828 10:23:30.924270 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:23:31.157067 140527252379648 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.62
I0828 10:23:36.192415 140527252379648 replay_runner.py:36] Average training steps per second: 198.62
I0828 10:23:36.621126 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:23:36.868678 140527252379648 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.36
I0828 10:23:41.987640 140527252379648 replay_runner.py:36] Average training steps per second: 195.36
I0828 10:23:42.380095 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:23:42.614559 140527252379648 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 193.86
I0828 10:23:47.773350 140527252379648 replay_runner.py:36] Average training steps per second: 193.86
I0828 10:23:48.179349 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:23:48.417149 140527252379648 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.39
I0828 10:23:53.458142 140527252379648 replay_runner.py:36] Average training steps per second: 198.39
I0828 10:23:53.884524 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:23:54.098735 140527252379648 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 196.05
I0828 10:23:59.199793 140527252379648 replay_runner.py:36] Average training steps per second: 196.05
I0828 10:23:59.588623 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:23:59.813709 140527252379648 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 194.37
I0828 10:24:04.958913 140527252379648 replay_runner.py:36] Average training steps per second: 194.37
I0828 10:24:05.385135 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:24:05.629785 140527252379648 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 194.85
I0828 10:24:10.762359 140527252379648 replay_runner.py:36] Average training steps per second: 194.85
I0828 10:24:11.187426 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:24:11.444509 140527252379648 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.02
I0828 10:24:16.546452 140527252379648 replay_runner.py:36] Average training steps per second: 196.02
I0828 10:24:16.924993 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:24:17.159380 140527252379648 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 204.36
I0828 10:24:22.053111 140527252379648 replay_runner.py:36] Average training steps per second: 204.36
I0828 10:24:22.432301 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:24:22.655895 140527252379648 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 210.31
I0828 10:24:27.411130 140527252379648 replay_runner.py:36] Average training steps per second: 210.31
I0828 10:24:27.806598 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:24:28.060010 140527252379648 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.67
I0828 10:24:32.922549 140527252379648 replay_runner.py:36] Average training steps per second: 205.67
I0828 10:24:33.286556 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 215.51
I0828 10:24:38.163158 140527252379648 replay_runner.py:36] Average training steps per second: 215.51
I0828 10:24:38.539201 140527252379648 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00