Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0828 10:51:23.664605 140078257940480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:51:23.673294 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:51:23.673446 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:51:23.673540 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:51:23.673610 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:51:23.673674 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:51:23.673769 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:51:23.673832 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:51:23.673924 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:51:23.674007 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:51:23.674092 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:51:23.674190 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:51:23.674251 140078257940480 dqn_agent.py:283] 	 seed: 1630147883673252
I0828 10:51:23.676599 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:51:23.676716 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:51:23.676797 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:51:23.676860 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:51:23.676917 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:51:23.676988 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:51:23.677045 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:51:23.677118 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:51:23.677178 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:51:23.703918 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:51:23.966266 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:51:23.977116 140078257940480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:51:24.030060 140078257940480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:51:24.030299 140078257940480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:51:24.030425 140078257940480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:51:24.030549 140078257940480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:51:24.030617 140078257940480 dqn_agent.py:275] 	 update_period: 4
I0828 10:51:24.030710 140078257940480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:51:24.030826 140078257940480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:51:24.030964 140078257940480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:51:24.031087 140078257940480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:51:24.031150 140078257940480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:51:24.031219 140078257940480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:51:24.031354 140078257940480 dqn_agent.py:283] 	 seed: 1630147884030011
I0828 10:51:24.033124 140078257940480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:51:24.033256 140078257940480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:51:24.033338 140078257940480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:51:24.033411 140078257940480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:51:24.033476 140078257940480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:51:24.033540 140078257940480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:51:24.033665 140078257940480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:51:24.033804 140078257940480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:51:24.033912 140078257940480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:51:24.059039 140078257940480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:51:24.077240 140078257940480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:51:24.077474 140078257940480 replay_runner.py:41] Starting iteration 0
Steps executed: 263 Episode length: 138 Return: -450.31725798904528
INFO:tensorflow:Average training steps per second: 236.99
I0828 10:51:28.297209 140078257940480 replay_runner.py:36] Average training steps per second: 236.99
I0828 10:51:29.127894 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.32
INFO:tensorflow:Starting iteration 1

Steps executed: 255 Episode length: 121 Return: -403.54505804456187
INFO:tensorflow:Average training steps per second: 328.49
I0828 10:51:35.556436 140078257940480 replay_runner.py:36] Average training steps per second: 328.49
I0828 10:51:35.703657 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.16
INFO:tensorflow:Starting iteration 2

Steps executed: 322 Episode length: 238 Return: -191.90401567888657
INFO:tensorflow:Average training steps per second: 327.39
I0828 10:51:42.166597 140078257940480 replay_runner.py:36] Average training steps per second: 327.39
I0828 10:51:42.377647 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.45
INFO:tensorflow:Starting iteration 3

Steps executed: 220 Episode length: 127 Return: -323.95245134053557
INFO:tensorflow:Average training steps per second: 333.48
I0828 10:51:48.777783 140078257940480 replay_runner.py:36] Average training steps per second: 333.48
I0828 10:51:48.915892 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.83
INFO:tensorflow:Starting iteration 4

Steps executed: 121 Episode length: 121 Return: -426.71758079985437
INFO:tensorflow:Average training steps per second: 334.54
I0828 10:51:55.298750 140078257940480 replay_runner.py:36] Average training steps per second: 334.54

Steps executed: 242 Episode length: 121 Return: -247.82945095317413
INFO:tensorflow:Starting iteration 5

Steps executed: 229 Episode length: 100 Return: -184.28270150862063
INFO:tensorflow:Average training steps per second: 332.28
I0828 10:52:01.885655 140078257940480 replay_runner.py:36] Average training steps per second: 332.28
I0828 10:52:02.024626 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.80
INFO:tensorflow:Starting iteration 6

Steps executed: 299 Episode length: 101 Return: -263.41245988641143
INFO:tensorflow:Average training steps per second: 333.68
I0828 10:52:08.486315 140078257940480 replay_runner.py:36] Average training steps per second: 333.68
I0828 10:52:08.654242 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.94
INFO:tensorflow:Starting iteration 7

Steps executed: 208 Episode length: 116 Return: -270.93538403318543
INFO:tensorflow:Average training steps per second: 338.39
I0828 10:52:15.063833 140078257940480 replay_runner.py:36] Average training steps per second: 338.39
I0828 10:52:15.180501 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.17
INFO:tensorflow:Starting iteration 8
I0828 10:52:18.656147 140078257940480 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 341.94
I0828 10:52:21.580922 140078257940480 replay_runner.py:36] Average training steps per second: 341.94

Steps executed: 223 Episode length: 83 Return: -336.158180475136173
INFO:tensorflow:Starting iteration 9

Steps executed: 226 Episode length: 104 Return: -234.29516257845194
INFO:tensorflow:Average training steps per second: 339.48
I0828 10:52:28.204625 140078257940480 replay_runner.py:36] Average training steps per second: 339.48
I0828 10:52:28.336125 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.41
INFO:tensorflow:Starting iteration 10

Steps executed: 206 Episode length: 132 Return: -160.96389651877968
INFO:tensorflow:Average training steps per second: 329.52
I0828 10:52:34.814941 140078257940480 replay_runner.py:36] Average training steps per second: 329.52
I0828 10:52:34.917641 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.95
INFO:tensorflow:Starting iteration 11

Steps executed: 229 Episode length: 101 Return: -208.29052755374085
INFO:tensorflow:Average training steps per second: 332.66
I0828 10:52:41.381946 140078257940480 replay_runner.py:36] Average training steps per second: 332.66
I0828 10:52:41.505451 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.96
INFO:tensorflow:Starting iteration 12
I0828 10:52:44.951820 140078257940480 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 334.98

Steps executed: 255 Episode length: 66 Return: -250.176301677895942
I0828 10:52:48.091449 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.87
INFO:tensorflow:Starting iteration 13

Steps executed: 221 Episode length: 87 Return: -348.544852949525787
INFO:tensorflow:Average training steps per second: 338.31
I0828 10:52:54.505119 140078257940480 replay_runner.py:36] Average training steps per second: 338.31
I0828 10:52:54.656754 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.78
INFO:tensorflow:Starting iteration 14

Steps executed: 297 Episode length: 160 Return: -377.34369606216404
INFO:tensorflow:Average training steps per second: 325.29
I0828 10:53:01.171629 140078257940480 replay_runner.py:36] Average training steps per second: 325.29
I0828 10:53:01.371648 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.95
INFO:tensorflow:Starting iteration 15


Steps executed: 246 Episode length: 129 Return: -84.412695083811854
INFO:tensorflow:Average training steps per second: 331.70
I0828 10:53:07.785119 140078257940480 replay_runner.py:36] Average training steps per second: 331.70
I0828 10:53:07.921424 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.14
INFO:tensorflow:Starting iteration 16

Steps executed: 214 Episode length: 82 Return: -253.091351661443277
INFO:tensorflow:Average training steps per second: 326.25
I0828 10:53:14.376842 140078257940480 replay_runner.py:36] Average training steps per second: 326.25
I0828 10:53:14.498314 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.87
INFO:tensorflow:Starting iteration 17

Steps executed: 317 Episode length: 177 Return: -586.53416994930635
INFO:tensorflow:Average training steps per second: 317.69
I0828 10:53:21.049647 140078257940480 replay_runner.py:36] Average training steps per second: 317.69
I0828 10:53:21.239455 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -539.42
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: -182.65907719380355
INFO:tensorflow:Average training steps per second: 318.79
I0828 10:53:27.747417 140078257940480 replay_runner.py:36] Average training steps per second: 318.79
I0828 10:53:27.865124 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.66
INFO:tensorflow:Starting iteration 19

Steps executed: 240 Episode length: 108 Return: -698.18506663276242
INFO:tensorflow:Average training steps per second: 316.92
I0828 10:53:34.377199 140078257940480 replay_runner.py:36] Average training steps per second: 316.92
I0828 10:53:34.517635 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.84
INFO:tensorflow:Starting iteration 20

Steps executed: 213 Episode length: 106 Return: -285.15643486124067
INFO:tensorflow:Average training steps per second: 319.58
I0828 10:53:41.047614 140078257940480 replay_runner.py:36] Average training steps per second: 319.58
I0828 10:53:41.155749 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.13
INFO:tensorflow:Starting iteration 21

Steps executed: 183 Episode length: 90 Return: -412.894418038851947
INFO:tensorflow:Average training steps per second: 328.43
I0828 10:53:47.562254 140078257940480 replay_runner.py:36] Average training steps per second: 328.43

Steps executed: 277 Episode length: 94 Return: -584.481959235807247
INFO:tensorflow:Starting iteration 22

Steps executed: 315 Episode length: 128 Return: -109.74834198530152
INFO:tensorflow:Average training steps per second: 340.55
I0828 10:53:54.070946 140078257940480 replay_runner.py:36] Average training steps per second: 340.55
I0828 10:53:54.249370 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.43
INFO:tensorflow:Starting iteration 23

Steps executed: 87 Episode length: 87 Return: -94.62123321338272152
INFO:tensorflow:Average training steps per second: 357.70

Steps executed: 1087 Episode length: 1000 Return: -31.24756985519366
I0828 10:54:02.561362 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -62.93
INFO:tensorflow:Starting iteration 24

Steps executed: 398 Episode length: 280 Return: -492.646404149760146
INFO:tensorflow:Average training steps per second: 352.45
I0828 10:54:08.629848 140078257940480 replay_runner.py:36] Average training steps per second: 352.45
I0828 10:54:08.939698 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.65
INFO:tensorflow:Starting iteration 25

Steps executed: 387 Episode length: 387 Return: -712.142327918531746
INFO:tensorflow:Average training steps per second: 339.39
I0828 10:54:15.229950 140078257940480 replay_runner.py:36] Average training steps per second: 339.39
I0828 10:54:15.599273 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -712.14
INFO:tensorflow:Starting iteration 26
I0828 10:54:18.890103 140078257940480 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 339.69
I0828 10:54:21.834222 140078257940480 replay_runner.py:36] Average training steps per second: 339.69

Steps executed: 221 Episode length: 114 Return: -506.919235103162146
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 109 Return: -556.527080625617346
INFO:tensorflow:Average training steps per second: 339.72
I0828 10:54:28.171180 140078257940480 replay_runner.py:36] Average training steps per second: 339.72
I0828 10:54:28.300185 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -522.48
INFO:tensorflow:Starting iteration 28

Steps executed: 284 Episode length: 90 Return: -169.3892863637280546
INFO:tensorflow:Average training steps per second: 347.27
I0828 10:54:34.569748 140078257940480 replay_runner.py:36] Average training steps per second: 347.27
I0828 10:54:34.732855 140078257940480 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.19
INFO:tensorflow:Starting iteration 29

Steps executed: 304 Episode length: 105 Return: -432.539104330766956
INFO:tensorflow:Average training steps per second: 353.26
I0828 10:54:41.068687 140078257940480 replay_runner.py:36] Average training steps per second: 353.26

Done fixed training!Episode length: 105 Return: -432.539104330766956