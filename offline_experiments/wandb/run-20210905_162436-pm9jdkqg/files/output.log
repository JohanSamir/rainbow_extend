I0905 16:24:41.502786 139967707396096 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:41.514085 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:41.514267 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:41.514399 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:41.514516 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:41.514624 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:41.514729 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:41.514840 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:41.514969 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:41.515115 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:41.515273 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:41.515408 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:41.515534 139967707396096 dqn_agent.py:283] 	 seed: 1630859081514042
I0905 16:24:41.518333 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:41.518493 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:41.518628 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:41.518749 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:41.518872 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:41.518979 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:41.519093 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:41.519194 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:41.519330 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:42.680286 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:42.997255 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:43.005318 139967707396096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 16:24:43.014425 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:43.014575 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:43.014691 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:43.014771 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:43.014849 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:43.014938 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:43.015019 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:43.015101 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:43.015181 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:43.015260 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:43.015340 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:43.015587 139967707396096 dqn_agent.py:283] 	 seed: 1630859083014392
I0905 16:24:43.017353 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:43.017467 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:43.017569 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:43.017652 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:43.017730 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:43.017814 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:43.017903 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:43.017984 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:43.018064 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:43.036477 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:43.048643 139967707396096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:43.048816 139967707396096 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 291.68
I0905 16:24:46.477419 139967707396096 replay_runner.py:36] Average training steps per second: 291.68
Steps executed: 277 Episode length: 121 Return: -320.70088966555446
I0905 16:24:47.164938 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.40
INFO:tensorflow:Starting iteration 1

Steps executed: 289 Episode length: 113 Return: -240.45931564337963
INFO:tensorflow:Average training steps per second: 419.34
I0905 16:24:52.666876 139967707396096 replay_runner.py:36] Average training steps per second: 419.34
I0905 16:24:52.782857 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.82
INFO:tensorflow:Starting iteration 2

Steps executed: 320 Episode length: 182 Return: -259.74078164509206
INFO:tensorflow:Average training steps per second: 402.58
I0905 16:24:58.371839 139967707396096 replay_runner.py:36] Average training steps per second: 402.58
I0905 16:24:58.525698 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.54
INFO:tensorflow:Starting iteration 3

Steps executed: 251 Episode length: 140 Return: -289.18253309413896
INFO:tensorflow:Average training steps per second: 320.11
I0905 16:25:04.846024 139967707396096 replay_runner.py:36] Average training steps per second: 320.11
I0905 16:25:04.943004 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.08
INFO:tensorflow:Starting iteration 4

Steps executed: 314 Episode length: 131 Return: -278.95846012881873
INFO:tensorflow:Average training steps per second: 408.94
I0905 16:25:10.697493 139967707396096 replay_runner.py:36] Average training steps per second: 408.94
I0905 16:25:10.834012 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.65
INFO:tensorflow:Starting iteration 5

Steps executed: 250 Episode length: 148 Return: -365.36467994049195
INFO:tensorflow:Average training steps per second: 411.10
I0905 16:25:16.410194 139967707396096 replay_runner.py:36] Average training steps per second: 411.10
I0905 16:25:16.511115 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.52
INFO:tensorflow:Starting iteration 6

Steps executed: 630 Episode length: 532 Return: -494.72449158655223
INFO:tensorflow:Average training steps per second: 391.95
I0905 16:25:22.191530 139967707396096 replay_runner.py:36] Average training steps per second: 391.95
I0905 16:25:22.792099 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.12
INFO:tensorflow:Starting iteration 7

Steps executed: 479 Episode length: 350 Return: -206.63853477189429
INFO:tensorflow:Average training steps per second: 397.96
I0905 16:25:28.426414 139967707396096 replay_runner.py:36] Average training steps per second: 397.96
I0905 16:25:28.720280 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.34
INFO:tensorflow:Starting iteration 8

Steps executed: 312 Episode length: 312 Return: -220.85976639294729
INFO:tensorflow:Average training steps per second: 401.47
I0905 16:25:34.324268 139967707396096 replay_runner.py:36] Average training steps per second: 401.47
I0905 16:25:34.531800 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.86
INFO:tensorflow:Starting iteration 9

Steps executed: 235 Episode length: 235 Return: -362.59948941403087
INFO:tensorflow:Average training steps per second: 391.96
I0905 16:25:40.248456 139967707396096 replay_runner.py:36] Average training steps per second: 391.96
I0905 16:25:40.396676 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.60
INFO:tensorflow:Starting iteration 10

Steps executed: 288 Episode length: 177 Return: -293.15869799823184
INFO:tensorflow:Average training steps per second: 399.92
I0905 16:25:46.088296 139967707396096 replay_runner.py:36] Average training steps per second: 399.92
I0905 16:25:46.210181 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.46
INFO:tensorflow:Starting iteration 11

Steps executed: 275 Episode length: 105 Return: -130.42260320403684
INFO:tensorflow:Average training steps per second: 393.12
I0905 16:25:51.918655 139967707396096 replay_runner.py:36] Average training steps per second: 393.12
I0905 16:25:52.026710 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.75
INFO:tensorflow:Starting iteration 12

Steps executed: 595 Episode length: 442 Return: -172.85957017061324
INFO:tensorflow:Average training steps per second: 402.53
I0905 16:25:57.653365 139967707396096 replay_runner.py:36] Average training steps per second: 402.53
I0905 16:25:58.198599 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.71
INFO:tensorflow:Starting iteration 13

Steps executed: 206 Episode length: 106 Return: -145.56562393508094
INFO:tensorflow:Average training steps per second: 395.64
I0905 16:26:03.879484 139967707396096 replay_runner.py:36] Average training steps per second: 395.64
I0905 16:26:03.970727 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.42
INFO:tensorflow:Starting iteration 14

Steps executed: 315 Episode length: 173 Return: -144.54857635030808
INFO:tensorflow:Average training steps per second: 405.45
I0905 16:26:09.579469 139967707396096 replay_runner.py:36] Average training steps per second: 405.45
I0905 16:26:09.747616 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.72
INFO:tensorflow:Starting iteration 15

Steps executed: 69 Episode length: 69 Return: -169.8317072988395808
INFO:tensorflow:Average training steps per second: 407.30

Steps executed: 436 Episode length: 367 Return: -125.35988621104944
I0905 16:26:15.704892 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.60
INFO:tensorflow:Starting iteration 16
I0905 16:26:18.842278 139967707396096 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 386.86

Steps executed: 837 Episode length: 837 Return: -264.55931928702114
I0905 16:26:22.512475 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.56
INFO:tensorflow:Starting iteration 17

Steps executed: 243 Episode length: 243 Return: -102.06346535737995
INFO:tensorflow:Average training steps per second: 399.30
I0905 16:26:28.169637 139967707396096 replay_runner.py:36] Average training steps per second: 399.30
I0905 16:26:28.292329 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.06
INFO:tensorflow:Starting iteration 18

Steps executed: 229 Episode length: 66 Return: -256.731994682668645
INFO:tensorflow:Average training steps per second: 399.65
I0905 16:26:33.985404 139967707396096 replay_runner.py:36] Average training steps per second: 399.65
I0905 16:26:34.072697 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.63
INFO:tensorflow:Starting iteration 19
I0905 16:26:37.177656 139967707396096 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 414.19

Steps executed: 1000 Episode length: 1000 Return: -96.05342106235337
I0905 16:26:42.185016 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.05
INFO:tensorflow:Starting iteration 20

Steps executed: 451 Episode length: 341 Return: -307.696953486724857
INFO:tensorflow:Average training steps per second: 345.47
I0905 16:26:48.247441 139967707396096 replay_runner.py:36] Average training steps per second: 345.47
I0905 16:26:48.574779 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.83
INFO:tensorflow:Starting iteration 21

Steps executed: 66 Episode length: 66 Return: -281.60127330722344857
INFO:tensorflow:Average training steps per second: 348.60

Steps executed: 1066 Episode length: 1000 Return: -95.06224699541393
I0905 16:26:56.943231 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.33
INFO:tensorflow:Starting iteration 22
I0905 16:27:00.414975 139967707396096 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 329.68
I0905 16:27:03.448458 139967707396096 replay_runner.py:36] Average training steps per second: 329.68

Steps executed: 361 Episode length: 231 Return: -156.188402907349543
INFO:tensorflow:Starting iteration 23

Steps executed: 443 Episode length: 443 Return: -346.290032268890943
INFO:tensorflow:Average training steps per second: 303.43
I0905 16:27:10.576552 139967707396096 replay_runner.py:36] Average training steps per second: 303.43
I0905 16:27:11.062301 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -346.29
INFO:tensorflow:Starting iteration 24

Steps executed: 482 Episode length: 303 Return: -398.307834223068143
INFO:tensorflow:Average training steps per second: 304.39
I0905 16:27:18.031976 139967707396096 replay_runner.py:36] Average training steps per second: 304.39
I0905 16:27:18.445469 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.67
INFO:tensorflow:Starting iteration 25

Steps executed: 136 Episode length: 136 Return: -314.804251986886473
INFO:tensorflow:Average training steps per second: 309.01
I0905 16:27:25.372614 139967707396096 replay_runner.py:36] Average training steps per second: 309.01

Steps executed: 551 Episode length: 415 Return: -219.605488503653253
INFO:tensorflow:Starting iteration 26

Steps executed: 529 Episode length: 348 Return: -204.475907347974253
INFO:tensorflow:Average training steps per second: 307.68
I0905 16:27:32.814944 139967707396096 replay_runner.py:36] Average training steps per second: 307.68
I0905 16:27:33.214699 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.76
INFO:tensorflow:Starting iteration 27

Steps executed: 182 Episode length: 182 Return: -344.131532100293673
INFO:tensorflow:Average training steps per second: 309.53
I0905 16:27:40.086309 139967707396096 replay_runner.py:36] Average training steps per second: 309.53

Steps executed: 946 Episode length: 764 Return: -470.291257251092253
INFO:tensorflow:Starting iteration 28

Steps executed: 423 Episode length: 423 Return: -274.597548834968173
INFO:tensorflow:Average training steps per second: 305.71
I0905 16:27:48.575016 139967707396096 replay_runner.py:36] Average training steps per second: 305.71
I0905 16:27:48.894760 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.60
INFO:tensorflow:Starting iteration 29
I0905 16:27:52.578303 139967707396096 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 312.70
I0905 16:27:55.776563 139967707396096 replay_runner.py:36] Average training steps per second: 312.70


Done fixed training!Episode length: 64 Return: -188.0146783417957373