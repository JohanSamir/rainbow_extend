Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0828 10:21:40.929615 140088388143104 run_experiment.py:549] Creating TrainRunner ...
I0828 10:21:40.938452 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:40.938730 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:40.938871 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:40.938972 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:40.939039 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:40.939144 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:40.939308 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:40.939452 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:40.939570 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:40.939693 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:40.939814 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:40.939934 140088388143104 dqn_agent.py:283] 	 seed: 1630146100938399
I0828 10:21:40.942495 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:40.942750 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:21:40.942917 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:40.943010 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:40.943174 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:40.943271 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:40.943379 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:40.943539 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:40.943641 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:40.977508 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:41.447178 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:41.460714 140088388143104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:21:41.469787 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:21:41.469969 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:21:41.470046 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:21:41.470107 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:21:41.470176 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:21:41.470235 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:21:41.470309 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:21:41.470450 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:21:41.470527 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:21:41.470583 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:21:41.470655 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:21:41.470720 140088388143104 dqn_agent.py:283] 	 seed: 1630146101469746
I0828 10:21:41.472461 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:21:41.472737 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:21:41.472872 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:21:41.473016 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:21:41.473141 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:21:41.473220 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:21:41.473344 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:21:41.473612 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:21:41.473709 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:21:41.507142 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:21:41.529247 140088388143104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:21:41.529540 140088388143104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.73
I0828 10:21:48.164629 140088388143104 replay_runner.py:36] Average training steps per second: 150.73
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:21:49.707930 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:21:49.952539 140088388143104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.46
I0828 10:21:55.017472 140088388143104 replay_runner.py:36] Average training steps per second: 197.46
I0828 10:21:55.399594 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0828 10:21:55.639298 140088388143104 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 198.03

Steps executed: 228 Episode length: 93 Return: -92.0.0
I0828 10:22:00.888839 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 3

Steps executed: 417 Episode length: 417 Return: -416.0
INFO:tensorflow:Average training steps per second: 206.37
I0828 10:22:05.986998 140088388143104 replay_runner.py:36] Average training steps per second: 206.37
I0828 10:22:06.318637 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -416.00
INFO:tensorflow:Starting iteration 4

Steps executed: 284 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 196.71
I0828 10:22:11.654234 140088388143104 replay_runner.py:36] Average training steps per second: 196.71
I0828 10:22:11.885908 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 5

Steps executed: 240 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 209.70
I0828 10:22:16.896456 140088388143104 replay_runner.py:36] Average training steps per second: 209.70
I0828 10:22:17.108730 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 6

Steps executed: 234 Episode length: 234 Return: -233.0
INFO:tensorflow:Average training steps per second: 201.90
I0828 10:22:22.299608 140088388143104 replay_runner.py:36] Average training steps per second: 201.90
I0828 10:22:22.481818 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.00
INFO:tensorflow:Starting iteration 7

Steps executed: 283 Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 199.83
I0828 10:22:27.721467 140088388143104 replay_runner.py:36] Average training steps per second: 199.83
I0828 10:22:27.966759 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.50
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 209.91
I0828 10:22:32.979569 140088388143104 replay_runner.py:36] Average training steps per second: 209.91
I0828 10:22:33.380788 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0828 10:22:33.616511 140088388143104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.12
I0828 10:22:38.794972 140088388143104 replay_runner.py:36] Average training steps per second: 193.12
I0828 10:22:39.210513 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:22:39.441034 140088388143104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 199.56
I0828 10:22:44.452458 140088388143104 replay_runner.py:36] Average training steps per second: 199.56
I0828 10:22:44.869966 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 468 Episode length: 279 Return: -278.0
INFO:tensorflow:Average training steps per second: 200.31
I0828 10:22:50.112813 140088388143104 replay_runner.py:36] Average training steps per second: 200.31
I0828 10:22:50.465913 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.00
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.96
I0828 10:22:55.846626 140088388143104 replay_runner.py:36] Average training steps per second: 193.96
I0828 10:22:56.258714 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0828 10:22:56.506067 140088388143104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 207.22
I0828 10:23:01.332181 140088388143104 replay_runner.py:36] Average training steps per second: 207.22
I0828 10:23:01.762578 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0828 10:23:02.011521 140088388143104 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 201.38
I0828 10:23:06.977839 140088388143104 replay_runner.py:36] Average training steps per second: 201.38
I0828 10:23:07.364989 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0828 10:23:07.590873 140088388143104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 218.85
I0828 10:23:12.160612 140088388143104 replay_runner.py:36] Average training steps per second: 218.85
I0828 10:23:12.525564 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0828 10:23:12.752494 140088388143104 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 198.09
I0828 10:23:17.801187 140088388143104 replay_runner.py:36] Average training steps per second: 198.09
I0828 10:23:18.225476 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0828 10:23:18.517738 140088388143104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 202.68
I0828 10:23:23.463895 140088388143104 replay_runner.py:36] Average training steps per second: 202.68
I0828 10:23:23.883409 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0828 10:23:24.115473 140088388143104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.75
I0828 10:23:29.250730 140088388143104 replay_runner.py:36] Average training steps per second: 194.75
I0828 10:23:29.666898 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0828 10:23:29.916533 140088388143104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 207.72
I0828 10:23:34.731239 140088388143104 replay_runner.py:36] Average training steps per second: 207.72
I0828 10:23:35.149321 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0828 10:23:35.402395 140088388143104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.71
I0828 10:23:40.460818 140088388143104 replay_runner.py:36] Average training steps per second: 197.71
I0828 10:23:40.871221 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0828 10:23:41.108409 140088388143104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 197.70
I0828 10:23:46.167150 140088388143104 replay_runner.py:36] Average training steps per second: 197.70
I0828 10:23:46.609663 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0828 10:23:46.867349 140088388143104 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 200.60
I0828 10:23:51.852797 140088388143104 replay_runner.py:36] Average training steps per second: 200.60
I0828 10:23:52.261954 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:23:52.508663 140088388143104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 196.38
I0828 10:23:57.601180 140088388143104 replay_runner.py:36] Average training steps per second: 196.38
I0828 10:23:57.998098 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0828 10:23:58.232077 140088388143104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 202.86
I0828 10:24:03.162059 140088388143104 replay_runner.py:36] Average training steps per second: 202.86
I0828 10:24:03.587255 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0828 10:24:03.846231 140088388143104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.31
I0828 10:24:08.717244 140088388143104 replay_runner.py:36] Average training steps per second: 205.31
I0828 10:24:09.130185 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0828 10:24:09.374616 140088388143104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.90
I0828 10:24:14.453613 140088388143104 replay_runner.py:36] Average training steps per second: 196.90
I0828 10:24:14.862390 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0828 10:24:15.108256 140088388143104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 207.97
I0828 10:24:19.917129 140088388143104 replay_runner.py:36] Average training steps per second: 207.97
I0828 10:24:20.356828 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0828 10:24:20.602973 140088388143104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 213.82
I0828 10:24:25.280193 140088388143104 replay_runner.py:36] Average training steps per second: 213.82
I0828 10:24:25.646398 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 214.69
I0828 10:24:30.591260 140088388143104 replay_runner.py:36] Average training steps per second: 214.69
I0828 10:24:30.967170 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00