Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0901 12:50:26.826894 140283033229312 run_experiment.py:549] Creating TrainRunner ...
I0901 12:50:26.836960 140283033229312 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:50:26.837232 140283033229312 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:50:26.837393 140283033229312 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:50:26.837587 140283033229312 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:50:26.837727 140283033229312 dqn_agent.py:275] 	 update_period: 4
I0901 12:50:26.838189 140283033229312 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:50:26.838349 140283033229312 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:50:26.838460 140283033229312 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:50:26.838609 140283033229312 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:50:26.838703 140283033229312 dqn_agent.py:280] 	 optimizer: adam
I0901 12:50:26.838780 140283033229312 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:50:26.838879 140283033229312 dqn_agent.py:283] 	 seed: 1630500626836899
I0901 12:50:26.842913 140283033229312 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:50:26.843157 140283033229312 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:50:26.843300 140283033229312 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:50:26.843474 140283033229312 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:50:26.843724 140283033229312 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:50:26.843870 140283033229312 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:50:26.844024 140283033229312 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:50:26.844359 140283033229312 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:50:26.844519 140283033229312 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:50:27.006850 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:50:27.454081 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:50:27.469566 140283033229312 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:50:27.479376 140283033229312 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:50:27.479667 140283033229312 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:50:27.479783 140283033229312 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:50:27.479875 140283033229312 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:50:27.479950 140283033229312 dqn_agent.py:275] 	 update_period: 4
I0901 12:50:27.480044 140283033229312 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:50:27.480195 140283033229312 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:50:27.480385 140283033229312 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:50:27.480469 140283033229312 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:50:27.480530 140283033229312 dqn_agent.py:280] 	 optimizer: adam
I0901 12:50:27.480589 140283033229312 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:50:27.480647 140283033229312 dqn_agent.py:283] 	 seed: 1630500627479312
I0901 12:50:27.482890 140283033229312 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:50:27.483044 140283033229312 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:50:27.483159 140283033229312 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:50:27.483271 140283033229312 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:50:27.483341 140283033229312 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:50:27.483418 140283033229312 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:50:27.483495 140283033229312 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:50:27.483571 140283033229312 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:50:27.483639 140283033229312 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:50:27.518906 140283033229312 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:50:27.541503 140283033229312 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:50:27.541762 140283033229312 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.29
I0901 12:50:34.377594 140283033229312 replay_runner.py:36] Average training steps per second: 146.29
Steps executed: 321 Episode length: 177 Return: -176.0
I0901 12:50:35.727579 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.50
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.33
I0901 12:50:41.200868 140283033229312 replay_runner.py:36] Average training steps per second: 191.33
I0901 12:50:41.600513 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 201 Episode length: 201 Return: -200.0
INFO:tensorflow:Average training steps per second: 204.77
I0901 12:50:46.711839 140283033229312 replay_runner.py:36] Average training steps per second: 204.77
I0901 12:50:46.893657 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 149 Episode length: 149 Return: -148.0
INFO:tensorflow:Average training steps per second: 191.41
I0901 12:50:52.346405 140283033229312 replay_runner.py:36] Average training steps per second: 191.41

Steps executed: 292 Episode length: 143 Return: -142.0
INFO:tensorflow:Starting iteration 4

Steps executed: 274 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 193.76
I0901 12:50:57.984195 140283033229312 replay_runner.py:36] Average training steps per second: 193.76
I0901 12:50:58.227496 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 5

Steps executed: 333 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 189.89
I0901 12:51:03.745688 140283033229312 replay_runner.py:36] Average training steps per second: 189.89
I0901 12:51:04.040750 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.42
I0901 12:51:09.552456 140283033229312 replay_runner.py:36] Average training steps per second: 190.42
I0901 12:51:09.985562 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 190.27
I0901 12:51:15.495318 140283033229312 replay_runner.py:36] Average training steps per second: 190.27
I0901 12:51:15.691999 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 8

Steps executed: 202 Episode length: 202 Return: -201.0
INFO:tensorflow:Average training steps per second: 189.78
I0901 12:51:21.210721 140283033229312 replay_runner.py:36] Average training steps per second: 189.78
I0901 12:51:21.388244 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 9
I0901 12:51:21.638403 140283033229312 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 191.20

Steps executed: 423 Episode length: 227 Return: -226.0
I0901 12:51:27.234830 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.00
INFO:tensorflow:Starting iteration 10

Steps executed: 151 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 190.13

Steps executed: 242 Episode length: 91 Return: -90.0.0
I0901 12:51:32.964351 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 11

Steps executed: 303 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 197.70
I0901 12:51:38.238656 140283033229312 replay_runner.py:36] Average training steps per second: 197.70
I0901 12:51:38.492756 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 12
I0901 12:51:38.733552 140283033229312 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 185.47
I0901 12:51:44.126026 140283033229312 replay_runner.py:36] Average training steps per second: 185.47
I0901 12:51:44.325709 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.67
INFO:tensorflow:Starting iteration 13


Steps executed: 556 Episode length: 375 Return: -374.0
INFO:tensorflow:Average training steps per second: 195.40
I0901 12:51:49.675171 140283033229312 replay_runner.py:36] Average training steps per second: 195.40
I0901 12:51:50.174721 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.33
INFO:tensorflow:Starting iteration 14
I0901 12:51:50.416727 140283033229312 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 192.72
I0901 12:51:55.606133 140283033229312 replay_runner.py:36] Average training steps per second: 192.72
I0901 12:51:55.878604 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 15

Steps executed: 305 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 183.10
I0901 12:52:01.568244 140283033229312 replay_runner.py:36] Average training steps per second: 183.10
I0901 12:52:01.793264 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 16

Steps executed: 231 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 189.23
I0901 12:52:07.330957 140283033229312 replay_runner.py:36] Average training steps per second: 189.23
I0901 12:52:07.586770 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 17

Steps executed: 274 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 189.35

Steps executed: 218 Episode length: 65 Return: -64.0.0
I0901 12:52:13.313533 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.67
INFO:tensorflow:Starting iteration 18
I0901 12:52:13.540774 140283033229312 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 192.89
I0901 12:52:18.725564 140283033229312 replay_runner.py:36] Average training steps per second: 192.89
I0901 12:52:18.902410 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 19


Steps executed: 209 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 201.67
I0901 12:52:24.097687 140283033229312 replay_runner.py:36] Average training steps per second: 201.67
I0901 12:52:24.304425 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 20


Steps executed: 259 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 197.61
I0901 12:52:29.609529 140283033229312 replay_runner.py:36] Average training steps per second: 197.61
I0901 12:52:29.815708 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.05
I0901 12:52:35.069151 140283033229312 replay_runner.py:36] Average training steps per second: 199.05
I0901 12:52:35.499229 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 224 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 196.53
I0901 12:52:40.829188 140283033229312 replay_runner.py:36] Average training steps per second: 196.53
I0901 12:52:41.022486 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 23

Steps executed: 300 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 194.06
I0901 12:52:46.402822 140283033229312 replay_runner.py:36] Average training steps per second: 194.06
I0901 12:52:46.667392 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 24

Steps executed: 216 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 195.73
I0901 12:52:52.021502 140283033229312 replay_runner.py:36] Average training steps per second: 195.73
I0901 12:52:52.213734 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 25

Steps executed: 236 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 196.44
I0901 12:52:57.536329 140283033229312 replay_runner.py:36] Average training steps per second: 196.44
I0901 12:52:57.745054 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 26

Steps executed: 223 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 194.65
I0901 12:53:03.134136 140283033229312 replay_runner.py:36] Average training steps per second: 194.65
I0901 12:53:03.326778 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 27

Steps executed: 302 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 191.72
I0901 12:53:08.761979 140283033229312 replay_runner.py:36] Average training steps per second: 191.72
I0901 12:53:09.026741 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 28

Steps executed: 291 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 197.20
I0901 12:53:14.344001 140283033229312 replay_runner.py:36] Average training steps per second: 197.20
I0901 12:53:14.597676 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 195.08
I0901 12:53:19.939987 140283033229312 replay_runner.py:36] Average training steps per second: 195.08
I0901 12:53:20.114921 140283033229312 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00