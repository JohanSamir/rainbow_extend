Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 23:35:30.293219 140268518520832 run_experiment.py:549] Creating TrainRunner ...
I0901 23:35:30.302526 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:30.302835 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:30.303068 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:30.303199 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:30.303301 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:30.303436 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:30.303539 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:30.303633 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:30.303730 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:30.303906 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:30.304018 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:30.304158 140268518520832 dqn_agent.py:283] 	 seed: 1630539330302469
I0901 23:35:30.307199 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:30.307416 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:35:30.307570 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:30.308050 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:30.308308 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:30.308453 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:30.308663 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:30.308789 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:30.308943 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:30.341852 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:30.808932 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:30.824577 140268518520832 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:35:30.832998 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:35:30.833245 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:35:30.833382 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:35:30.833528 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:35:30.833665 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0901 23:35:30.833862 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:35:30.833981 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:35:30.834093 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:35:30.834235 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:35:30.834400 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0901 23:35:30.834514 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:35:30.834622 140268518520832 dqn_agent.py:283] 	 seed: 1630539330832943
I0901 23:35:30.837589 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:35:30.837799 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:35:30.837943 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:35:30.838057 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:35:30.838193 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:35:30.838284 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:35:30.838393 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:35:30.838608 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:35:30.838743 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:35:30.868125 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:35:30.891872 140268518520832 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:35:30.892393 140268518520832 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.71
I0901 23:35:37.803109 140268518520832 replay_runner.py:36] Average training steps per second: 144.71
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:35:39.247229 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:35:39.487582 140268518520832 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 190.86
I0901 23:35:44.727572 140268518520832 replay_runner.py:36] Average training steps per second: 190.86
I0901 23:35:45.156200 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 23:35:45.402949 140268518520832 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.99
I0901 23:35:50.639569 140268518520832 replay_runner.py:36] Average training steps per second: 190.99
I0901 23:35:51.051119 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:35:51.294910 140268518520832 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.92
I0901 23:35:56.478973 140268518520832 replay_runner.py:36] Average training steps per second: 192.92
I0901 23:35:56.870677 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:35:57.107207 140268518520832 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 196.14
I0901 23:36:02.206103 140268518520832 replay_runner.py:36] Average training steps per second: 196.14
I0901 23:36:02.613383 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:36:02.863647 140268518520832 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 194.19
I0901 23:36:08.013853 140268518520832 replay_runner.py:36] Average training steps per second: 194.19
I0901 23:36:08.414019 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 23:36:08.660861 140268518520832 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 190.16
I0901 23:36:13.919980 140268518520832 replay_runner.py:36] Average training steps per second: 190.16
I0901 23:36:14.345134 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:36:14.581054 140268518520832 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 193.53
I0901 23:36:19.748549 140268518520832 replay_runner.py:36] Average training steps per second: 193.53
I0901 23:36:20.166789 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:36:20.413663 140268518520832 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.53
I0901 23:36:25.528458 140268518520832 replay_runner.py:36] Average training steps per second: 195.53
I0901 23:36:25.934670 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0901 23:36:26.165004 140268518520832 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 187.66
I0901 23:36:31.494101 140268518520832 replay_runner.py:36] Average training steps per second: 187.66
I0901 23:36:31.933711 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 23:36:32.149333 140268518520832 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.22
I0901 23:36:37.325199 140268518520832 replay_runner.py:36] Average training steps per second: 193.22
I0901 23:36:37.752775 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 23:36:37.995651 140268518520832 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 191.30
I0901 23:36:43.223681 140268518520832 replay_runner.py:36] Average training steps per second: 191.30
I0901 23:36:43.637695 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 23:36:43.874843 140268518520832 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 189.03
I0901 23:36:49.165611 140268518520832 replay_runner.py:36] Average training steps per second: 189.03
I0901 23:36:49.591986 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 23:36:49.848113 140268518520832 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.41
I0901 23:36:55.018739 140268518520832 replay_runner.py:36] Average training steps per second: 193.41
I0901 23:36:55.443686 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0901 23:36:55.689843 140268518520832 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 188.54
I0901 23:37:00.994143 140268518520832 replay_runner.py:36] Average training steps per second: 188.54
I0901 23:37:01.394668 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0901 23:37:01.635582 140268518520832 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 186.09
I0901 23:37:07.009998 140268518520832 replay_runner.py:36] Average training steps per second: 186.09
I0901 23:37:07.440822 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 23:37:07.673910 140268518520832 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.59
I0901 23:37:12.760901 140268518520832 replay_runner.py:36] Average training steps per second: 196.59
I0901 23:37:13.193876 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 23:37:13.441444 140268518520832 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 191.47
I0901 23:37:18.664541 140268518520832 replay_runner.py:36] Average training steps per second: 191.47
I0901 23:37:19.073042 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 23:37:19.307485 140268518520832 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.71
I0901 23:37:24.470307 140268518520832 replay_runner.py:36] Average training steps per second: 193.71
I0901 23:37:24.903281 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0901 23:37:25.144172 140268518520832 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 195.61
I0901 23:37:30.256732 140268518520832 replay_runner.py:36] Average training steps per second: 195.61
I0901 23:37:30.663854 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20
I0901 23:37:30.900016 140268518520832 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 189.81
I0901 23:37:36.168941 140268518520832 replay_runner.py:36] Average training steps per second: 189.81
I0901 23:37:36.569586 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0901 23:37:36.802714 140268518520832 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.44
I0901 23:37:41.999627 140268518520832 replay_runner.py:36] Average training steps per second: 192.44
I0901 23:37:42.420458 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 23:37:42.646335 140268518520832 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.04
I0901 23:37:47.773943 140268518520832 replay_runner.py:36] Average training steps per second: 195.04
I0901 23:37:48.169507 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0901 23:37:48.398723 140268518520832 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 187.40
I0901 23:37:53.735407 140268518520832 replay_runner.py:36] Average training steps per second: 187.40
I0901 23:37:54.134537 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 23:37:54.372793 140268518520832 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 202.31
I0901 23:37:59.315993 140268518520832 replay_runner.py:36] Average training steps per second: 202.31
I0901 23:37:59.718608 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0901 23:37:59.951704 140268518520832 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 203.52
I0901 23:38:04.865615 140268518520832 replay_runner.py:36] Average training steps per second: 203.52
I0901 23:38:05.244822 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 23:38:05.476694 140268518520832 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 190.67
I0901 23:38:10.721887 140268518520832 replay_runner.py:36] Average training steps per second: 190.67
I0901 23:38:11.099426 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0901 23:38:11.326317 140268518520832 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 206.88
I0901 23:38:16.160704 140268518520832 replay_runner.py:36] Average training steps per second: 206.88
I0901 23:38:16.568583 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28
I0901 23:38:16.799818 140268518520832 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.70
I0901 23:38:21.661691 140268518520832 replay_runner.py:36] Average training steps per second: 205.70
I0901 23:38:21.997923 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.91
I0901 23:38:27.119408 140268518520832 replay_runner.py:36] Average training steps per second: 203.91
I0901 23:38:27.486430 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00