Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0828 10:28:01.209819 140455557396480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:28:01.220738 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:28:01.220948 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:28:01.221089 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:28:01.221216 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:28:01.221293 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:28:01.221371 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:28:01.221619 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:28:01.221775 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:28:01.221916 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:28:01.222102 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:28:01.222229 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:28:01.222307 140455557396480 dqn_agent.py:283] 	 seed: 1630146481220681
I0828 10:28:01.225342 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:28:01.225518 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:28:01.225619 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:28:01.225741 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:28:01.225822 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:28:01.225908 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:28:01.226030 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:28:01.226141 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:28:01.226231 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:28:01.257408 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:01.610816 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:01.624036 140455557396480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:28:01.631977 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:28:01.632148 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:28:01.632220 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:28:01.632316 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:28:01.632375 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:28:01.632509 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:28:01.632587 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:28:01.632788 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:28:01.632950 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:28:01.633059 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:28:01.633228 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:28:01.633364 140455557396480 dqn_agent.py:283] 	 seed: 1630146481631937
I0828 10:28:01.635947 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:28:01.636142 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:28:01.636254 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:28:01.636352 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:28:01.636460 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:28:01.636594 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:28:01.636713 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:28:01.636880 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:28:01.636983 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:28:01.665971 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:28:01.685324 140455557396480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:28:01.685743 140455557396480 replay_runner.py:41] Starting iteration 0
Steps executed: 169 Episode length: 94 Return: -836.0134031280709
INFO:tensorflow:Average training steps per second: 169.68
I0828 10:28:07.579636 140455557396480 replay_runner.py:36] Average training steps per second: 169.68

Steps executed: 248 Episode length: 79 Return: -476.44246040800306
INFO:tensorflow:Starting iteration 1

Steps executed: 201 Episode length: 201 Return: -486.8973192934603
INFO:tensorflow:Average training steps per second: 226.97
I0828 10:28:17.476685 140455557396480 replay_runner.py:36] Average training steps per second: 226.97
I0828 10:28:17.664347 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.90
INFO:tensorflow:Starting iteration 2

Steps executed: 257 Episode length: 84 Return: -202.03912791290628
INFO:tensorflow:Average training steps per second: 229.35
I0828 10:28:26.281877 140455557396480 replay_runner.py:36] Average training steps per second: 229.35
I0828 10:28:26.478728 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.27
INFO:tensorflow:Starting iteration 3

Steps executed: 228 Episode length: 97 Return: -397.13686594892768
INFO:tensorflow:Average training steps per second: 231.20
I0828 10:28:35.172382 140455557396480 replay_runner.py:36] Average training steps per second: 231.20
I0828 10:28:35.383000 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.97
INFO:tensorflow:Starting iteration 4

Steps executed: 252 Episode length: 58 Return: -524.12051093053175
INFO:tensorflow:Average training steps per second: 228.41
I0828 10:28:44.113432 140455557396480 replay_runner.py:36] Average training steps per second: 228.41
I0828 10:28:44.329773 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -618.36
INFO:tensorflow:Starting iteration 5

Steps executed: 269 Episode length: 72 Return: -673.03062817976235
INFO:tensorflow:Average training steps per second: 220.77
I0828 10:28:53.184807 140455557396480 replay_runner.py:36] Average training steps per second: 220.77
I0828 10:28:53.418680 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -562.20
INFO:tensorflow:Starting iteration 6

Steps executed: 215 Episode length: 61 Return: -482.22698120006264
INFO:tensorflow:Average training steps per second: 229.15
I0828 10:29:02.165524 140455557396480 replay_runner.py:36] Average training steps per second: 229.15
I0828 10:29:02.329068 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.19
INFO:tensorflow:Starting iteration 7

Steps executed: 270 Episode length: 79 Return: -463.78951110546134
INFO:tensorflow:Average training steps per second: 219.30
I0828 10:29:11.104906 140455557396480 replay_runner.py:36] Average training steps per second: 219.30
I0828 10:29:11.332042 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -525.86
INFO:tensorflow:Starting iteration 8

Steps executed: 251 Episode length: 54 Return: -445.06256820048793
INFO:tensorflow:Average training steps per second: 221.19
I0828 10:29:20.183321 140455557396480 replay_runner.py:36] Average training steps per second: 221.19
I0828 10:29:20.400402 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -559.18
INFO:tensorflow:Starting iteration 9
I0828 10:29:24.703326 140455557396480 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.15

Steps executed: 234 Episode length: 58 Return: -305.61089862575743
I0828 10:29:29.300618 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.07
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 67 Return: -586.86036518664313
INFO:tensorflow:Average training steps per second: 225.78
I0828 10:29:37.997356 140455557396480 replay_runner.py:36] Average training steps per second: 225.78
I0828 10:29:38.193395 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.39
INFO:tensorflow:Starting iteration 11

Steps executed: 214 Episode length: 77 Return: -750.36343298873653
INFO:tensorflow:Average training steps per second: 224.91
I0828 10:29:46.836132 140455557396480 replay_runner.py:36] Average training steps per second: 224.91
I0828 10:29:47.027568 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -601.83
INFO:tensorflow:Starting iteration 12

Steps executed: 252 Episode length: 59 Return: -539.51986236638733
INFO:tensorflow:Average training steps per second: 222.08
I0828 10:29:55.943958 140455557396480 replay_runner.py:36] Average training steps per second: 222.08
I0828 10:29:56.171996 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -512.46
INFO:tensorflow:Starting iteration 13

Steps executed: 241 Episode length: 59 Return: -425.16247421358656
INFO:tensorflow:Average training steps per second: 224.48
I0828 10:30:04.976019 140455557396480 replay_runner.py:36] Average training steps per second: 224.48
I0828 10:30:05.179279 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.64
INFO:tensorflow:Starting iteration 14

Steps executed: 213 Episode length: 64 Return: -308.71990166485205
INFO:tensorflow:Average training steps per second: 230.07
I0828 10:30:13.830356 140455557396480 replay_runner.py:36] Average training steps per second: 230.07
I0828 10:30:14.060425 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.35
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 78 Return: -802.67067092816726
INFO:tensorflow:Average training steps per second: 244.21
I0828 10:30:22.392316 140455557396480 replay_runner.py:36] Average training steps per second: 244.21
I0828 10:30:22.562427 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.32
INFO:tensorflow:Starting iteration 16

Steps executed: 221 Episode length: 51 Return: -247.36706493339645
INFO:tensorflow:Average training steps per second: 247.73
I0828 10:30:30.943396 140455557396480 replay_runner.py:36] Average training steps per second: 247.73
I0828 10:30:31.151785 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.14
INFO:tensorflow:Starting iteration 17

Steps executed: 205 Episode length: 64 Return: -386.53940981537323
INFO:tensorflow:Average training steps per second: 236.47
I0828 10:30:39.552998 140455557396480 replay_runner.py:36] Average training steps per second: 236.47
I0828 10:30:39.732665 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.30
INFO:tensorflow:Starting iteration 18

Steps executed: 284 Episode length: 88 Return: -594.84599426619053
INFO:tensorflow:Average training steps per second: 231.17
I0828 10:30:48.422360 140455557396480 replay_runner.py:36] Average training steps per second: 231.17
I0828 10:30:48.648307 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.39
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 75 Return: -253.79051788342693
INFO:tensorflow:Average training steps per second: 249.89
I0828 10:30:56.919324 140455557396480 replay_runner.py:36] Average training steps per second: 249.89
I0828 10:30:57.129141 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.68
INFO:tensorflow:Starting iteration 20
I0828 10:31:01.279645 140455557396480 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 236.54

Steps executed: 259 Episode length: 73 Return: -496.11147083077933
I0828 10:31:05.772175 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -338.38
INFO:tensorflow:Starting iteration 21

Steps executed: 215 Episode length: 62 Return: -457.09513564146553
INFO:tensorflow:Average training steps per second: 233.01
I0828 10:31:14.364090 140455557396480 replay_runner.py:36] Average training steps per second: 233.01
I0828 10:31:14.553349 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.87
INFO:tensorflow:Starting iteration 22
I0828 10:31:18.860450 140455557396480 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 231.91

Steps executed: 234 Episode length: 88 Return: -449.74061762548313
I0828 10:31:23.418749 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -708.55
INFO:tensorflow:Starting iteration 23

Steps executed: 274 Episode length: 78 Return: -262.68031290583383
INFO:tensorflow:Average training steps per second: 236.74
I0828 10:31:32.026438 140455557396480 replay_runner.py:36] Average training steps per second: 236.74
I0828 10:31:32.266801 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.32
INFO:tensorflow:Starting iteration 24

Steps executed: 217 Episode length: 135 Return: -1004.6444383904299
INFO:tensorflow:Average training steps per second: 233.55
I0828 10:31:40.861454 140455557396480 replay_runner.py:36] Average training steps per second: 233.55
I0828 10:31:41.098667 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -715.32
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 226 Return: -1840.7363067462884
INFO:tensorflow:Average training steps per second: 236.68
I0828 10:31:49.631857 140455557396480 replay_runner.py:36] Average training steps per second: 236.68
I0828 10:31:49.913809 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -1840.74
INFO:tensorflow:Starting iteration 26

Steps executed: 228 Episode length: 88 Return: -643.014993666498522
INFO:tensorflow:Average training steps per second: 239.13
I0828 10:31:58.474330 140455557396480 replay_runner.py:36] Average training steps per second: 239.13
I0828 10:31:58.703784 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -889.40
INFO:tensorflow:Starting iteration 27

Steps executed: 225 Episode length: 96 Return: -460.892047041220452
INFO:tensorflow:Average training steps per second: 242.56
I0828 10:32:07.134815 140455557396480 replay_runner.py:36] Average training steps per second: 242.56
I0828 10:32:07.355209 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -566.73
INFO:tensorflow:Starting iteration 28

Steps executed: 236 Episode length: 101 Return: -380.64509859513252
INFO:tensorflow:Average training steps per second: 237.17
I0828 10:32:15.933859 140455557396480 replay_runner.py:36] Average training steps per second: 237.17
I0828 10:32:16.158956 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -611.69
INFO:tensorflow:Starting iteration 29

Steps executed: 226 Episode length: 98 Return: -583.298322270488812
INFO:tensorflow:Average training steps per second: 235.25
I0828 10:32:24.821020 140455557396480 replay_runner.py:36] Average training steps per second: 235.25

Done fixed training!Episode length: 98 Return: -583.298322270488812