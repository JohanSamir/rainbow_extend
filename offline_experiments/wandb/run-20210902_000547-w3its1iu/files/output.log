Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 00:05:54.321349 139919604459520 run_experiment.py:549] Creating TrainRunner ...
I0902 00:05:54.331298 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:54.331497 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:54.331575 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:54.331638 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:54.331694 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:54.331778 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:05:54.331875 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:54.331932 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:54.331999 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:54.332077 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:54.332155 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:54.332232 139919604459520 dqn_agent.py:283] 	 seed: 1630541154331249
I0902 00:05:54.335444 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:54.335731 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:05:54.335883 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:54.336054 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:54.336160 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:54.336289 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:54.336412 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:54.336487 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:54.336593 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:54.372309 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:54.769854 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:54.783179 139919604459520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:05:54.792141 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:54.792400 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:54.792666 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:54.792871 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:54.793000 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:54.793131 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:05:54.793247 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:54.793364 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:54.793490 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:54.793613 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:54.793751 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:54.793847 139919604459520 dqn_agent.py:283] 	 seed: 1630541154792072
I0902 00:05:54.795712 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:54.795894 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:05:54.796014 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:54.796120 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:54.796261 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:54.796362 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:54.796466 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:54.796646 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:54.796759 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:54.869055 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:54.892245 139919604459520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:05:54.892582 139919604459520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.97
I0902 00:06:01.790761 139919604459520 replay_runner.py:36] Average training steps per second: 144.97
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 00:06:03.257460 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 00:06:03.489863 139919604459520 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 203.29
I0902 00:06:08.409231 139919604459520 replay_runner.py:36] Average training steps per second: 203.29
I0902 00:06:08.818268 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 00:06:09.057017 139919604459520 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 202.11

Steps executed: 251 Episode length: 251 Return: -250.0
I0902 00:06:14.216041 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.16
I0902 00:06:19.502526 139919604459520 replay_runner.py:36] Average training steps per second: 198.16
I0902 00:06:19.893192 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 00:06:20.148059 139919604459520 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 202.35
I0902 00:06:25.090220 139919604459520 replay_runner.py:36] Average training steps per second: 202.35
I0902 00:06:25.523612 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 285 Episode length: 156 Return: -155.0
INFO:tensorflow:Average training steps per second: 202.58
I0902 00:06:30.697723 139919604459520 replay_runner.py:36] Average training steps per second: 202.58
I0902 00:06:30.941827 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.51
I0902 00:06:36.386730 139919604459520 replay_runner.py:36] Average training steps per second: 192.51
I0902 00:06:36.824004 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 00:06:37.068195 139919604459520 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 202.16
I0902 00:06:42.015240 139919604459520 replay_runner.py:36] Average training steps per second: 202.16
I0902 00:06:42.449269 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 00:06:42.698092 139919604459520 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.19
I0902 00:06:47.769781 139919604459520 replay_runner.py:36] Average training steps per second: 197.19
I0902 00:06:48.184219 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 239 Episode length: 154 Return: -153.0
INFO:tensorflow:Average training steps per second: 208.18
I0902 00:06:53.227506 139919604459520 replay_runner.py:36] Average training steps per second: 208.18
I0902 00:06:53.419425 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 10

Steps executed: 618 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.92
I0902 00:06:58.717897 139919604459520 replay_runner.py:36] Average training steps per second: 197.92
I0902 00:06:59.230879 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.50
INFO:tensorflow:Starting iteration 11

Steps executed: 231 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 196.22
I0902 00:07:04.574574 139919604459520 replay_runner.py:36] Average training steps per second: 196.22
I0902 00:07:04.774612 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 12

Steps executed: 233 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 197.76
I0902 00:07:10.083662 139919604459520 replay_runner.py:36] Average training steps per second: 197.76
I0902 00:07:10.273414 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 13

Steps executed: 234 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 195.02
I0902 00:07:15.644372 139919604459520 replay_runner.py:36] Average training steps per second: 195.02
I0902 00:07:15.851191 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 14

Steps executed: 232 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 203.46
I0902 00:07:21.008438 139919604459520 replay_runner.py:36] Average training steps per second: 203.46
I0902 00:07:21.203893 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 15

Steps executed: 216 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 194.66
I0902 00:07:26.587255 139919604459520 replay_runner.py:36] Average training steps per second: 194.66
I0902 00:07:26.775777 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 16

Steps executed: 275 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 205.16
I0902 00:07:31.871076 139919604459520 replay_runner.py:36] Average training steps per second: 205.16
I0902 00:07:32.110764 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 17

Steps executed: 202 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 192.27
I0902 00:07:37.560415 139919604459520 replay_runner.py:36] Average training steps per second: 192.27
I0902 00:07:37.722509 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 210.18
I0902 00:07:42.718234 139919604459520 replay_runner.py:36] Average training steps per second: 210.18
I0902 00:07:43.120736 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0902 00:07:43.365317 139919604459520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 200.71

Steps executed: 281 Episode length: 104 Return: -103.0
I0902 00:07:48.597951 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 20

Steps executed: 225 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 208.05
I0902 00:07:53.663693 139919604459520 replay_runner.py:36] Average training steps per second: 208.05
I0902 00:07:53.860254 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.26
I0902 00:07:59.232116 139919604459520 replay_runner.py:36] Average training steps per second: 195.26
I0902 00:07:59.628998 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 285 Episode length: 145 Return: -144.0
INFO:tensorflow:Average training steps per second: 196.63
I0902 00:08:04.950102 139919604459520 replay_runner.py:36] Average training steps per second: 196.63
I0902 00:08:05.193280 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 23
I0902 00:08:05.437445 139919604459520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.90
I0902 00:08:10.415793 139919604459520 replay_runner.py:36] Average training steps per second: 200.90

Steps executed: 235 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Starting iteration 24

Steps executed: 274 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 199.39
I0902 00:08:15.860106 139919604459520 replay_runner.py:36] Average training steps per second: 199.39
I0902 00:08:16.086626 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 202.22
I0902 00:08:21.287813 139919604459520 replay_runner.py:36] Average training steps per second: 202.22
I0902 00:08:21.493148 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 26
I0902 00:08:21.735317 139919604459520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.87

Steps executed: 220 Episode length: 75 Return: -74.0.0
I0902 00:08:26.957491 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.33
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 62 Return: -61.0.0
INFO:tensorflow:Average training steps per second: 195.75
I0902 00:08:32.313854 139919604459520 replay_runner.py:36] Average training steps per second: 195.75
I0902 00:08:32.504013 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.67
INFO:tensorflow:Starting iteration 28

Steps executed: 217 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 195.63
I0902 00:08:37.846901 139919604459520 replay_runner.py:36] Average training steps per second: 195.63
I0902 00:08:38.031816 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.33
INFO:tensorflow:Starting iteration 29
I0902 00:08:38.265115 139919604459520 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 195.84
I0902 00:08:43.371721 139919604459520 replay_runner.py:36] Average training steps per second: 195.84

Done fixed training!Episode length: 86 Return: -85.0.0