Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:21:19.214126 140338720843776 run_experiment.py:549] Creating TrainRunner ...
I0910 11:21:19.220910 140338720843776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:19.221037 140338720843776 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:19.221113 140338720843776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:19.221180 140338720843776 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:19.221261 140338720843776 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:19.221346 140338720843776 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:19.221433 140338720843776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:19.221525 140338720843776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:19.221598 140338720843776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:19.221673 140338720843776 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:19.221739 140338720843776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:19.221821 140338720843776 dqn_agent.py:283] 	 seed: 1631272879220868
I0910 11:21:19.223607 140338720843776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:19.223723 140338720843776 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:19.223803 140338720843776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:19.223891 140338720843776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:19.223968 140338720843776 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:19.224026 140338720843776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:19.224080 140338720843776 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:19.224160 140338720843776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:19.224261 140338720843776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:19.250008 140338720843776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:19.270719 140338720843776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:19.270841 140338720843776 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:19.270922 140338720843776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:19.270986 140338720843776 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:19.271041 140338720843776 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:19.271109 140338720843776 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:19.271194 140338720843776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:19.271266 140338720843776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:19.271338 140338720843776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:19.271407 140338720843776 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:19.271484 140338720843776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:19.271575 140338720843776 dqn_agent.py:283] 	 seed: 1631272879270692
I0910 11:21:19.273064 140338720843776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:19.273190 140338720843776 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:19.273265 140338720843776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:19.273351 140338720843776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:19.273410 140338720843776 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:19.273495 140338720843776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:19.273558 140338720843776 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:19.273646 140338720843776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:19.273713 140338720843776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:19.294627 140338720843776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:19.310556 140338720843776 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:21:19.310696 140338720843776 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 790334.28
I0910 11:21:19.312080 140338720843776 replay_runner.py:39] Average training steps per second: 790334.28
I0910 11:21:20.192540 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -363.50
INFO:tensorflow:Starting iteration 1
I0910 11:21:20.295037 140338720843776 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 765943.02
I0910 11:21:20.296616 140338720843776 replay_runner.py:39] Average training steps per second: 765943.02
I0910 11:21:20.485839 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:21:20.583835 140338720843776 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 805203.30
I0910 11:21:20.585305 140338720843776 replay_runner.py:39] Average training steps per second: 805203.30
I0910 11:21:20.793566 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:21:20.893651 140338720843776 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 739475.32
I0910 11:21:20.895241 140338720843776 replay_runner.py:39] Average training steps per second: 739475.32
I0910 11:21:21.105543 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:21:21.199127 140338720843776 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 778597.36
I0910 11:21:21.200649 140338720843776 replay_runner.py:39] Average training steps per second: 778597.36
I0910 11:21:21.460780 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.00
INFO:tensorflow:Starting iteration 5
I0910 11:21:21.559789 140338720843776 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 739084.41
I0910 11:21:21.561391 140338720843776 replay_runner.py:39] Average training steps per second: 739084.41
I0910 11:21:21.757999 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:21:21.856597 140338720843776 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 767344.31
I0910 11:21:21.858165 140338720843776 replay_runner.py:39] Average training steps per second: 767344.31
I0910 11:21:21.951527 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.00
INFO:tensorflow:Starting iteration 7
I0910 11:21:22.052855 140338720843776 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 738173.88
I0910 11:21:22.054511 140338720843776 replay_runner.py:39] Average training steps per second: 738173.88
I0910 11:21:22.246284 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:21:22.340908 140338720843776 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 738824.03
I0910 11:21:22.342526 140338720843776 replay_runner.py:39] Average training steps per second: 738824.03
I0910 11:21:22.588766 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.00
INFO:tensorflow:Starting iteration 9
I0910 11:21:22.685135 140338720843776 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 728430.71

Steps executed: 116 Episode length: 116 Return: -116.0
I0910 11:21:22.772211 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 10
I0910 11:21:22.870303 140338720843776 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 829241.60
I0910 11:21:22.871737 140338720843776 replay_runner.py:39] Average training steps per second: 829241.60
I0910 11:21:23.113374 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.00
INFO:tensorflow:Starting iteration 11
I0910 11:21:23.209324 140338720843776 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 805667.31
I0910 11:21:23.210815 140338720843776 replay_runner.py:39] Average training steps per second: 805667.31
I0910 11:21:23.453814 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:21:23.555742 140338720843776 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 774857.57
I0910 11:21:23.557347 140338720843776 replay_runner.py:39] Average training steps per second: 774857.57
I0910 11:21:23.651860 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.50
INFO:tensorflow:Starting iteration 13
I0910 11:21:23.751499 140338720843776 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 743934.73
I0910 11:21:23.753093 140338720843776 replay_runner.py:39] Average training steps per second: 743934.73
I0910 11:21:23.862043 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 14
I0910 11:21:23.956910 140338720843776 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 782081.67
I0910 11:21:23.958552 140338720843776 replay_runner.py:39] Average training steps per second: 782081.67
I0910 11:21:24.192304 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 15
I0910 11:21:24.291863 140338720843776 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 732885.55
I0910 11:21:24.293479 140338720843776 replay_runner.py:39] Average training steps per second: 732885.55
I0910 11:21:24.371483 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 16
I0910 11:21:24.465569 140338720843776 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 836351.74
I0910 11:21:24.467022 140338720843776 replay_runner.py:39] Average training steps per second: 836351.74
I0910 11:21:24.595757 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.00
INFO:tensorflow:Starting iteration 17
I0910 11:21:24.693393 140338720843776 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 770728.41
I0910 11:21:24.695233 140338720843776 replay_runner.py:39] Average training steps per second: 770728.41
I0910 11:21:24.780750 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 18
I0910 11:21:24.875581 140338720843776 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 766923.39
I0910 11:21:24.877103 140338720843776 replay_runner.py:39] Average training steps per second: 766923.39
I0910 11:21:24.947103 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 19
I0910 11:21:25.041536 140338720843776 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 813795.89
I0910 11:21:25.043046 140338720843776 replay_runner.py:39] Average training steps per second: 813795.89
I0910 11:21:25.119678 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 20
I0910 11:21:25.217628 140338720843776 replay_runner.py:44] Starting iteration 20

Steps executed: 230 Episode length: 115 Return: -115.0
I0910 11:21:25.332297 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 21
I0910 11:21:25.435712 140338720843776 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 773999.63
I0910 11:21:25.437314 140338720843776 replay_runner.py:39] Average training steps per second: 773999.63
I0910 11:21:25.521189 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 22
I0910 11:21:25.645818 140338720843776 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 433295.87
I0910 11:21:25.648460 140338720843776 replay_runner.py:39] Average training steps per second: 433295.87
I0910 11:21:25.726498 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 23
I0910 11:21:25.858107 140338720843776 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 331722.87
I0910 11:21:25.861464 140338720843776 replay_runner.py:39] Average training steps per second: 331722.87
I0910 11:21:26.085525 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 24
I0910 11:21:26.179341 140338720843776 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 782081.67
I0910 11:21:26.180841 140338720843776 replay_runner.py:39] Average training steps per second: 782081.67
I0910 11:21:26.383421 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.00
INFO:tensorflow:Starting iteration 25
I0910 11:21:26.476646 140338720843776 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 802430.46
I0910 11:21:26.478175 140338720843776 replay_runner.py:39] Average training steps per second: 802430.46
I0910 11:21:26.653391 140338720843776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:21:26.747100 140338720843776 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 383601.98
I0910 11:21:26.749997 140338720843776 replay_runner.py:39] Average training steps per second: 383601.98


Done fixed training!Episode length: 600 Return: -600.0
I0910 11:21:25.219123 140338720843776 replay_runner.py:39] Average training steps per second: 799371.83
I0910 11:21:25.219123 140338720843776 replay_runner.py:39] Average training steps per second: 799371.83