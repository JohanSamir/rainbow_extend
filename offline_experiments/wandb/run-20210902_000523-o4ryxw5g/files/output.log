Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 00:05:30.103702 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:05:30.117296 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:30.117544 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:30.117654 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:30.117744 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:30.117828 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:30.117910 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:30.118019 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:30.118131 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:30.118198 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:30.118252 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:30.118305 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:30.118561 140053067847680 dqn_agent.py:283] 	 seed: 1630541130117233
I0902 00:05:30.123901 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:30.124509 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:30.124702 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:30.124862 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:30.124965 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:30.125058 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:30.125422 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:30.126198 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:30.126349 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:30.170222 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:30.549334 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:30.563622 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:05:30.574160 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:30.574504 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:30.574641 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:30.574725 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:30.574847 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:30.574936 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:30.575123 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:30.575283 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:30.575404 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:30.575528 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:30.575652 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:30.575758 140053067847680 dqn_agent.py:283] 	 seed: 1630541130574076
I0902 00:05:30.578680 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:30.578888 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:30.579050 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:30.579149 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:30.579230 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:30.579356 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:30.579462 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:30.579600 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:30.579726 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:30.648400 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:30.673282 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:05:30.673618 140053067847680 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 167.28
I0902 00:05:36.651930 140053067847680 replay_runner.py:36] Average training steps per second: 167.28
Steps executed: 230 Episode length: 230 Return: -535.8030784504182
I0902 00:05:37.915122 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.80
INFO:tensorflow:Starting iteration 1

Steps executed: 334 Episode length: 201 Return: -371.2524530447949
INFO:tensorflow:Average training steps per second: 225.21
I0902 00:05:46.694355 140053067847680 replay_runner.py:36] Average training steps per second: 225.21
I0902 00:05:46.975383 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.76
INFO:tensorflow:Starting iteration 2

Steps executed: 137 Episode length: 137 Return: -327.7729354493668
INFO:tensorflow:Average training steps per second: 233.61
I0902 00:05:55.550142 140053067847680 replay_runner.py:36] Average training steps per second: 233.61

Steps executed: 249 Episode length: 112 Return: -333.8852312865199
INFO:tensorflow:Starting iteration 3
I0902 00:06:00.141227 140053067847680 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 224.21

Steps executed: 584 Episode length: 584 Return: -329.8392038747521
I0902 00:06:05.997152 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.84
INFO:tensorflow:Starting iteration 4
I0902 00:06:10.327711 140053067847680 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 225.18
I0902 00:06:14.769060 140053067847680 replay_runner.py:36] Average training steps per second: 225.18

Steps executed: 500 Episode length: 500 Return: -391.5825550513733
INFO:tensorflow:Starting iteration 5
I0902 00:06:20.309494 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.76

Steps executed: 1000 Episode length: 1000 Return: 76.69902575632373
I0902 00:06:27.005360 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: 76.70
INFO:tensorflow:Starting iteration 6
I0902 00:06:31.291331 140053067847680 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 217.38

Steps executed: 796 Episode length: 796 Return: -428.83811883336853
I0902 00:06:38.111268 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.84
INFO:tensorflow:Starting iteration 7
I0902 00:06:42.397477 140053067847680 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 220.97

Steps executed: 1000 Episode length: 1000 Return: -43.92509665696478
I0902 00:06:50.768419 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.93
INFO:tensorflow:Starting iteration 8
I0902 00:06:55.130552 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 217.24
I0902 00:06:59.734203 140053067847680 replay_runner.py:36] Average training steps per second: 217.24

Steps executed: 291 Episode length: 291 Return: -825.977884547834478
INFO:tensorflow:Starting iteration 9

Steps executed: 296 Episode length: 166 Return: -7.05429659315503778
INFO:tensorflow:Average training steps per second: 219.44
I0902 00:07:09.079630 140053067847680 replay_runner.py:36] Average training steps per second: 219.44
I0902 00:07:09.354508 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.23
INFO:tensorflow:Starting iteration 10
I0902 00:07:13.609190 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.10

Steps executed: 281 Episode length: 143 Return: -187.666620874978188
I0902 00:07:18.407554 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.74
INFO:tensorflow:Starting iteration 11

Steps executed: 253 Episode length: 253 Return: -156.196951135032188
INFO:tensorflow:Average training steps per second: 216.74
I0902 00:07:27.345168 140053067847680 replay_runner.py:36] Average training steps per second: 216.74
I0902 00:07:27.672454 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.20
INFO:tensorflow:Starting iteration 12

Steps executed: 207 Episode length: 207 Return: -186.786906046599268
INFO:tensorflow:Average training steps per second: 213.90
I0902 00:07:36.690293 140053067847680 replay_runner.py:36] Average training steps per second: 213.90
I0902 00:07:36.906818 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.79
INFO:tensorflow:Starting iteration 13

Steps executed: 336 Episode length: 336 Return: -284.417525638588568
INFO:tensorflow:Average training steps per second: 226.30
I0902 00:07:45.570693 140053067847680 replay_runner.py:36] Average training steps per second: 226.30
I0902 00:07:46.102266 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.42
INFO:tensorflow:Starting iteration 14

Steps executed: 485 Episode length: 485 Return: -396.121302607222568
INFO:tensorflow:Average training steps per second: 224.65
I0902 00:07:54.824373 140053067847680 replay_runner.py:36] Average training steps per second: 224.65
I0902 00:07:55.799961 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.12
INFO:tensorflow:Starting iteration 15
I0902 00:07:59.877526 140053067847680 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 221.55

Steps executed: 321 Episode length: 321 Return: -234.665954780745368
I0902 00:08:04.862961 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.67
INFO:tensorflow:Starting iteration 16

Steps executed: 424 Episode length: 424 Return: -258.842225887022968
INFO:tensorflow:Average training steps per second: 232.32
I0902 00:08:13.581477 140053067847680 replay_runner.py:36] Average training steps per second: 232.32
I0902 00:08:14.319247 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.84
INFO:tensorflow:Starting iteration 17

Steps executed: 231 Episode length: 108 Return: -113.574778440182388
INFO:tensorflow:Average training steps per second: 224.59
I0902 00:08:23.105370 140053067847680 replay_runner.py:36] Average training steps per second: 224.59
I0902 00:08:23.324323 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.58
INFO:tensorflow:Starting iteration 18
I0902 00:08:27.757234 140053067847680 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 223.23


Steps executed: 1099 Episode length: 1000 Return: -297.5102182421079
I0902 00:08:35.017284 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.01
INFO:tensorflow:Starting iteration 19
I0902 00:08:39.386492 140053067847680 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 223.89

Steps executed: 408 Episode length: 408 Return: -107.163481628719679
I0902 00:08:44.433658 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.16
INFO:tensorflow:Starting iteration 20

Steps executed: 257 Episode length: 257 Return: -129.284617004833089
INFO:tensorflow:Average training steps per second: 230.97
I0902 00:08:53.058827 140053067847680 replay_runner.py:36] Average training steps per second: 230.97
I0902 00:08:53.350697 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.28
INFO:tensorflow:Starting iteration 21

Steps executed: 253 Episode length: 80 Return: -242.6815247063894489
INFO:tensorflow:Average training steps per second: 233.64
I0902 00:09:01.904896 140053067847680 replay_runner.py:36] Average training steps per second: 233.64
I0902 00:09:02.123858 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.88
INFO:tensorflow:Starting iteration 22

Steps executed: 52 Episode length: 52 Return: -138.28500631726234489
INFO:tensorflow:Average training steps per second: 225.50
I0902 00:09:11.157362 140053067847680 replay_runner.py:36] Average training steps per second: 225.50

Steps executed: 627 Episode length: 575 Return: -5.75006447476704359
INFO:tensorflow:Starting iteration 23

Steps executed: 250 Episode length: 186 Return: -339.337508398353359
INFO:tensorflow:Average training steps per second: 221.34
I0902 00:09:21.271732 140053067847680 replay_runner.py:36] Average training steps per second: 221.34
I0902 00:09:21.511339 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.58
INFO:tensorflow:Starting iteration 24
I0902 00:09:25.983468 140053067847680 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.85

Steps executed: 249 Episode length: 55 Return: -133.3465492963465169
I0902 00:09:30.726793 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.43
INFO:tensorflow:Starting iteration 25

Steps executed: 204 Episode length: 204 Return: -131.759461402028089
INFO:tensorflow:Average training steps per second: 222.86
I0902 00:09:39.604443 140053067847680 replay_runner.py:36] Average training steps per second: 222.86
I0902 00:09:39.818013 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.76
INFO:tensorflow:Starting iteration 26
I0902 00:09:44.185957 140053067847680 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 225.59

Steps executed: 1000 Episode length: 1000 Return: 150.14797426101978
I0902 00:09:50.313274 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.15
INFO:tensorflow:Starting iteration 27

Steps executed: 257 Episode length: 128 Return: -185.414588932542168
INFO:tensorflow:Average training steps per second: 218.97
I0902 00:09:59.216430 140053067847680 replay_runner.py:36] Average training steps per second: 218.97
I0902 00:09:59.455615 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.08
INFO:tensorflow:Starting iteration 28
I0902 00:10:03.789230 140053067847680 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 207.72

Steps executed: 218 Episode length: 96 Return: -191.9686174703472368
I0902 00:10:08.799941 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.53
INFO:tensorflow:Starting iteration 29

Steps executed: 260 Episode length: 125 Return: -83.2270798656525168
INFO:tensorflow:Average training steps per second: 222.21
I0902 00:10:17.655469 140053067847680 replay_runner.py:36] Average training steps per second: 222.21

Done fixed training!Episode length: 125 Return: -83.2270798656525168