Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0901 12:52:28.074076 140196630247424 run_experiment.py:549] Creating TrainRunner ...
I0901 12:52:28.085700 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:52:28.086042 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:52:28.086245 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:52:28.086511 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:52:28.086650 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:52:28.086783 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:52:28.086908 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:52:28.087028 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:52:28.087157 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:52:28.087292 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:52:28.087401 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:52:28.087511 140196630247424 dqn_agent.py:283] 	 seed: 1630500748085531
I0901 12:52:28.090919 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:52:28.091098 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:52:28.091202 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:52:28.091294 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:52:28.091371 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:52:28.091459 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:52:28.091544 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:52:28.091651 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:52:28.091740 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:52:28.136013 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:52:28.678216 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:52:28.692766 140196630247424 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:52:28.702382 140196630247424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:52:28.702621 140196630247424 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:52:28.702787 140196630247424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:52:28.702924 140196630247424 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:52:28.703063 140196630247424 dqn_agent.py:275] 	 update_period: 4
I0901 12:52:28.703233 140196630247424 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:52:28.703441 140196630247424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:52:28.703553 140196630247424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:52:28.703685 140196630247424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:52:28.703793 140196630247424 dqn_agent.py:280] 	 optimizer: adam
I0901 12:52:28.703885 140196630247424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:52:28.703985 140196630247424 dqn_agent.py:283] 	 seed: 1630500748702323
I0901 12:52:28.706478 140196630247424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:52:28.706663 140196630247424 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:52:28.706811 140196630247424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:52:28.706931 140196630247424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:52:28.707037 140196630247424 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:52:28.707198 140196630247424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:52:28.707303 140196630247424 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:52:28.707416 140196630247424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:52:28.707546 140196630247424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:52:28.744273 140196630247424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:52:28.768178 140196630247424 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:52:28.768452 140196630247424 replay_runner.py:41] Starting iteration 0
Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 138.46
I0901 12:52:35.990962 140196630247424 replay_runner.py:36] Average training steps per second: 138.46
I0901 12:52:37.193646 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 193.32
I0901 12:52:42.569046 140196630247424 replay_runner.py:36] Average training steps per second: 193.32
I0901 12:52:42.718557 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 2
I0901 12:52:42.901657 140196630247424 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 188.31
I0901 12:52:48.212660 140196630247424 replay_runner.py:36] Average training steps per second: 188.31
I0901 12:52:48.371623 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.40
INFO:tensorflow:Starting iteration 3


Steps executed: 298 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 194.15
I0901 12:52:53.719977 140196630247424 replay_runner.py:36] Average training steps per second: 194.15
I0901 12:52:53.927217 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 4

Steps executed: 226 Episode length: 39 Return: 39.0.0
INFO:tensorflow:Average training steps per second: 192.83
I0901 12:52:59.306403 140196630247424 replay_runner.py:36] Average training steps per second: 192.83
I0901 12:52:59.457557 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.20
INFO:tensorflow:Starting iteration 5

Steps executed: 241 Episode length: 56 Return: 56.0.0
INFO:tensorflow:Average training steps per second: 191.36
I0901 12:53:04.871358 140196630247424 replay_runner.py:36] Average training steps per second: 191.36
I0901 12:53:05.054176 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 48.20
INFO:tensorflow:Starting iteration 6
I0901 12:53:05.254241 140196630247424 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 192.15
I0901 12:53:10.459176 140196630247424 replay_runner.py:36] Average training steps per second: 192.15
I0901 12:53:10.646790 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 63.25
INFO:tensorflow:Starting iteration 7

Steps executed: 253 Episode length: 61 Return: 61.0.0
INFO:tensorflow:Average training steps per second: 192.66
I0901 12:53:16.028390 140196630247424 replay_runner.py:36] Average training steps per second: 192.66

Steps executed: 215 Episode length: 50 Return: 50.0.0
INFO:tensorflow:Starting iteration 8
I0901 12:53:16.381855 140196630247424 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 196.90
I0901 12:53:21.461159 140196630247424 replay_runner.py:36] Average training steps per second: 196.90

Steps executed: 237 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Starting iteration 9
I0901 12:53:21.815463 140196630247424 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 189.60
I0901 12:53:27.090174 140196630247424 replay_runner.py:36] Average training steps per second: 189.60
I0901 12:53:27.235117 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 73.33
INFO:tensorflow:Starting iteration 10

Steps executed: 220 Episode length: 70 Return: 70.0.0
INFO:tensorflow:Average training steps per second: 190.54
I0901 12:53:32.725140 140196630247424 replay_runner.py:36] Average training steps per second: 190.54
I0901 12:53:32.961402 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 11

Steps executed: 328 Episode length: 177 Return: 177.0
INFO:tensorflow:Average training steps per second: 195.25
I0901 12:53:38.280036 140196630247424 replay_runner.py:36] Average training steps per second: 195.25
I0901 12:53:38.472730 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 12

Steps executed: 268 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 196.01

Steps executed: 339 Episode length: 164 Return: 164.0
I0901 12:53:43.995885 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.50
INFO:tensorflow:Starting iteration 13
I0901 12:53:44.193428 140196630247424 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.91
I0901 12:53:49.298321 140196630247424 replay_runner.py:36] Average training steps per second: 195.91
I0901 12:53:49.443945 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.84
I0901 12:53:54.762950 140196630247424 replay_runner.py:36] Average training steps per second: 194.84
I0901 12:53:55.007910 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 15

Steps executed: 342 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 190.45
I0901 12:54:00.439593 140196630247424 replay_runner.py:36] Average training steps per second: 190.45
I0901 12:54:00.711365 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.00
INFO:tensorflow:Starting iteration 16

Steps executed: 382 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 192.22
I0901 12:54:06.109385 140196630247424 replay_runner.py:36] Average training steps per second: 192.22
I0901 12:54:06.324046 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 17

Steps executed: 296 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 192.03
I0901 12:54:11.704861 140196630247424 replay_runner.py:36] Average training steps per second: 192.03
I0901 12:54:11.917352 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 18

Steps executed: 290 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 193.71
I0901 12:54:17.298454 140196630247424 replay_runner.py:36] Average training steps per second: 193.71
I0901 12:54:17.541239 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 19

Steps executed: 318 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 190.66
I0901 12:54:22.985784 140196630247424 replay_runner.py:36] Average training steps per second: 190.66
I0901 12:54:23.171086 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.00
INFO:tensorflow:Starting iteration 20

Steps executed: 260 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 193.06
I0901 12:54:28.540430 140196630247424 replay_runner.py:36] Average training steps per second: 193.06
I0901 12:54:28.802772 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 21

Steps executed: 356 Episode length: 194 Return: 194.0
INFO:tensorflow:Average training steps per second: 193.31

Steps executed: 335 Episode length: 176 Return: 176.0
I0901 12:54:34.403884 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.50
INFO:tensorflow:Starting iteration 22
I0901 12:54:34.587240 140196630247424 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 189.99
I0901 12:54:39.851045 140196630247424 replay_runner.py:36] Average training steps per second: 189.99
I0901 12:54:39.995396 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.38
I0901 12:54:45.267132 140196630247424 replay_runner.py:36] Average training steps per second: 197.38
I0901 12:54:45.525795 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 24

Steps executed: 379 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 192.68
I0901 12:54:50.910562 140196630247424 replay_runner.py:36] Average training steps per second: 192.68
I0901 12:54:51.045367 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.15
I0901 12:54:56.365675 140196630247424 replay_runner.py:36] Average training steps per second: 197.15
I0901 12:54:56.513862 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 12:54:56.739360 140196630247424 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 188.45
I0901 12:55:02.046847 140196630247424 replay_runner.py:36] Average training steps per second: 188.45
I0901 12:55:02.190298 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:55:02.388784 140196630247424 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 191.65
I0901 12:55:07.607107 140196630247424 replay_runner.py:36] Average training steps per second: 191.65
I0901 12:55:07.747186 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:55:07.942298 140196630247424 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.40
I0901 12:55:13.060481 140196630247424 replay_runner.py:36] Average training steps per second: 195.40
I0901 12:55:13.213012 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 190.73
I0901 12:55:18.660767 140196630247424 replay_runner.py:36] Average training steps per second: 190.73
I0901 12:55:18.868823 140196630247424 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00