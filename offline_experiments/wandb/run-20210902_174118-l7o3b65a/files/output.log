I0902 17:41:25.675162 140182397114368 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 17:41:25.675701 140182397114368 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 17:41:25.861864 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:25.864264 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:25.864460 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:25.864599 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:25.864910 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:25.865056 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:25.865171 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:25.865278 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:25.865380 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:25.865489 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:25.865602 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:25.865702 140182397114368 dqn_agent.py:283] 	 seed: 1630604485861755
I0902 17:41:25.868962 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:25.869147 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:25.869328 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:25.869475 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:25.869602 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:25.869715 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:25.869822 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:25.869928 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:25.870035 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 17:41:28.336458 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.716807 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.725543 140182397114368 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:41:28.730198 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:28.730350 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:28.730503 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:28.730570 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:28.730632 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:28.730697 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:28.730778 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:28.730880 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:28.730958 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:28.731031 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:28.731091 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:28.731168 140182397114368 dqn_agent.py:283] 	 seed: 1630604488730159
I0902 17:41:28.732872 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:28.733005 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:28.733084 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:28.733153 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:28.733276 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:28.733363 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:28.733434 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:28.733522 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:28.733692 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:28.752858 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.764075 140182397114368 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:41:28.764242 140182397114368 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.61
I0902 17:41:34.802881 140182397114368 replay_runner.py:36] Average training steps per second: 165.61
Steps executed: 232 Episode length: 55 Return: -453.40824492692165
I0902 17:41:35.645163 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.30
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 51 Return: -457.41503149097286
INFO:tensorflow:Average training steps per second: 215.21
I0902 17:41:44.583209 140182397114368 replay_runner.py:36] Average training steps per second: 215.21
I0902 17:41:44.757933 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -604.91
INFO:tensorflow:Starting iteration 2

Steps executed: 227 Episode length: 74 Return: -700.20271703023926
INFO:tensorflow:Average training steps per second: 215.59
I0902 17:41:53.616347 140182397114368 replay_runner.py:36] Average training steps per second: 215.59
I0902 17:41:53.791712 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -762.82
INFO:tensorflow:Starting iteration 3

Steps executed: 244 Episode length: 53 Return: -338.50956248541986
INFO:tensorflow:Average training steps per second: 216.71
I0902 17:42:02.694381 140182397114368 replay_runner.py:36] Average training steps per second: 216.71
I0902 17:42:02.897848 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.38
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 85 Return: -818.96187987266966
INFO:tensorflow:Average training steps per second: 218.10
I0902 17:42:11.653951 140182397114368 replay_runner.py:36] Average training steps per second: 218.10
I0902 17:42:11.833232 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -563.46
INFO:tensorflow:Starting iteration 5

Steps executed: 253 Episode length: 71 Return: -695.83796878187846
INFO:tensorflow:Average training steps per second: 216.38
I0902 17:42:20.710140 140182397114368 replay_runner.py:36] Average training steps per second: 216.38
I0902 17:42:20.950994 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -561.90
INFO:tensorflow:Starting iteration 6

Steps executed: 253 Episode length: 67 Return: -505.62292777072184
INFO:tensorflow:Average training steps per second: 219.43
I0902 17:42:29.765948 140182397114368 replay_runner.py:36] Average training steps per second: 219.43
I0902 17:42:29.986630 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -524.09
INFO:tensorflow:Starting iteration 7

Steps executed: 203 Episode length: 58 Return: -510.94764786081254
INFO:tensorflow:Average training steps per second: 218.92
I0902 17:42:38.802980 140182397114368 replay_runner.py:36] Average training steps per second: 218.92
I0902 17:42:38.985532 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -574.45
INFO:tensorflow:Starting iteration 8

Steps executed: 250 Episode length: 55 Return: -304.63871752867694
INFO:tensorflow:Average training steps per second: 222.43
I0902 17:42:47.682278 140182397114368 replay_runner.py:36] Average training steps per second: 222.43
I0902 17:42:47.900387 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.66
INFO:tensorflow:Starting iteration 9

Steps executed: 202 Episode length: 82 Return: -745.10684568671964
INFO:tensorflow:Average training steps per second: 215.46
I0902 17:42:56.707451 140182397114368 replay_runner.py:36] Average training steps per second: 215.46
I0902 17:42:56.883299 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -501.79
INFO:tensorflow:Starting iteration 10
I0902 17:43:01.049082 140182397114368 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.50

Steps executed: 238 Episode length: 50 Return: -328.00780281281274
I0902 17:43:05.776002 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.78
INFO:tensorflow:Starting iteration 11

Steps executed: 236 Episode length: 53 Return: -360.23090921692653
INFO:tensorflow:Average training steps per second: 222.68
I0902 17:43:14.524698 140182397114368 replay_runner.py:36] Average training steps per second: 222.68
I0902 17:43:14.754957 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.74
INFO:tensorflow:Starting iteration 12

Steps executed: 126 Episode length: 51 Return: -289.90273366999983
INFO:tensorflow:Average training steps per second: 222.98

Steps executed: 260 Episode length: 68 Return: -566.11433767336196
I0902 17:43:23.760221 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.06
INFO:tensorflow:Starting iteration 13

Steps executed: 272 Episode length: 73 Return: -609.37914263060386
INFO:tensorflow:Average training steps per second: 221.08
I0902 17:43:32.583099 140182397114368 replay_runner.py:36] Average training steps per second: 221.08
I0902 17:43:32.815857 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.37
INFO:tensorflow:Starting iteration 14

Steps executed: 166 Episode length: 50 Return: -318.81409460978625
INFO:tensorflow:Average training steps per second: 224.39
I0902 17:43:41.577858 140182397114368 replay_runner.py:36] Average training steps per second: 224.39

Steps executed: 248 Episode length: 82 Return: -791.44889005422355
INFO:tensorflow:Starting iteration 15

Steps executed: 236 Episode length: 64 Return: -347.72140459240215
INFO:tensorflow:Average training steps per second: 220.91
I0902 17:43:50.467627 140182397114368 replay_runner.py:36] Average training steps per second: 220.91
I0902 17:43:50.671014 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.43
INFO:tensorflow:Starting iteration 16

Steps executed: 215 Episode length: 90 Return: -423.06345737518814
INFO:tensorflow:Average training steps per second: 226.19
I0902 17:43:59.269872 140182397114368 replay_runner.py:36] Average training steps per second: 226.19
I0902 17:43:59.452475 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.81
INFO:tensorflow:Starting iteration 17

Steps executed: 218 Episode length: 62 Return: -386.98762032423244
INFO:tensorflow:Average training steps per second: 220.86
I0902 17:44:08.283961 140182397114368 replay_runner.py:36] Average training steps per second: 220.86
I0902 17:44:08.462547 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.37
INFO:tensorflow:Starting iteration 18

Steps executed: 236 Episode length: 66 Return: -326.74726136341194
INFO:tensorflow:Average training steps per second: 255.02
I0902 17:44:16.522408 140182397114368 replay_runner.py:36] Average training steps per second: 255.02
I0902 17:44:16.709586 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.58
INFO:tensorflow:Starting iteration 19

Steps executed: 82 Episode length: 82 Return: -402.362837331270844
INFO:tensorflow:Average training steps per second: 308.40

Steps executed: 234 Episode length: 79 Return: -333.65985343174974
I0902 17:44:24.054829 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.73
INFO:tensorflow:Starting iteration 20

Steps executed: 249 Episode length: 68 Return: -311.20398125348925
INFO:tensorflow:Average training steps per second: 243.15
I0902 17:44:32.146622 140182397114368 replay_runner.py:36] Average training steps per second: 243.15
I0902 17:44:32.324480 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.66
INFO:tensorflow:Starting iteration 21

Steps executed: 260 Episode length: 72 Return: -164.30581770857347
INFO:tensorflow:Average training steps per second: 231.96
I0902 17:44:40.911111 140182397114368 replay_runner.py:36] Average training steps per second: 231.96
I0902 17:44:41.109299 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.97
INFO:tensorflow:Starting iteration 22
I0902 17:44:45.485431 140182397114368 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 225.25
I0902 17:44:49.925332 140182397114368 replay_runner.py:36] Average training steps per second: 225.25

Steps executed: 235 Episode length: 75 Return: -300.97937079851757
INFO:tensorflow:Starting iteration 23

Steps executed: 221 Episode length: 77 Return: -450.08623257849266
INFO:tensorflow:Average training steps per second: 226.68
I0902 17:44:58.867514 140182397114368 replay_runner.py:36] Average training steps per second: 226.68
I0902 17:44:59.044721 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.27
INFO:tensorflow:Starting iteration 24
I0902 17:45:03.473098 140182397114368 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 232.80
I0902 17:45:07.769107 140182397114368 replay_runner.py:36] Average training steps per second: 232.80

Steps executed: 208 Episode length: 58 Return: -324.62692469444656
INFO:tensorflow:Starting iteration 25

Steps executed: 253 Episode length: 90 Return: -184.70540709254226
INFO:tensorflow:Average training steps per second: 228.92
I0902 17:45:16.646351 140182397114368 replay_runner.py:36] Average training steps per second: 228.92
I0902 17:45:16.852533 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.11
INFO:tensorflow:Starting iteration 26

Steps executed: 230 Episode length: 71 Return: -279.86380637712637
INFO:tensorflow:Average training steps per second: 227.20
I0902 17:45:25.323890 140182397114368 replay_runner.py:36] Average training steps per second: 227.20
I0902 17:45:25.505193 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.32
INFO:tensorflow:Starting iteration 27
I0902 17:45:29.920654 140182397114368 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 231.40

Steps executed: 239 Episode length: 71 Return: -307.91313445332435
I0902 17:45:34.446492 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.80
INFO:tensorflow:Starting iteration 28

Steps executed: 259 Episode length: 92 Return: -201.47857784796122
INFO:tensorflow:Average training steps per second: 229.85
I0902 17:45:43.224967 140182397114368 replay_runner.py:36] Average training steps per second: 229.85
I0902 17:45:43.442426 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.87
INFO:tensorflow:Starting iteration 29

Steps executed: 239 Episode length: 84 Return: -413.69587811688552
INFO:tensorflow:Average training steps per second: 234.77
I0902 17:45:52.148870 140182397114368 replay_runner.py:36] Average training steps per second: 234.77

Done fixed training!Episode length: 84 Return: -413.69587811688552