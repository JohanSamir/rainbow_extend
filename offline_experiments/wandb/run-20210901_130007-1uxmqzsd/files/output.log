Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 13:00:14.301704 139675548379136 run_experiment.py:549] Creating TrainRunner ...
I0901 13:00:14.312921 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:14.313161 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:14.313303 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:14.313483 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:14.313560 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:14.313683 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:14.313776 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:14.313846 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:14.313953 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:14.314066 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:14.314164 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:14.314257 139675548379136 dqn_agent.py:283] 	 seed: 1630501214312849
I0901 13:00:14.317375 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:14.317634 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:14.317774 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:14.317881 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:14.317983 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:14.318104 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:14.318366 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:14.318468 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:14.318548 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:14.500894 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:14.971354 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:14.987638 139675548379136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:00:14.999677 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:15.000208 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:15.000425 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:15.000581 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:15.000850 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:15.001011 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:15.001223 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:15.001370 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:15.001512 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:15.001638 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:15.001751 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:15.001891 139675548379136 dqn_agent.py:283] 	 seed: 1630501214999598
I0901 13:00:15.005207 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:15.005378 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:15.005486 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:15.005579 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:15.005662 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:15.005877 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:15.006027 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:15.006149 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:15.006267 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:15.047877 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:15.072889 139675548379136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:00:15.073180 139675548379136 replay_runner.py:41] Starting iteration 0
Steps executed: 158 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 133.40

Steps executed: 320 Episode length: 162 Return: -161.0
I0901 13:00:23.977028 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.00
INFO:tensorflow:Starting iteration 1
I0901 13:00:24.224701 139675548379136 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 181.53

Steps executed: 258 Episode length: 258 Return: -257.0
I0901 13:00:29.968312 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.00
INFO:tensorflow:Starting iteration 2
I0901 13:00:30.218603 139675548379136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 187.90

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 13:00:35.984611 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 13:00:36.240089 139675548379136 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 187.13
I0901 13:00:41.584251 139675548379136 replay_runner.py:36] Average training steps per second: 187.13
I0901 13:00:42.019221 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: -199.0
INFO:tensorflow:Average training steps per second: 185.92
I0901 13:00:47.640336 139675548379136 replay_runner.py:36] Average training steps per second: 185.92
I0901 13:00:47.829607 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.00
INFO:tensorflow:Starting iteration 5

Steps executed: 217 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 180.82
I0901 13:00:53.630162 139675548379136 replay_runner.py:36] Average training steps per second: 180.82
I0901 13:00:53.830958 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 6

Steps executed: 350 Episode length: 169 Return: -168.0
INFO:tensorflow:Average training steps per second: 185.44
I0901 13:00:59.474106 139675548379136 replay_runner.py:36] Average training steps per second: 185.44
I0901 13:00:59.797111 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.00
INFO:tensorflow:Starting iteration 7

Steps executed: 287 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 180.60
I0901 13:01:05.581625 139675548379136 replay_runner.py:36] Average training steps per second: 180.60
I0901 13:01:05.850564 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 8

Steps executed: 227 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 184.08
I0901 13:01:11.508992 139675548379136 replay_runner.py:36] Average training steps per second: 184.08
I0901 13:01:11.712480 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 9

Steps executed: 609 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.83
I0901 13:01:17.376877 139675548379136 replay_runner.py:36] Average training steps per second: 184.83
I0901 13:01:17.919378 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.22
I0901 13:01:23.595762 139675548379136 replay_runner.py:36] Average training steps per second: 184.22
I0901 13:01:24.086831 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 600 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.23
I0901 13:01:29.659394 139675548379136 replay_runner.py:36] Average training steps per second: 188.23
I0901 13:01:30.191160 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.50
INFO:tensorflow:Starting iteration 12

Steps executed: 233 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 189.09
I0901 13:01:35.717821 139675548379136 replay_runner.py:36] Average training steps per second: 189.09
I0901 13:01:35.925296 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 13

Steps executed: 249 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 196.01
I0901 13:01:41.242980 139675548379136 replay_runner.py:36] Average training steps per second: 196.01
I0901 13:01:41.465087 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 14

Steps executed: 278 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 193.54
I0901 13:01:46.894307 139675548379136 replay_runner.py:36] Average training steps per second: 193.54
I0901 13:01:47.131582 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 15

Steps executed: 80 Episode length: 80 Return: -79.00.0
INFO:tensorflow:Average training steps per second: 196.89
I0901 13:01:52.451472 139675548379136 replay_runner.py:36] Average training steps per second: 196.89

Steps executed: 210 Episode length: 130 Return: -129.0
INFO:tensorflow:Starting iteration 16

Steps executed: 253 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 199.01
I0901 13:01:57.895942 139675548379136 replay_runner.py:36] Average training steps per second: 199.01
I0901 13:01:58.116193 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 17

Steps executed: 281 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 192.95
I0901 13:02:03.538439 139675548379136 replay_runner.py:36] Average training steps per second: 192.95
I0901 13:02:03.784089 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 18

Steps executed: 233 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 196.21
I0901 13:02:09.132625 139675548379136 replay_runner.py:36] Average training steps per second: 196.21
I0901 13:02:09.348921 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.62
I0901 13:02:14.689555 139675548379136 replay_runner.py:36] Average training steps per second: 196.62
I0901 13:02:15.114682 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 288 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 194.09
I0901 13:02:20.517422 139675548379136 replay_runner.py:36] Average training steps per second: 194.09
I0901 13:02:20.772767 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 21

Steps executed: 285 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 200.05
I0901 13:02:26.021430 139675548379136 replay_runner.py:36] Average training steps per second: 200.05
I0901 13:02:26.273582 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.81
I0901 13:02:31.604111 139675548379136 replay_runner.py:36] Average training steps per second: 196.81
I0901 13:02:32.009725 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 257 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 202.47
I0901 13:02:37.184438 139675548379136 replay_runner.py:36] Average training steps per second: 202.47
I0901 13:02:37.431352 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.50
INFO:tensorflow:Starting iteration 24

Steps executed: 274 Episode length: 162 Return: -161.0
INFO:tensorflow:Average training steps per second: 196.12
I0901 13:02:42.772469 139675548379136 replay_runner.py:36] Average training steps per second: 196.12
I0901 13:02:43.001495 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 25

Steps executed: 212 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 193.35
I0901 13:02:48.414003 139675548379136 replay_runner.py:36] Average training steps per second: 193.35
I0901 13:02:48.605185 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.67
INFO:tensorflow:Starting iteration 26

Steps executed: 241 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 201.34
I0901 13:02:53.818078 139675548379136 replay_runner.py:36] Average training steps per second: 201.34
I0901 13:02:54.017700 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 27

Steps executed: 291 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 199.70
I0901 13:02:59.265234 139675548379136 replay_runner.py:36] Average training steps per second: 199.70
I0901 13:02:59.502665 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 28

Steps executed: 99 Episode length: 99 Return: -98.02.0
INFO:tensorflow:Average training steps per second: 203.09
I0901 13:03:04.655298 139675548379136 replay_runner.py:36] Average training steps per second: 203.09

Steps executed: 203 Episode length: 104 Return: -103.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 210.11
I0901 13:03:09.818934 139675548379136 replay_runner.py:36] Average training steps per second: 210.11
I0901 13:03:10.024481 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00