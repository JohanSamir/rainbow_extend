Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 23:15:21.222077 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0902 23:15:21.233421 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:21.233676 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:21.233794 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:21.233877 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:21.233952 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:21.234031 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:21.234113 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:21.234234 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:21.234361 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:21.234494 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:21.234595 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:21.234713 139819819333632 dqn_agent.py:283] 	 seed: 1630624521233361
I0902 23:15:21.238288 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:21.238480 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:21.238588 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:21.238778 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:21.238858 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:21.238941 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:21.239014 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:21.239068 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:21.239119 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:21.269534 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:21.657099 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:21.670548 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:15:21.680767 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:21.681028 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:21.681323 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:21.681607 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:21.681736 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:21.681890 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:21.682103 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:21.682375 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:21.682524 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:21.682650 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:21.682775 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:21.682883 139819819333632 dqn_agent.py:283] 	 seed: 1630624521680706
I0902 23:15:21.685936 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:21.686149 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:21.686291 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:21.686407 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:21.686535 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:21.686659 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:21.686801 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:21.686920 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:21.687044 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:21.759422 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:21.783201 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:15:21.783485 139819819333632 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 164.90
I0902 23:15:27.848094 139819819333632 replay_runner.py:36] Average training steps per second: 164.90
Steps executed: 241 Episode length: 57 Return: -117.36310486349122
I0902 23:15:28.995967 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.95
INFO:tensorflow:Starting iteration 1

Steps executed: 252 Episode length: 56 Return: -133.20791628645952
INFO:tensorflow:Average training steps per second: 224.97
I0902 23:15:37.851595 139819819333632 replay_runner.py:36] Average training steps per second: 224.97
I0902 23:15:38.022145 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.22
INFO:tensorflow:Starting iteration 2

Steps executed: 214 Episode length: 88 Return: -219.73005856606943
INFO:tensorflow:Average training steps per second: 239.02
I0902 23:15:46.582108 139819819333632 replay_runner.py:36] Average training steps per second: 239.02
I0902 23:15:46.706432 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.75
INFO:tensorflow:Starting iteration 3

Steps executed: 265 Episode length: 67 Return: -154.13442006877941
INFO:tensorflow:Average training steps per second: 238.16
I0902 23:15:55.312186 139819819333632 replay_runner.py:36] Average training steps per second: 238.16
I0902 23:15:55.465185 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.58
INFO:tensorflow:Starting iteration 4

Steps executed: 211 Episode length: 90 Return: -107.58653707924931
INFO:tensorflow:Average training steps per second: 239.69
I0902 23:16:03.777788 139819819333632 replay_runner.py:36] Average training steps per second: 239.69
I0902 23:16:03.916097 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.88
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 57 Return: -94.386482862336168
INFO:tensorflow:Average training steps per second: 231.51
I0902 23:16:12.431547 139819819333632 replay_runner.py:36] Average training steps per second: 231.51
I0902 23:16:12.577938 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.90
INFO:tensorflow:Starting iteration 6

Steps executed: 203 Episode length: 59 Return: -122.59118468202138
INFO:tensorflow:Average training steps per second: 227.64
I0902 23:16:21.326424 139819819333632 replay_runner.py:36] Average training steps per second: 227.64
I0902 23:16:21.464906 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.63
INFO:tensorflow:Starting iteration 7

Steps executed: 214 Episode length: 57 Return: -106.45830676808103
INFO:tensorflow:Average training steps per second: 226.27
I0902 23:16:30.240053 139819819333632 replay_runner.py:36] Average training steps per second: 226.27
I0902 23:16:30.381162 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.89
INFO:tensorflow:Starting iteration 8

Steps executed: 252 Episode length: 79 Return: -129.19457688139263
INFO:tensorflow:Average training steps per second: 224.44
I0902 23:16:39.265693 139819819333632 replay_runner.py:36] Average training steps per second: 224.44
I0902 23:16:39.446387 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.59
INFO:tensorflow:Starting iteration 9

Steps executed: 215 Episode length: 75 Return: -136.00217671711083
INFO:tensorflow:Average training steps per second: 225.12
I0902 23:16:48.254343 139819819333632 replay_runner.py:36] Average training steps per second: 225.12
I0902 23:16:48.400022 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.96
INFO:tensorflow:Starting iteration 10

Steps executed: 152 Episode length: 90 Return: -148.26145102960209
INFO:tensorflow:Average training steps per second: 227.96

Steps executed: 210 Episode length: 58 Return: -118.65593034890512
I0902 23:16:57.270364 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.59
INFO:tensorflow:Starting iteration 11

Steps executed: 224 Episode length: 79 Return: -113.16006615532083
INFO:tensorflow:Average training steps per second: 228.07
I0902 23:17:05.811934 139819819333632 replay_runner.py:36] Average training steps per second: 228.07
I0902 23:17:05.954654 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.19
INFO:tensorflow:Starting iteration 12

Steps executed: 219 Episode length: 64 Return: -135.97147979531276
INFO:tensorflow:Average training steps per second: 229.32
I0902 23:17:14.731275 139819819333632 replay_runner.py:36] Average training steps per second: 229.32
I0902 23:17:14.886139 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.11
INFO:tensorflow:Starting iteration 13

Steps executed: 203 Episode length: 67 Return: -121.14966793800627
INFO:tensorflow:Average training steps per second: 229.28
I0902 23:17:23.617369 139819819333632 replay_runner.py:36] Average training steps per second: 229.28
I0902 23:17:23.756478 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.71
INFO:tensorflow:Starting iteration 14

Steps executed: 260 Episode length: 70 Return: -140.58627075507973
INFO:tensorflow:Average training steps per second: 225.50
I0902 23:17:32.652745 139819819333632 replay_runner.py:36] Average training steps per second: 225.50
I0902 23:17:32.828560 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.52
INFO:tensorflow:Starting iteration 15

Steps executed: 259 Episode length: 92 Return: -120.48301181571264
INFO:tensorflow:Average training steps per second: 228.31
I0902 23:17:41.637205 139819819333632 replay_runner.py:36] Average training steps per second: 228.31
I0902 23:17:41.810263 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.91
INFO:tensorflow:Starting iteration 16

Steps executed: 224 Episode length: 69 Return: -174.95757466721062
INFO:tensorflow:Average training steps per second: 223.24
I0902 23:17:50.718308 139819819333632 replay_runner.py:36] Average training steps per second: 223.24
I0902 23:17:50.872486 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.29
INFO:tensorflow:Starting iteration 17

Steps executed: 243 Episode length: 62 Return: -105.07306133244364
INFO:tensorflow:Average training steps per second: 226.59
I0902 23:17:59.754925 139819819333632 replay_runner.py:36] Average training steps per second: 226.59
I0902 23:17:59.912546 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.18
INFO:tensorflow:Starting iteration 18

Steps executed: 275 Episode length: 86 Return: -219.07368501479132
INFO:tensorflow:Average training steps per second: 225.50
I0902 23:18:08.739133 139819819333632 replay_runner.py:36] Average training steps per second: 225.50
I0902 23:18:08.914352 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.62
INFO:tensorflow:Starting iteration 19

Steps executed: 201 Episode length: 89 Return: -210.13001036796756
INFO:tensorflow:Average training steps per second: 222.33
I0902 23:18:17.849462 139819819333632 replay_runner.py:36] Average training steps per second: 222.33
I0902 23:18:17.993694 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.78
INFO:tensorflow:Starting iteration 20

Steps executed: 242 Episode length: 56 Return: -138.04159702259534
INFO:tensorflow:Average training steps per second: 226.91
I0902 23:18:26.877152 139819819333632 replay_runner.py:36] Average training steps per second: 226.91
I0902 23:18:27.032715 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.51
INFO:tensorflow:Starting iteration 21
I0902 23:18:31.414094 139819819333632 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 228.80

Steps executed: 258 Episode length: 114 Return: -332.09700042064486
I0902 23:18:35.959352 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.52
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 70 Return: -125.123334522262756
INFO:tensorflow:Average training steps per second: 239.26
I0902 23:18:44.367664 139819819333632 replay_runner.py:36] Average training steps per second: 239.26
I0902 23:18:44.538953 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.12
INFO:tensorflow:Starting iteration 23

Steps executed: 217 Episode length: 61 Return: -131.199761673478246
INFO:tensorflow:Average training steps per second: 234.61
I0902 23:18:52.979824 139819819333632 replay_runner.py:36] Average training steps per second: 234.61
I0902 23:18:53.125554 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.13
INFO:tensorflow:Starting iteration 24
I0902 23:18:57.375051 139819819333632 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 249.19

Steps executed: 247 Episode length: 55 Return: -84.4501628385687676
I0902 23:19:01.538331 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.81
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 51 Return: -105.223879881300666
INFO:tensorflow:Average training steps per second: 240.83
I0902 23:19:09.867498 139819819333632 replay_runner.py:36] Average training steps per second: 240.83
I0902 23:19:09.990827 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.15
INFO:tensorflow:Starting iteration 26

Steps executed: 220 Episode length: 54 Return: -151.761705208168626
INFO:tensorflow:Average training steps per second: 235.86
I0902 23:19:18.352842 139819819333632 replay_runner.py:36] Average training steps per second: 235.86
I0902 23:19:18.490336 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.76
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 52 Return: -114.000400022654336
INFO:tensorflow:Average training steps per second: 228.43
I0902 23:19:27.197206 139819819333632 replay_runner.py:36] Average training steps per second: 228.43
I0902 23:19:27.352366 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.86
INFO:tensorflow:Starting iteration 28

Steps executed: 223 Episode length: 60 Return: -102.686787236079876
INFO:tensorflow:Average training steps per second: 225.06
I0902 23:19:36.152827 139819819333632 replay_runner.py:36] Average training steps per second: 225.06
I0902 23:19:36.302794 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.05
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 87 Return: -125.367323828328726
INFO:tensorflow:Average training steps per second: 235.80
I0902 23:19:44.893363 139819819333632 replay_runner.py:36] Average training steps per second: 235.80

Done fixed training!Episode length: 87 Return: -125.367323828328726