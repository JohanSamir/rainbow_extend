Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0902 00:10:00.982799 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:10:00.994102 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:00.994410 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:00.994691 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:00.994881 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:00.994974 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:00.995065 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:00.995173 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:00.995307 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:00.995444 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:00.995559 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:00.995658 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:00.995784 140183943698432 dqn_agent.py:283] 	 seed: 1630541400994039
I0902 00:10:00.998008 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:00.998260 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:00.998511 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:00.998625 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:00.998715 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:00.998788 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:00.998862 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:00.998964 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:00.999123 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:01.038487 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:01.411257 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:01.427497 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:10:01.438243 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:10:01.438504 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:10:01.438784 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:10:01.438974 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:10:01.439104 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:10:01.439218 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:10:01.439450 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:10:01.439582 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:10:01.439702 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:10:01.439830 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:10:01.439959 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:10:01.440093 140183943698432 dqn_agent.py:283] 	 seed: 1630541401438185
I0902 00:10:01.442893 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:10:01.443088 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:10:01.443273 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:10:01.443413 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:10:01.443534 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:10:01.443645 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:10:01.443785 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:10:01.443963 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:10:01.444110 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:10:01.514042 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:10:01.536901 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:10:01.537317 140183943698432 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 155.98
I0902 00:10:07.948775 140183943698432 replay_runner.py:36] Average training steps per second: 155.98
Steps executed: 286 Episode length: 96 Return: -365.96525069403026
I0902 00:10:09.566487 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.23
INFO:tensorflow:Starting iteration 1

Steps executed: 169 Episode length: 169 Return: -112.02203174737724
INFO:tensorflow:Average training steps per second: 217.63

Steps executed: 488 Episode length: 319 Return: -378.88296919004364
I0902 00:10:19.043929 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.45
INFO:tensorflow:Starting iteration 2

Steps executed: 472 Episode length: 278 Return: -284.57934677306235
INFO:tensorflow:Average training steps per second: 221.96
I0902 00:10:27.975231 140183943698432 replay_runner.py:36] Average training steps per second: 221.96
I0902 00:10:28.489323 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.33
INFO:tensorflow:Starting iteration 3

Steps executed: 257 Episode length: 257 Return: -416.82332538071176
INFO:tensorflow:Average training steps per second: 223.34
I0902 00:10:37.263802 140183943698432 replay_runner.py:36] Average training steps per second: 223.34
I0902 00:10:37.584789 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -416.82
INFO:tensorflow:Starting iteration 4
I0902 00:10:41.912023 140183943698432 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 229.43

Steps executed: 819 Episode length: 819 Return: -392.76341120870136
I0902 00:10:48.622659 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.76
INFO:tensorflow:Starting iteration 5
I0902 00:10:52.902192 140183943698432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 229.10

Steps executed: 1000 Episode length: 1000 Return: -67.29714450629665
I0902 00:10:59.880597 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.30
INFO:tensorflow:Starting iteration 6
I0902 00:11:04.302001 140183943698432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 224.00

Steps executed: 885 Episode length: 704 Return: -460.185102504728265
I0902 00:11:10.472453 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.29
INFO:tensorflow:Starting iteration 7

Steps executed: 477 Episode length: 477 Return: -341.618854878781865
INFO:tensorflow:Average training steps per second: 218.78
I0902 00:11:19.346493 140183943698432 replay_runner.py:36] Average training steps per second: 218.78
I0902 00:11:19.969513 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.62
INFO:tensorflow:Starting iteration 8
I0902 00:11:24.293821 140183943698432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 222.16

Steps executed: 948 Episode length: 948 Return: -1796.46729422737165
I0902 00:11:30.452735 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -1796.47
INFO:tensorflow:Starting iteration 9
I0902 00:11:34.771003 140183943698432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 218.84

Steps executed: 859 Episode length: 859 Return: -340.388493703020165
I0902 00:11:41.449029 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.39
INFO:tensorflow:Starting iteration 10
I0902 00:11:45.873826 140183943698432 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 225.20

Steps executed: 1000 Episode length: 1000 Return: -142.00409386393966
I0902 00:11:53.354391 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00
INFO:tensorflow:Starting iteration 11
I0902 00:11:57.659821 140183943698432 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 237.37
I0902 00:12:01.873210 140183943698432 replay_runner.py:36] Average training steps per second: 237.37

Steps executed: 1000 Episode length: 1000 Return: -162.85888872852848
INFO:tensorflow:Starting iteration 12
I0902 00:12:09.332393 140183943698432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 239.30

Steps executed: 1000 Episode length: 1000 Return: -186.31178270528318
I0902 00:12:16.320503 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.31
INFO:tensorflow:Starting iteration 13
I0902 00:12:20.665894 140183943698432 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 222.74

Steps executed: 1000 Episode length: 1000 Return: -67.296996384099818
I0902 00:12:28.536867 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.30
INFO:tensorflow:Starting iteration 14

Steps executed: 287 Episode length: 287 Return: -109.8993130131248118
INFO:tensorflow:Average training steps per second: 227.19
I0902 00:12:37.309453 140183943698432 replay_runner.py:36] Average training steps per second: 227.19
I0902 00:12:37.657817 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.90
INFO:tensorflow:Starting iteration 15

Steps executed: 206 Episode length: 206 Return: -186.5407066837325118
INFO:tensorflow:Average training steps per second: 225.37
I0902 00:12:46.562479 140183943698432 replay_runner.py:36] Average training steps per second: 225.37
I0902 00:12:46.783225 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.54
INFO:tensorflow:Starting iteration 16

Steps executed: 229 Episode length: 110 Return: -360.6458227256114118
INFO:tensorflow:Average training steps per second: 230.08
I0902 00:12:55.558492 140183943698432 replay_runner.py:36] Average training steps per second: 230.08
I0902 00:12:55.779477 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -498.80
INFO:tensorflow:Starting iteration 17
I0902 00:13:00.212542 140183943698432 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 222.29

Steps executed: 623 Episode length: 623 Return: -248.8495428773595718
I0902 00:13:06.103994 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.85
INFO:tensorflow:Starting iteration 18
I0902 00:13:10.458075 140183943698432 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 230.26

Steps executed: 999 Episode length: 999 Return: -430.0341380267254318
I0902 00:13:19.138832 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.03
INFO:tensorflow:Starting iteration 19

Steps executed: 525 Episode length: 346 Return: -214.8114197868287618
INFO:tensorflow:Average training steps per second: 220.22
I0902 00:13:28.129928 140183943698432 replay_runner.py:36] Average training steps per second: 220.22
I0902 00:13:28.785722 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.49
INFO:tensorflow:Starting iteration 20

Steps executed: 226 Episode length: 226 Return: -480.2862685064929618
INFO:tensorflow:Average training steps per second: 226.66
I0902 00:13:37.586782 140183943698432 replay_runner.py:36] Average training steps per second: 226.66
I0902 00:13:37.828905 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.29
INFO:tensorflow:Starting iteration 21

Steps executed: 310 Episode length: 118 Return: -360.7365627794581618
INFO:tensorflow:Average training steps per second: 224.96
I0902 00:13:46.595889 140183943698432 replay_runner.py:36] Average training steps per second: 224.96
I0902 00:13:46.894606 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.16
INFO:tensorflow:Starting iteration 22

Steps executed: 365 Episode length: 196 Return: -123.4813796231905218
INFO:tensorflow:Average training steps per second: 222.27
I0902 00:13:55.806080 140183943698432 replay_runner.py:36] Average training steps per second: 222.27
I0902 00:13:56.182604 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.42
INFO:tensorflow:Starting iteration 23
I0902 00:14:00.592182 140183943698432 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 222.16

Steps executed: 651 Episode length: 651 Return: -616.8562694667444218
I0902 00:14:06.708516 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -616.86
INFO:tensorflow:Starting iteration 24
I0902 00:14:11.011807 140183943698432 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 222.92
I0902 00:14:15.498171 140183943698432 replay_runner.py:36] Average training steps per second: 222.92

Steps executed: 674 Episode length: 674 Return: -303.5714566923744518
INFO:tensorflow:Starting iteration 25

Steps executed: 304 Episode length: 170 Return: -111.2609391224817418
INFO:tensorflow:Average training steps per second: 223.60
I0902 00:14:26.426659 140183943698432 replay_runner.py:36] Average training steps per second: 223.60
I0902 00:14:26.719955 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.84
INFO:tensorflow:Starting iteration 26
I0902 00:14:31.139370 140183943698432 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 223.44

Steps executed: 633 Episode length: 633 Return: -458.8192521755867718
I0902 00:14:37.065458 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.82
INFO:tensorflow:Starting iteration 27
I0902 00:14:41.384323 140183943698432 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 229.33

Steps executed: 201 Episode length: 82 Return: -20.642011726370384718
I0902 00:14:45.931034 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.48
INFO:tensorflow:Starting iteration 28

Steps executed: 204 Episode length: 204 Return: -294.6972957528207718
INFO:tensorflow:Average training steps per second: 232.79
I0902 00:14:54.511967 140183943698432 replay_runner.py:36] Average training steps per second: 232.79
I0902 00:14:54.732058 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.70
INFO:tensorflow:Starting iteration 29

Steps executed: 215 Episode length: 106 Return: -670.4157876865407718
INFO:tensorflow:Average training steps per second: 236.85
I0902 00:15:03.228638 140183943698432 replay_runner.py:36] Average training steps per second: 236.85

Done fixed training!Episode length: 106 Return: -670.4157876865407718