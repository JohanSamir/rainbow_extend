I0902 23:09:47.379481 139735608805376 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.380051 139735608805376 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.450100 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.451207 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.451449 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.451535 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.451601 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.451659 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:47.451716 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.451861 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.451934 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.452022 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.452080 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.452133 139735608805376 dqn_agent.py:283] 	 seed: 1630624187450043
I0902 23:09:47.454010 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.454143 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:47.454216 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.454278 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.454335 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.454410 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.454469 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.454559 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.454644 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.862178 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
I0902 23:09:54.263276 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.380545 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:54.421322 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:54.421886 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:54.422149 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:54.422319 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:54.422440 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:54.422579 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:09:54.422695 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:54.422845 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:54.422961 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:54.423073 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:54.423192 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:54.423310 139735608805376 dqn_agent.py:283] 	 seed: 1630624194421249
I0902 23:09:54.443652 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:54.443956 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:09:54.444261 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:54.444517 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:54.444802 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:54.445025 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:54.445244 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:54.445459 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:54.445659 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 2, please be patient, may be a while...
I0902 23:09:55.174752 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:55.285280 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:55.285563 139735608805376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 133.31
I0902 23:10:02.787226 139735608805376 replay_runner.py:36] Average training steps per second: 133.31
Steps executed: 274 Episode length: 183 Return: -315.3551765535047
I0902 23:10:04.001340 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.70
INFO:tensorflow:Starting iteration 1
I0902 23:10:08.076851 139735608805376 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 203.38

Steps executed: 312 Episode length: 153 Return: -337.04120868995884
I0902 23:10:13.331507 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.11
INFO:tensorflow:Starting iteration 2

Steps executed: 309 Episode length: 171 Return: -100.74769649658616
INFO:tensorflow:Average training steps per second: 203.91
I0902 23:10:22.518098 139735608805376 replay_runner.py:36] Average training steps per second: 203.91
I0902 23:10:22.822323 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.20
INFO:tensorflow:Starting iteration 3
I0902 23:10:27.087196 139735608805376 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 208.71

Steps executed: 1000 Episode length: 1000 Return: -169.50970296384745
I0902 23:10:34.427722 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.51
INFO:tensorflow:Starting iteration 4
I0902 23:10:38.725802 139735608805376 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 209.04

Steps executed: 1000 Episode length: 1000 Return: -98.749766296534975
I0902 23:10:45.858829 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.75
INFO:tensorflow:Starting iteration 5
I0902 23:10:50.205248 139735608805376 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 217.15
I0902 23:10:54.811288 139735608805376 replay_runner.py:36] Average training steps per second: 217.15

Steps executed: 1000 Episode length: 1000 Return: -161.28028967921125
INFO:tensorflow:Starting iteration 6
I0902 23:11:01.611402 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 212.56

Steps executed: 1000 Episode length: 1000 Return: -144.55584159737435
I0902 23:11:09.762328 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.56
INFO:tensorflow:Starting iteration 7
I0902 23:11:13.977071 139735608805376 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 220.40

Steps executed: 1000 Episode length: 1000 Return: -127.29015824816483
I0902 23:11:20.900768 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.29
INFO:tensorflow:Starting iteration 8
I0902 23:11:25.290529 139735608805376 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 220.46

Steps executed: 926 Episode length: 926 Return: -352.1213119444002483
I0902 23:11:31.827573 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.12
INFO:tensorflow:Starting iteration 9
I0902 23:11:35.936096 139735608805376 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.60

Steps executed: 1000 Episode length: 1000 Return: -64.903034784472723
I0902 23:11:42.236166 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.90
INFO:tensorflow:Starting iteration 10
I0902 23:11:46.459455 139735608805376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 222.46
I0902 23:11:50.955262 139735608805376 replay_runner.py:36] Average training steps per second: 222.46

Steps executed: 339 Episode length: 339 Return: -487.4979012544422723
INFO:tensorflow:Starting iteration 11
I0902 23:11:55.794430 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 214.68

Steps executed: 1000 Episode length: 1000 Return: -41.016391095892445
I0902 23:12:03.324871 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.02
INFO:tensorflow:Starting iteration 12
I0902 23:12:07.759214 139735608805376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 221.26

Steps executed: 1000 Episode length: 1000 Return: -98.164339673301915
I0902 23:12:16.538019 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.16
INFO:tensorflow:Starting iteration 13

Steps executed: 244 Episode length: 244 Return: -73.81405187282561915
INFO:tensorflow:Average training steps per second: 227.24
I0902 23:12:25.330974 139735608805376 replay_runner.py:36] Average training steps per second: 227.24
I0902 23:12:25.583765 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.81
INFO:tensorflow:Starting iteration 14
I0902 23:12:29.853569 139735608805376 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 223.34

Steps executed: 859 Episode length: 859 Return: -401.4708277908394515
I0902 23:12:36.480794 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.47
INFO:tensorflow:Starting iteration 15
I0902 23:12:41.114177 139735608805376 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 233.64

Steps executed: 413 Episode length: 413 Return: -70.30888919950581515
I0902 23:12:45.971522 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.31
INFO:tensorflow:Starting iteration 16

Steps executed: 293 Episode length: 293 Return: -26.72122506499961515
INFO:tensorflow:Average training steps per second: 249.05
I0902 23:12:53.818593 139735608805376 replay_runner.py:36] Average training steps per second: 249.05
I0902 23:12:54.154415 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.72
INFO:tensorflow:Starting iteration 17

Steps executed: 260 Episode length: 127 Return: -795.7173603640599515
INFO:tensorflow:Average training steps per second: 243.17
I0902 23:13:02.064480 139735608805376 replay_runner.py:36] Average training steps per second: 243.17
I0902 23:13:02.284893 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -779.86
INFO:tensorflow:Starting iteration 18

Steps executed: 291 Episode length: 150 Return: -669.8344443669881515
INFO:tensorflow:Average training steps per second: 218.90
I0902 23:13:11.055288 139735608805376 replay_runner.py:36] Average training steps per second: 218.90
I0902 23:13:11.343244 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.29
INFO:tensorflow:Starting iteration 19

Steps executed: 262 Episode length: 147 Return: -100.2010128205705415
INFO:tensorflow:Average training steps per second: 220.13
I0902 23:13:20.255475 139735608805376 replay_runner.py:36] Average training steps per second: 220.13
I0902 23:13:20.491803 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.89
INFO:tensorflow:Starting iteration 20
I0902 23:13:24.805366 139735608805376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 225.41

Steps executed: 546 Episode length: 546 Return: -10.83918339728515415
I0902 23:13:30.285935 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -10.84
INFO:tensorflow:Starting iteration 21

Steps executed: 280 Episode length: 163 Return: -223.9930890465550715
INFO:tensorflow:Average training steps per second: 226.32
I0902 23:13:39.032286 139735608805376 replay_runner.py:36] Average training steps per second: 226.32
I0902 23:13:39.316149 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.63
INFO:tensorflow:Starting iteration 22
I0902 23:13:43.656958 139735608805376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 238.15

Steps executed: 245 Episode length: 140 Return: -216.3797666625941615
I0902 23:13:48.071793 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.27
INFO:tensorflow:Starting iteration 23

Steps executed: 344 Episode length: 190 Return: -97.41498962893878615
INFO:tensorflow:Average training steps per second: 224.90
I0902 23:13:56.690185 139735608805376 replay_runner.py:36] Average training steps per second: 224.90
I0902 23:13:57.001634 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.51
INFO:tensorflow:Starting iteration 24
I0902 23:14:01.359380 139735608805376 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.62
I0902 23:14:05.892453 139735608805376 replay_runner.py:36] Average training steps per second: 220.62

Steps executed: 217 Episode length: 123 Return: -110.9471113157483215
INFO:tensorflow:Starting iteration 25

Steps executed: 277 Episode length: 86 Return: -167.50721345116838215
INFO:tensorflow:Average training steps per second: 225.26
I0902 23:14:14.855624 139735608805376 replay_runner.py:36] Average training steps per second: 225.26
I0902 23:14:15.098321 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.27
INFO:tensorflow:Starting iteration 26
I0902 23:14:19.286963 139735608805376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 223.82
I0902 23:14:23.755162 139735608805376 replay_runner.py:36] Average training steps per second: 223.82

Steps executed: 285 Episode length: 142 Return: -309.6654277787312215
INFO:tensorflow:Starting iteration 27

Steps executed: 335 Episode length: 158 Return: -389.7528129319057215
INFO:tensorflow:Average training steps per second: 226.48
I0902 23:14:32.781267 139735608805376 replay_runner.py:36] Average training steps per second: 226.48
I0902 23:14:33.115304 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.55
INFO:tensorflow:Starting iteration 28
I0902 23:14:37.524395 139735608805376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 233.05
I0902 23:14:41.815794 139735608805376 replay_runner.py:36] Average training steps per second: 233.05

Steps executed: 234 Episode length: 86 Return: -313.27384611879130215
INFO:tensorflow:Starting iteration 29

Steps executed: 436 Episode length: 297 Return: -112.8984234418319115
INFO:tensorflow:Average training steps per second: 224.70
I0902 23:14:50.836397 139735608805376 replay_runner.py:36] Average training steps per second: 224.70

Done fixed training!Episode length: 297 Return: -112.8984234418319115