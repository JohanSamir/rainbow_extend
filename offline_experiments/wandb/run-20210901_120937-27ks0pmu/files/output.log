
Loaded trained dqn in lunarlander
I0901 12:09:44.460003 140315766171648 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 12:09:44.460580 140315766171648 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 12:09:44.551628 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:44.553319 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:44.553516 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:44.553737 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:44.553853 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:44.553953 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:44.554099 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:44.554258 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:44.554371 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:44.554464 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:44.554605 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:44.554715 140315766171648 dqn_agent.py:283] 	 seed: 1630498184551562
I0901 12:09:44.557715 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:44.557927 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:44.558048 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:44.558301 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:44.558433 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:44.558536 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:44.558665 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:44.558783 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:44.558892 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 9, please be patient, may be a while...
I0901 12:09:46.020612 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.379322 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.388730 140315766171648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:09:46.395520 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:46.395674 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:46.395775 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:46.395842 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:46.395905 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:46.395988 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:46.396085 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:46.396153 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:46.396228 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:46.396311 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:46.396383 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:46.396461 140315766171648 dqn_agent.py:283] 	 seed: 1630498186395483
I0901 12:09:46.398176 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:46.398299 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:46.398376 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:46.398445 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:46.398508 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:46.398588 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:46.398670 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:46.398762 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:46.398836 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.417437 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.441159 140315766171648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:09:46.441384 140315766171648 replay_runner.py:41] Starting iteration 0
Steps executed: 280 Episode length: 136 Return: -451.15210477326833
INFO:tensorflow:Average training steps per second: 168.43
I0901 12:09:52.378990 140315766171648 replay_runner.py:36] Average training steps per second: 168.43
I0901 12:09:53.407870 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.26
INFO:tensorflow:Starting iteration 1

Steps executed: 216 Episode length: 77 Return: -589.792402073186213
INFO:tensorflow:Average training steps per second: 206.34
I0901 12:10:02.457663 140315766171648 replay_runner.py:36] Average training steps per second: 206.34
I0901 12:10:02.684743 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.27
INFO:tensorflow:Starting iteration 2

Steps executed: 109 Episode length: 109 Return: -203.43771346885773
INFO:tensorflow:Average training steps per second: 202.49

Steps executed: 226 Episode length: 117 Return: -531.37992834600873
I0901 12:10:12.133328 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -367.41
INFO:tensorflow:Starting iteration 3

Steps executed: 282 Episode length: 119 Return: -349.17204849212613
INFO:tensorflow:Average training steps per second: 204.57
I0901 12:10:21.406836 140315766171648 replay_runner.py:36] Average training steps per second: 204.57
I0901 12:10:21.646362 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.72
INFO:tensorflow:Starting iteration 4

Steps executed: 225 Episode length: 74 Return: -419.344416697586183
INFO:tensorflow:Average training steps per second: 206.60
I0901 12:10:30.727517 140315766171648 replay_runner.py:36] Average training steps per second: 206.60
I0901 12:10:30.916380 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.15
INFO:tensorflow:Starting iteration 5

Steps executed: 88 Episode length: 88 Return: -263.3531354179409683
INFO:tensorflow:Average training steps per second: 206.55

Steps executed: 295 Episode length: 124 Return: -32.966263675870835
I0901 12:10:40.277421 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.71
INFO:tensorflow:Starting iteration 6

Steps executed: 202 Episode length: 128 Return: -304.24146449507755
INFO:tensorflow:Average training steps per second: 210.91
I0901 12:10:49.374824 140315766171648 replay_runner.py:36] Average training steps per second: 210.91
I0901 12:10:49.533279 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.21
INFO:tensorflow:Starting iteration 7

Steps executed: 212 Episode length: 103 Return: -310.63721990516415
INFO:tensorflow:Average training steps per second: 212.75
I0901 12:10:58.533909 140315766171648 replay_runner.py:36] Average training steps per second: 212.75
I0901 12:10:58.692272 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.57
INFO:tensorflow:Starting iteration 8

Steps executed: 206 Episode length: 121 Return: -341.09560471275626
INFO:tensorflow:Average training steps per second: 213.12
I0901 12:11:07.741416 140315766171648 replay_runner.py:36] Average training steps per second: 213.12
I0901 12:11:07.916966 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.01
INFO:tensorflow:Starting iteration 9

Steps executed: 207 Episode length: 85 Return: -422.296768157988415
INFO:tensorflow:Average training steps per second: 213.26
I0901 12:11:16.905333 140315766171648 replay_runner.py:36] Average training steps per second: 213.26
I0901 12:11:17.087377 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.64
INFO:tensorflow:Starting iteration 10

Steps executed: 259 Episode length: 109 Return: -363.39217677425506
INFO:tensorflow:Average training steps per second: 211.44
I0901 12:11:26.086178 140315766171648 replay_runner.py:36] Average training steps per second: 211.44
I0901 12:11:26.288831 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -506.56
INFO:tensorflow:Starting iteration 11

Steps executed: 244 Episode length: 69 Return: -314.577622589210366
INFO:tensorflow:Average training steps per second: 212.63
I0901 12:11:35.340582 140315766171648 replay_runner.py:36] Average training steps per second: 212.63
I0901 12:11:35.535919 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -539.98
INFO:tensorflow:Starting iteration 12

Steps executed: 258 Episode length: 60 Return: -371.541735663210656
INFO:tensorflow:Average training steps per second: 213.32
I0901 12:11:44.558124 140315766171648 replay_runner.py:36] Average training steps per second: 213.32
I0901 12:11:44.788928 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.24
INFO:tensorflow:Starting iteration 13

Steps executed: 294 Episode length: 107 Return: -213.07839779979543
INFO:tensorflow:Average training steps per second: 214.32
I0901 12:11:53.829023 140315766171648 replay_runner.py:36] Average training steps per second: 214.32
I0901 12:11:54.067764 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.35
INFO:tensorflow:Starting iteration 14

Steps executed: 303 Episode length: 126 Return: -447.75855388542793
INFO:tensorflow:Average training steps per second: 215.51
I0901 12:12:03.047383 140315766171648 replay_runner.py:36] Average training steps per second: 215.51
I0901 12:12:03.312593 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.22
INFO:tensorflow:Starting iteration 15

Steps executed: 169 Episode length: 169 Return: -285.51751129488823
INFO:tensorflow:Average training steps per second: 215.11

Steps executed: 327 Episode length: 158 Return: -326.66863745991493
I0901 12:12:12.703982 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.09
INFO:tensorflow:Starting iteration 16

Steps executed: 232 Episode length: 71 Return: -339.436330558528543
INFO:tensorflow:Average training steps per second: 218.99
I0901 12:12:21.663689 140315766171648 replay_runner.py:36] Average training steps per second: 218.99
I0901 12:12:21.855928 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.05
INFO:tensorflow:Starting iteration 17

Steps executed: 302 Episode length: 107 Return: -142.87239469431222
INFO:tensorflow:Average training steps per second: 219.15
I0901 12:12:30.789733 140315766171648 replay_runner.py:36] Average training steps per second: 219.15
I0901 12:12:31.019589 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.42
INFO:tensorflow:Starting iteration 18

Steps executed: 276 Episode length: 108 Return: -391.28232122672165
INFO:tensorflow:Average training steps per second: 234.21
I0901 12:12:39.444645 140315766171648 replay_runner.py:36] Average training steps per second: 234.21
I0901 12:12:39.664876 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.61
INFO:tensorflow:Starting iteration 19
I0901 12:12:43.525724 140315766171648 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 253.87

Steps executed: 1000 Episode length: 1000 Return: 79.35094239309186
I0901 12:12:49.511294 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: 79.35
INFO:tensorflow:Starting iteration 20

Steps executed: 303 Episode length: 188 Return: -450.06626501974926
INFO:tensorflow:Average training steps per second: 237.18
I0901 12:12:58.013458 140315766171648 replay_runner.py:36] Average training steps per second: 237.18
I0901 12:12:58.282459 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.08
INFO:tensorflow:Starting iteration 21

Steps executed: 284 Episode length: 176 Return: -418.52510365003946
INFO:tensorflow:Average training steps per second: 229.00
I0901 12:13:07.075868 140315766171648 replay_runner.py:36] Average training steps per second: 229.00
I0901 12:13:07.337284 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.85
INFO:tensorflow:Starting iteration 22

Steps executed: 213 Episode length: 213 Return: -45.019959758646946
INFO:tensorflow:Average training steps per second: 227.25
I0901 12:13:16.174088 140315766171648 replay_runner.py:36] Average training steps per second: 227.25
I0901 12:13:16.360124 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -45.02
INFO:tensorflow:Starting iteration 23

Steps executed: 394 Episode length: 236 Return: -195.21880450927776
INFO:tensorflow:Average training steps per second: 227.82
I0901 12:13:25.187382 140315766171648 replay_runner.py:36] Average training steps per second: 227.82
I0901 12:13:25.593108 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.94
INFO:tensorflow:Starting iteration 24

Steps executed: 254 Episode length: 157 Return: -580.89334868220986
INFO:tensorflow:Average training steps per second: 227.67
I0901 12:13:34.452309 140315766171648 replay_runner.py:36] Average training steps per second: 227.67
I0901 12:13:34.697266 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -627.66
INFO:tensorflow:Starting iteration 25

Steps executed: 227 Episode length: 79 Return: -333.435376896190356
INFO:tensorflow:Average training steps per second: 226.04
I0901 12:13:43.627100 140315766171648 replay_runner.py:36] Average training steps per second: 226.04
I0901 12:13:43.803853 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.22
INFO:tensorflow:Starting iteration 26
I0901 12:13:48.235275 140315766171648 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 225.43
I0901 12:13:52.672223 140315766171648 replay_runner.py:36] Average training steps per second: 225.43

Steps executed: 202 Episode length: 136 Return: -214.23828960090236
INFO:tensorflow:Starting iteration 27

Steps executed: 267 Episode length: 68 Return: -480.798575932255236
INFO:tensorflow:Average training steps per second: 228.49
I0901 12:14:01.665844 140315766171648 replay_runner.py:36] Average training steps per second: 228.49
I0901 12:14:01.883917 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.10
INFO:tensorflow:Starting iteration 28
I0901 12:14:06.336012 140315766171648 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 227.35
I0901 12:14:10.734869 140315766171648 replay_runner.py:36] Average training steps per second: 227.35

Steps executed: 309 Episode length: 163 Return: -331.14121758838946
INFO:tensorflow:Starting iteration 29

Steps executed: 220 Episode length: 75 Return: -344.216658335095946
INFO:tensorflow:Average training steps per second: 233.89
I0901 12:14:19.756197 140315766171648 replay_runner.py:36] Average training steps per second: 233.89

Done fixed training!Episode length: 75 Return: -344.216658335095946