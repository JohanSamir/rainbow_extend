I0903 00:19:39.686642 139819819333632 run_experiment.py:549] Creating TrainRunner ...
I0903 00:19:39.695139 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:39.695272 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:39.695347 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:39.695408 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:39.695463 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:39.695538 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:39.695622 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:39.695678 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:39.695742 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:39.695824 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:39.695901 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:39.695959 139819819333632 dqn_agent.py:283] 	 seed: 1630628379695104
I0903 00:19:39.697722 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:39.697838 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:39.697915 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:39.697978 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:39.698044 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:39.698108 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:39.698176 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:39.698251 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:39.698333 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:39.730122 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:39.988593 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:39.998695 139819819333632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:19:40.005278 139819819333632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:19:40.005419 139819819333632 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:19:40.005510 139819819333632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:19:40.005580 139819819333632 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:19:40.005635 139819819333632 dqn_agent.py:275] 	 update_period: 4
I0903 00:19:40.005775 139819819333632 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:19:40.005835 139819819333632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:19:40.005910 139819819333632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:19:40.005971 139819819333632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:19:40.006030 139819819333632 dqn_agent.py:280] 	 optimizer: adam
I0903 00:19:40.006078 139819819333632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:19:40.006124 139819819333632 dqn_agent.py:283] 	 seed: 1630628380005244
I0903 00:19:40.008173 139819819333632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:19:40.008342 139819819333632 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:19:40.008416 139819819333632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:19:40.008479 139819819333632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:19:40.008535 139819819333632 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:19:40.008597 139819819333632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:19:40.008668 139819819333632 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:19:40.008759 139819819333632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:19:40.008818 139819819333632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:19:40.028191 139819819333632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:19:40.044438 139819819333632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:19:40.044649 139819819333632 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 223.43
I0903 00:19:44.520436 139819819333632 replay_runner.py:36] Average training steps per second: 223.43
Steps executed: 76 Episode length: 76 Return: -192.31310340124088

Steps executed: 262 Episode length: 97 Return: -416.11108300581037
INFO:tensorflow:Starting iteration 1
I0903 00:19:48.718850 139819819333632 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 328.69
I0903 00:19:51.761552 139819819333632 replay_runner.py:36] Average training steps per second: 328.69

Steps executed: 299 Episode length: 112 Return: -559.7800389075826
INFO:tensorflow:Starting iteration 2
I0903 00:19:55.353966 139819819333632 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 321.74

Steps executed: 168 Episode length: 54 Return: -359.28425542193326

Steps executed: 1168 Episode length: 1000 Return: -266.3190960382022
INFO:tensorflow:Starting iteration 3

Steps executed: 279 Episode length: 80 Return: -146.2374712278892222
INFO:tensorflow:Average training steps per second: 335.88
I0903 00:20:07.083370 139819819333632 replay_runner.py:36] Average training steps per second: 335.88
I0903 00:20:07.226980 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.82
INFO:tensorflow:Starting iteration 4

Steps executed: 230 Episode length: 103 Return: -384.727178671360662
INFO:tensorflow:Average training steps per second: 335.57
I0903 00:20:13.630611 139819819333632 replay_runner.py:36] Average training steps per second: 335.57
I0903 00:20:13.763150 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.85
INFO:tensorflow:Starting iteration 5

Steps executed: 271 Episode length: 81 Return: -263.3835755854168552
INFO:tensorflow:Average training steps per second: 337.06
I0903 00:20:20.177508 139819819333632 replay_runner.py:36] Average training steps per second: 337.06
I0903 00:20:20.329247 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.56
INFO:tensorflow:Starting iteration 6

Steps executed: 264 Episode length: 97 Return: -253.5412739203803852
INFO:tensorflow:Average training steps per second: 344.93
I0903 00:20:26.722030 139819819333632 replay_runner.py:36] Average training steps per second: 344.93
I0903 00:20:26.862456 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.99
INFO:tensorflow:Starting iteration 7

Steps executed: 238 Episode length: 55 Return: -457.6885961758082852
INFO:tensorflow:Average training steps per second: 341.99
I0903 00:20:33.279929 139819819333632 replay_runner.py:36] Average training steps per second: 341.99
I0903 00:20:33.420685 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.29
INFO:tensorflow:Starting iteration 8

Steps executed: 216 Episode length: 66 Return: -220.3608852997209852
INFO:tensorflow:Average training steps per second: 334.88
I0903 00:20:39.876870 139819819333632 replay_runner.py:36] Average training steps per second: 334.88
I0903 00:20:40.002249 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.22
INFO:tensorflow:Starting iteration 9

Steps executed: 333 Episode length: 143 Return: -205.129150701959762
INFO:tensorflow:Average training steps per second: 339.85
I0903 00:20:46.416915 139819819333632 replay_runner.py:36] Average training steps per second: 339.85
I0903 00:20:46.622872 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.16
INFO:tensorflow:Starting iteration 10

Steps executed: 201 Episode length: 60 Return: -111.7354405888460662
INFO:tensorflow:Average training steps per second: 334.76
I0903 00:20:53.071547 139819819333632 replay_runner.py:36] Average training steps per second: 334.76
I0903 00:20:53.180689 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.84
INFO:tensorflow:Starting iteration 11

Steps executed: 75 Episode length: 75 Return: -546.31845901490540662
INFO:tensorflow:Average training steps per second: 333.28
I0903 00:20:59.619354 139819819333632 replay_runner.py:36] Average training steps per second: 333.28

Steps executed: 200 Episode length: 125 Return: -606.870122624670162
INFO:tensorflow:Starting iteration 12

Steps executed: 212 Episode length: 56 Return: -109.4635390258723862
INFO:tensorflow:Average training steps per second: 323.47
I0903 00:21:06.311403 139819819333632 replay_runner.py:36] Average training steps per second: 323.47
I0903 00:21:06.415953 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.79
INFO:tensorflow:Starting iteration 13

Steps executed: 215 Episode length: 53 Return: -356.8828319811626762
INFO:tensorflow:Average training steps per second: 332.77
I0903 00:21:12.829310 139819819333632 replay_runner.py:36] Average training steps per second: 332.77
I0903 00:21:12.963168 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.78
INFO:tensorflow:Starting iteration 14

Steps executed: 247 Episode length: 82 Return: -257.2837480793823552
INFO:tensorflow:Average training steps per second: 328.86
I0903 00:21:19.423014 139819819333632 replay_runner.py:36] Average training steps per second: 328.86
I0903 00:21:19.574559 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.12
INFO:tensorflow:Starting iteration 15

Steps executed: 252 Episode length: 68 Return: -470.2400876098919352
INFO:tensorflow:Average training steps per second: 333.58
I0903 00:21:26.011312 139819819333632 replay_runner.py:36] Average training steps per second: 333.58
I0903 00:21:26.163553 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -513.33
INFO:tensorflow:Starting iteration 16

Steps executed: 242 Episode length: 59 Return: -140.1671458385363352
INFO:tensorflow:Average training steps per second: 329.44
I0903 00:21:32.634089 139819819333632 replay_runner.py:36] Average training steps per second: 329.44
I0903 00:21:32.756498 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.10
INFO:tensorflow:Starting iteration 17

Steps executed: 249 Episode length: 83 Return: -648.1609000702443652
INFO:tensorflow:Average training steps per second: 324.47
I0903 00:21:39.279009 139819819333632 replay_runner.py:36] Average training steps per second: 324.47
I0903 00:21:39.423573 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -496.90
INFO:tensorflow:Starting iteration 18

Steps executed: 85 Episode length: 85 Return: -406.35058588951793652
INFO:tensorflow:Average training steps per second: 323.22

Steps executed: 214 Episode length: 64 Return: -583.6732460775924552
I0903 00:21:46.087900 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.90
INFO:tensorflow:Starting iteration 19

Steps executed: 258 Episode length: 69 Return: -582.1600348967618352
INFO:tensorflow:Average training steps per second: 333.22
I0903 00:21:52.532627 139819819333632 replay_runner.py:36] Average training steps per second: 333.22
I0903 00:21:52.695803 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.69
INFO:tensorflow:Starting iteration 20

Steps executed: 279 Episode length: 87 Return: -824.7847054530583352
INFO:tensorflow:Average training steps per second: 332.37
I0903 00:21:59.129134 139819819333632 replay_runner.py:36] Average training steps per second: 332.37
I0903 00:21:59.303144 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -605.97
INFO:tensorflow:Starting iteration 21

Steps executed: 258 Episode length: 66 Return: -522.4150917146876652
INFO:tensorflow:Average training steps per second: 323.86
I0903 00:22:05.796268 139819819333632 replay_runner.py:36] Average training steps per second: 323.86
I0903 00:22:05.961233 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -558.81
INFO:tensorflow:Starting iteration 22

Steps executed: 204 Episode length: 74 Return: -774.0834486116858652
INFO:tensorflow:Average training steps per second: 336.35
I0903 00:22:12.361322 139819819333632 replay_runner.py:36] Average training steps per second: 336.35
I0903 00:22:12.496887 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.03
INFO:tensorflow:Starting iteration 23

Steps executed: 224 Episode length: 81 Return: -694.3677564649895652
INFO:tensorflow:Average training steps per second: 343.80
I0903 00:22:18.850238 139819819333632 replay_runner.py:36] Average training steps per second: 343.80
I0903 00:22:18.995627 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -737.02
INFO:tensorflow:Starting iteration 24

Steps executed: 207 Episode length: 72 Return: -597.9040179679421652
INFO:tensorflow:Average training steps per second: 355.12
I0903 00:22:25.259930 139819819333632 replay_runner.py:36] Average training steps per second: 355.12
I0903 00:22:25.397481 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -558.85
INFO:tensorflow:Starting iteration 25

Steps executed: 263 Episode length: 67 Return: -656.3144569379126652
INFO:tensorflow:Average training steps per second: 358.81
I0903 00:22:31.575762 139819819333632 replay_runner.py:36] Average training steps per second: 358.81
I0903 00:22:31.726028 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.81
INFO:tensorflow:Starting iteration 26
I0903 00:22:35.066731 139819819333632 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 364.12

Steps executed: 216 Episode length: 82 Return: -663.5326481543711652
I0903 00:22:37.950007 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -578.07
INFO:tensorflow:Starting iteration 27
I0903 00:22:41.209621 139819819333632 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 363.58

Steps executed: 217 Episode length: 53 Return: -336.6331192769433652
I0903 00:22:44.082019 139819819333632 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.91
INFO:tensorflow:Starting iteration 28

Steps executed: 141 Episode length: 65 Return: -551.6340606969932652
INFO:tensorflow:Average training steps per second: 385.92
I0903 00:22:49.796352 139819819333632 replay_runner.py:36] Average training steps per second: 385.92

Steps executed: 206 Episode length: 65 Return: -594.4743453546852652
INFO:tensorflow:Starting iteration 29

Steps executed: 250 Episode length: 75 Return: -770.8874764831791652
INFO:tensorflow:Average training steps per second: 392.97
I0903 00:22:55.585903 139819819333632 replay_runner.py:36] Average training steps per second: 392.97

Done fixed training!Episode length: 75 Return: -770.8874764831791652