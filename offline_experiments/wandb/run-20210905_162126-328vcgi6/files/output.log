I0905 16:21:33.213814 140523977541632 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.214363 140523977541632 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.276826 140523977541632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.278144 140523977541632 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.278239 140523977541632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.278301 140523977541632 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.278415 140523977541632 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.278591 140523977541632 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:21:33.278652 140523977541632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.278722 140523977541632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.278794 140523977541632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.278863 140523977541632 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.278927 140523977541632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.279015 140523977541632 dqn_agent.py:283] 	 seed: 1630858893276660
I0905 16:21:33.280753 140523977541632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.280905 140523977541632 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:21:33.280978 140523977541632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.281042 140523977541632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.281099 140523977541632 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.281214 140523977541632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.281278 140523977541632 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.281348 140523977541632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.281419 140523977541632 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0905 16:21:34.960242 140523977541632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.297448 140523977541632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.398011 140523977541632 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.401830 140523977541632 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.401982 140523977541632 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.402062 140523977541632 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.402123 140523977541632 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.402178 140523977541632 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.402280 140523977541632 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:21:35.402348 140523977541632 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.402418 140523977541632 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.402484 140523977541632 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.402552 140523977541632 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.402616 140523977541632 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.402679 140523977541632 dqn_agent.py:283] 	 seed: 1630858895401792
I0905 16:21:35.404062 140523977541632 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.404171 140523977541632 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:21:35.404242 140523977541632 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.404303 140523977541632 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.404375 140523977541632 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.404433 140523977541632 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.404501 140523977541632 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.404567 140523977541632 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.404623 140523977541632 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.424266 140523977541632 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.435020 140523977541632 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.435181 140523977541632 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 253.15
I0905 16:21:39.385592 140523977541632 replay_runner.py:36] Average training steps per second: 253.15
I0905 16:21:40.139897 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 418 Episode length: 418 Return: -417.0
INFO:tensorflow:Average training steps per second: 356.96
I0905 16:21:43.103076 140523977541632 replay_runner.py:36] Average training steps per second: 356.96
I0905 16:21:43.271124 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 352.22
I0905 16:21:46.269946 140523977541632 replay_runner.py:36] Average training steps per second: 352.22
I0905 16:21:46.459708 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0905 16:21:46.618551 140523977541632 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 351.79
I0905 16:21:49.461396 140523977541632 replay_runner.py:36] Average training steps per second: 351.79
I0905 16:21:49.656334 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0905 16:21:49.815764 140523977541632 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 352.46
I0905 16:21:52.653377 140523977541632 replay_runner.py:36] Average training steps per second: 352.46
I0905 16:21:52.831487 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 16:21:52.992220 140523977541632 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 354.23
I0905 16:21:55.815666 140523977541632 replay_runner.py:36] Average training steps per second: 354.23
I0905 16:21:56.004574 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0905 16:21:56.166545 140523977541632 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 361.96
I0905 16:21:58.929568 140523977541632 replay_runner.py:36] Average training steps per second: 361.96
I0905 16:21:59.105296 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 326 Episode length: 155 Return: -154.0
INFO:tensorflow:Average training steps per second: 359.72
I0905 16:22:02.045636 140523977541632 replay_runner.py:36] Average training steps per second: 359.72
I0905 16:22:02.158866 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.00
INFO:tensorflow:Starting iteration 8

Steps executed: 277 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 355.32
I0905 16:22:05.133803 140523977541632 replay_runner.py:36] Average training steps per second: 355.32
I0905 16:22:05.238608 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.50
INFO:tensorflow:Starting iteration 9

Steps executed: 323 Episode length: 164 Return: -163.0
INFO:tensorflow:Average training steps per second: 354.76
I0905 16:22:08.225288 140523977541632 replay_runner.py:36] Average training steps per second: 354.76
I0905 16:22:08.333605 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.50
INFO:tensorflow:Starting iteration 10

Steps executed: 605 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 358.68
I0905 16:22:11.277879 140523977541632 replay_runner.py:36] Average training steps per second: 358.68
I0905 16:22:11.493965 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.00
INFO:tensorflow:Starting iteration 11

Steps executed: 330 Episode length: 200 Return: -199.0
INFO:tensorflow:Average training steps per second: 356.63
I0905 16:22:14.462312 140523977541632 replay_runner.py:36] Average training steps per second: 356.63
I0905 16:22:14.579164 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.00
INFO:tensorflow:Starting iteration 12

Steps executed: 254 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 352.81
I0905 16:22:17.572047 140523977541632 replay_runner.py:36] Average training steps per second: 352.81
I0905 16:22:17.667396 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 13

Steps executed: 272 Episode length: 147 Return: -146.0
INFO:tensorflow:Average training steps per second: 346.89
I0905 16:22:20.719171 140523977541632 replay_runner.py:36] Average training steps per second: 346.89
I0905 16:22:20.812649 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 14

Steps executed: 258 Episode length: 147 Return: -146.0
INFO:tensorflow:Average training steps per second: 356.32
I0905 16:22:23.776112 140523977541632 replay_runner.py:36] Average training steps per second: 356.32
I0905 16:22:23.868570 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 15

Steps executed: 251 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 354.29
I0905 16:22:26.849897 140523977541632 replay_runner.py:36] Average training steps per second: 354.29
I0905 16:22:26.935730 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 16

Steps executed: 216 Episode length: 216 Return: -215.0
INFO:tensorflow:Average training steps per second: 357.92
I0905 16:22:29.890426 140523977541632 replay_runner.py:36] Average training steps per second: 357.92
I0905 16:22:29.964999 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.00
INFO:tensorflow:Starting iteration 17

Steps executed: 319 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 359.88
I0905 16:22:32.901976 140523977541632 replay_runner.py:36] Average training steps per second: 359.88
I0905 16:22:33.012382 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.50
INFO:tensorflow:Starting iteration 18

Steps executed: 316 Episode length: 153 Return: -152.0
INFO:tensorflow:Average training steps per second: 355.60
I0905 16:22:35.983186 140523977541632 replay_runner.py:36] Average training steps per second: 355.60
I0905 16:22:36.094538 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.00
INFO:tensorflow:Starting iteration 19

Steps executed: 206 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 358.69
I0905 16:22:39.043813 140523977541632 replay_runner.py:36] Average training steps per second: 358.69
I0905 16:22:39.114055 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 20

Steps executed: 597 Episode length: 468 Return: -467.0
INFO:tensorflow:Average training steps per second: 359.50
I0905 16:22:42.054414 140523977541632 replay_runner.py:36] Average training steps per second: 359.50
I0905 16:22:42.280615 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.50
INFO:tensorflow:Starting iteration 21

Steps executed: 269 Episode length: 177 Return: -176.0
INFO:tensorflow:Average training steps per second: 359.85
I0905 16:22:45.217527 140523977541632 replay_runner.py:36] Average training steps per second: 359.85
I0905 16:22:45.322614 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.50
INFO:tensorflow:Starting iteration 22

Steps executed: 223 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 356.77
I0905 16:22:48.283963 140523977541632 replay_runner.py:36] Average training steps per second: 356.77
I0905 16:22:48.360751 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 357.58
I0905 16:22:51.317826 140523977541632 replay_runner.py:36] Average training steps per second: 357.58
I0905 16:22:51.494129 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 297 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 356.05
I0905 16:22:54.461153 140523977541632 replay_runner.py:36] Average training steps per second: 356.05
I0905 16:22:54.564721 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.50
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 357.52
I0905 16:22:57.520761 140523977541632 replay_runner.py:36] Average training steps per second: 357.52
I0905 16:22:57.593579 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 26

Steps executed: 589 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 361.00
I0905 16:23:00.523162 140523977541632 replay_runner.py:36] Average training steps per second: 361.00
I0905 16:23:00.726421 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.00
INFO:tensorflow:Starting iteration 27

Steps executed: 217 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 360.77
I0905 16:23:03.654787 140523977541632 replay_runner.py:36] Average training steps per second: 360.77
I0905 16:23:03.729613 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 28

Steps executed: 209 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 363.10
I0905 16:23:06.645374 140523977541632 replay_runner.py:36] Average training steps per second: 363.10
I0905 16:23:06.717418 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 376.73
I0905 16:23:09.523375 140523977541632 replay_runner.py:36] Average training steps per second: 376.73
I0905 16:23:09.603135 140523977541632 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00