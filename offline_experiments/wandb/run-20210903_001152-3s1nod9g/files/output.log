I0903 00:11:58.551399 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0903 00:11:58.558883 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:11:58.559016 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:11:58.559088 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:11:58.559147 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:11:58.559201 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:11:58.559270 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:11:58.559358 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:11:58.559431 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:11:58.559508 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:11:58.559574 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:11:58.559639 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:11:58.559715 139900407642112 dqn_agent.py:283] 	 seed: 1630627918558850
I0903 00:11:58.561737 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:11:58.561848 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:11:58.561923 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:11:58.562016 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:11:58.562072 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:11:58.562124 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:11:58.562193 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:11:58.562262 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:11:58.562335 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:11:58.591572 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:11:58.836548 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:11:58.846906 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:11:58.854316 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:11:58.854492 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:11:58.854601 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:11:58.854711 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:11:58.854941 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:11:58.855026 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:11:58.855087 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:11:58.855242 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:11:58.855377 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:11:58.855503 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:11:58.855618 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:11:58.855875 139900407642112 dqn_agent.py:283] 	 seed: 1630627918854280
I0903 00:11:58.857547 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:11:58.857658 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:11:58.857728 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:11:58.857789 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:11:58.857845 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:11:58.857916 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:11:58.857982 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:11:58.858060 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:11:58.858128 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:11:58.878684 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:11:58.896275 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:11:58.896472 139900407642112 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
Steps executed: 297 Episode length: 130 Return: -266.91562548206264
INFO:tensorflow:Average training steps per second: 257.43
I0903 00:12:02.781278 139900407642112 replay_runner.py:36] Average training steps per second: 257.43
I0903 00:12:03.704800 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.36
INFO:tensorflow:Starting iteration 1

Steps executed: 237 Episode length: 98 Return: -312.908980434917872
INFO:tensorflow:Average training steps per second: 315.56
I0903 00:12:10.207602 139900407642112 replay_runner.py:36] Average training steps per second: 315.56
I0903 00:12:10.351562 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.22
INFO:tensorflow:Starting iteration 2

Steps executed: 240 Episode length: 120 Return: -427.25132630386322
INFO:tensorflow:Average training steps per second: 322.68
I0903 00:12:16.734874 139900407642112 replay_runner.py:36] Average training steps per second: 322.68
I0903 00:12:16.903310 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.07
INFO:tensorflow:Starting iteration 3

Steps executed: 236 Episode length: 125 Return: -551.47788017356452
INFO:tensorflow:Average training steps per second: 319.43
I0903 00:12:23.355560 139900407642112 replay_runner.py:36] Average training steps per second: 319.43
I0903 00:12:23.491783 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.24
INFO:tensorflow:Starting iteration 4
I0903 00:12:26.730352 139900407642112 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 317.37

Steps executed: 498 Episode length: 498 Return: -250.14511338507768
I0903 00:12:30.527369 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.15
INFO:tensorflow:Starting iteration 5

Steps executed: 273 Episode length: 273 Return: -281.53959444616714
INFO:tensorflow:Average training steps per second: 313.35
I0903 00:12:36.968825 139900407642112 replay_runner.py:36] Average training steps per second: 313.35
I0903 00:12:37.211606 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.54
INFO:tensorflow:Starting iteration 6
I0903 00:12:40.553066 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 329.82

Steps executed: 1000 Episode length: 1000 Return: -70.86346968146522
I0903 00:12:45.552265 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.86
INFO:tensorflow:Starting iteration 7
I0903 00:12:49.040077 139900407642112 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 341.60

Steps executed: 1000 Episode length: 1000 Return: -84.06272041486751
I0903 00:12:53.126645 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.06
INFO:tensorflow:Starting iteration 8

Steps executed: 705 Episode length: 705 Return: -313.797601813346951
INFO:tensorflow:Average training steps per second: 357.64
I0903 00:12:59.469743 139900407642112 replay_runner.py:36] Average training steps per second: 357.64
I0903 00:13:00.425902 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.80
INFO:tensorflow:Starting iteration 9

Steps executed: 313 Episode length: 172 Return: -852.999649455757421
INFO:tensorflow:Average training steps per second: 340.11
I0903 00:13:06.901345 139900407642112 replay_runner.py:36] Average training steps per second: 340.11
I0903 00:13:07.099384 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -540.02
INFO:tensorflow:Starting iteration 10

Steps executed: 234 Episode length: 137 Return: -142.447376589185221
INFO:tensorflow:Average training steps per second: 329.39
I0903 00:13:13.585212 139900407642112 replay_runner.py:36] Average training steps per second: 329.39
I0903 00:13:13.724515 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.68
INFO:tensorflow:Starting iteration 11

Steps executed: 302 Episode length: 302 Return: -655.646778943765221
INFO:tensorflow:Average training steps per second: 334.97
I0903 00:13:20.128084 139900407642112 replay_runner.py:36] Average training steps per second: 334.97
I0903 00:13:20.388797 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -655.65
INFO:tensorflow:Starting iteration 12

Steps executed: 216 Episode length: 96 Return: -485.5850367978441721
INFO:tensorflow:Average training steps per second: 331.52
I0903 00:13:26.807300 139900407642112 replay_runner.py:36] Average training steps per second: 331.52
I0903 00:13:26.940655 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -515.54
INFO:tensorflow:Starting iteration 13

Steps executed: 727 Episode length: 565 Return: -139.599540390260321
INFO:tensorflow:Average training steps per second: 325.23
I0903 00:13:33.339970 139900407642112 replay_runner.py:36] Average training steps per second: 325.23
I0903 00:13:34.084651 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.69
INFO:tensorflow:Starting iteration 14

Steps executed: 263 Episode length: 143 Return: -104.729969872044451
INFO:tensorflow:Average training steps per second: 314.73
I0903 00:13:40.557955 139900407642112 replay_runner.py:36] Average training steps per second: 314.73
I0903 00:13:40.743106 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.32
INFO:tensorflow:Starting iteration 15

Steps executed: 269 Episode length: 136 Return: -159.321711319860011
INFO:tensorflow:Average training steps per second: 323.52
I0903 00:13:47.126531 139900407642112 replay_runner.py:36] Average training steps per second: 323.52
I0903 00:13:47.301290 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.63
INFO:tensorflow:Starting iteration 16

Steps executed: 287 Episode length: 287 Return: -180.391055723107481
INFO:tensorflow:Average training steps per second: 327.56
I0903 00:13:53.676211 139900407642112 replay_runner.py:36] Average training steps per second: 327.56
I0903 00:13:53.914545 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.39
INFO:tensorflow:Starting iteration 17

Steps executed: 334 Episode length: 334 Return: -263.839538321824481
INFO:tensorflow:Average training steps per second: 334.75
I0903 00:14:00.263526 139900407642112 replay_runner.py:36] Average training steps per second: 334.75
I0903 00:14:00.537635 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.84
INFO:tensorflow:Starting iteration 18

Steps executed: 304 Episode length: 165 Return: -486.582679651507911
INFO:tensorflow:Average training steps per second: 318.15
I0903 00:14:07.084233 139900407642112 replay_runner.py:36] Average training steps per second: 318.15
I0903 00:14:07.298928 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.62
INFO:tensorflow:Starting iteration 19

Steps executed: 474 Episode length: 354 Return: -103.642533596751481
INFO:tensorflow:Average training steps per second: 324.03
I0903 00:14:13.742842 139900407642112 replay_runner.py:36] Average training steps per second: 324.03
I0903 00:14:14.172346 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.60
INFO:tensorflow:Starting iteration 20

Steps executed: 245 Episode length: 245 Return: -18.0875137697929981
INFO:tensorflow:Average training steps per second: 316.21
I0903 00:14:20.655929 139900407642112 replay_runner.py:36] Average training steps per second: 316.21
I0903 00:14:20.872697 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.09
INFO:tensorflow:Starting iteration 21

Steps executed: 688 Episode length: 544 Return: -351.055677150178231
INFO:tensorflow:Average training steps per second: 313.08
I0903 00:14:27.393074 139900407642112 replay_runner.py:36] Average training steps per second: 313.08
I0903 00:14:28.300709 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.48
INFO:tensorflow:Starting iteration 22

Steps executed: 301 Episode length: 182 Return: -810.383802134061631
INFO:tensorflow:Average training steps per second: 315.12
I0903 00:14:34.856343 139900407642112 replay_runner.py:36] Average training steps per second: 315.12
I0903 00:14:35.054541 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -875.15
INFO:tensorflow:Starting iteration 23

Steps executed: 304 Episode length: 110 Return: -545.916664497455531
INFO:tensorflow:Average training steps per second: 317.20
I0903 00:14:41.546765 139900407642112 replay_runner.py:36] Average training steps per second: 317.20
I0903 00:14:41.721213 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.68
INFO:tensorflow:Starting iteration 24

Steps executed: 222 Episode length: 133 Return: -327.351847603065431
INFO:tensorflow:Average training steps per second: 322.40
I0903 00:14:48.130723 139900407642112 replay_runner.py:36] Average training steps per second: 322.40
I0903 00:14:48.276413 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.74
INFO:tensorflow:Starting iteration 25
I0903 00:14:51.610714 139900407642112 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 323.06

Steps executed: 230 Episode length: 230 Return: -77.4174097155031431
I0903 00:14:54.873911 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.42
INFO:tensorflow:Starting iteration 26

Steps executed: 202 Episode length: 202 Return: -308.896916729440361
INFO:tensorflow:Average training steps per second: 317.29
I0903 00:15:01.422883 139900407642112 replay_runner.py:36] Average training steps per second: 317.29
I0903 00:15:01.567443 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.90
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 215 Return: -682.584539896704561
INFO:tensorflow:Average training steps per second: 323.47
I0903 00:15:08.010375 139900407642112 replay_runner.py:36] Average training steps per second: 323.47
I0903 00:15:08.168933 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -682.58
INFO:tensorflow:Starting iteration 28
I0903 00:15:11.555578 139900407642112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 331.86

Steps executed: 625 Episode length: 625 Return: -550.902959254980561
I0903 00:15:15.378725 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.90
INFO:tensorflow:Starting iteration 29

Steps executed: 444 Episode length: 326 Return: -743.451502324837461
INFO:tensorflow:Average training steps per second: 334.83
I0903 00:15:21.753236 139900407642112 replay_runner.py:36] Average training steps per second: 334.83

Done fixed training!Episode length: 326 Return: -743.451502324837461