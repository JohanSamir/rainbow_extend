I0905 18:47:51.121539 140258042054656 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.122303 140258042054656 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.184271 140258042054656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.185633 140258042054656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.185740 140258042054656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.185819 140258042054656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.185894 140258042054656 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.186004 140258042054656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:47:51.186085 140258042054656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.186191 140258042054656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.186270 140258042054656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.186440 140258042054656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.186536 140258042054656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.186619 140258042054656 dqn_agent.py:283] 	 seed: 1630867671184206
I0905 18:47:51.188612 140258042054656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.188749 140258042054656 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:47:51.188853 140258042054656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.188934 140258042054656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.189011 140258042054656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.189092 140258042054656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.189181 140258042054656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.189285 140258042054656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.189369 140258042054656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.348356 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.669539 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.694044 140258042054656 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:52.698066 140258042054656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:52.698242 140258042054656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:52.698362 140258042054656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:52.698439 140258042054656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:52.698514 140258042054656 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:52.698591 140258042054656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:47:52.698676 140258042054656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:52.698785 140258042054656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:52.698866 140258042054656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:52.698945 140258042054656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:52.699024 140258042054656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:52.699103 140258042054656 dqn_agent.py:283] 	 seed: 1630867672698025
I0905 18:47:52.700677 140258042054656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:52.700788 140258042054656 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:47:52.700888 140258042054656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:52.700968 140258042054656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:52.701044 140258042054656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:52.701124 140258042054656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:52.701206 140258042054656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:52.701289 140258042054656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:52.701369 140258042054656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.717154 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.726155 140258042054656 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:52.726385 140258042054656 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 277.26
I0905 18:47:56.333357 140258042054656 replay_runner.py:36] Average training steps per second: 277.26
Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:47:57.074623 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 18:47:57.237079 140258042054656 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 372.21
I0905 18:47:59.923971 140258042054656 replay_runner.py:36] Average training steps per second: 372.21
I0905 18:48:00.104725 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0905 18:48:00.274703 140258042054656 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 368.11
I0905 18:48:02.991566 140258042054656 replay_runner.py:36] Average training steps per second: 368.11
I0905 18:48:03.170274 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0905 18:48:03.329856 140258042054656 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 374.07
I0905 18:48:06.003434 140258042054656 replay_runner.py:36] Average training steps per second: 374.07
I0905 18:48:06.185332 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 258 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 363.66
I0905 18:48:09.098285 140258042054656 replay_runner.py:36] Average training steps per second: 363.66
I0905 18:48:09.197275 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 5

Steps executed: 237 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 366.71
I0905 18:48:12.081058 140258042054656 replay_runner.py:36] Average training steps per second: 366.71
I0905 18:48:12.171312 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 6

Steps executed: 347 Episode length: 178 Return: -177.0
INFO:tensorflow:Average training steps per second: 361.23
I0905 18:48:15.105133 140258042054656 replay_runner.py:36] Average training steps per second: 361.23
I0905 18:48:15.223395 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.50
INFO:tensorflow:Starting iteration 7

Steps executed: 245 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 369.65
I0905 18:48:18.093977 140258042054656 replay_runner.py:36] Average training steps per second: 369.65
I0905 18:48:18.181683 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 8

Steps executed: 246 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 368.30
I0905 18:48:21.060677 140258042054656 replay_runner.py:36] Average training steps per second: 368.30
I0905 18:48:21.148590 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 9

Steps executed: 222 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 369.07
I0905 18:48:24.018016 140258042054656 replay_runner.py:36] Average training steps per second: 369.07
I0905 18:48:24.096540 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 10
I0905 18:48:24.254856 140258042054656 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 371.06

Steps executed: 206 Episode length: 110 Return: -109.0
I0905 18:48:27.022792 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 11

Steps executed: 229 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 368.83
I0905 18:48:29.893244 140258042054656 replay_runner.py:36] Average training steps per second: 368.83
I0905 18:48:29.974678 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 12

Steps executed: 257 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 374.67
I0905 18:48:32.801043 140258042054656 replay_runner.py:36] Average training steps per second: 374.67
I0905 18:48:32.894732 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 365.20
I0905 18:48:35.790501 140258042054656 replay_runner.py:36] Average training steps per second: 365.20
I0905 18:48:35.873874 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 14

Steps executed: 209 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 368.36
I0905 18:48:38.749189 140258042054656 replay_runner.py:36] Average training steps per second: 368.36
I0905 18:48:38.822129 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 15

Steps executed: 218 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 367.39
I0905 18:48:41.702650 140258042054656 replay_runner.py:36] Average training steps per second: 367.39
I0905 18:48:41.778559 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 16

Steps executed: 209 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 367.58
I0905 18:48:44.657086 140258042054656 replay_runner.py:36] Average training steps per second: 367.58
I0905 18:48:44.727330 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 17

Steps executed: 314 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 367.13
I0905 18:48:47.610292 140258042054656 replay_runner.py:36] Average training steps per second: 367.13
I0905 18:48:47.725991 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.67
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 375.31
I0905 18:48:50.549379 140258042054656 replay_runner.py:36] Average training steps per second: 375.31
I0905 18:48:50.620932 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 19

Steps executed: 208 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 352.79
I0905 18:48:53.614544 140258042054656 replay_runner.py:36] Average training steps per second: 352.79
I0905 18:48:53.702996 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 20

Steps executed: 284 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 371.71
I0905 18:48:56.559659 140258042054656 replay_runner.py:36] Average training steps per second: 371.71
I0905 18:48:56.661522 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 21

Steps executed: 296 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 362.11
I0905 18:48:59.581469 140258042054656 replay_runner.py:36] Average training steps per second: 362.11
I0905 18:48:59.682013 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 22

Steps executed: 258 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 373.09
I0905 18:49:02.520110 140258042054656 replay_runner.py:36] Average training steps per second: 373.09
I0905 18:49:02.608281 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 369.97
I0905 18:49:05.469079 140258042054656 replay_runner.py:36] Average training steps per second: 369.97
I0905 18:49:05.544588 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 24

Steps executed: 351 Episode length: 179 Return: -178.0
INFO:tensorflow:Average training steps per second: 364.56
I0905 18:49:08.445310 140258042054656 replay_runner.py:36] Average training steps per second: 364.56
I0905 18:49:08.567797 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 25

Steps executed: 264 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 368.03
I0905 18:49:11.443238 140258042054656 replay_runner.py:36] Average training steps per second: 368.03
I0905 18:49:11.534782 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 26

Steps executed: 235 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 373.38
I0905 18:49:14.370884 140258042054656 replay_runner.py:36] Average training steps per second: 373.38
I0905 18:49:14.454245 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 27

Steps executed: 252 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 373.29
I0905 18:49:17.294143 140258042054656 replay_runner.py:36] Average training steps per second: 373.29
I0905 18:49:17.379844 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 378.02
I0905 18:49:20.180631 140258042054656 replay_runner.py:36] Average training steps per second: 378.02
I0905 18:49:20.250851 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 29
I0905 18:49:20.408679 140258042054656 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 369.03

Done fixed training!Episode length: 110 Return: -109.0
I0905 18:49:23.191385 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50