I0902 11:26:23.929332 139669628516352 run_experiment.py:549] Creating TrainRunner ...
I0902 11:26:23.941482 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:23.941764 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:23.941942 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:23.942109 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:23.942245 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:23.942360 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:23.942489 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:23.942585 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:23.942657 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:23.942871 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:23.942978 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:23.943077 139669628516352 dqn_agent.py:283] 	 seed: 1630581983941427
I0902 11:26:23.944934 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:23.945054 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:23.945178 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:23.945287 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:23.945359 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:23.945441 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:23.945499 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:23.945554 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:23.945642 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:24.113562 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.756090 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.769792 139669628516352 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:26:24.777591 139669628516352 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:26:24.777837 139669628516352 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:26:24.777937 139669628516352 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:26:24.778008 139669628516352 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:26:24.778138 139669628516352 dqn_agent.py:275] 	 update_period: 4
I0902 11:26:24.778249 139669628516352 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:26:24.778331 139669628516352 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:26:24.778423 139669628516352 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:26:24.778500 139669628516352 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:26:24.778564 139669628516352 dqn_agent.py:280] 	 optimizer: adam
I0902 11:26:24.778622 139669628516352 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:26:24.778844 139669628516352 dqn_agent.py:283] 	 seed: 1630581984777538
I0902 11:26:24.781723 139669628516352 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:26:24.781935 139669628516352 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:26:24.782058 139669628516352 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:26:24.782193 139669628516352 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:26:24.782373 139669628516352 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:26:24.782558 139669628516352 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:26:24.782654 139669628516352 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:26:24.782730 139669628516352 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:26:24.782806 139669628516352 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:26:24.825788 139669628516352 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:26:24.859227 139669628516352 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:26:24.859655 139669628516352 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 139.65
I0902 11:26:32.020477 139669628516352 replay_runner.py:36] Average training steps per second: 139.65
I0902 11:26:33.386723 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.32
Steps executed: 234 Episode length: 141 Return: -293.972985391285
INFO:tensorflow:Starting iteration 1

Steps executed: 445 Episode length: 269 Return: -407.37728907712415
INFO:tensorflow:Average training steps per second: 215.52
I0902 11:26:42.420347 139669628516352 replay_runner.py:36] Average training steps per second: 215.52
I0902 11:26:42.958859 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.49
INFO:tensorflow:Starting iteration 2

Steps executed: 779 Episode length: 586 Return: -402.63850363942475
INFO:tensorflow:Average training steps per second: 218.77
I0902 11:26:51.984179 139669628516352 replay_runner.py:36] Average training steps per second: 218.77
I0902 11:26:53.463429 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.60
INFO:tensorflow:Starting iteration 3
I0902 11:26:57.771902 139669628516352 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 242.45

Steps executed: 308 Episode length: 181 Return: -170.30550068023354
I0902 11:27:02.184742 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.24
INFO:tensorflow:Starting iteration 4
I0902 11:27:06.391340 139669628516352 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 264.29

Steps executed: 1000 Episode length: 1000 Return: -168.32203081949677
I0902 11:27:13.546698 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.32
INFO:tensorflow:Starting iteration 5
I0902 11:27:17.667898 139669628516352 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 236.78

Steps executed: 1000 Episode length: 1000 Return: -140.52841782710947
I0902 11:27:24.666160 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.53
INFO:tensorflow:Starting iteration 6
I0902 11:27:28.944191 139669628516352 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 217.62

Steps executed: 381 Episode length: 381 Return: -788.0541600801373947
I0902 11:27:34.084827 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -788.05
INFO:tensorflow:Starting iteration 7
I0902 11:27:38.452446 139669628516352 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 216.93

Steps executed: 441 Episode length: 441 Return: -650.8343042111359947
I0902 11:27:43.956447 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -650.83
INFO:tensorflow:Starting iteration 8
I0902 11:27:48.271841 139669628516352 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 216.23

Steps executed: 723 Episode length: 723 Return: -310.3166992242859947
I0902 11:27:54.308742 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.32
INFO:tensorflow:Starting iteration 9

Steps executed: 383 Episode length: 383 Return: -529.7385953179624947
INFO:tensorflow:Average training steps per second: 216.91
I0902 11:28:03.305131 139669628516352 replay_runner.py:36] Average training steps per second: 216.91
I0902 11:28:03.875217 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.74
INFO:tensorflow:Starting iteration 10
I0902 11:28:08.198094 139669628516352 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.49

Steps executed: 802 Episode length: 802 Return: -396.8743364273712947
I0902 11:28:14.157122 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.87
INFO:tensorflow:Starting iteration 11
I0902 11:28:18.608149 139669628516352 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 219.97

Steps executed: 1000 Episode length: 1000 Return: -174.99687801637245
I0902 11:28:26.175056 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.00
INFO:tensorflow:Starting iteration 12
I0902 11:28:30.502552 139669628516352 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 225.48

Steps executed: 560 Episode length: 560 Return: -307.3040701262690445
I0902 11:28:36.410954 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.30
INFO:tensorflow:Starting iteration 13
I0902 11:28:40.848317 139669628516352 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 219.67

Steps executed: 609 Episode length: 609 Return: 166.30159766429145445
I0902 11:28:46.576999 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.30
INFO:tensorflow:Starting iteration 14

Steps executed: 152 Episode length: 152 Return: -335.8885987918585445
INFO:tensorflow:Average training steps per second: 218.90

Steps executed: 1152 Episode length: 1000 Return: -111.01337356992755
I0902 11:28:58.573383 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.45
INFO:tensorflow:Starting iteration 15

Steps executed: 197 Episode length: 197 Return: -204.1235674121912555
INFO:tensorflow:Average training steps per second: 213.07

Steps executed: 673 Episode length: 476 Return: -31.31994291387590655
I0902 11:29:08.921042 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.72
INFO:tensorflow:Starting iteration 16
I0902 11:29:13.209923 139669628516352 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 213.60

Steps executed: 701 Episode length: 701 Return: -134.7024622535975655
I0902 11:29:19.444883 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.70
INFO:tensorflow:Starting iteration 17

Steps executed: 192 Episode length: 192 Return: -14.81199437755023555
INFO:tensorflow:Average training steps per second: 216.20

Steps executed: 1192 Episode length: 1000 Return: 119.832501021354845
I0902 11:29:31.231825 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: 52.51
INFO:tensorflow:Starting iteration 18
I0902 11:29:35.611335 139669628516352 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 217.53

Steps executed: 218 Episode length: 141 Return: -465.5874221198544845
I0902 11:29:40.423010 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.69
INFO:tensorflow:Starting iteration 19

Steps executed: 403 Episode length: 284 Return: -343.5562611636831845
INFO:tensorflow:Average training steps per second: 216.81
I0902 11:29:49.376091 139669628516352 replay_runner.py:36] Average training steps per second: 216.81
I0902 11:29:49.849192 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.24
INFO:tensorflow:Starting iteration 20

Steps executed: 270 Episode length: 120 Return: -244.9620753792369245
INFO:tensorflow:Average training steps per second: 223.48
I0902 11:29:58.607378 139669628516352 replay_runner.py:36] Average training steps per second: 223.48
I0902 11:29:58.855809 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.66
INFO:tensorflow:Starting iteration 21

Steps executed: 231 Episode length: 108 Return: -427.8870149001263645
INFO:tensorflow:Average training steps per second: 242.29
I0902 11:30:07.155666 139669628516352 replay_runner.py:36] Average training steps per second: 242.29
I0902 11:30:07.346532 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.94
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 150 Return: -52.90377168319007645
INFO:tensorflow:Average training steps per second: 261.23
I0902 11:30:15.193985 139669628516352 replay_runner.py:36] Average training steps per second: 261.23
I0902 11:30:15.385764 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.06
INFO:tensorflow:Starting iteration 23
I0902 11:30:19.092512 139669628516352 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 306.41
I0902 11:30:22.356854 139669628516352 replay_runner.py:36] Average training steps per second: 306.41

Steps executed: 254 Episode length: 254 Return: 66.527490889445807645
INFO:tensorflow:Starting iteration 24

Steps executed: 321 Episode length: 140 Return: -76.96234625290641845
INFO:tensorflow:Average training steps per second: 322.65
I0902 11:30:29.131244 139669628516352 replay_runner.py:36] Average training steps per second: 322.65
I0902 11:30:29.339024 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.15
INFO:tensorflow:Starting iteration 25

Steps executed: 266 Episode length: 101 Return: -466.3964291581998845
INFO:tensorflow:Average training steps per second: 321.20
I0902 11:30:35.854825 139669628516352 replay_runner.py:36] Average training steps per second: 321.20
I0902 11:30:36.027450 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.99
INFO:tensorflow:Starting iteration 26
I0902 11:30:39.401127 139669628516352 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 314.09
I0902 11:30:42.585205 139669628516352 replay_runner.py:36] Average training steps per second: 314.09

Steps executed: 228 Episode length: 71 Return: -157.81620546434482845
INFO:tensorflow:Starting iteration 27

Steps executed: 426 Episode length: 286 Return: -342.9198073911819845
INFO:tensorflow:Average training steps per second: 307.82
I0902 11:30:49.264956 139669628516352 replay_runner.py:36] Average training steps per second: 307.82
I0902 11:30:49.591232 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.39
INFO:tensorflow:Starting iteration 28

Steps executed: 315 Episode length: 163 Return: -13.00776673261701445
INFO:tensorflow:Average training steps per second: 304.26
I0902 11:30:56.111671 139669628516352 replay_runner.py:36] Average training steps per second: 304.26
I0902 11:30:56.307985 139669628516352 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.91
INFO:tensorflow:Starting iteration 29

Steps executed: 252 Episode length: 126 Return: -690.0298985453857445
INFO:tensorflow:Average training steps per second: 317.03
I0902 11:31:02.612029 139669628516352 replay_runner.py:36] Average training steps per second: 317.03

Done fixed training!Episode length: 126 Return: -690.0298985453857445