I0909 13:22:07.499561 140715861972992 run_experiment.py:549] Creating TrainRunner ...
I0909 13:22:07.506053 140715861972992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:07.506163 140715861972992 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:07.506221 140715861972992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:07.506295 140715861972992 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:07.506345 140715861972992 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:07.506391 140715861972992 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:07.506465 140715861972992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:07.506539 140715861972992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:07.506600 140715861972992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:07.506674 140715861972992 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:07.506717 140715861972992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:07.506762 140715861972992 dqn_agent.py:283] 	 seed: 1631193727506024
I0909 13:22:07.508193 140715861972992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:07.508290 140715861972992 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:07.508390 140715861972992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:07.508454 140715861972992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:07.508523 140715861972992 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:07.508577 140715861972992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:07.508653 140715861972992 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:07.508736 140715861972992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:07.508790 140715861972992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:07.801486 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:07.972351 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:07.982687 140715861972992 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:22:07.989013 140715861972992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:22:07.989304 140715861972992 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:22:07.989493 140715861972992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:22:07.989604 140715861972992 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:22:07.989682 140715861972992 dqn_agent.py:275] 	 update_period: 4
I0909 13:22:07.989755 140715861972992 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:22:07.989888 140715861972992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:22:07.990006 140715861972992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:22:07.990123 140715861972992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:22:07.990200 140715861972992 dqn_agent.py:280] 	 optimizer: adam
I0909 13:22:07.990271 140715861972992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:22:07.990343 140715861972992 dqn_agent.py:283] 	 seed: 1631193727988979
I0909 13:22:08.014670 140715861972992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:22:08.014847 140715861972992 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:22:08.014921 140715861972992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:22:08.014984 140715861972992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:22:08.015133 140715861972992 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:22:08.015207 140715861972992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:22:08.015283 140715861972992 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:22:08.015358 140715861972992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:22:08.015428 140715861972992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:22:08.041266 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:22:08.055812 140715861972992 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:22:08.055995 140715861972992 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 199.17
I0909 13:22:13.077077 140715861972992 replay_runner.py:36] Average training steps per second: 199.17
I0909 13:22:14.087244 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:22:14.180668 140715861972992 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 267.81
I0909 13:22:17.915219 140715861972992 replay_runner.py:36] Average training steps per second: 267.81
I0909 13:22:18.164885 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:22:18.260386 140715861972992 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 257.37
I0909 13:22:22.146178 140715861972992 replay_runner.py:36] Average training steps per second: 257.37
I0909 13:22:22.398594 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:22:22.489648 140715861972992 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 264.17
I0909 13:22:26.275508 140715861972992 replay_runner.py:36] Average training steps per second: 264.17
I0909 13:22:26.569267 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.50
INFO:tensorflow:Starting iteration 4

Steps executed: 703 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.55
I0909 13:22:30.423440 140715861972992 replay_runner.py:36] Average training steps per second: 265.55
I0909 13:22:30.675872 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 265.95
I0909 13:22:34.527289 140715861972992 replay_runner.py:36] Average training steps per second: 265.95
I0909 13:22:34.762743 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:22:34.853480 140715861972992 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 265.19
I0909 13:22:38.624767 140715861972992 replay_runner.py:36] Average training steps per second: 265.19
I0909 13:22:38.873655 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:22:38.966485 140715861972992 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 268.43
I0909 13:22:42.692368 140715861972992 replay_runner.py:36] Average training steps per second: 268.43
I0909 13:22:42.944255 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8

Steps executed: 263 Episode length: 171 Return: -171.0
INFO:tensorflow:Average training steps per second: 256.59
I0909 13:22:46.934273 140715861972992 replay_runner.py:36] Average training steps per second: 256.59
I0909 13:22:47.052621 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.50
INFO:tensorflow:Starting iteration 9

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 266.76
I0909 13:22:50.895661 140715861972992 replay_runner.py:36] Average training steps per second: 266.76
I0909 13:22:51.155036 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:22:51.249317 140715861972992 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 263.30
I0909 13:22:55.047678 140715861972992 replay_runner.py:36] Average training steps per second: 263.30
I0909 13:22:55.312397 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:22:55.404780 140715861972992 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 270.52
I0909 13:22:59.101765 140715861972992 replay_runner.py:36] Average training steps per second: 270.52
I0909 13:22:59.341474 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 267.17
I0909 13:23:03.172582 140715861972992 replay_runner.py:36] Average training steps per second: 267.17
I0909 13:23:03.266995 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 260.04
I0909 13:23:07.204522 140715861972992 replay_runner.py:36] Average training steps per second: 260.04
I0909 13:23:07.285848 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 14
I0909 13:23:07.374717 140715861972992 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 263.41
I0909 13:23:11.171511 140715861972992 replay_runner.py:36] Average training steps per second: 263.41

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 262.25
I0909 13:23:15.311618 140715861972992 replay_runner.py:36] Average training steps per second: 262.25
I0909 13:23:15.398010 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 16

Steps executed: 209 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 264.67
I0909 13:23:19.263527 140715861972992 replay_runner.py:36] Average training steps per second: 264.67
I0909 13:23:19.350070 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 17

Steps executed: 245 Episode length: 121 Return: -121.0
INFO:tensorflow:Average training steps per second: 265.96
I0909 13:23:23.199794 140715861972992 replay_runner.py:36] Average training steps per second: 265.96
I0909 13:23:23.305611 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 18

Steps executed: 713 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 264.25
I0909 13:23:27.186236 140715861972992 replay_runner.py:36] Average training steps per second: 264.25
I0909 13:23:27.481275 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.50
INFO:tensorflow:Starting iteration 19

Steps executed: 209 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 262.85
I0909 13:23:31.375911 140715861972992 replay_runner.py:36] Average training steps per second: 262.85
I0909 13:23:31.463937 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 20

Steps executed: 261 Episode length: 126 Return: -126.0
INFO:tensorflow:Average training steps per second: 252.15
I0909 13:23:35.529428 140715861972992 replay_runner.py:36] Average training steps per second: 252.15
I0909 13:23:35.636444 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.50
INFO:tensorflow:Starting iteration 21

Steps executed: 250 Episode length: 123 Return: -123.0
INFO:tensorflow:Average training steps per second: 262.15
I0909 13:23:39.542479 140715861972992 replay_runner.py:36] Average training steps per second: 262.15
I0909 13:23:39.647421 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 22

Steps executed: 299 Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 263.97
I0909 13:23:43.523707 140715861972992 replay_runner.py:36] Average training steps per second: 263.97
I0909 13:23:43.651281 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 23

Steps executed: 233 Episode length: 150 Return: -150.0
INFO:tensorflow:Average training steps per second: 266.65
I0909 13:23:47.495000 140715861972992 replay_runner.py:36] Average training steps per second: 266.65
I0909 13:23:47.599453 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 24

Steps executed: 769 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 262.58
I0909 13:23:51.500051 140715861972992 replay_runner.py:36] Average training steps per second: 262.58
I0909 13:23:51.825840 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.50
INFO:tensorflow:Starting iteration 25

Steps executed: 232 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 261.14
I0909 13:23:55.745867 140715861972992 replay_runner.py:36] Average training steps per second: 261.14
I0909 13:23:55.856172 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 26

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 268.05
I0909 13:23:59.678164 140715861972992 replay_runner.py:36] Average training steps per second: 268.05
I0909 13:23:59.766634 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 27
I0909 13:23:59.855287 140715861972992 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 264.03
I0909 13:24:03.643112 140715861972992 replay_runner.py:36] Average training steps per second: 264.03

Steps executed: 221 Episode length: 108 Return: -108.0
INFO:tensorflow:Starting iteration 28

Steps executed: 216 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 265.62
I0909 13:24:07.588576 140715861972992 replay_runner.py:36] Average training steps per second: 265.62
I0909 13:24:07.684153 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 296.62
I0909 13:24:11.143948 140715861972992 replay_runner.py:36] Average training steps per second: 296.62
I0909 13:24:11.306449 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00