Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0902 11:27:01.324278 139798986172416 run_experiment.py:549] Creating TrainRunner ...
I0902 11:27:01.332545 139798986172416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:01.332732 139798986172416 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:01.332811 139798986172416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:01.332878 139798986172416 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:01.332939 139798986172416 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:01.333004 139798986172416 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:01.333098 139798986172416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:01.333180 139798986172416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:01.333293 139798986172416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:01.333382 139798986172416 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:01.333454 139798986172416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:01.333513 139798986172416 dqn_agent.py:283] 	 seed: 1630582021332491
I0902 11:27:01.336498 139798986172416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:01.336695 139798986172416 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:27:01.336804 139798986172416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:01.336912 139798986172416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:01.336980 139798986172416 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:01.337045 139798986172416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:01.337135 139798986172416 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:01.337269 139798986172416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:01.337360 139798986172416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:01.577559 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:02.073892 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:02.088107 139798986172416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:27:02.096727 139798986172416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:02.096945 139798986172416 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:02.097023 139798986172416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:02.097085 139798986172416 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:02.097141 139798986172416 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:02.097229 139798986172416 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:02.097333 139798986172416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:02.097400 139798986172416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:02.097481 139798986172416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:02.097572 139798986172416 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:02.097647 139798986172416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:02.097726 139798986172416 dqn_agent.py:283] 	 seed: 1630582022096671
I0902 11:27:02.100352 139798986172416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:02.100563 139798986172416 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 11:27:02.100661 139798986172416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:02.100794 139798986172416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:02.100919 139798986172416 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:02.101171 139798986172416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:02.101298 139798986172416 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:02.101427 139798986172416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:02.101648 139798986172416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:02.149860 139798986172416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:02.174432 139798986172416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:27:02.174650 139798986172416 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 129.71
I0902 11:27:09.884310 139798986172416 replay_runner.py:36] Average training steps per second: 129.71
Steps executed: 200 Episode length: 200 Return: 200.0
I0902 11:27:11.015399 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 1
I0902 11:27:11.193814 139798986172416 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 226.98
I0902 11:27:15.600043 139798986172416 replay_runner.py:36] Average training steps per second: 226.98
I0902 11:27:15.720181 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2

Steps executed: 243 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 210.94
I0902 11:27:20.674068 139798986172416 replay_runner.py:36] Average training steps per second: 210.94
I0902 11:27:20.845634 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.13
I0902 11:27:26.063467 139798986172416 replay_runner.py:36] Average training steps per second: 198.13
I0902 11:27:26.200304 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.53
I0902 11:27:31.446666 139798986172416 replay_runner.py:36] Average training steps per second: 197.53
I0902 11:27:31.744397 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 5
I0902 11:27:31.942397 139798986172416 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 192.38
I0902 11:27:37.140969 139798986172416 replay_runner.py:36] Average training steps per second: 192.38

Steps executed: 232 Episode length: 127 Return: 127.0
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.50
I0902 11:27:42.643264 139798986172416 replay_runner.py:36] Average training steps per second: 194.50
I0902 11:27:42.788214 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 11:27:42.992605 139798986172416 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 195.38
I0902 11:27:48.111197 139798986172416 replay_runner.py:36] Average training steps per second: 195.38
I0902 11:27:48.259292 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 238 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 192.28
I0902 11:27:53.655807 139798986172416 replay_runner.py:36] Average training steps per second: 192.28
I0902 11:27:53.840402 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 119.00
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.88
I0902 11:27:59.250964 139798986172416 replay_runner.py:36] Average training steps per second: 191.88
I0902 11:27:59.404332 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 276 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 196.16
I0902 11:28:04.703676 139798986172416 replay_runner.py:36] Average training steps per second: 196.16
I0902 11:28:04.898423 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 11

Steps executed: 296 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 192.91
I0902 11:28:10.272970 139798986172416 replay_runner.py:36] Average training steps per second: 192.91
I0902 11:28:10.483110 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 12

Steps executed: 307 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 198.33
I0902 11:28:15.719306 139798986172416 replay_runner.py:36] Average training steps per second: 198.33
I0902 11:28:15.933362 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 13


Steps executed: 290 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 188.82
I0902 11:28:21.422776 139798986172416 replay_runner.py:36] Average training steps per second: 188.82
I0902 11:28:21.625421 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.77
I0902 11:28:26.853942 139798986172416 replay_runner.py:36] Average training steps per second: 198.77
I0902 11:28:27.011425 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 385 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.73
I0902 11:28:32.452195 139798986172416 replay_runner.py:36] Average training steps per second: 190.73
I0902 11:28:32.708662 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.76
I0902 11:28:37.909902 139798986172416 replay_runner.py:36] Average training steps per second: 199.76
I0902 11:28:38.053118 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 373 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 190.31
I0902 11:28:43.500966 139798986172416 replay_runner.py:36] Average training steps per second: 190.31
I0902 11:28:43.768533 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 18

Steps executed: 265 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 198.37
I0902 11:28:49.007506 139798986172416 replay_runner.py:36] Average training steps per second: 198.37
I0902 11:28:49.186511 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.07
I0902 11:28:54.536784 139798986172416 replay_runner.py:36] Average training steps per second: 193.07
I0902 11:28:54.675912 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 11:28:54.869802 139798986172416 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.52
I0902 11:28:59.958750 139798986172416 replay_runner.py:36] Average training steps per second: 196.52
I0902 11:29:00.098388 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 11:29:00.284111 139798986172416 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 190.83

Steps executed: 353 Episode length: 181 Return: 181.0
I0902 11:29:05.775051 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 22

Steps executed: 366 Episode length: 193 Return: 193.0
INFO:tensorflow:Average training steps per second: 194.35
I0902 11:29:11.124191 139798986172416 replay_runner.py:36] Average training steps per second: 194.35
I0902 11:29:11.375260 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.68
I0902 11:29:16.709157 139798986172416 replay_runner.py:36] Average training steps per second: 194.68
I0902 11:29:16.855107 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 349 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 192.55
I0902 11:29:22.239590 139798986172416 replay_runner.py:36] Average training steps per second: 192.55
I0902 11:29:22.475332 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 25

Steps executed: 316 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 192.28
I0902 11:29:27.861277 139798986172416 replay_runner.py:36] Average training steps per second: 192.28
I0902 11:29:28.092145 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.21
I0902 11:29:33.492210 139798986172416 replay_runner.py:36] Average training steps per second: 192.21
I0902 11:29:33.629439 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 289 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 196.73
I0902 11:29:38.902284 139798986172416 replay_runner.py:36] Average training steps per second: 196.73
I0902 11:29:39.116364 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 28

Steps executed: 300 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 195.00
I0902 11:29:44.439111 139798986172416 replay_runner.py:36] Average training steps per second: 195.00
I0902 11:29:44.654494 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 191.27
I0902 11:29:50.087734 139798986172416 replay_runner.py:36] Average training steps per second: 191.27
I0902 11:29:50.282728 139798986172416 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.00