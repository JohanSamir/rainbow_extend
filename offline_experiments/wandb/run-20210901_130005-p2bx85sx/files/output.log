Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0901 13:00:12.179185 140227445295104 run_experiment.py:549] Creating TrainRunner ...
I0901 13:00:12.189276 140227445295104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:12.189736 140227445295104 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:12.190142 140227445295104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:12.190316 140227445295104 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:12.190438 140227445295104 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:12.190541 140227445295104 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:12.190711 140227445295104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:12.190849 140227445295104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:12.190942 140227445295104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:12.191012 140227445295104 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:12.191078 140227445295104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:12.191248 140227445295104 dqn_agent.py:283] 	 seed: 1630501212189202
I0901 13:00:12.194035 140227445295104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:12.194210 140227445295104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:12.194361 140227445295104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:12.194513 140227445295104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:12.194634 140227445295104 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:12.194712 140227445295104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:12.194860 140227445295104 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:12.194977 140227445295104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:12.195051 140227445295104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:12.375497 140227445295104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:12.846101 140227445295104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:12.861141 140227445295104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:00:12.871134 140227445295104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:12.871438 140227445295104 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:12.871605 140227445295104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:12.871730 140227445295104 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:12.871903 140227445295104 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:12.872005 140227445295104 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:00:12.872109 140227445295104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:12.872248 140227445295104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:12.872382 140227445295104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:12.872489 140227445295104 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:12.872603 140227445295104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:12.872709 140227445295104 dqn_agent.py:283] 	 seed: 1630501212871077
I0901 13:00:12.875558 140227445295104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:12.875770 140227445295104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 13:00:12.875937 140227445295104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:12.876183 140227445295104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:12.876345 140227445295104 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:12.876555 140227445295104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:12.876684 140227445295104 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:12.876817 140227445295104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:12.876933 140227445295104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:12.915124 140227445295104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:12.938192 140227445295104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:00:12.938575 140227445295104 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 139.84
I0901 13:00:20.089723 140227445295104 replay_runner.py:36] Average training steps per second: 139.84
I0901 13:00:21.683988 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 13:00:21.909934 140227445295104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 188.47
I0901 13:00:27.216304 140227445295104 replay_runner.py:36] Average training steps per second: 188.47
I0901 13:00:27.718240 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 13:00:27.976404 140227445295104 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 187.43
I0901 13:00:33.312124 140227445295104 replay_runner.py:36] Average training steps per second: 187.43
I0901 13:00:33.751943 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 13:00:33.999959 140227445295104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 188.53
I0901 13:00:39.304720 140227445295104 replay_runner.py:36] Average training steps per second: 188.53
I0901 13:00:39.755340 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 436 Episode length: 436 Return: -435.0
INFO:tensorflow:Average training steps per second: 188.15
I0901 13:00:45.298004 140227445295104 replay_runner.py:36] Average training steps per second: 188.15
I0901 13:00:45.710906 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 190.28
I0901 13:00:51.223143 140227445295104 replay_runner.py:36] Average training steps per second: 190.28
I0901 13:00:51.406972 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 6

Steps executed: 245 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 185.14
I0901 13:00:57.058048 140227445295104 replay_runner.py:36] Average training steps per second: 185.14
I0901 13:00:57.283280 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.71
I0901 13:01:02.924562 140227445295104 replay_runner.py:36] Average training steps per second: 185.71
I0901 13:01:03.373804 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 13:01:03.627691 140227445295104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 182.25
I0901 13:01:09.115031 140227445295104 replay_runner.py:36] Average training steps per second: 182.25
I0901 13:01:09.566180 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 281 Episode length: 159 Return: -158.0
INFO:tensorflow:Average training steps per second: 185.89
I0901 13:01:15.207766 140227445295104 replay_runner.py:36] Average training steps per second: 185.89
I0901 13:01:15.464291 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.50
INFO:tensorflow:Starting iteration 10

Steps executed: 209 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 188.57
I0901 13:01:21.017061 140227445295104 replay_runner.py:36] Average training steps per second: 188.57
I0901 13:01:21.215749 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 11

Steps executed: 243 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 187.65
I0901 13:01:26.801949 140227445295104 replay_runner.py:36] Average training steps per second: 187.65
I0901 13:01:27.024297 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 12

Steps executed: 240 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 190.56
I0901 13:01:32.522474 140227445295104 replay_runner.py:36] Average training steps per second: 190.56
I0901 13:01:32.736272 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 13
I0901 13:01:32.988780 140227445295104 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 190.60

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 13:01:38.693652 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 318 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 196.00
I0901 13:01:44.032043 140227445295104 replay_runner.py:36] Average training steps per second: 196.00
I0901 13:01:44.297848 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 15

Steps executed: 292 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 200.76
I0901 13:01:49.512744 140227445295104 replay_runner.py:36] Average training steps per second: 200.76
I0901 13:01:49.742694 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 16

Steps executed: 271 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 187.90
I0901 13:01:55.305058 140227445295104 replay_runner.py:36] Average training steps per second: 187.90
I0901 13:01:55.522769 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 17

Steps executed: 281 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 195.24
I0901 13:02:00.872551 140227445295104 replay_runner.py:36] Average training steps per second: 195.24
I0901 13:02:01.122498 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 18

Steps executed: 237 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 186.33
I0901 13:02:06.718681 140227445295104 replay_runner.py:36] Average training steps per second: 186.33
I0901 13:02:06.911186 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 19

Steps executed: 286 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 189.36
I0901 13:02:12.435507 140227445295104 replay_runner.py:36] Average training steps per second: 189.36
I0901 13:02:12.681699 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 20

Steps executed: 268 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 200.84
I0901 13:02:17.906360 140227445295104 replay_runner.py:36] Average training steps per second: 200.84
I0901 13:02:18.141072 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 21

Steps executed: 250 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 193.88
I0901 13:02:23.558784 140227445295104 replay_runner.py:36] Average training steps per second: 193.88
I0901 13:02:23.768191 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 22

Steps executed: 290 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 195.12
I0901 13:02:29.132941 140227445295104 replay_runner.py:36] Average training steps per second: 195.12
I0901 13:02:29.393376 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.35
I0901 13:02:34.667328 140227445295104 replay_runner.py:36] Average training steps per second: 199.35
I0901 13:02:35.063912 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 13:02:35.298614 140227445295104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 189.44

Steps executed: 265 Episode length: 94 Return: -93.0.0
I0901 13:02:40.814774 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.50
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.17
I0901 13:02:46.056720 140227445295104 replay_runner.py:36] Average training steps per second: 200.17
I0901 13:02:46.482609 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 13:02:46.714295 140227445295104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.61
I0901 13:02:51.775146 140227445295104 replay_runner.py:36] Average training steps per second: 197.61
I0901 13:02:52.168185 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 249 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 195.91
I0901 13:02:57.509861 140227445295104 replay_runner.py:36] Average training steps per second: 195.91
I0901 13:02:57.718363 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 28
I0901 13:02:57.957550 140227445295104 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 205.26

Steps executed: 269 Episode length: 105 Return: -104.0
I0901 13:03:03.044263 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 29

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.24

Done fixed training!Episode length: 500 Return: -500.0
I0901 13:03:08.637060 140227445295104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00