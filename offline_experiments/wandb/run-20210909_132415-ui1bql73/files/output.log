I0909 13:24:21.362105 140537635538944 run_experiment.py:549] Creating TrainRunner ...
I0909 13:24:21.368891 140537635538944 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:21.369097 140537635538944 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:21.369234 140537635538944 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:21.369320 140537635538944 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:21.369404 140537635538944 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:21.369475 140537635538944 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:21.369545 140537635538944 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:21.369615 140537635538944 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:21.369685 140537635538944 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:21.369790 140537635538944 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:21.369956 140537635538944 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:21.370076 140537635538944 dqn_agent.py:283] 	 seed: 1631193861368854
I0909 13:24:21.372991 140537635538944 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:21.373118 140537635538944 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:21.373204 140537635538944 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:21.373280 140537635538944 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:21.373345 140537635538944 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:21.373406 140537635538944 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:21.373506 140537635538944 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:21.373605 140537635538944 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:21.373673 140537635538944 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:21.407745 140537635538944 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:21.628538 140537635538944 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:21.639281 140537635538944 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:24:21.646018 140537635538944 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:24:21.646204 140537635538944 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:24:21.646396 140537635538944 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:24:21.646492 140537635538944 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:24:21.646559 140537635538944 dqn_agent.py:275] 	 update_period: 4
I0909 13:24:21.646621 140537635538944 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:24:21.646795 140537635538944 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:24:21.646872 140537635538944 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:24:21.646966 140537635538944 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:24:21.647068 140537635538944 dqn_agent.py:280] 	 optimizer: adam
I0909 13:24:21.647128 140537635538944 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:24:21.647186 140537635538944 dqn_agent.py:283] 	 seed: 1631193861645971
I0909 13:24:21.648943 140537635538944 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:24:21.649078 140537635538944 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:24:21.649167 140537635538944 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:24:21.649237 140537635538944 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:24:21.649304 140537635538944 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:24:21.649389 140537635538944 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:24:21.649462 140537635538944 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:24:21.649555 140537635538944 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:24:21.649642 140537635538944 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:24:21.678165 140537635538944 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:24:21.697080 140537635538944 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:24:21.697267 140537635538944 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in mountaincar
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 176.83
I0909 13:24:27.352877 140537635538944 replay_runner.py:36] Average training steps per second: 176.83
I0909 13:24:28.557314 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:24:28.664989 140537635538944 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.78
I0909 13:24:33.094566 140537635538944 replay_runner.py:36] Average training steps per second: 225.78
I0909 13:24:33.426391 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:24:33.531592 140537635538944 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 226.86
I0909 13:24:37.940081 140537635538944 replay_runner.py:36] Average training steps per second: 226.86
I0909 13:24:38.280243 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:24:38.383584 140537635538944 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 221.42
I0909 13:24:42.900350 140537635538944 replay_runner.py:36] Average training steps per second: 221.42
I0909 13:24:43.254346 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:24:43.354204 140537635538944 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 226.51
I0909 13:24:47.769310 140537635538944 replay_runner.py:36] Average training steps per second: 226.51
I0909 13:24:48.099052 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:24:48.206931 140537635538944 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 224.67
I0909 13:24:52.658697 140537635538944 replay_runner.py:36] Average training steps per second: 224.67
I0909 13:24:53.005300 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:24:53.107916 140537635538944 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 226.74
I0909 13:24:57.518868 140537635538944 replay_runner.py:36] Average training steps per second: 226.74
I0909 13:24:57.869558 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:24:57.981755 140537635538944 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 224.26
I0909 13:25:02.441407 140537635538944 replay_runner.py:36] Average training steps per second: 224.26
I0909 13:25:02.782378 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:25:02.896262 140537635538944 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 228.64
I0909 13:25:07.270404 140537635538944 replay_runner.py:36] Average training steps per second: 228.64
I0909 13:25:07.637898 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 694 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 229.63
I0909 13:25:12.101788 140537635538944 replay_runner.py:36] Average training steps per second: 229.63
I0909 13:25:12.492985 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.00
INFO:tensorflow:Starting iteration 10
I0909 13:25:12.601830 140537635538944 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 227.00

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:25:17.356993 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:25:17.465040 140537635538944 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 225.14
I0909 13:25:21.907334 140537635538944 replay_runner.py:36] Average training steps per second: 225.14
I0909 13:25:22.256703 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 231 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 223.75
I0909 13:25:26.840562 140537635538944 replay_runner.py:36] Average training steps per second: 223.75
I0909 13:25:26.981573 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 13

Steps executed: 222 Episode length: 110 Return: -110.0
INFO:tensorflow:Average training steps per second: 224.66
I0909 13:25:31.533724 140537635538944 replay_runner.py:36] Average training steps per second: 224.66
I0909 13:25:31.664257 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 14

Steps executed: 208 Episode length: 103 Return: -103.0
INFO:tensorflow:Average training steps per second: 224.35
I0909 13:25:36.233988 140537635538944 replay_runner.py:36] Average training steps per second: 224.35
I0909 13:25:36.360512 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 15

Steps executed: 312 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 221.07
I0909 13:25:40.990491 140537635538944 replay_runner.py:36] Average training steps per second: 221.07
I0909 13:25:41.175205 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.00
INFO:tensorflow:Starting iteration 16

Steps executed: 336 Episode length: 175 Return: -175.0
INFO:tensorflow:Average training steps per second: 225.93
I0909 13:25:45.708850 140537635538944 replay_runner.py:36] Average training steps per second: 225.93
I0909 13:25:45.907757 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.00
INFO:tensorflow:Starting iteration 17

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 225.44
I0909 13:25:50.456008 140537635538944 replay_runner.py:36] Average training steps per second: 225.44
I0909 13:25:50.805760 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18

Steps executed: 230 Episode length: 114 Return: -114.0
INFO:tensorflow:Average training steps per second: 226.07
I0909 13:25:55.339165 140537635538944 replay_runner.py:36] Average training steps per second: 226.07
I0909 13:25:55.483732 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 19

Steps executed: 236 Episode length: 119 Return: -119.0
INFO:tensorflow:Average training steps per second: 226.29
I0909 13:26:00.015218 140537635538944 replay_runner.py:36] Average training steps per second: 226.29
I0909 13:26:00.154776 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 20

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 223.93
I0909 13:26:04.732950 140537635538944 replay_runner.py:36] Average training steps per second: 223.93
I0909 13:26:05.087483 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0909 13:26:05.200499 140537635538944 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 226.74
I0909 13:26:09.611322 140537635538944 replay_runner.py:36] Average training steps per second: 226.74
I0909 13:26:09.985303 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22

Steps executed: 217 Episode length: 109 Return: -109.0
INFO:tensorflow:Average training steps per second: 221.90
I0909 13:26:14.603241 140537635538944 replay_runner.py:36] Average training steps per second: 221.90
I0909 13:26:14.742358 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 23
I0909 13:26:14.855635 140537635538944 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 218.82
I0909 13:26:19.426253 140537635538944 replay_runner.py:36] Average training steps per second: 218.82
I0909 13:26:19.574456 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 24


Steps executed: 219 Episode length: 108 Return: -108.0
INFO:tensorflow:Average training steps per second: 220.28
I0909 13:26:24.231630 140537635538944 replay_runner.py:36] Average training steps per second: 220.28
I0909 13:26:24.361903 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 25

Steps executed: 231 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 223.48
I0909 13:26:28.964475 140537635538944 replay_runner.py:36] Average training steps per second: 223.48
I0909 13:26:29.105004 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 26
I0909 13:26:29.215970 140537635538944 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 223.59

Steps executed: 245 Episode length: 124 Return: -124.0
I0909 13:26:33.835601 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 27

Steps executed: 324 Episode length: 147 Return: -147.0
INFO:tensorflow:Average training steps per second: 222.49
I0909 13:26:38.438516 140537635538944 replay_runner.py:36] Average training steps per second: 222.49
I0909 13:26:38.632306 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.00
INFO:tensorflow:Starting iteration 28

Steps executed: 264 Episode length: 147 Return: -147.0
INFO:tensorflow:Average training steps per second: 224.89
I0909 13:26:43.186559 140537635538944 replay_runner.py:36] Average training steps per second: 224.89
I0909 13:26:43.346832 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.00
INFO:tensorflow:Starting iteration 29

Steps executed: 174 Episode length: 174 Return: -174.0
INFO:tensorflow:Average training steps per second: 245.68

Done fixed training!Episode length: 600 Return: -600.0
I0909 13:26:47.894640 140537635538944 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.00