Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0905 16:29:02.610341 140587280832512 run_experiment.py:549] Creating TrainRunner ...
I0905 16:29:02.617792 140587280832512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:02.617944 140587280832512 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:02.618050 140587280832512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:02.618113 140587280832512 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:02.618214 140587280832512 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:02.618287 140587280832512 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:02.618341 140587280832512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:02.618397 140587280832512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:02.618461 140587280832512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:02.618512 140587280832512 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:02.618564 140587280832512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:02.618667 140587280832512 dqn_agent.py:283] 	 seed: 1630859342617756
I0905 16:29:02.620923 140587280832512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:02.621056 140587280832512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:02.621143 140587280832512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:02.621214 140587280832512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:02.621277 140587280832512 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:02.621350 140587280832512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:02.621428 140587280832512 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:02.621517 140587280832512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:02.621594 140587280832512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:29:04.096334 140587280832512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.463803 140587280832512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.473665 140587280832512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:29:04.481142 140587280832512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:29:04.481352 140587280832512 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:29:04.481519 140587280832512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:29:04.481647 140587280832512 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:29:04.481827 140587280832512 dqn_agent.py:275] 	 update_period: 4
I0905 16:29:04.481946 140587280832512 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:29:04.482055 140587280832512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:29:04.482208 140587280832512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:29:04.482335 140587280832512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:29:04.482469 140587280832512 dqn_agent.py:280] 	 optimizer: adam
I0905 16:29:04.482574 140587280832512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:29:04.482700 140587280832512 dqn_agent.py:283] 	 seed: 1630859344481098
I0905 16:29:04.485159 140587280832512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:29:04.485322 140587280832512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:29:04.485450 140587280832512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:29:04.485571 140587280832512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:29:04.485706 140587280832512 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:29:04.485820 140587280832512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:29:04.485962 140587280832512 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:29:04.486082 140587280832512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:29:04.486192 140587280832512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:29:04.519233 140587280832512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:29:04.540508 140587280832512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:29:04.540770 140587280832512 replay_runner.py:41] Starting iteration 0
Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 202.35
I0905 16:29:09.483024 140587280832512 replay_runner.py:36] Average training steps per second: 202.35
I0905 16:29:10.219653 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 1

Steps executed: 189 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 251.19
I0905 16:29:14.341999 140587280832512 replay_runner.py:36] Average training steps per second: 251.19
I0905 16:29:14.431502 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.00
INFO:tensorflow:Starting iteration 2


Steps executed: 327 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 256.43
I0905 16:29:18.475265 140587280832512 replay_runner.py:36] Average training steps per second: 256.43
I0905 16:29:18.699749 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 3
I0905 16:29:18.861806 140587280832512 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 222.49
I0905 16:29:23.356620 140587280832512 replay_runner.py:36] Average training steps per second: 222.49
I0905 16:29:23.475390 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 226.72
I0905 16:29:28.059428 140587280832512 replay_runner.py:36] Average training steps per second: 226.72
I0905 16:29:28.250342 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 5

Steps executed: 326 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 206.51
I0905 16:29:33.270786 140587280832512 replay_runner.py:36] Average training steps per second: 206.51
I0905 16:29:33.485263 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 6

Steps executed: 352 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 208.93
I0905 16:29:38.445054 140587280832512 replay_runner.py:36] Average training steps per second: 208.93
I0905 16:29:38.636389 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 7

Steps executed: 298 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 209.60
I0905 16:29:43.587760 140587280832512 replay_runner.py:36] Average training steps per second: 209.60
I0905 16:29:43.802290 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 8

Steps executed: 340 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 207.33
I0905 16:29:48.808435 140587280832512 replay_runner.py:36] Average training steps per second: 207.33
I0905 16:29:48.999632 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 9

Steps executed: 300 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 204.09
I0905 16:29:54.081655 140587280832512 replay_runner.py:36] Average training steps per second: 204.09
I0905 16:29:54.265806 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 10

Steps executed: 292 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 205.63
I0905 16:29:59.322759 140587280832512 replay_runner.py:36] Average training steps per second: 205.63
I0905 16:29:59.552076 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 11

Steps executed: 372 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 205.81
I0905 16:30:04.591082 140587280832512 replay_runner.py:36] Average training steps per second: 205.81

Steps executed: 319 Episode length: 162 Return: 162.0
INFO:tensorflow:Starting iteration 12
I0905 16:30:04.962198 140587280832512 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 211.00
I0905 16:30:09.702191 140587280832512 replay_runner.py:36] Average training steps per second: 211.00
I0905 16:30:09.831156 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 209.20
I0905 16:30:14.797751 140587280832512 replay_runner.py:36] Average training steps per second: 209.20

Steps executed: 150 Episode length: 150 Return: 150.0
INFO:tensorflow:Starting iteration 14

Steps executed: 304 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 205.13
I0905 16:30:20.048089 140587280832512 replay_runner.py:36] Average training steps per second: 205.13
I0905 16:30:20.263806 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 15

Steps executed: 336 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 205.17
I0905 16:30:25.326671 140587280832512 replay_runner.py:36] Average training steps per second: 205.17
I0905 16:30:25.532604 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 16

Steps executed: 329 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 205.41

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:30:30.722813 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0905 16:30:30.912818 140587280832512 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 206.50
I0905 16:30:35.755811 140587280832512 replay_runner.py:36] Average training steps per second: 206.50
I0905 16:30:35.904124 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 16:30:36.081662 140587280832512 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 211.62
I0905 16:30:40.807461 140587280832512 replay_runner.py:36] Average training steps per second: 211.62
I0905 16:30:40.980474 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 19

Steps executed: 273 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 207.21
I0905 16:30:45.994899 140587280832512 replay_runner.py:36] Average training steps per second: 207.21
I0905 16:30:46.128745 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.78
I0905 16:30:51.288210 140587280832512 replay_runner.py:36] Average training steps per second: 204.78
I0905 16:30:51.416117 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 16:30:51.600182 140587280832512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 210.44
I0905 16:30:56.352670 140587280832512 replay_runner.py:36] Average training steps per second: 210.44
I0905 16:30:56.555721 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 22

Steps executed: 315 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 208.51
I0905 16:31:01.541411 140587280832512 replay_runner.py:36] Average training steps per second: 208.51
I0905 16:31:01.731681 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 23

Steps executed: 302 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 208.00
I0905 16:31:06.725023 140587280832512 replay_runner.py:36] Average training steps per second: 208.00
I0905 16:31:06.859304 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.87
I0905 16:31:11.884682 140587280832512 replay_runner.py:36] Average training steps per second: 206.87
I0905 16:31:12.021288 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0905 16:31:12.208437 140587280832512 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.03
I0905 16:31:17.086394 140587280832512 replay_runner.py:36] Average training steps per second: 205.03
I0905 16:31:17.219115 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0905 16:31:17.410565 140587280832512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 208.45
I0905 16:31:22.208296 140587280832512 replay_runner.py:36] Average training steps per second: 208.45
I0905 16:31:22.343893 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:31:22.535621 140587280832512 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 210.51
I0905 16:31:27.286603 140587280832512 replay_runner.py:36] Average training steps per second: 210.51
I0905 16:31:27.471858 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 28


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.78
I0905 16:31:32.590085 140587280832512 replay_runner.py:36] Average training steps per second: 202.78
I0905 16:31:32.716567 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 208.98
I0905 16:31:37.693084 140587280832512 replay_runner.py:36] Average training steps per second: 208.98
I0905 16:31:37.871901 140587280832512 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50