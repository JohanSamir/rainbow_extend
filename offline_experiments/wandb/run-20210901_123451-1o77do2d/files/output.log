Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0901 12:34:58.385534 139983334602752 run_experiment.py:549] Creating TrainRunner ...
I0901 12:34:58.395138 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:58.395353 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:58.395521 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:58.395589 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:58.395653 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:58.395723 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:58.395798 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:58.395879 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:58.395985 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:58.396052 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:58.396106 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:58.396159 139983334602752 dqn_agent.py:283] 	 seed: 1630499698395081
I0901 12:34:58.398831 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:58.399050 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:58.399130 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:58.399214 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:58.399279 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:58.399334 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:58.399493 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:58.399598 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:58.399652 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:58.441710 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:58.900619 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:58.914290 139983334602752 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:34:58.921844 139983334602752 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:34:58.922049 139983334602752 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:34:58.922157 139983334602752 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:34:58.922262 139983334602752 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:34:58.922365 139983334602752 dqn_agent.py:275] 	 update_period: 4
I0901 12:34:58.922445 139983334602752 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:34:58.922829 139983334602752 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:34:58.922971 139983334602752 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:34:58.923051 139983334602752 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:34:58.923127 139983334602752 dqn_agent.py:280] 	 optimizer: adam
I0901 12:34:58.923202 139983334602752 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:34:58.923318 139983334602752 dqn_agent.py:283] 	 seed: 1630499698921799
I0901 12:34:58.925351 139983334602752 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:34:58.925500 139983334602752 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:34:58.925710 139983334602752 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:34:58.925830 139983334602752 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:34:58.925931 139983334602752 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:34:58.926035 139983334602752 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:34:58.926168 139983334602752 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:34:58.926277 139983334602752 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:34:58.926375 139983334602752 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:34:58.960427 139983334602752 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:34:58.981991 139983334602752 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:34:58.982621 139983334602752 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 136.11
I0901 12:35:06.330156 139983334602752 replay_runner.py:36] Average training steps per second: 136.11
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:35:08.055734 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:35:08.373823 139983334602752 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 182.78
I0901 12:35:13.845404 139983334602752 replay_runner.py:36] Average training steps per second: 182.78
I0901 12:35:14.338566 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:35:14.591491 139983334602752 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 183.45
I0901 12:35:20.042879 139983334602752 replay_runner.py:36] Average training steps per second: 183.45
I0901 12:35:20.492139 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 309 Episode length: 158 Return: -157.0
INFO:tensorflow:Average training steps per second: 181.82
I0901 12:35:26.238800 139983334602752 replay_runner.py:36] Average training steps per second: 181.82
I0901 12:35:26.531321 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.50
INFO:tensorflow:Starting iteration 4
I0901 12:35:26.774911 139983334602752 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 189.03

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:35:32.543123 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:35:32.799437 139983334602752 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 182.26
I0901 12:35:38.286548 139983334602752 replay_runner.py:36] Average training steps per second: 182.26
I0901 12:35:38.732115 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:35:38.975615 139983334602752 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 182.28
I0901 12:35:44.462152 139983334602752 replay_runner.py:36] Average training steps per second: 182.28
I0901 12:35:44.949653 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:35:45.210933 139983334602752 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 206.25
I0901 12:35:50.059942 139983334602752 replay_runner.py:36] Average training steps per second: 206.25
I0901 12:35:50.533428 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:35:50.760577 139983334602752 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 204.07
I0901 12:35:55.661348 139983334602752 replay_runner.py:36] Average training steps per second: 204.07
I0901 12:35:56.145323 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 280 Episode length: 141 Return: -140.0
INFO:tensorflow:Average training steps per second: 186.34
I0901 12:36:01.765048 139983334602752 replay_runner.py:36] Average training steps per second: 186.34
I0901 12:36:02.035894 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.00
INFO:tensorflow:Starting iteration 10

Steps executed: 249 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 182.89
I0901 12:36:07.770550 139983334602752 replay_runner.py:36] Average training steps per second: 182.89
I0901 12:36:07.991614 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.50
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 180.32
I0901 12:36:13.771674 139983334602752 replay_runner.py:36] Average training steps per second: 180.32
I0901 12:36:14.246422 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:36:14.500389 139983334602752 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 187.28
I0901 12:36:19.840283 139983334602752 replay_runner.py:36] Average training steps per second: 187.28
I0901 12:36:20.286645 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0901 12:36:20.532941 139983334602752 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 182.05
I0901 12:36:26.026587 139983334602752 replay_runner.py:36] Average training steps per second: 182.05
I0901 12:36:26.467553 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 291 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 185.39
I0901 12:36:32.113901 139983334602752 replay_runner.py:36] Average training steps per second: 185.39
I0901 12:36:32.389025 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.50
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 182.93
I0901 12:36:38.116281 139983334602752 replay_runner.py:36] Average training steps per second: 182.93
I0901 12:36:38.559435 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16
I0901 12:36:38.807615 139983334602752 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 176.75
I0901 12:36:44.465953 139983334602752 replay_runner.py:36] Average training steps per second: 176.75
I0901 12:36:44.913642 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 12:36:45.166835 139983334602752 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 188.89
I0901 12:36:50.461446 139983334602752 replay_runner.py:36] Average training steps per second: 188.89
I0901 12:36:50.914225 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0901 12:36:51.148357 139983334602752 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 186.64

Steps executed: 255 Episode length: 151 Return: -150.0
I0901 12:36:56.743219 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 19

Steps executed: 111 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 196.69

Steps executed: 611 Episode length: 500 Return: -500.0
I0901 12:37:02.677660 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.00
INFO:tensorflow:Starting iteration 20
I0901 12:37:02.915774 139983334602752 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.04

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:37:08.494192 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0901 12:37:08.739609 139983334602752 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 191.90
I0901 12:37:13.951136 139983334602752 replay_runner.py:36] Average training steps per second: 191.90
I0901 12:37:14.394579 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 257 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 188.63
I0901 12:37:19.946916 139983334602752 replay_runner.py:36] Average training steps per second: 188.63
I0901 12:37:20.167446 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.25
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 184.73
I0901 12:37:25.823446 139983334602752 replay_runner.py:36] Average training steps per second: 184.73
I0901 12:37:26.261255 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0901 12:37:26.507421 139983334602752 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 181.99
I0901 12:37:32.002627 139983334602752 replay_runner.py:36] Average training steps per second: 181.99
I0901 12:37:32.451628 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 210 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 188.33
I0901 12:37:38.014657 139983334602752 replay_runner.py:36] Average training steps per second: 188.33
I0901 12:37:38.202463 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 26

Steps executed: 277 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 188.86
I0901 12:37:43.729282 139983334602752 replay_runner.py:36] Average training steps per second: 188.86
I0901 12:37:43.951547 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.33
INFO:tensorflow:Starting iteration 27

Steps executed: 300 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 194.26
I0901 12:37:49.339146 139983334602752 replay_runner.py:36] Average training steps per second: 194.26
I0901 12:37:49.617088 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 28

Steps executed: 272 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 194.90
I0901 12:37:55.016925 139983334602752 replay_runner.py:36] Average training steps per second: 194.90
I0901 12:37:55.264458 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 29
I0901 12:37:55.500808 139983334602752 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 192.59

Done fixed training!Episode length: 500 Return: -500.0
I0901 12:38:01.181872 139983334602752 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00