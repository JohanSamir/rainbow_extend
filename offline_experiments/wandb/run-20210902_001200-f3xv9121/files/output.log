Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0902 00:12:06.547951 140286289131520 run_experiment.py:549] Creating TrainRunner ...
I0902 00:12:06.557911 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:12:06.558253 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:12:06.558430 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:12:06.558613 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:12:06.558765 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0902 00:12:06.558930 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:12:06.559041 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:12:06.559158 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:12:06.559309 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:12:06.559474 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:12:06.559605 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:12:06.559774 140286289131520 dqn_agent.py:283] 	 seed: 1630541526557818
I0902 00:12:06.563329 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:12:06.563501 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:12:06.563645 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:12:06.563774 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:12:06.563941 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:12:06.564029 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:12:06.564120 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:12:06.564326 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:12:06.564436 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:12:06.606530 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:07.181459 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:07.196362 140286289131520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:12:07.206393 140286289131520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:12:07.206645 140286289131520 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:12:07.206926 140286289131520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:12:07.207095 140286289131520 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:12:07.207184 140286289131520 dqn_agent.py:275] 	 update_period: 4
I0902 00:12:07.207333 140286289131520 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:12:07.207450 140286289131520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:12:07.207540 140286289131520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:12:07.207616 140286289131520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:12:07.207737 140286289131520 dqn_agent.py:280] 	 optimizer: adam
I0902 00:12:07.207819 140286289131520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:12:07.207888 140286289131520 dqn_agent.py:283] 	 seed: 1630541527206329
I0902 00:12:07.210676 140286289131520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:12:07.210869 140286289131520 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:12:07.211004 140286289131520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:12:07.211181 140286289131520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:12:07.211420 140286289131520 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:12:07.211616 140286289131520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:12:07.211758 140286289131520 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:12:07.211971 140286289131520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:12:07.212139 140286289131520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:12:07.252258 140286289131520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:12:07.276051 140286289131520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:12:07.276362 140286289131520 replay_runner.py:41] Starting iteration 0
Steps executed: 279 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 138.53
I0902 00:12:14.495795 140286289131520 replay_runner.py:36] Average training steps per second: 138.53
I0902 00:12:15.741191 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 69.75
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.28
I0902 00:12:21.136788 140286289131520 replay_runner.py:36] Average training steps per second: 192.28
I0902 00:12:21.279606 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2
I0902 00:12:21.464956 140286289131520 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 186.91
I0902 00:12:26.815460 140286289131520 replay_runner.py:36] Average training steps per second: 186.91
I0902 00:12:26.947093 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 00:12:27.131636 140286289131520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.05

Steps executed: 272 Episode length: 132 Return: 132.0
I0902 00:12:32.466666 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.00
INFO:tensorflow:Starting iteration 4

Steps executed: 245 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 189.97
I0902 00:12:37.919256 140286289131520 replay_runner.py:36] Average training steps per second: 189.97
I0902 00:12:38.088301 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.50
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.57
I0902 00:12:43.705686 140286289131520 replay_runner.py:36] Average training steps per second: 184.57
I0902 00:12:43.854791 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 333 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 190.39
I0902 00:12:49.296861 140286289131520 replay_runner.py:36] Average training steps per second: 190.39
I0902 00:12:49.522933 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 7

Steps executed: 363 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 189.87
I0902 00:12:54.981372 140286289131520 replay_runner.py:36] Average training steps per second: 189.87
I0902 00:12:55.216304 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.50
INFO:tensorflow:Starting iteration 8

Steps executed: 332 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 187.52
I0902 00:13:00.737102 140286289131520 replay_runner.py:36] Average training steps per second: 187.52
I0902 00:13:00.978232 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 9

Steps executed: 138 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 186.60

Steps executed: 271 Episode length: 133 Return: 133.0
I0902 00:13:06.733775 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.50
INFO:tensorflow:Starting iteration 10

Steps executed: 257 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 192.26
I0902 00:13:12.132068 140286289131520 replay_runner.py:36] Average training steps per second: 192.26
I0902 00:13:12.310894 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 11

Steps executed: 217 Episode length: 110 Return: 110.0
INFO:tensorflow:Average training steps per second: 189.25
I0902 00:13:17.791344 140286289131520 replay_runner.py:36] Average training steps per second: 189.25
I0902 00:13:17.943597 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 108.50
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 191.39
I0902 00:13:23.362435 140286289131520 replay_runner.py:36] Average training steps per second: 191.39
I0902 00:13:23.529895 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 13

Steps executed: 259 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 187.51
I0902 00:13:29.056507 140286289131520 replay_runner.py:36] Average training steps per second: 187.51
I0902 00:13:29.233190 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.42
I0902 00:13:34.601078 140286289131520 replay_runner.py:36] Average training steps per second: 193.42
I0902 00:13:34.734862 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0902 00:13:34.927127 140286289131520 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 195.17
I0902 00:13:40.051440 140286289131520 replay_runner.py:36] Average training steps per second: 195.17
I0902 00:13:40.180285 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 00:13:40.367131 140286289131520 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 190.66
I0902 00:13:45.612581 140286289131520 replay_runner.py:36] Average training steps per second: 190.66
I0902 00:13:45.750033 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 00:13:45.944234 140286289131520 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 190.24
I0902 00:13:51.201248 140286289131520 replay_runner.py:36] Average training steps per second: 190.24
I0902 00:13:51.336625 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 00:13:51.527442 140286289131520 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 187.64
I0902 00:13:56.857023 140286289131520 replay_runner.py:36] Average training steps per second: 187.64
I0902 00:13:56.998966 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 00:13:57.193407 140286289131520 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 194.13
I0902 00:14:02.345079 140286289131520 replay_runner.py:36] Average training steps per second: 194.13
I0902 00:14:02.485180 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 00:14:02.672132 140286289131520 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 190.13
I0902 00:14:07.932070 140286289131520 replay_runner.py:36] Average training steps per second: 190.13
I0902 00:14:08.065133 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:14:08.253479 140286289131520 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 189.89
I0902 00:14:13.520362 140286289131520 replay_runner.py:36] Average training steps per second: 189.89
I0902 00:14:13.658618 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:14:13.857335 140286289131520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 189.87
I0902 00:14:19.124565 140286289131520 replay_runner.py:36] Average training steps per second: 189.87
I0902 00:14:19.263464 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:14:19.460132 140286289131520 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 188.09
I0902 00:14:24.777118 140286289131520 replay_runner.py:36] Average training steps per second: 188.09
I0902 00:14:24.916213 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 00:14:25.113197 140286289131520 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 191.23
I0902 00:14:30.342916 140286289131520 replay_runner.py:36] Average training steps per second: 191.23
I0902 00:14:30.481917 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 00:14:30.670886 140286289131520 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 190.32
I0902 00:14:35.925712 140286289131520 replay_runner.py:36] Average training steps per second: 190.32
I0902 00:14:36.063298 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:14:36.251355 140286289131520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.58
I0902 00:14:41.391057 140286289131520 replay_runner.py:36] Average training steps per second: 194.58
I0902 00:14:41.525274 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:14:41.715408 140286289131520 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.58
I0902 00:14:46.963005 140286289131520 replay_runner.py:36] Average training steps per second: 190.58
I0902 00:14:47.097133 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.42
I0902 00:14:52.381030 140286289131520 replay_runner.py:36] Average training steps per second: 196.42
I0902 00:14:52.633260 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.56
I0902 00:14:57.777215 140286289131520 replay_runner.py:36] Average training steps per second: 201.56
I0902 00:14:57.889832 140286289131520 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00