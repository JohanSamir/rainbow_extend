Loaded trained dqn in mountaincar
Training fixed agent 4, please be patient, may be a while...
Steps executed: 232 Episode length: 119 Return: -119.0
I0910 11:20:49.645693 140389048559616 run_experiment.py:549] Creating TrainRunner ...
I0910 11:20:49.654055 140389048559616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:20:49.654228 140389048559616 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:20:49.654329 140389048559616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:20:49.654426 140389048559616 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:20:49.654507 140389048559616 dqn_agent.py:275] 	 update_period: 4
I0910 11:20:49.654596 140389048559616 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:20:49.654680 140389048559616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:20:49.654803 140389048559616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:20:49.654923 140389048559616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:20:49.655020 140389048559616 dqn_agent.py:280] 	 optimizer: adam
I0910 11:20:49.655160 140389048559616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:20:49.655256 140389048559616 dqn_agent.py:283] 	 seed: 1631272849654012
I0910 11:20:49.658012 140389048559616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:20:49.658167 140389048559616 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:20:49.658266 140389048559616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:20:49.658365 140389048559616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:20:49.658458 140389048559616 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:20:49.658586 140389048559616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:20:49.658684 140389048559616 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:20:49.658827 140389048559616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:20:49.658941 140389048559616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:20:49.790970 140389048559616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:20:49.818902 140389048559616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:20:49.819128 140389048559616 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:20:49.819272 140389048559616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:20:49.819388 140389048559616 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:20:49.819487 140389048559616 dqn_agent.py:275] 	 update_period: 4
I0910 11:20:49.819589 140389048559616 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:20:49.819687 140389048559616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:20:49.819791 140389048559616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:20:49.819895 140389048559616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:20:49.819998 140389048559616 dqn_agent.py:280] 	 optimizer: adam
I0910 11:20:49.820099 140389048559616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:20:49.820203 140389048559616 dqn_agent.py:283] 	 seed: 1631272849818848
I0910 11:20:49.822685 140389048559616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:20:49.822844 140389048559616 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:20:49.822956 140389048559616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:20:49.823067 140389048559616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:20:49.823178 140389048559616 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:20:49.823282 140389048559616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:20:49.823386 140389048559616 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:20:49.823485 140389048559616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:20:49.823617 140389048559616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:20:49.857854 140389048559616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:20:49.878155 140389048559616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:20:49.878407 140389048559616 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 426120.49
I0910 11:20:49.880973 140389048559616 replay_runner.py:39] Average training steps per second: 426120.49
I0910 11:20:51.100862 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 1
I0910 11:20:51.143743 140389048559616 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 791975.83
I0910 11:20:51.145253 140389048559616 replay_runner.py:39] Average training steps per second: 791975.83
I0910 11:20:51.243831 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.00
INFO:tensorflow:Starting iteration 2
I0910 11:20:51.310597 140389048559616 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 342839.95
I0910 11:20:51.313912 140389048559616 replay_runner.py:39] Average training steps per second: 342839.95
I0910 11:20:51.391909 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 3
I0910 11:20:51.432758 140389048559616 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 814902.66

Steps executed: 227 Episode length: 113 Return: -113.0
I0910 11:20:51.580612 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.00
INFO:tensorflow:Starting iteration 4
I0910 11:20:51.619193 140389048559616 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 834687.36
I0910 11:20:51.620610 140389048559616 replay_runner.py:39] Average training steps per second: 834687.36
I0910 11:20:51.708384 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 5
I0910 11:20:51.749218 140389048559616 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 819520.13
I0910 11:20:51.750660 140389048559616 replay_runner.py:39] Average training steps per second: 819520.13
I0910 11:20:51.812970 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 6
I0910 11:20:51.871063 140389048559616 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 337977.76
I0910 11:20:51.874610 140389048559616 replay_runner.py:39] Average training steps per second: 337977.76
I0910 11:20:51.998854 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 7
I0910 11:20:52.040235 140389048559616 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 812692.11
I0910 11:20:52.041728 140389048559616 replay_runner.py:39] Average training steps per second: 812692.11
I0910 11:20:52.142080 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 8
I0910 11:20:52.282759 140389048559616 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 801663.61
I0910 11:20:52.284269 140389048559616 replay_runner.py:39] Average training steps per second: 801663.61
I0910 11:20:52.422897 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 9
I0910 11:20:52.505480 140389048559616 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 819840.50
I0910 11:20:52.506937 140389048559616 replay_runner.py:39] Average training steps per second: 819840.50
I0910 11:20:52.573632 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 10
I0910 11:20:52.618103 140389048559616 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 340640.30
I0910 11:20:52.621418 140389048559616 replay_runner.py:39] Average training steps per second: 340640.30
I0910 11:20:52.757243 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 11
I0910 11:20:52.798701 140389048559616 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 842568.10
I0910 11:20:52.800147 140389048559616 replay_runner.py:39] Average training steps per second: 842568.10
I0910 11:20:52.888109 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.50
INFO:tensorflow:Starting iteration 12
I0910 11:20:52.930685 140389048559616 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 793924.66
I0910 11:20:52.932198 140389048559616 replay_runner.py:39] Average training steps per second: 793924.66
I0910 11:20:53.011125 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 13
I0910 11:20:53.053412 140389048559616 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 799371.83
I0910 11:20:53.054947 140389048559616 replay_runner.py:39] Average training steps per second: 799371.83
I0910 11:20:53.163850 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 14
I0910 11:20:53.303906 140389048559616 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 372429.76
I0910 11:20:53.307396 140389048559616 replay_runner.py:39] Average training steps per second: 372429.76
I0910 11:20:53.400456 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 15
I0910 11:20:53.441102 140389048559616 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 819520.13

Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:20:53.681214 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.50
INFO:tensorflow:Starting iteration 16
I0910 11:20:53.722397 140389048559616 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 804122.70
I0910 11:20:53.723885 140389048559616 replay_runner.py:39] Average training steps per second: 804122.70
I0910 11:20:53.783103 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.00
INFO:tensorflow:Starting iteration 17
I0910 11:20:53.825150 140389048559616 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 795279.48
I0910 11:20:53.826677 140389048559616 replay_runner.py:39] Average training steps per second: 795279.48
I0910 11:20:53.891644 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 18
I0910 11:20:53.932296 140389048559616 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 799676.64
I0910 11:20:53.933819 140389048559616 replay_runner.py:39] Average training steps per second: 799676.64
I0910 11:20:54.003790 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 19
I0910 11:20:54.051558 140389048559616 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 815853.72
I0910 11:20:54.053005 140389048559616 replay_runner.py:39] Average training steps per second: 815853.72
I0910 11:20:54.159877 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.00
INFO:tensorflow:Starting iteration 20
I0910 11:20:54.231097 140389048559616 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 341861.93
I0910 11:20:54.234392 140389048559616 replay_runner.py:39] Average training steps per second: 341861.93
I0910 11:20:54.315570 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 21
I0910 11:20:54.357409 140389048559616 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 811434.32
I0910 11:20:54.358859 140389048559616 replay_runner.py:39] Average training steps per second: 811434.32
I0910 11:20:54.535301 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:20:54.578430 140389048559616 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 817603.12
I0910 11:20:54.579962 140389048559616 replay_runner.py:39] Average training steps per second: 817603.12
I0910 11:20:54.805261 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:20:54.846747 140389048559616 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 822251.32
I0910 11:20:54.848220 140389048559616 replay_runner.py:39] Average training steps per second: 822251.32
I0910 11:20:54.918462 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 24
I0910 11:20:54.961458 140389048559616 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 667351.47
I0910 11:20:54.963228 140389048559616 replay_runner.py:39] Average training steps per second: 667351.47
I0910 11:20:55.143845 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:20:55.255435 140389048559616 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 341333.33
I0910 11:20:55.258747 140389048559616 replay_runner.py:39] Average training steps per second: 341333.33
I0910 11:20:55.370943 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 26
I0910 11:20:55.431533 140389048559616 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 795581.18
I0910 11:20:55.433036 140389048559616 replay_runner.py:39] Average training steps per second: 795581.18

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 27
I0910 11:20:55.553976 140389048559616 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 799829.14
I0910 11:20:55.555451 140389048559616 replay_runner.py:39] Average training steps per second: 799829.14
I0910 11:20:55.665822 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 28
I0910 11:20:55.765887 140389048559616 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 308087.56
I0910 11:20:55.769524 140389048559616 replay_runner.py:39] Average training steps per second: 308087.56
I0910 11:20:55.855474 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 29
I0910 11:20:55.902146 140389048559616 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 796638.94
I0910 11:20:55.903633 140389048559616 replay_runner.py:39] Average training steps per second: 796638.94
I0910 11:20:56.152513 140389048559616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00