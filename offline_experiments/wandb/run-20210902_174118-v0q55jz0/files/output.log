I0902 17:41:25.675728 140284730537984 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 17:41:25.676380 140284730537984 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 17:41:25.856796 140284730537984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:25.857940 140284730537984 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:25.858024 140284730537984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:25.858088 140284730537984 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:25.858152 140284730537984 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:25.858207 140284730537984 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:25.858286 140284730537984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:25.858351 140284730537984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:25.858471 140284730537984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:25.858572 140284730537984 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:25.858659 140284730537984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:25.858743 140284730537984 dqn_agent.py:283] 	 seed: 1630604485856709
I0902 17:41:25.860377 140284730537984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:25.860491 140284730537984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:25.860579 140284730537984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:25.860709 140284730537984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:25.860764 140284730537984 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:25.860832 140284730537984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:25.860930 140284730537984 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:25.861006 140284730537984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:25.861081 140284730537984 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 17:41:27.334489 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.068719 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.077728 140284730537984 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:41:28.082517 140284730537984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:28.082696 140284730537984 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:28.082781 140284730537984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:28.082844 140284730537984 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:28.082939 140284730537984 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:28.083016 140284730537984 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:28.083157 140284730537984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:28.083236 140284730537984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:28.083295 140284730537984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:28.083397 140284730537984 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:28.083472 140284730537984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:28.083527 140284730537984 dqn_agent.py:283] 	 seed: 1630604488082476
I0902 17:41:28.085079 140284730537984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:28.085196 140284730537984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:28.085268 140284730537984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:28.085330 140284730537984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:28.085386 140284730537984 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:28.085443 140284730537984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:28.085512 140284730537984 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:28.085581 140284730537984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:28.085673 140284730537984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:28.104879 140284730537984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.119012 140284730537984 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:41:28.119230 140284730537984 replay_runner.py:41] Starting iteration 0
Steps executed: 239 Episode length: 149 Return: -974.4828320701007
INFO:tensorflow:Average training steps per second: 176.97
I0902 17:41:33.771350 140284730537984 replay_runner.py:36] Average training steps per second: 176.97
I0902 17:41:34.981613 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -825.36
INFO:tensorflow:Starting iteration 1

Steps executed: 233 Episode length: 74 Return: -504.46540517301977
INFO:tensorflow:Average training steps per second: 214.06
I0902 17:41:43.796647 140284730537984 replay_runner.py:36] Average training steps per second: 214.06
I0902 17:41:44.025595 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -549.53
INFO:tensorflow:Starting iteration 2

Steps executed: 282 Episode length: 113 Return: -614.7778724017813
INFO:tensorflow:Average training steps per second: 211.62
I0902 17:41:52.899212 140284730537984 replay_runner.py:36] Average training steps per second: 211.62
I0902 17:41:53.169716 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -662.15
INFO:tensorflow:Starting iteration 3

Steps executed: 285 Episode length: 221 Return: -1394.4947770041676
INFO:tensorflow:Average training steps per second: 214.56
I0902 17:42:02.143276 140284730537984 replay_runner.py:36] Average training steps per second: 214.56
I0902 17:42:02.479806 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -1009.75
INFO:tensorflow:Starting iteration 4
I0902 17:42:06.678523 140284730537984 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 215.89

Steps executed: 326 Episode length: 132 Return: -771.27909810222576
I0902 17:42:11.664647 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -961.27
INFO:tensorflow:Starting iteration 5

Steps executed: 310 Episode length: 229 Return: -1330.7340377071116
INFO:tensorflow:Average training steps per second: 213.96
I0902 17:42:20.607674 140284730537984 replay_runner.py:36] Average training steps per second: 213.96
I0902 17:42:20.953335 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -911.92
INFO:tensorflow:Starting iteration 6

Steps executed: 222 Episode length: 78 Return: -502.406677102227916
INFO:tensorflow:Average training steps per second: 214.56
I0902 17:42:29.875206 140284730537984 replay_runner.py:36] Average training steps per second: 214.56
I0902 17:42:30.077036 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -569.11
INFO:tensorflow:Starting iteration 7

Steps executed: 215 Episode length: 73 Return: -497.621214227355676
INFO:tensorflow:Average training steps per second: 216.40
I0902 17:42:38.861019 140284730537984 replay_runner.py:36] Average training steps per second: 216.40
I0902 17:42:39.057417 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -528.02
INFO:tensorflow:Starting iteration 8

Steps executed: 272 Episode length: 160 Return: -856.99689100469356
INFO:tensorflow:Average training steps per second: 218.43
I0902 17:42:47.830030 140284730537984 replay_runner.py:36] Average training steps per second: 218.43
I0902 17:42:48.091126 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -832.10
INFO:tensorflow:Starting iteration 9

Steps executed: 354 Episode length: 179 Return: -713.07058459464756
INFO:tensorflow:Average training steps per second: 219.44
I0902 17:42:56.851431 140284730537984 replay_runner.py:36] Average training steps per second: 219.44
I0902 17:42:57.200751 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -656.37
INFO:tensorflow:Starting iteration 10

Steps executed: 246 Episode length: 105 Return: -320.60738855299087
INFO:tensorflow:Average training steps per second: 216.61
I0902 17:43:06.040669 140284730537984 replay_runner.py:36] Average training steps per second: 216.61
I0902 17:43:06.253790 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -586.40
INFO:tensorflow:Starting iteration 11

Steps executed: 348 Episode length: 150 Return: -882.64845705884277
INFO:tensorflow:Average training steps per second: 218.76
I0902 17:43:15.106931 140284730537984 replay_runner.py:36] Average training steps per second: 218.76
I0902 17:43:15.433346 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.73
INFO:tensorflow:Starting iteration 12

Steps executed: 263 Episode length: 78 Return: -366.209998399777427
INFO:tensorflow:Average training steps per second: 220.81
I0902 17:43:24.208561 140284730537984 replay_runner.py:36] Average training steps per second: 220.81
I0902 17:43:24.443776 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.80
INFO:tensorflow:Starting iteration 13

Steps executed: 266 Episode length: 266 Return: -983.68278197022157
INFO:tensorflow:Average training steps per second: 220.12
I0902 17:43:33.260239 140284730537984 replay_runner.py:36] Average training steps per second: 220.12
I0902 17:43:33.595183 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -983.68
INFO:tensorflow:Starting iteration 14

Steps executed: 206 Episode length: 206 Return: -1027.0054373547646
INFO:tensorflow:Average training steps per second: 213.83
I0902 17:43:42.513954 140284730537984 replay_runner.py:36] Average training steps per second: 213.83
I0902 17:43:42.742836 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -1027.01
INFO:tensorflow:Starting iteration 15

Steps executed: 187 Episode length: 92 Return: -316.970603189034846
INFO:tensorflow:Average training steps per second: 215.58

Steps executed: 420 Episode length: 233 Return: -476.48531998996836
I0902 17:43:52.048590 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.46
INFO:tensorflow:Starting iteration 16

Steps executed: 215 Episode length: 123 Return: -89.609794794231496
INFO:tensorflow:Average training steps per second: 219.98
I0902 17:44:00.815929 140284730537984 replay_runner.py:36] Average training steps per second: 219.98
I0902 17:44:00.997599 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.68
INFO:tensorflow:Starting iteration 17
I0902 17:44:05.273581 140284730537984 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 215.84

Steps executed: 245 Episode length: 245 Return: -285.37585331625026
I0902 17:44:10.158672 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.38
INFO:tensorflow:Starting iteration 18

Steps executed: 295 Episode length: 147 Return: -457.87587336893256
INFO:tensorflow:Average training steps per second: 234.20
I0902 17:44:18.358985 140284730537984 replay_runner.py:36] Average training steps per second: 234.20
I0902 17:44:18.546831 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.90
INFO:tensorflow:Starting iteration 19
I0902 17:44:22.273637 140284730537984 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 270.65

Steps executed: 271 Episode length: 84 Return: -578.719191682664986
I0902 17:44:26.213764 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.96
INFO:tensorflow:Starting iteration 20

Steps executed: 336 Episode length: 245 Return: -339.13689221402256
INFO:tensorflow:Average training steps per second: 240.28
I0902 17:44:34.440590 140284730537984 replay_runner.py:36] Average training steps per second: 240.28
I0902 17:44:34.751886 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.74
INFO:tensorflow:Starting iteration 21

Steps executed: 300 Episode length: 225 Return: -718.70054933966426
INFO:tensorflow:Average training steps per second: 222.65
I0902 17:44:43.547315 140284730537984 replay_runner.py:36] Average training steps per second: 222.65
I0902 17:44:43.857562 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -593.75
INFO:tensorflow:Starting iteration 22

Steps executed: 342 Episode length: 157 Return: -681.50795191869383
INFO:tensorflow:Average training steps per second: 216.12
I0902 17:44:52.779408 140284730537984 replay_runner.py:36] Average training steps per second: 216.12
I0902 17:44:53.071726 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.99
INFO:tensorflow:Starting iteration 23

Steps executed: 189 Episode length: 189 Return: -285.43077851371293
INFO:tensorflow:Average training steps per second: 219.96
I0902 17:45:01.927775 140284730537984 replay_runner.py:36] Average training steps per second: 219.96

Steps executed: 332 Episode length: 143 Return: -31.934948592203014
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 129 Return: -129.20080268643676
INFO:tensorflow:Average training steps per second: 220.92
I0902 17:45:11.039426 140284730537984 replay_runner.py:36] Average training steps per second: 220.92
I0902 17:45:11.222298 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.05
INFO:tensorflow:Starting iteration 25

Steps executed: 276 Episode length: 182 Return: -1014.4844150381514
INFO:tensorflow:Average training steps per second: 219.64
I0902 17:45:20.063932 140284730537984 replay_runner.py:36] Average training steps per second: 219.64
I0902 17:45:20.320180 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -647.77
INFO:tensorflow:Starting iteration 26

Steps executed: 330 Episode length: 179 Return: -136.30902236127064
INFO:tensorflow:Average training steps per second: 224.17
I0902 17:45:29.082354 140284730537984 replay_runner.py:36] Average training steps per second: 224.17
I0902 17:45:29.375520 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.18
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 202 Return: -160.27681021223302
INFO:tensorflow:Average training steps per second: 217.96
I0902 17:45:38.241369 140284730537984 replay_runner.py:36] Average training steps per second: 217.96
I0902 17:45:38.436800 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.28
INFO:tensorflow:Starting iteration 28

Steps executed: 311 Episode length: 227 Return: -257.19929756481782
INFO:tensorflow:Average training steps per second: 221.55
I0902 17:45:47.263271 140284730537984 replay_runner.py:36] Average training steps per second: 221.55
I0902 17:45:47.568170 140284730537984 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.43
INFO:tensorflow:Starting iteration 29

Steps executed: 272 Episode length: 103 Return: -290.06076794666732
INFO:tensorflow:Average training steps per second: 219.07
I0902 17:45:56.473974 140284730537984 replay_runner.py:36] Average training steps per second: 219.07

Done fixed training!Episode length: 103 Return: -290.06076794666732