I0905 16:33:01.581375 139967707396096 run_experiment.py:549] Creating TrainRunner ...
I0905 16:33:01.599216 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:33:01.599774 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:33:01.600046 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:33:01.600662 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:33:01.601259 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:33:01.601463 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:33:01.601606 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:33:01.602131 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:33:01.602620 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:33:01.602789 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:33:01.603551 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:33:01.604157 139967707396096 dqn_agent.py:283] 	 seed: 1630859581599137
I0905 16:33:01.610489 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:33:01.610740 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:33:01.612067 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:33:01.612335 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:33:01.612847 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:33:01.613252 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:33:01.613529 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:33:01.614561 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:33:01.614739 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:33:05.214936 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0905 16:33:06.009239 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:33:06.041697 139967707396096 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:33:06.084090 139967707396096 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:33:06.084481 139967707396096 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:33:06.084803 139967707396096 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:33:06.085734 139967707396096 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:33:06.086060 139967707396096 dqn_agent.py:275] 	 update_period: 4
I0905 16:33:06.086285 139967707396096 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:33:06.086919 139967707396096 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:33:06.087760 139967707396096 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:33:06.088357 139967707396096 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:33:06.088561 139967707396096 dqn_agent.py:280] 	 optimizer: adam
I0905 16:33:06.088750 139967707396096 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:33:06.088878 139967707396096 dqn_agent.py:283] 	 seed: 1630859586084003
I0905 16:33:06.094151 139967707396096 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:33:06.094608 139967707396096 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:33:06.094909 139967707396096 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:33:06.095197 139967707396096 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:33:06.095613 139967707396096 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:33:06.095915 139967707396096 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:33:06.096276 139967707396096 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:33:06.097380 139967707396096 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:33:06.098022 139967707396096 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:33:06.176188 139967707396096 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:33:06.232635 139967707396096 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:33:06.233257 139967707396096 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 101.48
I0905 16:33:16.089155 139967707396096 replay_runner.py:36] Average training steps per second: 101.48
Steps executed: 245 Episode length: 146 Return: -474.5583001451561
I0905 16:33:17.922226 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.00
INFO:tensorflow:Starting iteration 1
I0905 16:33:22.806067 139967707396096 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 154.20

Steps executed: 233 Episode length: 146 Return: -331.1519764288092
I0905 16:33:29.591925 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.48
INFO:tensorflow:Starting iteration 2

Steps executed: 314 Episode length: 136 Return: -230.49429752282737
INFO:tensorflow:Average training steps per second: 163.03
I0905 16:33:40.592641 139967707396096 replay_runner.py:36] Average training steps per second: 163.03
I0905 16:33:40.999065 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.31
INFO:tensorflow:Starting iteration 3

Steps executed: 142 Episode length: 142 Return: -242.56990397187352
INFO:tensorflow:Average training steps per second: 155.32
I0905 16:33:52.400239 139967707396096 replay_runner.py:36] Average training steps per second: 155.32

Steps executed: 510 Episode length: 368 Return: -326.92352718472443
INFO:tensorflow:Starting iteration 4

Steps executed: 412 Episode length: 282 Return: -253.68425380058532
INFO:tensorflow:Average training steps per second: 165.76
I0905 16:34:04.729669 139967707396096 replay_runner.py:36] Average training steps per second: 165.76
I0905 16:34:05.345086 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.75
INFO:tensorflow:Starting iteration 5
I0905 16:34:10.707464 139967707396096 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 158.09

Steps executed: 1000 Episode length: 1000 Return: -176.9682801489437
I0905 16:34:20.082612 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.97
INFO:tensorflow:Starting iteration 6
I0905 16:34:25.119047 139967707396096 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 162.92

Steps executed: 321 Episode length: 321 Return: -410.033820427028337
I0905 16:34:31.793102 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.03
INFO:tensorflow:Starting iteration 7

Steps executed: 361 Episode length: 361 Return: -433.940917925258537
INFO:tensorflow:Average training steps per second: 150.62
I0905 16:34:43.658357 139967707396096 replay_runner.py:36] Average training steps per second: 150.62
I0905 16:34:44.398011 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -433.94
INFO:tensorflow:Starting iteration 8

Steps executed: 386 Episode length: 386 Return: -623.949372419219737
INFO:tensorflow:Average training steps per second: 157.34
I0905 16:34:55.744982 139967707396096 replay_runner.py:36] Average training steps per second: 157.34
I0905 16:34:56.819528 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -623.95
INFO:tensorflow:Starting iteration 9

Steps executed: 394 Episode length: 394 Return: -751.911288785368637
INFO:tensorflow:Average training steps per second: 153.10
I0905 16:35:08.523812 139967707396096 replay_runner.py:36] Average training steps per second: 153.10
I0905 16:35:09.495719 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -751.91
INFO:tensorflow:Starting iteration 10
I0905 16:35:14.798295 139967707396096 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 153.51

Steps executed: 266 Episode length: 266 Return: -537.737711004729637
I0905 16:35:21.812502 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.74
INFO:tensorflow:Starting iteration 11

Steps executed: 149 Episode length: 149 Return: -150.611159811158477
INFO:tensorflow:Average training steps per second: 172.28

Steps executed: 678 Episode length: 529 Return: -274.458639998326877
I0905 16:35:34.324700 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.53
INFO:tensorflow:Starting iteration 12

Steps executed: 171 Episode length: 83 Return: -39.03619792299305477
INFO:tensorflow:Average training steps per second: 190.09

Steps executed: 1171 Episode length: 1000 Return: -114.93397485364595
I0905 16:35:48.018621 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.49
INFO:tensorflow:Starting iteration 13

Steps executed: 85 Episode length: 85 Return: -55.3692052877822364595
INFO:tensorflow:Average training steps per second: 177.60

Steps executed: 1085 Episode length: 1000 Return: 21.1116684899371565
I0905 16:36:02.025410 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -17.13
INFO:tensorflow:Starting iteration 14
I0905 16:36:06.830791 139967707396096 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 179.69

Steps executed: 1000 Episode length: 1000 Return: -115.91017534531062
I0905 16:36:16.117538 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.91
INFO:tensorflow:Starting iteration 15
I0905 16:36:20.585042 139967707396096 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 216.23

Steps executed: 1000 Episode length: 1000 Return: -90.515254398959072
I0905 16:36:28.973774 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.52
INFO:tensorflow:Starting iteration 16
I0905 16:36:32.782128 139967707396096 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 308.39

Steps executed: 1000 Episode length: 1000 Return: -122.93977819522729
I0905 16:36:38.254571 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.94
INFO:tensorflow:Starting iteration 17
I0905 16:36:41.450575 139967707396096 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 415.33

Steps executed: 1000 Episode length: 1000 Return: -126.09594298582412
I0905 16:36:45.219071 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.10
INFO:tensorflow:Starting iteration 18
I0905 16:36:48.397679 139967707396096 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 404.86

Steps executed: 1000 Episode length: 1000 Return: -70.294881856044172
I0905 16:36:53.075859 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.29
INFO:tensorflow:Starting iteration 19
I0905 16:36:56.163584 139967707396096 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 380.81

Steps executed: 1000 Episode length: 1000 Return: -144.99243308409416
I0905 16:37:01.218722 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.99
INFO:tensorflow:Starting iteration 20
I0905 16:37:04.271383 139967707396096 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 401.99

Steps executed: 1000 Episode length: 1000 Return: -100.25266630089381
I0905 16:37:08.920930 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.25
INFO:tensorflow:Starting iteration 21

Steps executed: 631 Episode length: 631 Return: -111.7266702303175481
INFO:tensorflow:Average training steps per second: 405.33
I0905 16:37:14.577602 139967707396096 replay_runner.py:36] Average training steps per second: 405.33
I0905 16:37:15.370589 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.73
INFO:tensorflow:Starting iteration 22
I0905 16:37:18.563497 139967707396096 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 392.27

Steps executed: 1000 Episode length: 1000 Return: 46.8007398297713451
I0905 16:37:23.509680 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: 46.80
INFO:tensorflow:Starting iteration 23
I0905 16:37:26.593628 139967707396096 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 395.21

Steps executed: 1000 Episode length: 1000 Return: -17.343537326305896
I0905 16:37:30.705967 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -17.34
INFO:tensorflow:Starting iteration 24
I0905 16:37:33.813441 139967707396096 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 398.08
I0905 16:37:36.325751 139967707396096 replay_runner.py:36] Average training steps per second: 398.08

Steps executed: 1000 Episode length: 1000 Return: -54.518246055432755
INFO:tensorflow:Starting iteration 25

Steps executed: 327 Episode length: 327 Return: -136.3023605026225255
INFO:tensorflow:Average training steps per second: 399.97
I0905 16:37:43.412955 139967707396096 replay_runner.py:36] Average training steps per second: 399.97
I0905 16:37:43.654446 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.30
INFO:tensorflow:Starting iteration 26

Steps executed: 379 Episode length: 379 Return: -46.47537088527119255
INFO:tensorflow:Average training steps per second: 399.90
I0905 16:37:49.213019 139967707396096 replay_runner.py:36] Average training steps per second: 399.90
I0905 16:37:49.620819 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.48
INFO:tensorflow:Starting iteration 27
I0905 16:37:52.675621 139967707396096 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 397.88

Steps executed: 1000 Episode length: 1000 Return: -18.047832079863802
I0905 16:37:56.919889 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.05
INFO:tensorflow:Starting iteration 28
I0905 16:38:00.028917 139967707396096 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 408.50

Steps executed: 1000 Episode length: 1000 Return: 1.68163472063274472
I0905 16:38:04.023502 139967707396096 run_experiment.py:428] Average undiscounted return per evaluation episode: 1.68
INFO:tensorflow:Starting iteration 29
I0905 16:38:07.072547 139967707396096 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 376.27

Steps executed: 937 Episode length: 937 Return: 116.40938459665148472

Done fixed training!Episode length: 937 Return: 116.40938459665148472