I0905 16:24:50.272710 140334269278208 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:50.279554 140334269278208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:50.279683 140334269278208 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:50.279762 140334269278208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:50.279863 140334269278208 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:50.279936 140334269278208 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:50.280030 140334269278208 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:50.280127 140334269278208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:50.280218 140334269278208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:50.280389 140334269278208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:50.280519 140334269278208 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:50.280650 140334269278208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:50.280766 140334269278208 dqn_agent.py:283] 	 seed: 1630859090279521
I0905 16:24:50.282461 140334269278208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:50.282572 140334269278208 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:50.282652 140334269278208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:50.282713 140334269278208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:50.282767 140334269278208 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:50.282819 140334269278208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:50.282895 140334269278208 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:50.282953 140334269278208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:50.283010 140334269278208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:51.410937 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:51.724751 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:51.732568 140334269278208 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:51.737663 140334269278208 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:51.737788 140334269278208 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:51.737883 140334269278208 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:51.737945 140334269278208 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:51.738000 140334269278208 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:51.738071 140334269278208 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:51.738130 140334269278208 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:51.738220 140334269278208 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:51.738300 140334269278208 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:51.738367 140334269278208 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:51.738421 140334269278208 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:51.738494 140334269278208 dqn_agent.py:283] 	 seed: 1630859091737636
I0905 16:24:51.739856 140334269278208 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:51.739964 140334269278208 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:51.740041 140334269278208 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:51.740102 140334269278208 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:51.740159 140334269278208 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:51.740242 140334269278208 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:51.740326 140334269278208 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:51.740418 140334269278208 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:51.740497 140334269278208 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:51.758095 140334269278208 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:51.769612 140334269278208 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:51.769772 140334269278208 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 285.41
I0905 16:24:55.273675 140334269278208 replay_runner.py:36] Average training steps per second: 285.41
I0905 16:24:55.876975 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.06
Steps executed: 212 Episode length: 81 Return: -345.494402621815773
INFO:tensorflow:Starting iteration 1

Steps executed: 232 Episode length: 94 Return: -398.152931830031343
INFO:tensorflow:Average training steps per second: 336.46
I0905 16:25:02.137300 140334269278208 replay_runner.py:36] Average training steps per second: 336.46
I0905 16:25:02.291614 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.77
INFO:tensorflow:Starting iteration 2
I0905 16:25:05.857381 140334269278208 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 374.89
I0905 16:25:08.525146 140334269278208 replay_runner.py:36] Average training steps per second: 374.89

Steps executed: 266 Episode length: 156 Return: -467.99794261272154
INFO:tensorflow:Starting iteration 3
I0905 16:25:11.745539 140334269278208 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 401.32
I0905 16:25:14.237569 140334269278208 replay_runner.py:36] Average training steps per second: 401.32

Steps executed: 211 Episode length: 93 Return: -374.328826845037294
INFO:tensorflow:Starting iteration 4

Steps executed: 236 Episode length: 108 Return: -333.03676102176365
INFO:tensorflow:Average training steps per second: 388.28
I0905 16:25:20.068367 140334269278208 replay_runner.py:36] Average training steps per second: 388.28
I0905 16:25:20.172416 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.65
INFO:tensorflow:Starting iteration 5
I0905 16:25:23.340215 140334269278208 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 395.60
I0905 16:25:25.868337 140334269278208 replay_runner.py:36] Average training steps per second: 395.60

Steps executed: 288 Episode length: 288 Return: -14.433836321218337
INFO:tensorflow:Starting iteration 6

Steps executed: 368 Episode length: 368 Return: -238.89638233938143
INFO:tensorflow:Average training steps per second: 388.78
I0905 16:25:31.796830 140334269278208 replay_runner.py:36] Average training steps per second: 388.78
I0905 16:25:32.033621 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.90
INFO:tensorflow:Starting iteration 7
I0905 16:25:35.198995 140334269278208 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 396.85

Steps executed: 1000 Episode length: 1000 Return: -34.995353138562436
I0905 16:25:39.064569 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -35.00
INFO:tensorflow:Starting iteration 8

Steps executed: 287 Episode length: 162 Return: -94.70702434428235536
INFO:tensorflow:Average training steps per second: 395.52
I0905 16:25:44.737082 140334269278208 replay_runner.py:36] Average training steps per second: 395.52
I0905 16:25:44.847174 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -179.54
INFO:tensorflow:Starting iteration 9

Steps executed: 332 Episode length: 332 Return: -364.1829198072216536
INFO:tensorflow:Average training steps per second: 391.23
I0905 16:25:50.529000 140334269278208 replay_runner.py:36] Average training steps per second: 391.23
I0905 16:25:50.757592 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.18
INFO:tensorflow:Starting iteration 10

Steps executed: 347 Episode length: 347 Return: -139.0412731970169836
INFO:tensorflow:Average training steps per second: 385.76
I0905 16:25:56.599260 140334269278208 replay_runner.py:36] Average training steps per second: 385.76
I0905 16:25:56.844173 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.04
INFO:tensorflow:Starting iteration 11

Steps executed: 266 Episode length: 96 Return: -91.771716813829138836
INFO:tensorflow:Average training steps per second: 375.59
I0905 16:26:02.724361 140334269278208 replay_runner.py:36] Average training steps per second: 375.59
I0905 16:26:02.851104 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.36
INFO:tensorflow:Starting iteration 12

Steps executed: 572 Episode length: 381 Return: -324.7395366566079436
INFO:tensorflow:Average training steps per second: 389.43
I0905 16:26:08.568697 140334269278208 replay_runner.py:36] Average training steps per second: 389.43
I0905 16:26:09.014178 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.21
INFO:tensorflow:Starting iteration 13

Steps executed: 265 Episode length: 155 Return: -298.1361174232667436
INFO:tensorflow:Average training steps per second: 397.51
I0905 16:26:14.647172 140334269278208 replay_runner.py:36] Average training steps per second: 397.51
I0905 16:26:14.756991 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.22
INFO:tensorflow:Starting iteration 14

Steps executed: 621 Episode length: 621 Return: -100.7924612840614436
INFO:tensorflow:Average training steps per second: 395.28
I0905 16:26:20.439089 140334269278208 replay_runner.py:36] Average training steps per second: 395.28
I0905 16:26:21.076013 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.79
INFO:tensorflow:Starting iteration 15

Steps executed: 414 Episode length: 414 Return: -81.04018770831539436
INFO:tensorflow:Average training steps per second: 405.83
I0905 16:26:26.746852 140334269278208 replay_runner.py:36] Average training steps per second: 405.83
I0905 16:26:27.142549 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.04
INFO:tensorflow:Starting iteration 16

Steps executed: 504 Episode length: 504 Return: -41.46505335131458436
INFO:tensorflow:Average training steps per second: 399.90
I0905 16:26:32.872184 140334269278208 replay_runner.py:36] Average training steps per second: 399.90
I0905 16:26:33.449171 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.47
INFO:tensorflow:Starting iteration 17

Steps executed: 489 Episode length: 489 Return: -209.4499924254628236
INFO:tensorflow:Average training steps per second: 394.42
I0905 16:26:39.118453 140334269278208 replay_runner.py:36] Average training steps per second: 394.42
I0905 16:26:39.534080 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.45
INFO:tensorflow:Starting iteration 18

Steps executed: 208 Episode length: 208 Return: -734.2736105140548236
INFO:tensorflow:Average training steps per second: 376.99
I0905 16:26:45.370748 140334269278208 replay_runner.py:36] Average training steps per second: 376.99
I0905 16:26:45.471136 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -734.27
INFO:tensorflow:Starting iteration 19

Steps executed: 593 Episode length: 402 Return: -618.9089631247342236
INFO:tensorflow:Average training steps per second: 345.06
I0905 16:26:51.637446 140334269278208 replay_runner.py:36] Average training steps per second: 345.06
I0905 16:26:52.124301 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -440.40
INFO:tensorflow:Starting iteration 20

Steps executed: 236 Episode length: 110 Return: -187.8287442215270236
INFO:tensorflow:Average training steps per second: 309.93
I0905 16:26:58.860601 140334269278208 replay_runner.py:36] Average training steps per second: 309.93
I0905 16:26:58.958158 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.81
INFO:tensorflow:Starting iteration 21

Steps executed: 298 Episode length: 298 Return: -159.3289038872420236
INFO:tensorflow:Average training steps per second: 312.61
I0905 16:27:05.641723 140334269278208 replay_runner.py:36] Average training steps per second: 312.61
I0905 16:27:05.922293 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.33
INFO:tensorflow:Starting iteration 22

Steps executed: 226 Episode length: 226 Return: -531.0703311068355236
INFO:tensorflow:Average training steps per second: 296.71
I0905 16:27:12.954493 140334269278208 replay_runner.py:36] Average training steps per second: 296.71
I0905 16:27:13.099931 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -531.07
INFO:tensorflow:Starting iteration 23

Steps executed: 301 Episode length: 301 Return: -154.2231314558728236
INFO:tensorflow:Average training steps per second: 301.94
I0905 16:27:20.117041 140334269278208 replay_runner.py:36] Average training steps per second: 301.94
I0905 16:27:20.382678 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.22
INFO:tensorflow:Starting iteration 24

Steps executed: 291 Episode length: 158 Return: -649.0332946705502236
INFO:tensorflow:Average training steps per second: 306.13
I0905 16:27:27.309002 140334269278208 replay_runner.py:36] Average training steps per second: 306.13
I0905 16:27:27.487077 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -629.69
INFO:tensorflow:Starting iteration 25
I0905 16:27:31.168007 140334269278208 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 302.53

Steps executed: 451 Episode length: 399 Return: -524.4002177117115236
I0905 16:27:35.000207 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.07
INFO:tensorflow:Starting iteration 26

Steps executed: 270 Episode length: 135 Return: -667.5192061696338236
INFO:tensorflow:Average training steps per second: 307.71
I0905 16:27:41.918187 140334269278208 replay_runner.py:36] Average training steps per second: 307.71
I0905 16:27:42.089808 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -579.87
INFO:tensorflow:Starting iteration 27

Steps executed: 225 Episode length: 225 Return: -609.1255431250031236
INFO:tensorflow:Average training steps per second: 307.59
I0905 16:27:49.008880 140334269278208 replay_runner.py:36] Average training steps per second: 307.59
I0905 16:27:49.197597 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -609.13
INFO:tensorflow:Starting iteration 28

Steps executed: 318 Episode length: 318 Return: -349.6818895121019236
INFO:tensorflow:Average training steps per second: 307.60
I0905 16:27:56.111684 140334269278208 replay_runner.py:36] Average training steps per second: 307.60
I0905 16:27:56.375019 140334269278208 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.68
INFO:tensorflow:Starting iteration 29

Steps executed: 275 Episode length: 101 Return: -19.40615073492645636
INFO:tensorflow:Average training steps per second: 293.24
I0905 16:28:03.585431 140334269278208 replay_runner.py:36] Average training steps per second: 293.24

Done fixed training!Episode length: 101 Return: -19.40615073492645636