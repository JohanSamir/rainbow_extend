Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 00:23:26.059447 140149719906304 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:26.066207 140149719906304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:26.066323 140149719906304 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:26.066397 140149719906304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:26.066458 140149719906304 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:26.066525 140149719906304 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:26.066598 140149719906304 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:26.066682 140149719906304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:26.066835 140149719906304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:26.066940 140149719906304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:26.067012 140149719906304 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:26.067094 140149719906304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:26.067172 140149719906304 dqn_agent.py:283] 	 seed: 1630542206066178
I0902 00:23:26.068909 140149719906304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:26.069010 140149719906304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:26.069076 140149719906304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:26.069132 140149719906304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:26.069194 140149719906304 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:26.069258 140149719906304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:26.069339 140149719906304 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:26.069438 140149719906304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:26.069499 140149719906304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:26.092074 140149719906304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:26.316634 140149719906304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:26.325574 140149719906304 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:26.331447 140149719906304 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:26.331568 140149719906304 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:26.331642 140149719906304 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:26.331705 140149719906304 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:26.331761 140149719906304 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:26.331836 140149719906304 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:26.331918 140149719906304 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:26.331990 140149719906304 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:26.332050 140149719906304 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:26.332118 140149719906304 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:26.332186 140149719906304 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:26.332253 140149719906304 dqn_agent.py:283] 	 seed: 1630542206331421
I0902 00:23:26.333612 140149719906304 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:26.333718 140149719906304 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:26.333786 140149719906304 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:26.333853 140149719906304 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:26.333914 140149719906304 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:26.333969 140149719906304 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:26.334037 140149719906304 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:26.334128 140149719906304 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:26.334196 140149719906304 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:26.353450 140149719906304 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:26.368527 140149719906304 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:26.368669 140149719906304 replay_runner.py:41] Starting iteration 0
Steps executed: 302 Episode length: 162 Return: -384.7646909829636
INFO:tensorflow:Average training steps per second: 266.58
I0902 00:23:30.120005 140149719906304 replay_runner.py:36] Average training steps per second: 266.58
I0902 00:23:30.924732 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.55
INFO:tensorflow:Starting iteration 1

Steps executed: 256 Episode length: 136 Return: 28.078743562443805
INFO:tensorflow:Average training steps per second: 349.03
I0902 00:23:37.133032 140149719906304 replay_runner.py:36] Average training steps per second: 349.03
I0902 00:23:37.336696 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.07
INFO:tensorflow:Starting iteration 2
I0902 00:23:40.541101 140149719906304 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 336.50

Steps executed: 341 Episode length: 341 Return: -23.419787987806814
I0902 00:23:43.845610 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -23.42
INFO:tensorflow:Starting iteration 3

Steps executed: 453 Episode length: 453 Return: -97.292770761127164
INFO:tensorflow:Average training steps per second: 341.12
I0902 00:23:50.047573 140149719906304 replay_runner.py:36] Average training steps per second: 341.12
I0902 00:23:50.620337 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.29
INFO:tensorflow:Starting iteration 4
I0902 00:23:54.061319 140149719906304 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 378.27

Steps executed: 939 Episode length: 939 Return: -229.24233358015988
I0902 00:23:58.774410 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.24
INFO:tensorflow:Starting iteration 5
I0902 00:24:02.055056 140149719906304 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 374.52

Steps executed: 1000 Episode length: 1000 Return: -104.5325145074212
I0902 00:24:07.265885 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.53
INFO:tensorflow:Starting iteration 6
I0902 00:24:10.567431 140149719906304 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 341.98

Steps executed: 1000 Episode length: 1000 Return: -12.707976513164194
I0902 00:24:14.843967 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -12.71
INFO:tensorflow:Starting iteration 7
I0902 00:24:18.202699 140149719906304 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 338.52

Steps executed: 1000 Episode length: 1000 Return: -88.384705077675194
I0902 00:24:22.602809 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.38
INFO:tensorflow:Starting iteration 8
I0902 00:24:25.956429 140149719906304 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 346.36

Steps executed: 1000 Episode length: 1000 Return: -94.636274969508124
I0902 00:24:31.340359 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.64
INFO:tensorflow:Starting iteration 9
I0902 00:24:34.698081 140149719906304 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 336.80

Steps executed: 635 Episode length: 635 Return: -314.4650050219447124
I0902 00:24:38.477262 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.47
INFO:tensorflow:Starting iteration 10

Steps executed: 295 Episode length: 295 Return: -128.3343451976993524
INFO:tensorflow:Average training steps per second: 330.57
I0902 00:24:44.731552 140149719906304 replay_runner.py:36] Average training steps per second: 330.57
I0902 00:24:44.971362 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.33
INFO:tensorflow:Starting iteration 11

Steps executed: 194 Episode length: 194 Return: -240.0881312695364524
INFO:tensorflow:Average training steps per second: 364.00

Steps executed: 1194 Episode length: 1000 Return: -127.00945579844234
I0902 00:24:53.405021 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.55
INFO:tensorflow:Starting iteration 12

Steps executed: 383 Episode length: 311 Return: -315.6031494054629234
INFO:tensorflow:Average training steps per second: 364.72
I0902 00:24:59.525704 140149719906304 replay_runner.py:36] Average training steps per second: 364.72
I0902 00:24:59.862658 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.02
INFO:tensorflow:Starting iteration 13
I0902 00:25:03.300058 140149719906304 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 363.56
I0902 00:25:06.051093 140149719906304 replay_runner.py:36] Average training steps per second: 363.56

Steps executed: 245 Episode length: 55 Return: -316.77282927370896234
INFO:tensorflow:Starting iteration 14

Steps executed: 598 Episode length: 598 Return: 214.54988603672558234
INFO:tensorflow:Average training steps per second: 329.98
I0902 00:25:12.631631 140149719906304 replay_runner.py:36] Average training steps per second: 329.98
I0902 00:25:13.604546 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: 214.55
INFO:tensorflow:Starting iteration 15

Steps executed: 151 Episode length: 151 Return: -168.6859693178642534
INFO:tensorflow:Average training steps per second: 328.04

Steps executed: 665 Episode length: 514 Return: -80.06814366992181534
I0902 00:25:20.662999 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.38
INFO:tensorflow:Starting iteration 16

Steps executed: 280 Episode length: 157 Return: -91.62237764851251534
INFO:tensorflow:Average training steps per second: 342.64
I0902 00:25:26.943143 140149719906304 replay_runner.py:36] Average training steps per second: 342.64
I0902 00:25:27.086924 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.03
INFO:tensorflow:Starting iteration 17

Steps executed: 320 Episode length: 320 Return: -325.2747155378542634
INFO:tensorflow:Average training steps per second: 326.60
I0902 00:25:33.465293 140149719906304 replay_runner.py:36] Average training steps per second: 326.60
I0902 00:25:33.731427 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.27
INFO:tensorflow:Starting iteration 18

Steps executed: 437 Episode length: 292 Return: -272.9303683449008434
INFO:tensorflow:Average training steps per second: 330.31
I0902 00:25:39.989548 140149719906304 replay_runner.py:36] Average training steps per second: 330.31
I0902 00:25:40.325398 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.57
INFO:tensorflow:Starting iteration 19

Steps executed: 213 Episode length: 101 Return: -283.7091802299436234
INFO:tensorflow:Average training steps per second: 324.69
I0902 00:25:46.709850 140149719906304 replay_runner.py:36] Average training steps per second: 324.69
I0902 00:25:46.822370 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.05
INFO:tensorflow:Starting iteration 20

Steps executed: 239 Episode length: 149 Return: -177.9164435969535234
INFO:tensorflow:Average training steps per second: 349.34
I0902 00:25:53.044984 140149719906304 replay_runner.py:36] Average training steps per second: 349.34
I0902 00:25:53.188695 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.27
INFO:tensorflow:Starting iteration 21

Steps executed: 265 Episode length: 265 Return: 235.70558284434835234
INFO:tensorflow:Average training steps per second: 351.40
I0902 00:25:59.466707 140149719906304 replay_runner.py:36] Average training steps per second: 351.40
I0902 00:25:59.702730 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: 235.71
INFO:tensorflow:Starting iteration 22
I0902 00:26:03.168745 140149719906304 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 343.02

Steps executed: 448 Episode length: 448 Return: -624.8856035410364234
I0902 00:26:06.629781 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.89
INFO:tensorflow:Starting iteration 23

Steps executed: 241 Episode length: 241 Return: -231.1905914524630234
INFO:tensorflow:Average training steps per second: 340.66
I0902 00:26:13.049416 140149719906304 replay_runner.py:36] Average training steps per second: 340.66
I0902 00:26:13.248740 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.19
INFO:tensorflow:Starting iteration 24

Steps executed: 259 Episode length: 162 Return: -360.5118642957000434
INFO:tensorflow:Average training steps per second: 350.09
I0902 00:26:19.567587 140149719906304 replay_runner.py:36] Average training steps per second: 350.09
I0902 00:26:19.714607 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.01
INFO:tensorflow:Starting iteration 25

Steps executed: 252 Episode length: 77 Return: -86.526062613775380434
INFO:tensorflow:Average training steps per second: 358.95
I0902 00:26:25.981509 140149719906304 replay_runner.py:36] Average training steps per second: 358.95
I0902 00:26:26.112416 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.40
INFO:tensorflow:Starting iteration 26

Steps executed: 280 Episode length: 280 Return: -43.63328593422848434
INFO:tensorflow:Average training steps per second: 365.89
I0902 00:26:32.388976 140149719906304 replay_runner.py:36] Average training steps per second: 365.89
I0902 00:26:32.658002 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.63
INFO:tensorflow:Starting iteration 27

Steps executed: 311 Episode length: 171 Return: -122.3656070871668634
INFO:tensorflow:Average training steps per second: 358.77
I0902 00:26:39.020626 140149719906304 replay_runner.py:36] Average training steps per second: 358.77
I0902 00:26:39.218950 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.81
INFO:tensorflow:Starting iteration 28

Steps executed: 272 Episode length: 126 Return: -130.6981650350416534
INFO:tensorflow:Average training steps per second: 352.85
I0902 00:26:45.576514 140149719906304 replay_runner.py:36] Average training steps per second: 352.85
I0902 00:26:45.736802 140149719906304 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.38
INFO:tensorflow:Starting iteration 29

Steps executed: 227 Episode length: 136 Return: -103.6808299750873334
INFO:tensorflow:Average training steps per second: 347.82
I0902 00:26:52.108059 140149719906304 replay_runner.py:36] Average training steps per second: 347.82

Done fixed training!Episode length: 136 Return: -103.6808299750873334