I0902 00:15:20.923691 140183943698432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:15:20.934021 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:20.934317 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:20.934446 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:20.934547 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:20.934651 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:20.934744 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:20.934863 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:20.934963 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:20.935054 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:20.935150 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:20.935276 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:20.935389 140183943698432 dqn_agent.py:283] 	 seed: 1630541720933960
I0902 00:15:20.938774 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:20.938994 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:20.939110 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:20.939186 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:20.939248 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:20.939340 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:20.939409 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:20.939507 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:20.939562 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:20.973491 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:21.354555 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:21.370363 140183943698432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:15:21.461046 140183943698432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:15:21.461339 140183943698432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:15:21.461493 140183943698432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:15:21.461605 140183943698432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:15:21.461713 140183943698432 dqn_agent.py:275] 	 update_period: 4
I0902 00:15:21.461827 140183943698432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:15:21.461932 140183943698432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:15:21.462036 140183943698432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:15:21.462139 140183943698432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:15:21.462242 140183943698432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:15:21.462333 140183943698432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:15:21.462409 140183943698432 dqn_agent.py:283] 	 seed: 1630541721460988
I0902 00:15:21.465225 140183943698432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:15:21.465478 140183943698432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:15:21.465632 140183943698432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:15:21.465780 140183943698432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:15:21.465881 140183943698432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:15:21.465979 140183943698432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:15:21.466080 140183943698432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:15:21.466212 140183943698432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:15:21.466357 140183943698432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:15:21.502572 140183943698432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:15:21.525884 140183943698432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:15:21.526246 140183943698432 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 168.94
I0902 00:15:27.445810 140183943698432 replay_runner.py:36] Average training steps per second: 168.94
Steps executed: 279 Episode length: 150 Return: -202.9164608262467
I0902 00:15:28.713967 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.99
INFO:tensorflow:Starting iteration 1

Steps executed: 258 Episode length: 118 Return: -558.5690910806443
INFO:tensorflow:Average training steps per second: 223.11
I0902 00:15:37.563235 140183943698432 replay_runner.py:36] Average training steps per second: 223.11
I0902 00:15:37.788582 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.96
INFO:tensorflow:Starting iteration 2
I0902 00:15:42.066701 140183943698432 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 225.89

Steps executed: 274 Episode length: 170 Return: -274.1275685769361
I0902 00:15:46.746137 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.33
INFO:tensorflow:Starting iteration 3

Steps executed: 372 Episode length: 207 Return: -340.9141463472333
INFO:tensorflow:Average training steps per second: 225.84
I0902 00:15:55.473190 140183943698432 replay_runner.py:36] Average training steps per second: 225.84
I0902 00:15:55.840397 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.09
INFO:tensorflow:Starting iteration 4
I0902 00:16:00.230512 140183943698432 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 233.23

Steps executed: 1000 Episode length: 1000 Return: -2.5130606853006316
I0902 00:16:08.077867 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.51
INFO:tensorflow:Starting iteration 5
I0902 00:16:12.375270 140183943698432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.26

Steps executed: 1000 Episode length: 1000 Return: -60.471196463346746
I0902 00:16:18.847171 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.47
INFO:tensorflow:Starting iteration 6
I0902 00:16:23.163541 140183943698432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.48

Steps executed: 1000 Episode length: 1000 Return: -93.697345569823746
I0902 00:16:31.405864 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.70
INFO:tensorflow:Starting iteration 7
I0902 00:16:35.720669 140183943698432 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 228.04

Steps executed: 1000 Episode length: 1000 Return: -185.93261614522922
I0902 00:16:42.953323 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.93
INFO:tensorflow:Starting iteration 8
I0902 00:16:47.162787 140183943698432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 233.75

Steps executed: 1000 Episode length: 1000 Return: -117.20190310364161
I0902 00:16:54.401583 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.20
INFO:tensorflow:Starting iteration 9
I0902 00:16:58.581169 140183943698432 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 248.26

Steps executed: 1000 Episode length: 1000 Return: -53.717559798509031
I0902 00:17:05.899156 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.72
INFO:tensorflow:Starting iteration 10
I0902 00:17:10.038830 140183943698432 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 255.26

Steps executed: 1000 Episode length: 1000 Return: -116.77272158279611
I0902 00:17:16.163728 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.77
INFO:tensorflow:Starting iteration 11
I0902 00:17:20.367932 140183943698432 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 262.43

Steps executed: 884 Episode length: 884 Return: -618.7812193082809611
I0902 00:17:26.052548 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -618.78
INFO:tensorflow:Starting iteration 12
I0902 00:17:30.231498 140183943698432 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 259.49

Steps executed: 669 Episode length: 669 Return: -358.7794920294428611
I0902 00:17:35.541531 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.78
INFO:tensorflow:Starting iteration 13

Steps executed: 289 Episode length: 289 Return: -228.9456781188325711
INFO:tensorflow:Average training steps per second: 260.01
I0902 00:17:43.519554 140183943698432 replay_runner.py:36] Average training steps per second: 260.01
I0902 00:17:43.887221 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.95
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 317 Return: -102.9607373081981311
INFO:tensorflow:Average training steps per second: 278.55
I0902 00:17:51.563792 140183943698432 replay_runner.py:36] Average training steps per second: 278.55
I0902 00:17:52.050003 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.54
INFO:tensorflow:Starting iteration 15
I0902 00:17:55.911317 140183943698432 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 301.39

Steps executed: 327 Episode length: 157 Return: -310.6878373094242511
I0902 00:17:59.486344 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.15
INFO:tensorflow:Starting iteration 16

Steps executed: 334 Episode length: 214 Return: -155.7508832441373511
INFO:tensorflow:Average training steps per second: 316.07
I0902 00:18:06.297514 140183943698432 replay_runner.py:36] Average training steps per second: 316.07
I0902 00:18:06.572506 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.74
INFO:tensorflow:Starting iteration 17
I0902 00:18:10.234348 140183943698432 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 320.17

Steps executed: 500 Episode length: 359 Return: -314.9326034877206511
I0902 00:18:13.808884 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -195.30
INFO:tensorflow:Starting iteration 18

Steps executed: 382 Episode length: 274 Return: -1453.176173969936611
INFO:tensorflow:Average training steps per second: 314.31
I0902 00:18:20.554536 140183943698432 replay_runner.py:36] Average training steps per second: 314.31
I0902 00:18:20.872007 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -723.65
INFO:tensorflow:Starting iteration 19

Steps executed: 222 Episode length: 106 Return: -108.0432245063135511
INFO:tensorflow:Average training steps per second: 314.37
I0902 00:18:27.446315 140183943698432 replay_runner.py:36] Average training steps per second: 314.37
I0902 00:18:27.598555 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.75
INFO:tensorflow:Starting iteration 20

Steps executed: 309 Episode length: 197 Return: -342.5377262100606711
INFO:tensorflow:Average training steps per second: 316.93
I0902 00:18:34.114129 140183943698432 replay_runner.py:36] Average training steps per second: 316.93
I0902 00:18:34.373262 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.50
INFO:tensorflow:Starting iteration 21
I0902 00:18:37.763497 140183943698432 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 309.76

Steps executed: 235 Episode length: 235 Return: -57.58967658651883411
I0902 00:18:41.196489 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.59
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 136 Return: 16.656915537958298411
INFO:tensorflow:Average training steps per second: 319.62
I0902 00:18:47.511130 140183943698432 replay_runner.py:36] Average training steps per second: 319.62
I0902 00:18:47.662751 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.16
INFO:tensorflow:Starting iteration 23

Steps executed: 300 Episode length: 119 Return: -270.8875158041509411
INFO:tensorflow:Average training steps per second: 332.45
I0902 00:18:53.844160 140183943698432 replay_runner.py:36] Average training steps per second: 332.45
I0902 00:18:54.080354 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.52
INFO:tensorflow:Starting iteration 24

Steps executed: 269 Episode length: 111 Return: -741.3470944159534411
INFO:tensorflow:Average training steps per second: 344.11
I0902 00:19:00.263957 140183943698432 replay_runner.py:36] Average training steps per second: 344.11
I0902 00:19:00.462301 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.82
INFO:tensorflow:Starting iteration 25

Steps executed: 302 Episode length: 189 Return: -436.5545633391928411
INFO:tensorflow:Average training steps per second: 351.18
I0902 00:19:06.600624 140183943698432 replay_runner.py:36] Average training steps per second: 351.18
I0902 00:19:06.830520 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.95
INFO:tensorflow:Starting iteration 26

Steps executed: 290 Episode length: 114 Return: -475.3314967136427611
INFO:tensorflow:Average training steps per second: 354.84
I0902 00:19:12.991285 140183943698432 replay_runner.py:36] Average training steps per second: 354.84
I0902 00:19:13.174727 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.96
INFO:tensorflow:Starting iteration 27
I0902 00:19:16.512890 140183943698432 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 349.14

Steps executed: 316 Episode length: 316 Return: -56.02031615895884611
I0902 00:19:19.707333 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.02
INFO:tensorflow:Starting iteration 28

Steps executed: 291 Episode length: 103 Return: -184.4821632675752311
INFO:tensorflow:Average training steps per second: 371.39
I0902 00:19:25.536976 140183943698432 replay_runner.py:36] Average training steps per second: 371.39
I0902 00:19:25.770085 140183943698432 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.65
INFO:tensorflow:Starting iteration 29

Steps executed: 240 Episode length: 119 Return: -419.3203346142683311
INFO:tensorflow:Average training steps per second: 354.86
I0902 00:19:31.936592 140183943698432 replay_runner.py:36] Average training steps per second: 354.86

Done fixed training!Episode length: 119 Return: -419.3203346142683311