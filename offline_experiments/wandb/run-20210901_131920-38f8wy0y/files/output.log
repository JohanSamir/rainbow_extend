I0901 13:19:26.885362 140315766171648 run_experiment.py:549] Creating TrainRunner ...
I0901 13:19:26.892677 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:19:26.892858 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:19:26.892963 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:19:26.893043 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:19:26.893116 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:19:26.893208 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:19:26.893316 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:19:26.893395 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:19:26.893472 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:19:26.893550 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:19:26.893634 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:19:26.893732 140315766171648 dqn_agent.py:283] 	 seed: 1630502366892635
I0901 13:19:26.895541 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:19:26.895654 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:19:26.895759 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:19:26.895822 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:19:26.895893 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:19:26.895962 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:19:26.896023 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:19:26.896100 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:19:26.896173 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:19:26.923821 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:27.182568 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:27.192066 140315766171648 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:19:27.199591 140315766171648 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:19:27.199829 140315766171648 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:19:27.199963 140315766171648 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:19:27.200048 140315766171648 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:19:27.200139 140315766171648 dqn_agent.py:275] 	 update_period: 4
I0901 13:19:27.200208 140315766171648 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:19:27.200333 140315766171648 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:19:27.200414 140315766171648 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:19:27.200467 140315766171648 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:19:27.200517 140315766171648 dqn_agent.py:280] 	 optimizer: adam
I0901 13:19:27.200567 140315766171648 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:19:27.200617 140315766171648 dqn_agent.py:283] 	 seed: 1630502367199552
I0901 13:19:27.202097 140315766171648 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:19:27.202224 140315766171648 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:19:27.202320 140315766171648 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:19:27.202426 140315766171648 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:19:27.202486 140315766171648 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:19:27.202578 140315766171648 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:19:27.202662 140315766171648 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:19:27.202728 140315766171648 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:19:27.202801 140315766171648 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:19:27.227875 140315766171648 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:19:27.244102 140315766171648 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:19:27.244293 140315766171648 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 230.96
I0901 13:19:31.574316 140315766171648 replay_runner.py:36] Average training steps per second: 230.96
I0901 13:19:32.378446 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.03
Steps executed: 216 Episode length: 86 Return: -372.147752709802684
INFO:tensorflow:Starting iteration 1

Steps executed: 306 Episode length: 306 Return: -329.28136417504766
INFO:tensorflow:Average training steps per second: 322.17
I0901 13:19:38.869906 140315766171648 replay_runner.py:36] Average training steps per second: 322.17
I0901 13:19:39.154430 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.28
INFO:tensorflow:Starting iteration 2

Steps executed: 244 Episode length: 123 Return: -363.19403743378047
INFO:tensorflow:Average training steps per second: 342.88
I0901 13:19:45.438090 140315766171648 replay_runner.py:36] Average training steps per second: 342.88
I0901 13:19:45.596589 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.09
INFO:tensorflow:Starting iteration 3

Steps executed: 301 Episode length: 111 Return: -17.194125021983382
INFO:tensorflow:Average training steps per second: 317.86
I0901 13:19:52.153588 140315766171648 replay_runner.py:36] Average training steps per second: 317.86
I0901 13:19:52.333441 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -51.72
INFO:tensorflow:Starting iteration 4

Steps executed: 289 Episode length: 149 Return: -197.96367615614216
INFO:tensorflow:Average training steps per second: 320.69
I0901 13:19:58.804700 140315766171648 replay_runner.py:36] Average training steps per second: 320.69
I0901 13:19:59.003136 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.11
INFO:tensorflow:Starting iteration 5

Steps executed: 621 Episode length: 621 Return: -196.30183900041726
INFO:tensorflow:Average training steps per second: 339.08
I0901 13:20:05.346834 140315766171648 replay_runner.py:36] Average training steps per second: 339.08
I0901 13:20:06.527509 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.30
INFO:tensorflow:Starting iteration 6

Steps executed: 264 Episode length: 264 Return: -252.32201738663266
INFO:tensorflow:Average training steps per second: 327.61
I0901 13:20:12.974941 140315766171648 replay_runner.py:36] Average training steps per second: 327.61
I0901 13:20:13.225031 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.32
INFO:tensorflow:Starting iteration 7

Steps executed: 538 Episode length: 538 Return: -366.32159098200555
INFO:tensorflow:Average training steps per second: 325.16
I0901 13:20:19.662729 140315766171648 replay_runner.py:36] Average training steps per second: 325.16
I0901 13:20:20.384977 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.32
INFO:tensorflow:Starting iteration 8

Steps executed: 325 Episode length: 149 Return: -41.380917213156285
INFO:tensorflow:Average training steps per second: 317.25
I0901 13:20:26.911181 140315766171648 replay_runner.py:36] Average training steps per second: 317.25
I0901 13:20:27.085135 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.56
INFO:tensorflow:Starting iteration 9

Steps executed: 340 Episode length: 238 Return: -259.20243580595854
INFO:tensorflow:Average training steps per second: 319.92
I0901 13:20:33.499772 140315766171648 replay_runner.py:36] Average training steps per second: 319.92
I0901 13:20:33.768982 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.50
INFO:tensorflow:Starting iteration 10

Steps executed: 277 Episode length: 99 Return: -126.643952964539864
INFO:tensorflow:Average training steps per second: 306.00
I0901 13:20:40.278662 140315766171648 replay_runner.py:36] Average training steps per second: 306.00
I0901 13:20:40.426342 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.27
INFO:tensorflow:Starting iteration 11
I0901 13:20:43.680558 140315766171648 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 327.66

Steps executed: 281 Episode length: 281 Return: -299.20440585348706
I0901 13:20:47.026568 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.20
INFO:tensorflow:Starting iteration 12

Steps executed: 206 Episode length: 115 Return: -202.50123655984953
INFO:tensorflow:Average training steps per second: 334.57
I0901 13:20:53.407760 140315766171648 replay_runner.py:36] Average training steps per second: 334.57
I0901 13:20:53.541394 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.47
INFO:tensorflow:Starting iteration 13

Steps executed: 280 Episode length: 167 Return: -231.69372295021887
INFO:tensorflow:Average training steps per second: 347.08
I0901 13:20:59.887620 140315766171648 replay_runner.py:36] Average training steps per second: 347.08
I0901 13:21:00.073409 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.78
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 84 Return: -217.076791800969267
INFO:tensorflow:Average training steps per second: 359.36
I0901 13:21:06.364544 140315766171648 replay_runner.py:36] Average training steps per second: 359.36
I0901 13:21:06.470428 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.19
INFO:tensorflow:Starting iteration 15

Steps executed: 267 Episode length: 96 Return: 0.720676964788182887
INFO:tensorflow:Average training steps per second: 357.18
I0901 13:21:12.821465 140315766171648 replay_runner.py:36] Average training steps per second: 357.18
I0901 13:21:12.918225 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.45
INFO:tensorflow:Starting iteration 16

Steps executed: 234 Episode length: 63 Return: -156.757559892860237
INFO:tensorflow:Average training steps per second: 346.68
I0901 13:21:19.299795 140315766171648 replay_runner.py:36] Average training steps per second: 346.68
I0901 13:21:19.408537 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.55
INFO:tensorflow:Starting iteration 17

Steps executed: 255 Episode length: 255 Return: -205.25588050838957
INFO:tensorflow:Average training steps per second: 331.48
I0901 13:21:25.883189 140315766171648 replay_runner.py:36] Average training steps per second: 331.48
I0901 13:21:26.085191 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.26
INFO:tensorflow:Starting iteration 18
I0901 13:21:29.484092 140315766171648 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 328.40
I0901 13:21:32.529448 140315766171648 replay_runner.py:36] Average training steps per second: 328.40

Steps executed: 481 Episode length: 481 Return: -165.05086371315987
INFO:tensorflow:Starting iteration 19

Steps executed: 206 Episode length: 77 Return: -126.945078721319647
INFO:tensorflow:Average training steps per second: 326.26
I0901 13:21:39.496895 140315766171648 replay_runner.py:36] Average training steps per second: 326.26
I0901 13:21:39.603469 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.10
INFO:tensorflow:Starting iteration 20

Steps executed: 576 Episode length: 576 Return: -354.07307894742427
INFO:tensorflow:Average training steps per second: 332.73
I0901 13:21:46.055227 140315766171648 replay_runner.py:36] Average training steps per second: 332.73
I0901 13:21:46.803222 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.07
INFO:tensorflow:Starting iteration 21

Steps executed: 263 Episode length: 78 Return: -144.335970274963647
INFO:tensorflow:Average training steps per second: 323.47
I0901 13:21:53.288616 140315766171648 replay_runner.py:36] Average training steps per second: 323.47
I0901 13:21:53.419968 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.43
INFO:tensorflow:Starting iteration 22

Steps executed: 239 Episode length: 239 Return: -107.45633538900532
INFO:tensorflow:Average training steps per second: 304.14
I0901 13:22:00.077420 140315766171648 replay_runner.py:36] Average training steps per second: 304.14
I0901 13:22:00.236116 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.46
INFO:tensorflow:Starting iteration 23
I0901 13:22:03.569411 140315766171648 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 306.73

Steps executed: 1000 Episode length: 1000 Return: -56.75578195663999
I0901 13:22:09.643973 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.76
INFO:tensorflow:Starting iteration 24
I0901 13:22:13.080550 140315766171648 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 337.15

Steps executed: 1000 Episode length: 1000 Return: -261.7232206595525
I0901 13:22:17.380867 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.72
INFO:tensorflow:Starting iteration 25
I0901 13:22:20.763749 140315766171648 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 326.79

Steps executed: 1000 Episode length: 1000 Return: -134.32387161869408
I0901 13:22:26.208801 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.32
INFO:tensorflow:Starting iteration 26
I0901 13:22:29.619865 140315766171648 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 339.03

Steps executed: 1000 Episode length: 1000 Return: -267.10555594639238
I0901 13:22:34.105676 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.11
INFO:tensorflow:Starting iteration 27
I0901 13:22:37.407477 140315766171648 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 324.70

Steps executed: 1000 Episode length: 1000 Return: -123.52163962938326
I0901 13:22:42.259917 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.52
INFO:tensorflow:Starting iteration 28

Steps executed: 303 Episode length: 181 Return: -249.9751668707981526
INFO:tensorflow:Average training steps per second: 338.25
I0901 13:22:48.511448 140315766171648 replay_runner.py:36] Average training steps per second: 338.25
I0901 13:22:48.691334 140315766171648 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.16
INFO:tensorflow:Starting iteration 29
I0901 13:22:51.956019 140315766171648 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 328.98

Steps executed: 1000 Episode length: 1000 Return: -220.63171166731917

Done fixed training! Episode length: 1000 Return: -220.63171166731917