Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0901 12:30:19.400664 139982171817984 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:19.412431 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:19.412700 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:19.412853 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:19.412982 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:19.413111 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:19.413231 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:19.413360 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:19.413476 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:19.413590 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:19.413705 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:19.413849 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:19.413985 139982171817984 dqn_agent.py:283] 	 seed: 1630499419412367
I0901 12:30:19.417200 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:19.417417 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:19.417562 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:19.417720 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:19.417847 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:19.417968 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:19.418139 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:19.418282 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:19.418410 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:19.627719 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:20.031130 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:20.045634 139982171817984 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:20.054556 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:20.054858 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:20.055007 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:20.055176 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:20.055380 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:20.055507 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:20.055732 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:20.055881 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:20.055989 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:20.056096 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:20.056200 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:20.056304 139982171817984 dqn_agent.py:283] 	 seed: 1630499420054499
I0901 12:30:20.059063 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:20.059241 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:20.059367 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:20.059485 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:20.059593 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:20.059700 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:20.059802 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:20.059948 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:20.060086 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:20.093450 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:20.115051 139982171817984 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:20.115429 139982171817984 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.97
I0901 12:30:26.486418 139982171817984 replay_runner.py:36] Average training steps per second: 156.97
Steps executed: 377 Episode length: 197 Return: -573.3238881876991
I0901 12:30:27.910162 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -566.09
INFO:tensorflow:Starting iteration 1

Steps executed: 150 Episode length: 150 Return: -362.80977776299324
INFO:tensorflow:Average training steps per second: 222.01

Steps executed: 311 Episode length: 161 Return: -266.28425772025554
I0901 12:30:37.071372 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.55
INFO:tensorflow:Starting iteration 2

Steps executed: 289 Episode length: 155 Return: -287.50909383654664
INFO:tensorflow:Average training steps per second: 220.79
I0901 12:30:46.010919 139982171817984 replay_runner.py:36] Average training steps per second: 220.79
I0901 12:30:46.306185 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.54
INFO:tensorflow:Starting iteration 3

Steps executed: 94 Episode length: 94 Return: -494.5535067895071464
INFO:tensorflow:Average training steps per second: 232.53
I0901 12:30:54.943822 139982171817984 replay_runner.py:36] Average training steps per second: 232.53

Steps executed: 219 Episode length: 125 Return: -414.46698205173465
INFO:tensorflow:Starting iteration 4

Steps executed: 379 Episode length: 184 Return: -96.212724226540793
INFO:tensorflow:Average training steps per second: 225.93
I0901 12:31:03.917105 139982171817984 replay_runner.py:36] Average training steps per second: 225.93
I0901 12:31:04.235730 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.00
INFO:tensorflow:Starting iteration 5
I0901 12:31:08.464977 139982171817984 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 216.15

Steps executed: 217 Episode length: 86 Return: -694.796390647256818
I0901 12:31:13.301836 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.72
INFO:tensorflow:Starting iteration 6

Steps executed: 260 Episode length: 89 Return: -379.743395431556118
INFO:tensorflow:Average training steps per second: 230.54
I0901 12:31:22.047010 139982171817984 replay_runner.py:36] Average training steps per second: 230.54
I0901 12:31:22.263265 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.86
INFO:tensorflow:Starting iteration 7

Steps executed: 248 Episode length: 77 Return: -412.606435278186848
INFO:tensorflow:Average training steps per second: 227.86
I0901 12:31:30.970373 139982171817984 replay_runner.py:36] Average training steps per second: 227.86
I0901 12:31:31.158766 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.32
INFO:tensorflow:Starting iteration 8

Steps executed: 207 Episode length: 91 Return: -408.534498558098858
INFO:tensorflow:Average training steps per second: 229.91
I0901 12:31:39.790017 139982171817984 replay_runner.py:36] Average training steps per second: 229.91
I0901 12:31:39.956455 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.12
INFO:tensorflow:Starting iteration 9

Steps executed: 310 Episode length: 157 Return: -369.34635971396848
INFO:tensorflow:Average training steps per second: 223.45
I0901 12:31:48.764784 139982171817984 replay_runner.py:36] Average training steps per second: 223.45
I0901 12:31:49.032406 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.37
INFO:tensorflow:Starting iteration 10

Steps executed: 247 Episode length: 112 Return: -302.98797510947736
INFO:tensorflow:Average training steps per second: 224.41
I0901 12:31:57.866840 139982171817984 replay_runner.py:36] Average training steps per second: 224.41
I0901 12:31:58.077909 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.38
INFO:tensorflow:Starting iteration 11

Steps executed: 273 Episode length: 91 Return: -90.7241377921289487
INFO:tensorflow:Average training steps per second: 219.66
I0901 12:32:07.047555 139982171817984 replay_runner.py:36] Average training steps per second: 219.66
I0901 12:32:07.257884 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.72
INFO:tensorflow:Starting iteration 12

Steps executed: 206 Episode length: 67 Return: -72.6489442336062737
INFO:tensorflow:Average training steps per second: 219.83
I0901 12:32:15.993361 139982171817984 replay_runner.py:36] Average training steps per second: 219.83
I0901 12:32:16.146612 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.71
INFO:tensorflow:Starting iteration 13

Steps executed: 226 Episode length: 70 Return: -495.048663589483177
INFO:tensorflow:Average training steps per second: 216.78
I0901 12:32:25.162458 139982171817984 replay_runner.py:36] Average training steps per second: 216.78
I0901 12:32:25.359602 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.30
INFO:tensorflow:Starting iteration 14

Steps executed: 206 Episode length: 128 Return: -265.81175340228747
INFO:tensorflow:Average training steps per second: 220.33
I0901 12:32:34.206520 139982171817984 replay_runner.py:36] Average training steps per second: 220.33
I0901 12:32:34.381403 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.31
INFO:tensorflow:Starting iteration 15

Steps executed: 90 Episode length: 90 Return: -330.7186603322814747
INFO:tensorflow:Average training steps per second: 218.29
I0901 12:32:43.367969 139982171817984 replay_runner.py:36] Average training steps per second: 218.29

Steps executed: 354 Episode length: 264 Return: -425.34387658583637
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 150 Return: -269.33412569680367
INFO:tensorflow:Average training steps per second: 216.50
I0901 12:32:52.775893 139982171817984 replay_runner.py:36] Average training steps per second: 216.50
I0901 12:32:53.014369 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.30
INFO:tensorflow:Starting iteration 17

Steps executed: 218 Episode length: 73 Return: -232.786880218067257
INFO:tensorflow:Average training steps per second: 218.20
I0901 12:33:01.970630 139982171817984 replay_runner.py:36] Average training steps per second: 218.20
I0901 12:33:02.124261 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.39
INFO:tensorflow:Starting iteration 18

Steps executed: 340 Episode length: 141 Return: -266.52227737639637
INFO:tensorflow:Average training steps per second: 216.55
I0901 12:33:11.206859 139982171817984 replay_runner.py:36] Average training steps per second: 216.55
I0901 12:33:11.531203 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.43
INFO:tensorflow:Starting iteration 19

Steps executed: 234 Episode length: 89 Return: -314.691660186357637
INFO:tensorflow:Average training steps per second: 218.20
I0901 12:33:20.554507 139982171817984 replay_runner.py:36] Average training steps per second: 218.20
I0901 12:33:20.730542 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.26
INFO:tensorflow:Starting iteration 20

Steps executed: 249 Episode length: 129 Return: -369.12262697450227
INFO:tensorflow:Average training steps per second: 219.72
I0901 12:33:29.663389 139982171817984 replay_runner.py:36] Average training steps per second: 219.72
I0901 12:33:29.885707 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -537.19
INFO:tensorflow:Starting iteration 21

Steps executed: 264 Episode length: 70 Return: -172.427648994572627
INFO:tensorflow:Average training steps per second: 221.68
I0901 12:33:38.655405 139982171817984 replay_runner.py:36] Average training steps per second: 221.68
I0901 12:33:38.828679 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.41
INFO:tensorflow:Starting iteration 22

Steps executed: 366 Episode length: 269 Return: -237.42964731370677
INFO:tensorflow:Average training steps per second: 221.16
I0901 12:33:47.760607 139982171817984 replay_runner.py:36] Average training steps per second: 221.16
I0901 12:33:48.154396 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.22
INFO:tensorflow:Starting iteration 23

Steps executed: 214 Episode length: 77 Return: -758.617274090226377
INFO:tensorflow:Average training steps per second: 228.53
I0901 12:33:56.843835 139982171817984 replay_runner.py:36] Average training steps per second: 228.53
I0901 12:33:57.030797 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -686.93
INFO:tensorflow:Starting iteration 24
I0901 12:34:01.341243 139982171817984 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 230.46

Steps executed: 229 Episode length: 129 Return: -743.11534020902297
I0901 12:34:05.887761 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -699.51
INFO:tensorflow:Starting iteration 25

Steps executed: 226 Episode length: 165 Return: -204.56065899504466
INFO:tensorflow:Average training steps per second: 222.19
I0901 12:34:14.785550 139982171817984 replay_runner.py:36] Average training steps per second: 222.19
I0901 12:34:15.013036 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.78
INFO:tensorflow:Starting iteration 26

Steps executed: 253 Episode length: 66 Return: -136.168332697346936
INFO:tensorflow:Average training steps per second: 217.32
I0901 12:34:23.891906 139982171817984 replay_runner.py:36] Average training steps per second: 217.32
I0901 12:34:24.076053 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.72
INFO:tensorflow:Starting iteration 27

Steps executed: 212 Episode length: 98 Return: -259.249875929760156
INFO:tensorflow:Average training steps per second: 230.53
I0901 12:34:32.823013 139982171817984 replay_runner.py:36] Average training steps per second: 230.53
I0901 12:34:32.981060 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.24
INFO:tensorflow:Starting iteration 28
I0901 12:34:37.334938 139982171817984 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 227.60

Steps executed: 231 Episode length: 117 Return: -263.28708984103666
I0901 12:34:41.948734 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.07
INFO:tensorflow:Starting iteration 29

Steps executed: 224 Episode length: 55 Return: -361.081037959411566
INFO:tensorflow:Average training steps per second: 233.21
I0901 12:34:50.721150 139982171817984 replay_runner.py:36] Average training steps per second: 233.21

Done fixed training!Episode length: 55 Return: -361.081037959411566