I0901 13:01:57.524444 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 13:01:57.534247 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:01:57.534638 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:01:57.534850 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:01:57.534990 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:01:57.535104 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 13:01:57.535225 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:01:57.535344 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:01:57.535435 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:01:57.535541 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:01:57.535649 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 13:01:57.535751 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:01:57.535827 140635665344512 dqn_agent.py:283] 	 seed: 1630501317534168
I0901 13:01:57.538406 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:01:57.538553 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:01:57.538654 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:01:57.538718 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:01:57.538770 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:01:57.538819 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:01:57.538866 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:01:57.538913 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:01:57.538958 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 13:01:59.633036 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:00.219521 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:00.236712 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:02:00.245107 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:02:00.245338 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:02:00.245471 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:02:00.245646 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:02:00.245737 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 13:02:00.245884 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:02:00.246032 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:02:00.246299 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:02:00.246632 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:02:00.246757 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 13:02:00.246902 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:02:00.246961 140635665344512 dqn_agent.py:283] 	 seed: 1630501320245043
I0901 13:02:00.249332 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:02:00.249537 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:02:00.249696 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:02:00.249887 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:02:00.250024 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:02:00.250166 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:02:00.250429 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:02:00.250775 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:02:00.250982 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:02:00.289071 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:02:00.312166 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:02:00.312412 140635665344512 replay_runner.py:41] Starting iteration 0
Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 142.55
I0901 13:02:07.327530 140635665344512 replay_runner.py:36] Average training steps per second: 142.55
I0901 13:02:08.539500 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.04
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 192.73
I0901 13:02:13.928440 140635665344512 replay_runner.py:36] Average training steps per second: 192.73
I0901 13:02:14.052617 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 2

Steps executed: 181 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 200.14

Steps executed: 206 Episode length: 8 Return: 8.0.0
I0901 13:02:19.390836 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 8.96
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 197.38
I0901 13:02:24.653292 140635665344512 replay_runner.py:36] Average training steps per second: 197.38
I0901 13:02:24.782196 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 4

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 194.25
I0901 13:02:30.115922 140635665344512 replay_runner.py:36] Average training steps per second: 194.25
I0901 13:02:30.248279 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 5

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 203.84
I0901 13:02:35.344076 140635665344512 replay_runner.py:36] Average training steps per second: 203.84
I0901 13:02:35.477388 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 6

Steps executed: 214 Episode length: 20 Return: 20.0
INFO:tensorflow:Average training steps per second: 190.41
I0901 13:02:40.915211 140635665344512 replay_runner.py:36] Average training steps per second: 190.41
I0901 13:02:41.050837 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.83
INFO:tensorflow:Starting iteration 7

Steps executed: 273 Episode length: 77 Return: 77.0
INFO:tensorflow:Average training steps per second: 201.08
I0901 13:02:46.215639 140635665344512 replay_runner.py:36] Average training steps per second: 201.08
I0901 13:02:46.384878 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.25
INFO:tensorflow:Starting iteration 8
I0901 13:02:46.572386 140635665344512 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.61

Steps executed: 227 Episode length: 123 Return: 123.0
I0901 13:02:51.826793 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 113.50
INFO:tensorflow:Starting iteration 9

Steps executed: 197 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 193.93
I0901 13:02:57.163580 140635665344512 replay_runner.py:36] Average training steps per second: 193.93
I0901 13:02:57.384392 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 10


Steps executed: 222 Episode length: 104 Return: 104.0
INFO:tensorflow:Average training steps per second: 206.98
I0901 13:03:02.397988 140635665344512 replay_runner.py:36] Average training steps per second: 206.98
I0901 13:03:02.528210 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 111.00
INFO:tensorflow:Starting iteration 11

Steps executed: 341 Episode length: 174 Return: 174.0
INFO:tensorflow:Average training steps per second: 200.05
I0901 13:03:07.706656 140635665344512 replay_runner.py:36] Average training steps per second: 200.05
I0901 13:03:07.908558 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 12

Steps executed: 265 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 215.45
I0901 13:03:12.730197 140635665344512 replay_runner.py:36] Average training steps per second: 215.45
I0901 13:03:12.885340 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.98
I0901 13:03:17.997431 140635665344512 replay_runner.py:36] Average training steps per second: 202.98
I0901 13:03:18.115252 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 284 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 204.58
I0901 13:03:23.181760 140635665344512 replay_runner.py:36] Average training steps per second: 204.58
I0901 13:03:23.348769 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 210.46
I0901 13:03:28.282256 140635665344512 replay_runner.py:36] Average training steps per second: 210.46
I0901 13:03:28.397644 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 13:03:28.564160 140635665344512 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 201.49
I0901 13:03:33.527641 140635665344512 replay_runner.py:36] Average training steps per second: 201.49
I0901 13:03:33.647731 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 13:03:33.831570 140635665344512 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 211.83
I0901 13:03:38.552672 140635665344512 replay_runner.py:36] Average training steps per second: 211.83
I0901 13:03:38.673873 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 215 Episode length: 105 Return: 105.0
INFO:tensorflow:Average training steps per second: 206.76
I0901 13:03:43.693738 140635665344512 replay_runner.py:36] Average training steps per second: 206.76
I0901 13:03:43.810858 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.50
INFO:tensorflow:Starting iteration 19

Steps executed: 246 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 222.58
I0901 13:03:48.474190 140635665344512 replay_runner.py:36] Average training steps per second: 222.58
I0901 13:03:48.631764 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 214.39
I0901 13:03:53.510413 140635665344512 replay_runner.py:36] Average training steps per second: 214.39
I0901 13:03:53.622239 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 13:03:53.801625 140635665344512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 213.22
I0901 13:03:58.491924 140635665344512 replay_runner.py:36] Average training steps per second: 213.22
I0901 13:03:58.606235 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 13:03:58.784863 140635665344512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 220.65
I0901 13:04:03.317343 140635665344512 replay_runner.py:36] Average training steps per second: 220.65
I0901 13:04:03.424578 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 13:04:03.603564 140635665344512 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 210.80
I0901 13:04:08.347799 140635665344512 replay_runner.py:36] Average training steps per second: 210.80
I0901 13:04:08.455830 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 294 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 222.03
I0901 13:04:13.133279 140635665344512 replay_runner.py:36] Average training steps per second: 222.03
I0901 13:04:13.298809 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 25

Steps executed: 387 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.46
I0901 13:04:18.167167 140635665344512 replay_runner.py:36] Average training steps per second: 213.46
I0901 13:04:18.373707 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 222.32
I0901 13:04:23.037511 140635665344512 replay_runner.py:36] Average training steps per second: 222.32
I0901 13:04:23.150528 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 13:04:23.324271 140635665344512 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 229.53
I0901 13:04:27.681473 140635665344512 replay_runner.py:36] Average training steps per second: 229.53
I0901 13:04:27.783766 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 13:04:27.953682 140635665344512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 226.03
I0901 13:04:32.378195 140635665344512 replay_runner.py:36] Average training steps per second: 226.03
I0901 13:04:32.477879 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 240.04
I0901 13:04:36.799890 140635665344512 replay_runner.py:36] Average training steps per second: 240.04
I0901 13:04:36.997095 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00