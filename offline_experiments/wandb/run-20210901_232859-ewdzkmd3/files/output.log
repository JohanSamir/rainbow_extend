I0901 23:29:06.295642 139965167532032 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 23:29:06.296434 139965167532032 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 23:29:06.399281 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:06.400654 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:06.400774 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:06.400933 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:06.401027 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:06.401109 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:06.401176 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:06.401233 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:06.401336 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:06.401417 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:06.401630 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:06.401837 139965167532032 dqn_agent.py:283] 	 seed: 1630538946399208
I0901 23:29:06.405026 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:06.405266 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:06.405440 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:06.405637 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:06.405756 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:06.405850 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:06.406026 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:06.406215 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:06.406361 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:29:13.330106 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 23:29:14.667360 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:14.696548 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:29:14.707374 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:14.707645 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:14.707854 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:14.707978 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:14.708086 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:14.708191 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:14.708296 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:14.708402 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:14.708516 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:14.708620 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:14.708720 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:14.708813 139965167532032 dqn_agent.py:283] 	 seed: 1630538954707307
I0901 23:29:14.711651 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:14.711817 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:14.711943 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:14.712067 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:14.712168 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:14.712260 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:14.712353 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:14.712454 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:14.712555 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:29:15.391994 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:15.513975 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:29:15.514345 139965167532032 replay_runner.py:41] Starting iteration 0
Steps executed: 304 Episode length: 120 Return: -311.07648246758964
INFO:tensorflow:Average training steps per second: 140.91
I0901 23:29:22.611268 139965167532032 replay_runner.py:36] Average training steps per second: 140.91
I0901 23:29:23.783107 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.29
INFO:tensorflow:Starting iteration 1

Steps executed: 268 Episode length: 164 Return: -329.74413559903616
INFO:tensorflow:Average training steps per second: 207.79
I0901 23:29:32.864490 139965167532032 replay_runner.py:36] Average training steps per second: 207.79
I0901 23:29:33.131603 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.13
INFO:tensorflow:Starting iteration 2

Steps executed: 407 Episode length: 407 Return: -317.23570317401584
INFO:tensorflow:Average training steps per second: 206.66
I0901 23:29:42.289966 139965167532032 replay_runner.py:36] Average training steps per second: 206.66
I0901 23:29:42.963437 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.24
INFO:tensorflow:Starting iteration 3
I0901 23:29:47.325768 139965167532032 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 210.02

Steps executed: 1000 Episode length: 1000 Return: -137.62476573155254
I0901 23:29:55.862065 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.62
INFO:tensorflow:Starting iteration 4
I0901 23:30:00.308564 139965167532032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 219.35

Steps executed: 1000 Episode length: 1000 Return: -146.51152653770064
I0901 23:30:07.373463 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.51
INFO:tensorflow:Starting iteration 5
I0901 23:30:11.808654 139965167532032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 220.97

Steps executed: 1000 Episode length: 1000 Return: -125.69380268980362
I0901 23:30:18.376947 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.69
INFO:tensorflow:Starting iteration 6
I0901 23:30:22.698161 139965167532032 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 218.04

Steps executed: 1000 Episode length: 1000 Return: -293.19656807818592
I0901 23:30:30.669763 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.20
INFO:tensorflow:Starting iteration 7
I0901 23:30:35.015446 139965167532032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 225.93

Steps executed: 1000 Episode length: 1000 Return: -214.75219263528044
I0901 23:30:43.430439 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.75
INFO:tensorflow:Starting iteration 8
I0901 23:30:47.808843 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 226.31

Steps executed: 1000 Episode length: 1000 Return: -263.74412022463525
I0901 23:30:55.427505 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.74
INFO:tensorflow:Starting iteration 9
I0901 23:30:59.889895 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 224.15

Steps executed: 465 Episode length: 465 Return: -385.9236163105437525
I0901 23:31:05.078793 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -385.92
INFO:tensorflow:Starting iteration 10
I0901 23:31:09.333788 139965167532032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.30

Steps executed: 561 Episode length: 561 Return: -172.2975211235936425
I0901 23:31:15.095218 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.30
INFO:tensorflow:Starting iteration 11

Steps executed: 107 Episode length: 107 Return: -73.39483490921484425
INFO:tensorflow:Average training steps per second: 225.21

Steps executed: 1107 Episode length: 1000 Return: -138.62262730992518
I0901 23:31:27.181723 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.01
INFO:tensorflow:Starting iteration 12
I0901 23:31:31.485820 139965167532032 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 229.52

Steps executed: 688 Episode length: 688 Return: -255.8626810822695518
I0901 23:31:37.672523 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.86
INFO:tensorflow:Starting iteration 13
I0901 23:31:41.980746 139965167532032 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 229.25

Steps executed: 1000 Episode length: 1000 Return: -193.19729042913505
I0901 23:31:49.233524 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.20
INFO:tensorflow:Starting iteration 14
I0901 23:31:53.600751 139965167532032 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 231.00

Steps executed: 1000 Episode length: 1000 Return: -144.27502923759678
I0901 23:32:01.756029 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.28
INFO:tensorflow:Starting iteration 15

Steps executed: 208 Episode length: 208 Return: -54.50093353534087678
INFO:tensorflow:Average training steps per second: 282.61
I0901 23:32:09.483706 139965167532032 replay_runner.py:36] Average training steps per second: 282.61
I0901 23:32:09.640295 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -54.50
INFO:tensorflow:Starting iteration 16
I0901 23:32:13.562919 139965167532032 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 251.26

Steps executed: 1000 Episode length: 1000 Return: -154.11806934043884
I0901 23:32:19.768254 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.12
INFO:tensorflow:Starting iteration 17
I0901 23:32:23.851003 139965167532032 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 231.46

Steps executed: 1000 Episode length: 1000 Return: -172.41964457505474
I0901 23:32:31.547470 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.42
INFO:tensorflow:Starting iteration 18

Steps executed: 269 Episode length: 123 Return: -102.6442292809983674
INFO:tensorflow:Average training steps per second: 223.42
I0901 23:32:41.030007 139965167532032 replay_runner.py:36] Average training steps per second: 223.42
I0901 23:32:41.265426 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.24
INFO:tensorflow:Starting iteration 19

Steps executed: 366 Episode length: 182 Return: -45.72554068145634674
INFO:tensorflow:Average training steps per second: 226.56
I0901 23:32:49.996848 139965167532032 replay_runner.py:36] Average training steps per second: 226.56
I0901 23:32:50.381595 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -38.64
INFO:tensorflow:Starting iteration 20
I0901 23:32:54.675448 139965167532032 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 228.84

Steps executed: 209 Episode length: 56 Return: -29.953560230528453874
I0901 23:32:59.245718 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.05
INFO:tensorflow:Starting iteration 21
I0901 23:33:03.512305 139965167532032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 234.10

Steps executed: 1000 Episode length: 1000 Return: -40.926236124738264
I0901 23:33:11.087436 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.93
INFO:tensorflow:Starting iteration 22
I0901 23:33:15.367145 139965167532032 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 231.17

Steps executed: 1000 Episode length: 1000 Return: -59.628576835283866
I0901 23:33:24.170685 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.63
INFO:tensorflow:Starting iteration 23
I0901 23:33:28.549281 139965167532032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 231.53

Steps executed: 1000 Episode length: 1000 Return: -45.023193948041016
I0901 23:33:36.277373 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -45.02
INFO:tensorflow:Starting iteration 24

Steps executed: 332 Episode length: 212 Return: -243.6533826817938616
INFO:tensorflow:Average training steps per second: 232.74
I0901 23:33:44.965225 139965167532032 replay_runner.py:36] Average training steps per second: 232.74
I0901 23:33:45.297641 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.23
INFO:tensorflow:Starting iteration 25

Steps executed: 176 Episode length: 176 Return: -439.8744875386783616
INFO:tensorflow:Average training steps per second: 232.23

Steps executed: 1176 Episode length: 1000 Return: -76.270923986359996
I0901 23:33:56.962091 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.07
INFO:tensorflow:Starting iteration 26

Steps executed: 239 Episode length: 147 Return: -91.10603681755438996
INFO:tensorflow:Average training steps per second: 231.29
I0901 23:34:05.673066 139965167532032 replay_runner.py:36] Average training steps per second: 231.29
I0901 23:34:05.907927 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.93
INFO:tensorflow:Starting iteration 27
I0901 23:34:10.328791 139965167532032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 233.17

Steps executed: 378 Episode length: 378 Return: 228.08976007101123996
I0901 23:34:15.193801 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 228.09
INFO:tensorflow:Starting iteration 28

Steps executed: 257 Episode length: 257 Return: -71.29002283382778996
INFO:tensorflow:Average training steps per second: 235.14
I0901 23:34:23.765234 139965167532032 replay_runner.py:36] Average training steps per second: 235.14
I0901 23:34:24.045936 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.29
INFO:tensorflow:Starting iteration 29
I0901 23:34:28.505568 139965167532032 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 236.71
I0901 23:34:32.730663 139965167532032 replay_runner.py:36] Average training steps per second: 236.71


Done fixed training!Episode length: 152 Return: -24.01451080496298996