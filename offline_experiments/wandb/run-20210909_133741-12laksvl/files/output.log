I0909 13:37:47.403791 140715251898368 run_experiment.py:549] Creating TrainRunner ...
I0909 13:37:47.413830 140715251898368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:37:47.414136 140715251898368 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:37:47.414307 140715251898368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:37:47.414433 140715251898368 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:37:47.414521 140715251898368 dqn_agent.py:275] 	 update_period: 4
I0909 13:37:47.414636 140715251898368 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:37:47.414708 140715251898368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:37:47.414822 140715251898368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:37:47.414984 140715251898368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:37:47.415125 140715251898368 dqn_agent.py:280] 	 optimizer: adam
I0909 13:37:47.415229 140715251898368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:37:47.415476 140715251898368 dqn_agent.py:283] 	 seed: 1631194667413768
I0909 13:37:47.418123 140715251898368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:37:47.418244 140715251898368 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:37:47.418324 140715251898368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:37:47.418396 140715251898368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:37:47.418550 140715251898368 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:37:47.418697 140715251898368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:37:47.418812 140715251898368 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:37:47.418946 140715251898368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:37:47.419072 140715251898368 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
I0909 13:37:49.018183 140715251898368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:49.444948 140715251898368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:49.459256 140715251898368 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:37:49.467439 140715251898368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:37:49.467630 140715251898368 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:37:49.467731 140715251898368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:37:49.467838 140715251898368 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:37:49.467946 140715251898368 dqn_agent.py:275] 	 update_period: 4
I0909 13:37:49.468045 140715251898368 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:37:49.468125 140715251898368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:37:49.468244 140715251898368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:37:49.468376 140715251898368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:37:49.468567 140715251898368 dqn_agent.py:280] 	 optimizer: adam
I0909 13:37:49.468744 140715251898368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:37:49.468855 140715251898368 dqn_agent.py:283] 	 seed: 1631194669467391
I0909 13:37:49.471112 140715251898368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:37:49.471264 140715251898368 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:37:49.471374 140715251898368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:37:49.471436 140715251898368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:37:49.471493 140715251898368 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:37:49.471735 140715251898368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:37:49.471815 140715251898368 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:37:49.471988 140715251898368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:37:49.472062 140715251898368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:37:49.507031 140715251898368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:37:49.528868 140715251898368 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:37:49.529217 140715251898368 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 139.98
I0909 13:37:56.673629 140715251898368 replay_runner.py:36] Average training steps per second: 139.98
Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:37:58.345414 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:37:58.474226 140715251898368 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 183.94
I0909 13:38:03.911544 140715251898368 replay_runner.py:36] Average training steps per second: 183.94
I0909 13:38:04.470438 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:38:04.591767 140715251898368 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.83
I0909 13:38:09.973504 140715251898368 replay_runner.py:36] Average training steps per second: 185.83
I0909 13:38:10.508650 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:38:10.651816 140715251898368 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 183.98
I0909 13:38:16.087620 140715251898368 replay_runner.py:36] Average training steps per second: 183.98
I0909 13:38:16.641119 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:38:16.768640 140715251898368 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 185.35
I0909 13:38:22.164171 140715251898368 replay_runner.py:36] Average training steps per second: 185.35
I0909 13:38:22.732293 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:38:22.867382 140715251898368 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 184.30
I0909 13:38:28.293737 140715251898368 replay_runner.py:36] Average training steps per second: 184.30
I0909 13:38:28.832966 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:38:28.974334 140715251898368 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 184.87
I0909 13:38:34.383924 140715251898368 replay_runner.py:36] Average training steps per second: 184.87
I0909 13:38:34.942834 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:38:35.074760 140715251898368 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 184.34
I0909 13:38:40.500191 140715251898368 replay_runner.py:36] Average training steps per second: 184.34
I0909 13:38:41.067481 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:38:41.221097 140715251898368 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 182.52
I0909 13:38:46.700154 140715251898368 replay_runner.py:36] Average training steps per second: 182.52
I0909 13:38:47.245216 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9

Steps executed: 227 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 183.32
I0909 13:38:52.824643 140715251898368 replay_runner.py:36] Average training steps per second: 183.32
I0909 13:38:53.037473 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 10

Steps executed: 686 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 186.27
I0909 13:38:58.541294 140715251898368 replay_runner.py:36] Average training steps per second: 186.27
I0909 13:38:59.165845 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.00
INFO:tensorflow:Starting iteration 11

Steps executed: 121 Episode length: 121 Return: -121.0
INFO:tensorflow:Average training steps per second: 181.56

Steps executed: 721 Episode length: 600 Return: -600.0
I0909 13:39:05.477243 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.50
INFO:tensorflow:Starting iteration 12
I0909 13:39:05.611909 140715251898368 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 178.19

Steps executed: 213 Episode length: 106 Return: -106.0
I0909 13:39:11.417385 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 13
I0909 13:39:11.551222 140715251898368 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 185.31

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:39:17.467873 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14

Steps executed: 233 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 186.97
I0909 13:39:22.944253 140715251898368 replay_runner.py:36] Average training steps per second: 186.97
I0909 13:39:23.156429 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 15

Steps executed: 213 Episode length: 106 Return: -106.0
INFO:tensorflow:Average training steps per second: 184.37
I0909 13:39:28.730084 140715251898368 replay_runner.py:36] Average training steps per second: 184.37
I0909 13:39:28.925932 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 16

Steps executed: 259 Episode length: 83 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 185.31
I0909 13:39:34.451834 140715251898368 replay_runner.py:36] Average training steps per second: 185.31
I0909 13:39:34.680246 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 17

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 181.38
I0909 13:39:40.320831 140715251898368 replay_runner.py:36] Average training steps per second: 181.38
I0909 13:39:40.812067 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18

Steps executed: 210 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 185.54
I0909 13:39:46.330094 140715251898368 replay_runner.py:36] Average training steps per second: 185.54
I0909 13:39:46.508865 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 19

Steps executed: 206 Episode length: 123 Return: -123.0
INFO:tensorflow:Average training steps per second: 185.87
I0909 13:39:52.016805 140715251898368 replay_runner.py:36] Average training steps per second: 185.87
I0909 13:39:52.195455 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 20

Steps executed: 230 Episode length: 115 Return: -115.0
INFO:tensorflow:Average training steps per second: 183.09
I0909 13:39:57.779438 140715251898368 replay_runner.py:36] Average training steps per second: 183.09
I0909 13:39:57.970294 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 21
I0909 13:39:58.092617 140715251898368 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 183.76

Steps executed: 222 Episode length: 112 Return: -112.0
I0909 13:40:03.734772 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 22

Steps executed: 250 Episode length: 105 Return: -105.0
INFO:tensorflow:Average training steps per second: 183.98
I0909 13:40:09.296869 140715251898368 replay_runner.py:36] Average training steps per second: 183.98
I0909 13:40:09.495777 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 23

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 183.82
I0909 13:40:15.056304 140715251898368 replay_runner.py:36] Average training steps per second: 183.82
I0909 13:40:15.559530 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24

Steps executed: 253 Episode length: 128 Return: -128.0
INFO:tensorflow:Average training steps per second: 184.37
I0909 13:40:21.115233 140715251898368 replay_runner.py:36] Average training steps per second: 184.37
I0909 13:40:21.347128 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 25

Steps executed: 235 Episode length: 117 Return: -117.0
INFO:tensorflow:Average training steps per second: 188.42
I0909 13:40:26.815296 140715251898368 replay_runner.py:36] Average training steps per second: 188.42
I0909 13:40:26.995642 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 26

Steps executed: 275 Episode length: 90 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 190.98
I0909 13:40:32.364257 140715251898368 replay_runner.py:36] Average training steps per second: 190.98
I0909 13:40:32.568258 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 27

Steps executed: 232 Episode length: 120 Return: -120.0
INFO:tensorflow:Average training steps per second: 208.57
I0909 13:40:37.489499 140715251898368 replay_runner.py:36] Average training steps per second: 208.57
I0909 13:40:37.643578 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 28
I0909 13:40:37.751582 140715251898368 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 249.06

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:40:42.095705 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 255.24
I0909 13:40:46.110752 140715251898368 replay_runner.py:36] Average training steps per second: 255.24
I0909 13:40:46.423551 140715251898368 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00