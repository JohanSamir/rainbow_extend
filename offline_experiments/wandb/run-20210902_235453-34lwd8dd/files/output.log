Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0902 23:55:00.403555 140260243740672 run_experiment.py:549] Creating TrainRunner ...
I0902 23:55:00.413698 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:00.414083 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:00.414315 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:00.414448 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:00.414535 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:00.414606 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:55:00.414661 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:00.414766 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:00.414873 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:00.415070 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:00.415253 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:00.415390 140260243740672 dqn_agent.py:283] 	 seed: 1630626900413618
I0902 23:55:00.418703 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:00.418873 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:55:00.419003 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:00.419090 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:00.419230 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:00.419328 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:00.419399 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:00.419452 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:00.419535 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:00.454923 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:01.003110 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:01.017286 140260243740672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:55:01.026425 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:55:01.026649 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:55:01.026813 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:55:01.026929 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:55:01.027060 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:55:01.027176 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:55:01.027292 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:55:01.027456 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:55:01.027677 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:55:01.027948 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:55:01.028077 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:55:01.028203 140260243740672 dqn_agent.py:283] 	 seed: 1630626901026378
I0902 23:55:01.030788 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:55:01.030950 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:55:01.031040 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:55:01.031163 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:55:01.031271 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:55:01.031348 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:55:01.031425 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:55:01.031493 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:55:01.031589 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:55:01.065289 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:55:01.087213 140260243740672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:55:01.087542 140260243740672 replay_runner.py:41] Starting iteration 0
Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 142.49
I0902 23:55:08.105877 140260243740672 replay_runner.py:36] Average training steps per second: 142.49
I0902 23:55:09.257815 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.94
INFO:tensorflow:Starting iteration 1

Steps executed: 395 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.67
I0902 23:55:14.476640 140260243740672 replay_runner.py:36] Average training steps per second: 198.67
I0902 23:55:14.751584 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.50
INFO:tensorflow:Starting iteration 2

Steps executed: 254 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 208.54
I0902 23:55:19.733346 140260243740672 replay_runner.py:36] Average training steps per second: 208.54
I0902 23:55:19.913041 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.67
INFO:tensorflow:Starting iteration 3

Steps executed: 255 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Average training steps per second: 201.52
I0902 23:55:25.061432 140260243740672 replay_runner.py:36] Average training steps per second: 201.52
I0902 23:55:25.244781 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 85.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.49
I0902 23:55:30.470086 140260243740672 replay_runner.py:36] Average training steps per second: 198.49
I0902 23:55:30.605666 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 242 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 191.96
I0902 23:55:36.005726 140260243740672 replay_runner.py:36] Average training steps per second: 191.96
I0902 23:55:36.166644 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.00
INFO:tensorflow:Starting iteration 6

Steps executed: 314 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 199.74
I0902 23:55:41.359509 140260243740672 replay_runner.py:36] Average training steps per second: 199.74
I0902 23:55:41.573681 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.45
I0902 23:55:46.856647 140260243740672 replay_runner.py:36] Average training steps per second: 196.45
I0902 23:55:46.995030 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 299 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 206.46
I0902 23:55:52.033751 140260243740672 replay_runner.py:36] Average training steps per second: 206.46
I0902 23:55:52.235646 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 9

Steps executed: 266 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 205.86
I0902 23:55:57.287374 140260243740672 replay_runner.py:36] Average training steps per second: 205.86
I0902 23:55:57.460471 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 10

Steps executed: 315 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 203.17
I0902 23:56:02.564680 140260243740672 replay_runner.py:36] Average training steps per second: 203.17
I0902 23:56:02.766375 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 11

Steps executed: 255 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 200.57
I0902 23:56:07.936064 140260243740672 replay_runner.py:36] Average training steps per second: 200.57
I0902 23:56:08.100669 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 209.91
I0902 23:56:13.110690 140260243740672 replay_runner.py:36] Average training steps per second: 209.91
I0902 23:56:13.314068 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 13
I0902 23:56:13.493533 140260243740672 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.90

Steps executed: 253 Episode length: 129 Return: 129.0
I0902 23:56:18.766762 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 126.50
INFO:tensorflow:Starting iteration 14

Steps executed: 250 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 200.89
I0902 23:56:23.924234 140260243740672 replay_runner.py:36] Average training steps per second: 200.89
I0902 23:56:24.102321 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.15
I0902 23:56:29.449600 140260243740672 replay_runner.py:36] Average training steps per second: 194.15
I0902 23:56:29.585473 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:56:29.755885 140260243740672 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.75
I0902 23:56:34.865024 140260243740672 replay_runner.py:36] Average training steps per second: 195.75
I0902 23:56:35.014592 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:56:35.213536 140260243740672 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 193.66

Steps executed: 369 Episode length: 178 Return: 178.0
I0902 23:56:40.645664 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.89
I0902 23:56:46.089189 140260243740672 replay_runner.py:36] Average training steps per second: 189.89
I0902 23:56:46.245645 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.11
I0902 23:56:51.562760 140260243740672 replay_runner.py:36] Average training steps per second: 196.11
I0902 23:56:51.815199 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.04
I0902 23:56:57.129223 140260243740672 replay_runner.py:36] Average training steps per second: 195.04
I0902 23:56:57.264592 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:56:57.433278 140260243740672 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 202.32
I0902 23:57:02.376412 140260243740672 replay_runner.py:36] Average training steps per second: 202.32
I0902 23:57:02.513905 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:57:02.690789 140260243740672 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 188.92
I0902 23:57:07.984307 140260243740672 replay_runner.py:36] Average training steps per second: 188.92
I0902 23:57:08.135029 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 369 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 196.22
I0902 23:57:13.432745 140260243740672 replay_runner.py:36] Average training steps per second: 196.22
I0902 23:57:13.678932 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.73
I0902 23:57:19.081020 140260243740672 replay_runner.py:36] Average training steps per second: 191.73
I0902 23:57:19.214729 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:57:19.398309 140260243740672 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.77
I0902 23:57:24.258533 140260243740672 replay_runner.py:36] Average training steps per second: 205.77
I0902 23:57:24.391896 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:57:24.575033 140260243740672 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.85
I0902 23:57:29.655501 140260243740672 replay_runner.py:36] Average training steps per second: 196.85
I0902 23:57:29.792338 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:57:29.983125 140260243740672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 207.47
I0902 23:57:34.803451 140260243740672 replay_runner.py:36] Average training steps per second: 207.47
I0902 23:57:34.932195 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:57:35.125156 140260243740672 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.77
I0902 23:57:40.207725 140260243740672 replay_runner.py:36] Average training steps per second: 196.77
I0902 23:57:40.342198 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.87
I0902 23:57:45.482813 140260243740672 replay_runner.py:36] Average training steps per second: 201.87
I0902 23:57:45.605917 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00