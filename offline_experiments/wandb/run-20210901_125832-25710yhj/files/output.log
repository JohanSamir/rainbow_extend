Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0901 12:58:39.407321 139796751951872 run_experiment.py:549] Creating TrainRunner ...
I0901 12:58:39.423395 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:58:39.423687 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:58:39.424401 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:58:39.424685 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:58:39.425949 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:58:39.426200 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:58:39.427681 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:58:39.427832 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:58:39.428263 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:58:39.428419 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:58:39.429471 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:58:39.429584 139796751951872 dqn_agent.py:283] 	 seed: 1630501119423318
I0901 12:58:39.436593 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:58:39.436787 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:58:39.436970 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:58:39.437315 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:58:39.437692 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:58:39.437891 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:58:39.438070 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:58:39.438276 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:58:39.439221 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:58:39.634971 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:58:40.188586 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:58:40.203989 139796751951872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:58:40.214251 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:58:40.214547 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:58:40.214735 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:58:40.214952 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:58:40.215149 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:58:40.215348 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:58:40.215486 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:58:40.215606 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:58:40.215740 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:58:40.215887 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:58:40.215987 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:58:40.216118 139796751951872 dqn_agent.py:283] 	 seed: 1630501120214180
I0901 12:58:40.219208 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:58:40.219384 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:58:40.219482 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:58:40.219592 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:58:40.219669 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:58:40.219810 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:58:40.219896 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:58:40.219948 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:58:40.220000 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:58:40.256399 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:58:40.279450 139796751951872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:58:40.279803 139796751951872 replay_runner.py:41] Starting iteration 0
Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 139.20
I0901 12:58:47.464200 139796751951872 replay_runner.py:36] Average training steps per second: 139.20
I0901 12:58:48.735966 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1

Steps executed: 201 Episode length: 17 Return: 17.0
INFO:tensorflow:Average training steps per second: 185.93
I0901 12:58:54.316797 139796751951872 replay_runner.py:36] Average training steps per second: 185.93
I0901 12:58:54.463428 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 16.75
INFO:tensorflow:Starting iteration 2

Steps executed: 224 Episode length: 47 Return: 47.0
INFO:tensorflow:Average training steps per second: 185.12
I0901 12:59:00.054944 139796751951872 replay_runner.py:36] Average training steps per second: 185.12
I0901 12:59:00.224418 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 44.80
INFO:tensorflow:Starting iteration 3

Steps executed: 338 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.73
I0901 12:59:05.782548 139796751951872 replay_runner.py:36] Average training steps per second: 186.73
I0901 12:59:06.041639 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 4

Steps executed: 235 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Average training steps per second: 182.84
I0901 12:59:11.699803 139796751951872 replay_runner.py:36] Average training steps per second: 182.84
I0901 12:59:11.870239 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 78.33
INFO:tensorflow:Starting iteration 5

Steps executed: 252 Episode length: 80 Return: 80.0.0
INFO:tensorflow:Average training steps per second: 187.36
I0901 12:59:17.410743 139796751951872 replay_runner.py:36] Average training steps per second: 187.36
I0901 12:59:17.586536 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.00
INFO:tensorflow:Starting iteration 6

Steps executed: 192 Episode length: 93 Return: 93.0.0
INFO:tensorflow:Average training steps per second: 189.47
I0901 12:59:23.064590 139796751951872 replay_runner.py:36] Average training steps per second: 189.47

Steps executed: 283 Episode length: 91 Return: 91.0.0
INFO:tensorflow:Starting iteration 7

Steps executed: 319 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 188.10
I0901 12:59:28.777466 139796751951872 replay_runner.py:36] Average training steps per second: 188.10
I0901 12:59:29.003569 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.50
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 183.64
I0901 12:59:34.647944 139796751951872 replay_runner.py:36] Average training steps per second: 183.64
I0901 12:59:34.802294 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 270 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 190.64
I0901 12:59:40.248935 139796751951872 replay_runner.py:36] Average training steps per second: 190.64
I0901 12:59:40.454278 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 10

Steps executed: 375 Episode length: 186 Return: 186.0
INFO:tensorflow:Average training steps per second: 184.93
I0901 12:59:46.061853 139796751951872 replay_runner.py:36] Average training steps per second: 184.93
I0901 12:59:46.305628 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 11

Steps executed: 347 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 189.29
I0901 12:59:51.762289 139796751951872 replay_runner.py:36] Average training steps per second: 189.29
I0901 12:59:52.008643 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 12
I0901 12:59:52.241364 139796751951872 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 189.78

Steps executed: 328 Episode length: 157 Return: 157.0
I0901 12:59:57.744453 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.85
I0901 13:00:03.207154 139796751951872 replay_runner.py:36] Average training steps per second: 189.85
I0901 13:00:03.346856 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 157 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 185.82
I0901 13:00:08.921833 139796751951872 replay_runner.py:36] Average training steps per second: 185.82
I0901 13:00:09.201279 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 15


Steps executed: 360 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 197.09
I0901 13:00:14.470683 139796751951872 replay_runner.py:36] Average training steps per second: 197.09
I0901 13:00:14.724190 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 16

Steps executed: 308 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 189.27
I0901 13:00:20.207292 139796751951872 replay_runner.py:36] Average training steps per second: 189.27
I0901 13:00:20.464616 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.20
I0901 13:00:26.033918 139796751951872 replay_runner.py:36] Average training steps per second: 186.20
I0901 13:00:26.187818 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 13:00:26.385880 139796751951872 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 180.55
I0901 13:00:31.924950 139796751951872 replay_runner.py:36] Average training steps per second: 180.55
I0901 13:00:32.059304 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 13:00:32.256488 139796751951872 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 182.92
I0901 13:00:37.723929 139796751951872 replay_runner.py:36] Average training steps per second: 182.92
I0901 13:00:37.874746 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 13:00:38.075569 139796751951872 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 184.28
I0901 13:00:43.502572 139796751951872 replay_runner.py:36] Average training steps per second: 184.28
I0901 13:00:43.646669 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 13:00:43.841386 139796751951872 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 184.79
I0901 13:00:49.253226 139796751951872 replay_runner.py:36] Average training steps per second: 184.79
I0901 13:00:49.403037 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 13:00:49.586284 139796751951872 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 181.26
I0901 13:00:55.103696 139796751951872 replay_runner.py:36] Average training steps per second: 181.26
I0901 13:00:55.261395 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 13:00:55.465323 139796751951872 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 183.77
I0901 13:01:00.907381 139796751951872 replay_runner.py:36] Average training steps per second: 183.77
I0901 13:01:01.056105 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 376 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 180.15
I0901 13:01:06.810680 139796751951872 replay_runner.py:36] Average training steps per second: 180.15
I0901 13:01:07.082261 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.86
I0901 13:01:12.635031 139796751951872 replay_runner.py:36] Average training steps per second: 186.86
I0901 13:01:12.787192 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 13:01:12.978896 139796751951872 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 184.33
I0901 13:01:18.404392 139796751951872 replay_runner.py:36] Average training steps per second: 184.33
I0901 13:01:18.549969 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 374 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.14
I0901 13:01:24.179185 139796751951872 replay_runner.py:36] Average training steps per second: 184.14
I0901 13:01:24.456217 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.78
I0901 13:01:30.015426 139796751951872 replay_runner.py:36] Average training steps per second: 186.78
I0901 13:01:30.161876 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 13:01:30.355672 139796751951872 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 189.43
I0901 13:01:35.634937 139796751951872 replay_runner.py:36] Average training steps per second: 189.43

Done fixed training!Episode length: 200 Return: 200.0