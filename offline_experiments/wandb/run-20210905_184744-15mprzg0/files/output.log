I0905 18:47:51.504618 139666636298240 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.505166 139666636298240 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.578372 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.579493 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.579574 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.579637 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.579693 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.579783 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:51.579935 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.579994 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.580084 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.580136 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.580224 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.580335 139666636298240 dqn_agent.py:283] 	 seed: 1630867671578312
I0905 18:47:51.582088 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.582211 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:51.582274 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.582335 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.582390 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.582441 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.582490 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.582538 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.582587 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.753727 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0905 18:47:53.091971 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.117465 139666636298240 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:53.122868 139666636298240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:53.123018 139666636298240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:53.123092 139666636298240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:53.123151 139666636298240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:53.123205 139666636298240 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:53.123275 139666636298240 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:53.123331 139666636298240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:53.123410 139666636298240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:53.123477 139666636298240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:53.123552 139666636298240 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:53.123623 139666636298240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:53.123694 139666636298240 dqn_agent.py:283] 	 seed: 1630867673122831
I0905 18:47:53.125178 139666636298240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:53.125296 139666636298240 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:53.125365 139666636298240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:53.125426 139666636298240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:53.125482 139666636298240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:53.125578 139666636298240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:53.125657 139666636298240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:53.125725 139666636298240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:53.125793 139666636298240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:53.140856 139666636298240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.150232 139666636298240 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:53.150392 139666636298240 replay_runner.py:41] Starting iteration 0
Steps executed: 253 Episode length: 124 Return: -232.69421946606886
INFO:tensorflow:Average training steps per second: 316.94
I0905 18:47:56.305738 139666636298240 replay_runner.py:36] Average training steps per second: 316.94
I0905 18:47:56.956011 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.86
INFO:tensorflow:Starting iteration 1

Steps executed: 216 Episode length: 135 Return: -383.64589128525366
INFO:tensorflow:Average training steps per second: 405.11
I0905 18:48:02.513722 139666636298240 replay_runner.py:36] Average training steps per second: 405.11
I0905 18:48:02.613806 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.40
INFO:tensorflow:Starting iteration 2

Steps executed: 348 Episode length: 219 Return: -151.12814177773456
INFO:tensorflow:Average training steps per second: 410.97
I0905 18:48:08.128729 139666636298240 replay_runner.py:36] Average training steps per second: 410.97
I0905 18:48:08.290992 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.25
INFO:tensorflow:Starting iteration 3

Steps executed: 212 Episode length: 81 Return: -231.352316224114676
INFO:tensorflow:Average training steps per second: 410.63
I0905 18:48:13.815634 139666636298240 replay_runner.py:36] Average training steps per second: 410.63
I0905 18:48:13.902690 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.76
INFO:tensorflow:Starting iteration 4

Steps executed: 283 Episode length: 132 Return: -337.51736054995696
INFO:tensorflow:Average training steps per second: 418.06
I0905 18:48:19.387831 139666636298240 replay_runner.py:36] Average training steps per second: 418.06
I0905 18:48:19.510440 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.41
INFO:tensorflow:Starting iteration 5

Steps executed: 321 Episode length: 148 Return: -246.67813803601152
INFO:tensorflow:Average training steps per second: 417.31
I0905 18:48:25.005419 139666636298240 replay_runner.py:36] Average training steps per second: 417.31
I0905 18:48:25.158951 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.34
INFO:tensorflow:Starting iteration 6

Steps executed: 276 Episode length: 101 Return: -385.69061463099564
INFO:tensorflow:Average training steps per second: 418.46
I0905 18:48:30.649204 139666636298240 replay_runner.py:36] Average training steps per second: 418.46
I0905 18:48:30.754499 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.20
INFO:tensorflow:Starting iteration 7

Steps executed: 233 Episode length: 137 Return: -203.95817603505307
INFO:tensorflow:Average training steps per second: 421.58
I0905 18:48:36.209083 139666636298240 replay_runner.py:36] Average training steps per second: 421.58
I0905 18:48:36.301498 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.39
INFO:tensorflow:Starting iteration 8

Steps executed: 215 Episode length: 86 Return: -187.019945845424057
INFO:tensorflow:Average training steps per second: 419.81
I0905 18:48:41.766721 139666636298240 replay_runner.py:36] Average training steps per second: 419.81
I0905 18:48:41.845943 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.49
INFO:tensorflow:Starting iteration 9

Steps executed: 236 Episode length: 136 Return: -251.69825591492324
INFO:tensorflow:Average training steps per second: 417.41
I0905 18:48:47.317960 139666636298240 replay_runner.py:36] Average training steps per second: 417.41
I0905 18:48:47.424945 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.96
INFO:tensorflow:Starting iteration 10

Steps executed: 250 Episode length: 107 Return: -62.855389159917934
INFO:tensorflow:Average training steps per second: 410.89
I0905 18:48:52.940104 139666636298240 replay_runner.py:36] Average training steps per second: 410.89
I0905 18:48:53.041380 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.36
INFO:tensorflow:Starting iteration 11

Steps executed: 205 Episode length: 104 Return: -306.56035586583298
INFO:tensorflow:Average training steps per second: 413.71
I0905 18:48:58.538740 139666636298240 replay_runner.py:36] Average training steps per second: 413.71
I0905 18:48:58.608384 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.64
INFO:tensorflow:Starting iteration 12

Steps executed: 262 Episode length: 66 Return: -229.060153771470288
INFO:tensorflow:Average training steps per second: 421.55
I0905 18:49:04.065464 139666636298240 replay_runner.py:36] Average training steps per second: 421.55
I0905 18:49:04.166265 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.33
INFO:tensorflow:Starting iteration 13

Steps executed: 287 Episode length: 156 Return: -197.13232224695884
INFO:tensorflow:Average training steps per second: 418.40
I0905 18:49:09.638251 139666636298240 replay_runner.py:36] Average training steps per second: 418.40
I0905 18:49:09.780837 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -424.49
INFO:tensorflow:Starting iteration 14

Steps executed: 243 Episode length: 102 Return: -158.07398835375936
INFO:tensorflow:Average training steps per second: 411.83
I0905 18:49:15.293968 139666636298240 replay_runner.py:36] Average training steps per second: 411.83
I0905 18:49:15.386602 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.19
INFO:tensorflow:Starting iteration 15

Steps executed: 282 Episode length: 282 Return: -528.30639425285156
INFO:tensorflow:Average training steps per second: 411.49
I0905 18:49:20.900390 139666636298240 replay_runner.py:36] Average training steps per second: 411.49
I0905 18:49:21.071296 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -528.31
INFO:tensorflow:Starting iteration 16

Steps executed: 273 Episode length: 93 Return: -259.405130998040246
INFO:tensorflow:Average training steps per second: 448.23
I0905 18:49:26.355415 139666636298240 replay_runner.py:36] Average training steps per second: 448.23
I0905 18:49:26.467713 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.47
INFO:tensorflow:Starting iteration 17

Steps executed: 288 Episode length: 120 Return: -112.07594888607423
INFO:tensorflow:Average training steps per second: 321.14
I0905 18:49:32.603816 139666636298240 replay_runner.py:36] Average training steps per second: 321.14
I0905 18:49:32.808701 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.23
INFO:tensorflow:Starting iteration 18
I0905 18:49:36.359506 139666636298240 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 309.27

Steps executed: 202 Episode length: 88 Return: -231.660708375520584
I0905 18:49:39.710417 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.97
INFO:tensorflow:Starting iteration 19

Steps executed: 269 Episode length: 99 Return: -242.827430615676974
INFO:tensorflow:Average training steps per second: 242.83
I0905 18:49:47.851735 139666636298240 replay_runner.py:36] Average training steps per second: 242.83
I0905 18:49:48.022345 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.55
INFO:tensorflow:Starting iteration 20

Steps executed: 287 Episode length: 189 Return: -367.22017408136954
INFO:tensorflow:Average training steps per second: 242.03
I0905 18:49:56.412728 139666636298240 replay_runner.py:36] Average training steps per second: 242.03
I0905 18:49:56.640792 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.49
INFO:tensorflow:Starting iteration 21

Steps executed: 213 Episode length: 49 Return: -405.878181663881544
INFO:tensorflow:Average training steps per second: 240.85
I0905 18:50:05.073839 139666636298240 replay_runner.py:36] Average training steps per second: 240.85
I0905 18:50:05.241530 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -471.56
INFO:tensorflow:Starting iteration 22
I0905 18:50:09.504032 139666636298240 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 245.42

Steps executed: 405 Episode length: 236 Return: -469.50267179962124
I0905 18:50:13.907655 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.85
INFO:tensorflow:Starting iteration 23

Steps executed: 232 Episode length: 50 Return: -426.624342038721474
INFO:tensorflow:Average training steps per second: 239.82
I0905 18:50:22.356902 139666636298240 replay_runner.py:36] Average training steps per second: 239.82
I0905 18:50:22.523028 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -437.93
INFO:tensorflow:Starting iteration 24
I0905 18:50:26.794787 139666636298240 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 241.63

Steps executed: 1000 Episode length: 1000 Return: -42.79968425013497
I0905 18:50:34.226380 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.80
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 249 Return: -238.631200693418387
INFO:tensorflow:Average training steps per second: 241.33
I0905 18:50:42.603400 139666636298240 replay_runner.py:36] Average training steps per second: 241.33
I0905 18:50:42.843253 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.63
INFO:tensorflow:Starting iteration 26

Steps executed: 226 Episode length: 136 Return: -476.173742725569647
INFO:tensorflow:Average training steps per second: 238.39
I0905 18:50:51.309281 139666636298240 replay_runner.py:36] Average training steps per second: 238.39
I0905 18:50:51.471728 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.37
INFO:tensorflow:Starting iteration 27

Steps executed: 294 Episode length: 118 Return: -465.372580444357347
INFO:tensorflow:Average training steps per second: 239.37
I0905 18:50:59.860663 139666636298240 replay_runner.py:36] Average training steps per second: 239.37
I0905 18:51:00.076285 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.23
INFO:tensorflow:Starting iteration 28

Steps executed: 265 Episode length: 206 Return: -239.852769429195147
INFO:tensorflow:Average training steps per second: 237.66
I0905 18:51:08.572195 139666636298240 replay_runner.py:36] Average training steps per second: 237.66
I0905 18:51:08.777858 139666636298240 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.32
INFO:tensorflow:Starting iteration 29

Steps executed: 240 Episode length: 87 Return: -271.0573651518461367
INFO:tensorflow:Average training steps per second: 244.02
I0905 18:51:17.157674 139666636298240 replay_runner.py:36] Average training steps per second: 244.02

Done fixed training!Episode length: 87 Return: -271.0573651518461367