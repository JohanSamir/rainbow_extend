I0910 11:20:54.940559 139711396034560 run_experiment.py:549] Creating TrainRunner ...
I0910 11:20:54.947563 139711396034560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:20:54.947698 139711396034560 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:20:54.947770 139711396034560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:20:54.947892 139711396034560 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:20:54.947994 139711396034560 dqn_agent.py:275] 	 update_period: 4
I0910 11:20:54.948069 139711396034560 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:20:54.948141 139711396034560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:20:54.948204 139711396034560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:20:54.948277 139711396034560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:20:54.948379 139711396034560 dqn_agent.py:280] 	 optimizer: adam
I0910 11:20:54.948452 139711396034560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:20:54.948527 139711396034560 dqn_agent.py:283] 	 seed: 1631272854947524
I0910 11:20:54.950378 139711396034560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:20:54.950493 139711396034560 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:20:54.950567 139711396034560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:20:54.950632 139711396034560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:20:54.950688 139711396034560 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:20:54.950761 139711396034560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:20:54.950846 139711396034560 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:20:54.950912 139711396034560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:20:54.950981 139711396034560 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:20:55.041011 139711396034560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:20:55.059424 139711396034560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:20:55.059582 139711396034560 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:20:55.059648 139711396034560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:20:55.059728 139711396034560 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:20:55.059793 139711396034560 dqn_agent.py:275] 	 update_period: 4
I0910 11:20:55.059847 139711396034560 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:20:55.059897 139711396034560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:20:55.059990 139711396034560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:20:55.060060 139711396034560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:20:55.060127 139711396034560 dqn_agent.py:280] 	 optimizer: adam
I0910 11:20:55.060194 139711396034560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:20:55.060259 139711396034560 dqn_agent.py:283] 	 seed: 1631272855059384
I0910 11:20:55.061664 139711396034560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:20:55.061779 139711396034560 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:20:55.061856 139711396034560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:20:55.061914 139711396034560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:20:55.061968 139711396034560 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:20:55.062052 139711396034560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:20:55.062109 139711396034560 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:20:55.062191 139711396034560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:20:55.062258 139711396034560 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:20:55.084036 139711396034560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:20:55.097777 139711396034560 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:20:55.097974 139711396034560 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 823058.08
I0910 11:20:55.099356 139711396034560 replay_runner.py:39] Average training steps per second: 823058.08
I0910 11:20:56.139900 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:20:56.209355 139711396034560 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 838022.78
I0910 11:20:56.210817 139711396034560 replay_runner.py:39] Average training steps per second: 838022.78
I0910 11:20:56.379798 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:20:56.441683 139711396034560 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 891835.85
I0910 11:20:56.443016 139711396034560 replay_runner.py:39] Average training steps per second: 891835.85
I0910 11:20:56.608336 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:20:56.672414 139711396034560 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 846820.92
I0910 11:20:56.673823 139711396034560 replay_runner.py:39] Average training steps per second: 846820.92
I0910 11:20:56.854762 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Loaded trained dqn in mountaincar
Training fixed agent 6, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 4
I0910 11:20:56.924376 139711396034560 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 812534.68
I0910 11:20:56.925863 139711396034560 replay_runner.py:39] Average training steps per second: 812534.68
I0910 11:20:57.134646 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:20:57.200541 139711396034560 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 846991.92
I0910 11:20:57.201949 139711396034560 replay_runner.py:39] Average training steps per second: 846991.92
I0910 11:20:57.380412 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:20:57.490306 139711396034560 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 339235.20
I0910 11:20:57.501614 139711396034560 replay_runner.py:39] Average training steps per second: 339235.20
I0910 11:20:57.735996 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:20:57.802659 139711396034560 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 827768.70
I0910 11:20:57.804086 139711396034560 replay_runner.py:39] Average training steps per second: 827768.70
I0910 11:20:57.976810 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:20:58.043185 139711396034560 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 798915.05
I0910 11:20:58.044668 139711396034560 replay_runner.py:39] Average training steps per second: 798915.05
I0910 11:20:58.234785 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:20:58.304453 139711396034560 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 659378.09
I0910 11:20:58.306249 139711396034560 replay_runner.py:39] Average training steps per second: 659378.09
I0910 11:20:58.494607 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:20:58.566210 139711396034560 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 798915.05
I0910 11:20:58.567707 139711396034560 replay_runner.py:39] Average training steps per second: 798915.05
I0910 11:20:58.748366 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:20:58.816978 139711396034560 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 813164.79
I0910 11:20:58.818430 139711396034560 replay_runner.py:39] Average training steps per second: 813164.79
I0910 11:20:59.012148 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:20:59.079228 139711396034560 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 794375.76
I0910 11:20:59.080745 139711396034560 replay_runner.py:39] Average training steps per second: 794375.76
I0910 11:20:59.257371 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:20:59.328479 139711396034560 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 724529.97
I0910 11:20:59.330129 139711396034560 replay_runner.py:39] Average training steps per second: 724529.97
I0910 11:20:59.513625 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:20:59.583184 139711396034560 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 739084.41
I0910 11:20:59.584794 139711396034560 replay_runner.py:39] Average training steps per second: 739084.41
I0910 11:20:59.767123 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:20:59.837322 139711396034560 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 813480.22
I0910 11:20:59.838788 139711396034560 replay_runner.py:39] Average training steps per second: 813480.22
I0910 11:21:00.026273 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:21:00.093682 139711396034560 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 821768.03
I0910 11:21:00.095149 139711396034560 replay_runner.py:39] Average training steps per second: 821768.03
I0910 11:21:00.286888 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:21:00.353387 139711396034560 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 795430.31
I0910 11:21:00.354931 139711396034560 replay_runner.py:39] Average training steps per second: 795430.31
I0910 11:21:00.557603 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:21:00.625014 139711396034560 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 822251.32
I0910 11:21:00.626484 139711396034560 replay_runner.py:39] Average training steps per second: 822251.32
I0910 11:21:00.835825 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:21:00.907227 139711396034560 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 712347.83
I0910 11:21:00.908872 139711396034560 replay_runner.py:39] Average training steps per second: 712347.83
I0910 11:21:01.123470 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:21:01.189899 139711396034560 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 822896.61
I0910 11:21:01.191376 139711396034560 replay_runner.py:39] Average training steps per second: 822896.61
I0910 11:21:01.368287 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:21:01.436527 139711396034560 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 804739.83
I0910 11:21:01.438031 139711396034560 replay_runner.py:39] Average training steps per second: 804739.83
I0910 11:21:01.615385 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:21:01.682802 139711396034560 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 820000.78
I0910 11:21:01.684260 139711396034560 replay_runner.py:39] Average training steps per second: 820000.78
I0910 11:21:01.874210 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:21:01.940759 139711396034560 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 815377.92
I0910 11:21:01.942229 139711396034560 replay_runner.py:39] Average training steps per second: 815377.92
I0910 11:21:02.163563 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:21:02.246836 139711396034560 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 603496.98
I0910 11:21:02.248808 139711396034560 replay_runner.py:39] Average training steps per second: 603496.98
I0910 11:21:02.493340 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:21:02.564918 139711396034560 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 697539.33
I0910 11:21:02.566593 139711396034560 replay_runner.py:39] Average training steps per second: 697539.33
I0910 11:21:02.764744 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:21:02.873135 139711396034560 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 316718.57

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:21:03.115536 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:21:03.185557 139711396034560 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 711501.95
I0910 11:21:03.187234 139711396034560 replay_runner.py:39] Average training steps per second: 711501.95
I0910 11:21:03.383654 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:21:03.451284 139711396034560 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 694421.19
I0910 11:21:03.452992 139711396034560 replay_runner.py:39] Average training steps per second: 694421.19
I0910 11:21:03.649402 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:21:03.717405 139711396034560 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 795128.72
I0910 11:21:03.718892 139711396034560 replay_runner.py:39] Average training steps per second: 795128.72
I0910 11:21:03.904810 139711396034560 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00