Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 23:27:47.051074 140082076076032 run_experiment.py:549] Creating TrainRunner ...
I0902 23:27:47.061130 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:27:47.061417 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:27:47.061612 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:27:47.061775 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:27:47.061981 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:27:47.062363 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:27:47.062516 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:27:47.062646 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:27:47.062867 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:27:47.063060 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:27:47.063170 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:27:47.063406 140082076076032 dqn_agent.py:283] 	 seed: 1630625267061048
I0902 23:27:47.066821 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:27:47.067075 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:27:47.067255 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:27:47.067385 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:27:47.067547 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:27:47.067662 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:27:47.067777 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:27:47.067890 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:27:47.067975 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:27:47.109797 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:27:47.663175 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:27:47.678540 140082076076032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:27:47.687448 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:27:47.687698 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:27:47.687849 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:27:47.687938 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:27:47.688013 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:27:47.688085 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:27:47.688193 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:27:47.688274 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:27:47.688347 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:27:47.688403 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:27:47.688550 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:27:47.688768 140082076076032 dqn_agent.py:283] 	 seed: 1630625267687395
I0902 23:27:47.692406 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:27:47.692678 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:27:47.692883 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:27:47.693080 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:27:47.693361 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:27:47.693546 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:27:47.693874 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:27:47.693985 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:27:47.694084 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:27:47.727607 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:27:47.748777 140082076076032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:27:47.749144 140082076076032 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.30
I0902 23:27:54.538458 140082076076032 replay_runner.py:36] Average training steps per second: 147.30
Steps executed: 207 Episode length: 10 Return: 10.0
I0902 23:27:55.644986 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 1

Steps executed: 368 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 192.19
I0902 23:28:01.019336 140082076076032 replay_runner.py:36] Average training steps per second: 192.19
I0902 23:28:01.260645 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 2

Steps executed: 189 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 196.35
I0902 23:28:06.536013 140082076076032 replay_runner.py:36] Average training steps per second: 196.35
I0902 23:28:06.787719 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.50
INFO:tensorflow:Starting iteration 3

Steps executed: 367 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 198.96
I0902 23:28:12.002265 140082076076032 replay_runner.py:36] Average training steps per second: 198.96
I0902 23:28:12.140886 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4


Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 207.11
I0902 23:28:17.156479 140082076076032 replay_runner.py:36] Average training steps per second: 207.11
I0902 23:28:17.408858 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 5
I0902 23:28:17.589493 140082076076032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 206.20
I0902 23:28:22.439432 140082076076032 replay_runner.py:36] Average training steps per second: 206.20
I0902 23:28:22.557683 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.81
I0902 23:28:27.905513 140082076076032 replay_runner.py:36] Average training steps per second: 196.81
I0902 23:28:28.130846 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50
INFO:tensorflow:Starting iteration 7

Steps executed: 359 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 199.43
I0902 23:28:33.322508 140082076076032 replay_runner.py:36] Average training steps per second: 199.43
I0902 23:28:33.549595 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 8


Steps executed: 350 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 200.74
I0902 23:28:38.717444 140082076076032 replay_runner.py:36] Average training steps per second: 200.74
I0902 23:28:38.945098 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 9
I0902 23:28:39.128756 140082076076032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 195.84
I0902 23:28:44.235226 140082076076032 replay_runner.py:36] Average training steps per second: 195.84
I0902 23:28:44.472059 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 10

Steps executed: 349 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 198.07
I0902 23:28:49.712734 140082076076032 replay_runner.py:36] Average training steps per second: 198.07
I0902 23:28:49.888249 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 11

Steps executed: 262 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 193.68
I0902 23:28:55.232389 140082076076032 replay_runner.py:36] Average training steps per second: 193.68
I0902 23:28:55.412439 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 12

Steps executed: 266 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 206.55
I0902 23:29:00.425309 140082076076032 replay_runner.py:36] Average training steps per second: 206.55
I0902 23:29:00.619315 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.50
INFO:tensorflow:Starting iteration 13

Steps executed: 291 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 193.74
I0902 23:29:05.979233 140082076076032 replay_runner.py:36] Average training steps per second: 193.74
I0902 23:29:06.169125 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 14

Steps executed: 276 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 200.32
I0902 23:29:11.357513 140082076076032 replay_runner.py:36] Average training steps per second: 200.32
I0902 23:29:11.535138 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 130.50
INFO:tensorflow:Starting iteration 15

Steps executed: 261 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 196.43

Steps executed: 282 Episode length: 128 Return: 128.0
I0902 23:29:17.098095 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 16

Steps executed: 248 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 194.31
I0902 23:29:22.442301 140082076076032 replay_runner.py:36] Average training steps per second: 194.31
I0902 23:29:22.613291 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 17

Steps executed: 264 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 192.87
I0902 23:29:27.997848 140082076076032 replay_runner.py:36] Average training steps per second: 192.87
I0902 23:29:28.186410 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 18


Steps executed: 345 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.08
I0902 23:29:33.369958 140082076076032 replay_runner.py:36] Average training steps per second: 200.08
I0902 23:29:33.609494 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 19
I0902 23:29:33.805824 140082076076032 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.70

Steps executed: 353 Episode length: 200 Return: 200.0
I0902 23:29:39.200896 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.44
I0902 23:29:44.433834 140082076076032 replay_runner.py:36] Average training steps per second: 198.44
I0902 23:29:44.567647 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:29:44.763630 140082076076032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.40
I0902 23:29:49.779186 140082076076032 replay_runner.py:36] Average training steps per second: 199.40
I0902 23:29:49.909584 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:29:50.094095 140082076076032 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 200.29
I0902 23:29:55.087387 140082076076032 replay_runner.py:36] Average training steps per second: 200.29
I0902 23:29:55.207698 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:29:55.388336 140082076076032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 201.89
I0902 23:30:00.341824 140082076076032 replay_runner.py:36] Average training steps per second: 201.89
I0902 23:30:00.466669 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:30:00.682209 140082076076032 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 203.21
I0902 23:30:05.617520 140082076076032 replay_runner.py:36] Average training steps per second: 203.21
I0902 23:30:05.752537 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:30:05.940632 140082076076032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.58
I0902 23:30:11.106768 140082076076032 replay_runner.py:36] Average training steps per second: 193.58
I0902 23:30:11.238990 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:30:11.431614 140082076076032 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 201.98
I0902 23:30:16.383004 140082076076032 replay_runner.py:36] Average training steps per second: 201.98
I0902 23:30:16.516406 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:30:16.694103 140082076076032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.43
I0902 23:30:21.864345 140082076076032 replay_runner.py:36] Average training steps per second: 193.43
I0902 23:30:22.006816 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:30:22.203534 140082076076032 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.80
I0902 23:30:27.311243 140082076076032 replay_runner.py:36] Average training steps per second: 195.80
I0902 23:30:27.442766 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.14
I0902 23:30:32.786258 140082076076032 replay_runner.py:36] Average training steps per second: 194.14
I0902 23:30:32.926831 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00