Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0902 23:25:24.536429 140687300532224 run_experiment.py:549] Creating TrainRunner ...
I0902 23:25:24.545887 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:24.546242 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:24.546529 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:24.546800 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:24.547146 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:24.547389 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:24.547663 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:24.547932 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:24.548177 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:24.548444 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:24.548723 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:24.548982 140687300532224 dqn_agent.py:283] 	 seed: 1630625124545837
I0902 23:25:24.551708 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:24.551851 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:25:24.551972 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:24.552057 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:24.552140 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:24.552223 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:24.552302 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:24.552401 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:24.552515 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:24.588531 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:25.032022 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:25.050930 140687300532224 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:25:25.061729 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:25.061914 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:25.061991 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:25.062050 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:25.062104 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:25.062156 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:25.062256 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:25.062482 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:25.062586 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:25.062660 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:25.062719 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:25.062776 140687300532224 dqn_agent.py:283] 	 seed: 1630625125061683
I0902 23:25:25.064800 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:25.065001 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:25:25.065131 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:25.065349 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:25.065466 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:25.065548 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:25.065619 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:25.065734 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:25.065822 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:25.100867 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:25.124690 140687300532224 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:25:25.125028 140687300532224 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.51
I0902 23:25:31.769087 140687300532224 replay_runner.py:36] Average training steps per second: 150.51
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:25:33.357987 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 335 Episode length: 335 Return: -334.0
INFO:tensorflow:Average training steps per second: 195.82
I0902 23:25:38.703821 140687300532224 replay_runner.py:36] Average training steps per second: 195.82
I0902 23:25:38.948232 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.00
INFO:tensorflow:Starting iteration 2
I0902 23:25:39.170702 140687300532224 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 205.23

Steps executed: 263 Episode length: 263 Return: -262.0
I0902 23:25:44.265464 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.00
INFO:tensorflow:Starting iteration 3

Steps executed: 213 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 201.28
I0902 23:25:49.460720 140687300532224 replay_runner.py:36] Average training steps per second: 201.28
I0902 23:25:49.638326 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 4

Steps executed: 228 Episode length: 228 Return: -227.0
INFO:tensorflow:Average training steps per second: 202.51
I0902 23:25:54.800721 140687300532224 replay_runner.py:36] Average training steps per second: 202.51
I0902 23:25:55.006030 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.67
I0902 23:26:00.430527 140687300532224 replay_runner.py:36] Average training steps per second: 192.67
I0902 23:26:00.830522 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 287 Episode length: 287 Return: -286.0
INFO:tensorflow:Average training steps per second: 203.66
I0902 23:26:05.977205 140687300532224 replay_runner.py:36] Average training steps per second: 203.66
I0902 23:26:06.222120 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.00
INFO:tensorflow:Starting iteration 7

Steps executed: 337 Episode length: 337 Return: -336.0
INFO:tensorflow:Average training steps per second: 194.57
I0902 23:26:11.595426 140687300532224 replay_runner.py:36] Average training steps per second: 194.57
I0902 23:26:11.872908 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -336.00
INFO:tensorflow:Starting iteration 8

Steps executed: 256 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 203.08
I0902 23:26:17.043689 140687300532224 replay_runner.py:36] Average training steps per second: 203.08
I0902 23:26:17.245999 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 62 Return: -61.0.0
INFO:tensorflow:Average training steps per second: 193.57
I0902 23:26:22.637475 140687300532224 replay_runner.py:36] Average training steps per second: 193.57
I0902 23:26:22.810652 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.67
INFO:tensorflow:Starting iteration 10

Steps executed: 223 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 199.75
I0902 23:26:28.048448 140687300532224 replay_runner.py:36] Average training steps per second: 199.75
I0902 23:26:28.224264 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 11

Steps executed: 317 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 192.43
I0902 23:26:33.660353 140687300532224 replay_runner.py:36] Average training steps per second: 192.43
I0902 23:26:33.912336 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.67
INFO:tensorflow:Starting iteration 12

Steps executed: 267 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 202.91
I0902 23:26:39.077317 140687300532224 replay_runner.py:36] Average training steps per second: 202.91
I0902 23:26:39.291535 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 13
I0902 23:26:39.523489 140687300532224 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.82

Steps executed: 297 Episode length: 118 Return: -117.0
I0902 23:26:44.901948 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.20
I0902 23:26:50.093392 140687300532224 replay_runner.py:36] Average training steps per second: 202.20
I0902 23:26:50.522293 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 248 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 191.07
I0902 23:26:56.002728 140687300532224 replay_runner.py:36] Average training steps per second: 191.07
I0902 23:26:56.222295 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.37
I0902 23:27:01.482613 140687300532224 replay_runner.py:36] Average training steps per second: 199.37
I0902 23:27:01.880000 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17

Steps executed: 255 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 190.62
I0902 23:27:07.368062 140687300532224 replay_runner.py:36] Average training steps per second: 190.62
I0902 23:27:07.581875 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 18

Steps executed: 293 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 207.03
I0902 23:27:12.659311 140687300532224 replay_runner.py:36] Average training steps per second: 207.03
I0902 23:27:12.899023 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 19

Steps executed: 146 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 194.52
I0902 23:27:18.280670 140687300532224 replay_runner.py:36] Average training steps per second: 194.52

Steps executed: 268 Episode length: 122 Return: -121.0
INFO:tensorflow:Starting iteration 20

Steps executed: 275 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 194.99
I0902 23:27:23.883825 140687300532224 replay_runner.py:36] Average training steps per second: 194.99
I0902 23:27:24.110387 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 21

Steps executed: 342 Episode length: 175 Return: -174.0
INFO:tensorflow:Average training steps per second: 195.16
I0902 23:27:29.476189 140687300532224 replay_runner.py:36] Average training steps per second: 195.16
I0902 23:27:29.781164 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 22

Steps executed: 274 Episode length: 78 Return: -77.000
INFO:tensorflow:Average training steps per second: 201.47
I0902 23:27:34.974214 140687300532224 replay_runner.py:36] Average training steps per second: 201.47
I0902 23:27:35.198286 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 23

Steps executed: 191 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 197.88
I0902 23:27:40.481403 140687300532224 replay_runner.py:36] Average training steps per second: 197.88

Steps executed: 301 Episode length: 110 Return: -109.0
INFO:tensorflow:Starting iteration 24

Steps executed: 268 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 206.05
I0902 23:27:45.863252 140687300532224 replay_runner.py:36] Average training steps per second: 206.05
I0902 23:27:46.070969 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 25

Steps executed: 213 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 199.88
I0902 23:27:51.311524 140687300532224 replay_runner.py:36] Average training steps per second: 199.88
I0902 23:27:51.474388 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 207.35
I0902 23:27:56.528923 140687300532224 replay_runner.py:36] Average training steps per second: 207.35
I0902 23:27:56.755461 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 27

Steps executed: 249 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 205.86
I0902 23:28:01.836464 140687300532224 replay_runner.py:36] Average training steps per second: 205.86
I0902 23:28:02.036714 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 28

Steps executed: 216 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 199.74
I0902 23:28:07.281096 140687300532224 replay_runner.py:36] Average training steps per second: 199.74
I0902 23:28:07.467234 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 29

Steps executed: 213 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 197.32
I0902 23:28:12.768596 140687300532224 replay_runner.py:36] Average training steps per second: 197.32

Done fixed training!Episode length: 125 Return: -124.0