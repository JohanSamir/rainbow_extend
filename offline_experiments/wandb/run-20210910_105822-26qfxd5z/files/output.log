I0910 10:58:28.242729 139923723503616 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 10:58:28.243284 139923723503616 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 10:58:28.298125 139923723503616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:28.299304 139923723503616 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:28.299379 139923723503616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:28.299439 139923723503616 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:28.299489 139923723503616 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:28.299537 139923723503616 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:28.299583 139923723503616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:28.299662 139923723503616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:28.299766 139923723503616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:28.299825 139923723503616 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:28.299890 139923723503616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:28.299958 139923723503616 dqn_agent.py:283] 	 seed: 1631271508298066
I0910 10:58:28.302016 139923723503616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:28.302185 139923723503616 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:28.302270 139923723503616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:28.302349 139923723503616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:28.302426 139923723503616 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:28.302498 139923723503616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:28.302589 139923723503616 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:28.302686 139923723503616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:28.302768 139923723503616 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
I0910 10:58:30.694366 139923723503616 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:31.002132 139923723503616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 10:58:31.002507 139923723503616 dqn_agent.py:272] 	 gamma: 0.990000
I0910 10:58:31.002768 139923723503616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 10:58:31.003001 139923723503616 dqn_agent.py:274] 	 min_replay_history: 500
I0910 10:58:31.003206 139923723503616 dqn_agent.py:275] 	 update_period: 4
I0910 10:58:31.003421 139923723503616 dqn_agent.py:276] 	 target_update_period: 100
I0910 10:58:31.003507 139923723503616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 10:58:31.003685 139923723503616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 10:58:31.003934 139923723503616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 10:58:31.004136 139923723503616 dqn_agent.py:280] 	 optimizer: adam
I0910 10:58:31.004374 139923723503616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 10:58:31.004587 139923723503616 dqn_agent.py:283] 	 seed: 1631271511002073
I0910 10:58:31.009362 139923723503616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 10:58:31.009526 139923723503616 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 10:58:31.010260 139923723503616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 10:58:31.010583 139923723503616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 10:58:31.010872 139923723503616 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 10:58:31.011160 139923723503616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 10:58:31.011633 139923723503616 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 10:58:31.012019 139923723503616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 10:58:31.012440 139923723503616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 10:58:31.081974 139923723503616 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 10:58:31.139267 139923723503616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 10:58:31.139617 139923723503616 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 355539.88
I0910 10:58:31.142808 139923723503616 replay_runner.py:39] Average training steps per second: 355539.88
Steps executed: 271 Episode length: 120 Return: -120.0
I0910 10:58:32.344785 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 10:58:32.414206 139923723503616 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 345750.89
I0910 10:58:32.417498 139923723503616 replay_runner.py:39] Average training steps per second: 345750.89
I0910 10:58:32.563020 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.50
INFO:tensorflow:Starting iteration 2
I0910 10:58:32.643201 139923723503616 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 359717.32
I0910 10:58:32.646380 139923723503616 replay_runner.py:39] Average training steps per second: 359717.32
I0910 10:58:32.772570 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.50
INFO:tensorflow:Starting iteration 3
I0910 10:58:32.842023 139923723503616 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 434103.08
I0910 10:58:32.844646 139923723503616 replay_runner.py:39] Average training steps per second: 434103.08
I0910 10:58:33.068737 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 4
I0910 10:58:33.153027 139923723503616 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 371736.59
I0910 10:58:33.156076 139923723503616 replay_runner.py:39] Average training steps per second: 371736.59
I0910 10:58:33.416446 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.00
INFO:tensorflow:Starting iteration 5
I0910 10:58:33.509402 139923723503616 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 435998.34
I0910 10:58:33.512068 139923723503616 replay_runner.py:39] Average training steps per second: 435998.34
I0910 10:58:33.628805 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.50
INFO:tensorflow:Starting iteration 6
I0910 10:58:33.695060 139923723503616 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 802276.97
I0910 10:58:33.696549 139923723503616 replay_runner.py:39] Average training steps per second: 802276.97

Steps executed: 120 Episode length: 120 Return: -120.0
INFO:tensorflow:Starting iteration 7
I0910 10:58:33.847215 139923723503616 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 717097.62
I0910 10:58:33.848865 139923723503616 replay_runner.py:39] Average training steps per second: 717097.62
I0910 10:58:33.956902 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.50
INFO:tensorflow:Starting iteration 8
I0910 10:58:34.013329 139923723503616 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 741174.06
I0910 10:58:34.014918 139923723503616 replay_runner.py:39] Average training steps per second: 741174.06
I0910 10:58:34.117631 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.00
INFO:tensorflow:Starting iteration 9
I0910 10:58:34.184260 139923723503616 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 843754.58
I0910 10:58:34.185732 139923723503616 replay_runner.py:39] Average training steps per second: 843754.58
I0910 10:58:34.474628 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.00
INFO:tensorflow:Starting iteration 10
I0910 10:58:34.530889 139923723503616 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 808462.61
I0910 10:58:34.532390 139923723503616 replay_runner.py:39] Average training steps per second: 808462.61
I0910 10:58:34.605732 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 11
I0910 10:58:34.674616 139923723503616 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 564205.54
I0910 10:58:34.676745 139923723503616 replay_runner.py:39] Average training steps per second: 564205.54
I0910 10:58:34.808946 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.50
INFO:tensorflow:Starting iteration 12
I0910 10:58:34.867656 139923723503616 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 807062.54
I0910 10:58:34.869158 139923723503616 replay_runner.py:39] Average training steps per second: 807062.54
I0910 10:58:34.945285 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 13
I0910 10:58:35.001567 139923723503616 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 766923.39
I0910 10:58:35.003142 139923723503616 replay_runner.py:39] Average training steps per second: 766923.39
I0910 10:58:35.122661 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.50
INFO:tensorflow:Starting iteration 14
I0910 10:58:35.179776 139923723503616 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 763294.63
I0910 10:58:35.181373 139923723503616 replay_runner.py:39] Average training steps per second: 763294.63
I0910 10:58:35.277412 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50
INFO:tensorflow:Starting iteration 15
I0910 10:58:35.333620 139923723503616 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 808774.39
I0910 10:58:35.335121 139923723503616 replay_runner.py:39] Average training steps per second: 808774.39
I0910 10:58:35.446329 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.50
INFO:tensorflow:Starting iteration 16
I0910 10:58:35.501621 139923723503616 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 819680.28
I0910 10:58:35.503111 139923723503616 replay_runner.py:39] Average training steps per second: 819680.28
I0910 10:58:35.600039 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.00
INFO:tensorflow:Starting iteration 17
I0910 10:58:35.655957 139923723503616 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 798003.04
I0910 10:58:35.657482 139923723503616 replay_runner.py:39] Average training steps per second: 798003.04
I0910 10:58:35.755911 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 18
I0910 10:58:35.823212 139923723503616 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 582947.05

Steps executed: 642 Episode length: 523 Return: -523.0
I0910 10:58:35.937668 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.50
INFO:tensorflow:Starting iteration 19
I0910 10:58:35.991816 139923723503616 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 787514.83
I0910 10:58:35.993340 139923723503616 replay_runner.py:39] Average training steps per second: 787514.83
I0910 10:58:36.094511 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.50
INFO:tensorflow:Starting iteration 20
I0910 10:58:36.150151 139923723503616 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 835352.32
I0910 10:58:36.151578 139923723503616 replay_runner.py:39] Average training steps per second: 835352.32
I0910 10:58:36.246588 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00
INFO:tensorflow:Starting iteration 21
I0910 10:58:36.317828 139923723503616 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 828913.83
I0910 10:58:36.319290 139923723503616 replay_runner.py:39] Average training steps per second: 828913.83
I0910 10:58:36.512519 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 10:58:36.568449 139923723503616 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 815061.02
I0910 10:58:36.569915 139923723503616 replay_runner.py:39] Average training steps per second: 815061.02
I0910 10:58:36.665128 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.00
INFO:tensorflow:Starting iteration 23
I0910 10:58:36.732048 139923723503616 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 618994.10
I0910 10:58:36.733925 139923723503616 replay_runner.py:39] Average training steps per second: 618994.10
I0910 10:58:36.895603 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.00
INFO:tensorflow:Starting iteration 24
I0910 10:58:36.952339 139923723503616 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 725156.29
I0910 10:58:36.953984 139923723503616 replay_runner.py:39] Average training steps per second: 725156.29
I0910 10:58:37.063155 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.50
INFO:tensorflow:Starting iteration 25
I0910 10:58:37.117255 139923723503616 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 837019.36
I0910 10:58:37.118721 139923723503616 replay_runner.py:39] Average training steps per second: 837019.36
I0910 10:58:37.235663 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.00
INFO:tensorflow:Starting iteration 26
I0910 10:58:37.291370 139923723503616 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 756684.83
I0910 10:58:37.292941 139923723503616 replay_runner.py:39] Average training steps per second: 756684.83
I0910 10:58:37.386524 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 27
I0910 10:58:37.440553 139923723503616 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 829241.60
I0910 10:58:37.441993 139923723503616 replay_runner.py:39] Average training steps per second: 829241.60
I0910 10:58:37.666747 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.00
INFO:tensorflow:Starting iteration 28
I0910 10:58:37.723054 139923723503616 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 758738.06
I0910 10:58:37.724615 139923723503616 replay_runner.py:39] Average training steps per second: 758738.06

Done fixed training!Episode length: 156 Return: -156.0
INFO:tensorflow:Starting iteration 29
I0910 10:58:37.890486 139923723503616 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 831543.22
I0910 10:58:37.891954 139923723503616 replay_runner.py:39] Average training steps per second: 831543.22
I0910 10:58:38.002929 139923723503616 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50