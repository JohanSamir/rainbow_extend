Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0905 16:23:20.006352 140572166862848 run_experiment.py:549] Creating TrainRunner ...
I0905 16:23:20.016130 140572166862848 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:23:20.016330 140572166862848 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:23:20.016500 140572166862848 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:23:20.016614 140572166862848 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:23:20.016721 140572166862848 dqn_agent.py:275] 	 update_period: 4
I0905 16:23:20.016865 140572166862848 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:23:20.016976 140572166862848 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:23:20.017125 140572166862848 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:23:20.017252 140572166862848 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:23:20.017360 140572166862848 dqn_agent.py:280] 	 optimizer: adam
I0905 16:23:20.017468 140572166862848 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:23:20.017588 140572166862848 dqn_agent.py:283] 	 seed: 1630859000016083
I0905 16:23:20.020289 140572166862848 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:23:20.020485 140572166862848 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:23:20.020623 140572166862848 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:23:20.020746 140572166862848 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:23:20.020850 140572166862848 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:23:20.020961 140572166862848 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:23:20.021053 140572166862848 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:23:20.021157 140572166862848 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:23:20.021247 140572166862848 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:23:21.457536 140572166862848 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:23:21.799975 140572166862848 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:23:21.808416 140572166862848 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:23:21.813001 140572166862848 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:23:21.813141 140572166862848 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:23:21.813201 140572166862848 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:23:21.813280 140572166862848 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:23:21.813336 140572166862848 dqn_agent.py:275] 	 update_period: 4
I0905 16:23:21.813395 140572166862848 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:23:21.813447 140572166862848 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:23:21.813520 140572166862848 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:23:21.813588 140572166862848 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:23:21.813643 140572166862848 dqn_agent.py:280] 	 optimizer: adam
I0905 16:23:21.813708 140572166862848 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:23:21.813773 140572166862848 dqn_agent.py:283] 	 seed: 1630859001812966
I0905 16:23:21.815172 140572166862848 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:23:21.815282 140572166862848 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 16:23:21.815353 140572166862848 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:23:21.815423 140572166862848 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:23:21.815483 140572166862848 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:23:21.815553 140572166862848 circular_replay_buffer.py:160] 	 replay_capacity: 50000
Steps executed: 500 Episode length: 500 Return: -500.0
I0905 16:23:21.815608 140572166862848 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:23:21.815684 140572166862848 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:23:21.815752 140572166862848 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:23:21.833842 140572166862848 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:23:21.846049 140572166862848 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:23:21.846227 140572166862848 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 258.70
I0905 16:23:25.712039 140572166862848 replay_runner.py:36] Average training steps per second: 258.70
I0905 16:23:26.459632 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 254 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 360.23
I0905 16:23:29.396670 140572166862848 replay_runner.py:36] Average training steps per second: 360.23
I0905 16:23:29.484241 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 359.55
I0905 16:23:32.426717 140572166862848 replay_runner.py:36] Average training steps per second: 359.55
I0905 16:23:32.598317 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 107 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 360.56
I0905 16:23:35.529855 140572166862848 replay_runner.py:36] Average training steps per second: 360.56

Steps executed: 231 Episode length: 124 Return: -123.0
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 362.00
I0905 16:23:38.540230 140572166862848 replay_runner.py:36] Average training steps per second: 362.00
I0905 16:23:38.713923 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 16:23:38.871573 140572166862848 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 361.68

Steps executed: 302 Episode length: 142 Return: -141.0
I0905 16:23:41.745319 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.00
INFO:tensorflow:Starting iteration 6

Steps executed: 333 Episode length: 202 Return: -201.0
INFO:tensorflow:Average training steps per second: 361.37
I0905 16:23:44.677009 140572166862848 replay_runner.py:36] Average training steps per second: 361.37
I0905 16:23:44.793519 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.50
INFO:tensorflow:Starting iteration 7
I0905 16:23:44.950197 140572166862848 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 363.60

Steps executed: 262 Episode length: 149 Return: -148.0
I0905 16:23:47.791393 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.00
INFO:tensorflow:Starting iteration 8

Steps executed: 229 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 363.03
I0905 16:23:50.707509 140572166862848 replay_runner.py:36] Average training steps per second: 363.03
I0905 16:23:50.786607 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 9

Steps executed: 122 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 363.79
I0905 16:23:53.693634 140572166862848 replay_runner.py:36] Average training steps per second: 363.79

Steps executed: 224 Episode length: 102 Return: -101.0
INFO:tensorflow:Starting iteration 10

Steps executed: 313 Episode length: 313 Return: -312.0
INFO:tensorflow:Average training steps per second: 359.81
I0905 16:23:56.705937 140572166862848 replay_runner.py:36] Average training steps per second: 359.81
I0905 16:23:56.813885 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.00
INFO:tensorflow:Starting iteration 11

Steps executed: 254 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 362.61
I0905 16:23:59.729857 140572166862848 replay_runner.py:36] Average training steps per second: 362.61
I0905 16:23:59.817451 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 12

Steps executed: 317 Episode length: 153 Return: -152.0
INFO:tensorflow:Average training steps per second: 362.19
I0905 16:24:02.735198 140572166862848 replay_runner.py:36] Average training steps per second: 362.19
I0905 16:24:02.842719 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.50
INFO:tensorflow:Starting iteration 13

Steps executed: 248 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 360.55
I0905 16:24:05.773843 140572166862848 replay_runner.py:36] Average training steps per second: 360.55
I0905 16:24:05.859164 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.00
INFO:tensorflow:Starting iteration 14

Steps executed: 308 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 360.83
I0905 16:24:08.788304 140572166862848 replay_runner.py:36] Average training steps per second: 360.83
I0905 16:24:08.907893 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 15

Steps executed: 311 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 361.23
I0905 16:24:11.837643 140572166862848 replay_runner.py:36] Average training steps per second: 361.23
I0905 16:24:11.944584 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.67
INFO:tensorflow:Starting iteration 16

Steps executed: 201 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 362.56
I0905 16:24:14.861055 140572166862848 replay_runner.py:36] Average training steps per second: 362.56
I0905 16:24:14.930971 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 17

Steps executed: 231 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 364.09
I0905 16:24:17.834365 140572166862848 replay_runner.py:36] Average training steps per second: 364.09
I0905 16:24:17.915921 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 18

Steps executed: 236 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 360.13
I0905 16:24:20.850327 140572166862848 replay_runner.py:36] Average training steps per second: 360.13
I0905 16:24:20.933659 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 19

Steps executed: 256 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 364.10
I0905 16:24:23.837546 140572166862848 replay_runner.py:36] Average training steps per second: 364.10
I0905 16:24:23.927214 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 20

Steps executed: 287 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 365.06
I0905 16:24:26.823080 140572166862848 replay_runner.py:36] Average training steps per second: 365.06
I0905 16:24:26.922955 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 21

Steps executed: 204 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 367.13
I0905 16:24:29.804507 140572166862848 replay_runner.py:36] Average training steps per second: 367.13
I0905 16:24:29.875542 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 22

Steps executed: 229 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 370.35
I0905 16:24:32.734924 140572166862848 replay_runner.py:36] Average training steps per second: 370.35
I0905 16:24:32.812298 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 23
I0905 16:24:32.966542 140572166862848 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 312.17

Steps executed: 314 Episode length: 122 Return: -121.0
I0905 16:24:36.315024 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.67
INFO:tensorflow:Starting iteration 24

Steps executed: 264 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 321.04
I0905 16:24:39.718707 140572166862848 replay_runner.py:36] Average training steps per second: 321.04
I0905 16:24:39.808656 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 25

Steps executed: 268 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 357.58
I0905 16:24:42.762168 140572166862848 replay_runner.py:36] Average training steps per second: 357.58
I0905 16:24:42.854046 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 26

Steps executed: 294 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 350.25
I0905 16:24:45.869318 140572166862848 replay_runner.py:36] Average training steps per second: 350.25
I0905 16:24:45.975912 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 27

Steps executed: 232 Episode length: 232 Return: -231.0
INFO:tensorflow:Average training steps per second: 355.15
I0905 16:24:48.949899 140572166862848 replay_runner.py:36] Average training steps per second: 355.15
I0905 16:24:49.032141 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.00
INFO:tensorflow:Starting iteration 28
I0905 16:24:49.190555 140572166862848 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 362.99
I0905 16:24:51.945703 140572166862848 replay_runner.py:36] Average training steps per second: 362.99
I0905 16:24:52.052985 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 29


Done fixed training!Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 364.04
I0905 16:24:54.955464 140572166862848 replay_runner.py:36] Average training steps per second: 364.04
I0905 16:24:55.041846 140572166862848 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33