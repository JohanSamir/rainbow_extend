Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 18:02:11.505975 140537039579136 run_experiment.py:549] Creating TrainRunner ...
I0902 18:02:11.517474 140537039579136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:02:11.517735 140537039579136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:02:11.517945 140537039579136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:02:11.518162 140537039579136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:02:11.518276 140537039579136 dqn_agent.py:275] 	 update_period: 4
I0902 18:02:11.518383 140537039579136 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:02:11.518500 140537039579136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:02:11.518628 140537039579136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:02:11.518777 140537039579136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:02:11.518888 140537039579136 dqn_agent.py:280] 	 optimizer: adam
I0902 18:02:11.518989 140537039579136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:02:11.519139 140537039579136 dqn_agent.py:283] 	 seed: 1630605731517405
I0902 18:02:11.522050 140537039579136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:02:11.522266 140537039579136 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:02:11.522426 140537039579136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:02:11.522517 140537039579136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:02:11.522691 140537039579136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:02:11.522861 140537039579136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:02:11.522958 140537039579136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:02:11.523035 140537039579136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:02:11.523110 140537039579136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:02:11.562294 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:02:12.096244 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:02:12.135584 140537039579136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:02:12.161789 140537039579136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:02:12.162017 140537039579136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:02:12.162165 140537039579136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:02:12.162317 140537039579136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:02:12.162411 140537039579136 dqn_agent.py:275] 	 update_period: 4
I0902 18:02:12.162550 140537039579136 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:02:12.162671 140537039579136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:02:12.162762 140537039579136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:02:12.162882 140537039579136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:02:12.163004 140537039579136 dqn_agent.py:280] 	 optimizer: adam
I0902 18:02:12.163135 140537039579136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:02:12.163270 140537039579136 dqn_agent.py:283] 	 seed: 1630605732161734
I0902 18:02:12.166125 140537039579136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:02:12.166312 140537039579136 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 18:02:12.166429 140537039579136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:02:12.166573 140537039579136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:02:12.166681 140537039579136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:02:12.166779 140537039579136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:02:12.166874 140537039579136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:02:12.166966 140537039579136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:02:12.167060 140537039579136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:02:12.194864 140537039579136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:02:12.213892 140537039579136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:02:12.214168 140537039579136 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 147.68
I0902 18:02:18.985812 140537039579136 replay_runner.py:36] Average training steps per second: 147.68
Steps executed: 201 Episode length: 10 Return: 10.0
I0902 18:02:20.224135 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 205.50
I0902 18:02:25.289529 140537039579136 replay_runner.py:36] Average training steps per second: 205.50
I0902 18:02:25.431536 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 196.46
I0902 18:02:30.708512 140537039579136 replay_runner.py:36] Average training steps per second: 196.46
I0902 18:02:30.850125 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.53
INFO:tensorflow:Starting iteration 3

Steps executed: 351 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 200.22
I0902 18:02:36.035987 140537039579136 replay_runner.py:36] Average training steps per second: 200.22
I0902 18:02:36.290347 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.50
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.90
I0902 18:02:41.543559 140537039579136 replay_runner.py:36] Average training steps per second: 197.90
I0902 18:02:41.678257 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 332 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 202.66
I0902 18:02:46.795307 140537039579136 replay_runner.py:36] Average training steps per second: 202.66
I0902 18:02:47.019648 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.00
INFO:tensorflow:Starting iteration 6

Steps executed: 346 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 206.47
I0902 18:02:52.058020 140537039579136 replay_runner.py:36] Average training steps per second: 206.47
I0902 18:02:52.267172 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 7

Steps executed: 172 Episode length: 172 Return: 172.0
INFO:tensorflow:Average training steps per second: 201.71

Steps executed: 365 Episode length: 193 Return: 193.0
I0902 18:02:57.649444 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 8

Steps executed: 324 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 200.50
I0902 18:03:02.818932 140537039579136 replay_runner.py:36] Average training steps per second: 200.50
I0902 18:03:03.028424 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 9

Steps executed: 310 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 199.03
I0902 18:03:08.245663 140537039579136 replay_runner.py:36] Average training steps per second: 199.03
I0902 18:03:08.434577 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 10
I0902 18:03:08.609039 140537039579136 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 201.78

Steps executed: 366 Episode length: 192 Return: 192.0
I0902 18:03:13.819989 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 11

Steps executed: 308 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 200.29
I0902 18:03:19.036413 140537039579136 replay_runner.py:36] Average training steps per second: 200.29
I0902 18:03:19.227755 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 12

Steps executed: 315 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 193.50
I0902 18:03:24.583306 140537039579136 replay_runner.py:36] Average training steps per second: 193.50
I0902 18:03:24.791499 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 13

Steps executed: 364 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 200.51
I0902 18:03:29.971286 140537039579136 replay_runner.py:36] Average training steps per second: 200.51
I0902 18:03:30.220830 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 14
I0902 18:03:30.420250 140537039579136 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 194.19
I0902 18:03:35.570146 140537039579136 replay_runner.py:36] Average training steps per second: 194.19
I0902 18:03:35.692957 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.90
I0902 18:03:40.934914 140537039579136 replay_runner.py:36] Average training steps per second: 197.90
I0902 18:03:41.079717 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 365 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 200.77
I0902 18:03:46.261418 140537039579136 replay_runner.py:36] Average training steps per second: 200.77
I0902 18:03:46.494248 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 17

Steps executed: 347 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 192.06
I0902 18:03:51.887742 140537039579136 replay_runner.py:36] Average training steps per second: 192.06
I0902 18:03:52.119842 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.17
I0902 18:03:57.238339 140537039579136 replay_runner.py:36] Average training steps per second: 203.17
I0902 18:03:57.379279 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 384 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.83
I0902 18:04:02.707295 140537039579136 replay_runner.py:36] Average training steps per second: 194.83
I0902 18:04:02.962447 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.00
INFO:tensorflow:Starting iteration 20

Steps executed: 371 Episode length: 188 Return: 188.0
INFO:tensorflow:Average training steps per second: 193.93
I0902 18:04:08.399173 140537039579136 replay_runner.py:36] Average training steps per second: 193.93
I0902 18:04:08.667760 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.27
I0902 18:04:13.932120 140537039579136 replay_runner.py:36] Average training steps per second: 197.27
I0902 18:04:14.067800 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 341 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 190.84
I0902 18:04:19.497648 140537039579136 replay_runner.py:36] Average training steps per second: 190.84
I0902 18:04:19.728290 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.80
I0902 18:04:24.980717 140537039579136 replay_runner.py:36] Average training steps per second: 197.80
I0902 18:04:25.126404 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 18:04:25.311482 140537039579136 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 194.71
I0902 18:04:30.447729 140537039579136 replay_runner.py:36] Average training steps per second: 194.71
I0902 18:04:30.581297 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 18:04:30.765704 140537039579136 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.81
I0902 18:04:35.899195 140537039579136 replay_runner.py:36] Average training steps per second: 194.81
I0902 18:04:36.048926 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 18:04:36.244449 140537039579136 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 200.61
I0902 18:04:41.229716 140537039579136 replay_runner.py:36] Average training steps per second: 200.61
I0902 18:04:41.367412 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 18:04:41.563923 140537039579136 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.47
I0902 18:04:46.733366 140537039579136 replay_runner.py:36] Average training steps per second: 193.47
I0902 18:04:46.879169 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 18:04:47.077484 140537039579136 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 200.40
I0902 18:04:52.068066 140537039579136 replay_runner.py:36] Average training steps per second: 200.40
I0902 18:04:52.215492 140537039579136 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Steps executed: 195 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 199.87
I0902 18:04:57.415594 140537039579136 replay_runner.py:36] Average training steps per second: 199.87

Done fixed training!Episode length: 200 Return: 200.0