Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:40:21.003708 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:40:21.014176 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:40:21.014403 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:40:21.014492 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:40:21.014558 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:40:21.014615 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:40:21.014668 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:40:21.014851 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:40:21.014918 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:40:21.015017 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:40:21.015090 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:40:21.015160 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:40:21.015228 140635665344512 dqn_agent.py:283] 	 seed: 1630500021014081
I0901 12:40:21.017598 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:40:21.017780 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:40:21.017932 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:40:21.018064 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:40:21.018300 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:40:21.018450 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:40:21.018576 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:40:21.018726 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:40:21.018954 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:40:21.066271 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:21.600098 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:21.617622 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:40:21.628071 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:40:21.628350 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:40:21.628504 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:40:21.628624 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:40:21.628716 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:40:21.628818 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:40:21.628930 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:40:21.629016 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:40:21.629103 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:40:21.629202 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:40:21.629399 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:40:21.629534 140635665344512 dqn_agent.py:283] 	 seed: 1630500021628008
I0901 12:40:21.632367 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:40:21.632580 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:40:21.632737 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:40:21.632866 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:40:21.632986 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:40:21.633182 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:40:21.633377 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:40:21.633502 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:40:21.633616 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:40:21.673848 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:40:21.695953 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:40:21.696262 140635665344512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.61
I0901 12:40:28.611735 140635665344512 replay_runner.py:36] Average training steps per second: 144.61
I0901 12:40:29.774528 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 1
I0901 12:40:29.958313 140635665344512 replay_runner.py:41] Starting iteration 1

Steps executed: 200 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 190.31
I0901 12:40:35.213233 140635665344512 replay_runner.py:36] Average training steps per second: 190.31
I0901 12:40:35.372225 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 2
I0901 12:40:35.571158 140635665344512 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 183.59
I0901 12:40:41.019719 140635665344512 replay_runner.py:36] Average training steps per second: 183.59
I0901 12:40:41.202242 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 117.50
INFO:tensorflow:Starting iteration 3

Steps executed: 235 Episode length: 111 Return: 111.0
INFO:tensorflow:Average training steps per second: 188.64

Steps executed: 219 Episode length: 97 Return: 97.0.0
I0901 12:40:46.854238 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 109.50
INFO:tensorflow:Starting iteration 4

Steps executed: 264 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 186.60
I0901 12:40:52.400841 140635665344512 replay_runner.py:36] Average training steps per second: 186.60
I0901 12:40:52.588247 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 5

Steps executed: 265 Episode length: 91 Return: 91.0.0
INFO:tensorflow:Average training steps per second: 191.12
I0901 12:40:58.007729 140635665344512 replay_runner.py:36] Average training steps per second: 191.12
I0901 12:40:58.218650 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 88.33
INFO:tensorflow:Starting iteration 6

Steps executed: 232 Episode length: 104 Return: 104.0
INFO:tensorflow:Average training steps per second: 198.39
I0901 12:41:03.457790 140635665344512 replay_runner.py:36] Average training steps per second: 198.39
I0901 12:41:03.619419 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.00
INFO:tensorflow:Starting iteration 7

Steps executed: 254 Episode length: 89 Return: 89.0.0
INFO:tensorflow:Average training steps per second: 189.45
I0901 12:41:09.087172 140635665344512 replay_runner.py:36] Average training steps per second: 189.45
I0901 12:41:09.263965 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.67
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.89
I0901 12:41:14.582546 140635665344512 replay_runner.py:36] Average training steps per second: 195.89
I0901 12:41:14.750935 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 220 Episode length: 42 Return: 42.0.0
INFO:tensorflow:Average training steps per second: 189.22
I0901 12:41:20.215358 140635665344512 replay_runner.py:36] Average training steps per second: 189.22
I0901 12:41:20.364458 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 44.00
INFO:tensorflow:Starting iteration 10

Steps executed: 273 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 205.88
I0901 12:41:25.420073 140635665344512 replay_runner.py:36] Average training steps per second: 205.88
I0901 12:41:25.645439 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 11
I0901 12:41:25.849355 140635665344512 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 188.84

Steps executed: 255 Episode length: 131 Return: 131.0
I0901 12:41:31.327770 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 12

Steps executed: 151 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 184.46
I0901 12:41:36.941388 140635665344512 replay_runner.py:36] Average training steps per second: 184.46

Steps executed: 326 Episode length: 175 Return: 175.0
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.78
I0901 12:41:42.531673 140635665344512 replay_runner.py:36] Average training steps per second: 193.78
I0901 12:41:42.668770 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 222 Episode length: 79 Return: 79.0.0
INFO:tensorflow:Average training steps per second: 187.03
I0901 12:41:48.216315 140635665344512 replay_runner.py:36] Average training steps per second: 187.03
I0901 12:41:48.385737 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 74.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.62
I0901 12:41:53.862329 140635665344512 replay_runner.py:36] Average training steps per second: 189.62
I0901 12:41:54.020617 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 268 Episode length: 120 Return: 120.0
INFO:tensorflow:Average training steps per second: 187.21
I0901 12:41:59.568036 140635665344512 replay_runner.py:36] Average training steps per second: 187.21
I0901 12:41:59.762008 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.00
INFO:tensorflow:Starting iteration 17

Steps executed: 281 Episode length: 85 Return: 85.0.0
INFO:tensorflow:Average training steps per second: 181.78
I0901 12:42:05.465785 140635665344512 replay_runner.py:36] Average training steps per second: 181.78
I0901 12:42:05.678822 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.67
INFO:tensorflow:Starting iteration 18

Steps executed: 232 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 181.06
I0901 12:42:11.400119 140635665344512 replay_runner.py:36] Average training steps per second: 181.06
I0901 12:42:11.574138 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 116.00
INFO:tensorflow:Starting iteration 19

Steps executed: 245 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 184.11
I0901 12:42:17.216104 140635665344512 replay_runner.py:36] Average training steps per second: 184.11
I0901 12:42:17.390173 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.50
INFO:tensorflow:Starting iteration 20
I0901 12:42:17.583028 140635665344512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 187.41
I0901 12:42:22.919501 140635665344512 replay_runner.py:36] Average training steps per second: 187.41

Steps executed: 299 Episode length: 141 Return: 141.0
INFO:tensorflow:Starting iteration 21

Steps executed: 327 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 189.79
I0901 12:42:28.614295 140635665344512 replay_runner.py:36] Average training steps per second: 189.79
I0901 12:42:28.851816 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 183.17
I0901 12:42:34.513654 140635665344512 replay_runner.py:36] Average training steps per second: 183.17
I0901 12:42:34.666344 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:42:34.872992 140635665344512 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 188.49
I0901 12:42:40.178838 140635665344512 replay_runner.py:36] Average training steps per second: 188.49
I0901 12:42:40.331944 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:42:40.532364 140635665344512 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 189.70
I0901 12:42:45.804418 140635665344512 replay_runner.py:36] Average training steps per second: 189.70
I0901 12:42:45.957870 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 12:42:46.142512 140635665344512 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 180.71
I0901 12:42:51.676647 140635665344512 replay_runner.py:36] Average training steps per second: 180.71
I0901 12:42:51.820185 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 12:42:52.013298 140635665344512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 188.86

Steps executed: 275 Episode length: 131 Return: 131.0
I0901 12:42:57.512150 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.06
I0901 12:43:02.979738 140635665344512 replay_runner.py:36] Average training steps per second: 189.06
I0901 12:43:03.126139 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:43:03.325259 140635665344512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 191.82
I0901 12:43:08.538812 140635665344512 replay_runner.py:36] Average training steps per second: 191.82
I0901 12:43:08.684970 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.62
I0901 12:43:14.024723 140635665344512 replay_runner.py:36] Average training steps per second: 194.62
I0901 12:43:14.164998 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00