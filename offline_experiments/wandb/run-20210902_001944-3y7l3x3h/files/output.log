Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0902 00:19:50.888957 139825600018432 run_experiment.py:549] Creating TrainRunner ...
I0902 00:19:50.897004 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:50.897173 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:50.897268 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:50.897331 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:50.897418 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:50.897480 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:50.897591 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:50.897661 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:50.897735 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:50.897805 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:50.897888 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:50.897964 139825600018432 dqn_agent.py:283] 	 seed: 1630541990896960
I0902 00:19:50.899627 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:50.899735 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:50.899803 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:50.899859 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:50.899910 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:50.899981 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:50.900049 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:50.900099 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:50.900172 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:50.926196 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:51.170124 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:51.180402 139825600018432 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:19:51.187390 139825600018432 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:51.187540 139825600018432 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:51.187625 139825600018432 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:51.187687 139825600018432 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:51.187747 139825600018432 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:51.187807 139825600018432 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:51.187864 139825600018432 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:51.187918 139825600018432 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:51.187993 139825600018432 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:51.188073 139825600018432 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:51.188157 139825600018432 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:51.188221 139825600018432 dqn_agent.py:283] 	 seed: 1630541991187353
I0902 00:19:51.189725 139825600018432 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:51.189840 139825600018432 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:51.189908 139825600018432 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:51.189968 139825600018432 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:51.190023 139825600018432 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:51.190107 139825600018432 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:51.190184 139825600018432 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:51.190253 139825600018432 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:51.190330 139825600018432 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:51.213026 139825600018432 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:51.230287 139825600018432 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:19:51.230458 139825600018432 replay_runner.py:41] Starting iteration 0
Steps executed: 209 Episode length: 133 Return: -374.48076527608447
INFO:tensorflow:Average training steps per second: 248.49
I0902 00:19:55.254970 139825600018432 replay_runner.py:36] Average training steps per second: 248.49
I0902 00:19:56.041569 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.55
INFO:tensorflow:Starting iteration 1

Steps executed: 174 Episode length: 174 Return: -625.98080956928647
INFO:tensorflow:Average training steps per second: 353.18
I0902 00:20:02.314068 139825600018432 replay_runner.py:36] Average training steps per second: 353.18

Steps executed: 331 Episode length: 157 Return: -573.14104528614267
INFO:tensorflow:Starting iteration 2

Steps executed: 229 Episode length: 99 Return: -316.974883490988765
INFO:tensorflow:Average training steps per second: 349.37
I0902 00:20:08.824320 139825600018432 replay_runner.py:36] Average training steps per second: 349.37
I0902 00:20:08.936465 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.07
INFO:tensorflow:Starting iteration 3

Steps executed: 589 Episode length: 436 Return: -216.10252961094563
INFO:tensorflow:Average training steps per second: 343.26
I0902 00:20:15.281435 139825600018432 replay_runner.py:36] Average training steps per second: 343.26
I0902 00:20:15.871678 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.56
INFO:tensorflow:Starting iteration 4
I0902 00:20:19.287774 139825600018432 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 337.58

Steps executed: 1000 Episode length: 1000 Return: -27.782711268049443
I0902 00:20:24.420343 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.78
INFO:tensorflow:Starting iteration 5
I0902 00:20:27.734806 139825600018432 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 346.67

Steps executed: 1000 Episode length: 1000 Return: -70.707706903612443
I0902 00:20:33.287308 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.71
INFO:tensorflow:Starting iteration 6
I0902 00:20:36.554712 139825600018432 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 336.79

Steps executed: 1000 Episode length: 1000 Return: -40.226131532722183
I0902 00:20:40.785448 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.23
INFO:tensorflow:Starting iteration 7

Steps executed: 1000 Episode length: 1000 Return: -186.59372811816846
INFO:tensorflow:Average training steps per second: 324.22
I0902 00:20:47.061360 139825600018432 replay_runner.py:36] Average training steps per second: 324.22
I0902 00:20:48.538068 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.59
INFO:tensorflow:Starting iteration 8
I0902 00:20:51.693183 139825600018432 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 339.39

Steps executed: 1000 Episode length: 1000 Return: -89.678305187830166
I0902 00:20:57.235852 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.68
INFO:tensorflow:Starting iteration 9

Steps executed: 764 Episode length: 764 Return: -306.8572026393696166
INFO:tensorflow:Average training steps per second: 327.64
I0902 00:21:03.401451 139825600018432 replay_runner.py:36] Average training steps per second: 327.64
I0902 00:21:04.551385 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.86
INFO:tensorflow:Starting iteration 10
I0902 00:21:07.766835 139825600018432 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 326.67

Steps executed: 845 Episode length: 845 Return: -413.3027767814419366
I0902 00:21:12.512063 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.30
INFO:tensorflow:Starting iteration 11
I0902 00:21:15.662067 139825600018432 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 331.80

Steps executed: 1000 Episode length: 1000 Return: -86.488361847838666
I0902 00:21:21.263115 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.49
INFO:tensorflow:Starting iteration 12

Steps executed: 317 Episode length: 317 Return: -235.0592841282298566
INFO:tensorflow:Average training steps per second: 317.32
I0902 00:21:27.561754 139825600018432 replay_runner.py:36] Average training steps per second: 317.32
I0902 00:21:27.804133 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.06
INFO:tensorflow:Starting iteration 13

Steps executed: 311 Episode length: 311 Return: -158.3907679137380566
INFO:tensorflow:Average training steps per second: 319.64
I0902 00:21:34.057585 139825600018432 replay_runner.py:36] Average training steps per second: 319.64
I0902 00:21:34.323523 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.39
INFO:tensorflow:Starting iteration 14

Steps executed: 399 Episode length: 399 Return: -359.8388140795094566
INFO:tensorflow:Average training steps per second: 333.34
I0902 00:21:40.639416 139825600018432 replay_runner.py:36] Average training steps per second: 333.34
I0902 00:21:41.051660 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.84
INFO:tensorflow:Starting iteration 15

Steps executed: 272 Episode length: 272 Return: -480.6805049208524666
INFO:tensorflow:Average training steps per second: 332.57
I0902 00:21:47.333040 139825600018432 replay_runner.py:36] Average training steps per second: 332.57
I0902 00:21:47.566157 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -480.68
INFO:tensorflow:Starting iteration 16
I0902 00:21:50.909281 139825600018432 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 324.21

Steps executed: 671 Episode length: 671 Return: -305.0004614715662766
I0902 00:21:55.355197 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.00
INFO:tensorflow:Starting iteration 17

Steps executed: 213 Episode length: 152 Return: -4.232940080999384766
INFO:tensorflow:Average training steps per second: 341.65
I0902 00:22:01.657366 139825600018432 replay_runner.py:36] Average training steps per second: 341.65
I0902 00:22:01.787397 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.87
INFO:tensorflow:Starting iteration 18

Steps executed: 242 Episode length: 242 Return: -148.6768867006903266
INFO:tensorflow:Average training steps per second: 343.44
I0902 00:22:08.086404 139825600018432 replay_runner.py:36] Average training steps per second: 343.44
I0902 00:22:08.300786 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.68
INFO:tensorflow:Starting iteration 19

Steps executed: 224 Episode length: 224 Return: -162.6671653384252266
INFO:tensorflow:Average training steps per second: 350.19
I0902 00:22:14.529275 139825600018432 replay_runner.py:36] Average training steps per second: 350.19
I0902 00:22:14.697385 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.67
INFO:tensorflow:Starting iteration 20
I0902 00:22:18.114106 139825600018432 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 361.59

Steps executed: 562 Episode length: 376 Return: -228.3710188790344466
I0902 00:22:21.454803 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.86
INFO:tensorflow:Starting iteration 21

Steps executed: 514 Episode length: 514 Return: -80.81646694270106466
INFO:tensorflow:Average training steps per second: 354.11
I0902 00:22:27.754858 139825600018432 replay_runner.py:36] Average training steps per second: 354.11
I0902 00:22:28.372313 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.82
INFO:tensorflow:Starting iteration 22

Steps executed: 245 Episode length: 189 Return: -90.93327109747876466
INFO:tensorflow:Average training steps per second: 347.43
I0902 00:22:34.688153 139825600018432 replay_runner.py:36] Average training steps per second: 347.43
I0902 00:22:34.851541 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.16
INFO:tensorflow:Starting iteration 23

Steps executed: 540 Episode length: 540 Return: -517.6081792717093466
INFO:tensorflow:Average training steps per second: 332.17
I0902 00:22:41.221380 139825600018432 replay_runner.py:36] Average training steps per second: 332.17
I0902 00:22:42.025751 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.61
INFO:tensorflow:Starting iteration 24
I0902 00:22:45.332662 139825600018432 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 322.12

Steps executed: 1000 Episode length: 1000 Return: -56.555188134294876
I0902 00:22:50.950319 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.56
INFO:tensorflow:Starting iteration 25
I0902 00:22:54.258577 139825600018432 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 325.27

Steps executed: 1000 Episode length: 1000 Return: -56.497907092967694
I0902 00:22:59.309067 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.50
INFO:tensorflow:Starting iteration 26

Steps executed: 241 Episode length: 241 Return: 19.792864659762685694
INFO:tensorflow:Average training steps per second: 324.41
I0902 00:23:05.706467 139825600018432 replay_runner.py:36] Average training steps per second: 324.41
I0902 00:23:05.906672 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: 19.79
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 200 Return: -18.90461975781613594
INFO:tensorflow:Average training steps per second: 360.22
I0902 00:23:11.932406 139825600018432 replay_runner.py:36] Average training steps per second: 360.22
I0902 00:23:12.078642 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.90
INFO:tensorflow:Starting iteration 28

Steps executed: 729 Episode length: 729 Return: -107.4987387658264994
INFO:tensorflow:Average training steps per second: 340.12
I0902 00:23:18.201048 139825600018432 replay_runner.py:36] Average training steps per second: 340.12
I0902 00:23:19.110938 139825600018432 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 29

Steps executed: 529 Episode length: 393 Return: -425.4909251231152594
INFO:tensorflow:Average training steps per second: 339.39
I0902 00:23:25.410338 139825600018432 replay_runner.py:36] Average training steps per second: 339.39

Done fixed training!Episode length: 393 Return: -425.4909251231152594