Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0902 11:27:22.903876 139736437499904 run_experiment.py:549] Creating TrainRunner ...
I0902 11:27:22.913791 139736437499904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:22.914059 139736437499904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:22.914189 139736437499904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:22.914279 139736437499904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:22.914350 139736437499904 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:22.914427 139736437499904 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:22.914536 139736437499904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:22.914627 139736437499904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:22.914731 139736437499904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:22.914960 139736437499904 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:22.915057 139736437499904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:22.915129 139736437499904 dqn_agent.py:283] 	 seed: 1630582042913718
I0902 11:27:22.918481 139736437499904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:22.918696 139736437499904 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:27:22.918844 139736437499904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:22.918972 139736437499904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:22.919105 139736437499904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:22.919194 139736437499904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:22.919272 139736437499904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:22.919347 139736437499904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:22.919467 139736437499904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:23.164336 139736437499904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:23.615288 139736437499904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:23.631469 139736437499904 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:27:23.640480 139736437499904 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:23.640790 139736437499904 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:23.641003 139736437499904 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:23.641218 139736437499904 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:23.641359 139736437499904 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:23.641459 139736437499904 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:23.641629 139736437499904 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:23.641725 139736437499904 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:23.641846 139736437499904 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:23.642309 139736437499904 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:23.642508 139736437499904 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:23.642706 139736437499904 dqn_agent.py:283] 	 seed: 1630582043640416
I0902 11:27:23.645738 139736437499904 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:23.645940 139736437499904 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:27:23.646052 139736437499904 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:23.646185 139736437499904 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:23.646284 139736437499904 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:23.646374 139736437499904 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:23.646472 139736437499904 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:23.646566 139736437499904 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:23.646675 139736437499904 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:23.701097 139736437499904 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:23.731617 139736437499904 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:27:23.731913 139736437499904 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 111.06
I0902 11:27:32.736347 139736437499904 replay_runner.py:36] Average training steps per second: 111.06
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 11:27:34.559403 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 11:27:34.797557 139736437499904 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 190.47
I0902 11:27:40.048013 139736437499904 replay_runner.py:36] Average training steps per second: 190.47
I0902 11:27:40.503562 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 379 Episode length: 379 Return: -378.0
INFO:tensorflow:Average training steps per second: 187.12
I0902 11:27:46.071135 139736437499904 replay_runner.py:36] Average training steps per second: 187.12
I0902 11:27:46.409609 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.00
INFO:tensorflow:Starting iteration 3

Steps executed: 224 Episode length: 224 Return: -223.0
INFO:tensorflow:Average training steps per second: 186.25
I0902 11:27:52.021023 139736437499904 replay_runner.py:36] Average training steps per second: 186.25
I0902 11:27:52.207442 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.00
INFO:tensorflow:Starting iteration 4

Steps executed: 449 Episode length: 252 Return: -251.0
INFO:tensorflow:Average training steps per second: 188.65
I0902 11:27:57.751450 139736437499904 replay_runner.py:36] Average training steps per second: 188.65
I0902 11:27:58.151780 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.50
INFO:tensorflow:Starting iteration 5

Steps executed: 669 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.19
I0902 11:28:03.633766 139736437499904 replay_runner.py:36] Average training steps per second: 191.19
I0902 11:28:04.206202 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.00
INFO:tensorflow:Starting iteration 6

Steps executed: 256 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 187.63
I0902 11:28:09.773086 139736437499904 replay_runner.py:36] Average training steps per second: 187.63
I0902 11:28:09.989789 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 7

Steps executed: 273 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 193.02
I0902 11:28:15.413582 139736437499904 replay_runner.py:36] Average training steps per second: 193.02
I0902 11:28:15.645285 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.64
I0902 11:28:21.246675 139736437499904 replay_runner.py:36] Average training steps per second: 186.64
I0902 11:28:21.677345 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 11:28:21.924142 139736437499904 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 193.08
I0902 11:28:27.104139 139736437499904 replay_runner.py:36] Average training steps per second: 193.08
I0902 11:28:27.557336 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 216 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 188.21
I0902 11:28:33.124003 139736437499904 replay_runner.py:36] Average training steps per second: 188.21
I0902 11:28:33.308175 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 11

Steps executed: 170 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 186.63
I0902 11:28:38.911618 139736437499904 replay_runner.py:36] Average training steps per second: 186.63

Steps executed: 272 Episode length: 102 Return: -101.0
INFO:tensorflow:Starting iteration 12
I0902 11:28:39.413270 139736437499904 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 185.29

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 11:28:45.252186 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 11:28:45.493436 139736437499904 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.49
I0902 11:28:50.635736 139736437499904 replay_runner.py:36] Average training steps per second: 194.49
I0902 11:28:51.084482 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 281 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 189.65
I0902 11:28:56.608850 139736437499904 replay_runner.py:36] Average training steps per second: 189.65
I0902 11:28:56.852917 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 15

Steps executed: 495 Episode length: 495 Return: -494.0
INFO:tensorflow:Average training steps per second: 191.81
I0902 11:29:02.311921 139736437499904 replay_runner.py:36] Average training steps per second: 191.81
I0902 11:29:02.763592 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.00
INFO:tensorflow:Starting iteration 16

Steps executed: 262 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 187.34
I0902 11:29:08.351810 139736437499904 replay_runner.py:36] Average training steps per second: 187.34
I0902 11:29:08.597127 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 17

Steps executed: 233 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 194.33
I0902 11:29:14.001121 139736437499904 replay_runner.py:36] Average training steps per second: 194.33
I0902 11:29:14.211530 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 18

Steps executed: 273 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 184.93
I0902 11:29:19.871177 139736437499904 replay_runner.py:36] Average training steps per second: 184.93
I0902 11:29:20.114323 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 19
I0902 11:29:20.355224 139736437499904 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 194.25

Steps executed: 224 Episode length: 118 Return: -117.0
I0902 11:29:25.705640 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 20


Steps executed: 584 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 183.31
I0902 11:29:31.394818 139736437499904 replay_runner.py:36] Average training steps per second: 183.31
I0902 11:29:31.917443 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.50
INFO:tensorflow:Starting iteration 21

Steps executed: 281 Episode length: 281 Return: -280.0
INFO:tensorflow:Average training steps per second: 193.33
I0902 11:29:37.335597 139736437499904 replay_runner.py:36] Average training steps per second: 193.33
I0902 11:29:37.595748 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.00
INFO:tensorflow:Starting iteration 22
I0902 11:29:37.846487 139736437499904 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.81

Steps executed: 269 Episode length: 85 Return: -84.0.0
I0902 11:29:43.330088 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 23

Steps executed: 294 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 188.83
I0902 11:29:48.873680 139736437499904 replay_runner.py:36] Average training steps per second: 188.83
I0902 11:29:49.137997 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 24

Steps executed: 269 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 193.34
I0902 11:29:54.563457 139736437499904 replay_runner.py:36] Average training steps per second: 193.34
I0902 11:29:54.800560 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 25

Steps executed: 201 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 194.71
I0902 11:30:00.181491 139736437499904 replay_runner.py:36] Average training steps per second: 194.71
I0902 11:30:00.352654 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -66.00
INFO:tensorflow:Starting iteration 26
I0902 11:30:00.593179 139736437499904 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 209.39

Steps executed: 255 Episode length: 104 Return: -103.0
I0902 11:30:05.599444 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 27

Steps executed: 233 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 219.42
I0902 11:30:10.387097 139736437499904 replay_runner.py:36] Average training steps per second: 219.42
I0902 11:30:10.550905 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 28

Steps executed: 286 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 229.50
I0902 11:30:15.118717 139736437499904 replay_runner.py:36] Average training steps per second: 229.50
I0902 11:30:15.311194 139736437499904 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 29

Steps executed: 284 Episode length: 137 Return: -136.0
INFO:tensorflow:Average training steps per second: 259.26
I0902 11:30:19.369831 139736437499904 replay_runner.py:36] Average training steps per second: 259.26

Done fixed training!Episode length: 137 Return: -136.0