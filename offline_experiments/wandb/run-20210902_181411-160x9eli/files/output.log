Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 18:14:16.976399 139977662982144 run_experiment.py:549] Creating TrainRunner ...
I0902 18:14:16.983586 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:16.983702 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:16.983773 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:16.983833 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:16.983887 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:16.983960 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:16.984040 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:16.984118 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:16.984187 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:16.984252 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:16.984345 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:16.984440 139977662982144 dqn_agent.py:283] 	 seed: 1630606456983559
I0902 18:14:16.986227 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:16.986414 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:16.986523 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:16.986660 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:16.986796 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:16.986942 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:16.987097 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:16.987196 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:16.987305 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:17.010200 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:17.258474 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:17.267514 139977662982144 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:14:17.273945 139977662982144 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:17.274080 139977662982144 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:17.274155 139977662982144 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:17.274218 139977662982144 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:17.274277 139977662982144 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:17.274331 139977662982144 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:17.274411 139977662982144 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:17.274463 139977662982144 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:17.274515 139977662982144 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:17.274566 139977662982144 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:17.274722 139977662982144 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:17.274816 139977662982144 dqn_agent.py:283] 	 seed: 1630606457273917
I0902 18:14:17.276362 139977662982144 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:17.276508 139977662982144 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:17.276605 139977662982144 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:17.276713 139977662982144 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:17.276813 139977662982144 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:17.276940 139977662982144 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:17.277031 139977662982144 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:17.277157 139977662982144 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:17.277262 139977662982144 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:17.296182 139977662982144 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:17.311580 139977662982144 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:14:17.311747 139977662982144 replay_runner.py:41] Starting iteration 0
Steps executed: 268 Episode length: 88 Return: -543.92045403290086
INFO:tensorflow:Average training steps per second: 241.40
I0902 18:14:21.454448 139977662982144 replay_runner.py:36] Average training steps per second: 241.40
I0902 18:14:22.261276 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.36
INFO:tensorflow:Starting iteration 1
I0902 18:14:25.681941 139977662982144 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 323.51
I0902 18:14:28.773298 139977662982144 replay_runner.py:36] Average training steps per second: 323.51

Steps executed: 284 Episode length: 146 Return: -361.2179262502626
INFO:tensorflow:Starting iteration 2
I0902 18:14:32.337761 139977662982144 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 326.44
I0902 18:14:35.401527 139977662982144 replay_runner.py:36] Average training steps per second: 326.44

Steps executed: 225 Episode length: 100 Return: -182.38633321371435
INFO:tensorflow:Starting iteration 3

Steps executed: 265 Episode length: 94 Return: -248.726170003949453
INFO:tensorflow:Average training steps per second: 333.05
I0902 18:14:41.926454 139977662982144 replay_runner.py:36] Average training steps per second: 333.05
I0902 18:14:42.087765 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.72
INFO:tensorflow:Starting iteration 4

Steps executed: 351 Episode length: 265 Return: -304.58830242448386
INFO:tensorflow:Average training steps per second: 344.54
I0902 18:14:48.379118 139977662982144 replay_runner.py:36] Average training steps per second: 344.54
I0902 18:14:48.640290 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.82
INFO:tensorflow:Starting iteration 5

Steps executed: 469 Episode length: 355 Return: -357.72924572327337
INFO:tensorflow:Average training steps per second: 350.73
I0902 18:14:54.931013 139977662982144 replay_runner.py:36] Average training steps per second: 350.73
I0902 18:14:55.317353 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.64
INFO:tensorflow:Starting iteration 6

Steps executed: 261 Episode length: 123 Return: -169.98484583681184
INFO:tensorflow:Average training steps per second: 339.23
I0902 18:15:01.676718 139977662982144 replay_runner.py:36] Average training steps per second: 339.23
I0902 18:15:01.807355 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.17
INFO:tensorflow:Starting iteration 7

Steps executed: 318 Episode length: 318 Return: -541.09702513541844
INFO:tensorflow:Average training steps per second: 310.97
I0902 18:15:08.298346 139977662982144 replay_runner.py:36] Average training steps per second: 310.97
I0902 18:15:08.596271 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -541.10
INFO:tensorflow:Starting iteration 8

Steps executed: 1000 Episode length: 1000 Return: -143.685476868572
INFO:tensorflow:Average training steps per second: 309.21
I0902 18:15:15.014695 139977662982144 replay_runner.py:36] Average training steps per second: 309.21
I0902 18:15:16.591154 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.69
INFO:tensorflow:Starting iteration 9

Steps executed: 1000 Episode length: 1000 Return: -106.35683157157865
INFO:tensorflow:Average training steps per second: 313.51
I0902 18:15:23.055227 139977662982144 replay_runner.py:36] Average training steps per second: 313.51
I0902 18:15:24.340283 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.36
INFO:tensorflow:Starting iteration 10
I0902 18:15:27.761133 139977662982144 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 330.39

Steps executed: 1000 Episode length: 1000 Return: -133.10999197144804
I0902 18:15:32.516513 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.11
INFO:tensorflow:Starting iteration 11

Steps executed: 1000 Episode length: 1000 Return: -121.99703005102188
INFO:tensorflow:Average training steps per second: 331.80
I0902 18:15:39.092749 139977662982144 replay_runner.py:36] Average training steps per second: 331.80
I0902 18:15:40.570135 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 12
I0902 18:15:44.060560 139977662982144 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 340.59

Steps executed: 1000 Episode length: 1000 Return: -108.85273861083891
I0902 18:15:48.896811 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.85
INFO:tensorflow:Starting iteration 13
I0902 18:15:52.310111 139977662982144 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 346.14

Steps executed: 1000 Episode length: 1000 Return: -88.026866334908451
I0902 18:15:57.523250 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.03
INFO:tensorflow:Starting iteration 14

Steps executed: 213 Episode length: 162 Return: -376.1575506436676651
INFO:tensorflow:Average training steps per second: 354.00
I0902 18:16:03.757628 139977662982144 replay_runner.py:36] Average training steps per second: 354.00
I0902 18:16:03.901767 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.79
INFO:tensorflow:Starting iteration 15
I0902 18:16:07.364547 139977662982144 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 359.21

Steps executed: 1000 Episode length: 1000 Return: -69.947257073542861
I0902 18:16:12.043669 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.95
INFO:tensorflow:Starting iteration 16
I0902 18:16:15.441396 139977662982144 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 336.84

Steps executed: 1000 Episode length: 1000 Return: -64.267250353809561
I0902 18:16:20.317884 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.27
INFO:tensorflow:Starting iteration 17

Steps executed: 310 Episode length: 155 Return: -128.1179748024647561
INFO:tensorflow:Average training steps per second: 328.94
I0902 18:16:26.687553 139977662982144 replay_runner.py:36] Average training steps per second: 328.94
I0902 18:16:26.847934 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.09
INFO:tensorflow:Starting iteration 18

Steps executed: 52 Episode length: 52 Return: -125.399536190912847561
INFO:tensorflow:Average training steps per second: 313.99
I0902 18:16:33.235092 139977662982144 replay_runner.py:36] Average training steps per second: 313.99

Steps executed: 246 Episode length: 54 Return: -102.43425267710933561
INFO:tensorflow:Starting iteration 19

Steps executed: 406 Episode length: 406 Return: 205.19356659678698561
INFO:tensorflow:Average training steps per second: 326.97
I0902 18:16:39.638855 139977662982144 replay_runner.py:36] Average training steps per second: 326.97
I0902 18:16:40.072263 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: 205.19
INFO:tensorflow:Starting iteration 20

Steps executed: 68 Episode length: 68 Return: -146.379463147422888561
INFO:tensorflow:Average training steps per second: 333.43

Steps executed: 1068 Episode length: 1000 Return: 33.3075020095557161
I0902 18:16:48.808295 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.54
INFO:tensorflow:Starting iteration 21

Steps executed: 299 Episode length: 299 Return: -300.5016273015756461
INFO:tensorflow:Average training steps per second: 330.58
I0902 18:16:55.183281 139977662982144 replay_runner.py:36] Average training steps per second: 330.58
I0902 18:16:55.446708 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.50
INFO:tensorflow:Starting iteration 22

Steps executed: 459 Episode length: 459 Return: -281.1226829025808461
INFO:tensorflow:Average training steps per second: 340.00
I0902 18:17:01.782979 139977662982144 replay_runner.py:36] Average training steps per second: 340.00
I0902 18:17:02.407220 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.12
INFO:tensorflow:Starting iteration 23
I0902 18:17:05.886189 139977662982144 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 336.21

Steps executed: 319 Episode length: 319 Return: -207.5799015294100261
I0902 18:17:09.163254 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.58
INFO:tensorflow:Starting iteration 24

Steps executed: 435 Episode length: 435 Return: -322.5556698239250261
INFO:tensorflow:Average training steps per second: 341.38
I0902 18:17:15.592885 139977662982144 replay_runner.py:36] Average training steps per second: 341.38
I0902 18:17:16.162849 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.56
INFO:tensorflow:Starting iteration 25

Steps executed: 217 Episode length: 217 Return: -481.0905741164735261
INFO:tensorflow:Average training steps per second: 340.39
I0902 18:17:22.425033 139977662982144 replay_runner.py:36] Average training steps per second: 340.39
I0902 18:17:22.574970 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.09
INFO:tensorflow:Starting iteration 26
I0902 18:17:25.934873 139977662982144 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 329.73
I0902 18:17:28.967927 139977662982144 replay_runner.py:36] Average training steps per second: 329.73

Steps executed: 275 Episode length: 275 Return: -269.5593083099062261
INFO:tensorflow:Starting iteration 27

Steps executed: 1000 Episode length: 1000 Return: -28.158529777603448
INFO:tensorflow:Average training steps per second: 327.18
I0902 18:17:35.570134 139977662982144 replay_runner.py:36] Average training steps per second: 327.18
I0902 18:17:37.146018 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -28.16
INFO:tensorflow:Starting iteration 28
I0902 18:17:40.505251 139977662982144 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 364.26

Steps executed: 229 Episode length: 229 Return: -5.009204207185863448
I0902 18:17:43.415971 139977662982144 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.01
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 229 Return: -320.6690549903329448
INFO:tensorflow:Average training steps per second: 345.62
I0902 18:17:49.616545 139977662982144 replay_runner.py:36] Average training steps per second: 345.62

Done fixed training!Episode length: 229 Return: -320.6690549903329448