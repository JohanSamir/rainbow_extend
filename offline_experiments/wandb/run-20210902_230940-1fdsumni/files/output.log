I0902 23:09:47.264359 139850648303616 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.265172 139850648303616 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.336807 139850648303616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.338180 139850648303616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.338284 139850648303616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.338413 139850648303616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.338508 139850648303616 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.338591 139850648303616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:47.338779 139850648303616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.338901 139850648303616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.338988 139850648303616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.339248 139850648303616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.339430 139850648303616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.339509 139850648303616 dqn_agent.py:283] 	 seed: 1630624187336709
I0902 23:09:47.341839 139850648303616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.342004 139850648303616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:09:47.342113 139850648303616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.342270 139850648303616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.342393 139850648303616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.342515 139850648303616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.342609 139850648303616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.342674 139850648303616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.342764 139850648303616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.795605 139850648303616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in acrobot
I0902 23:09:54.026727 139850648303616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:54.075415 139850648303616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:54.108848 139850648303616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:54.109124 139850648303616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:54.109259 139850648303616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:54.109378 139850648303616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:54.109481 139850648303616 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:54.109580 139850648303616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:54.109679 139850648303616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:54.109778 139850648303616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:54.109876 139850648303616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:54.109975 139850648303616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:54.110073 139850648303616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:54.110169 139850648303616 dqn_agent.py:283] 	 seed: 1630624194108782
I0902 23:09:54.182449 139850648303616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:54.182680 139850648303616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:09:54.189433 139850648303616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:54.189549 139850648303616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:54.190895 139850648303616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:54.190990 139850648303616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:54.192105 139850648303616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:54.192206 139850648303616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:54.193499 139850648303616 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 8, please be patient, may be a while...
I0902 23:09:55.440713 139850648303616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:55.492702 139850648303616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:55.493100 139850648303616 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 122.58
I0902 23:10:03.651684 139850648303616 replay_runner.py:36] Average training steps per second: 122.58
I0902 23:10:04.731153 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 332 Episode length: 173 Return: -172.0
INFO:tensorflow:Average training steps per second: 189.51
I0902 23:10:10.227661 139850648303616 replay_runner.py:36] Average training steps per second: 189.51
I0902 23:10:10.528119 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.00
INFO:tensorflow:Starting iteration 2

Steps executed: 362 Episode length: 209 Return: -208.0
INFO:tensorflow:Average training steps per second: 184.90
I0902 23:10:16.197275 139850648303616 replay_runner.py:36] Average training steps per second: 184.90
I0902 23:10:16.482778 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.00
INFO:tensorflow:Starting iteration 3

Steps executed: 473 Episode length: 286 Return: -285.0
INFO:tensorflow:Average training steps per second: 180.21
I0902 23:10:22.267260 139850648303616 replay_runner.py:36] Average training steps per second: 180.21
I0902 23:10:22.694040 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.50
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.22
I0902 23:10:27.957489 139850648303616 replay_runner.py:36] Average training steps per second: 199.22
I0902 23:10:28.408526 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 255 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 185.15
I0902 23:10:34.051037 139850648303616 replay_runner.py:36] Average training steps per second: 185.15
I0902 23:10:34.262527 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 6

Steps executed: 489 Episode length: 489 Return: -488.0
INFO:tensorflow:Average training steps per second: 199.07
I0902 23:10:39.520458 139850648303616 replay_runner.py:36] Average training steps per second: 199.07
I0902 23:10:39.962510 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.00
INFO:tensorflow:Starting iteration 7

Steps executed: 286 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 187.77
I0902 23:10:45.547572 139850648303616 replay_runner.py:36] Average training steps per second: 187.77
I0902 23:10:45.775757 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 8

Steps executed: 269 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 204.84
I0902 23:10:50.889157 139850648303616 replay_runner.py:36] Average training steps per second: 204.84
I0902 23:10:51.119948 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 9

Steps executed: 237 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 192.32
I0902 23:10:56.567935 139850648303616 replay_runner.py:36] Average training steps per second: 192.32
I0902 23:10:56.756141 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.87
I0902 23:11:01.970759 139850648303616 replay_runner.py:36] Average training steps per second: 200.87
I0902 23:11:02.397053 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 193.09
I0902 23:11:07.824365 139850648303616 replay_runner.py:36] Average training steps per second: 193.09
I0902 23:11:07.990386 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 12

Steps executed: 211 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 197.35
I0902 23:11:13.292428 139850648303616 replay_runner.py:36] Average training steps per second: 197.35
I0902 23:11:13.486375 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 13
I0902 23:11:13.736164 139850648303616 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 194.70
I0902 23:11:18.872857 139850648303616 replay_runner.py:36] Average training steps per second: 194.70

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 14

Steps executed: 286 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 194.84
I0902 23:11:24.644304 139850648303616 replay_runner.py:36] Average training steps per second: 194.84
I0902 23:11:24.892844 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 15

Steps executed: 206 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 197.28
I0902 23:11:30.204529 139850648303616 replay_runner.py:36] Average training steps per second: 197.28
I0902 23:11:30.367174 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 16

Steps executed: 312 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 194.03
I0902 23:11:35.753633 139850648303616 replay_runner.py:36] Average training steps per second: 194.03
I0902 23:11:36.011932 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 17
I0902 23:11:36.241941 139850648303616 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.12
I0902 23:11:41.264720 139850648303616 replay_runner.py:36] Average training steps per second: 199.12
I0902 23:11:41.468723 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 18


Steps executed: 203 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 197.50
I0902 23:11:46.765916 139850648303616 replay_runner.py:36] Average training steps per second: 197.50
I0902 23:11:46.944525 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.52
I0902 23:11:52.254970 139850648303616 replay_runner.py:36] Average training steps per second: 197.52
I0902 23:11:52.643485 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 578 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.22
I0902 23:11:58.116377 139850648303616 replay_runner.py:36] Average training steps per second: 191.22
I0902 23:11:58.610539 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.78
I0902 23:12:03.786423 139850648303616 replay_runner.py:36] Average training steps per second: 202.78
I0902 23:12:04.185257 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0902 23:12:04.437112 139850648303616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.57
I0902 23:12:09.684957 139850648303616 replay_runner.py:36] Average training steps per second: 190.57
I0902 23:12:10.123067 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0902 23:12:10.360574 139850648303616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 201.28
I0902 23:12:15.329313 139850648303616 replay_runner.py:36] Average training steps per second: 201.28
I0902 23:12:15.739274 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 328 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 191.57
I0902 23:12:21.207623 139850648303616 replay_runner.py:36] Average training steps per second: 191.57
I0902 23:12:21.480629 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.33
INFO:tensorflow:Starting iteration 25

Steps executed: 238 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 201.25
I0902 23:12:26.691644 139850648303616 replay_runner.py:36] Average training steps per second: 201.25
I0902 23:12:26.882258 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.68
I0902 23:12:32.426785 139850648303616 replay_runner.py:36] Average training steps per second: 188.68
I0902 23:12:32.845290 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0902 23:12:33.077427 139850648303616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 201.78
I0902 23:12:38.033733 139850648303616 replay_runner.py:36] Average training steps per second: 201.78
I0902 23:12:38.448775 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 250 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 194.99
I0902 23:12:43.825387 139850648303616 replay_runner.py:36] Average training steps per second: 194.99
I0902 23:12:44.021196 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 234.66
I0902 23:12:48.514894 139850648303616 replay_runner.py:36] Average training steps per second: 234.66
I0902 23:12:48.634863 139850648303616 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.33