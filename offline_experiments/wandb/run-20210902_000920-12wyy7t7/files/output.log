Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0902 00:09:26.938977 139645366429696 run_experiment.py:549] Creating TrainRunner ...
I0902 00:09:26.948524 139645366429696 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:09:26.948724 139645366429696 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:09:26.948807 139645366429696 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:09:26.948876 139645366429696 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:09:26.948939 139645366429696 dqn_agent.py:275] 	 update_period: 4
I0902 00:09:26.949267 139645366429696 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:09:26.949411 139645366429696 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:09:26.949489 139645366429696 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:09:26.949556 139645366429696 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:09:26.949620 139645366429696 dqn_agent.py:280] 	 optimizer: adam
I0902 00:09:26.949686 139645366429696 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:09:26.949888 139645366429696 dqn_agent.py:283] 	 seed: 1630541366948470
I0902 00:09:26.953303 139645366429696 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:09:26.953617 139645366429696 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:09:26.953787 139645366429696 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:09:26.953943 139645366429696 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:09:26.954134 139645366429696 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:09:26.954361 139645366429696 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:09:26.954532 139645366429696 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:09:26.954656 139645366429696 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:09:26.954813 139645366429696 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:09:26.999600 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:27.461734 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:27.477688 139645366429696 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:09:27.486914 139645366429696 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:09:27.487164 139645366429696 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:09:27.487293 139645366429696 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:09:27.487387 139645366429696 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:09:27.487509 139645366429696 dqn_agent.py:275] 	 update_period: 4
I0902 00:09:27.487669 139645366429696 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:09:27.487818 139645366429696 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:09:27.487934 139645366429696 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:09:27.488120 139645366429696 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:09:27.488240 139645366429696 dqn_agent.py:280] 	 optimizer: adam
I0902 00:09:27.488339 139645366429696 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:09:27.488440 139645366429696 dqn_agent.py:283] 	 seed: 1630541367486848
I0902 00:09:27.491075 139645366429696 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:09:27.491265 139645366429696 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:09:27.491382 139645366429696 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:09:27.491703 139645366429696 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:09:27.491878 139645366429696 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:09:27.491978 139645366429696 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:09:27.492085 139645366429696 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:09:27.492257 139645366429696 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:09:27.492394 139645366429696 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:09:27.529585 139645366429696 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:27.553426 139645366429696 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:09:27.553747 139645366429696 replay_runner.py:41] Starting iteration 0
Steps executed: 315 Episode length: 315 Return: -314.0
INFO:tensorflow:Average training steps per second: 139.60
I0902 00:09:34.717357 139645366429696 replay_runner.py:36] Average training steps per second: 139.60
I0902 00:09:36.130697 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.00
INFO:tensorflow:Starting iteration 1

Steps executed: 478 Episode length: 478 Return: -477.0
INFO:tensorflow:Average training steps per second: 192.65
I0902 00:09:41.567088 139645366429696 replay_runner.py:36] Average training steps per second: 192.65
I0902 00:09:41.980438 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -477.00
INFO:tensorflow:Starting iteration 2

Steps executed: 401 Episode length: 273 Return: -272.0
INFO:tensorflow:Average training steps per second: 198.31
I0902 00:09:47.263396 139645366429696 replay_runner.py:36] Average training steps per second: 198.31
I0902 00:09:47.619089 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.50
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.92
I0902 00:09:52.885970 139645366429696 replay_runner.py:36] Average training steps per second: 198.92
I0902 00:09:53.274340 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 00:09:53.567137 139645366429696 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.74

Steps executed: 433 Episode length: 433 Return: -432.0
I0902 00:09:59.035777 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.00
INFO:tensorflow:Starting iteration 5

Steps executed: 294 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 199.24
I0902 00:10:04.456650 139645366429696 replay_runner.py:36] Average training steps per second: 199.24
I0902 00:10:04.711571 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.00
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.52
I0902 00:10:10.052008 139645366429696 replay_runner.py:36] Average training steps per second: 196.52
I0902 00:10:10.467373 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 00:10:10.694925 139645366429696 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 201.76
I0902 00:10:15.651579 139645366429696 replay_runner.py:36] Average training steps per second: 201.76
I0902 00:10:16.100894 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 218 Episode length: 218 Return: -217.0
INFO:tensorflow:Average training steps per second: 197.19
I0902 00:10:21.416075 139645366429696 replay_runner.py:36] Average training steps per second: 197.19
I0902 00:10:21.608618 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.00
INFO:tensorflow:Starting iteration 9

Steps executed: 279 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 192.45
I0902 00:10:27.047723 139645366429696 replay_runner.py:36] Average training steps per second: 192.45
I0902 00:10:27.287889 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 10

Steps executed: 255 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 199.13
I0902 00:10:32.550630 139645366429696 replay_runner.py:36] Average training steps per second: 199.13
I0902 00:10:32.766712 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 11

Steps executed: 275 Episode length: 151 Return: -150.0
INFO:tensorflow:Average training steps per second: 197.70
I0902 00:10:38.065869 139645366429696 replay_runner.py:36] Average training steps per second: 197.70
I0902 00:10:38.277658 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.50
INFO:tensorflow:Starting iteration 12

Steps executed: 230 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 197.35
I0902 00:10:43.582022 139645366429696 replay_runner.py:36] Average training steps per second: 197.35
I0902 00:10:43.777367 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.67
INFO:tensorflow:Starting iteration 13


Steps executed: 254 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 199.79
I0902 00:10:49.018929 139645366429696 replay_runner.py:36] Average training steps per second: 199.79
I0902 00:10:49.235234 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 14

Steps executed: 258 Episode length: 159 Return: -158.0
INFO:tensorflow:Average training steps per second: 195.76
I0902 00:10:54.577161 139645366429696 replay_runner.py:36] Average training steps per second: 195.76
I0902 00:10:54.798896 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 15

Steps executed: 290 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 198.38
I0902 00:11:00.086628 139645366429696 replay_runner.py:36] Average training steps per second: 198.38
I0902 00:11:00.337048 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 16

Steps executed: 204 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 193.96
I0902 00:11:05.738604 139645366429696 replay_runner.py:36] Average training steps per second: 193.96
I0902 00:11:05.916299 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 17

Steps executed: 302 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 195.66
I0902 00:11:11.269830 139645366429696 replay_runner.py:36] Average training steps per second: 195.66
I0902 00:11:11.517238 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 18
I0902 00:11:11.752879 139645366429696 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.04
I0902 00:11:16.933719 139645366429696 replay_runner.py:36] Average training steps per second: 193.04

Steps executed: 231 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 197.14
I0902 00:11:22.438136 139645366429696 replay_runner.py:36] Average training steps per second: 197.14
I0902 00:11:22.624996 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 20
I0902 00:11:22.859532 139645366429696 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 195.57
I0902 00:11:27.973296 139645366429696 replay_runner.py:36] Average training steps per second: 195.57
I0902 00:11:28.207874 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 21

Steps executed: 270 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 200.02
I0902 00:11:33.433867 139645366429696 replay_runner.py:36] Average training steps per second: 200.02
I0902 00:11:33.664765 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.33
INFO:tensorflow:Starting iteration 22

Steps executed: 280 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 196.17
I0902 00:11:39.007600 139645366429696 replay_runner.py:36] Average training steps per second: 196.17


Steps executed: 211 Episode length: 109 Return: -108.0
INFO:tensorflow:Starting iteration 23

Steps executed: 227 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 200.61
I0902 00:11:44.414496 139645366429696 replay_runner.py:36] Average training steps per second: 200.61
I0902 00:11:44.598434 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.50
INFO:tensorflow:Starting iteration 24

Steps executed: 267 Episode length: 95 Return: -94.000
INFO:tensorflow:Average training steps per second: 196.12
I0902 00:11:49.949305 139645366429696 replay_runner.py:36] Average training steps per second: 196.12
I0902 00:11:50.170933 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 25


Steps executed: 248 Episode length: 89 Return: -88.000
INFO:tensorflow:Average training steps per second: 210.21
I0902 00:11:55.163827 139645366429696 replay_runner.py:36] Average training steps per second: 210.21
I0902 00:11:55.361556 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.67
INFO:tensorflow:Starting iteration 26

Steps executed: 224 Episode length: 72 Return: -71.000
INFO:tensorflow:Average training steps per second: 207.13
I0902 00:12:00.473475 139645366429696 replay_runner.py:36] Average training steps per second: 207.13
I0902 00:12:00.694282 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 27

Steps executed: 239 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 210.46
I0902 00:12:05.671322 139645366429696 replay_runner.py:36] Average training steps per second: 210.46
I0902 00:12:05.864629 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 28

Steps executed: 249 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 205.00
I0902 00:12:10.969626 139645366429696 replay_runner.py:36] Average training steps per second: 205.00
I0902 00:12:11.188571 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 200.75
I0902 00:12:16.423950 139645366429696 replay_runner.py:36] Average training steps per second: 200.75
I0902 00:12:16.647808 139645366429696 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00