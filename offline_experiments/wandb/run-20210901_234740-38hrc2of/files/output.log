Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0901 23:47:47.036116 140268994136064 run_experiment.py:549] Creating TrainRunner ...
I0901 23:47:47.045827 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:47:47.046173 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:47:47.046317 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:47:47.046432 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:47:47.046553 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:47:47.046667 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:47:47.046777 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:47:47.046890 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:47:47.047001 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:47:47.047104 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:47:47.047263 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:47:47.047388 140268994136064 dqn_agent.py:283] 	 seed: 1630540067045752
I0901 23:47:47.051225 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:47:47.051500 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:47:47.051668 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:47:47.051805 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:47:47.051933 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:47:47.052074 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:47:47.052202 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:47:47.052330 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:47:47.052450 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:47:47.095469 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:47.560335 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:47.574625 140268994136064 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:47:47.582776 140268994136064 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:47:47.583106 140268994136064 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:47:47.583325 140268994136064 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:47:47.583467 140268994136064 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:47:47.583583 140268994136064 dqn_agent.py:275] 	 update_period: 4
I0901 23:47:47.583803 140268994136064 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:47:47.583948 140268994136064 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:47:47.584096 140268994136064 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:47:47.584215 140268994136064 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:47:47.584411 140268994136064 dqn_agent.py:280] 	 optimizer: adam
I0901 23:47:47.584578 140268994136064 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:47:47.584727 140268994136064 dqn_agent.py:283] 	 seed: 1630540067582713
I0901 23:47:47.586905 140268994136064 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:47:47.587031 140268994136064 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:47:47.587105 140268994136064 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:47:47.587170 140268994136064 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:47:47.587253 140268994136064 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:47:47.587315 140268994136064 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:47:47.587412 140268994136064 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:47:47.587466 140268994136064 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:47:47.587517 140268994136064 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:47:47.621734 140268994136064 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:47:47.644150 140268994136064 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:47:47.644418 140268994136064 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.32
I0901 23:47:54.526062 140268994136064 replay_runner.py:36] Average training steps per second: 145.32
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:47:56.039582 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 23:47:56.284968 140268994136064 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 204.61
I0901 23:48:01.173022 140268994136064 replay_runner.py:36] Average training steps per second: 204.61
I0901 23:48:01.581787 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 210 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 194.71
I0901 23:48:06.968691 140268994136064 replay_runner.py:36] Average training steps per second: 194.71
I0901 23:48:07.156724 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.57
I0901 23:48:12.307396 140268994136064 replay_runner.py:36] Average training steps per second: 203.57
I0901 23:48:12.737438 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 23:48:12.969436 140268994136064 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.30
I0901 23:48:18.038480 140268994136064 replay_runner.py:36] Average training steps per second: 197.30
I0901 23:48:18.450884 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:48:18.696646 140268994136064 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.19
I0901 23:48:23.794207 140268994136064 replay_runner.py:36] Average training steps per second: 196.19
I0901 23:48:24.215597 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 23:48:24.450373 140268994136064 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.67
I0901 23:48:29.614540 140268994136064 replay_runner.py:36] Average training steps per second: 193.67
I0901 23:48:30.045036 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:48:30.286735 140268994136064 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 197.47
I0901 23:48:35.351480 140268994136064 replay_runner.py:36] Average training steps per second: 197.47
I0901 23:48:35.770820 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:48:36.021311 140268994136064 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 199.33

Steps executed: 200 Episode length: 92 Return: -91.0.0
I0901 23:48:41.229197 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.45
I0901 23:48:46.469417 140268994136064 replay_runner.py:36] Average training steps per second: 200.45
I0901 23:48:46.917746 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 282 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 197.79
I0901 23:48:52.231127 140268994136064 replay_runner.py:36] Average training steps per second: 197.79
I0901 23:48:52.468904 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 11

Steps executed: 268 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 206.11
I0901 23:48:57.565626 140268994136064 replay_runner.py:36] Average training steps per second: 206.11
I0901 23:48:57.801708 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00
INFO:tensorflow:Starting iteration 12

Steps executed: 77 Episode length: 77 Return: -76.03.0
INFO:tensorflow:Average training steps per second: 200.55
I0901 23:49:03.040673 140268994136064 replay_runner.py:36] Average training steps per second: 200.55

Steps executed: 233 Episode length: 156 Return: -155.0
INFO:tensorflow:Starting iteration 13

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.59
I0901 23:49:08.584166 140268994136064 replay_runner.py:36] Average training steps per second: 195.59
I0901 23:49:08.999851 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 313 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 197.30
I0901 23:49:14.314975 140268994136064 replay_runner.py:36] Average training steps per second: 197.30
I0901 23:49:14.590346 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.33
INFO:tensorflow:Starting iteration 15

Steps executed: 202 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 196.08
I0901 23:49:19.934816 140268994136064 replay_runner.py:36] Average training steps per second: 196.08
I0901 23:49:20.104667 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 16


Steps executed: 251 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 201.07
I0901 23:49:25.328529 140268994136064 replay_runner.py:36] Average training steps per second: 201.07
I0901 23:49:25.546917 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 17
I0901 23:49:25.785313 140268994136064 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 196.22
I0901 23:49:30.882061 140268994136064 replay_runner.py:36] Average training steps per second: 196.22

Steps executed: 202 Episode length: 117 Return: -116.0
INFO:tensorflow:Starting iteration 18

Steps executed: 265 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 192.99
I0901 23:49:36.467664 140268994136064 replay_runner.py:36] Average training steps per second: 192.99
I0901 23:49:36.690627 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 19

Steps executed: 204 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.09
I0901 23:49:41.928399 140268994136064 replay_runner.py:36] Average training steps per second: 200.09
I0901 23:49:42.087632 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 20

Steps executed: 308 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 199.93
I0901 23:49:47.315309 140268994136064 replay_runner.py:36] Average training steps per second: 199.93
I0901 23:49:47.572839 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 21

Steps executed: 97 Episode length: 97 Return: -96.08.0
INFO:tensorflow:Average training steps per second: 200.76
I0901 23:49:52.801025 140268994136064 replay_runner.py:36] Average training steps per second: 200.76

Steps executed: 597 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 22

Steps executed: 245 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 197.03
I0901 23:49:58.701359 140268994136064 replay_runner.py:36] Average training steps per second: 197.03
I0901 23:49:58.913574 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 23

Steps executed: 234 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 204.88
I0901 23:50:04.034573 140268994136064 replay_runner.py:36] Average training steps per second: 204.88
I0901 23:50:04.227422 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 190.85
I0901 23:50:09.695007 140268994136064 replay_runner.py:36] Average training steps per second: 190.85
I0901 23:50:09.884309 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.33
INFO:tensorflow:Starting iteration 25

Steps executed: 211 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 203.93
I0901 23:50:15.040106 140268994136064 replay_runner.py:36] Average training steps per second: 203.93
I0901 23:50:15.237792 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.33
INFO:tensorflow:Starting iteration 26

Steps executed: 268 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 200.71
I0901 23:50:20.453617 140268994136064 replay_runner.py:36] Average training steps per second: 200.71
I0901 23:50:20.678129 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 27

Steps executed: 239 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 194.36
I0901 23:50:26.045997 140268994136064 replay_runner.py:36] Average training steps per second: 194.36
I0901 23:50:26.245931 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 201.37
I0901 23:50:31.457247 140268994136064 replay_runner.py:36] Average training steps per second: 201.37
I0901 23:50:31.649902 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 202.59
I0901 23:50:36.825122 140268994136064 replay_runner.py:36] Average training steps per second: 202.59
I0901 23:50:36.983877 140268994136064 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00