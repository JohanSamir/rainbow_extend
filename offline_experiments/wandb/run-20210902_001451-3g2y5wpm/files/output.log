Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 00:14:57.922168 140252174653440 run_experiment.py:549] Creating TrainRunner ...
I0902 00:14:57.932814 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:14:57.933050 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:14:57.933268 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:14:57.933407 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:14:57.933542 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:14:57.933646 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:14:57.933891 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:14:57.934046 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:14:57.934179 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:14:57.934253 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:14:57.934325 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:14:57.934394 140252174653440 dqn_agent.py:283] 	 seed: 1630541697932753
I0902 00:14:57.937324 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:14:57.937568 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:14:57.937687 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:14:57.937784 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:14:57.937874 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:14:57.937948 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:14:57.938062 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:14:57.938202 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:14:57.938388 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:14:57.972424 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:14:58.315670 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:14:58.325845 140252174653440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:14:58.335180 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:14:58.335349 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:14:58.335466 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:14:58.335531 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:14:58.335597 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:14:58.335660 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:14:58.335787 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:14:58.335868 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:14:58.335992 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:14:58.336163 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:14:58.336256 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:14:58.336333 140252174653440 dqn_agent.py:283] 	 seed: 1630541698335138
I0902 00:14:58.337901 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:14:58.338013 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:14:58.338086 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:14:58.338168 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:14:58.338227 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:14:58.338314 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:14:58.338376 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:14:58.338438 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:14:58.338509 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:14:58.365375 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:14:58.387677 140252174653440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:14:58.387924 140252174653440 replay_runner.py:41] Starting iteration 0
Steps executed: 207 Episode length: 89 Return: -341.05065260052646
INFO:tensorflow:Average training steps per second: 170.22
I0902 00:15:04.262833 140252174653440 replay_runner.py:36] Average training steps per second: 170.22
I0902 00:15:05.407709 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.52
INFO:tensorflow:Starting iteration 1

Steps executed: 251 Episode length: 98 Return: -343.149713175446254
INFO:tensorflow:Average training steps per second: 236.57
I0902 00:15:13.828836 140252174653440 replay_runner.py:36] Average training steps per second: 236.57
I0902 00:15:14.053350 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -392.93
INFO:tensorflow:Starting iteration 2

Steps executed: 251 Episode length: 149 Return: -63.078105755798026
INFO:tensorflow:Average training steps per second: 237.22
I0902 00:15:22.576705 140252174653440 replay_runner.py:36] Average training steps per second: 237.22
I0902 00:15:22.792502 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.31
INFO:tensorflow:Starting iteration 3
I0902 00:15:27.130624 140252174653440 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 230.74
I0902 00:15:31.464974 140252174653440 replay_runner.py:36] Average training steps per second: 230.74

Steps executed: 215 Episode length: 215 Return: -155.46977617834796
INFO:tensorflow:Starting iteration 4

Steps executed: 605 Episode length: 470 Return: -224.75269040423564
INFO:tensorflow:Average training steps per second: 225.64
I0902 00:15:40.334911 140252174653440 replay_runner.py:36] Average training steps per second: 225.64
I0902 00:15:41.301845 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.75
INFO:tensorflow:Starting iteration 5
I0902 00:15:45.538655 140252174653440 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 232.93

Steps executed: 620 Episode length: 620 Return: -255.40596831665877
I0902 00:15:50.959468 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.41
INFO:tensorflow:Starting iteration 6
I0902 00:15:55.329605 140252174653440 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 227.48

Steps executed: 1000 Episode length: 1000 Return: -124.10794373647906
I0902 00:16:01.627215 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.11
INFO:tensorflow:Starting iteration 7
I0902 00:16:05.925750 140252174653440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 229.94
I0902 00:16:10.275008 140252174653440 replay_runner.py:36] Average training steps per second: 229.94

Steps executed: 686 Episode length: 686 Return: -137.9576038977680206
INFO:tensorflow:Starting iteration 8

Steps executed: 449 Episode length: 449 Return: -241.4458006824911806
INFO:tensorflow:Average training steps per second: 226.62
I0902 00:16:20.835794 140252174653440 replay_runner.py:36] Average training steps per second: 226.62
I0902 00:16:21.503401 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.45
INFO:tensorflow:Starting iteration 9
I0902 00:16:25.825716 140252174653440 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 229.71

Steps executed: 269 Episode length: 269 Return: -560.0649163201698806
I0902 00:16:30.499107 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -560.06
INFO:tensorflow:Starting iteration 10
I0902 00:16:34.764797 140252174653440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 225.90

Steps executed: 1000 Episode length: 1000 Return: -97.215116940140026
I0902 00:16:41.330317 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.22
INFO:tensorflow:Starting iteration 11

Steps executed: 117 Episode length: 117 Return: -49.16100486908043026
INFO:tensorflow:Average training steps per second: 232.80

Steps executed: 1117 Episode length: 1000 Return: -107.43001825540472
I0902 00:16:51.471668 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.30
INFO:tensorflow:Starting iteration 12
I0902 00:16:55.597301 140252174653440 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 244.30

Steps executed: 693 Episode length: 693 Return: -166.5302880758637472
I0902 00:17:00.888090 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.53
INFO:tensorflow:Starting iteration 13
I0902 00:17:04.995556 140252174653440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 249.02
I0902 00:17:09.011683 140252174653440 replay_runner.py:36] Average training steps per second: 249.02

Steps executed: 1000 Episode length: 1000 Return: -91.285858180410932
INFO:tensorflow:Starting iteration 14

Steps executed: 391 Episode length: 229 Return: -242.3118821894297232
INFO:tensorflow:Average training steps per second: 244.88
I0902 00:17:20.127523 140252174653440 replay_runner.py:36] Average training steps per second: 244.88
I0902 00:17:20.518578 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.43
INFO:tensorflow:Starting iteration 15

Steps executed: 331 Episode length: 331 Return: -26.64890034906355332
INFO:tensorflow:Average training steps per second: 250.83
I0902 00:17:28.504943 140252174653440 replay_runner.py:36] Average training steps per second: 250.83
I0902 00:17:28.990077 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.65
INFO:tensorflow:Starting iteration 16

Steps executed: 294 Episode length: 162 Return: -81.48065801385462332
INFO:tensorflow:Average training steps per second: 256.66
I0902 00:17:36.984245 140252174653440 replay_runner.py:36] Average training steps per second: 256.66
I0902 00:17:37.201454 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.26
INFO:tensorflow:Starting iteration 17

Steps executed: 306 Episode length: 306 Return: -8.706483925245664332
INFO:tensorflow:Average training steps per second: 256.62
I0902 00:17:45.169218 140252174653440 replay_runner.py:36] Average training steps per second: 256.62
I0902 00:17:45.579628 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -8.71
INFO:tensorflow:Starting iteration 18

Steps executed: 289 Episode length: 116 Return: -476.2441784144135432
INFO:tensorflow:Average training steps per second: 276.82
I0902 00:17:53.187162 140252174653440 replay_runner.py:36] Average training steps per second: 276.82
I0902 00:17:53.410347 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.26
INFO:tensorflow:Starting iteration 19

Steps executed: 288 Episode length: 288 Return: -242.7506623698544732
INFO:tensorflow:Average training steps per second: 297.34
I0902 00:18:00.515191 140252174653440 replay_runner.py:36] Average training steps per second: 297.34
I0902 00:18:00.830049 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.75
INFO:tensorflow:Starting iteration 20

Steps executed: 308 Episode length: 173 Return: 23.739351849957464732
INFO:tensorflow:Average training steps per second: 306.03
I0902 00:18:07.640903 140252174653440 replay_runner.py:36] Average training steps per second: 306.03
I0902 00:18:07.850557 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.70
INFO:tensorflow:Starting iteration 21

Steps executed: 270 Episode length: 270 Return: 284.69220745443354732
INFO:tensorflow:Average training steps per second: 310.35
I0902 00:18:14.641222 140252174653440 replay_runner.py:36] Average training steps per second: 310.35
I0902 00:18:14.886846 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: 284.69
INFO:tensorflow:Starting iteration 22

Steps executed: 379 Episode length: 227 Return: -226.0396059401574732
INFO:tensorflow:Average training steps per second: 313.77
I0902 00:18:21.564932 140252174653440 replay_runner.py:36] Average training steps per second: 313.77
I0902 00:18:21.869018 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.18
INFO:tensorflow:Starting iteration 23
I0902 00:18:25.200974 140252174653440 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 306.11

Steps executed: 210 Episode length: 210 Return: -291.0619603366972732
I0902 00:18:28.647191 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.06
INFO:tensorflow:Starting iteration 24

Steps executed: 316 Episode length: 136 Return: -211.6200499100100432
INFO:tensorflow:Average training steps per second: 304.88
I0902 00:18:35.199727 140252174653440 replay_runner.py:36] Average training steps per second: 304.88
I0902 00:18:35.437248 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.50
INFO:tensorflow:Starting iteration 25

Steps executed: 330 Episode length: 330 Return: -391.8763777264074432
INFO:tensorflow:Average training steps per second: 311.05
I0902 00:18:41.933435 140252174653440 replay_runner.py:36] Average training steps per second: 311.05
I0902 00:18:42.271871 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.88
INFO:tensorflow:Starting iteration 26
I0902 00:18:45.377626 140252174653440 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 308.70

Steps executed: 298 Episode length: 117 Return: -317.8326648540011832
I0902 00:18:48.794968 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.99
INFO:tensorflow:Starting iteration 27
I0902 00:18:51.879494 140252174653440 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 312.45

Steps executed: 1000 Episode length: 1000 Return: -6.5033349791760852
I0902 00:18:56.740816 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -6.50
INFO:tensorflow:Starting iteration 28

Steps executed: 218 Episode length: 77 Return: -122.42791516276282852
INFO:tensorflow:Average training steps per second: 329.82
I0902 00:19:03.022631 140252174653440 replay_runner.py:36] Average training steps per second: 329.82
I0902 00:19:03.101651 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.61
INFO:tensorflow:Starting iteration 29

Steps executed: 395 Episode length: 216 Return: -376.4409689903832852
INFO:tensorflow:Average training steps per second: 324.68
I0902 00:19:09.369334 140252174653440 replay_runner.py:36] Average training steps per second: 324.68

Done fixed training!Episode length: 216 Return: -376.4409689903832852