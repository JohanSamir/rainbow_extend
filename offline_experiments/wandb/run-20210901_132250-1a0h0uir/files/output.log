Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0901 13:22:55.987705 139683016574976 run_experiment.py:549] Creating TrainRunner ...
I0901 13:22:55.995329 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:55.995460 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:55.995545 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:55.995614 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:55.995679 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:55.995739 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:55.995820 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:55.995934 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:55.996028 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:55.996118 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:55.996184 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:55.996254 139683016574976 dqn_agent.py:283] 	 seed: 1630502575995298
I0901 13:22:55.998085 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:55.998223 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:55.998309 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:55.998380 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:55.998444 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:55.998507 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:55.998587 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:55.998682 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:55.998756 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:56.115359 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:56.364470 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:56.373668 139683016574976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:22:56.379331 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:22:56.379440 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:22:56.379505 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:22:56.379560 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:22:56.379610 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 13:22:56.379677 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:22:56.379758 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:22:56.379829 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:22:56.379909 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:22:56.380007 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:22:56.380123 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:22:56.380293 139683016574976 dqn_agent.py:283] 	 seed: 1630502576379308
I0901 13:22:56.382485 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:22:56.382693 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:22:56.382924 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:22:56.383085 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:22:56.383210 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:22:56.383333 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:22:56.383429 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:22:56.383502 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:22:56.383583 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:22:56.404805 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:22:56.418947 139683016574976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:22:56.419102 139683016574976 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 223.46
I0901 13:23:00.894369 139683016574976 replay_runner.py:36] Average training steps per second: 223.46
Steps executed: 230 Episode length: 113 Return: -405.84151917087036
I0901 13:23:01.650853 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.51
INFO:tensorflow:Starting iteration 1
I0901 13:23:04.859923 139683016574976 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 311.93
I0901 13:23:08.066075 139683016574976 replay_runner.py:36] Average training steps per second: 311.93

Steps executed: 253 Episode length: 100 Return: -10.260409880339495
INFO:tensorflow:Starting iteration 2

Steps executed: 278 Episode length: 278 Return: -124.11182186538612
INFO:tensorflow:Average training steps per second: 303.28
I0901 13:23:14.869739 139683016574976 replay_runner.py:36] Average training steps per second: 303.28
I0901 13:23:15.097627 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.11
INFO:tensorflow:Starting iteration 3
I0901 13:23:18.479363 139683016574976 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 314.92

Steps executed: 281 Episode length: 140 Return: -212.46559219216052
I0901 13:23:21.843000 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.92
INFO:tensorflow:Starting iteration 4

Steps executed: 333 Episode length: 160 Return: -256.33874623963392
INFO:tensorflow:Average training steps per second: 319.99
I0901 13:23:28.414169 139683016574976 replay_runner.py:36] Average training steps per second: 319.99
I0901 13:23:28.641769 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.63
INFO:tensorflow:Starting iteration 5

Steps executed: 251 Episode length: 163 Return: -334.94585006410625
INFO:tensorflow:Average training steps per second: 315.83
I0901 13:23:35.162223 139683016574976 replay_runner.py:36] Average training steps per second: 315.83
I0901 13:23:35.322388 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.51
INFO:tensorflow:Starting iteration 6
I0901 13:23:38.758350 139683016574976 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 318.77

Steps executed: 286 Episode length: 198 Return: -209.09216589202225
I0901 13:23:42.101363 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.98
INFO:tensorflow:Starting iteration 7

Steps executed: 87 Episode length: 87 Return: 27.087433251543303225
INFO:tensorflow:Average training steps per second: 328.42
I0901 13:23:48.630483 139683016574976 replay_runner.py:36] Average training steps per second: 328.42

Steps executed: 816 Episode length: 729 Return: -648.37251045135255
INFO:tensorflow:Starting iteration 8

Steps executed: 234 Episode length: 107 Return: -114.16076766484339
INFO:tensorflow:Average training steps per second: 314.08
I0901 13:23:56.657008 139683016574976 replay_runner.py:36] Average training steps per second: 314.08
I0901 13:23:56.781825 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.92
INFO:tensorflow:Starting iteration 9

Steps executed: 265 Episode length: 80 Return: -111.758618874131593
INFO:tensorflow:Average training steps per second: 314.89
I0901 13:24:03.419901 139683016574976 replay_runner.py:36] Average training steps per second: 314.89
I0901 13:24:03.564951 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.93
INFO:tensorflow:Starting iteration 10
I0901 13:24:07.039638 139683016574976 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 321.10

Steps executed: 672 Episode length: 596 Return: -205.21637877779063
I0901 13:24:10.892196 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.38
INFO:tensorflow:Starting iteration 11

Steps executed: 254 Episode length: 56 Return: -387.890949972828493
INFO:tensorflow:Average training steps per second: 320.58
I0901 13:24:17.406934 139683016574976 replay_runner.py:36] Average training steps per second: 320.58
I0901 13:24:17.570058 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.68
INFO:tensorflow:Starting iteration 12

Steps executed: 248 Episode length: 61 Return: -273.320033309979863
INFO:tensorflow:Average training steps per second: 332.93
I0901 13:24:24.028966 139683016574976 replay_runner.py:36] Average training steps per second: 332.93
I0901 13:24:24.178235 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.51
INFO:tensorflow:Starting iteration 13

Steps executed: 257 Episode length: 132 Return: -510.42037713404216
INFO:tensorflow:Average training steps per second: 331.80
I0901 13:24:30.693713 139683016574976 replay_runner.py:36] Average training steps per second: 331.80
I0901 13:24:30.853572 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.96
INFO:tensorflow:Starting iteration 14

Steps executed: 445 Episode length: 380 Return: -893.77541771011626
INFO:tensorflow:Average training steps per second: 337.08
I0901 13:24:37.416491 139683016574976 replay_runner.py:36] Average training steps per second: 337.08
I0901 13:24:37.819998 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -513.61
INFO:tensorflow:Starting iteration 15

Steps executed: 210 Episode length: 60 Return: -530.537355163461126
INFO:tensorflow:Average training steps per second: 346.80
I0901 13:24:44.296981 139683016574976 replay_runner.py:36] Average training steps per second: 346.80
I0901 13:24:44.424154 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -571.25
INFO:tensorflow:Starting iteration 16

Steps executed: 303 Episode length: 154 Return: -241.09628447785502
INFO:tensorflow:Average training steps per second: 338.46
I0901 13:24:50.975626 139683016574976 replay_runner.py:36] Average training steps per second: 338.46
I0901 13:24:51.171255 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.70
INFO:tensorflow:Starting iteration 17

Steps executed: 263 Episode length: 90 Return: -620.838572901212813
INFO:tensorflow:Average training steps per second: 332.92
I0901 13:24:57.756844 139683016574976 replay_runner.py:36] Average training steps per second: 332.92
I0901 13:24:57.907254 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.17
INFO:tensorflow:Starting iteration 18

Steps executed: 205 Episode length: 61 Return: -610.943217066799513
INFO:tensorflow:Average training steps per second: 332.90
I0901 13:25:04.495075 139683016574976 replay_runner.py:36] Average training steps per second: 332.90
I0901 13:25:04.606650 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -595.33
INFO:tensorflow:Starting iteration 19

Steps executed: 253 Episode length: 132 Return: -274.71228468481044
INFO:tensorflow:Average training steps per second: 326.33
I0901 13:25:11.237426 139683016574976 replay_runner.py:36] Average training steps per second: 326.33
I0901 13:25:11.393295 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.03
INFO:tensorflow:Starting iteration 20
I0901 13:25:14.936067 139683016574976 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 329.74
I0901 13:25:17.969180 139683016574976 replay_runner.py:36] Average training steps per second: 329.74

Steps executed: 252 Episode length: 144 Return: -276.74635672683985
INFO:tensorflow:Starting iteration 21

Steps executed: 302 Episode length: 124 Return: -538.29885464087535
INFO:tensorflow:Average training steps per second: 326.87
I0901 13:25:24.697702 139683016574976 replay_runner.py:36] Average training steps per second: 326.87
I0901 13:25:24.861488 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.32
INFO:tensorflow:Starting iteration 22

Steps executed: 234 Episode length: 128 Return: -116.43604429577695
INFO:tensorflow:Average training steps per second: 323.32
I0901 13:25:31.428968 139683016574976 replay_runner.py:36] Average training steps per second: 323.32
I0901 13:25:31.576047 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.81
INFO:tensorflow:Starting iteration 23
I0901 13:25:35.025276 139683016574976 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 319.30
I0901 13:25:38.157391 139683016574976 replay_runner.py:36] Average training steps per second: 319.30

Steps executed: 259 Episode length: 132 Return: -102.45429624242473
INFO:tensorflow:Starting iteration 24

Steps executed: 246 Episode length: 129 Return: -78.888188187533393
INFO:tensorflow:Average training steps per second: 318.70
I0901 13:25:44.902771 139683016574976 replay_runner.py:36] Average training steps per second: 318.70
I0901 13:25:45.038589 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.74
INFO:tensorflow:Starting iteration 25

Steps executed: 229 Episode length: 93 Return: -375.000746059750443
INFO:tensorflow:Average training steps per second: 313.88
I0901 13:25:51.668290 139683016574976 replay_runner.py:36] Average training steps per second: 313.88
I0901 13:25:51.798065 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.34
INFO:tensorflow:Starting iteration 26
I0901 13:25:55.099194 139683016574976 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 314.68
I0901 13:25:58.277678 139683016574976 replay_runner.py:36] Average training steps per second: 314.68

Steps executed: 252 Episode length: 127 Return: -260.11538112356413
INFO:tensorflow:Starting iteration 27

Steps executed: 269 Episode length: 103 Return: -138.16990897770343
INFO:tensorflow:Average training steps per second: 322.47
I0901 13:26:04.882137 139683016574976 replay_runner.py:36] Average training steps per second: 322.47
I0901 13:26:05.054635 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.97
INFO:tensorflow:Starting iteration 28

Steps executed: 205 Episode length: 127 Return: -244.69558415537892
INFO:tensorflow:Average training steps per second: 313.95
I0901 13:26:11.607734 139683016574976 replay_runner.py:36] Average training steps per second: 313.95
I0901 13:26:11.742219 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.82
INFO:tensorflow:Starting iteration 29

Steps executed: 165 Episode length: 165 Return: -195.28761937219852
INFO:tensorflow:Average training steps per second: 325.21
I0901 13:26:18.089447 139683016574976 replay_runner.py:36] Average training steps per second: 325.21


Done fixed training!Episode length: 203 Return: -485.69673848493613