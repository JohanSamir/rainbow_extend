I0905 19:02:33.794485 139980086712320 run_experiment.py:549] Creating TrainRunner ...
I0905 19:02:33.804118 139980086712320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:33.804331 139980086712320 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:33.804476 139980086712320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:33.804582 139980086712320 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:33.804685 139980086712320 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:33.804802 139980086712320 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:33.804894 139980086712320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:33.804967 139980086712320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:33.805037 139980086712320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:33.805138 139980086712320 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:33.805255 139980086712320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:33.805345 139980086712320 dqn_agent.py:283] 	 seed: 1630868553804065
I0905 19:02:33.808099 139980086712320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:33.808250 139980086712320 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:33.808411 139980086712320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:33.808507 139980086712320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:33.808646 139980086712320 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:33.808741 139980086712320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:33.808847 139980086712320 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:33.808923 139980086712320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:33.809012 139980086712320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:33.852878 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:34.197385 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:34.211824 139980086712320 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 19:02:34.221568 139980086712320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 19:02:34.221842 139980086712320 dqn_agent.py:272] 	 gamma: 0.990000
I0905 19:02:34.221970 139980086712320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 19:02:34.222126 139980086712320 dqn_agent.py:274] 	 min_replay_history: 500
I0905 19:02:34.222241 139980086712320 dqn_agent.py:275] 	 update_period: 4
I0905 19:02:34.222388 139980086712320 dqn_agent.py:276] 	 target_update_period: 300
I0905 19:02:34.222491 139980086712320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 19:02:34.222596 139980086712320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 19:02:34.222700 139980086712320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 19:02:34.222803 139980086712320 dqn_agent.py:280] 	 optimizer: adam
I0905 19:02:34.222904 139980086712320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 19:02:34.223001 139980086712320 dqn_agent.py:283] 	 seed: 1630868554221505
I0905 19:02:34.225783 139980086712320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 19:02:34.226008 139980086712320 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 19:02:34.226176 139980086712320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 19:02:34.226359 139980086712320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 19:02:34.226465 139980086712320 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 19:02:34.226596 139980086712320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 19:02:34.226765 139980086712320 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 19:02:34.226875 139980086712320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 19:02:34.226972 139980086712320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 19:02:34.270344 139980086712320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 19:02:34.330504 139980086712320 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 19:02:34.330708 139980086712320 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 173.96
I0905 19:02:40.079357 139980086712320 replay_runner.py:36] Average training steps per second: 173.96
I0905 19:02:41.152526 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -613.93
Steps executed: 332 Episode length: 140 Return: -550.0344314067933
INFO:tensorflow:Starting iteration 1

Steps executed: 222 Episode length: 222 Return: -143.73994408658442
INFO:tensorflow:Average training steps per second: 273.23
I0905 19:02:48.769736 139980086712320 replay_runner.py:36] Average training steps per second: 273.23
I0905 19:02:49.011143 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.74
INFO:tensorflow:Starting iteration 2

Steps executed: 181 Episode length: 181 Return: -511.61165454123562
INFO:tensorflow:Average training steps per second: 258.81

Steps executed: 1181 Episode length: 1000 Return: -254.86220533112083
I0905 19:02:58.926214 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.24
INFO:tensorflow:Starting iteration 3
I0905 19:03:02.830203 139980086712320 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 285.12

Steps executed: 1000 Episode length: 1000 Return: -220.60549540397125
I0905 19:03:09.398627 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.61
INFO:tensorflow:Starting iteration 4
I0905 19:03:13.267256 139980086712320 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 281.35

Steps executed: 1000 Episode length: 1000 Return: -240.65274903290035
I0905 19:03:19.904948 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.65
INFO:tensorflow:Starting iteration 5
I0905 19:03:23.811080 139980086712320 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 261.74

Steps executed: 1000 Episode length: 1000 Return: -491.08936049491837
I0905 19:03:29.438000 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.09
INFO:tensorflow:Starting iteration 6
I0905 19:03:33.345644 139980086712320 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 266.35

Steps executed: 1000 Episode length: 1000 Return: -292.07604093133697
I0905 19:03:38.890106 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.08
INFO:tensorflow:Starting iteration 7
I0905 19:03:42.811025 139980086712320 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 256.49

Steps executed: 1000 Episode length: 1000 Return: -242.00425236591894
I0905 19:03:49.125706 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.00
INFO:tensorflow:Starting iteration 8

Steps executed: 425 Episode length: 237 Return: -147.3010980022616594
INFO:tensorflow:Average training steps per second: 257.21
I0905 19:03:56.885832 139980086712320 replay_runner.py:36] Average training steps per second: 257.21
I0905 19:03:57.250613 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.59
INFO:tensorflow:Starting iteration 9
I0905 19:04:01.027227 139980086712320 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 266.81

Steps executed: 1000 Episode length: 1000 Return: -39.030014802955574
I0905 19:04:07.113792 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -39.03
INFO:tensorflow:Starting iteration 10

Steps executed: 157 Episode length: 157 Return: -125.0251704202298174
INFO:tensorflow:Average training steps per second: 271.49

Steps executed: 1157 Episode length: 1000 Return: -62.902490512697374
I0905 19:04:17.685419 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.96
INFO:tensorflow:Starting iteration 11

Steps executed: 289 Episode length: 289 Return: -111.5431233816537174
INFO:tensorflow:Average training steps per second: 272.67
I0905 19:04:25.338939 139980086712320 replay_runner.py:36] Average training steps per second: 272.67
I0905 19:04:25.724196 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.54
INFO:tensorflow:Starting iteration 12

Steps executed: 270 Episode length: 135 Return: -118.1130765059744874
INFO:tensorflow:Average training steps per second: 280.76
I0905 19:04:33.129401 139980086712320 replay_runner.py:36] Average training steps per second: 280.76
I0905 19:04:33.358508 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.43
INFO:tensorflow:Starting iteration 13

Steps executed: 372 Episode length: 219 Return: -145.2460833108981774
INFO:tensorflow:Average training steps per second: 269.59
I0905 19:04:41.074511 139980086712320 replay_runner.py:36] Average training steps per second: 269.59
I0905 19:04:41.413700 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.82
INFO:tensorflow:Starting iteration 14

Steps executed: 271 Episode length: 271 Return: -35.93453287579794774
INFO:tensorflow:Average training steps per second: 255.19
I0905 19:04:49.250479 139980086712320 replay_runner.py:36] Average training steps per second: 255.19
I0905 19:04:49.541829 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -35.93
INFO:tensorflow:Starting iteration 15

Steps executed: 245 Episode length: 245 Return: -293.7694438109635474
INFO:tensorflow:Average training steps per second: 256.40
I0905 19:04:57.249516 139980086712320 replay_runner.py:36] Average training steps per second: 256.40
I0905 19:04:57.549813 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.77
INFO:tensorflow:Starting iteration 16

Steps executed: 304 Episode length: 142 Return: -129.4276403285713474
INFO:tensorflow:Average training steps per second: 269.15
I0905 19:05:05.080571 139980086712320 replay_runner.py:36] Average training steps per second: 269.15
I0905 19:05:05.375675 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.03
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 65 Return: -145.36442901066772474
INFO:tensorflow:Average training steps per second: 284.90
I0905 19:05:12.865104 139980086712320 replay_runner.py:36] Average training steps per second: 284.90
I0905 19:05:13.046898 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.67
INFO:tensorflow:Starting iteration 18

Steps executed: 318 Episode length: 154 Return: -102.1630115136118674
INFO:tensorflow:Average training steps per second: 279.13
I0905 19:05:20.776988 139980086712320 replay_runner.py:36] Average training steps per second: 279.13
I0905 19:05:21.053038 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.31
INFO:tensorflow:Starting iteration 19
I0905 19:05:24.902499 139980086712320 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 254.50

Steps executed: 817 Episode length: 817 Return: -265.7060150138534674
I0905 19:05:30.524282 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.71
INFO:tensorflow:Starting iteration 20

Steps executed: 638 Episode length: 638 Return: -119.5778378966032174
INFO:tensorflow:Average training steps per second: 248.56
I0905 19:05:38.345410 139980086712320 replay_runner.py:36] Average training steps per second: 248.56
I0905 19:05:39.347913 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.58
INFO:tensorflow:Starting iteration 21

Steps executed: 316 Episode length: 316 Return: -230.3623410460009874
INFO:tensorflow:Average training steps per second: 248.04
I0905 19:05:47.049196 139980086712320 replay_runner.py:36] Average training steps per second: 248.04
I0905 19:05:47.351732 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.36
INFO:tensorflow:Starting iteration 22
I0905 19:05:50.910257 139980086712320 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 238.59

Steps executed: 1000 Episode length: 1000 Return: -43.574854296148864
I0905 19:05:57.968271 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.57
INFO:tensorflow:Starting iteration 23
I0905 19:06:01.964649 139980086712320 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 256.81

Steps executed: 1000 Episode length: 1000 Return: -12.434737454470486
I0905 19:06:08.463016 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -12.43
INFO:tensorflow:Starting iteration 24
I0905 19:06:12.435353 139980086712320 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 266.08

Steps executed: 575 Episode length: 575 Return: 189.57064151173503486
I0905 19:06:17.364914 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.57
INFO:tensorflow:Starting iteration 25

Steps executed: 426 Episode length: 249 Return: -347.4480479745073586
INFO:tensorflow:Average training steps per second: 258.82
I0905 19:06:25.182715 139980086712320 replay_runner.py:36] Average training steps per second: 258.82
I0905 19:06:25.604365 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.14
INFO:tensorflow:Starting iteration 26
I0905 19:06:29.414104 139980086712320 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 256.78

Steps executed: 1000 Episode length: 1000 Return: -84.261625584224686
I0905 19:06:35.654591 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.26
INFO:tensorflow:Starting iteration 27

Steps executed: 318 Episode length: 318 Return: -215.3038095594005586
INFO:tensorflow:Average training steps per second: 285.00
I0905 19:06:42.938478 139980086712320 replay_runner.py:36] Average training steps per second: 285.00
I0905 19:06:43.325456 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.30
INFO:tensorflow:Starting iteration 28
I0905 19:06:46.863203 139980086712320 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 300.08

Steps executed: 527 Episode length: 527 Return: 189.13942878935106586
I0905 19:06:50.757256 139980086712320 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.14
INFO:tensorflow:Starting iteration 29

Steps executed: 244 Episode length: 244 Return: -320.0169091145627486
INFO:tensorflow:Average training steps per second: 366.73
I0905 19:06:56.895329 139980086712320 replay_runner.py:36] Average training steps per second: 366.73

Done fixed training!Episode length: 244 Return: -320.0169091145627486