Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0901 12:15:45.744718 140635665344512 run_experiment.py:549] Creating TrainRunner ...
I0901 12:15:45.752521 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:15:45.752712 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:15:45.752820 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:15:45.752914 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:15:45.752996 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:15:45.753074 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:15:45.753180 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:15:45.753314 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:15:45.753410 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:15:45.753520 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:15:45.753613 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:15:45.753703 140635665344512 dqn_agent.py:283] 	 seed: 1630498545752472
I0901 12:15:45.756009 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:15:45.756157 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:15:45.756257 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:15:45.756357 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:15:45.756450 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:15:45.756529 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:15:45.756607 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:15:45.756682 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:15:45.756784 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:15:45.808526 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:46.265131 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:46.279341 140635665344512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:15:46.287240 140635665344512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:15:46.287454 140635665344512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:15:46.287600 140635665344512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:15:46.287714 140635665344512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:15:46.287816 140635665344512 dqn_agent.py:275] 	 update_period: 4
I0901 12:15:46.287927 140635665344512 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:15:46.288045 140635665344512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:15:46.288142 140635665344512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:15:46.288282 140635665344512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:15:46.288476 140635665344512 dqn_agent.py:280] 	 optimizer: adam
I0901 12:15:46.288600 140635665344512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:15:46.288702 140635665344512 dqn_agent.py:283] 	 seed: 1630498546287196
I0901 12:15:46.291340 140635665344512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:15:46.291501 140635665344512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:15:46.291636 140635665344512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:15:46.291749 140635665344512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:15:46.291854 140635665344512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:15:46.291975 140635665344512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:15:46.292101 140635665344512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:15:46.292267 140635665344512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:15:46.292463 140635665344512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:15:46.314373 140635665344512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:15:46.329690 140635665344512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:15:46.329925 140635665344512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 160.06
I0901 12:15:52.577893 140635665344512 replay_runner.py:36] Average training steps per second: 160.06
Steps executed: 209 Episode length: 10 Return: 10.0
I0901 12:15:53.702227 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 1
I0901 12:15:53.878358 140635665344512 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 213.57
I0901 12:15:58.561165 140635665344512 replay_runner.py:36] Average training steps per second: 213.57
I0901 12:15:58.721992 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.00
INFO:tensorflow:Starting iteration 2

Steps executed: 210 Episode length: 73 Return: 73.0
INFO:tensorflow:Average training steps per second: 191.02
I0901 12:16:04.151639 140635665344512 replay_runner.py:36] Average training steps per second: 191.02
I0901 12:16:04.284900 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.97
I0901 12:16:09.670278 140635665344512 replay_runner.py:36] Average training steps per second: 191.97
I0901 12:16:09.804055 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0901 12:16:09.974450 140635665344512 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 182.02
I0901 12:16:15.468801 140635665344512 replay_runner.py:36] Average training steps per second: 182.02
I0901 12:16:15.614017 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 299 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 189.19
I0901 12:16:21.096340 140635665344512 replay_runner.py:36] Average training steps per second: 189.19
I0901 12:16:21.330614 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 6

Steps executed: 378 Episode length: 186 Return: 186.0
INFO:tensorflow:Average training steps per second: 185.80
I0901 12:16:26.898195 140635665344512 replay_runner.py:36] Average training steps per second: 185.80
I0901 12:16:27.161232 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 7
I0901 12:16:27.335262 140635665344512 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 193.41
I0901 12:16:32.506050 140635665344512 replay_runner.py:36] Average training steps per second: 193.41
I0901 12:16:32.706799 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.50
INFO:tensorflow:Starting iteration 8

Steps executed: 271 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 187.19
I0901 12:16:38.232317 140635665344512 replay_runner.py:36] Average training steps per second: 187.19
I0901 12:16:38.434269 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 9

Steps executed: 282 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 191.66
I0901 12:16:43.846894 140635665344512 replay_runner.py:36] Average training steps per second: 191.66
I0901 12:16:44.082989 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.50
INFO:tensorflow:Starting iteration 10

Steps executed: 321 Episode length: 174 Return: 174.0
INFO:tensorflow:Average training steps per second: 184.00

Steps executed: 146 Episode length: 146 Return: 146.0
I0901 12:16:49.914584 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.00
INFO:tensorflow:Starting iteration 11


Steps executed: 301 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 193.00
I0901 12:16:55.296693 140635665344512 replay_runner.py:36] Average training steps per second: 193.00
I0901 12:16:55.514877 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 12

Steps executed: 309 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 184.44
I0901 12:17:01.137292 140635665344512 replay_runner.py:36] Average training steps per second: 184.44
I0901 12:17:01.353795 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.35
I0901 12:17:06.659361 140635665344512 replay_runner.py:36] Average training steps per second: 195.35
I0901 12:17:06.805461 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 353 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 185.11
I0901 12:17:12.383669 140635665344512 replay_runner.py:36] Average training steps per second: 185.11
I0901 12:17:12.627444 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.40
I0901 12:17:18.158451 140635665344512 replay_runner.py:36] Average training steps per second: 187.40
I0901 12:17:18.313298 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 195 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 186.19

Steps executed: 395 Episode length: 200 Return: 200.0
I0901 12:17:24.189287 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.51
I0901 12:17:29.693105 140635665344512 replay_runner.py:36] Average training steps per second: 188.51
I0901 12:17:29.835230 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 12:17:30.030067 140635665344512 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 191.41
I0901 12:17:35.255479 140635665344512 replay_runner.py:36] Average training steps per second: 191.41
I0901 12:17:35.391386 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:17:35.585243 140635665344512 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 189.74
I0901 12:17:40.856102 140635665344512 replay_runner.py:36] Average training steps per second: 189.74
I0901 12:17:41.003772 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:17:41.201478 140635665344512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 186.33
I0901 12:17:46.568557 140635665344512 replay_runner.py:36] Average training steps per second: 186.33
I0901 12:17:46.713252 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 12:17:46.892379 140635665344512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 191.21
I0901 12:17:52.122740 140635665344512 replay_runner.py:36] Average training steps per second: 191.21
I0901 12:17:52.284897 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 12:17:52.502495 140635665344512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 186.53
I0901 12:17:57.864121 140635665344512 replay_runner.py:36] Average training steps per second: 186.53
I0901 12:17:58.007056 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:17:58.205395 140635665344512 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 186.02
I0901 12:18:03.581861 140635665344512 replay_runner.py:36] Average training steps per second: 186.02
I0901 12:18:03.738216 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:18:03.930001 140635665344512 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 183.21
I0901 12:18:09.388456 140635665344512 replay_runner.py:36] Average training steps per second: 183.21
I0901 12:18:09.538463 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 12:18:09.742972 140635665344512 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 184.06
I0901 12:18:15.176498 140635665344512 replay_runner.py:36] Average training steps per second: 184.06
I0901 12:18:15.331915 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 12:18:15.533638 140635665344512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 186.27
I0901 12:18:20.902573 140635665344512 replay_runner.py:36] Average training steps per second: 186.27
I0901 12:18:21.048601 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 369 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.13
I0901 12:18:26.544609 140635665344512 replay_runner.py:36] Average training steps per second: 188.13
I0901 12:18:26.815494 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.02
I0901 12:18:32.369911 140635665344512 replay_runner.py:36] Average training steps per second: 187.02
I0901 12:18:32.505112 140635665344512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 12:18:32.689206 140635665344512 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 192.74
I0901 12:18:37.877810 140635665344512 replay_runner.py:36] Average training steps per second: 192.74

Done fixed training!Episode length: 200 Return: 200.0