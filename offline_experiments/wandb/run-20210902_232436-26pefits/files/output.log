
Loaded trained dqn in lunarlander
I0902 23:24:42.614012 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:24:42.625185 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:42.625475 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:42.625751 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:42.625889 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:42.626078 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:42.626206 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:42.626322 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:42.626455 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:42.626566 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:42.626678 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:42.626786 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:42.626891 140006414895104 dqn_agent.py:283] 	 seed: 1630625082625106
I0902 23:24:42.630169 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:42.630414 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:42.630572 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:42.630707 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:42.630864 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:42.631051 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:42.631319 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:42.631469 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:42.631601 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:44.096576 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Training fixed agent 9, please be patient, may be a while...
I0902 23:24:44.523324 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:44.535433 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:24:44.543450 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:44.543664 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:44.543795 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:44.543915 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:44.544102 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:44.544204 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:44.544279 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:44.544414 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:44.544647 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:44.544841 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:44.545027 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:44.545272 140006414895104 dqn_agent.py:283] 	 seed: 1630625084543400
I0902 23:24:44.547854 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:44.548023 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:44.548125 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:44.548265 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:44.548406 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:44.548480 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:44.548590 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:44.548726 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:44.548813 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:24:44.576404 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:24:44.596122 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:24:44.596426 140006414895104 replay_runner.py:41] Starting iteration 0
Steps executed: 308 Episode length: 188 Return: -173.08274160663967
INFO:tensorflow:Average training steps per second: 163.40
I0902 23:24:50.716830 140006414895104 replay_runner.py:36] Average training steps per second: 163.40
I0902 23:24:51.958064 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.85
INFO:tensorflow:Starting iteration 1

Steps executed: 247 Episode length: 144 Return: -250.88929303154614
INFO:tensorflow:Average training steps per second: 230.73
I0902 23:25:00.785388 140006414895104 replay_runner.py:36] Average training steps per second: 230.73
I0902 23:25:00.989232 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.53
INFO:tensorflow:Starting iteration 2

Steps executed: 219 Episode length: 107 Return: -236.14903350018983
INFO:tensorflow:Average training steps per second: 233.48
I0902 23:25:09.735459 140006414895104 replay_runner.py:36] Average training steps per second: 233.48
I0902 23:25:09.904260 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.72
INFO:tensorflow:Starting iteration 3

Steps executed: 214 Episode length: 214 Return: -526.51881667690743
INFO:tensorflow:Average training steps per second: 228.95
I0902 23:25:18.580147 140006414895104 replay_runner.py:36] Average training steps per second: 228.95
I0902 23:25:18.827431 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -526.52
INFO:tensorflow:Starting iteration 4
I0902 23:25:23.124342 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 228.29

Steps executed: 746 Episode length: 746 Return: -569.00279651428343
I0902 23:25:28.967640 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -569.00
INFO:tensorflow:Starting iteration 5
I0902 23:25:33.313280 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 224.70

Steps executed: 1000 Episode length: 1000 Return: -111.10317823046393
I0902 23:25:40.750106 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.10
INFO:tensorflow:Starting iteration 6
I0902 23:25:45.110674 140006414895104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 216.77

Steps executed: 1000 Episode length: 1000 Return: -182.50807352793763
I0902 23:25:51.544244 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -182.51
INFO:tensorflow:Starting iteration 7
I0902 23:25:55.694942 140006414895104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 217.56

Steps executed: 1000 Episode length: 1000 Return: -138.54339593455754
I0902 23:26:02.784796 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.54
INFO:tensorflow:Starting iteration 8
I0902 23:26:07.158123 140006414895104 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 216.93

Steps executed: 1000 Episode length: 1000 Return: -109.03777859642705
I0902 23:26:14.548539 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.04
INFO:tensorflow:Starting iteration 9
I0902 23:26:18.868181 140006414895104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 217.96

Steps executed: 1000 Episode length: 1000 Return: -258.42925011186566
I0902 23:26:25.793918 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.43
INFO:tensorflow:Starting iteration 10
I0902 23:26:30.162384 140006414895104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 221.67

Steps executed: 1000 Episode length: 1000 Return: -331.08526863996666
I0902 23:26:37.650908 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.09
INFO:tensorflow:Starting iteration 11
I0902 23:26:41.946610 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 216.35

Steps executed: 1000 Episode length: 1000 Return: -399.31719276019714
I0902 23:26:48.806770 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.32
INFO:tensorflow:Starting iteration 12
I0902 23:26:53.176381 140006414895104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 214.76

Steps executed: 551 Episode length: 551 Return: -65.58196883246749714
I0902 23:26:58.901243 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.58
INFO:tensorflow:Starting iteration 13

Steps executed: 450 Episode length: 336 Return: -207.9808299092235314
INFO:tensorflow:Average training steps per second: 213.11
I0902 23:27:07.915045 140006414895104 replay_runner.py:36] Average training steps per second: 213.11
I0902 23:27:08.502777 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.30
INFO:tensorflow:Starting iteration 14

Steps executed: 566 Episode length: 566 Return: -40.81629050430798614
INFO:tensorflow:Average training steps per second: 214.45
I0902 23:27:17.461667 140006414895104 replay_runner.py:36] Average training steps per second: 214.45
I0902 23:27:18.378647 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.82
INFO:tensorflow:Starting iteration 15

Steps executed: 322 Episode length: 160 Return: -128.3962619638119814
INFO:tensorflow:Average training steps per second: 221.64
I0902 23:27:27.200156 140006414895104 replay_runner.py:36] Average training steps per second: 221.64
I0902 23:27:27.478555 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.46
INFO:tensorflow:Starting iteration 16

Steps executed: 174 Episode length: 174 Return: -132.7966942876146814
INFO:tensorflow:Average training steps per second: 225.96

Steps executed: 1028 Episode length: 854 Return: -135.293770731716654
I0902 23:27:38.556128 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.05
INFO:tensorflow:Starting iteration 17

Steps executed: 480 Episode length: 480 Return: -89.31419186447126654
INFO:tensorflow:Average training steps per second: 230.51
I0902 23:27:47.364337 140006414895104 replay_runner.py:36] Average training steps per second: 230.51
I0902 23:27:48.267005 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.31
INFO:tensorflow:Starting iteration 18
I0902 23:27:52.539349 140006414895104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 230.79
I0902 23:27:56.872771 140006414895104 replay_runner.py:36] Average training steps per second: 230.79

Steps executed: 273 Episode length: 138 Return: 18.980174117127547654
INFO:tensorflow:Starting iteration 19

Steps executed: 270 Episode length: 270 Return: 265.98426969251886654
INFO:tensorflow:Average training steps per second: 221.59
I0902 23:28:05.987359 140006414895104 replay_runner.py:36] Average training steps per second: 221.59
I0902 23:28:06.309859 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: 265.98
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 216 Return: -250.7404537057054254
INFO:tensorflow:Average training steps per second: 223.37
I0902 23:28:15.120675 140006414895104 replay_runner.py:36] Average training steps per second: 223.37
I0902 23:28:15.358850 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.74
INFO:tensorflow:Starting iteration 21

Steps executed: 262 Episode length: 70 Return: -155.80645696610787254
INFO:tensorflow:Average training steps per second: 214.74
I0902 23:28:24.196556 140006414895104 replay_runner.py:36] Average training steps per second: 214.74
I0902 23:28:24.428346 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.53
INFO:tensorflow:Starting iteration 22

Steps executed: 274 Episode length: 124 Return: -218.5007679124698254
INFO:tensorflow:Average training steps per second: 220.97
I0902 23:28:33.281336 140006414895104 replay_runner.py:36] Average training steps per second: 220.97
I0902 23:28:33.515691 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.32
INFO:tensorflow:Starting iteration 23

Steps executed: 349 Episode length: 185 Return: 1.6756047443900854454
INFO:tensorflow:Average training steps per second: 225.59
I0902 23:28:42.194299 140006414895104 replay_runner.py:36] Average training steps per second: 225.59
I0902 23:28:42.553078 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.79
INFO:tensorflow:Starting iteration 24

Steps executed: 203 Episode length: 95 Return: -440.34729745976480854
INFO:tensorflow:Average training steps per second: 226.02
I0902 23:28:51.466684 140006414895104 replay_runner.py:36] Average training steps per second: 226.02
I0902 23:28:51.635679 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.14
INFO:tensorflow:Starting iteration 25

Steps executed: 361 Episode length: 221 Return: -115.4041352900767554
INFO:tensorflow:Average training steps per second: 224.87
I0902 23:29:00.574294 140006414895104 replay_runner.py:36] Average training steps per second: 224.87
I0902 23:29:00.924003 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -240.98
INFO:tensorflow:Starting iteration 26

Steps executed: 259 Episode length: 189 Return: -50.46313930609392554
INFO:tensorflow:Average training steps per second: 225.57
I0902 23:29:09.767000 140006414895104 replay_runner.py:36] Average training steps per second: 225.57
I0902 23:29:10.007127 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.80
INFO:tensorflow:Starting iteration 27
I0902 23:29:14.361142 140006414895104 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 217.33

Steps executed: 551 Episode length: 551 Return: -803.1709523765377554
I0902 23:29:20.244823 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -803.17
INFO:tensorflow:Starting iteration 28

Steps executed: 223 Episode length: 96 Return: -116.66879391531432554
INFO:tensorflow:Average training steps per second: 216.73
I0902 23:29:29.285053 140006414895104 replay_runner.py:36] Average training steps per second: 216.73
I0902 23:29:29.499549 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.29
INFO:tensorflow:Starting iteration 29

Steps executed: 283 Episode length: 283 Return: -273.7874987062716654
INFO:tensorflow:Average training steps per second: 217.87
I0902 23:29:38.497188 140006414895104 replay_runner.py:36] Average training steps per second: 217.87

Done fixed training!Episode length: 283 Return: -273.7874987062716654