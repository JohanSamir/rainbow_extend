I0828 10:23:20.624483 140455557396480 run_experiment.py:549] Creating TrainRunner ...
I0828 10:23:20.637106 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:23:20.637320 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:23:20.637403 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:23:20.637469 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:23:20.637527 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:23:20.637644 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:23:20.637832 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:23:20.637944 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:23:20.638040 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:23:20.638220 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:23:20.638405 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:23:20.638529 140455557396480 dqn_agent.py:283] 	 seed: 1630146200637050
I0828 10:23:20.642195 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:23:20.642388 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:23:20.642561 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:23:20.642685 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:23:20.642802 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:23:20.642880 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:23:20.642953 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:23:20.643064 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:23:20.643242 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:23:20.681019 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:21.404324 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:21.417630 140455557396480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:23:21.424760 140455557396480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:23:21.424909 140455557396480 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:23:21.424982 140455557396480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:23:21.425043 140455557396480 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:23:21.425101 140455557396480 dqn_agent.py:275] 	 update_period: 4
I0828 10:23:21.425182 140455557396480 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:23:21.425319 140455557396480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:23:21.425376 140455557396480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:23:21.425427 140455557396480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:23:21.425528 140455557396480 dqn_agent.py:280] 	 optimizer: adam
I0828 10:23:21.425614 140455557396480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:23:21.425701 140455557396480 dqn_agent.py:283] 	 seed: 1630146201424725
I0828 10:23:21.428522 140455557396480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:23:21.428762 140455557396480 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:23:21.429179 140455557396480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:23:21.429358 140455557396480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:23:21.429469 140455557396480 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:23:21.429550 140455557396480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:23:21.429647 140455557396480 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:23:21.429729 140455557396480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:23:21.429841 140455557396480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:23:21.460858 140455557396480 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:23:21.482510 140455557396480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:23:21.482684 140455557396480 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 170.29
I0828 10:23:27.355222 140455557396480 replay_runner.py:36] Average training steps per second: 170.29
I0828 10:23:28.619119 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.45
Steps executed: 231 Episode length: 85 Return: -405.81041374840664
INFO:tensorflow:Starting iteration 1

Steps executed: 267 Episode length: 69 Return: -128.75593794346264
INFO:tensorflow:Average training steps per second: 228.91
I0828 10:23:37.296328 140455557396480 replay_runner.py:36] Average training steps per second: 228.91
I0828 10:23:37.493441 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.49
INFO:tensorflow:Starting iteration 2
I0828 10:23:41.859646 140455557396480 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 229.68
I0828 10:23:46.214078 140455557396480 replay_runner.py:36] Average training steps per second: 229.68

Steps executed: 301 Episode length: 119 Return: -751.8298629635269
INFO:tensorflow:Starting iteration 3

Steps executed: 254 Episode length: 57 Return: -112.52395633604618
INFO:tensorflow:Average training steps per second: 233.74
I0828 10:23:55.095171 140455557396480 replay_runner.py:36] Average training steps per second: 233.74
I0828 10:23:55.264915 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.70
INFO:tensorflow:Starting iteration 4

Steps executed: 273 Episode length: 100 Return: -568.2696403689774
INFO:tensorflow:Average training steps per second: 230.79
I0828 10:24:03.976227 140455557396480 replay_runner.py:36] Average training steps per second: 230.79
I0828 10:24:04.251529 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -556.28
INFO:tensorflow:Starting iteration 5

Steps executed: 254 Episode length: 58 Return: -134.24418032313872
INFO:tensorflow:Average training steps per second: 225.82
I0828 10:24:13.073245 140455557396480 replay_runner.py:36] Average training steps per second: 225.82
I0828 10:24:13.261147 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.09
INFO:tensorflow:Starting iteration 6

Steps executed: 217 Episode length: 77 Return: -563.04789013911682
INFO:tensorflow:Average training steps per second: 236.62
I0828 10:24:21.794296 140455557396480 replay_runner.py:36] Average training steps per second: 236.62
I0828 10:24:21.956106 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.46
INFO:tensorflow:Starting iteration 7

Steps executed: 300 Episode length: 116 Return: -881.9930262989279
INFO:tensorflow:Average training steps per second: 254.30
I0828 10:24:30.159309 140455557396480 replay_runner.py:36] Average training steps per second: 254.30
I0828 10:24:30.458258 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -675.29
INFO:tensorflow:Starting iteration 8
I0828 10:24:34.671187 140455557396480 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 247.42

Steps executed: 279 Episode length: 99 Return: -548.21715258235832
I0828 10:24:38.936376 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -603.43
INFO:tensorflow:Starting iteration 9

Steps executed: 226 Episode length: 84 Return: -766.62915444267792
INFO:tensorflow:Average training steps per second: 239.12
I0828 10:24:47.191467 140455557396480 replay_runner.py:36] Average training steps per second: 239.12
I0828 10:24:47.380272 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -654.20
INFO:tensorflow:Starting iteration 10

Steps executed: 233 Episode length: 77 Return: -358.22278349805777
INFO:tensorflow:Average training steps per second: 235.35
I0828 10:24:55.858707 140455557396480 replay_runner.py:36] Average training steps per second: 235.35
I0828 10:24:56.030009 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.59
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 50 Return: -431.73876893388517
INFO:tensorflow:Average training steps per second: 231.61
I0828 10:25:04.675873 140455557396480 replay_runner.py:36] Average training steps per second: 231.61
I0828 10:25:04.852959 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -676.30
INFO:tensorflow:Starting iteration 12

Steps executed: 227 Episode length: 50 Return: -345.99786727039924
INFO:tensorflow:Average training steps per second: 233.09
I0828 10:25:13.257661 140455557396480 replay_runner.py:36] Average training steps per second: 233.09
I0828 10:25:13.440948 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.43
INFO:tensorflow:Starting iteration 13

Steps executed: 225 Episode length: 58 Return: -450.56202909426834
INFO:tensorflow:Average training steps per second: 223.75
I0828 10:25:22.217210 140455557396480 replay_runner.py:36] Average training steps per second: 223.75
I0828 10:25:22.408559 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.39
INFO:tensorflow:Starting iteration 14

Steps executed: 210 Episode length: 79 Return: -691.60549113499294
INFO:tensorflow:Average training steps per second: 226.58
I0828 10:25:31.253184 140455557396480 replay_runner.py:36] Average training steps per second: 226.58
I0828 10:25:31.450229 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -647.53
INFO:tensorflow:Starting iteration 15

Steps executed: 104 Episode length: 57 Return: -524.84096108158064
INFO:tensorflow:Average training steps per second: 225.96
I0828 10:25:40.316608 140455557396480 replay_runner.py:36] Average training steps per second: 225.96

Steps executed: 238 Episode length: 55 Return: -407.72164697456464
INFO:tensorflow:Starting iteration 16

Steps executed: 235 Episode length: 91 Return: -116.37634470813273
INFO:tensorflow:Average training steps per second: 228.24
I0828 10:25:49.122845 140455557396480 replay_runner.py:36] Average training steps per second: 228.24
I0828 10:25:49.281450 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.57
INFO:tensorflow:Starting iteration 17

Steps executed: 269 Episode length: 71 Return: -541.07517544920056
INFO:tensorflow:Average training steps per second: 228.91
I0828 10:25:57.951277 140455557396480 replay_runner.py:36] Average training steps per second: 228.91
I0828 10:25:58.188340 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -529.42
INFO:tensorflow:Starting iteration 18

Steps executed: 207 Episode length: 63 Return: -500.24338765552426
INFO:tensorflow:Average training steps per second: 232.68
I0828 10:26:06.928250 140455557396480 replay_runner.py:36] Average training steps per second: 232.68
I0828 10:26:07.118811 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.78
INFO:tensorflow:Starting iteration 19

Steps executed: 291 Episode length: 111 Return: -653.0195800155541
INFO:tensorflow:Average training steps per second: 231.86
I0828 10:26:15.832594 140455557396480 replay_runner.py:36] Average training steps per second: 231.86
I0828 10:26:16.098280 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -572.76
INFO:tensorflow:Starting iteration 20
I0828 10:26:20.503547 140455557396480 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 228.42

Steps executed: 274 Episode length: 79 Return: -587.99798543559779
I0828 10:26:25.142583 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -643.08
INFO:tensorflow:Starting iteration 21

Steps executed: 345 Episode length: 153 Return: -789.5472771026776
INFO:tensorflow:Average training steps per second: 229.52
I0828 10:26:33.607427 140455557396480 replay_runner.py:36] Average training steps per second: 229.52
I0828 10:26:33.938001 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -729.43
INFO:tensorflow:Starting iteration 22

Steps executed: 86 Episode length: 86 Return: -181.483110385215356
INFO:tensorflow:Average training steps per second: 231.30
I0828 10:26:42.658596 140455557396480 replay_runner.py:36] Average training steps per second: 231.30

Steps executed: 230 Episode length: 62 Return: -141.44497383898303
INFO:tensorflow:Starting iteration 23

Steps executed: 250 Episode length: 61 Return: -130.88012883083226
INFO:tensorflow:Average training steps per second: 232.27
I0828 10:26:51.523881 140455557396480 replay_runner.py:36] Average training steps per second: 232.27
I0828 10:26:51.682663 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.85
INFO:tensorflow:Starting iteration 24

Steps executed: 206 Episode length: 58 Return: -415.47968063537684
INFO:tensorflow:Average training steps per second: 229.03
I0828 10:27:00.258662 140455557396480 replay_runner.py:36] Average training steps per second: 229.03
I0828 10:27:00.428206 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -614.60
INFO:tensorflow:Starting iteration 25
I0828 10:27:04.531236 140455557396480 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 228.64
I0828 10:27:08.905290 140455557396480 replay_runner.py:36] Average training steps per second: 228.64

Steps executed: 240 Episode length: 86 Return: -845.89905728618274
INFO:tensorflow:Starting iteration 26

Steps executed: 219 Episode length: 78 Return: -696.51548516602994
INFO:tensorflow:Average training steps per second: 231.28
I0828 10:27:17.775975 140455557396480 replay_runner.py:36] Average training steps per second: 231.28
I0828 10:27:17.972761 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -620.76
INFO:tensorflow:Starting iteration 27

Steps executed: 349 Episode length: 151 Return: -969.5835441657771
INFO:tensorflow:Average training steps per second: 236.41
I0828 10:27:26.400949 140455557396480 replay_runner.py:36] Average training steps per second: 236.41
I0828 10:27:26.709125 140455557396480 run_experiment.py:428] Average undiscounted return per evaluation episode: -663.62
INFO:tensorflow:Starting iteration 28
I0828 10:27:30.804591 140455557396480 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 234.07
I0828 10:27:35.077408 140455557396480 replay_runner.py:36] Average training steps per second: 234.07

Steps executed: 239 Episode length: 62 Return: -601.89699954956771
INFO:tensorflow:Starting iteration 29

Steps executed: 340 Episode length: 233 Return: -1359.5764283491494
INFO:tensorflow:Average training steps per second: 235.14
I0828 10:27:43.683908 140455557396480 replay_runner.py:36] Average training steps per second: 235.14

Done fixed training!Episode length: 233 Return: -1359.5764283491494