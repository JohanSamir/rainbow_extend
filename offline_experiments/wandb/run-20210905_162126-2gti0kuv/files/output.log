I0905 16:21:33.468448 140235000764416 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.469039 140235000764416 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.541670 140235000764416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.544100 140235000764416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.544216 140235000764416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.544298 140235000764416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.544414 140235000764416 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.544499 140235000764416 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:33.544586 140235000764416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.544666 140235000764416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.544747 140235000764416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.544829 140235000764416 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.544911 140235000764416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.544997 140235000764416 dqn_agent.py:283] 	 seed: 1630858893541242
I0905 16:21:33.547329 140235000764416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.547471 140235000764416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:33.547546 140235000764416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.547611 140235000764416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.547674 140235000764416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.547810 140235000764416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.547878 140235000764416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.548039 140235000764416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.548155 140235000764416 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0905 16:21:35.158522 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.464608 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.591961 140235000764416 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.598433 140235000764416 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.598603 140235000764416 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.598704 140235000764416 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.598785 140235000764416 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.598862 140235000764416 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.598941 140235000764416 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:35.599016 140235000764416 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.599114 140235000764416 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.599210 140235000764416 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.599312 140235000764416 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.599370 140235000764416 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.599470 140235000764416 dqn_agent.py:283] 	 seed: 1630858895598394
I0905 16:21:35.601223 140235000764416 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.601341 140235000764416 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:35.601415 140235000764416 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.601489 140235000764416 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.601545 140235000764416 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.601595 140235000764416 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.601646 140235000764416 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.601698 140235000764416 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.601747 140235000764416 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.620280 140235000764416 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.632072 140235000764416 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.632289 140235000764416 replay_runner.py:41] Starting iteration 0
Steps executed: 293 Episode length: 160 Return: -216.52491753767447
INFO:tensorflow:Average training steps per second: 291.31
I0905 16:21:39.065325 140235000764416 replay_runner.py:36] Average training steps per second: 291.31
I0905 16:21:39.753868 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.45
INFO:tensorflow:Starting iteration 1

Steps executed: 436 Episode length: 246 Return: -167.03993495779747
INFO:tensorflow:Average training steps per second: 411.10
I0905 16:21:45.282812 140235000764416 replay_runner.py:36] Average training steps per second: 411.10
I0905 16:21:45.498659 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -312.98
INFO:tensorflow:Starting iteration 2

Steps executed: 261 Episode length: 82 Return: -458.516640993541847
INFO:tensorflow:Average training steps per second: 411.65
I0905 16:21:51.053608 140235000764416 replay_runner.py:36] Average training steps per second: 411.65
I0905 16:21:51.154663 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -470.45
INFO:tensorflow:Starting iteration 3

Steps executed: 238 Episode length: 104 Return: -456.45357123250864
INFO:tensorflow:Average training steps per second: 399.47
I0905 16:21:56.741218 140235000764416 replay_runner.py:36] Average training steps per second: 399.47
I0905 16:21:56.845781 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -420.12
INFO:tensorflow:Starting iteration 4

Steps executed: 321 Episode length: 138 Return: -276.22475256096914
INFO:tensorflow:Average training steps per second: 413.11
I0905 16:22:02.351918 140235000764416 replay_runner.py:36] Average training steps per second: 413.11
I0905 16:22:02.485647 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.13
INFO:tensorflow:Starting iteration 5

Steps executed: 225 Episode length: 85 Return: -335.229962039583137
INFO:tensorflow:Average training steps per second: 417.07
I0905 16:22:07.980269 140235000764416 replay_runner.py:36] Average training steps per second: 417.07
I0905 16:22:08.079444 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.13
INFO:tensorflow:Starting iteration 6

Steps executed: 237 Episode length: 118 Return: -18.554204326890627
INFO:tensorflow:Average training steps per second: 407.95
I0905 16:22:13.647388 140235000764416 replay_runner.py:36] Average training steps per second: 407.95
I0905 16:22:13.757018 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -23.06
INFO:tensorflow:Starting iteration 7

Steps executed: 307 Episode length: 133 Return: -48.556907709534747
INFO:tensorflow:Average training steps per second: 409.15
I0905 16:22:19.290199 140235000764416 replay_runner.py:36] Average training steps per second: 409.15
I0905 16:22:19.408259 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.57
INFO:tensorflow:Starting iteration 8

Steps executed: 268 Episode length: 76 Return: -169.964773343174367
INFO:tensorflow:Average training steps per second: 408.98
I0905 16:22:24.964824 140235000764416 replay_runner.py:36] Average training steps per second: 408.98
I0905 16:22:25.072558 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.66
INFO:tensorflow:Starting iteration 9

Steps executed: 201 Episode length: 117 Return: -270.77223534549483
INFO:tensorflow:Average training steps per second: 414.47
I0905 16:22:30.590302 140235000764416 replay_runner.py:36] Average training steps per second: 414.47
I0905 16:22:30.659384 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.56
INFO:tensorflow:Starting iteration 10

Steps executed: 275 Episode length: 147 Return: -198.36095028373424
INFO:tensorflow:Average training steps per second: 411.84
I0905 16:22:36.178283 140235000764416 replay_runner.py:36] Average training steps per second: 411.84
I0905 16:22:36.288748 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -218.98
INFO:tensorflow:Starting iteration 11

Steps executed: 268 Episode length: 135 Return: -192.38633987722778
INFO:tensorflow:Average training steps per second: 418.78
I0905 16:22:41.766420 140235000764416 replay_runner.py:36] Average training steps per second: 418.78
I0905 16:22:41.877652 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.92
INFO:tensorflow:Starting iteration 12

Steps executed: 633 Episode length: 633 Return: -673.14849526108648
INFO:tensorflow:Average training steps per second: 421.34
I0905 16:22:47.349051 140235000764416 replay_runner.py:36] Average training steps per second: 421.34
I0905 16:22:48.447465 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -673.15
INFO:tensorflow:Starting iteration 13

Steps executed: 255 Episode length: 59 Return: -141.559744756973526
INFO:tensorflow:Average training steps per second: 422.35
I0905 16:22:53.892426 140235000764416 replay_runner.py:36] Average training steps per second: 422.35
I0905 16:22:53.983799 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.88
INFO:tensorflow:Starting iteration 14

Steps executed: 336 Episode length: 202 Return: -802.18236004144157
INFO:tensorflow:Average training steps per second: 412.17
I0905 16:22:59.498906 140235000764416 replay_runner.py:36] Average training steps per second: 412.17
I0905 16:22:59.671208 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.61
INFO:tensorflow:Starting iteration 15

Steps executed: 268 Episode length: 86 Return: 9.443535681705236887
INFO:tensorflow:Average training steps per second: 418.00
I0905 16:23:05.223425 140235000764416 replay_runner.py:36] Average training steps per second: 418.00
I0905 16:23:05.315919 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.86
INFO:tensorflow:Starting iteration 16

Steps executed: 228 Episode length: 72 Return: -129.594005784426787
INFO:tensorflow:Average training steps per second: 446.54
I0905 16:23:10.544796 140235000764416 replay_runner.py:36] Average training steps per second: 446.54
I0905 16:23:10.604157 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.29
INFO:tensorflow:Starting iteration 17

Steps executed: 268 Episode length: 91 Return: -128.615878464397557
INFO:tensorflow:Average training steps per second: 301.02
I0905 16:23:17.139696 140235000764416 replay_runner.py:36] Average training steps per second: 301.02
I0905 16:23:17.241690 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.67
INFO:tensorflow:Starting iteration 18

Steps executed: 255 Episode length: 91 Return: -637.006941661304477
INFO:tensorflow:Average training steps per second: 416.28
I0905 16:23:22.936156 140235000764416 replay_runner.py:36] Average training steps per second: 416.28
I0905 16:23:23.052091 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -482.52
INFO:tensorflow:Starting iteration 19

Steps executed: 236 Episode length: 83 Return: -218.739137997291157
INFO:tensorflow:Average training steps per second: 406.78
I0905 16:23:28.594530 140235000764416 replay_runner.py:36] Average training steps per second: 406.78
I0905 16:23:28.682900 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.96
INFO:tensorflow:Starting iteration 20

Steps executed: 227 Episode length: 71 Return: -117.400058552372423
INFO:tensorflow:Average training steps per second: 406.67
I0905 16:23:34.227411 140235000764416 replay_runner.py:36] Average training steps per second: 406.67
I0905 16:23:34.295858 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.61
INFO:tensorflow:Starting iteration 21

Steps executed: 564 Episode length: 485 Return: -181.68055205703416
INFO:tensorflow:Average training steps per second: 421.21
I0905 16:23:39.768537 140235000764416 replay_runner.py:36] Average training steps per second: 421.21
I0905 16:23:40.295900 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.10
INFO:tensorflow:Starting iteration 22

Steps executed: 225 Episode length: 58 Return: -255.485469994786856
INFO:tensorflow:Average training steps per second: 418.75
I0905 16:23:45.768772 140235000764416 replay_runner.py:36] Average training steps per second: 418.75
I0905 16:23:45.855832 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.16
INFO:tensorflow:Starting iteration 23

Steps executed: 267 Episode length: 72 Return: -545.263741297250856
INFO:tensorflow:Average training steps per second: 394.98
I0905 16:23:51.475007 140235000764416 replay_runner.py:36] Average training steps per second: 394.98
I0905 16:23:51.578516 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.80
INFO:tensorflow:Starting iteration 24

Steps executed: 241 Episode length: 74 Return: -426.746212909381956
INFO:tensorflow:Average training steps per second: 420.07
I0905 16:23:57.038432 140235000764416 replay_runner.py:36] Average training steps per second: 420.07
I0905 16:23:57.135301 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.76
INFO:tensorflow:Starting iteration 25

Steps executed: 253 Episode length: 75 Return: -537.679105479193656
INFO:tensorflow:Average training steps per second: 416.13
I0905 16:24:02.622961 140235000764416 replay_runner.py:36] Average training steps per second: 416.13
I0905 16:24:02.730682 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -753.59
INFO:tensorflow:Starting iteration 26

Steps executed: 229 Episode length: 87 Return: -880.707629719166156
INFO:tensorflow:Average training steps per second: 419.10
I0905 16:24:08.202490 140235000764416 replay_runner.py:36] Average training steps per second: 419.10
I0905 16:24:08.293355 140235000764416 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.24
INFO:tensorflow:Starting iteration 27
I0905 16:24:11.364650 140235000764416 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 415.73
I0905 16:24:13.770306 140235000764416 replay_runner.py:36] Average training steps per second: 415.73

Steps executed: 203 Episode length: 65 Return: -69.0119093604929556
INFO:tensorflow:Starting iteration 28
I0905 16:24:16.921832 140235000764416 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 417.73
I0905 16:24:19.315973 140235000764416 replay_runner.py:36] Average training steps per second: 417.73

Steps executed: 305 Episode length: 114 Return: -358.66279988207969
INFO:tensorflow:Starting iteration 29

Steps executed: 225 Episode length: 56 Return: -102.864913454358618
INFO:tensorflow:Average training steps per second: 423.49
I0905 16:24:24.885306 140235000764416 replay_runner.py:36] Average training steps per second: 423.49

Done fixed training!Episode length: 56 Return: -102.864913454358618