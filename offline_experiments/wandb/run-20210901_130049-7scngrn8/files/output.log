Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0901 13:00:56.011677 139809518303232 run_experiment.py:549] Creating TrainRunner ...
I0901 13:00:56.023409 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:56.023726 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:56.023904 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:56.024039 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:56.024148 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:56.024284 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:00:56.024373 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:56.024485 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:56.024589 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:56.024933 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:56.025424 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:56.025582 139809518303232 dqn_agent.py:283] 	 seed: 1630501256023326
I0901 13:00:56.030620 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:56.030897 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:00:56.031052 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:56.031300 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:56.031425 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:56.031622 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:56.031836 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:56.031973 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:56.032073 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:56.078647 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.545787 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.561524 139809518303232 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:00:56.572677 139809518303232 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:00:56.572896 139809518303232 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:00:56.573055 139809518303232 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:00:56.573213 139809518303232 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:00:56.573298 139809518303232 dqn_agent.py:275] 	 update_period: 4
I0901 13:00:56.573412 139809518303232 dqn_agent.py:276] 	 target_update_period: 300
I0901 13:00:56.573544 139809518303232 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:00:56.573875 139809518303232 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:00:56.574003 139809518303232 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:00:56.574166 139809518303232 dqn_agent.py:280] 	 optimizer: adam
I0901 13:00:56.574283 139809518303232 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:00:56.574413 139809518303232 dqn_agent.py:283] 	 seed: 1630501256572626
I0901 13:00:56.577398 139809518303232 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:00:56.577569 139809518303232 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 13:00:56.577848 139809518303232 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:00:56.578061 139809518303232 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:00:56.578320 139809518303232 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:00:56.578485 139809518303232 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:00:56.578630 139809518303232 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:00:56.578794 139809518303232 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:00:56.578917 139809518303232 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:00:56.618661 139809518303232 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:00:56.647111 139809518303232 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:00:56.647636 139809518303232 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.44
I0901 13:01:03.339740 139809518303232 replay_runner.py:36] Average training steps per second: 149.44
Steps executed: 239 Episode length: 137 Return: -311.7627075800723
I0901 13:01:04.659136 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -507.89
INFO:tensorflow:Starting iteration 1

Steps executed: 255 Episode length: 155 Return: -24.19457870941767
INFO:tensorflow:Average training steps per second: 211.36
I0901 13:01:13.930981 139809518303232 replay_runner.py:36] Average training steps per second: 211.36
I0901 13:01:14.184439 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.05
INFO:tensorflow:Starting iteration 2

Steps executed: 85 Episode length: 85 Return: -123.935414551839617
INFO:tensorflow:Average training steps per second: 210.67
I0901 13:01:23.431591 139809518303232 replay_runner.py:36] Average training steps per second: 210.67

Steps executed: 210 Episode length: 125 Return: -245.77865187126895
INFO:tensorflow:Starting iteration 3

Steps executed: 240 Episode length: 116 Return: -212.43467486532664
INFO:tensorflow:Average training steps per second: 211.49
I0901 13:01:32.852901 139809518303232 replay_runner.py:36] Average training steps per second: 211.49
I0901 13:01:33.083391 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.75
INFO:tensorflow:Starting iteration 4

Steps executed: 232 Episode length: 111 Return: -235.41799611278162
INFO:tensorflow:Average training steps per second: 213.60
I0901 13:01:42.143297 139809518303232 replay_runner.py:36] Average training steps per second: 213.60
I0901 13:01:42.375465 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.28
INFO:tensorflow:Starting iteration 5

Steps executed: 244 Episode length: 80 Return: -335.175665486597672
INFO:tensorflow:Average training steps per second: 222.35
I0901 13:01:51.247111 139809518303232 replay_runner.py:36] Average training steps per second: 222.35
I0901 13:01:51.450128 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.18
INFO:tensorflow:Starting iteration 6

Steps executed: 234 Episode length: 149 Return: -273.94869280298762
INFO:tensorflow:Average training steps per second: 224.50
I0901 13:02:00.321874 139809518303232 replay_runner.py:36] Average training steps per second: 224.50
I0901 13:02:00.536082 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.21
INFO:tensorflow:Starting iteration 7

Steps executed: 219 Episode length: 88 Return: -355.533211226146362
INFO:tensorflow:Average training steps per second: 217.36
I0901 13:02:09.541300 139809518303232 replay_runner.py:36] Average training steps per second: 217.36
I0901 13:02:09.714653 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.86
INFO:tensorflow:Starting iteration 8

Steps executed: 286 Episode length: 96 Return: -67.8233987655757262
INFO:tensorflow:Average training steps per second: 222.93
I0901 13:02:18.598554 139809518303232 replay_runner.py:36] Average training steps per second: 222.93
I0901 13:02:18.835452 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.53
INFO:tensorflow:Starting iteration 9

Steps executed: 80 Episode length: 80 Return: -51.01440770548643462
INFO:tensorflow:Average training steps per second: 219.94
I0901 13:02:27.853655 139809518303232 replay_runner.py:36] Average training steps per second: 219.94

Steps executed: 260 Episode length: 91 Return: -262.422874084346742
INFO:tensorflow:Starting iteration 10

Steps executed: 258 Episode length: 107 Return: -561.24045761036132
INFO:tensorflow:Average training steps per second: 225.93
I0901 13:02:36.889718 139809518303232 replay_runner.py:36] Average training steps per second: 225.93
I0901 13:02:37.139352 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.78
INFO:tensorflow:Starting iteration 11

Steps executed: 228 Episode length: 228 Return: -289.85054697032183
INFO:tensorflow:Average training steps per second: 227.46
I0901 13:02:45.873503 139809518303232 replay_runner.py:36] Average training steps per second: 227.46
I0901 13:02:46.134353 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.85
INFO:tensorflow:Starting iteration 12

Steps executed: 201 Episode length: 55 Return: -176.132897127055743
INFO:tensorflow:Average training steps per second: 228.06
I0901 13:02:54.885600 139809518303232 replay_runner.py:36] Average training steps per second: 228.06
I0901 13:02:55.050044 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.26
INFO:tensorflow:Starting iteration 13

Steps executed: 218 Episode length: 161 Return: -755.65003148108243
INFO:tensorflow:Average training steps per second: 229.04
I0901 13:03:03.731988 139809518303232 replay_runner.py:36] Average training steps per second: 229.04
I0901 13:03:03.934303 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.71
INFO:tensorflow:Starting iteration 14

Steps executed: 240 Episode length: 156 Return: -580.28348676741463
INFO:tensorflow:Average training steps per second: 240.86
I0901 13:03:12.401397 139809518303232 replay_runner.py:36] Average training steps per second: 240.86
I0901 13:03:12.588369 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.67
INFO:tensorflow:Starting iteration 15

Steps executed: 273 Episode length: 88 Return: -363.019631874929153
INFO:tensorflow:Average training steps per second: 238.20
I0901 13:03:21.039008 139809518303232 replay_runner.py:36] Average training steps per second: 238.20
I0901 13:03:21.242434 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.14
INFO:tensorflow:Starting iteration 16

Steps executed: 272 Episode length: 75 Return: -224.935251284527143
INFO:tensorflow:Average training steps per second: 246.03
I0901 13:03:29.562841 139809518303232 replay_runner.py:36] Average training steps per second: 246.03
I0901 13:03:29.752285 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -139.29
INFO:tensorflow:Starting iteration 17

Steps executed: 215 Episode length: 86 Return: -503.099552585293873
INFO:tensorflow:Average training steps per second: 241.76
I0901 13:03:38.201293 139809518303232 replay_runner.py:36] Average training steps per second: 241.76
I0901 13:03:38.375359 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.67
INFO:tensorflow:Starting iteration 18

Steps executed: 300 Episode length: 115 Return: -895.67490817866259
INFO:tensorflow:Average training steps per second: 253.69
I0901 13:03:46.519964 139809518303232 replay_runner.py:36] Average training steps per second: 253.69
I0901 13:03:46.731314 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.66
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 62 Return: -160.922711030509679
INFO:tensorflow:Average training steps per second: 244.99
I0901 13:03:55.037175 139809518303232 replay_runner.py:36] Average training steps per second: 244.99
I0901 13:03:55.220576 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.39
INFO:tensorflow:Starting iteration 20

Steps executed: 201 Episode length: 82 Return: -23.9255083403073749
INFO:tensorflow:Average training steps per second: 253.49
I0901 13:04:03.362975 139809518303232 replay_runner.py:36] Average training steps per second: 253.49
I0901 13:04:03.498276 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.46
INFO:tensorflow:Starting iteration 21

Steps executed: 237 Episode length: 60 Return: -275.566220658211369
INFO:tensorflow:Average training steps per second: 251.11
I0901 13:04:11.647881 139809518303232 replay_runner.py:36] Average training steps per second: 251.11
I0901 13:04:11.819353 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.10
INFO:tensorflow:Starting iteration 22

Steps executed: 254 Episode length: 95 Return: -729.966166674452449
INFO:tensorflow:Average training steps per second: 245.40
I0901 13:04:20.082591 139809518303232 replay_runner.py:36] Average training steps per second: 245.40
I0901 13:04:20.275255 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -611.01
INFO:tensorflow:Starting iteration 23

Steps executed: 187 Episode length: 60 Return: -591.147022365712249
INFO:tensorflow:Average training steps per second: 258.52
I0901 13:04:28.172678 139809518303232 replay_runner.py:36] Average training steps per second: 258.52

Steps executed: 247 Episode length: 60 Return: -528.056317216528249
INFO:tensorflow:Starting iteration 24

Steps executed: 257 Episode length: 80 Return: -671.365763764276249
INFO:tensorflow:Average training steps per second: 270.76
I0901 13:04:36.176183 139809518303232 replay_runner.py:36] Average training steps per second: 270.76
I0901 13:04:36.376224 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -533.15
INFO:tensorflow:Starting iteration 25

Steps executed: 203 Episode length: 67 Return: -173.369599153786429
INFO:tensorflow:Average training steps per second: 277.71
I0901 13:04:43.992731 139809518303232 replay_runner.py:36] Average training steps per second: 277.71
I0901 13:04:44.116605 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.55
INFO:tensorflow:Starting iteration 26

Steps executed: 203 Episode length: 52 Return: -438.353267128903529
INFO:tensorflow:Average training steps per second: 279.15
I0901 13:04:51.622332 139809518303232 replay_runner.py:36] Average training steps per second: 279.15
I0901 13:04:51.750401 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -385.52
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 66 Return: -571.154347332063329
INFO:tensorflow:Average training steps per second: 281.90
I0901 13:04:59.032771 139809518303232 replay_runner.py:36] Average training steps per second: 281.90
I0901 13:04:59.221656 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.96
INFO:tensorflow:Starting iteration 28
I0901 13:05:03.089819 139809518303232 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 278.81

Steps executed: 222 Episode length: 84 Return: -748.361849243785829
I0901 13:05:06.846540 139809518303232 run_experiment.py:428] Average undiscounted return per evaluation episode: -646.15
INFO:tensorflow:Starting iteration 29
I0901 13:05:10.799386 139809518303232 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 280.90
I0901 13:05:14.359663 139809518303232 replay_runner.py:36] Average training steps per second: 280.90


Done fixed training!Episode length: 67 Return: -537.618138742774429