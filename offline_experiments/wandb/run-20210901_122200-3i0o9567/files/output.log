Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:22:06.800077 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:22:06.809236 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:06.809424 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:06.809516 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:06.809592 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:06.809657 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:06.809718 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:06.809784 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:06.809844 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:06.809936 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:06.809998 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:06.810064 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:06.810181 140320049072128 dqn_agent.py:283] 	 seed: 1630498926809186
I0901 12:22:06.813657 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:06.813876 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:22:06.814000 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:06.814094 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:06.814242 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:06.814365 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:06.814487 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:06.814611 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:06.814926 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:07.008579 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:07.470863 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:07.487123 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:22:07.496763 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:22:07.497039 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:22:07.497213 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:22:07.497385 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:22:07.497531 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:22:07.497655 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:22:07.497897 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:22:07.498015 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:22:07.498150 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:22:07.498270 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:22:07.498398 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:22:07.498513 140320049072128 dqn_agent.py:283] 	 seed: 1630498927496695
I0901 12:22:07.501606 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:22:07.501862 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:22:07.501994 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:22:07.502123 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:22:07.502237 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:22:07.502346 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:22:07.502475 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:22:07.502577 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:22:07.502739 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:22:07.544570 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:22:07.565858 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:22:07.566902 140320049072128 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 136.73
I0901 12:22:14.881577 140320049072128 replay_runner.py:36] Average training steps per second: 136.73
I0901 12:22:16.350024 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:22:16.585328 140320049072128 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.68
I0901 12:22:21.644547 140320049072128 replay_runner.py:36] Average training steps per second: 197.68
I0901 12:22:22.076756 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:22:22.316537 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 195.38
I0901 12:22:27.435286 140320049072128 replay_runner.py:36] Average training steps per second: 195.38
I0901 12:22:27.891372 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 220 Episode length: 220 Return: -219.0
INFO:tensorflow:Average training steps per second: 187.30
I0901 12:22:33.495355 140320049072128 replay_runner.py:36] Average training steps per second: 187.30
I0901 12:22:33.700431 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.00
INFO:tensorflow:Starting iteration 4

Steps executed: 266 Episode length: 266 Return: -265.0
INFO:tensorflow:Average training steps per second: 197.30
I0901 12:22:39.021018 140320049072128 replay_runner.py:36] Average training steps per second: 197.30
I0901 12:22:39.253732 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 187.12
I0901 12:22:44.851237 140320049072128 replay_runner.py:36] Average training steps per second: 187.12
I0901 12:22:45.292939 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:22:45.547069 140320049072128 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 202.59
I0901 12:22:50.483885 140320049072128 replay_runner.py:36] Average training steps per second: 202.59
I0901 12:22:50.916874 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:22:51.172100 140320049072128 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 189.73
I0901 12:22:56.443063 140320049072128 replay_runner.py:36] Average training steps per second: 189.73
I0901 12:22:56.870680 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 254 Episode length: 254 Return: -253.0
INFO:tensorflow:Average training steps per second: 197.81
I0901 12:23:02.160615 140320049072128 replay_runner.py:36] Average training steps per second: 197.81
I0901 12:23:02.383955 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -253.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.28
I0901 12:23:07.907667 140320049072128 replay_runner.py:36] Average training steps per second: 189.28
I0901 12:23:08.346721 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 340 Episode length: 150 Return: -149.0
INFO:tensorflow:Average training steps per second: 194.09
I0901 12:23:13.753870 140320049072128 replay_runner.py:36] Average training steps per second: 194.09
I0901 12:23:14.060859 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.05
I0901 12:23:19.541067 140320049072128 replay_runner.py:36] Average training steps per second: 191.05
I0901 12:23:19.973302 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0901 12:23:20.218827 140320049072128 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 197.37
I0901 12:23:25.285769 140320049072128 replay_runner.py:36] Average training steps per second: 197.37
I0901 12:23:25.739110 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 240 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 191.21
I0901 12:23:31.201222 140320049072128 replay_runner.py:36] Average training steps per second: 191.21
I0901 12:23:31.408657 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 14

Steps executed: 339 Episode length: 162 Return: -161.0
INFO:tensorflow:Average training steps per second: 190.29
I0901 12:23:36.906623 140320049072128 replay_runner.py:36] Average training steps per second: 190.29
I0901 12:23:37.217432 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.50
INFO:tensorflow:Starting iteration 15
I0901 12:23:37.466831 140320049072128 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 193.28
I0901 12:23:42.641102 140320049072128 replay_runner.py:36] Average training steps per second: 193.28

Steps executed: 200 Episode length: 115 Return: -114.0
INFO:tensorflow:Starting iteration 16

Steps executed: 244 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 182.32
I0901 12:23:48.548886 140320049072128 replay_runner.py:36] Average training steps per second: 182.32
I0901 12:23:48.754851 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.00
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.63
I0901 12:23:54.175067 140320049072128 replay_runner.py:36] Average training steps per second: 192.63
I0901 12:23:54.655258 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 287 Episode length: 114 Return: -113.0
INFO:tensorflow:Average training steps per second: 196.59
I0901 12:23:59.998417 140320049072128 replay_runner.py:36] Average training steps per second: 196.59
I0901 12:24:00.245169 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.18
I0901 12:24:05.716872 140320049072128 replay_runner.py:36] Average training steps per second: 191.18
I0901 12:24:06.180219 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 192.80
I0901 12:24:11.603628 140320049072128 replay_runner.py:36] Average training steps per second: 192.80
I0901 12:24:11.807286 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.35
I0901 12:24:17.424700 140320049072128 replay_runner.py:36] Average training steps per second: 186.35
I0901 12:24:17.897992 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22

Steps executed: 641 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.14
I0901 12:24:23.376337 140320049072128 replay_runner.py:36] Average training steps per second: 191.14
I0901 12:24:23.932683 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.00
INFO:tensorflow:Starting iteration 23
I0901 12:24:24.183450 140320049072128 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 200.26

Steps executed: 245 Episode length: 128 Return: -127.0
I0901 12:24:29.394626 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 24

Steps executed: 258 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 195.46
I0901 12:24:34.742752 140320049072128 replay_runner.py:36] Average training steps per second: 195.46
I0901 12:24:34.968443 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 25

Steps executed: 232 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 200.77
I0901 12:24:40.202014 140320049072128 replay_runner.py:36] Average training steps per second: 200.77
I0901 12:24:40.408524 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 207.28
I0901 12:24:45.485326 140320049072128 replay_runner.py:36] Average training steps per second: 207.28
I0901 12:24:45.654676 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 206.79
I0901 12:24:50.717248 140320049072128 replay_runner.py:36] Average training steps per second: 206.79
I0901 12:24:51.146388 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 218 Episode length: 218 Return: -217.0
INFO:tensorflow:Average training steps per second: 202.73
I0901 12:24:56.308749 140320049072128 replay_runner.py:36] Average training steps per second: 202.73
I0901 12:24:56.486160 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.35
I0901 12:25:01.809011 140320049072128 replay_runner.py:36] Average training steps per second: 196.35
I0901 12:25:02.305647 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.50