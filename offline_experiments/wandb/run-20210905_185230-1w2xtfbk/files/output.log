Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0905 18:52:36.921877 139831300229120 run_experiment.py:549] Creating TrainRunner ...
I0905 18:52:36.931042 139831300229120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:36.931316 139831300229120 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:36.931533 139831300229120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:36.931654 139831300229120 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:36.931798 139831300229120 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:36.931995 139831300229120 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:36.932105 139831300229120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:36.932241 139831300229120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:36.932374 139831300229120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:36.932525 139831300229120 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:36.932629 139831300229120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:36.932735 139831300229120 dqn_agent.py:283] 	 seed: 1630867956930981
I0905 18:52:36.935825 139831300229120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:36.936048 139831300229120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:52:36.936189 139831300229120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:36.936288 139831300229120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:36.936427 139831300229120 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:36.936528 139831300229120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:36.936652 139831300229120 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:36.936773 139831300229120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:36.936963 139831300229120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:36.984435 139831300229120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:37.467593 139831300229120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:37.482403 139831300229120 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:52:37.491300 139831300229120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:52:37.491540 139831300229120 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:52:37.491716 139831300229120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:52:37.491838 139831300229120 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:52:37.491947 139831300229120 dqn_agent.py:275] 	 update_period: 4
I0905 18:52:37.492056 139831300229120 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:52:37.492218 139831300229120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:52:37.492369 139831300229120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:52:37.492509 139831300229120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:52:37.492622 139831300229120 dqn_agent.py:280] 	 optimizer: adam
I0905 18:52:37.492765 139831300229120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:52:37.492889 139831300229120 dqn_agent.py:283] 	 seed: 1630867957491243
I0905 18:52:37.495295 139831300229120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:52:37.495479 139831300229120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:52:37.495608 139831300229120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:52:37.495717 139831300229120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:52:37.495811 139831300229120 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:52:37.495901 139831300229120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:52:37.496054 139831300229120 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:52:37.496145 139831300229120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:52:37.496238 139831300229120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:52:37.534757 139831300229120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:52:37.562779 139831300229120 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:52:37.563124 139831300229120 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 141.87
I0905 18:52:44.612446 139831300229120 replay_runner.py:36] Average training steps per second: 141.87
I0905 18:52:46.347222 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 18:52:46.607401 139831300229120 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 173.95
I0905 18:52:52.356581 139831300229120 replay_runner.py:36] Average training steps per second: 173.95
I0905 18:52:52.944183 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0905 18:52:53.222469 139831300229120 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 174.40
I0905 18:52:58.957311 139831300229120 replay_runner.py:36] Average training steps per second: 174.40
I0905 18:52:59.486748 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 214 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 171.17
I0905 18:53:05.605743 139831300229120 replay_runner.py:36] Average training steps per second: 171.17
I0905 18:53:05.838400 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.00
INFO:tensorflow:Starting iteration 4

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 171.06
I0905 18:53:11.917487 139831300229120 replay_runner.py:36] Average training steps per second: 171.06
I0905 18:53:12.478460 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 18:53:12.771044 139831300229120 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 174.04
I0905 18:53:18.517526 139831300229120 replay_runner.py:36] Average training steps per second: 174.04
I0905 18:53:19.098012 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 208 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 177.40
I0905 18:53:25.013321 139831300229120 replay_runner.py:36] Average training steps per second: 177.40
I0905 18:53:25.267077 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 170.52
I0905 18:53:31.420051 139831300229120 replay_runner.py:36] Average training steps per second: 170.52
I0905 18:53:31.985924 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 255 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 176.12
I0905 18:53:37.950622 139831300229120 replay_runner.py:36] Average training steps per second: 176.12
I0905 18:53:38.243209 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 156.90
I0905 18:53:44.894889 139831300229120 replay_runner.py:36] Average training steps per second: 156.90
I0905 18:53:45.461535 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0905 18:53:45.740277 139831300229120 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 170.75
I0905 18:53:51.597575 139831300229120 replay_runner.py:36] Average training steps per second: 170.75
I0905 18:53:52.158407 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0905 18:53:52.440294 139831300229120 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 171.57
I0905 18:53:58.269665 139831300229120 replay_runner.py:36] Average training steps per second: 171.57
I0905 18:53:58.839623 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 594 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 170.33
I0905 18:54:04.990817 139831300229120 replay_runner.py:36] Average training steps per second: 170.33
I0905 18:54:05.617517 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.50
INFO:tensorflow:Starting iteration 13

Steps executed: 250 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 171.93
I0905 18:54:11.702930 139831300229120 replay_runner.py:36] Average training steps per second: 171.93
I0905 18:54:11.975866 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 14

Steps executed: 251 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 171.06
I0905 18:54:18.092242 139831300229120 replay_runner.py:36] Average training steps per second: 171.06
I0905 18:54:18.359695 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 15

Steps executed: 288 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 172.05
I0905 18:54:24.443870 139831300229120 replay_runner.py:36] Average training steps per second: 172.05
I0905 18:54:24.766950 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 16
I0905 18:54:25.039446 139831300229120 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 170.13

Steps executed: 239 Episode length: 70 Return: -69.0.0
I0905 18:54:31.193711 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 17

Steps executed: 231 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 169.81
I0905 18:54:37.360119 139831300229120 replay_runner.py:36] Average training steps per second: 169.81
I0905 18:54:37.614069 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 18

Steps executed: 268 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 174.04
I0905 18:54:43.600041 139831300229120 replay_runner.py:36] Average training steps per second: 174.04
I0905 18:54:43.889490 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 19

Steps executed: 239 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 167.05
I0905 18:54:50.151518 139831300229120 replay_runner.py:36] Average training steps per second: 167.05
I0905 18:54:50.403937 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 20

Steps executed: 221 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 174.32
I0905 18:54:56.411377 139831300229120 replay_runner.py:36] Average training steps per second: 174.32
I0905 18:54:56.652411 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 21

Steps executed: 182 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 170.74

Steps executed: 682 Episode length: 500 Return: -500.0
I0905 18:55:03.500742 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.67
INFO:tensorflow:Starting iteration 22

Steps executed: 206 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 168.05
I0905 18:55:09.733759 139831300229120 replay_runner.py:36] Average training steps per second: 168.05
I0905 18:55:09.962899 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.67
INFO:tensorflow:Starting iteration 23

Steps executed: 255 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 170.36
I0905 18:55:16.107367 139831300229120 replay_runner.py:36] Average training steps per second: 170.36
I0905 18:55:16.399119 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 24

Steps executed: 256 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 171.18
I0905 18:55:22.486348 139831300229120 replay_runner.py:36] Average training steps per second: 171.18
I0905 18:55:22.756545 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 25

Steps executed: 222 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 168.49
I0905 18:55:28.964114 139831300229120 replay_runner.py:36] Average training steps per second: 168.49
I0905 18:55:29.207910 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.00
INFO:tensorflow:Starting iteration 26


Steps executed: 201 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 175.39
I0905 18:55:35.207076 139831300229120 replay_runner.py:36] Average training steps per second: 175.39
I0905 18:55:35.408294 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -66.00
INFO:tensorflow:Starting iteration 27

Steps executed: 262 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 185.65
I0905 18:55:41.068658 139831300229120 replay_runner.py:36] Average training steps per second: 185.65
I0905 18:55:41.300186 139831300229120 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 28

Steps executed: 150 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 192.82
I0905 18:55:46.730094 139831300229120 replay_runner.py:36] Average training steps per second: 192.82

Steps executed: 229 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 186.65
I0905 18:55:52.604469 139831300229120 replay_runner.py:36] Average training steps per second: 186.65

Done fixed training!Episode length: 83 Return: -82.0.0