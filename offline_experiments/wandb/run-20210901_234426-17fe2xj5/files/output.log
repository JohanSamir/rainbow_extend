Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0901 23:44:33.623439 140630304192512 run_experiment.py:549] Creating TrainRunner ...
I0901 23:44:33.634673 140630304192512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:33.634990 140630304192512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:33.635128 140630304192512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:33.635267 140630304192512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:33.635358 140630304192512 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:33.635442 140630304192512 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:33.635517 140630304192512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:33.635598 140630304192512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:33.635669 140630304192512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:33.635738 140630304192512 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:33.635808 140630304192512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:33.635877 140630304192512 dqn_agent.py:283] 	 seed: 1630539873634600
I0901 23:44:33.638404 140630304192512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:33.638620 140630304192512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:33.638735 140630304192512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:33.638823 140630304192512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:33.638905 140630304192512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:33.639041 140630304192512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:33.639145 140630304192512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:33.639412 140630304192512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:33.639716 140630304192512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:33.684489 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:34.215830 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:34.229796 140630304192512 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:44:34.240537 140630304192512 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:34.240767 140630304192512 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:34.240929 140630304192512 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:34.241009 140630304192512 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:34.241076 140630304192512 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:34.241174 140630304192512 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:44:34.241627 140630304192512 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:34.241782 140630304192512 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:34.241896 140630304192512 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:34.241972 140630304192512 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:34.242053 140630304192512 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:34.242174 140630304192512 dqn_agent.py:283] 	 seed: 1630539874240491
I0901 23:44:34.245659 140630304192512 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:34.245963 140630304192512 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:44:34.246093 140630304192512 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:34.246231 140630304192512 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:34.246312 140630304192512 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:34.246412 140630304192512 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:34.246555 140630304192512 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:34.246674 140630304192512 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:34.246821 140630304192512 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:34.277150 140630304192512 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:34.298534 140630304192512 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:44:34.298843 140630304192512 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.02
I0901 23:44:40.920917 140630304192512 replay_runner.py:36] Average training steps per second: 151.02
Steps executed: 214 Episode length: 107 Return: 107.0
I0901 23:44:42.027176 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.00
INFO:tensorflow:Starting iteration 1
I0901 23:44:42.211346 140630304192512 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 197.06

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 23:44:47.417871 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2

Steps executed: 229 Episode length: 77 Return: 77.0.0
INFO:tensorflow:Average training steps per second: 200.23
I0901 23:44:52.593613 140630304192512 replay_runner.py:36] Average training steps per second: 200.23
I0901 23:44:52.750450 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 76.33
INFO:tensorflow:Starting iteration 3
I0901 23:44:52.939303 140630304192512 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 189.29
I0901 23:44:58.222967 140630304192512 replay_runner.py:36] Average training steps per second: 189.29
I0901 23:44:58.357332 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.04
I0901 23:45:03.673704 140630304192512 replay_runner.py:36] Average training steps per second: 195.04
I0901 23:45:03.811252 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0901 23:45:03.992121 140630304192512 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 194.37
I0901 23:45:09.137315 140630304192512 replay_runner.py:36] Average training steps per second: 194.37
I0901 23:45:09.270379 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0901 23:45:09.461456 140630304192512 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 190.20
I0901 23:45:14.719423 140630304192512 replay_runner.py:36] Average training steps per second: 190.20
I0901 23:45:14.860197 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0901 23:45:15.044521 140630304192512 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 187.56
I0901 23:45:20.376628 140630304192512 replay_runner.py:36] Average training steps per second: 187.56
I0901 23:45:20.520918 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0901 23:45:20.716826 140630304192512 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 192.25
I0901 23:45:25.919039 140630304192512 replay_runner.py:36] Average training steps per second: 192.25
I0901 23:45:26.069694 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 311 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 191.27
I0901 23:45:31.487680 140630304192512 replay_runner.py:36] Average training steps per second: 191.27
I0901 23:45:31.697967 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.50
INFO:tensorflow:Starting iteration 10

Steps executed: 307 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 190.78
I0901 23:45:37.129122 140630304192512 replay_runner.py:36] Average training steps per second: 190.78
I0901 23:45:37.336974 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 11

Steps executed: 266 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 190.03
I0901 23:45:42.782969 140630304192512 replay_runner.py:36] Average training steps per second: 190.03
I0901 23:45:42.965851 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 12

Steps executed: 325 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 192.70
I0901 23:45:48.343355 140630304192512 replay_runner.py:36] Average training steps per second: 192.70
I0901 23:45:48.558422 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 13

Steps executed: 290 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 189.90
I0901 23:45:54.004261 140630304192512 replay_runner.py:36] Average training steps per second: 189.90
I0901 23:45:54.210002 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 14
I0901 23:45:54.398662 140630304192512 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 195.15

Steps executed: 361 Episode length: 187 Return: 187.0
I0901 23:45:59.768278 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.40
I0901 23:46:05.260393 140630304192512 replay_runner.py:36] Average training steps per second: 188.40
I0901 23:46:05.389916 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 309 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 187.64
I0901 23:46:10.906798 140630304192512 replay_runner.py:36] Average training steps per second: 187.64
I0901 23:46:11.109606 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.64
I0901 23:46:16.524056 140630304192512 replay_runner.py:36] Average training steps per second: 191.64
I0901 23:46:16.663836 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0901 23:46:16.854999 140630304192512 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 191.33
I0901 23:46:22.082034 140630304192512 replay_runner.py:36] Average training steps per second: 191.33
I0901 23:46:22.218441 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 23:46:22.416066 140630304192512 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.88
I0901 23:46:27.628279 140630304192512 replay_runner.py:36] Average training steps per second: 191.88
I0901 23:46:27.764612 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:46:27.947031 140630304192512 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 192.32
I0901 23:46:33.147075 140630304192512 replay_runner.py:36] Average training steps per second: 192.32
I0901 23:46:33.289152 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:46:33.493424 140630304192512 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 192.16
I0901 23:46:38.697951 140630304192512 replay_runner.py:36] Average training steps per second: 192.16
I0901 23:46:38.831932 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:46:39.023238 140630304192512 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 194.10
I0901 23:46:44.175801 140630304192512 replay_runner.py:36] Average training steps per second: 194.10
I0901 23:46:44.310498 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:46:44.488475 140630304192512 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 192.95
I0901 23:46:49.671461 140630304192512 replay_runner.py:36] Average training steps per second: 192.95
I0901 23:46:49.804778 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:46:49.989764 140630304192512 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 197.17
I0901 23:46:55.062035 140630304192512 replay_runner.py:36] Average training steps per second: 197.17
I0901 23:46:55.189826 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:46:55.369011 140630304192512 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 194.08
I0901 23:47:00.521998 140630304192512 replay_runner.py:36] Average training steps per second: 194.08
I0901 23:47:00.661603 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:47:00.865185 140630304192512 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 196.29
I0901 23:47:05.960370 140630304192512 replay_runner.py:36] Average training steps per second: 196.29
I0901 23:47:06.082923 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:47:06.333126 140630304192512 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.40
I0901 23:47:11.504362 140630304192512 replay_runner.py:36] Average training steps per second: 193.40
I0901 23:47:11.641988 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:47:11.839980 140630304192512 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.56
I0901 23:47:16.953972 140630304192512 replay_runner.py:36] Average training steps per second: 195.56
I0901 23:47:17.081445 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.78
I0901 23:47:22.400123 140630304192512 replay_runner.py:36] Average training steps per second: 194.78
I0901 23:47:22.529529 140630304192512 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00