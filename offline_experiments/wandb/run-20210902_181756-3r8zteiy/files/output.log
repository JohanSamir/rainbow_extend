I0902 18:18:01.794618 140451420674048 run_experiment.py:549] Creating TrainRunner ...
I0902 18:18:01.802492 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:18:01.802633 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:18:01.802711 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:18:01.802772 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:18:01.802835 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:18:01.802913 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:18:01.803024 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:18:01.803101 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:18:01.803169 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:18:01.803237 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:18:01.803311 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:18:01.803384 140451420674048 dqn_agent.py:283] 	 seed: 1630606681802458
I0902 18:18:01.805151 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:18:01.805261 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:18:01.805352 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:18:01.805431 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:18:01.805489 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:18:01.805560 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:18:01.805649 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:18:01.805718 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:18:01.805776 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:18:01.828745 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:18:02.079234 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:18:02.088226 140451420674048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:18:02.094516 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:18:02.094642 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:18:02.094714 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:18:02.094775 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:18:02.094830 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:18:02.094902 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:18:02.094990 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:18:02.095052 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:18:02.095129 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:18:02.095196 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:18:02.095263 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:18:02.095329 140451420674048 dqn_agent.py:283] 	 seed: 1630606682094488
I0902 18:18:02.096772 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:18:02.096882 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:18:02.096953 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:18:02.097014 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:18:02.097078 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:18:02.097147 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:18:02.097206 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:18:02.097281 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:18:02.097332 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:18:02.117418 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 18:18:02.132395 140451420674048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:18:02.132545 140451420674048 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 241.67
I0902 18:18:06.270579 140451420674048 replay_runner.py:36] Average training steps per second: 241.67
I0902 18:18:07.135036 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.11
Steps executed: 305 Episode length: 113 Return: -256.2732187771997
INFO:tensorflow:Starting iteration 1
I0902 18:18:10.395855 140451420674048 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 318.15
I0902 18:18:13.539271 140451420674048 replay_runner.py:36] Average training steps per second: 318.15

Steps executed: 282 Episode length: 153 Return: -133.7001122588061
INFO:tensorflow:Starting iteration 2
I0902 18:18:16.978452 140451420674048 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 326.32
I0902 18:18:20.043156 140451420674048 replay_runner.py:36] Average training steps per second: 326.32

Steps executed: 357 Episode length: 189 Return: -306.19440763886723
INFO:tensorflow:Starting iteration 3
I0902 18:18:23.500479 140451420674048 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 357.93
I0902 18:18:26.294508 140451420674048 replay_runner.py:36] Average training steps per second: 357.93

Steps executed: 235 Episode length: 235 Return: -279.54709747855566
INFO:tensorflow:Starting iteration 4
I0902 18:18:29.980559 140451420674048 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 384.51

Steps executed: 1000 Episode length: 1000 Return: -176.707536238685
I0902 18:18:34.767599 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.71
INFO:tensorflow:Starting iteration 5
I0902 18:18:38.190775 140451420674048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 366.65

Steps executed: 1000 Episode length: 1000 Return: -135.0084509052151
I0902 18:18:42.713580 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.01
INFO:tensorflow:Starting iteration 6
I0902 18:18:46.052542 140451420674048 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 354.28

Steps executed: 1000 Episode length: 1000 Return: -181.22713477536914
I0902 18:18:52.122454 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.23
INFO:tensorflow:Starting iteration 7

Steps executed: 617 Episode length: 617 Return: -598.8755772933104914
INFO:tensorflow:Average training steps per second: 324.50
I0902 18:18:58.326819 140451420674048 replay_runner.py:36] Average training steps per second: 324.50
I0902 18:18:59.155022 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -598.88
INFO:tensorflow:Starting iteration 8
I0902 18:19:02.399106 140451420674048 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 319.62

Steps executed: 459 Episode length: 459 Return: -413.4526191552667914
I0902 18:19:05.989967 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.45
INFO:tensorflow:Starting iteration 9

Steps executed: 403 Episode length: 403 Return: -425.9027061256797414
INFO:tensorflow:Average training steps per second: 328.09
I0902 18:19:12.367317 140451420674048 replay_runner.py:36] Average training steps per second: 328.09
I0902 18:19:12.800797 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.90
INFO:tensorflow:Starting iteration 10

Steps executed: 264 Episode length: 264 Return: -311.4793635108105414
INFO:tensorflow:Average training steps per second: 333.80
I0902 18:19:19.074771 140451420674048 replay_runner.py:36] Average training steps per second: 333.80
I0902 18:19:19.306511 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.48
INFO:tensorflow:Starting iteration 11
I0902 18:19:22.699679 140451420674048 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 344.93
I0902 18:19:25.599062 140451420674048 replay_runner.py:36] Average training steps per second: 344.93

Steps executed: 277 Episode length: 277 Return: -382.3630478343216614
INFO:tensorflow:Starting iteration 12

Steps executed: 387 Episode length: 387 Return: -156.0320997375751614
INFO:tensorflow:Average training steps per second: 335.90
I0902 18:19:32.169243 140451420674048 replay_runner.py:36] Average training steps per second: 335.90
I0902 18:19:32.572124 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.03
INFO:tensorflow:Starting iteration 13
I0902 18:19:35.927836 140451420674048 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 336.27

Steps executed: 935 Episode length: 935 Return: -210.6053911680612314
I0902 18:19:41.199492 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.61
INFO:tensorflow:Starting iteration 14

Steps executed: 245 Episode length: 245 Return: -48.70997025084281514
INFO:tensorflow:Average training steps per second: 319.67
I0902 18:19:47.575399 140451420674048 replay_runner.py:36] Average training steps per second: 319.67
I0902 18:19:47.751300 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -48.71
INFO:tensorflow:Starting iteration 15
I0902 18:19:51.007277 140451420674048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 324.72

Steps executed: 851 Episode length: 851 Return: -157.9599489330025814
I0902 18:19:55.762629 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.96
INFO:tensorflow:Starting iteration 16

Steps executed: 509 Episode length: 509 Return: -44.89110739333436814
INFO:tensorflow:Average training steps per second: 325.31
I0902 18:20:02.212224 140451420674048 replay_runner.py:36] Average training steps per second: 325.31
I0902 18:20:02.909409 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.89
INFO:tensorflow:Starting iteration 17
I0902 18:20:06.259824 140451420674048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 323.61

Steps executed: 543 Episode length: 543 Return: -341.5581576507116814
I0902 18:20:10.239015 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.56
INFO:tensorflow:Starting iteration 18

Steps executed: 264 Episode length: 153 Return: -249.2541808620893614
INFO:tensorflow:Average training steps per second: 324.47
I0902 18:20:16.614333 140451420674048 replay_runner.py:36] Average training steps per second: 324.47
I0902 18:20:16.769145 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.72
INFO:tensorflow:Starting iteration 19

Steps executed: 201 Episode length: 201 Return: -231.2146806839313614
INFO:tensorflow:Average training steps per second: 321.69
I0902 18:20:23.204887 140451420674048 replay_runner.py:36] Average training steps per second: 321.69
I0902 18:20:23.344584 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.21
INFO:tensorflow:Starting iteration 20
I0902 18:20:26.670745 140451420674048 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 322.42

Steps executed: 1000 Episode length: 1000 Return: -96.685580372188414
I0902 18:20:31.784700 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.69
INFO:tensorflow:Starting iteration 21

Steps executed: 893 Episode length: 893 Return: -567.1411424740326414
INFO:tensorflow:Average training steps per second: 322.59
I0902 18:20:38.201151 140451420674048 replay_runner.py:36] Average training steps per second: 322.59
I0902 18:20:40.081495 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -567.14
INFO:tensorflow:Starting iteration 22

Steps executed: 688 Episode length: 512 Return: 219.98606507235027414
INFO:tensorflow:Average training steps per second: 336.16
I0902 18:20:46.466814 140451420674048 replay_runner.py:36] Average training steps per second: 336.16
I0902 18:20:47.169878 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -40.28
INFO:tensorflow:Starting iteration 23
I0902 18:20:50.607640 140451420674048 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 333.90
I0902 18:20:53.602784 140451420674048 replay_runner.py:36] Average training steps per second: 333.90

Steps executed: 337 Episode length: 337 Return: -22.65276897225028614
INFO:tensorflow:Starting iteration 24

Steps executed: 438 Episode length: 438 Return: -398.5646700753211514
INFO:tensorflow:Average training steps per second: 341.94
I0902 18:21:00.270991 140451420674048 replay_runner.py:36] Average training steps per second: 341.94
I0902 18:21:00.678574 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.56
INFO:tensorflow:Starting iteration 25

Steps executed: 399 Episode length: 306 Return: -98.66548947951335514
INFO:tensorflow:Average training steps per second: 349.56
I0902 18:21:06.913523 140451420674048 replay_runner.py:36] Average training steps per second: 349.56
I0902 18:21:07.237587 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.85
INFO:tensorflow:Starting iteration 26

Steps executed: 299 Episode length: 153 Return: -442.6527087762054314
INFO:tensorflow:Average training steps per second: 340.86
I0902 18:21:13.554116 140451420674048 replay_runner.py:36] Average training steps per second: 340.86
I0902 18:21:13.727191 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.30
INFO:tensorflow:Starting iteration 27
I0902 18:21:17.012428 140451420674048 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 324.11

Steps executed: 347 Episode length: 347 Return: -63.95208313948836314
I0902 18:21:20.438569 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.95
INFO:tensorflow:Starting iteration 28

Steps executed: 275 Episode length: 144 Return: -101.7571973501638214
INFO:tensorflow:Average training steps per second: 349.15
I0902 18:21:26.496357 140451420674048 replay_runner.py:36] Average training steps per second: 349.15
I0902 18:21:26.669092 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.18
INFO:tensorflow:Starting iteration 29

Steps executed: 300 Episode length: 300 Return: -506.1224026202824614
INFO:tensorflow:Average training steps per second: 345.88
I0902 18:21:32.898955 140451420674048 replay_runner.py:36] Average training steps per second: 345.88

Done fixed training!Episode length: 300 Return: -506.1224026202824614