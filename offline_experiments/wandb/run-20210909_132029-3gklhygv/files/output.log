Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
I0909 13:20:34.283088 140715861972992 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 13:20:34.283738 140715861972992 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 13:20:34.338352 140715861972992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:20:34.339200 140715861972992 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:20:34.339258 140715861972992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:20:34.339498 140715861972992 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:20:34.339568 140715861972992 dqn_agent.py:275] 	 update_period: 4
I0909 13:20:34.339619 140715861972992 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:20:34.339665 140715861972992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:20:34.339712 140715861972992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:20:34.339758 140715861972992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:20:34.339802 140715861972992 dqn_agent.py:280] 	 optimizer: adam
I0909 13:20:34.339845 140715861972992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:20:34.339889 140715861972992 dqn_agent.py:283] 	 seed: 1631193634338309
I0909 13:20:34.341502 140715861972992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:20:34.341622 140715861972992 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:20:34.341683 140715861972992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:20:34.341738 140715861972992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:20:34.341788 140715861972992 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:20:34.341834 140715861972992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:20:34.341881 140715861972992 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:20:34.341925 140715861972992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:20:34.342006 140715861972992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:20:35.317745 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.493025 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.515409 140715861972992 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:20:35.518700 140715861972992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:20:35.518827 140715861972992 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:20:35.518914 140715861972992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:20:35.518990 140715861972992 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:20:35.519042 140715861972992 dqn_agent.py:275] 	 update_period: 4
I0909 13:20:35.519095 140715861972992 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:20:35.519184 140715861972992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:20:35.519247 140715861972992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:20:35.519292 140715861972992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:20:35.519336 140715861972992 dqn_agent.py:280] 	 optimizer: adam
I0909 13:20:35.519380 140715861972992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:20:35.519423 140715861972992 dqn_agent.py:283] 	 seed: 1631193635518672
I0909 13:20:35.520662 140715861972992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:20:35.520764 140715861972992 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:20:35.520821 140715861972992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:20:35.520874 140715861972992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:20:35.520928 140715861972992 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:20:35.521016 140715861972992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:20:35.521068 140715861972992 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:20:35.521138 140715861972992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:20:35.521212 140715861972992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:20:35.535915 140715861972992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.545019 140715861972992 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:20:35.545147 140715861972992 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 316.07
I0909 13:20:38.709227 140715861972992 replay_runner.py:36] Average training steps per second: 316.07
I0909 13:20:39.313115 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:20:39.381114 140715861972992 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 404.70
I0909 13:20:41.852260 140715861972992 replay_runner.py:36] Average training steps per second: 404.70
I0909 13:20:41.979932 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2

Steps executed: 778 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 399.37
I0909 13:20:44.547270 140715861972992 replay_runner.py:36] Average training steps per second: 399.37
I0909 13:20:44.702936 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.00
INFO:tensorflow:Starting iteration 3

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 399.91
I0909 13:20:47.268927 140715861972992 replay_runner.py:36] Average training steps per second: 399.91
I0909 13:20:47.388412 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:20:47.453018 140715861972992 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 401.52
I0909 13:20:49.943756 140715861972992 replay_runner.py:36] Average training steps per second: 401.52
I0909 13:20:50.065665 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:20:50.130788 140715861972992 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 404.92
I0909 13:20:52.600608 140715861972992 replay_runner.py:36] Average training steps per second: 404.92
I0909 13:20:52.721231 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:20:52.783064 140715861972992 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 407.39
I0909 13:20:55.237937 140715861972992 replay_runner.py:36] Average training steps per second: 407.39
I0909 13:20:55.353882 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7

Steps executed: 706 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 405.08
I0909 13:20:57.887690 140715861972992 replay_runner.py:36] Average training steps per second: 405.08
I0909 13:20:58.020027 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.00
INFO:tensorflow:Starting iteration 8

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 397.92
I0909 13:21:00.598105 140715861972992 replay_runner.py:36] Average training steps per second: 397.92
I0909 13:21:00.728409 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:21:00.791129 140715861972992 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 404.07
I0909 13:21:03.266144 140715861972992 replay_runner.py:36] Average training steps per second: 404.07
I0909 13:21:03.387441 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10

Steps executed: 780 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 399.91
I0909 13:21:05.951811 140715861972992 replay_runner.py:36] Average training steps per second: 399.91
I0909 13:21:06.114218 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.00
INFO:tensorflow:Starting iteration 11

Steps executed: 688 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 397.64
I0909 13:21:08.691631 140715861972992 replay_runner.py:36] Average training steps per second: 397.64
I0909 13:21:08.828240 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.00
INFO:tensorflow:Starting iteration 12

Steps executed: 773 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 398.14
I0909 13:21:11.401657 140715861972992 replay_runner.py:36] Average training steps per second: 398.14
I0909 13:21:11.553802 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.50
INFO:tensorflow:Starting iteration 13

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 409.74
I0909 13:21:14.056703 140715861972992 replay_runner.py:36] Average training steps per second: 409.74
I0909 13:21:14.171242 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0909 13:21:14.233357 140715861972992 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 406.49
I0909 13:21:16.693624 140715861972992 replay_runner.py:36] Average training steps per second: 406.49
I0909 13:21:16.811894 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15

Steps executed: 300 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 408.45
I0909 13:21:19.323030 140715861972992 replay_runner.py:36] Average training steps per second: 408.45
I0909 13:21:19.382338 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.00
INFO:tensorflow:Starting iteration 16

Steps executed: 228 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 401.07
I0909 13:21:21.937556 140715861972992 replay_runner.py:36] Average training steps per second: 401.07
I0909 13:21:21.982889 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 17

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 400.17
I0909 13:21:24.545518 140715861972992 replay_runner.py:36] Average training steps per second: 400.17
I0909 13:21:24.661295 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18

Steps executed: 446 Episode length: 343 Return: -343.0
INFO:tensorflow:Average training steps per second: 405.48
I0909 13:21:27.190572 140715861972992 replay_runner.py:36] Average training steps per second: 405.48
I0909 13:21:27.276199 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.00
INFO:tensorflow:Starting iteration 19

Steps executed: 327 Episode length: 149 Return: -149.0
INFO:tensorflow:Average training steps per second: 404.25
I0909 13:21:29.812003 140715861972992 replay_runner.py:36] Average training steps per second: 404.25
I0909 13:21:29.875947 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.50
INFO:tensorflow:Starting iteration 20
I0909 13:21:29.937668 140715861972992 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 402.63

Steps executed: 252 Episode length: 153 Return: -153.0
I0909 13:21:32.471773 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 21

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 405.02
I0909 13:21:35.003691 140715861972992 replay_runner.py:36] Average training steps per second: 405.02
I0909 13:21:35.121986 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22

Steps executed: 301 Episode length: 113 Return: -113.0
INFO:tensorflow:Average training steps per second: 401.59
I0909 13:21:37.676084 140715861972992 replay_runner.py:36] Average training steps per second: 401.59
I0909 13:21:37.736620 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.33
INFO:tensorflow:Starting iteration 23
I0909 13:21:37.799484 140715861972992 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 398.62
I0909 13:21:40.308363 140715861972992 replay_runner.py:36] Average training steps per second: 398.62
I0909 13:21:40.353582 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 24


Steps executed: 766 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 399.90
I0909 13:21:42.918352 140715861972992 replay_runner.py:36] Average training steps per second: 399.90
I0909 13:21:43.066372 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.00
INFO:tensorflow:Starting iteration 25

Steps executed: 338 Episode length: 155 Return: -155.0
INFO:tensorflow:Average training steps per second: 401.30
I0909 13:21:45.620944 140715861972992 replay_runner.py:36] Average training steps per second: 401.30
I0909 13:21:45.688107 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.67
INFO:tensorflow:Starting iteration 26

Steps executed: 306 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 403.66
I0909 13:21:48.229593 140715861972992 replay_runner.py:36] Average training steps per second: 403.66
I0909 13:21:48.289332 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.00
INFO:tensorflow:Starting iteration 27

Steps executed: 683 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 403.75
I0909 13:21:50.828861 140715861972992 replay_runner.py:36] Average training steps per second: 403.75
I0909 13:21:50.964543 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.50
INFO:tensorflow:Starting iteration 28

Steps executed: 249 Episode length: 123 Return: -123.0
INFO:tensorflow:Average training steps per second: 398.60
I0909 13:21:53.534962 140715861972992 replay_runner.py:36] Average training steps per second: 398.60
I0909 13:21:53.584296 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 161 Return: -161.0
INFO:tensorflow:Average training steps per second: 404.45
I0909 13:21:56.118982 140715861972992 replay_runner.py:36] Average training steps per second: 404.45
I0909 13:21:56.187026 140715861972992 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.00