I0905 16:25:05.153118 140444824340480 run_experiment.py:549] Creating TrainRunner ...
I0905 16:25:05.160487 140444824340480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:05.160652 140444824340480 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:05.160766 140444824340480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:05.160828 140444824340480 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:05.160881 140444824340480 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:05.160935 140444824340480 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:05.161043 140444824340480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:05.161103 140444824340480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:05.161153 140444824340480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:05.161202 140444824340480 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:05.161274 140444824340480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:25:05.161354 140444824340480 dqn_agent.py:283] 	 seed: 1630859105160447
I0905 16:25:05.163097 140444824340480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:05.163218 140444824340480 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:05.163293 140444824340480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:05.163357 140444824340480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:05.163414 140444824340480 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:05.163466 140444824340480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:05.163545 140444824340480 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:05.163628 140444824340480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:05.163699 140444824340480 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0905 16:25:06.789482 140444824340480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:07.127588 140444824340480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:07.135653 140444824340480 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:25:07.141654 140444824340480 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:07.141797 140444824340480 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:07.141881 140444824340480 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:07.141946 140444824340480 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:07.142033 140444824340480 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:07.142091 140444824340480 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:07.142145 140444824340480 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:07.142246 140444824340480 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:07.142314 140444824340480 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:07.142369 140444824340480 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:07.142426 140444824340480 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:25:07.142504 140444824340480 dqn_agent.py:283] 	 seed: 1630859107141616
I0905 16:25:07.143893 140444824340480 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:07.144006 140444824340480 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:07.144076 140444824340480 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:07.144143 140444824340480 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:07.144201 140444824340480 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:07.144256 140444824340480 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:07.144352 140444824340480 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:07.151124 140444824340480 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:07.151211 140444824340480 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:25:07.186921 140444824340480 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:07.199656 140444824340480 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:25:07.199847 140444824340480 replay_runner.py:41] Starting iteration 0
Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 249.20
I0905 16:25:11.213032 140444824340480 replay_runner.py:36] Average training steps per second: 249.20
I0905 16:25:11.865524 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 346.53
I0905 16:25:14.886888 140444824340480 replay_runner.py:36] Average training steps per second: 346.53
I0905 16:25:14.947906 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 2

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 351.43
I0905 16:25:17.919903 140444824340480 replay_runner.py:36] Average training steps per second: 351.43
I0905 16:25:17.987251 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 333.62
I0905 16:25:21.116479 140444824340480 replay_runner.py:36] Average training steps per second: 333.62
I0905 16:25:21.183221 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.86
INFO:tensorflow:Starting iteration 4

Steps executed: 250 Episode length: 82 Return: 82.0
INFO:tensorflow:Average training steps per second: 335.01
I0905 16:25:24.302764 140444824340480 replay_runner.py:36] Average training steps per second: 335.01
I0905 16:25:24.380641 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 83.33
INFO:tensorflow:Starting iteration 5

Steps executed: 284 Episode length: 130 Return: 130.0
INFO:tensorflow:Average training steps per second: 338.44
I0905 16:25:27.466899 140444824340480 replay_runner.py:36] Average training steps per second: 338.44
I0905 16:25:27.563877 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 344.31
I0905 16:25:30.608746 140444824340480 replay_runner.py:36] Average training steps per second: 344.31
I0905 16:25:30.667927 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0905 16:25:30.795807 140444824340480 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 338.45
I0905 16:25:33.750989 140444824340480 replay_runner.py:36] Average training steps per second: 338.45
I0905 16:25:33.816726 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0905 16:25:33.952237 140444824340480 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 342.30
I0905 16:25:36.874138 140444824340480 replay_runner.py:36] Average training steps per second: 342.30
I0905 16:25:36.932943 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 345 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 349.85
I0905 16:25:39.923043 140444824340480 replay_runner.py:36] Average training steps per second: 349.85
I0905 16:25:40.022029 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 10
I0905 16:25:40.147355 140444824340480 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 344.63

Steps executed: 352 Episode length: 184 Return: 184.0
I0905 16:25:43.154018 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 11

Steps executed: 365 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 338.20
I0905 16:25:46.235690 140444824340480 replay_runner.py:36] Average training steps per second: 338.20
I0905 16:25:46.352204 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 336.17
I0905 16:25:49.460956 140444824340480 replay_runner.py:36] Average training steps per second: 336.17
I0905 16:25:49.524581 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 325 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 341.24
I0905 16:25:52.592415 140444824340480 replay_runner.py:36] Average training steps per second: 341.24
I0905 16:25:52.687068 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 348.09
I0905 16:25:55.691030 140444824340480 replay_runner.py:36] Average training steps per second: 348.09
I0905 16:25:55.748744 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0905 16:25:55.874416 140444824340480 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 345.88
I0905 16:25:58.765975 140444824340480 replay_runner.py:36] Average training steps per second: 345.88
I0905 16:25:58.824636 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0905 16:25:58.956132 140444824340480 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 345.77
I0905 16:26:01.848592 140444824340480 replay_runner.py:36] Average training steps per second: 345.77
I0905 16:26:01.907097 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17

Steps executed: 341 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 344.04
I0905 16:26:04.943217 140444824340480 replay_runner.py:36] Average training steps per second: 344.04
I0905 16:26:05.050663 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 18

Steps executed: 345 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 341.81
I0905 16:26:08.115210 140444824340480 replay_runner.py:36] Average training steps per second: 341.81
I0905 16:26:08.224434 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 19


Steps executed: 335 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 346.20
I0905 16:26:11.237085 140444824340480 replay_runner.py:36] Average training steps per second: 346.20
I0905 16:26:11.339293 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.50
INFO:tensorflow:Starting iteration 20

Steps executed: 385 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 341.39
I0905 16:26:14.398858 140444824340480 replay_runner.py:36] Average training steps per second: 341.39
I0905 16:26:14.511028 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 21

Steps executed: 308 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 339.40
I0905 16:26:17.584230 140444824340480 replay_runner.py:36] Average training steps per second: 339.40
I0905 16:26:17.676712 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 22

Steps executed: 297 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 342.31
I0905 16:26:20.732386 140444824340480 replay_runner.py:36] Average training steps per second: 342.31
I0905 16:26:20.820683 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 349.07
I0905 16:26:23.810496 140444824340480 replay_runner.py:36] Average training steps per second: 349.07
I0905 16:26:23.870765 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 381 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 347.68
I0905 16:26:26.873582 140444824340480 replay_runner.py:36] Average training steps per second: 347.68
I0905 16:26:26.985800 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.50
INFO:tensorflow:Starting iteration 25

Steps executed: 377 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 342.59
I0905 16:26:30.028975 140444824340480 replay_runner.py:36] Average training steps per second: 342.59
I0905 16:26:30.139863 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.50
INFO:tensorflow:Starting iteration 26
I0905 16:26:30.271141 140444824340480 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 343.54

Steps executed: 340 Episode length: 170 Return: 170.0
I0905 16:26:33.279281 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 27

Steps executed: 378 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 334.94
I0905 16:26:36.389212 140444824340480 replay_runner.py:36] Average training steps per second: 334.94
I0905 16:26:36.502926 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 336.36
I0905 16:26:39.603787 140444824340480 replay_runner.py:36] Average training steps per second: 336.36
I0905 16:26:39.668425 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 317.33
I0905 16:26:42.944901 140444824340480 replay_runner.py:36] Average training steps per second: 317.33
I0905 16:26:43.036287 140444824340480 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50