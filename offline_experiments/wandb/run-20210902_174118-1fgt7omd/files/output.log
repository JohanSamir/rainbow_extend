I0902 17:41:25.534049 140451420674048 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 17:41:25.534630 140451420674048 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 17:41:25.847795 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:25.850027 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:25.850160 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:25.850273 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:25.850373 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:25.850468 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:25.850737 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:25.850872 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:25.850984 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:25.851086 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:25.851185 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:25.851277 140451420674048 dqn_agent.py:283] 	 seed: 1630604485847693
I0902 17:41:25.853910 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:25.854066 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:25.854180 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:25.854285 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:25.854385 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:25.854488 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:25.854588 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:25.854676 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:25.854767 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 17:41:27.332818 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.068461 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.078510 140451420674048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:41:28.083371 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:41:28.083528 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:41:28.083613 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:41:28.083705 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:41:28.083808 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 17:41:28.083897 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:41:28.083973 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:41:28.084036 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:41:28.084091 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:41:28.084177 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 17:41:28.084239 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:41:28.084358 140451420674048 dqn_agent.py:283] 	 seed: 1630604488083331
I0902 17:41:28.085988 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:41:28.086117 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:41:28.086202 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:41:28.086270 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:41:28.086334 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:41:28.086396 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:41:28.086472 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:41:28.086561 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:41:28.086633 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:41:28.106740 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=10.000000
I0902 17:41:28.120779 140451420674048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:41:28.120978 140451420674048 replay_runner.py:41] Starting iteration 0
Steps executed: 220 Episode length: 220 Return: -1910.3071097385236
INFO:tensorflow:Average training steps per second: 176.77
I0902 17:41:33.778503 140451420674048 replay_runner.py:36] Average training steps per second: 176.77
I0902 17:41:35.009310 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -1910.31
INFO:tensorflow:Starting iteration 1

Steps executed: 214 Episode length: 133 Return: -742.07364619983436
INFO:tensorflow:Average training steps per second: 213.35
I0902 17:41:43.751121 140451420674048 replay_runner.py:36] Average training steps per second: 213.35
I0902 17:41:43.963239 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -682.85
INFO:tensorflow:Starting iteration 2

Steps executed: 233 Episode length: 233 Return: -620.13102671160526
INFO:tensorflow:Average training steps per second: 213.32
I0902 17:41:52.894776 140451420674048 replay_runner.py:36] Average training steps per second: 213.32
I0902 17:41:53.164808 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -620.13
INFO:tensorflow:Starting iteration 3

Steps executed: 274 Episode length: 93 Return: -469.107179821610426
INFO:tensorflow:Average training steps per second: 211.00
I0902 17:42:02.158794 140451420674048 replay_runner.py:36] Average training steps per second: 211.00
I0902 17:42:02.426023 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -543.86
INFO:tensorflow:Starting iteration 4

Steps executed: 230 Episode length: 102 Return: -693.50239860156396
INFO:tensorflow:Average training steps per second: 212.70
I0902 17:42:11.337296 140451420674048 replay_runner.py:36] Average training steps per second: 212.70
I0902 17:42:11.554579 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -696.29
INFO:tensorflow:Starting iteration 5

Steps executed: 294 Episode length: 127 Return: -729.62462894545586
INFO:tensorflow:Average training steps per second: 213.51
I0902 17:42:20.459361 140451420674048 replay_runner.py:36] Average training steps per second: 213.51
I0902 17:42:20.768605 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -785.91
INFO:tensorflow:Starting iteration 6

Steps executed: 241 Episode length: 122 Return: -666.00953432539736
INFO:tensorflow:Average training steps per second: 215.95
I0902 17:42:29.596652 140451420674048 replay_runner.py:36] Average training steps per second: 215.95
I0902 17:42:29.827810 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -681.65
INFO:tensorflow:Starting iteration 7

Steps executed: 223 Episode length: 105 Return: -467.43417204357826
INFO:tensorflow:Average training steps per second: 213.21
I0902 17:42:38.655186 140451420674048 replay_runner.py:36] Average training steps per second: 213.21
I0902 17:42:38.883382 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -514.17
INFO:tensorflow:Starting iteration 8

Steps executed: 258 Episode length: 258 Return: -387.70010475928726
INFO:tensorflow:Average training steps per second: 216.18
I0902 17:42:47.678176 140451420674048 replay_runner.py:36] Average training steps per second: 216.18
I0902 17:42:47.950633 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.70
INFO:tensorflow:Starting iteration 9

Steps executed: 385 Episode length: 201 Return: -369.05194566468055
INFO:tensorflow:Average training steps per second: 216.11
I0902 17:42:56.805674 140451420674048 replay_runner.py:36] Average training steps per second: 216.11
I0902 17:42:57.185459 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -516.20
INFO:tensorflow:Starting iteration 10

Steps executed: 308 Episode length: 193 Return: -612.52810589317375
INFO:tensorflow:Average training steps per second: 213.87
I0902 17:43:06.100470 140451420674048 replay_runner.py:36] Average training steps per second: 213.87
I0902 17:43:06.404711 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -641.19
INFO:tensorflow:Starting iteration 11

Steps executed: 215 Episode length: 107 Return: -683.22001145698795
INFO:tensorflow:Average training steps per second: 214.41
I0902 17:43:15.361946 140451420674048 replay_runner.py:36] Average training steps per second: 214.41
I0902 17:43:15.561286 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -595.60
INFO:tensorflow:Starting iteration 12

Steps executed: 255 Episode length: 82 Return: -481.079181166864315
INFO:tensorflow:Average training steps per second: 216.85
I0902 17:43:24.422520 140451420674048 replay_runner.py:36] Average training steps per second: 216.85
I0902 17:43:24.660646 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.31
INFO:tensorflow:Starting iteration 13
I0902 17:43:28.907978 140451420674048 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 216.28

Steps executed: 394 Episode length: 394 Return: -534.69938700211955
I0902 17:43:34.090260 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.70
INFO:tensorflow:Starting iteration 14

Steps executed: 267 Episode length: 267 Return: -255.77623202310582
INFO:tensorflow:Average training steps per second: 209.66
I0902 17:43:43.138045 140451420674048 replay_runner.py:36] Average training steps per second: 209.66
I0902 17:43:43.419217 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.78
INFO:tensorflow:Starting iteration 15

Steps executed: 316 Episode length: 316 Return: -434.16968246961557
INFO:tensorflow:Average training steps per second: 214.11
I0902 17:43:52.352642 140451420674048 replay_runner.py:36] Average training steps per second: 214.11
I0902 17:43:52.762574 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.17
INFO:tensorflow:Starting iteration 16

Steps executed: 97 Episode length: 97 Return: -492.5162650087196457
INFO:tensorflow:Average training steps per second: 217.81

Steps executed: 358 Episode length: 165 Return: -477.41711633819585
I0902 17:44:01.970551 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -486.55
INFO:tensorflow:Starting iteration 17

Steps executed: 317 Episode length: 317 Return: -726.23331724250845
INFO:tensorflow:Average training steps per second: 219.15
I0902 17:44:10.840872 140451420674048 replay_runner.py:36] Average training steps per second: 219.15
I0902 17:44:11.161239 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -726.23
INFO:tensorflow:Starting iteration 18

Steps executed: 292 Episode length: 123 Return: -388.22593449960436
INFO:tensorflow:Average training steps per second: 239.83
I0902 17:44:19.313959 140451420674048 replay_runner.py:36] Average training steps per second: 239.83
I0902 17:44:19.489515 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.38
INFO:tensorflow:Starting iteration 19
I0902 17:44:23.288689 140451420674048 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 249.36
I0902 17:44:27.299239 140451420674048 replay_runner.py:36] Average training steps per second: 249.36

Steps executed: 211 Episode length: 211 Return: -263.40444620988316
INFO:tensorflow:Starting iteration 20

Steps executed: 231 Episode length: 122 Return: -502.71400057762785
INFO:tensorflow:Average training steps per second: 235.06
I0902 17:44:35.947929 140451420674048 replay_runner.py:36] Average training steps per second: 235.06
I0902 17:44:36.133044 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.34
INFO:tensorflow:Starting iteration 21

Steps executed: 238 Episode length: 72 Return: -502.890576896046185
INFO:tensorflow:Average training steps per second: 224.14
I0902 17:44:44.939405 140451420674048 replay_runner.py:36] Average training steps per second: 224.14
I0902 17:44:45.145629 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.33
INFO:tensorflow:Starting iteration 22
I0902 17:44:49.494342 140451420674048 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 222.62

Steps executed: 321 Episode length: 156 Return: -464.69320010241725
I0902 17:44:54.274920 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.00
INFO:tensorflow:Starting iteration 23

Steps executed: 243 Episode length: 87 Return: -503.337278817869525
INFO:tensorflow:Average training steps per second: 221.33
I0902 17:45:03.174407 140451420674048 replay_runner.py:36] Average training steps per second: 221.33
I0902 17:45:03.377547 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.96
INFO:tensorflow:Starting iteration 24

Steps executed: 337 Episode length: 158 Return: -431.83431510025064
INFO:tensorflow:Average training steps per second: 221.69
I0902 17:45:12.160134 140451420674048 replay_runner.py:36] Average training steps per second: 221.69
I0902 17:45:12.465399 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -460.39
INFO:tensorflow:Starting iteration 25

Steps executed: 210 Episode length: 114 Return: -383.22436664111884
INFO:tensorflow:Average training steps per second: 222.04
I0902 17:45:21.345875 140451420674048 replay_runner.py:36] Average training steps per second: 222.04
I0902 17:45:21.513243 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.20
INFO:tensorflow:Starting iteration 26

Steps executed: 266 Episode length: 136 Return: -466.39717963383977
INFO:tensorflow:Average training steps per second: 223.02
I0902 17:45:30.336783 140451420674048 replay_runner.py:36] Average training steps per second: 223.02
I0902 17:45:30.562152 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.94
INFO:tensorflow:Starting iteration 27

Steps executed: 261 Episode length: 95 Return: -510.473378470306847
INFO:tensorflow:Average training steps per second: 221.91
I0902 17:45:39.354261 140451420674048 replay_runner.py:36] Average training steps per second: 221.91
I0902 17:45:39.577413 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.58
INFO:tensorflow:Starting iteration 28

Steps executed: 263 Episode length: 263 Return: -409.98970088790367
INFO:tensorflow:Average training steps per second: 221.96
I0902 17:45:48.451973 140451420674048 replay_runner.py:36] Average training steps per second: 221.96
I0902 17:45:48.742961 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.99
INFO:tensorflow:Starting iteration 29

Steps executed: 177 Episode length: 177 Return: -192.12590115413147
INFO:tensorflow:Average training steps per second: 223.72

Steps executed: 520 Episode length: 343 Return: -133.60903530470625

Done fixed training!Episode length: 343 Return: -133.60903530470625