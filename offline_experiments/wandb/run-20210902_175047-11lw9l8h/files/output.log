Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 17:50:53.595698 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 17:50:53.606192 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:53.606461 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:53.606601 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:53.607115 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:53.607254 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:53.607396 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:50:53.607538 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:53.607639 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:53.607712 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:53.607801 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:53.607977 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:53.608181 140016423897088 dqn_agent.py:283] 	 seed: 1630605053606122
I0902 17:50:53.610334 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:53.610514 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:50:53.610640 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:53.610725 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:53.610851 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:53.610997 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:53.611136 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:53.611280 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:53.611389 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:53.644786 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:50:54.072437 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:50:54.106297 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:50:54.117390 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:50:54.117661 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:50:54.117828 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:50:54.117942 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:50:54.118077 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 17:50:54.118281 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 17:50:54.118388 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:50:54.118495 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:50:54.118584 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:50:54.118710 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 17:50:54.118857 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:50:54.118977 140016423897088 dqn_agent.py:283] 	 seed: 1630605054117331
I0902 17:50:54.121950 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:50:54.122155 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 17:50:54.122341 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:50:54.122479 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:50:54.122618 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:50:54.122840 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:50:54.123022 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:50:54.123155 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:50:54.123331 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:50:54.157492 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=2.000000
I0902 17:50:54.180237 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:50:54.180547 140016423897088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 168.17
I0902 17:51:00.127199 140016423897088 replay_runner.py:36] Average training steps per second: 168.17
Steps executed: 213 Episode length: 67 Return: -425.4165616542463
I0902 17:51:01.304469 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.21
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 95 Return: -174.88724288674914
INFO:tensorflow:Average training steps per second: 228.02
I0902 17:51:10.063092 140016423897088 replay_runner.py:36] Average training steps per second: 228.02
I0902 17:51:10.221281 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.17
INFO:tensorflow:Starting iteration 2

Steps executed: 154 Episode length: 58 Return: -3.0562510767799154
INFO:tensorflow:Average training steps per second: 225.27
I0902 17:51:19.040387 140016423897088 replay_runner.py:36] Average training steps per second: 225.27

Steps executed: 233 Episode length: 79 Return: -109.71219824749087
INFO:tensorflow:Starting iteration 3
I0902 17:51:23.516808 140016423897088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 230.50
I0902 17:51:27.855691 140016423897088 replay_runner.py:36] Average training steps per second: 230.50

Steps executed: 246 Episode length: 78 Return: -380.49692576999877
INFO:tensorflow:Starting iteration 4

Steps executed: 202 Episode length: 98 Return: -635.81445169036927
INFO:tensorflow:Average training steps per second: 227.93
I0902 17:51:36.626388 140016423897088 replay_runner.py:36] Average training steps per second: 227.93
I0902 17:51:36.795319 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.25
INFO:tensorflow:Starting iteration 5
I0902 17:51:40.863266 140016423897088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 226.38

Steps executed: 214 Episode length: 60 Return: -169.09277291348877
I0902 17:51:45.446410 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.82
INFO:tensorflow:Starting iteration 6

Steps executed: 266 Episode length: 155 Return: -1059.9172745822852
INFO:tensorflow:Average training steps per second: 232.39
I0902 17:51:54.034165 140016423897088 replay_runner.py:36] Average training steps per second: 232.39
I0902 17:51:54.287013 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -801.19
INFO:tensorflow:Starting iteration 7

Steps executed: 255 Episode length: 96 Return: -663.351225012893872
INFO:tensorflow:Average training steps per second: 223.90
I0902 17:52:02.962823 140016423897088 replay_runner.py:36] Average training steps per second: 223.90
I0902 17:52:03.203113 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -822.02
INFO:tensorflow:Starting iteration 8

Steps executed: 211 Episode length: 119 Return: -742.32938461694642
INFO:tensorflow:Average training steps per second: 224.76
I0902 17:52:11.890980 140016423897088 replay_runner.py:36] Average training steps per second: 224.76
I0902 17:52:12.073612 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -429.61
INFO:tensorflow:Starting iteration 9

Steps executed: 206 Episode length: 118 Return: -676.37465023769542
INFO:tensorflow:Average training steps per second: 226.36
I0902 17:52:20.900778 140016423897088 replay_runner.py:36] Average training steps per second: 226.36
I0902 17:52:21.078595 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.68
INFO:tensorflow:Starting iteration 10

Steps executed: 259 Episode length: 159 Return: -1136.6832007202909
INFO:tensorflow:Average training steps per second: 226.63
I0902 17:52:29.671684 140016423897088 replay_runner.py:36] Average training steps per second: 226.63
I0902 17:52:29.936061 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -914.07
INFO:tensorflow:Starting iteration 11

Steps executed: 360 Episode length: 167 Return: -111.96961041175329
INFO:tensorflow:Average training steps per second: 228.08
I0902 17:52:38.695194 140016423897088 replay_runner.py:36] Average training steps per second: 228.08
I0902 17:52:39.049580 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.59
INFO:tensorflow:Starting iteration 12
I0902 17:52:43.393638 140016423897088 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 230.89

Steps executed: 298 Episode length: 181 Return: -918.08959565233739
I0902 17:52:48.041187 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -790.48
INFO:tensorflow:Starting iteration 13

Steps executed: 321 Episode length: 141 Return: -882.98768336777889
INFO:tensorflow:Average training steps per second: 233.46
I0902 17:52:56.684688 140016423897088 replay_runner.py:36] Average training steps per second: 233.46
I0902 17:52:56.972248 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -584.44
INFO:tensorflow:Starting iteration 14
I0902 17:53:01.204552 140016423897088 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 234.84
I0902 17:53:05.463253 140016423897088 replay_runner.py:36] Average training steps per second: 234.84

Steps executed: 297 Episode length: 297 Return: -616.32578246258049
INFO:tensorflow:Starting iteration 15

Steps executed: 308 Episode length: 130 Return: -796.12537072684279
INFO:tensorflow:Average training steps per second: 244.72
I0902 17:53:13.968900 140016423897088 replay_runner.py:36] Average training steps per second: 244.72
I0902 17:53:14.274633 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -701.56
INFO:tensorflow:Starting iteration 16

Steps executed: 228 Episode length: 108 Return: -669.31349433503259
INFO:tensorflow:Average training steps per second: 237.96
I0902 17:53:22.733769 140016423897088 replay_runner.py:36] Average training steps per second: 237.96
I0902 17:53:22.945263 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -668.35
INFO:tensorflow:Starting iteration 17

Steps executed: 204 Episode length: 204 Return: -626.40982444479969
INFO:tensorflow:Average training steps per second: 229.05
I0902 17:53:31.599622 140016423897088 replay_runner.py:36] Average training steps per second: 229.05
I0902 17:53:31.806771 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -626.41
INFO:tensorflow:Starting iteration 18

Steps executed: 418 Episode length: 285 Return: -642.56635975390969
INFO:tensorflow:Average training steps per second: 237.92
I0902 17:53:40.316350 140016423897088 replay_runner.py:36] Average training steps per second: 237.92
I0902 17:53:40.770055 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -670.15
INFO:tensorflow:Starting iteration 19

Steps executed: 447 Episode length: 305 Return: -544.81943679513239
INFO:tensorflow:Average training steps per second: 238.73
I0902 17:53:49.235121 140016423897088 replay_runner.py:36] Average training steps per second: 238.73
I0902 17:53:49.762191 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -632.76
INFO:tensorflow:Starting iteration 20

Steps executed: 446 Episode length: 326 Return: -496.40316891181499
INFO:tensorflow:Average training steps per second: 235.07
I0902 17:53:58.366843 140016423897088 replay_runner.py:36] Average training steps per second: 235.07
I0902 17:53:58.959118 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -590.89
INFO:tensorflow:Starting iteration 21

Steps executed: 283 Episode length: 283 Return: -626.35706049490399
INFO:tensorflow:Average training steps per second: 225.59
I0902 17:54:07.669965 140016423897088 replay_runner.py:36] Average training steps per second: 225.59
I0902 17:54:08.013249 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -626.36
INFO:tensorflow:Starting iteration 22

Steps executed: 258 Episode length: 258 Return: -337.21828175980739
INFO:tensorflow:Average training steps per second: 225.02
I0902 17:54:16.846206 140016423897088 replay_runner.py:36] Average training steps per second: 225.02
I0902 17:54:17.175164 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.22
INFO:tensorflow:Starting iteration 23

Steps executed: 352 Episode length: 158 Return: -448.72250360214605
INFO:tensorflow:Average training steps per second: 226.65
I0902 17:54:25.994351 140016423897088 replay_runner.py:36] Average training steps per second: 226.65
I0902 17:54:26.358979 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -618.91
INFO:tensorflow:Starting iteration 24

Steps executed: 174 Episode length: 174 Return: -616.04636006349285
INFO:tensorflow:Average training steps per second: 221.87

Steps executed: 503 Episode length: 329 Return: -555.36249620400285
I0902 17:54:35.873944 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -585.70
INFO:tensorflow:Starting iteration 25

Steps executed: 390 Episode length: 213 Return: -604.62576959932775
INFO:tensorflow:Average training steps per second: 221.39
I0902 17:54:44.787350 140016423897088 replay_runner.py:36] Average training steps per second: 221.39
I0902 17:54:45.152796 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -604.85
INFO:tensorflow:Starting iteration 26
I0902 17:54:49.446610 140016423897088 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 225.80

Steps executed: 365 Episode length: 192 Return: -467.30233740421534
I0902 17:54:54.250871 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.03
INFO:tensorflow:Starting iteration 27

Steps executed: 417 Episode length: 234 Return: -818.19910933815714
INFO:tensorflow:Average training steps per second: 225.51
I0902 17:55:02.774310 140016423897088 replay_runner.py:36] Average training steps per second: 225.51
I0902 17:55:03.159017 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -709.60
INFO:tensorflow:Starting iteration 28
I0902 17:55:07.575188 140016423897088 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 229.42

Steps executed: 432 Episode length: 265 Return: -641.95246172286344
I0902 17:55:12.404138 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -561.25
INFO:tensorflow:Starting iteration 29

Steps executed: 225 Episode length: 126 Return: -244.69252726738424
INFO:tensorflow:Average training steps per second: 226.02
I0902 17:55:21.149239 140016423897088 replay_runner.py:36] Average training steps per second: 226.02

Done fixed training!Episode length: 126 Return: -244.69252726738424