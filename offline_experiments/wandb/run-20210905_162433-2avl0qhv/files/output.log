I0905 16:24:38.948108 139789596633088 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:38.957376 139789596633088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:38.957566 139789596633088 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:38.957689 139789596633088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:38.957798 139789596633088 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:38.957903 139789596633088 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:38.958008 139789596633088 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:38.958113 139789596633088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:38.958248 139789596633088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:38.958389 139789596633088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:38.958504 139789596633088 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:38.958606 139789596633088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:38.958705 139789596633088 dqn_agent.py:283] 	 seed: 1630859078957334
I0905 16:24:38.961212 139789596633088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:38.961365 139789596633088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:38.961508 139789596633088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:38.961614 139789596633088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:38.961712 139789596633088 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:38.961806 139789596633088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:38.961918 139789596633088 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:38.962032 139789596633088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:38.962160 139789596633088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.414085 139789596633088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0905 16:24:40.720883 139789596633088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.728973 139789596633088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:40.733991 139789596633088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:40.734112 139789596633088 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:40.734192 139789596633088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:40.734256 139789596633088 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:40.734310 139789596633088 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:40.734381 139789596633088 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:40.734444 139789596633088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:40.734522 139789596633088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:40.734586 139789596633088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:40.734663 139789596633088 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:40.734716 139789596633088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:40.734793 139789596633088 dqn_agent.py:283] 	 seed: 1630859080733962
I0905 16:24:40.736168 139789596633088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:40.736277 139789596633088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:40.736361 139789596633088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:40.736426 139789596633088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:40.736483 139789596633088 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:40.736555 139789596633088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:40.736617 139789596633088 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:40.736695 139789596633088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:40.736756 139789596633088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.753842 139789596633088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.767596 139789596633088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:40.767727 139789596633088 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 295.59
I0905 16:24:44.150933 139789596633088 replay_runner.py:36] Average training steps per second: 295.59
Steps executed: 222 Episode length: 111 Return: -139.33538896941639
I0905 16:24:44.790068 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -170.98
INFO:tensorflow:Starting iteration 1

Steps executed: 321 Episode length: 143 Return: -289.95247186147463
INFO:tensorflow:Average training steps per second: 419.06
I0905 16:24:50.342069 139789596633088 replay_runner.py:36] Average training steps per second: 419.06
I0905 16:24:50.494329 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.14
INFO:tensorflow:Starting iteration 2

Steps executed: 233 Episode length: 103 Return: -288.43985511157257
INFO:tensorflow:Average training steps per second: 398.19
I0905 16:24:56.064043 139789596633088 replay_runner.py:36] Average training steps per second: 398.19
I0905 16:24:56.155628 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.49
INFO:tensorflow:Starting iteration 3

Steps executed: 274 Episode length: 161 Return: -30.638288901937777
INFO:tensorflow:Average training steps per second: 346.74
I0905 16:25:02.158779 139789596633088 replay_runner.py:36] Average training steps per second: 346.74
I0905 16:25:02.346396 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.52
INFO:tensorflow:Starting iteration 4

Steps executed: 276 Episode length: 101 Return: -176.76258636253715
INFO:tensorflow:Average training steps per second: 357.98
I0905 16:25:08.553426 139789596633088 replay_runner.py:36] Average training steps per second: 357.98
I0905 16:25:08.691592 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.56
INFO:tensorflow:Starting iteration 5

Steps executed: 260 Episode length: 158 Return: -109.49434779407373
INFO:tensorflow:Average training steps per second: 386.25
I0905 16:25:14.463790 139789596633088 replay_runner.py:36] Average training steps per second: 386.25
I0905 16:25:14.589292 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.29
INFO:tensorflow:Starting iteration 6

Steps executed: 222 Episode length: 114 Return: 23.2754078321388143
INFO:tensorflow:Average training steps per second: 398.52
I0905 16:25:20.231818 139789596633088 replay_runner.py:36] Average training steps per second: 398.52
I0905 16:25:20.339906 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -32.73
INFO:tensorflow:Starting iteration 7

Steps executed: 324 Episode length: 324 Return: -63.703186664476135
INFO:tensorflow:Average training steps per second: 409.76
I0905 16:25:25.900696 139789596633088 replay_runner.py:36] Average training steps per second: 409.76
I0905 16:25:26.174279 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.70
INFO:tensorflow:Starting iteration 8

Steps executed: 227 Episode length: 135 Return: -105.40840117993957
INFO:tensorflow:Average training steps per second: 392.26
I0905 16:25:31.886777 139789596633088 replay_runner.py:36] Average training steps per second: 392.26
I0905 16:25:32.002579 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.73
INFO:tensorflow:Starting iteration 9

Steps executed: 718 Episode length: 718 Return: -247.83363577390102
INFO:tensorflow:Average training steps per second: 396.85
I0905 16:25:37.620175 139789596633088 replay_runner.py:36] Average training steps per second: 396.85
I0905 16:25:38.653887 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.83
INFO:tensorflow:Starting iteration 10

Steps executed: 403 Episode length: 403 Return: -239.17489252225972
INFO:tensorflow:Average training steps per second: 392.50
I0905 16:25:44.342266 139789596633088 replay_runner.py:36] Average training steps per second: 392.50
I0905 16:25:44.654703 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.17
INFO:tensorflow:Starting iteration 11
I0905 16:25:47.763327 139789596633088 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 404.10
I0905 16:25:50.238200 139789596633088 replay_runner.py:36] Average training steps per second: 404.10

Steps executed: 1000 Episode length: 1000 Return: -175.21379525137235
INFO:tensorflow:Starting iteration 12

Steps executed: 105 Episode length: 105 Return: -313.7755312769799235
INFO:tensorflow:Average training steps per second: 396.11

Steps executed: 780 Episode length: 675 Return: -3492.043550906613235
I0905 16:25:59.805264 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -1902.91
INFO:tensorflow:Starting iteration 13

Steps executed: 407 Episode length: 331 Return: -269.8030482042017235
INFO:tensorflow:Average training steps per second: 404.88
I0905 16:26:05.393901 139789596633088 replay_runner.py:36] Average training steps per second: 404.88
I0905 16:26:05.650788 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.02
INFO:tensorflow:Starting iteration 14
I0905 16:26:08.817843 139789596633088 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 396.13
I0905 16:26:11.342545 139789596633088 replay_runner.py:36] Average training steps per second: 396.13

Steps executed: 1000 Episode length: 1000 Return: -85.162353621205385
INFO:tensorflow:Starting iteration 15

Steps executed: 345 Episode length: 345 Return: -154.7814716477628385
INFO:tensorflow:Average training steps per second: 400.38
I0905 16:26:18.652675 139789596633088 replay_runner.py:36] Average training steps per second: 400.38
I0905 16:26:18.932958 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.78
INFO:tensorflow:Starting iteration 16

Steps executed: 84 Episode length: 84 Return: -221.187076005280428385
INFO:tensorflow:Average training steps per second: 403.36
I0905 16:26:24.582592 139789596633088 replay_runner.py:36] Average training steps per second: 403.36

Steps executed: 339 Episode length: 255 Return: -91.92650157330755385
INFO:tensorflow:Starting iteration 17
I0905 16:26:27.885449 139789596633088 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 404.74
I0905 16:26:30.356606 139789596633088 replay_runner.py:36] Average training steps per second: 404.74

Steps executed: 435 Episode length: 435 Return: -174.0648569302932785
INFO:tensorflow:Starting iteration 18

Steps executed: 206 Episode length: 74 Return: -397.63248293521485785
INFO:tensorflow:Average training steps per second: 399.72
I0905 16:26:36.416929 139789596633088 replay_runner.py:36] Average training steps per second: 399.72
I0905 16:26:36.502673 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.13
INFO:tensorflow:Starting iteration 19

Steps executed: 227 Episode length: 53 Return: -179.76378935516365785
INFO:tensorflow:Average training steps per second: 387.50
I0905 16:26:42.198660 139789596633088 replay_runner.py:36] Average training steps per second: 387.50
I0905 16:26:42.300617 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.62
INFO:tensorflow:Starting iteration 20

Steps executed: 208 Episode length: 126 Return: -32.70060101382282785
INFO:tensorflow:Average training steps per second: 342.23
I0905 16:26:48.408836 139789596633088 replay_runner.py:36] Average training steps per second: 342.23
I0905 16:26:48.561801 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.08
INFO:tensorflow:Starting iteration 21

Steps executed: 74 Episode length: 74 Return: -106.509847805029182785
INFO:tensorflow:Average training steps per second: 354.88
I0905 16:26:54.795732 139789596633088 replay_runner.py:36] Average training steps per second: 354.88

Steps executed: 236 Episode length: 73 Return: -61.657100810304845785
INFO:tensorflow:Starting iteration 22
I0905 16:26:58.575858 139789596633088 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 335.67

Steps executed: 1000 Episode length: 1000 Return: -133.21817334078625
I0905 16:27:03.619741 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.22
INFO:tensorflow:Starting iteration 23

Steps executed: 59 Episode length: 59 Return: -89.5430461877666978625
INFO:tensorflow:Average training steps per second: 306.49

Steps executed: 1059 Episode length: 1000 Return: -59.604014476588435
I0905 16:27:12.802181 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.57
INFO:tensorflow:Starting iteration 24

Steps executed: 270 Episode length: 105 Return: -401.9713768013435435
INFO:tensorflow:Average training steps per second: 307.63
I0905 16:27:19.736421 139789596633088 replay_runner.py:36] Average training steps per second: 307.63
I0905 16:27:19.896107 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.81
INFO:tensorflow:Starting iteration 25

Steps executed: 297 Episode length: 186 Return: -182.2271420118093535
INFO:tensorflow:Average training steps per second: 303.32
I0905 16:27:26.843796 139789596633088 replay_runner.py:36] Average training steps per second: 303.32
I0905 16:27:27.047524 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.14
INFO:tensorflow:Starting iteration 26

Steps executed: 359 Episode length: 359 Return: -299.9404680846434435
INFO:tensorflow:Average training steps per second: 309.56
I0905 16:27:33.966740 139789596633088 replay_runner.py:36] Average training steps per second: 309.56
I0905 16:27:34.406226 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.94
INFO:tensorflow:Starting iteration 27

Steps executed: 290 Episode length: 290 Return: -79.30231230604886435
INFO:tensorflow:Average training steps per second: 301.55
I0905 16:27:41.416421 139789596633088 replay_runner.py:36] Average training steps per second: 301.55
I0905 16:27:41.661239 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.30
INFO:tensorflow:Starting iteration 28

Steps executed: 319 Episode length: 120 Return: -143.8712092282388335
INFO:tensorflow:Average training steps per second: 303.64
I0905 16:27:48.665052 139789596633088 replay_runner.py:36] Average training steps per second: 303.64
I0905 16:27:48.851613 139789596633088 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.10
INFO:tensorflow:Starting iteration 29
I0905 16:27:52.558328 139789596633088 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 309.53

Steps executed: 910 Episode length: 910 Return: -378.6897226755521335

Done fixed training!Episode length: 910 Return: -378.6897226755521335