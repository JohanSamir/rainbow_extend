Loaded trained dqn in cartpole
Training fixed agent 3, please be patient, may be a while...
I0901 12:46:25.691288 139796751951872 run_experiment.py:549] Creating TrainRunner ...
I0901 12:46:25.701591 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:46:25.701848 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:46:25.701953 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:46:25.702037 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:46:25.702315 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:46:25.702534 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:46:25.702663 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:46:25.702919 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:46:25.703129 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:46:25.703279 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:46:25.703416 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:46:25.703617 139796751951872 dqn_agent.py:283] 	 seed: 1630500385701513
I0901 12:46:25.706681 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:46:25.706817 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:46:25.706923 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:46:25.707003 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:46:25.707123 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:46:25.707211 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:46:25.707391 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:46:25.707471 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:46:25.707565 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:46:25.917057 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:26.469184 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:26.485028 139796751951872 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:46:26.494680 139796751951872 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:46:26.494926 139796751951872 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:46:26.495237 139796751951872 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:46:26.495352 139796751951872 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:46:26.495430 139796751951872 dqn_agent.py:275] 	 update_period: 4
I0901 12:46:26.495505 139796751951872 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:46:26.495628 139796751951872 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:46:26.495729 139796751951872 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:46:26.495863 139796751951872 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:46:26.496080 139796751951872 dqn_agent.py:280] 	 optimizer: adam
I0901 12:46:26.496169 139796751951872 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:46:26.496241 139796751951872 dqn_agent.py:283] 	 seed: 1630500386494632
I0901 12:46:26.498648 139796751951872 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:46:26.498801 139796751951872 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:46:26.498956 139796751951872 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:46:26.499061 139796751951872 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:46:26.499203 139796751951872 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:46:26.499350 139796751951872 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:46:26.499573 139796751951872 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:46:26.499658 139796751951872 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:46:26.499755 139796751951872 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:46:26.531253 139796751951872 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:26.553895 139796751951872 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:46:26.554169 139796751951872 replay_runner.py:41] Starting iteration 0
Steps executed: 206 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 143.67
I0901 12:46:33.515280 139796751951872 replay_runner.py:36] Average training steps per second: 143.67
I0901 12:46:34.726259 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 188.70
I0901 12:46:40.219395 139796751951872 replay_runner.py:36] Average training steps per second: 188.70
I0901 12:46:40.374909 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.20
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.75
I0901 12:46:45.787491 139796751951872 replay_runner.py:36] Average training steps per second: 191.75
I0901 12:46:45.915449 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 69 Episode length: 69 Return: 69.00.0
INFO:tensorflow:Average training steps per second: 190.92
I0901 12:46:51.343246 139796751951872 replay_runner.py:36] Average training steps per second: 190.92

Steps executed: 202 Episode length: 71 Return: 71.0.0
INFO:tensorflow:Starting iteration 4

Steps executed: 292 Episode length: 95 Return: 95.0.0
INFO:tensorflow:Average training steps per second: 196.52
I0901 12:46:56.841971 139796751951872 replay_runner.py:36] Average training steps per second: 196.52
I0901 12:46:57.052437 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 97.33
INFO:tensorflow:Starting iteration 5

Steps executed: 254 Episode length: 82 Return: 82.0.0
INFO:tensorflow:Average training steps per second: 192.89
I0901 12:47:02.430730 139796751951872 replay_runner.py:36] Average training steps per second: 192.89
I0901 12:47:02.615878 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.67
INFO:tensorflow:Starting iteration 6

Steps executed: 240 Episode length: 79 Return: 79.0.0
INFO:tensorflow:Average training steps per second: 189.33
I0901 12:47:08.085775 139796751951872 replay_runner.py:36] Average training steps per second: 189.33
I0901 12:47:08.254371 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 80.00
INFO:tensorflow:Starting iteration 7
I0901 12:47:08.440284 139796751951872 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 194.90

Steps executed: 280 Episode length: 150 Return: 150.0
I0901 12:47:13.761283 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.00
INFO:tensorflow:Starting iteration 8

Steps executed: 266 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 194.41
I0901 12:47:19.097486 139796751951872 replay_runner.py:36] Average training steps per second: 194.41
I0901 12:47:19.279595 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 9

Steps executed: 337 Episode length: 178 Return: 178.0
INFO:tensorflow:Average training steps per second: 197.36
I0901 12:47:24.541772 139796751951872 replay_runner.py:36] Average training steps per second: 197.36
I0901 12:47:24.760917 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.50
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.87
I0901 12:47:30.220422 139796751951872 replay_runner.py:36] Average training steps per second: 189.87
I0901 12:47:30.349514 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 297 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 198.23
I0901 12:47:35.584808 139796751951872 replay_runner.py:36] Average training steps per second: 198.23
I0901 12:47:35.780440 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.50
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.70
I0901 12:47:41.075339 139796751951872 replay_runner.py:36] Average training steps per second: 195.70
I0901 12:47:41.208550 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 263 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 191.29
I0901 12:47:46.617645 139796751951872 replay_runner.py:36] Average training steps per second: 191.29
I0901 12:47:46.790030 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.50
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.29
I0901 12:47:52.114537 139796751951872 replay_runner.py:36] Average training steps per second: 194.29
I0901 12:47:52.243175 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 370 Episode length: 186 Return: 186.0
INFO:tensorflow:Average training steps per second: 192.90
I0901 12:47:57.612783 139796751951872 replay_runner.py:36] Average training steps per second: 192.90
I0901 12:47:57.865152 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.00
INFO:tensorflow:Starting iteration 16

Steps executed: 328 Episode length: 161 Return: 161.0
INFO:tensorflow:Average training steps per second: 196.30
I0901 12:48:03.205219 139796751951872 replay_runner.py:36] Average training steps per second: 196.30
I0901 12:48:03.426448 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 17

Steps executed: 320 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 194.76
I0901 12:48:08.742371 139796751951872 replay_runner.py:36] Average training steps per second: 194.76
I0901 12:48:08.958796 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.36
I0901 12:48:14.242263 139796751951872 replay_runner.py:36] Average training steps per second: 196.36
I0901 12:48:14.379627 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:48:14.572121 139796751951872 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 190.29
I0901 12:48:19.827623 139796751951872 replay_runner.py:36] Average training steps per second: 190.29
I0901 12:48:19.977779 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 301 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 193.55
I0901 12:48:25.342974 139796751951872 replay_runner.py:36] Average training steps per second: 193.55
I0901 12:48:25.554222 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.81
I0901 12:48:30.935573 139796751951872 replay_runner.py:36] Average training steps per second: 192.81
I0901 12:48:31.068210 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 12:48:31.266964 139796751951872 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 193.64
I0901 12:48:36.431513 139796751951872 replay_runner.py:36] Average training steps per second: 193.64
I0901 12:48:36.569932 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 12:48:36.765335 139796751951872 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.48
I0901 12:48:41.881507 139796751951872 replay_runner.py:36] Average training steps per second: 195.48
I0901 12:48:42.013994 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 298 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 195.99
I0901 12:48:47.303117 139796751951872 replay_runner.py:36] Average training steps per second: 195.99
I0901 12:48:47.509874 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.57
I0901 12:48:52.711506 139796751951872 replay_runner.py:36] Average training steps per second: 199.57
I0901 12:48:52.842971 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 12:48:53.040735 139796751951872 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 193.18
I0901 12:48:58.217696 139796751951872 replay_runner.py:36] Average training steps per second: 193.18
I0901 12:48:58.353292 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 12:48:58.549203 139796751951872 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.53
I0901 12:49:03.716667 139796751951872 replay_runner.py:36] Average training steps per second: 193.53
I0901 12:49:03.851277 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 12:49:04.040835 139796751951872 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.06
I0901 12:49:09.194368 139796751951872 replay_runner.py:36] Average training steps per second: 194.06
I0901 12:49:09.323232 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 193.96
I0901 12:49:14.664534 139796751951872 replay_runner.py:36] Average training steps per second: 193.96
I0901 12:49:14.888032 139796751951872 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50