Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0901 12:30:27.349092 139683016574976 run_experiment.py:549] Creating TrainRunner ...
I0901 12:30:27.360592 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:27.360823 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:27.360947 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:27.361367 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:27.361671 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:27.361800 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:27.361879 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:27.361953 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:27.362043 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:27.362200 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:27.362523 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:27.362672 139683016574976 dqn_agent.py:283] 	 seed: 1630499427360520
I0901 12:30:27.365785 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:27.365961 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:27.366107 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:27.366238 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:27.366455 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:27.366571 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:27.366727 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:27.366913 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:27.367082 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:27.569675 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:27.982524 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:27.997203 139683016574976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:30:28.005828 139683016574976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:30:28.006133 139683016574976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:30:28.006473 139683016574976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:30:28.006634 139683016574976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:30:28.006751 139683016574976 dqn_agent.py:275] 	 update_period: 4
I0901 12:30:28.006868 139683016574976 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:30:28.006997 139683016574976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:30:28.007133 139683016574976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:30:28.007277 139683016574976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:30:28.007425 139683016574976 dqn_agent.py:280] 	 optimizer: adam
I0901 12:30:28.007681 139683016574976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:30:28.007799 139683016574976 dqn_agent.py:283] 	 seed: 1630499428005777
I0901 12:30:28.010939 139683016574976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:30:28.011170 139683016574976 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:30:28.011467 139683016574976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:30:28.011648 139683016574976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:30:28.011767 139683016574976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:30:28.011867 139683016574976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:30:28.012012 139683016574976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:30:28.012112 139683016574976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:30:28.012186 139683016574976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:30:28.048898 139683016574976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:30:28.072481 139683016574976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:30:28.072943 139683016574976 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 156.24
I0901 12:30:34.473695 139683016574976 replay_runner.py:36] Average training steps per second: 156.24
Steps executed: 200 Episode length: 113 Return: -45.5520697834549
I0901 12:30:35.780762 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.14
INFO:tensorflow:Starting iteration 1

Steps executed: 155 Episode length: 155 Return: -41.578092053575745
INFO:tensorflow:Average training steps per second: 220.07
I0901 12:30:44.729044 139683016574976 replay_runner.py:36] Average training steps per second: 220.07

Steps executed: 251 Episode length: 96 Return: -721.545570513006945
INFO:tensorflow:Starting iteration 2

Steps executed: 215 Episode length: 114 Return: -656.20606280334585
INFO:tensorflow:Average training steps per second: 226.95
I0901 12:30:53.709218 139683016574976 replay_runner.py:36] Average training steps per second: 226.95
I0901 12:30:53.902521 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.29
INFO:tensorflow:Starting iteration 3

Steps executed: 262 Episode length: 109 Return: -355.32232619677654
INFO:tensorflow:Average training steps per second: 226.16
I0901 12:31:02.677333 139683016574976 replay_runner.py:36] Average training steps per second: 226.16
I0901 12:31:02.919986 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.72
INFO:tensorflow:Starting iteration 4

Steps executed: 206 Episode length: 85 Return: -336.412385856638934
INFO:tensorflow:Average training steps per second: 222.86
I0901 12:31:11.661781 139683016574976 replay_runner.py:36] Average training steps per second: 222.86
I0901 12:31:11.842087 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.66
INFO:tensorflow:Starting iteration 5

Steps executed: 355 Episode length: 183 Return: -237.73605396835928
INFO:tensorflow:Average training steps per second: 220.61
I0901 12:31:20.745602 139683016574976 replay_runner.py:36] Average training steps per second: 220.61
I0901 12:31:21.118615 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.45
INFO:tensorflow:Starting iteration 6

Steps executed: 203 Episode length: 97 Return: -660.666342040825502
INFO:tensorflow:Average training steps per second: 231.23
I0901 12:31:29.745442 139683016574976 replay_runner.py:36] Average training steps per second: 231.23
I0901 12:31:29.916491 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.25
INFO:tensorflow:Starting iteration 7

Steps executed: 349 Episode length: 178 Return: -35.838055917520112
INFO:tensorflow:Average training steps per second: 230.28
I0901 12:31:38.465996 139683016574976 replay_runner.py:36] Average training steps per second: 230.28
I0901 12:31:38.754566 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.00
INFO:tensorflow:Starting iteration 8

Steps executed: 240 Episode length: 101 Return: -331.16346511852512
INFO:tensorflow:Average training steps per second: 222.69
I0901 12:31:47.537803 139683016574976 replay_runner.py:36] Average training steps per second: 222.69
I0901 12:31:47.749320 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.80
INFO:tensorflow:Starting iteration 9

Steps executed: 304 Episode length: 176 Return: -5.2175902379934062
INFO:tensorflow:Average training steps per second: 225.30
I0901 12:31:56.586727 139683016574976 replay_runner.py:36] Average training steps per second: 225.30
I0901 12:31:56.873457 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -149.40
INFO:tensorflow:Starting iteration 10

Steps executed: 268 Episode length: 91 Return: -240.231041312835942
INFO:tensorflow:Average training steps per second: 218.84
I0901 12:32:05.629673 139683016574976 replay_runner.py:36] Average training steps per second: 218.84
I0901 12:32:05.868182 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.93
INFO:tensorflow:Starting iteration 11

Steps executed: 219 Episode length: 144 Return: -65.911368375631472
INFO:tensorflow:Average training steps per second: 218.80
I0901 12:32:14.774053 139683016574976 replay_runner.py:36] Average training steps per second: 218.80
I0901 12:32:14.979981 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.76
INFO:tensorflow:Starting iteration 12

Steps executed: 245 Episode length: 72 Return: -163.336943232263372
INFO:tensorflow:Average training steps per second: 218.82
I0901 12:32:23.807932 139683016574976 replay_runner.py:36] Average training steps per second: 218.82
I0901 12:32:24.006621 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.55
INFO:tensorflow:Starting iteration 13

Steps executed: 231 Episode length: 102 Return: -40.331631150144716
INFO:tensorflow:Average training steps per second: 214.40
I0901 12:32:33.004329 139683016574976 replay_runner.py:36] Average training steps per second: 214.40
I0901 12:32:33.213294 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -28.07
INFO:tensorflow:Starting iteration 14

Steps executed: 237 Episode length: 237 Return: 236.859861808801716
INFO:tensorflow:Average training steps per second: 213.01
I0901 12:32:42.283989 139683016574976 replay_runner.py:36] Average training steps per second: 213.01
I0901 12:32:42.492047 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: 236.86
INFO:tensorflow:Starting iteration 15
I0901 12:32:46.787186 139683016574976 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 206.92

Steps executed: 225 Episode length: 68 Return: -299.251024456590186
I0901 12:32:51.819939 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.23
INFO:tensorflow:Starting iteration 16

Steps executed: 304 Episode length: 158 Return: -219.69587588326067
INFO:tensorflow:Average training steps per second: 216.76
I0901 12:33:00.632885 139683016574976 replay_runner.py:36] Average training steps per second: 216.76
I0901 12:33:00.924197 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.69
INFO:tensorflow:Starting iteration 17

Steps executed: 283 Episode length: 204 Return: -344.27431969463805
INFO:tensorflow:Average training steps per second: 212.70
I0901 12:33:09.843534 139683016574976 replay_runner.py:36] Average training steps per second: 212.70
I0901 12:33:10.115233 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.70
INFO:tensorflow:Starting iteration 18

Steps executed: 211 Episode length: 128 Return: -176.87703440837385
INFO:tensorflow:Average training steps per second: 212.57
I0901 12:33:19.094003 139683016574976 replay_runner.py:36] Average training steps per second: 212.57
I0901 12:33:19.276405 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.02
INFO:tensorflow:Starting iteration 19

Steps executed: 240 Episode length: 52 Return: -269.549750985518996
INFO:tensorflow:Average training steps per second: 216.74
I0901 12:33:28.216470 139683016574976 replay_runner.py:36] Average training steps per second: 216.74
I0901 12:33:28.413798 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.92
INFO:tensorflow:Starting iteration 20
I0901 12:33:32.742330 139683016574976 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 215.83

Steps executed: 260 Episode length: 86 Return: -235.915270858918236
I0901 12:33:37.580901 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.93
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 94 Return: -483.394842193816236
INFO:tensorflow:Average training steps per second: 226.33
I0901 12:33:46.241271 139683016574976 replay_runner.py:36] Average training steps per second: 226.33
I0901 12:33:46.477456 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.79
INFO:tensorflow:Starting iteration 22

Steps executed: 63 Episode length: 63 Return: -354.6444339490693236
INFO:tensorflow:Average training steps per second: 222.80

Steps executed: 228 Episode length: 102 Return: -295.45288859879916
I0901 12:33:55.556828 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.41
INFO:tensorflow:Starting iteration 23

Steps executed: 271 Episode length: 82 Return: -438.277284844235968
INFO:tensorflow:Average training steps per second: 225.89
I0901 12:34:04.262137 139683016574976 replay_runner.py:36] Average training steps per second: 225.89
I0901 12:34:04.469841 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.85
INFO:tensorflow:Starting iteration 24

Steps executed: 65 Episode length: 65 Return: -525.0775234173653968
INFO:tensorflow:Average training steps per second: 221.48
I0901 12:34:13.325505 139683016574976 replay_runner.py:36] Average training steps per second: 221.48

Steps executed: 220 Episode length: 155 Return: -606.05986076342798
INFO:tensorflow:Starting iteration 25

Steps executed: 315 Episode length: 141 Return: -166.59992011012915
INFO:tensorflow:Average training steps per second: 216.00
I0901 12:34:22.384667 139683016574976 replay_runner.py:36] Average training steps per second: 216.00
I0901 12:34:22.665508 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.54
INFO:tensorflow:Starting iteration 26

Steps executed: 120 Episode length: 120 Return: -207.73026299217577
INFO:tensorflow:Average training steps per second: 224.60
I0901 12:34:31.446799 139683016574976 replay_runner.py:36] Average training steps per second: 224.60

Steps executed: 261 Episode length: 141 Return: -243.17977330175787
INFO:tensorflow:Starting iteration 27

Steps executed: 278 Episode length: 100 Return: -411.41458403243854
INFO:tensorflow:Average training steps per second: 229.10
I0901 12:34:40.310131 139683016574976 replay_runner.py:36] Average training steps per second: 229.10
I0901 12:34:40.567530 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -448.39
INFO:tensorflow:Starting iteration 28

Steps executed: 274 Episode length: 83 Return: -147.746309748123174
INFO:tensorflow:Average training steps per second: 222.40
I0901 12:34:49.497866 139683016574976 replay_runner.py:36] Average training steps per second: 222.40
I0901 12:34:49.693555 139683016574976 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.16
INFO:tensorflow:Starting iteration 29

Steps executed: 229 Episode length: 69 Return: -466.404188425324954
INFO:tensorflow:Average training steps per second: 212.94
I0901 12:34:58.805323 139683016574976 replay_runner.py:36] Average training steps per second: 212.94

Done fixed training!Episode length: 69 Return: -466.404188425324954