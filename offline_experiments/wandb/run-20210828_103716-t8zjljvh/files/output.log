Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0828 10:37:23.021518 140441643927552 run_experiment.py:549] Creating TrainRunner ...
I0828 10:37:23.031658 140441643927552 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:23.031933 140441643927552 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:23.032099 140441643927552 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:23.032253 140441643927552 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:23.032383 140441643927552 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:23.032510 140441643927552 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:37:23.032632 140441643927552 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:23.032748 140441643927552 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:23.032872 140441643927552 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:23.032993 140441643927552 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:23.033110 140441643927552 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:23.033240 140441643927552 dqn_agent.py:283] 	 seed: 1630147043031594
I0828 10:37:23.036416 140441643927552 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:23.036635 140441643927552 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:37:23.036766 140441643927552 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:23.037008 140441643927552 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:23.037148 140441643927552 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:23.037278 140441643927552 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:23.037399 140441643927552 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:23.037543 140441643927552 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:23.037647 140441643927552 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:23.075980 140441643927552 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:23.486625 140441643927552 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:23.499519 140441643927552 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:37:23.531369 140441643927552 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:23.531624 140441643927552 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:23.531749 140441643927552 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:23.531855 140441643927552 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:23.531959 140441643927552 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:23.532073 140441643927552 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:37:23.532201 140441643927552 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:23.532336 140441643927552 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:23.532422 140441643927552 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:23.532478 140441643927552 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:23.532592 140441643927552 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:23.532662 140441643927552 dqn_agent.py:283] 	 seed: 1630147043531302
I0828 10:37:23.534965 140441643927552 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:23.535235 140441643927552 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:37:23.535559 140441643927552 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:23.535824 140441643927552 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:23.535926 140441643927552 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:23.536031 140441643927552 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:23.536193 140441643927552 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:23.536317 140441643927552 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:23.536431 140441643927552 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:23.569530 140441643927552 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:23.591511 140441643927552 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:37:23.592104 140441643927552 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.63
I0828 10:37:30.506354 140441643927552 replay_runner.py:36] Average training steps per second: 144.63
Steps executed: 470 Episode length: 470 Return: -469.0
I0828 10:37:32.178008 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -469.00
INFO:tensorflow:Starting iteration 1

Steps executed: 344 Episode length: 188 Return: -187.0
INFO:tensorflow:Average training steps per second: 200.66
I0828 10:37:37.398565 140441643927552 replay_runner.py:36] Average training steps per second: 200.66
I0828 10:37:37.707572 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.00
INFO:tensorflow:Starting iteration 2

Steps executed: 641 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.41
I0828 10:37:43.140808 140441643927552 replay_runner.py:36] Average training steps per second: 192.41
I0828 10:37:43.661617 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.00
INFO:tensorflow:Starting iteration 3
I0828 10:37:43.890100 140441643927552 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.89

Steps executed: 250 Episode length: 142 Return: -141.0
I0828 10:37:49.298863 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.00
INFO:tensorflow:Starting iteration 4

Steps executed: 223 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 194.16
I0828 10:37:54.689020 140441643927552 replay_runner.py:36] Average training steps per second: 194.16
I0828 10:37:54.880053 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50
INFO:tensorflow:Starting iteration 5

Steps executed: 253 Episode length: 66 Return: -65.0.0
INFO:tensorflow:Average training steps per second: 192.32
I0828 10:38:00.322624 140441643927552 replay_runner.py:36] Average training steps per second: 192.32
I0828 10:38:00.529361 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 6

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.56
I0828 10:38:05.891666 140441643927552 replay_runner.py:36] Average training steps per second: 195.56
I0828 10:38:06.323987 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 237 Episode length: 66 Return: -65.0.0
INFO:tensorflow:Average training steps per second: 196.08
I0828 10:38:11.663324 140441643927552 replay_runner.py:36] Average training steps per second: 196.08
I0828 10:38:11.858595 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 8

Steps executed: 287 Episode length: 92 Return: -91.000
INFO:tensorflow:Average training steps per second: 195.44
I0828 10:38:17.218560 140441643927552 replay_runner.py:36] Average training steps per second: 195.44
I0828 10:38:17.470993 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 9

Steps executed: 79 Episode length: 79 Return: -78.0000
INFO:tensorflow:Average training steps per second: 194.79

Steps executed: 236 Episode length: 77 Return: -76.000
I0828 10:38:23.050886 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 10

Steps executed: 205 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 194.56
I0828 10:38:28.430519 140441643927552 replay_runner.py:36] Average training steps per second: 194.56
I0828 10:38:28.605666 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 11

Steps executed: 584 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.34
I0828 10:38:33.943924 140441643927552 replay_runner.py:36] Average training steps per second: 196.34
I0828 10:38:34.459454 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.50
INFO:tensorflow:Starting iteration 12

Steps executed: 251 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 196.86
I0828 10:38:39.782520 140441643927552 replay_runner.py:36] Average training steps per second: 196.86
I0828 10:38:40.004882 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 13

Steps executed: 212 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 191.52
I0828 10:38:45.471786 140441643927552 replay_runner.py:36] Average training steps per second: 191.52
I0828 10:38:45.668420 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 14

Steps executed: 83 Episode length: 83 Return: -82.00.0
INFO:tensorflow:Average training steps per second: 194.20

Steps executed: 252 Episode length: 85 Return: -84.0.0
I0828 10:38:51.255310 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 15

Steps executed: 208 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 191.93
I0828 10:38:56.702843 140441643927552 replay_runner.py:36] Average training steps per second: 191.93
I0828 10:38:56.873636 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 16

Steps executed: 238 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 190.35
I0828 10:39:02.358002 140441643927552 replay_runner.py:36] Average training steps per second: 190.35
I0828 10:39:02.554482 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 17

Steps executed: 253 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 194.38
I0828 10:39:07.924421 140441643927552 replay_runner.py:36] Average training steps per second: 194.38
I0828 10:39:08.146315 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 18
I0828 10:39:08.377043 140441643927552 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 198.00

Steps executed: 227 Episode length: 87 Return: -86.0.0
I0828 10:39:13.615085 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.67
INFO:tensorflow:Starting iteration 19

Steps executed: 262 Episode length: 89 Return: -88.0.0
INFO:tensorflow:Average training steps per second: 193.95
I0828 10:39:19.004240 140441643927552 replay_runner.py:36] Average training steps per second: 193.95
I0828 10:39:19.230939 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 20

Steps executed: 273 Episode length: 273 Return: -272.0
INFO:tensorflow:Average training steps per second: 198.59
I0828 10:39:24.508529 140441643927552 replay_runner.py:36] Average training steps per second: 198.59
I0828 10:39:24.730476 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.00
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 118 Return: -117.0
INFO:tensorflow:Average training steps per second: 200.16
I0828 10:39:29.967926 140441643927552 replay_runner.py:36] Average training steps per second: 200.16
I0828 10:39:30.187709 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 22

Steps executed: 264 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 202.39
I0828 10:39:35.364529 140441643927552 replay_runner.py:36] Average training steps per second: 202.39
I0828 10:39:35.585613 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 23

Steps executed: 209 Episode length: 209 Return: -208.0
INFO:tensorflow:Average training steps per second: 196.87
I0828 10:39:40.901383 140441643927552 replay_runner.py:36] Average training steps per second: 196.87
I0828 10:39:41.082364 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.00
INFO:tensorflow:Starting iteration 24

Steps executed: 285 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 194.73
I0828 10:39:46.453998 140441643927552 replay_runner.py:36] Average training steps per second: 194.73
I0828 10:39:46.693168 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.00
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 195.93
I0828 10:39:52.030932 140441643927552 replay_runner.py:36] Average training steps per second: 195.93
I0828 10:39:52.226179 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.20
I0828 10:39:57.597407 140441643927552 replay_runner.py:36] Average training steps per second: 195.20
I0828 10:39:57.985685 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 128 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 200.04
I0828 10:40:03.215548 140441643927552 replay_runner.py:36] Average training steps per second: 200.04

Steps executed: 215 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Starting iteration 28

Steps executed: 227 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 201.83
I0828 10:40:08.598736 140441643927552 replay_runner.py:36] Average training steps per second: 201.83
I0828 10:40:08.881272 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 192.14
I0828 10:40:14.330635 140441643927552 replay_runner.py:36] Average training steps per second: 192.14
I0828 10:40:14.559759 140441643927552 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67