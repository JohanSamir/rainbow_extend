Loaded trained dqn in cartpole
Training fixed agent 9, please be patient, may be a while...
I0902 17:53:15.624802 140523524642816 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:15.635000 140523524642816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:15.635298 140523524642816 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:15.635416 140523524642816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:15.635499 140523524642816 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:15.635621 140523524642816 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:15.635776 140523524642816 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:15.635950 140523524642816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:15.636074 140523524642816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:15.636299 140523524642816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:15.636553 140523524642816 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:15.636679 140523524642816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:15.636890 140523524642816 dqn_agent.py:283] 	 seed: 1630605195634928
I0902 17:53:15.639307 140523524642816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:15.639448 140523524642816 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:15.639553 140523524642816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:15.639640 140523524642816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:15.639736 140523524642816 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:15.639824 140523524642816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:15.639893 140523524642816 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:15.639974 140523524642816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:15.640047 140523524642816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:15.677249 140523524642816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:16.175240 140523524642816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:16.188456 140523524642816 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:16.196829 140523524642816 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:16.197129 140523524642816 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:16.197348 140523524642816 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:16.197547 140523524642816 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:16.197644 140523524642816 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:16.197951 140523524642816 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:16.198120 140523524642816 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:16.198231 140523524642816 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:16.198355 140523524642816 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:16.198487 140523524642816 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:16.198628 140523524642816 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:16.198772 140523524642816 dqn_agent.py:283] 	 seed: 1630605196196773
I0902 17:53:16.201876 140523524642816 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:16.202085 140523524642816 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 17:53:16.202195 140523524642816 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:16.202293 140523524642816 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:16.202381 140523524642816 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:16.202468 140523524642816 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:16.202552 140523524642816 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:16.202637 140523524642816 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:16.202724 140523524642816 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:16.234061 140523524642816 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:16.254842 140523524642816 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:16.255106 140523524642816 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 143.59
I0902 17:53:23.220108 140523524642816 replay_runner.py:36] Average training steps per second: 143.59
Steps executed: 203 Episode length: 10 Return: 10.0
I0902 17:53:24.381127 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 198.72
I0902 17:53:29.598403 140523524642816 replay_runner.py:36] Average training steps per second: 198.72
I0902 17:53:29.792329 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 2

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 198.86
I0902 17:53:35.039046 140523524642816 replay_runner.py:36] Average training steps per second: 198.86
I0902 17:53:35.172565 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 3

Steps executed: 218 Episode length: 24 Return: 24.0
INFO:tensorflow:Average training steps per second: 209.96
I0902 17:53:40.119462 140523524642816 replay_runner.py:36] Average training steps per second: 209.96
I0902 17:53:40.276108 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 21.80
INFO:tensorflow:Starting iteration 4
I0902 17:53:40.492789 140523524642816 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 204.28

Steps executed: 200 Episode length: 10 Return: 10.0
I0902 17:53:45.518616 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 5

Steps executed: 206 Episode length: 11 Return: 11.0
INFO:tensorflow:Average training steps per second: 205.72
I0902 17:53:50.576387 140523524642816 replay_runner.py:36] Average training steps per second: 205.72
I0902 17:53:50.715577 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 200.32
I0902 17:53:55.891988 140523524642816 replay_runner.py:36] Average training steps per second: 200.32
I0902 17:53:56.026856 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 7

Steps executed: 205 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 200.43
I0902 17:54:01.203226 140523524642816 replay_runner.py:36] Average training steps per second: 200.43
I0902 17:54:01.350035 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 8

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.18
I0902 17:54:06.702493 140523524642816 replay_runner.py:36] Average training steps per second: 194.18
I0902 17:54:06.833617 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 9

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 196.53
I0902 17:54:12.112982 140523524642816 replay_runner.py:36] Average training steps per second: 196.53
I0902 17:54:12.256233 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 10

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.60
I0902 17:54:17.495475 140523524642816 replay_runner.py:36] Average training steps per second: 197.60
I0902 17:54:17.635613 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 196.91
I0902 17:54:22.900591 140523524642816 replay_runner.py:36] Average training steps per second: 196.91
I0902 17:54:23.042847 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 12

Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 197.91
I0902 17:54:28.291967 140523524642816 replay_runner.py:36] Average training steps per second: 197.91
I0902 17:54:28.442979 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 13
I0902 17:54:28.637390 140523524642816 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 195.95
I0902 17:54:33.741112 140523524642816 replay_runner.py:36] Average training steps per second: 195.95

Steps executed: 203 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Starting iteration 14

Steps executed: 258 Episode length: 71 Return: 71.0
INFO:tensorflow:Average training steps per second: 196.45
I0902 17:54:39.168354 140523524642816 replay_runner.py:36] Average training steps per second: 196.45
I0902 17:54:39.347201 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 64.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.19
I0902 17:54:44.669609 140523524642816 replay_runner.py:36] Average training steps per second: 195.19
I0902 17:54:44.807219 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 17:54:45.000857 140523524642816 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 192.74
I0902 17:54:50.189443 140523524642816 replay_runner.py:36] Average training steps per second: 192.74
I0902 17:54:50.325973 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 17:54:50.518636 140523524642816 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 197.21
I0902 17:54:55.590066 140523524642816 replay_runner.py:36] Average training steps per second: 197.21
I0902 17:54:55.727531 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 389 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.50
I0902 17:55:01.088667 140523524642816 replay_runner.py:36] Average training steps per second: 193.50
I0902 17:55:01.335710 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 19

Steps executed: 388 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 197.36
I0902 17:55:06.585960 140523524642816 replay_runner.py:36] Average training steps per second: 197.36
I0902 17:55:06.848782 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 20

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.90
I0902 17:55:12.068033 140523524642816 replay_runner.py:36] Average training steps per second: 198.90
I0902 17:55:12.333401 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 21

Steps executed: 370 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.50
I0902 17:55:17.565919 140523524642816 replay_runner.py:36] Average training steps per second: 198.50
I0902 17:55:17.810101 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.00
INFO:tensorflow:Starting iteration 22

Steps executed: 306 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 197.29
I0902 17:55:23.071928 140523524642816 replay_runner.py:36] Average training steps per second: 197.29
I0902 17:55:23.269834 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 23

Steps executed: 363 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 204.17
I0902 17:55:28.365959 140523524642816 replay_runner.py:36] Average training steps per second: 204.17
I0902 17:55:28.591176 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 181.50
INFO:tensorflow:Starting iteration 24

Steps executed: 155 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 197.14

Steps executed: 334 Episode length: 179 Return: 179.0
I0902 17:55:34.053597 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 25

Steps executed: 318 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 204.69
I0902 17:55:39.112725 140523524642816 replay_runner.py:36] Average training steps per second: 204.69
I0902 17:55:39.306837 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 26

Steps executed: 343 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 198.73
I0902 17:55:44.524580 140523524642816 replay_runner.py:36] Average training steps per second: 198.73
I0902 17:55:44.754855 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.50
INFO:tensorflow:Starting iteration 27
I0902 17:55:44.948182 140523524642816 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.73

Steps executed: 383 Episode length: 200 Return: 200.0
I0902 17:55:50.392471 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.53
I0902 17:55:55.595700 140523524642816 replay_runner.py:36] Average training steps per second: 199.53
I0902 17:55:55.728874 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.31
I0902 17:56:00.885289 140523524642816 replay_runner.py:36] Average training steps per second: 201.31
I0902 17:56:01.019134 140523524642816 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00