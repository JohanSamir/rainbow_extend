I0902 00:19:53.700865 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:19:53.710341 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:53.710480 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:53.710571 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:53.710634 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:53.710690 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:53.710770 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:53.710872 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:53.710960 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:53.711075 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:53.711153 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:53.711240 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:53.711324 140053067847680 dqn_agent.py:283] 	 seed: 1630541993710303
I0902 00:19:53.713442 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:53.713613 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:53.713733 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:53.713874 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:53.714016 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:53.714189 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:53.714277 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:53.714384 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:53.714497 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:53.741189 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:54.015232 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:54.024302 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:19:54.030754 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:19:54.030886 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:19:54.030960 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:19:54.031022 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:19:54.031078 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:19:54.031153 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:19:54.031248 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:19:54.031327 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:19:54.031388 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:19:54.031458 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:19:54.031535 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:19:54.031603 140053067847680 dqn_agent.py:283] 	 seed: 1630541994030724
I0902 00:19:54.033537 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:19:54.033658 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:19:54.033806 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:19:54.033882 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:19:54.033942 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:19:54.033998 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:19:54.034094 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:19:54.034199 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:19:54.034326 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:19:54.055895 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:19:54.073482 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:19:54.073729 140053067847680 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 244.20
I0902 00:19:58.168932 140053067847680 replay_runner.py:36] Average training steps per second: 244.20
I0902 00:19:59.011160 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.18
Steps executed: 251 Episode length: 125 Return: -428.8394539654739
INFO:tensorflow:Starting iteration 1
I0902 00:20:02.392682 140053067847680 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 338.26

Steps executed: 316 Episode length: 172 Return: -154.59828198136177
I0902 00:20:05.552395 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.45
INFO:tensorflow:Starting iteration 2

Steps executed: 408 Episode length: 252 Return: -90.763776349018667
INFO:tensorflow:Average training steps per second: 346.18
I0902 00:20:11.758738 140053067847680 replay_runner.py:36] Average training steps per second: 346.18
I0902 00:20:12.138372 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -170.36
INFO:tensorflow:Starting iteration 3

Steps executed: 286 Episode length: 286 Return: -47.637816497876467
INFO:tensorflow:Average training steps per second: 341.58
I0902 00:20:18.418474 140053067847680 replay_runner.py:36] Average training steps per second: 341.58
I0902 00:20:18.663268 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -47.64
INFO:tensorflow:Starting iteration 4
I0902 00:20:22.108922 140053067847680 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 340.71

Steps executed: 1000 Episode length: 1000 Return: -98.10043493516434
I0902 00:20:27.142460 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.10
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -136.40596070526516
INFO:tensorflow:Average training steps per second: 334.20
I0902 00:20:33.502911 140053067847680 replay_runner.py:36] Average training steps per second: 334.20
I0902 00:20:35.287630 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.41
INFO:tensorflow:Starting iteration 6

Steps executed: 430 Episode length: 430 Return: -249.8042015825938316
INFO:tensorflow:Average training steps per second: 323.33
I0902 00:20:41.662962 140053067847680 replay_runner.py:36] Average training steps per second: 323.33
I0902 00:20:42.063974 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.80
INFO:tensorflow:Starting iteration 7
I0902 00:20:45.281036 140053067847680 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 314.95

Steps executed: 1000 Episode length: 1000 Return: -209.45935236107653
I0902 00:20:50.108941 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -209.46
INFO:tensorflow:Starting iteration 8
I0902 00:20:53.372616 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 315.24

Steps executed: 1000 Episode length: 1000 Return: -250.02304252757793
I0902 00:20:58.021257 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.02
INFO:tensorflow:Starting iteration 9

Steps executed: 682 Episode length: 682 Return: -282.2539972399591793
INFO:tensorflow:Average training steps per second: 314.79
I0902 00:21:04.441785 140053067847680 replay_runner.py:36] Average training steps per second: 314.79
I0902 00:21:05.443302 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.25
INFO:tensorflow:Starting iteration 10

Steps executed: 1000 Episode length: 1000 Return: -153.08161795764155
INFO:tensorflow:Average training steps per second: 315.05
I0902 00:21:11.868982 140053067847680 replay_runner.py:36] Average training steps per second: 315.05
I0902 00:21:13.601488 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.08
INFO:tensorflow:Starting iteration 11
I0902 00:21:16.880872 140053067847680 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 320.18

Steps executed: 1000 Episode length: 1000 Return: -183.46458187714097
I0902 00:21:22.098536 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.46
INFO:tensorflow:Starting iteration 12

Steps executed: 649 Episode length: 649 Return: -131.2523235584739697
INFO:tensorflow:Average training steps per second: 326.69
I0902 00:21:28.517039 140053067847680 replay_runner.py:36] Average training steps per second: 326.69
I0902 00:21:29.449019 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.25
INFO:tensorflow:Starting iteration 13
I0902 00:21:32.801064 140053067847680 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 345.00

Steps executed: 1000 Episode length: 1000 Return: -144.78741438687267
I0902 00:21:37.230801 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.79
INFO:tensorflow:Starting iteration 14
I0902 00:21:40.668515 140053067847680 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 357.16

Steps executed: 690 Episode length: 690 Return: -132.7328728953708667
I0902 00:21:44.875757 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.73
INFO:tensorflow:Starting iteration 15

Steps executed: 259 Episode length: 72 Return: -291.59222604879368667
INFO:tensorflow:Average training steps per second: 343.71
I0902 00:21:51.227138 140053067847680 replay_runner.py:36] Average training steps per second: 343.71
I0902 00:21:51.367554 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.95
INFO:tensorflow:Starting iteration 16
I0902 00:21:54.760093 140053067847680 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 337.13
I0902 00:21:57.726592 140053067847680 replay_runner.py:36] Average training steps per second: 337.13

Steps executed: 207 Episode length: 59 Return: -135.97944380438287667
INFO:tensorflow:Starting iteration 17
I0902 00:22:01.250423 140053067847680 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 326.45
I0902 00:22:04.313932 140053067847680 replay_runner.py:36] Average training steps per second: 326.45

Steps executed: 1000 Episode length: 1000 Return: -74.861659178120267
INFO:tensorflow:Starting iteration 18

Steps executed: 238 Episode length: 172 Return: -6.405873476886342267
INFO:tensorflow:Average training steps per second: 346.43
I0902 00:22:12.413059 140053067847680 replay_runner.py:36] Average training steps per second: 346.43
I0902 00:22:12.571430 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.65
INFO:tensorflow:Starting iteration 19

Steps executed: 382 Episode length: 225 Return: -76.40372241546409267
INFO:tensorflow:Average training steps per second: 350.33
I0902 00:22:18.919682 140053067847680 replay_runner.py:36] Average training steps per second: 350.33
I0902 00:22:19.157721 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -37.40
INFO:tensorflow:Starting iteration 20
I0902 00:22:22.561569 140053067847680 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 330.28

Steps executed: 714 Episode length: 714 Return: -200.8523298574755867
I0902 00:22:26.595545 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.85
INFO:tensorflow:Starting iteration 21
I0902 00:22:29.987294 140053067847680 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 327.30

Steps executed: 1000 Episode length: 1000 Return: -20.815411027665287
I0902 00:22:35.129502 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -20.82
INFO:tensorflow:Starting iteration 22
I0902 00:22:38.469758 140053067847680 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 325.45
I0902 00:22:41.542761 140053067847680 replay_runner.py:36] Average training steps per second: 325.45

Steps executed: 460 Episode length: 460 Return: -45.87965139727002287
INFO:tensorflow:Starting iteration 23

Steps executed: 350 Episode length: 350 Return: -25.20345288516905787
INFO:tensorflow:Average training steps per second: 318.47
I0902 00:22:48.656942 140053067847680 replay_runner.py:36] Average training steps per second: 318.47
I0902 00:22:49.005912 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -25.20
INFO:tensorflow:Starting iteration 24
I0902 00:22:52.349763 140053067847680 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 353.86

Steps executed: 887 Episode length: 887 Return: -186.2977227521249787
I0902 00:22:56.758304 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.30
INFO:tensorflow:Starting iteration 25

Steps executed: 283 Episode length: 283 Return: -119.3236684411401387
INFO:tensorflow:Average training steps per second: 357.53
I0902 00:23:02.956234 140053067847680 replay_runner.py:36] Average training steps per second: 357.53
I0902 00:23:03.200560 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.32
INFO:tensorflow:Starting iteration 26
I0902 00:23:06.694846 140053067847680 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 370.20

Steps executed: 1000 Episode length: 1000 Return: -11.830977990208673
I0902 00:23:11.424050 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -11.83
INFO:tensorflow:Starting iteration 27
I0902 00:23:14.696582 140053067847680 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 341.40

Steps executed: 1000 Episode length: 1000 Return: -53.533485224383223
I0902 00:23:19.617113 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.53
INFO:tensorflow:Starting iteration 28
I0902 00:23:22.965340 140053067847680 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 341.86

Steps executed: 1000 Episode length: 1000 Return: -76.292164638956863
I0902 00:23:27.675951 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.29
INFO:tensorflow:Starting iteration 29

Steps executed: 211 Episode length: 211 Return: -87.64846968894385863
INFO:tensorflow:Average training steps per second: 342.79
I0902 00:23:33.956529 140053067847680 replay_runner.py:36] Average training steps per second: 342.79

Done fixed training!Episode length: 211 Return: -87.64846968894385863