Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 00:05:10.348879 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:05:10.360663 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:10.360974 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:10.361181 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:10.361334 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:10.361470 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:10.361565 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:10.361682 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:10.361803 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:10.361931 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:10.362061 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:10.362209 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:10.362325 139644712736768 dqn_agent.py:283] 	 seed: 1630541110360578
I0902 00:05:10.366291 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:10.366716 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:10.366877 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:10.367029 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:10.367261 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:10.367584 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:10.367780 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:10.367934 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:10.368116 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:10.411563 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:10.805451 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:10.821941 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:05:10.831706 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:10.832655 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:10.832900 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:10.833075 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:10.833214 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:10.833387 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:05:10.833719 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:10.833834 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:10.833936 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:10.839660 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:10.845068 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:10.845284 139644712736768 dqn_agent.py:283] 	 seed: 1630541110831645
I0902 00:05:10.867524 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:10.867805 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:05:10.867975 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:10.868124 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:10.868470 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:10.868656 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:10.868798 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:10.869019 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:10.869182 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:10.906026 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:10.931025 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:05:10.931428 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 161.11
I0902 00:05:17.138813 139644712736768 replay_runner.py:36] Average training steps per second: 161.11
Steps executed: 271 Episode length: 87 Return: -362.212606433467863
I0902 00:05:18.360589 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -413.90
INFO:tensorflow:Starting iteration 1

Steps executed: 253 Episode length: 154 Return: -279.59384357201623
INFO:tensorflow:Average training steps per second: 223.99
I0902 00:05:27.132625 139644712736768 replay_runner.py:36] Average training steps per second: 223.99
I0902 00:05:27.381598 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.72
INFO:tensorflow:Starting iteration 2
I0902 00:05:31.569902 139644712736768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 226.00

Steps executed: 287 Episode length: 287 Return: -231.54333085201145
I0902 00:05:36.349775 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.54
INFO:tensorflow:Starting iteration 3

Steps executed: 269 Episode length: 118 Return: -282.46022942024007
INFO:tensorflow:Average training steps per second: 228.65
I0902 00:05:45.032252 139644712736768 replay_runner.py:36] Average training steps per second: 228.65
I0902 00:05:45.283297 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.27
INFO:tensorflow:Starting iteration 4
I0902 00:05:49.522856 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 233.22

Steps executed: 467 Episode length: 467 Return: -316.57868308047216
I0902 00:05:54.519144 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.58
INFO:tensorflow:Starting iteration 5
I0902 00:05:58.849872 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 224.40

Steps executed: 893 Episode length: 893 Return: -410.18330666066623
I0902 00:06:05.514034 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.18
INFO:tensorflow:Starting iteration 6
I0902 00:06:09.799486 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 222.92

Steps executed: 1000 Episode length: 1000 Return: -241.59066585258304
I0902 00:06:16.535564 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.59
INFO:tensorflow:Starting iteration 7
I0902 00:06:20.907192 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 221.91

Steps executed: 1000 Episode length: 1000 Return: -208.37822502113124
I0902 00:06:28.117570 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.38
INFO:tensorflow:Starting iteration 8

Steps executed: 124 Episode length: 124 Return: 35.336731304424663124
INFO:tensorflow:Average training steps per second: 217.64

Steps executed: 1124 Episode length: 1000 Return: -179.27925344048188
I0902 00:06:40.675654 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.97
INFO:tensorflow:Starting iteration 9
I0902 00:06:44.979763 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 225.41

Steps executed: 945 Episode length: 945 Return: -360.9459072844291588
I0902 00:06:51.413650 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.95
INFO:tensorflow:Starting iteration 10
I0902 00:06:55.760138 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 220.24

Steps executed: 1000 Episode length: 1000 Return: -125.44897236013234
I0902 00:07:03.171034 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.45
INFO:tensorflow:Starting iteration 11
I0902 00:07:07.468168 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 222.96

Steps executed: 895 Episode length: 895 Return: -405.8559343343530434
I0902 00:07:14.930721 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.86
INFO:tensorflow:Starting iteration 12
I0902 00:07:19.073501 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 222.04

Steps executed: 1000 Episode length: 1000 Return: -230.92162242579734
I0902 00:07:27.471817 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.92
INFO:tensorflow:Starting iteration 13

Steps executed: 148 Episode length: 148 Return: -698.9257914160332734
INFO:tensorflow:Average training steps per second: 216.54

Steps executed: 1148 Episode length: 1000 Return: -229.61281423889734
I0902 00:07:40.219203 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.27
INFO:tensorflow:Starting iteration 14

Steps executed: 490 Episode length: 301 Return: -302.4337832874203534
INFO:tensorflow:Average training steps per second: 224.27
I0902 00:07:49.056861 139644712736768 replay_runner.py:36] Average training steps per second: 224.27
I0902 00:07:49.642249 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.52
INFO:tensorflow:Starting iteration 15

Steps executed: 126 Episode length: 126 Return: -715.0999464644901534
INFO:tensorflow:Average training steps per second: 220.49

Steps executed: 846 Episode length: 720 Return: -261.1689631167923534
I0902 00:08:00.362715 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.13
INFO:tensorflow:Starting iteration 16

Steps executed: 213 Episode length: 73 Return: -82.408654139608748534
INFO:tensorflow:Average training steps per second: 226.89
I0902 00:08:09.202711 139644712736768 replay_runner.py:36] Average training steps per second: 226.89
I0902 00:08:09.358363 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.86
INFO:tensorflow:Starting iteration 17

Steps executed: 118 Episode length: 118 Return: -425.6824306824924534
INFO:tensorflow:Average training steps per second: 227.00
I0902 00:08:18.082107 139644712736768 replay_runner.py:36] Average training steps per second: 227.00

Steps executed: 289 Episode length: 171 Return: -694.1766530192634534
INFO:tensorflow:Starting iteration 18

Steps executed: 278 Episode length: 157 Return: -220.6044784876456534
INFO:tensorflow:Average training steps per second: 222.79
I0902 00:08:27.212531 139644712736768 replay_runner.py:36] Average training steps per second: 222.79
I0902 00:08:27.513964 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.73
INFO:tensorflow:Starting iteration 19
I0902 00:08:31.921863 139644712736768 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 222.86
I0902 00:08:36.409449 139644712736768 replay_runner.py:36] Average training steps per second: 222.86

Steps executed: 285 Episode length: 123 Return: -886.1566354994419834
INFO:tensorflow:Starting iteration 20

Steps executed: 210 Episode length: 101 Return: -212.7885185518972834
INFO:tensorflow:Average training steps per second: 223.51
I0902 00:08:45.495034 139644712736768 replay_runner.py:36] Average training steps per second: 223.51
I0902 00:08:45.672151 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.71
INFO:tensorflow:Starting iteration 21

Steps executed: 241 Episode length: 114 Return: -746.6615581553492834
INFO:tensorflow:Average training steps per second: 230.93
I0902 00:08:54.260394 139644712736768 replay_runner.py:36] Average training steps per second: 230.93
I0902 00:08:54.475609 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -639.92
INFO:tensorflow:Starting iteration 22

Steps executed: 236 Episode length: 138 Return: -285.0684621063379634
INFO:tensorflow:Average training steps per second: 226.84
I0902 00:09:03.043554 139644712736768 replay_runner.py:36] Average training steps per second: 226.84
I0902 00:09:03.291797 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.39
INFO:tensorflow:Starting iteration 23

Steps executed: 295 Episode length: 100 Return: -58.77931546900468434
INFO:tensorflow:Average training steps per second: 230.18
I0902 00:09:11.889035 139644712736768 replay_runner.py:36] Average training steps per second: 230.18
I0902 00:09:12.166839 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.92
INFO:tensorflow:Starting iteration 24

Steps executed: 234 Episode length: 85 Return: -285.60474414381468434
INFO:tensorflow:Average training steps per second: 224.89
I0902 00:09:20.960893 139644712736768 replay_runner.py:36] Average training steps per second: 224.89
I0902 00:09:21.170682 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.21
INFO:tensorflow:Starting iteration 25

Steps executed: 235 Episode length: 61 Return: -131.70253743743336434
INFO:tensorflow:Average training steps per second: 221.13
I0902 00:09:30.021807 139644712736768 replay_runner.py:36] Average training steps per second: 221.13
I0902 00:09:30.231820 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.30
INFO:tensorflow:Starting iteration 26

Steps executed: 330 Episode length: 182 Return: -1003.648150168058634
INFO:tensorflow:Average training steps per second: 220.08
I0902 00:09:39.265199 139644712736768 replay_runner.py:36] Average training steps per second: 220.08
I0902 00:09:39.588856 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.39
INFO:tensorflow:Starting iteration 27

Steps executed: 290 Episode length: 145 Return: -64.74907339979842634
INFO:tensorflow:Average training steps per second: 227.91
I0902 00:09:48.221426 139644712736768 replay_runner.py:36] Average training steps per second: 227.91
I0902 00:09:48.462565 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.88
INFO:tensorflow:Starting iteration 28

Steps executed: 598 Episode length: 406 Return: -104.7427993268715634
INFO:tensorflow:Average training steps per second: 227.73
I0902 00:09:57.131459 139644712736768 replay_runner.py:36] Average training steps per second: 227.73
I0902 00:09:58.038763 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.16
INFO:tensorflow:Starting iteration 29

Steps executed: 213 Episode length: 113 Return: -156.3075853838713634
INFO:tensorflow:Average training steps per second: 223.34
I0902 00:10:06.676309 139644712736768 replay_runner.py:36] Average training steps per second: 223.34

Done fixed training!Episode length: 113 Return: -156.3075853838713634