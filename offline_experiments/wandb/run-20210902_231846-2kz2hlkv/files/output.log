I0902 23:18:53.272406 140260243740672 run_experiment.py:549] Creating TrainRunner ...
I0902 23:18:53.280931 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:18:53.281180 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:18:53.281328 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:18:53.281457 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:18:53.281552 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:18:53.281634 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:18:53.281706 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:18:53.281805 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:18:53.281902 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:18:53.282025 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:18:53.282149 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:18:53.282242 140260243740672 dqn_agent.py:283] 	 seed: 1630624733280863
I0902 23:18:53.285055 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:18:53.285264 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:18:53.285362 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:18:53.285440 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:18:53.285549 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:18:53.285651 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:18:53.285756 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:18:53.285831 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:18:53.285908 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0902 23:18:54.894209 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:55.440021 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:55.453038 140260243740672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:18:55.460010 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:18:55.460366 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:18:55.460580 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:18:55.460742 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:18:55.461127 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:18:55.461269 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:18:55.461450 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:18:55.461666 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:18:55.461843 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:18:55.461990 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:18:55.462121 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:18:55.462253 140260243740672 dqn_agent.py:283] 	 seed: 1630624735459951
I0902 23:18:55.464949 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:18:55.465065 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:18:55.465138 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:18:55.465201 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:18:55.465274 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:18:55.465374 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:18:55.465456 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:18:55.465600 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:18:55.465687 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:18:55.495514 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:18:55.515741 140260243740672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:18:55.516494 140260243740672 replay_runner.py:41] Starting iteration 0
Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 161.48
I0902 23:19:01.709815 140260243740672 replay_runner.py:36] Average training steps per second: 161.48
I0902 23:19:02.792599 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 1

Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 209.92
I0902 23:19:07.741356 140260243740672 replay_runner.py:36] Average training steps per second: 209.92
I0902 23:19:07.858030 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 11.33
INFO:tensorflow:Starting iteration 2
I0902 23:19:08.036866 140260243740672 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 207.42

Steps executed: 330 Episode length: 166 Return: 166.0
I0902 23:19:13.113236 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 213.04
I0902 23:19:17.993091 140260243740672 replay_runner.py:36] Average training steps per second: 213.04
I0902 23:19:18.108240 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 365 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 199.19
I0902 23:19:23.307631 140260243740672 replay_runner.py:36] Average training steps per second: 199.19
I0902 23:19:23.564664 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.50
INFO:tensorflow:Starting iteration 5

Steps executed: 185 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 196.55
I0902 23:19:28.842143 140260243740672 replay_runner.py:36] Average training steps per second: 196.55

Steps executed: 355 Episode length: 170 Return: 170.0
INFO:tensorflow:Starting iteration 6

Steps executed: 341 Episode length: 175 Return: 175.0
INFO:tensorflow:Average training steps per second: 190.32
I0902 23:19:34.540631 140260243740672 replay_runner.py:36] Average training steps per second: 190.32
I0902 23:19:34.767416 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 7

Steps executed: 360 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 195.31
I0902 23:19:40.077138 140260243740672 replay_runner.py:36] Average training steps per second: 195.31
I0902 23:19:40.324161 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 8

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.94
I0902 23:19:45.499308 140260243740672 replay_runner.py:36] Average training steps per second: 200.94
I0902 23:19:45.638295 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9

Steps executed: 323 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 194.93
I0902 23:19:50.948598 140260243740672 replay_runner.py:36] Average training steps per second: 194.93
I0902 23:19:51.137891 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 10

Steps executed: 345 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 196.16
I0902 23:19:56.422813 140260243740672 replay_runner.py:36] Average training steps per second: 196.16
I0902 23:19:56.667106 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 11

Steps executed: 340 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 197.92
I0902 23:20:01.904289 140260243740672 replay_runner.py:36] Average training steps per second: 197.92
I0902 23:20:02.127735 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 12
I0902 23:20:02.322695 140260243740672 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 197.05
I0902 23:20:07.397977 140260243740672 replay_runner.py:36] Average training steps per second: 197.05

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 13
I0902 23:20:07.723243 140260243740672 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 193.67
I0902 23:20:12.887125 140260243740672 replay_runner.py:36] Average training steps per second: 193.67
I0902 23:20:13.024478 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 329 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 193.38
I0902 23:20:18.386961 140260243740672 replay_runner.py:36] Average training steps per second: 193.38
I0902 23:20:18.610465 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 15

Steps executed: 255 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 191.54
I0902 23:20:24.025237 140260243740672 replay_runner.py:36] Average training steps per second: 191.54
I0902 23:20:24.215810 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 16

Steps executed: 308 Episode length: 155 Return: 155.0
INFO:tensorflow:Average training steps per second: 194.76
I0902 23:20:29.547195 140260243740672 replay_runner.py:36] Average training steps per second: 194.76
I0902 23:20:29.779036 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 17
I0902 23:20:29.961710 140260243740672 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.43

Steps executed: 370 Episode length: 199 Return: 199.0
I0902 23:20:35.493541 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 185.00
INFO:tensorflow:Starting iteration 18

Steps executed: 328 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 193.46
I0902 23:20:40.856646 140260243740672 replay_runner.py:36] Average training steps per second: 193.46
I0902 23:20:41.110162 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.67
I0902 23:20:46.498139 140260243740672 replay_runner.py:36] Average training steps per second: 195.67
I0902 23:20:46.635322 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 326 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 193.43
I0902 23:20:51.991997 140260243740672 replay_runner.py:36] Average training steps per second: 193.43
I0902 23:20:52.215685 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 21
I0902 23:20:52.408465 140260243740672 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 202.82
I0902 23:20:57.339150 140260243740672 replay_runner.py:36] Average training steps per second: 202.82

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 22
I0902 23:20:57.683918 140260243740672 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.65
I0902 23:21:02.902174 140260243740672 replay_runner.py:36] Average training steps per second: 191.65
I0902 23:21:03.042989 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 336 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 196.35
I0902 23:21:08.335407 140260243740672 replay_runner.py:36] Average training steps per second: 196.35
I0902 23:21:08.596460 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.39
I0902 23:21:13.858869 140260243740672 replay_runner.py:36] Average training steps per second: 197.39
I0902 23:21:13.993664 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:21:14.164089 140260243740672 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 189.65
I0902 23:21:19.437434 140260243740672 replay_runner.py:36] Average training steps per second: 189.65
I0902 23:21:19.578331 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:21:19.768007 140260243740672 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 191.91
I0902 23:21:24.979197 140260243740672 replay_runner.py:36] Average training steps per second: 191.91
I0902 23:21:25.121535 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:21:25.301214 140260243740672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 190.77
I0902 23:21:30.543468 140260243740672 replay_runner.py:36] Average training steps per second: 190.77
I0902 23:21:30.677216 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:21:30.853972 140260243740672 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.52
I0902 23:21:35.968904 140260243740672 replay_runner.py:36] Average training steps per second: 195.52
I0902 23:21:36.107244 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.90
I0902 23:21:41.332749 140260243740672 replay_runner.py:36] Average training steps per second: 198.90
I0902 23:21:41.484037 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00