I0828 10:24:37.061676 139845548115968 run_experiment.py:549] Creating TrainRunner ...
I0828 10:24:37.070244 139845548115968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:37.070428 139845548115968 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:37.070506 139845548115968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:37.070569 139845548115968 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:37.070673 139845548115968 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:37.070764 139845548115968 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:37.070856 139845548115968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:37.070949 139845548115968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:37.071020 139845548115968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:37.071097 139845548115968 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:37.071166 139845548115968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:37.071242 139845548115968 dqn_agent.py:283] 	 seed: 1630146277070197
I0828 10:24:37.073626 139845548115968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:37.073828 139845548115968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:24:37.073959 139845548115968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:37.074033 139845548115968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:37.074094 139845548115968 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:37.074170 139845548115968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:37.074234 139845548115968 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:37.074361 139845548115968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:37.074441 139845548115968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:37.108122 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:37.643469 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:37.657270 139845548115968 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:24:37.665784 139845548115968 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:24:37.665960 139845548115968 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:24:37.666045 139845548115968 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:24:37.666121 139845548115968 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:24:37.666182 139845548115968 dqn_agent.py:275] 	 update_period: 4
I0828 10:24:37.666285 139845548115968 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:24:37.666540 139845548115968 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:24:37.666651 139845548115968 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:24:37.666728 139845548115968 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:24:37.666802 139845548115968 dqn_agent.py:280] 	 optimizer: adam
I0828 10:24:37.666944 139845548115968 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:24:37.667025 139845548115968 dqn_agent.py:283] 	 seed: 1630146277665742
I0828 10:24:37.669249 139845548115968 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:24:37.669378 139845548115968 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0828 10:24:37.669451 139845548115968 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:24:37.669516 139845548115968 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:24:37.669619 139845548115968 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:24:37.669679 139845548115968 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:24:37.669770 139845548115968 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:24:37.669838 139845548115968 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:24:37.669894 139845548115968 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:24:37.701352 139845548115968 dqn_agent.py:70] Creating Adam optimizer with settings lr=2.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:24:37.721376 139845548115968 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:24:37.721706 139845548115968 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 164.32
I0828 10:24:43.808059 139845548115968 replay_runner.py:36] Average training steps per second: 164.32
I0828 10:24:44.882444 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 27.00
INFO:tensorflow:Starting iteration 1
I0828 10:24:45.096563 139845548115968 replay_runner.py:41] Starting iteration 1
Steps executed: 216 Episode length: 30 Return: 30.0
INFO:tensorflow:Average training steps per second: 187.39
I0828 10:24:50.433486 139845548115968 replay_runner.py:36] Average training steps per second: 187.39
I0828 10:24:50.568412 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 31.86
INFO:tensorflow:Starting iteration 2

Steps executed: 223 Episode length: 39 Return: 39.0
INFO:tensorflow:Average training steps per second: 198.56
I0828 10:24:55.784017 139845548115968 replay_runner.py:36] Average training steps per second: 198.56
I0828 10:24:55.929418 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 15.69
INFO:tensorflow:Starting iteration 3

Steps executed: 204 Episode length: 16 Return: 16.0
INFO:tensorflow:Average training steps per second: 193.52
I0828 10:25:01.289015 139845548115968 replay_runner.py:36] Average training steps per second: 193.52
I0828 10:25:01.431748 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 52.00
INFO:tensorflow:Starting iteration 4

Steps executed: 208 Episode length: 59 Return: 59.0
INFO:tensorflow:Average training steps per second: 190.97
I0828 10:25:06.850525 139845548115968 replay_runner.py:36] Average training steps per second: 190.97
I0828 10:25:06.993377 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 100.50
INFO:tensorflow:Starting iteration 5

Steps executed: 201 Episode length: 99 Return: 99.0.0
INFO:tensorflow:Average training steps per second: 199.01
I0828 10:25:12.212720 139845548115968 replay_runner.py:36] Average training steps per second: 199.01
I0828 10:25:12.348145 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 104.00
INFO:tensorflow:Starting iteration 6

Steps executed: 208 Episode length: 104 Return: 104.0
INFO:tensorflow:Average training steps per second: 190.26
I0828 10:25:17.793932 139845548115968 replay_runner.py:36] Average training steps per second: 190.26
I0828 10:25:17.996165 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.33
INFO:tensorflow:Starting iteration 7

Steps executed: 280 Episode length: 94 Return: 94.0.0
INFO:tensorflow:Average training steps per second: 191.35
I0828 10:25:23.412013 139845548115968 replay_runner.py:36] Average training steps per second: 191.35
I0828 10:25:23.563330 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.00
INFO:tensorflow:Starting iteration 8

Steps executed: 214 Episode length: 108 Return: 108.0
INFO:tensorflow:Average training steps per second: 192.56
I0828 10:25:28.958226 139845548115968 replay_runner.py:36] Average training steps per second: 192.56
I0828 10:25:29.137474 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 90.67
INFO:tensorflow:Starting iteration 9


Steps executed: 251 Episode length: 122 Return: 122.0
INFO:tensorflow:Average training steps per second: 186.95
I0828 10:25:34.668781 139845548115968 replay_runner.py:36] Average training steps per second: 186.95
I0828 10:25:34.831793 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 10

Steps executed: 206 Episode length: 20 Return: 20.0.0
INFO:tensorflow:Average training steps per second: 189.93
I0828 10:25:40.284536 139845548115968 replay_runner.py:36] Average training steps per second: 189.93
I0828 10:25:40.421487 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.60
INFO:tensorflow:Starting iteration 11

Steps executed: 210 Episode length: 67 Return: 67.0.0
INFO:tensorflow:Average training steps per second: 192.55
I0828 10:25:45.799902 139845548115968 replay_runner.py:36] Average training steps per second: 192.55
I0828 10:25:45.951533 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 70.00
INFO:tensorflow:Starting iteration 12
I0828 10:25:46.131414 139845548115968 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 195.94

Steps executed: 273 Episode length: 142 Return: 142.0
I0828 10:25:51.428896 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 13

Steps executed: 265 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 194.90
I0828 10:25:56.748533 139845548115968 replay_runner.py:36] Average training steps per second: 194.90
I0828 10:25:56.931318 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.50
INFO:tensorflow:Starting iteration 14

Steps executed: 319 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 194.60
I0828 10:26:02.273143 139845548115968 replay_runner.py:36] Average training steps per second: 194.60
I0828 10:26:02.485773 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.75
I0828 10:26:07.870725 139845548115968 replay_runner.py:36] Average training steps per second: 192.75
I0828 10:26:08.007852 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 333 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 194.01
I0828 10:26:13.352219 139845548115968 replay_runner.py:36] Average training steps per second: 194.01
I0828 10:26:13.582233 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 17
I0828 10:26:13.779250 139845548115968 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 193.52

Steps executed: 323 Episode length: 149 Return: 149.0
I0828 10:26:19.172258 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.91
I0828 10:26:24.475669 139845548115968 replay_runner.py:36] Average training steps per second: 195.91
I0828 10:26:24.613447 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0828 10:26:24.811659 139845548115968 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.58
I0828 10:26:29.978041 139845548115968 replay_runner.py:36] Average training steps per second: 193.58
I0828 10:26:30.116451 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 314 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 194.10
I0828 10:26:35.469729 139845548115968 replay_runner.py:36] Average training steps per second: 194.10
I0828 10:26:35.682517 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.00
INFO:tensorflow:Starting iteration 21
I0828 10:26:35.876195 139845548115968 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 191.69
I0828 10:26:41.093726 139845548115968 replay_runner.py:36] Average training steps per second: 191.69

Steps executed: 302 Episode length: 153 Return: 153.0
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.41
I0828 10:26:46.581607 139845548115968 replay_runner.py:36] Average training steps per second: 196.41
I0828 10:26:46.718981 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0828 10:26:46.915696 139845548115968 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 194.19
I0828 10:26:52.065710 139845548115968 replay_runner.py:36] Average training steps per second: 194.19
I0828 10:26:52.196007 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 245 Episode length: 123 Return: 123.0
INFO:tensorflow:Average training steps per second: 192.36
I0828 10:26:57.592108 139845548115968 replay_runner.py:36] Average training steps per second: 192.36
I0828 10:26:57.758052 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.02
I0828 10:27:02.940149 139845548115968 replay_runner.py:36] Average training steps per second: 200.02
I0828 10:27:03.077697 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 320 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 190.60
I0828 10:27:08.514373 139845548115968 replay_runner.py:36] Average training steps per second: 190.60
I0828 10:27:08.746286 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 160.00
INFO:tensorflow:Starting iteration 27

Steps executed: 243 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 197.93
I0828 10:27:13.981555 139845548115968 replay_runner.py:36] Average training steps per second: 197.93
I0828 10:27:14.153321 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 121.50
INFO:tensorflow:Starting iteration 28
I0828 10:27:14.344645 139845548115968 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 194.49
I0828 10:27:19.486949 139845548115968 replay_runner.py:36] Average training steps per second: 194.49

Steps executed: 290 Episode length: 147 Return: 147.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 204.13
I0828 10:27:24.739799 139845548115968 replay_runner.py:36] Average training steps per second: 204.13
I0828 10:27:24.943029 139845548115968 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00