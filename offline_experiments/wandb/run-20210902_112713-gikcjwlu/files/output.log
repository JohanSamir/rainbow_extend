Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0902 11:27:19.675638 140217612584960 run_experiment.py:549] Creating TrainRunner ...
I0902 11:27:19.684638 140217612584960 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:19.685017 140217612584960 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:19.685202 140217612584960 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:19.685346 140217612584960 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:19.685457 140217612584960 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:19.685528 140217612584960 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:19.685595 140217612584960 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:19.685659 140217612584960 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:19.685722 140217612584960 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:19.685784 140217612584960 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:19.685856 140217612584960 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:19.685919 140217612584960 dqn_agent.py:283] 	 seed: 1630582039684579
I0902 11:27:19.688458 140217612584960 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:19.688590 140217612584960 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:27:19.688689 140217612584960 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:19.688753 140217612584960 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:19.688810 140217612584960 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:19.688863 140217612584960 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:19.688919 140217612584960 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:19.688998 140217612584960 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:19.689057 140217612584960 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:19.899798 140217612584960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:20.303350 140217612584960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:20.318339 140217612584960 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:27:20.325465 140217612584960 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:27:20.325774 140217612584960 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:27:20.325958 140217612584960 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:27:20.326075 140217612584960 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:27:20.326202 140217612584960 dqn_agent.py:275] 	 update_period: 4
I0902 11:27:20.326313 140217612584960 dqn_agent.py:276] 	 target_update_period: 100
I0902 11:27:20.326497 140217612584960 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:27:20.326640 140217612584960 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:27:20.326747 140217612584960 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:27:20.326876 140217612584960 dqn_agent.py:280] 	 optimizer: adam
I0902 11:27:20.327041 140217612584960 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:27:20.327199 140217612584960 dqn_agent.py:283] 	 seed: 1630582040325386
I0902 11:27:20.330201 140217612584960 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:27:20.330478 140217612584960 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 11:27:20.330663 140217612584960 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:27:20.330818 140217612584960 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:27:20.330925 140217612584960 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:27:20.331063 140217612584960 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:27:20.331195 140217612584960 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:27:20.331271 140217612584960 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:27:20.331379 140217612584960 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:27:20.377638 140217612584960 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:27:20.404043 140217612584960 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:27:20.404333 140217612584960 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 115.21
I0902 11:27:29.084776 140217612584960 replay_runner.py:36] Average training steps per second: 115.21
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 11:27:30.917216 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 227 Episode length: 227 Return: -226.0
INFO:tensorflow:Average training steps per second: 188.51
I0902 11:27:36.473952 140217612584960 replay_runner.py:36] Average training steps per second: 188.51
I0902 11:27:36.672473 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.54
I0902 11:27:42.087940 140217612584960 replay_runner.py:36] Average training steps per second: 193.54
I0902 11:27:42.529574 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 11:27:42.772149 140217612584960 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 194.44
I0902 11:27:47.915817 140217612584960 replay_runner.py:36] Average training steps per second: 194.44
I0902 11:27:48.375159 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 11:27:48.629512 140217612584960 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 189.22
I0902 11:27:53.915050 140217612584960 replay_runner.py:36] Average training steps per second: 189.22
I0902 11:27:54.352667 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 11:27:54.604424 140217612584960 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 189.11
I0902 11:27:59.892953 140217612584960 replay_runner.py:36] Average training steps per second: 189.11
I0902 11:28:00.345645 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 11:28:00.593863 140217612584960 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.94
I0902 11:28:05.750655 140217612584960 replay_runner.py:36] Average training steps per second: 193.94
I0902 11:28:06.227163 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 11:28:06.475949 140217612584960 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 191.26
I0902 11:28:11.704776 140217612584960 replay_runner.py:36] Average training steps per second: 191.26
I0902 11:28:12.148441 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 11:28:12.388942 140217612584960 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 193.11

Steps executed: 222 Episode length: 108 Return: -107.0
I0902 11:28:17.773197 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 9

Steps executed: 201 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 188.21
I0902 11:28:23.353429 140217612584960 replay_runner.py:36] Average training steps per second: 188.21
I0902 11:28:23.515741 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.57
I0902 11:28:29.002578 140217612584960 replay_runner.py:36] Average training steps per second: 190.57
I0902 11:28:29.463728 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 266 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 196.08
I0902 11:28:34.798648 140217612584960 replay_runner.py:36] Average training steps per second: 196.08
I0902 11:28:35.035118 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.67
INFO:tensorflow:Starting iteration 12

Steps executed: 245 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 190.88
I0902 11:28:40.518496 140217612584960 replay_runner.py:36] Average training steps per second: 190.88
I0902 11:28:40.749698 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 13

Steps executed: 692 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.77
I0902 11:28:46.248994 140217612584960 replay_runner.py:36] Average training steps per second: 190.77
I0902 11:28:46.831030 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.00
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.95
I0902 11:28:52.275990 140217612584960 replay_runner.py:36] Average training steps per second: 191.95
I0902 11:28:52.710623 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 282 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 193.87
I0902 11:28:58.122719 140217612584960 replay_runner.py:36] Average training steps per second: 193.87
I0902 11:28:58.373260 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 16

Steps executed: 210 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 195.68
I0902 11:29:03.734820 140217612584960 replay_runner.py:36] Average training steps per second: 195.68
I0902 11:29:03.922568 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 17

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.13
I0902 11:29:09.548277 140217612584960 replay_runner.py:36] Average training steps per second: 186.13
I0902 11:29:09.998328 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 278 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 191.81
I0902 11:29:15.478882 140217612584960 replay_runner.py:36] Average training steps per second: 191.81
I0902 11:29:15.732944 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.67
INFO:tensorflow:Starting iteration 19
I0902 11:29:15.972098 140217612584960 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 187.07
I0902 11:29:21.318060 140217612584960 replay_runner.py:36] Average training steps per second: 187.07

Steps executed: 368 Episode length: 368 Return: -367.0
INFO:tensorflow:Starting iteration 20

Steps executed: 595 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.56
I0902 11:29:27.080406 140217612584960 replay_runner.py:36] Average training steps per second: 192.56
I0902 11:29:27.642820 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.00
INFO:tensorflow:Starting iteration 21

Steps executed: 210 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 191.56
I0902 11:29:33.084849 140217612584960 replay_runner.py:36] Average training steps per second: 191.56
I0902 11:29:33.272429 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 22

Steps executed: 269 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 190.00
I0902 11:29:38.783192 140217612584960 replay_runner.py:36] Average training steps per second: 190.00
I0902 11:29:39.023596 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 193.43
I0902 11:29:44.431150 140217612584960 replay_runner.py:36] Average training steps per second: 193.43
I0902 11:29:44.626066 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 24

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.57
I0902 11:29:50.166461 140217612584960 replay_runner.py:36] Average training steps per second: 188.57
I0902 11:29:50.581259 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0902 11:29:50.824939 140217612584960 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.68

Steps executed: 279 Episode length: 182 Return: -181.0
I0902 11:29:56.180555 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.50
INFO:tensorflow:Starting iteration 26

Steps executed: 268 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 200.00
I0902 11:30:01.411843 140217612584960 replay_runner.py:36] Average training steps per second: 200.00
I0902 11:30:01.618427 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 27

Steps executed: 214 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 212.58
I0902 11:30:06.554648 140217612584960 replay_runner.py:36] Average training steps per second: 212.58
I0902 11:30:06.724621 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.33
INFO:tensorflow:Starting iteration 28

Steps executed: 267 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 225.22
I0902 11:30:11.402897 140217612584960 replay_runner.py:36] Average training steps per second: 225.22
I0902 11:30:11.596873 140217612584960 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 29
I0902 11:30:11.824611 140217612584960 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 236.18
I0902 11:30:16.059212 140217612584960 replay_runner.py:36] Average training steps per second: 236.18

Done fixed training!Episode length: 206 Return: -205.0