Loaded trained dqn in acrobot
Training fixed agent 3, please be patient, may be a while...
I0828 10:36:58.725602 140088388143104 run_experiment.py:549] Creating TrainRunner ...
I0828 10:36:58.736154 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:36:58.736425 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:36:58.736668 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:36:58.737031 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:36:58.737253 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:36:58.737375 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:36:58.737509 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:36:58.737641 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:36:58.737763 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:36:58.737895 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:36:58.738023 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:36:58.738230 140088388143104 dqn_agent.py:283] 	 seed: 1630147018736090
I0828 10:36:58.741011 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:36:58.741174 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:36:58.741278 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:36:58.741362 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:36:58.741443 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:36:58.741529 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:36:58.741635 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:36:58.741689 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:36:58.741789 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:36:58.779262 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:36:59.204479 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:36:59.243505 140088388143104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:36:59.250702 140088388143104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:36:59.250919 140088388143104 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:36:59.251099 140088388143104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:36:59.251251 140088388143104 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:36:59.251390 140088388143104 dqn_agent.py:275] 	 update_period: 4
I0828 10:36:59.251491 140088388143104 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:36:59.251568 140088388143104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:36:59.251645 140088388143104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:36:59.251722 140088388143104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:36:59.251801 140088388143104 dqn_agent.py:280] 	 optimizer: adam
I0828 10:36:59.251968 140088388143104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:36:59.252110 140088388143104 dqn_agent.py:283] 	 seed: 1630147019250649
I0828 10:36:59.255165 140088388143104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:36:59.255398 140088388143104 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:36:59.255583 140088388143104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:36:59.255704 140088388143104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:36:59.255821 140088388143104 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:36:59.255930 140088388143104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:36:59.256041 140088388143104 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:36:59.256147 140088388143104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:36:59.256304 140088388143104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:36:59.291163 140088388143104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:36:59.312867 140088388143104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:36:59.313135 140088388143104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.37
I0828 10:37:05.963468 140088388143104 replay_runner.py:36] Average training steps per second: 150.37
Steps executed: 285 Episode length: 148 Return: -147.0
I0828 10:37:07.252294 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.50
INFO:tensorflow:Starting iteration 1
I0828 10:37:07.495311 140088388143104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 209.64

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:37:12.637386 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 222 Episode length: 222 Return: -221.0
INFO:tensorflow:Average training steps per second: 211.00
I0828 10:37:17.600142 140088388143104 replay_runner.py:36] Average training steps per second: 211.00
I0828 10:37:17.812923 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.00
INFO:tensorflow:Starting iteration 3

Steps executed: 349 Episode length: 154 Return: -153.0
INFO:tensorflow:Average training steps per second: 211.77
I0828 10:37:22.766763 140088388143104 replay_runner.py:36] Average training steps per second: 211.77
I0828 10:37:23.035983 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.50
INFO:tensorflow:Starting iteration 4

Steps executed: 247 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 206.85
I0828 10:37:28.211040 140088388143104 replay_runner.py:36] Average training steps per second: 206.85
I0828 10:37:28.400476 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 5

Steps executed: 391 Episode length: 202 Return: -201.0
INFO:tensorflow:Average training steps per second: 210.39
I0828 10:37:33.387536 140088388143104 replay_runner.py:36] Average training steps per second: 210.39
I0828 10:37:33.705387 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.33
INFO:tensorflow:Starting iteration 6

Steps executed: 646 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.77
I0828 10:37:38.899837 140088388143104 replay_runner.py:36] Average training steps per second: 201.77
I0828 10:37:39.411227 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -322.50
INFO:tensorflow:Starting iteration 7
I0828 10:37:39.655144 140088388143104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 201.16

Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:37:45.031080 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 290 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 197.87
I0828 10:37:50.353925 140088388143104 replay_runner.py:36] Average training steps per second: 197.87
I0828 10:37:50.609672 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 9

Steps executed: 264 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 197.59
I0828 10:37:55.924481 140088388143104 replay_runner.py:36] Average training steps per second: 197.59
I0828 10:37:56.145246 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.83
I0828 10:38:01.449156 140088388143104 replay_runner.py:36] Average training steps per second: 197.83
I0828 10:38:01.863039 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0828 10:38:02.096512 140088388143104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 195.37
I0828 10:38:07.215281 140088388143104 replay_runner.py:36] Average training steps per second: 195.37
I0828 10:38:07.659473 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0828 10:38:07.904492 140088388143104 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 198.92
I0828 10:38:12.932258 140088388143104 replay_runner.py:36] Average training steps per second: 198.92
I0828 10:38:13.354975 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13


Steps executed: 286 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 197.76
I0828 10:38:18.659764 140088388143104 replay_runner.py:36] Average training steps per second: 197.76
I0828 10:38:18.939910 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.33
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.66
I0828 10:38:24.309740 140088388143104 replay_runner.py:36] Average training steps per second: 196.66
I0828 10:38:24.744471 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 291 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 199.67
I0828 10:38:30.014370 140088388143104 replay_runner.py:36] Average training steps per second: 199.67
I0828 10:38:30.259237 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.00
INFO:tensorflow:Starting iteration 16

Steps executed: 262 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 195.78
I0828 10:38:35.618298 140088388143104 replay_runner.py:36] Average training steps per second: 195.78
I0828 10:38:35.834983 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 17

Steps executed: 287 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 201.16
I0828 10:38:41.052574 140088388143104 replay_runner.py:36] Average training steps per second: 201.16
I0828 10:38:41.291279 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 18
I0828 10:38:41.591412 140088388143104 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 193.43

Steps executed: 228 Episode length: 72 Return: -71.0.0
I0828 10:38:46.975843 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.00
INFO:tensorflow:Starting iteration 19
I0828 10:38:47.274544 140088388143104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 199.69
I0828 10:38:52.282718 140088388143104 replay_runner.py:36] Average training steps per second: 199.69

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 20

Steps executed: 273 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 204.04
I0828 10:38:57.859135 140088388143104 replay_runner.py:36] Average training steps per second: 204.04
I0828 10:38:58.102190 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 21

Steps executed: 245 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 198.88
I0828 10:39:03.450739 140088388143104 replay_runner.py:36] Average training steps per second: 198.88
I0828 10:39:03.661794 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 22
I0828 10:39:03.899801 140088388143104 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 201.89
I0828 10:39:08.853477 140088388143104 replay_runner.py:36] Average training steps per second: 201.89

Steps executed: 234 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Starting iteration 23

Steps executed: 232 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 204.07
I0828 10:39:14.193549 140088388143104 replay_runner.py:36] Average training steps per second: 204.07
I0828 10:39:14.375603 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 24

Steps executed: 263 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 201.15
I0828 10:39:19.575472 140088388143104 replay_runner.py:36] Average training steps per second: 201.15
I0828 10:39:19.789132 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 25
I0828 10:39:20.030063 140088388143104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 201.78
I0828 10:39:24.986379 140088388143104 replay_runner.py:36] Average training steps per second: 201.78

Steps executed: 278 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 203.74
I0828 10:39:30.365357 140088388143104 replay_runner.py:36] Average training steps per second: 203.74
I0828 10:39:30.538256 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 27

Steps executed: 282 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 207.01
I0828 10:39:35.602904 140088388143104 replay_runner.py:36] Average training steps per second: 207.01
I0828 10:39:35.833678 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 28

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.68
I0828 10:39:41.082245 140088388143104 replay_runner.py:36] Average training steps per second: 199.68
I0828 10:39:41.475868 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 29

Steps executed: 616 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.54

Done fixed training!Episode length: 500 Return: -500.0
I0828 10:39:47.241207 140088388143104 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.50