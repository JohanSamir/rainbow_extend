Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 00:23:22.193952 140413705484288 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:22.204573 140413705484288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:22.204737 140413705484288 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:22.204812 140413705484288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:22.204878 140413705484288 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:22.204934 140413705484288 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:22.204988 140413705484288 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:22.205083 140413705484288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:22.205236 140413705484288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:22.205367 140413705484288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:22.205475 140413705484288 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:22.205576 140413705484288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:22.205735 140413705484288 dqn_agent.py:283] 	 seed: 1630542202204517
I0902 00:23:22.207981 140413705484288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:22.208096 140413705484288 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:22.208171 140413705484288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:22.208234 140413705484288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:22.208316 140413705484288 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:22.208398 140413705484288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:22.208486 140413705484288 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:22.208547 140413705484288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:22.208601 140413705484288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:22.234560 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:22.510811 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:22.519685 140413705484288 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:22.527112 140413705484288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:22.527272 140413705484288 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:22.527360 140413705484288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:22.527421 140413705484288 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:22.527477 140413705484288 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:22.527553 140413705484288 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:22.527674 140413705484288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:22.527728 140413705484288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:22.527784 140413705484288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:22.527859 140413705484288 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:22.527926 140413705484288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:22.527981 140413705484288 dqn_agent.py:283] 	 seed: 1630542202527073
I0902 00:23:22.529416 140413705484288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:22.529523 140413705484288 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:22.529593 140413705484288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:22.529654 140413705484288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:22.529719 140413705484288 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:22.529811 140413705484288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:22.529880 140413705484288 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:22.529945 140413705484288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:22.530019 140413705484288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:22.550668 140413705484288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:22.566495 140413705484288 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:22.566687 140413705484288 replay_runner.py:41] Starting iteration 0
Steps executed: 324 Episode length: 197 Return: -503.44085396283225
INFO:tensorflow:Average training steps per second: 243.72
I0902 00:23:26.669938 140413705484288 replay_runner.py:36] Average training steps per second: 243.72
I0902 00:23:27.403895 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.86
INFO:tensorflow:Starting iteration 1

Steps executed: 173 Episode length: 173 Return: -402.22049498262695
INFO:tensorflow:Average training steps per second: 361.85
I0902 00:23:33.504025 140413705484288 replay_runner.py:36] Average training steps per second: 361.85

Steps executed: 445 Episode length: 272 Return: -208.65323708921346
INFO:tensorflow:Starting iteration 2

Steps executed: 308 Episode length: 308 Return: -109.98896110385884
INFO:tensorflow:Average training steps per second: 366.34
I0902 00:23:39.915014 140413705484288 replay_runner.py:36] Average training steps per second: 366.34
I0902 00:23:40.151507 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.99
INFO:tensorflow:Starting iteration 3

Steps executed: 230 Episode length: 230 Return: -299.78224636194184
INFO:tensorflow:Average training steps per second: 359.34
I0902 00:23:46.370676 140413705484288 replay_runner.py:36] Average training steps per second: 359.34
I0902 00:23:46.534265 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.78
INFO:tensorflow:Starting iteration 4
I0902 00:23:49.878433 140413705484288 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 324.77

Steps executed: 911 Episode length: 911 Return: -184.86119005658236
I0902 00:23:54.539770 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.86
INFO:tensorflow:Starting iteration 5

Steps executed: 419 Episode length: 419 Return: -287.48719001390536
INFO:tensorflow:Average training steps per second: 324.32
I0902 00:24:00.884189 140413705484288 replay_runner.py:36] Average training steps per second: 324.32
I0902 00:24:01.326300 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.49
INFO:tensorflow:Starting iteration 6
I0902 00:24:04.428621 140413705484288 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 339.03

Steps executed: 1000 Episode length: 1000 Return: -70.6834944184036
I0902 00:24:08.808378 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.68
INFO:tensorflow:Starting iteration 7
I0902 00:24:12.104783 140413705484288 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 348.31

Steps executed: 1000 Episode length: 1000 Return: -228.81293517334578
I0902 00:24:17.258847 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -228.81
INFO:tensorflow:Starting iteration 8
I0902 00:24:20.678666 140413705484288 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 362.28

Steps executed: 1000 Episode length: 1000 Return: -361.18455965882168
I0902 00:24:25.369450 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.18
INFO:tensorflow:Starting iteration 9
I0902 00:24:28.761682 140413705484288 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 350.62

Steps executed: 1000 Episode length: 1000 Return: -76.192437025099718
I0902 00:24:33.669000 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.19
INFO:tensorflow:Starting iteration 10
I0902 00:24:37.089005 140413705484288 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 350.82
I0902 00:24:39.939735 140413705484288 replay_runner.py:36] Average training steps per second: 350.82

Steps executed: 1000 Episode length: 1000 Return: -71.061722798768958
INFO:tensorflow:Starting iteration 11

Steps executed: 687 Episode length: 687 Return: -325.6528753148870758
INFO:tensorflow:Average training steps per second: 350.28
I0902 00:24:48.578748 140413705484288 replay_runner.py:36] Average training steps per second: 350.28
I0902 00:24:49.561507 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.65
INFO:tensorflow:Starting iteration 12
I0902 00:24:52.950798 140413705484288 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 341.83

Steps executed: 614 Episode length: 614 Return: -256.8789532714809758
I0902 00:24:56.594598 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.88
INFO:tensorflow:Starting iteration 13

Steps executed: 293 Episode length: 209 Return: -290.2809560189600758
INFO:tensorflow:Average training steps per second: 333.56
I0902 00:25:02.900145 140413705484288 replay_runner.py:36] Average training steps per second: 333.56
I0902 00:25:03.093011 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.97
INFO:tensorflow:Starting iteration 14
I0902 00:25:06.396965 140413705484288 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 351.42

Steps executed: 1000 Episode length: 1000 Return: -92.839566104268348
I0902 00:25:11.774107 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.84
INFO:tensorflow:Starting iteration 15

Steps executed: 282 Episode length: 146 Return: -182.8876328385948648
INFO:tensorflow:Average training steps per second: 353.08
I0902 00:25:17.837969 140413705484288 replay_runner.py:36] Average training steps per second: 353.08
I0902 00:25:17.999562 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.26
INFO:tensorflow:Starting iteration 16

Steps executed: 283 Episode length: 142 Return: -494.4976139069316348
INFO:tensorflow:Average training steps per second: 356.24
I0902 00:25:24.231592 140413705484288 replay_runner.py:36] Average training steps per second: 356.24
I0902 00:25:24.399450 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.76
INFO:tensorflow:Starting iteration 17

Steps executed: 238 Episode length: 84 Return: -102.77699549020188448
INFO:tensorflow:Average training steps per second: 359.93
I0902 00:25:30.579815 140413705484288 replay_runner.py:36] Average training steps per second: 359.93
I0902 00:25:30.727123 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.22
INFO:tensorflow:Starting iteration 18

Steps executed: 226 Episode length: 111 Return: -448.4232583587982448
INFO:tensorflow:Average training steps per second: 389.12
I0902 00:25:36.813679 140413705484288 replay_runner.py:36] Average training steps per second: 389.12
I0902 00:25:36.922160 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -534.14
INFO:tensorflow:Starting iteration 19

Steps executed: 316 Episode length: 123 Return: -243.4924291591623848
INFO:tensorflow:Average training steps per second: 367.49
I0902 00:25:43.189051 140413705484288 replay_runner.py:36] Average training steps per second: 367.49
I0902 00:25:43.331380 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.91
INFO:tensorflow:Starting iteration 20

Steps executed: 267 Episode length: 267 Return: -264.4783792649908548
INFO:tensorflow:Average training steps per second: 356.06
I0902 00:25:49.607218 140413705484288 replay_runner.py:36] Average training steps per second: 356.06
I0902 00:25:49.785099 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.48
INFO:tensorflow:Starting iteration 21
I0902 00:25:53.160030 140413705484288 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 326.29

Steps executed: 304 Episode length: 147 Return: -55.06842903500524548
I0902 00:25:56.381378 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.70
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 92 Return: -465.08500038192767548
INFO:tensorflow:Average training steps per second: 334.67
I0902 00:26:02.757858 140413705484288 replay_runner.py:36] Average training steps per second: 334.67
I0902 00:26:02.905201 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -478.81
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 57 Return: -157.52553138018914548
INFO:tensorflow:Average training steps per second: 334.26
I0902 00:26:09.337057 140413705484288 replay_runner.py:36] Average training steps per second: 334.26
I0902 00:26:09.435758 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.92
INFO:tensorflow:Starting iteration 24

Steps executed: 397 Episode length: 198 Return: 300.41744263699998448
INFO:tensorflow:Average training steps per second: 342.08
I0902 00:26:15.775874 140413705484288 replay_runner.py:36] Average training steps per second: 342.08
I0902 00:26:16.010788 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: 0.16
INFO:tensorflow:Starting iteration 25
I0902 00:26:19.413498 140413705484288 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 339.78

Steps executed: 289 Episode length: 117 Return: -413.0160994508517448
I0902 00:26:22.538098 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -396.46
INFO:tensorflow:Starting iteration 26

Steps executed: 322 Episode length: 208 Return: -69.69877505974054448
INFO:tensorflow:Average training steps per second: 337.61
I0902 00:26:28.875996 140413705484288 replay_runner.py:36] Average training steps per second: 337.61
I0902 00:26:29.072639 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.33
INFO:tensorflow:Starting iteration 27

Steps executed: 253 Episode length: 135 Return: -224.5497977692393248
INFO:tensorflow:Average training steps per second: 329.09
I0902 00:26:35.447183 140413705484288 replay_runner.py:36] Average training steps per second: 329.09
I0902 00:26:35.588646 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.47
INFO:tensorflow:Starting iteration 28

Steps executed: 272 Episode length: 160 Return: -290.0327754084470448
INFO:tensorflow:Average training steps per second: 337.13
I0902 00:26:41.904139 140413705484288 replay_runner.py:36] Average training steps per second: 337.13
I0902 00:26:42.110743 140413705484288 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.83
INFO:tensorflow:Starting iteration 29

Steps executed: 141 Episode length: 141 Return: -481.3811349201788448
INFO:tensorflow:Average training steps per second: 348.45

Steps executed: 298 Episode length: 157 Return: -402.2859717023693548

Done fixed training!Episode length: 157 Return: -402.2859717023693548