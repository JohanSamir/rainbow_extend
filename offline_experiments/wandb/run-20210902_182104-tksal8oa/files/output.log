Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0902 18:21:10.763738 140182397114368 run_experiment.py:549] Creating TrainRunner ...
I0902 18:21:10.771466 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:10.771605 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:10.771743 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:10.771857 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:10.771930 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:10.771987 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:10.772040 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:10.772133 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:10.772234 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:10.772352 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:10.772449 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:10.772539 140182397114368 dqn_agent.py:283] 	 seed: 1630606870771429
I0902 18:21:10.774428 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:10.774549 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:10.774625 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:10.774687 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:10.774746 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:10.774799 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:10.774882 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:10.774999 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:10.775065 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:10.799970 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:11.067567 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:11.075531 140182397114368 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:21:11.083066 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:11.083212 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:11.083286 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:11.083347 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:11.083415 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:11.083492 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:11.083594 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:11.083665 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:11.083730 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:11.083806 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:11.083867 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:11.083946 140182397114368 dqn_agent.py:283] 	 seed: 1630606871083036
I0902 18:21:11.085607 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:11.085743 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:11.085825 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:11.085905 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:11.086014 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:11.086093 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:11.086194 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:11.086319 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:11.086458 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:11.110641 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:11.128155 140182397114368 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:21:11.128350 140182397114368 replay_runner.py:41] Starting iteration 0
Steps executed: 247 Episode length: 99 Return: -418.53350733437287
INFO:tensorflow:Average training steps per second: 241.75
I0902 18:21:15.265025 140182397114368 replay_runner.py:36] Average training steps per second: 241.75
I0902 18:21:15.957738 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.80
INFO:tensorflow:Starting iteration 1
I0902 18:21:19.417856 140182397114368 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 361.52
I0902 18:21:22.184180 140182397114368 replay_runner.py:36] Average training steps per second: 361.52

Steps executed: 234 Episode length: 100 Return: -377.2674493966668
INFO:tensorflow:Starting iteration 2
I0902 18:21:25.523369 140182397114368 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 349.18

Steps executed: 295 Episode length: 295 Return: -353.52284893323485
I0902 18:21:28.667369 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.52
INFO:tensorflow:Starting iteration 3

Steps executed: 1000 Episode length: 1000 Return: -148.47538379980244
INFO:tensorflow:Average training steps per second: 380.36
I0902 18:21:34.680005 140182397114368 replay_runner.py:36] Average training steps per second: 380.36
I0902 18:21:36.368253 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.48
INFO:tensorflow:Starting iteration 4
I0902 18:21:39.712911 140182397114368 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 380.34

Steps executed: 1000 Episode length: 1000 Return: -123.58924520889654
I0902 18:21:44.228513 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.59
INFO:tensorflow:Starting iteration 5
I0902 18:21:47.425039 140182397114368 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 347.78

Steps executed: 1000 Episode length: 1000 Return: -194.77043723204884
I0902 18:21:52.938978 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.77
INFO:tensorflow:Starting iteration 6
I0902 18:21:56.241096 140182397114368 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 329.82

Steps executed: 1000 Episode length: 1000 Return: -290.83161139375125
I0902 18:22:01.303434 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.83
INFO:tensorflow:Starting iteration 7

Steps executed: 278 Episode length: 278 Return: -451.1843975037444425
INFO:tensorflow:Average training steps per second: 333.77
I0902 18:22:07.621515 140182397114368 replay_runner.py:36] Average training steps per second: 333.77
I0902 18:22:07.838410 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.18
INFO:tensorflow:Starting iteration 8
I0902 18:22:11.159265 140182397114368 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 343.18

Steps executed: 1000 Episode length: 1000 Return: -217.03090931769367
I0902 18:22:15.298641 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.03
INFO:tensorflow:Starting iteration 9

Steps executed: 247 Episode length: 247 Return: -648.0297082340229367
INFO:tensorflow:Average training steps per second: 360.20
I0902 18:22:21.452576 140182397114368 replay_runner.py:36] Average training steps per second: 360.20
I0902 18:22:21.641512 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -648.03
INFO:tensorflow:Starting iteration 10

Steps executed: 591 Episode length: 591 Return: -509.7953277939933367
INFO:tensorflow:Average training steps per second: 366.60
I0902 18:22:27.825321 140182397114368 replay_runner.py:36] Average training steps per second: 366.60
I0902 18:22:28.536921 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.80
INFO:tensorflow:Starting iteration 11
I0902 18:22:31.951614 140182397114368 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 341.15

Steps executed: 725 Episode length: 725 Return: -706.5128596032821367
I0902 18:22:36.041698 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -706.51
INFO:tensorflow:Starting iteration 12
I0902 18:22:39.326142 140182397114368 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 323.20

Steps executed: 1000 Episode length: 1000 Return: -77.327734192835757
I0902 18:22:45.347822 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 13
I0902 18:22:48.746270 140182397114368 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 348.04

Steps executed: 1000 Episode length: 1000 Return: -27.069699166969855
I0902 18:22:53.823935 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -27.07
INFO:tensorflow:Starting iteration 14

Steps executed: 628 Episode length: 536 Return: -393.8687874532622855
INFO:tensorflow:Average training steps per second: 348.92
I0902 18:23:00.077455 140182397114368 replay_runner.py:36] Average training steps per second: 348.92
I0902 18:23:00.850275 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.80
INFO:tensorflow:Starting iteration 15
I0902 18:23:04.288132 140182397114368 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 352.28

Steps executed: 931 Episode length: 931 Return: -671.6488706908702855
I0902 18:23:09.151131 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -671.65
INFO:tensorflow:Starting iteration 16
I0902 18:23:12.592275 140182397114368 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 348.04

Steps executed: 1000 Episode length: 1000 Return: -34.211256199961085
I0902 18:23:17.762877 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -34.21
INFO:tensorflow:Starting iteration 17

Steps executed: 147 Episode length: 147 Return: -1.732968091531020685
INFO:tensorflow:Average training steps per second: 340.14

Steps executed: 1107 Episode length: 960 Return: 138.1736558828024285
I0902 18:23:25.887376 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: 68.22
INFO:tensorflow:Starting iteration 18

Steps executed: 379 Episode length: 251 Return: -459.2631447295462585
INFO:tensorflow:Average training steps per second: 362.96
I0902 18:23:31.962573 140182397114368 replay_runner.py:36] Average training steps per second: 362.96
I0902 18:23:32.199299 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.71
INFO:tensorflow:Starting iteration 19

Steps executed: 528 Episode length: 528 Return: -49.27197145602917585
INFO:tensorflow:Average training steps per second: 376.15
I0902 18:23:38.337387 140182397114368 replay_runner.py:36] Average training steps per second: 376.15
I0902 18:23:39.127395 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.27
INFO:tensorflow:Starting iteration 20

Steps executed: 512 Episode length: 512 Return: -668.6515966706793585
INFO:tensorflow:Average training steps per second: 368.78
I0902 18:23:45.350914 140182397114368 replay_runner.py:36] Average training steps per second: 368.78
I0902 18:23:45.882839 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -668.65
INFO:tensorflow:Starting iteration 21

Steps executed: 289 Episode length: 289 Return: -201.9685454270894585
INFO:tensorflow:Average training steps per second: 345.09
I0902 18:23:52.279539 140182397114368 replay_runner.py:36] Average training steps per second: 345.09
I0902 18:23:52.462321 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.97
INFO:tensorflow:Starting iteration 22
I0902 18:23:55.808899 140182397114368 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 338.29

Steps executed: 131 Episode length: 131 Return: -67.69926210217844585

Steps executed: 1131 Episode length: 1000 Return: 54.2179896204032455
INFO:tensorflow:Starting iteration 23

Steps executed: 248 Episode length: 173 Return: 1.5902512364750123455
INFO:tensorflow:Average training steps per second: 366.09
I0902 18:24:07.128508 140182397114368 replay_runner.py:36] Average training steps per second: 366.09
I0902 18:24:07.281344 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.30
INFO:tensorflow:Starting iteration 24

Steps executed: 179 Episode length: 179 Return: 65.109524506590933455
INFO:tensorflow:Average training steps per second: 358.65

Steps executed: 1179 Episode length: 1000 Return: 20.2992837063366455
I0902 18:24:16.360147 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: 42.70
INFO:tensorflow:Starting iteration 25

Steps executed: 119 Episode length: 119 Return: -266.6958464871255555
INFO:tensorflow:Average training steps per second: 322.43

Steps executed: 1119 Episode length: 1000 Return: 90.1953456286998155
I0902 18:24:24.855869 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.25
INFO:tensorflow:Starting iteration 26
I0902 18:24:28.073413 140182397114368 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 326.57

Steps executed: 1000 Episode length: 1000 Return: -12.188276476603738
I0902 18:24:33.397028 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -12.19
INFO:tensorflow:Starting iteration 27
I0902 18:24:36.870282 140182397114368 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 355.44

Steps executed: 1000 Episode length: 1000 Return: -146.01554693196568
I0902 18:24:41.363162 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.02
INFO:tensorflow:Starting iteration 28

Steps executed: 479 Episode length: 321 Return: -640.8418654978573568
INFO:tensorflow:Average training steps per second: 351.72
I0902 18:24:47.713437 140182397114368 replay_runner.py:36] Average training steps per second: 351.72
I0902 18:24:48.024147 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.66
INFO:tensorflow:Starting iteration 29

Steps executed: 295 Episode length: 295 Return: 249.47055134195614568
INFO:tensorflow:Average training steps per second: 327.66
I0902 18:24:54.348424 140182397114368 replay_runner.py:36] Average training steps per second: 327.66

Done fixed training!Episode length: 295 Return: 249.47055134195614568