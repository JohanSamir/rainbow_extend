I0902 23:21:54.020522 140260243740672 run_experiment.py:549] Creating TrainRunner ...
I0902 23:21:54.029137 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:54.029384 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:54.029488 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:54.029572 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:54.029647 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:54.029768 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:54.029847 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:54.029956 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:54.030043 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:54.030174 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:54.030272 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:54.030361 140260243740672 dqn_agent.py:283] 	 seed: 1630624914029065
I0902 23:21:54.032485 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:54.032676 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:54.032797 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:54.032888 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:54.032983 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:54.033081 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:54.033173 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:54.033269 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:54.033360 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 8, please be patient, may be a while...
I0902 23:21:56.248026 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.744234 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.758338 140260243740672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:21:56.765513 140260243740672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:56.765819 140260243740672 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:56.765967 140260243740672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:56.766113 140260243740672 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:56.766293 140260243740672 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:56.766536 140260243740672 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:56.766664 140260243740672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:56.766788 140260243740672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:56.766904 140260243740672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:56.767012 140260243740672 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:56.767112 140260243740672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:56.767248 140260243740672 dqn_agent.py:283] 	 seed: 1630624916765453
I0902 23:21:56.769914 140260243740672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:56.770147 140260243740672 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:56.770300 140260243740672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:56.770442 140260243740672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:56.770531 140260243740672 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:56.770800 140260243740672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:56.770924 140260243740672 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:56.771168 140260243740672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:56.771298 140260243740672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:21:56.807367 140260243740672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:56.833157 140260243740672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:21:56.833444 140260243740672 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.46
I0902 23:22:03.350081 140260243740672 replay_runner.py:36] Average training steps per second: 153.46
Steps executed: 204 Episode length: 10 Return: 10.0
I0902 23:22:04.501300 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 1

Steps executed: 30 Episode length: 30 Return: 30.00
INFO:tensorflow:Average training steps per second: 205.60
I0902 23:22:09.549860 140260243740672 replay_runner.py:36] Average training steps per second: 205.60
I0902 23:22:09.704677 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 30.57
INFO:tensorflow:Starting iteration 2


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.60
I0902 23:22:14.812838 140260243740672 replay_runner.py:36] Average training steps per second: 202.60
I0902 23:22:14.927097 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:22:15.094645 140260243740672 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 214.64

Steps executed: 375 Episode length: 200 Return: 200.0
I0902 23:22:19.995381 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 4

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 206.25
I0902 23:22:25.027220 140260243740672 replay_runner.py:36] Average training steps per second: 206.25
I0902 23:22:25.154815 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0902 23:22:25.334948 140260243740672 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.83
I0902 23:22:30.390192 140260243740672 replay_runner.py:36] Average training steps per second: 197.83
I0902 23:22:30.528758 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 23:22:30.705668 140260243740672 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.25

Steps executed: 292 Episode length: 147 Return: 147.0
I0902 23:22:36.003719 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 7

Steps executed: 294 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 192.33
I0902 23:22:41.395192 140260243740672 replay_runner.py:36] Average training steps per second: 192.33
I0902 23:22:41.587722 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 8

Steps executed: 282 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 201.37
I0902 23:22:46.748591 140260243740672 replay_runner.py:36] Average training steps per second: 201.37
I0902 23:22:46.948395 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 9

Steps executed: 303 Episode length: 138 Return: 138.0
INFO:tensorflow:Average training steps per second: 196.02
I0902 23:22:52.245089 140260243740672 replay_runner.py:36] Average training steps per second: 196.02
I0902 23:22:52.448268 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 10
I0902 23:22:52.630486 140260243740672 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 187.19

Steps executed: 366 Episode length: 174 Return: 174.0
I0902 23:22:58.236355 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 11

Steps executed: 282 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 197.09
I0902 23:23:03.505207 140260243740672 replay_runner.py:36] Average training steps per second: 197.09
I0902 23:23:03.700119 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.00
INFO:tensorflow:Starting iteration 12

Steps executed: 352 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 187.42
I0902 23:23:09.224278 140260243740672 replay_runner.py:36] Average training steps per second: 187.42
I0902 23:23:09.453155 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 13

Steps executed: 330 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 197.65
I0902 23:23:14.681869 140260243740672 replay_runner.py:36] Average training steps per second: 197.65
I0902 23:23:14.907238 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 14
I0902 23:23:15.087279 140260243740672 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 197.11
I0902 23:23:20.161111 140260243740672 replay_runner.py:36] Average training steps per second: 197.11

Steps executed: 352 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 15

Steps executed: 357 Episode length: 174 Return: 174.0
INFO:tensorflow:Average training steps per second: 193.39
I0902 23:23:25.728675 140260243740672 replay_runner.py:36] Average training steps per second: 193.39
I0902 23:23:25.975940 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 201.03
I0902 23:23:31.147959 140260243740672 replay_runner.py:36] Average training steps per second: 201.03
I0902 23:23:31.293987 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:23:31.492658 140260243740672 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 190.31
I0902 23:23:36.747784 140260243740672 replay_runner.py:36] Average training steps per second: 190.31
I0902 23:23:36.885293 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:23:37.074833 140260243740672 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 190.49
I0902 23:23:42.325061 140260243740672 replay_runner.py:36] Average training steps per second: 190.49
I0902 23:23:42.474175 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 361 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 197.17
I0902 23:23:47.751726 140260243740672 replay_runner.py:36] Average training steps per second: 197.17
I0902 23:23:47.987987 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.50
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.86
I0902 23:23:53.444752 140260243740672 replay_runner.py:36] Average training steps per second: 189.86
I0902 23:23:53.585311 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:23:53.779775 140260243740672 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 198.38
I0902 23:23:58.820999 140260243740672 replay_runner.py:36] Average training steps per second: 198.38
I0902 23:23:58.976842 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:23:59.316863 140260243740672 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 189.10
I0902 23:24:04.605791 140260243740672 replay_runner.py:36] Average training steps per second: 189.10
I0902 23:24:04.739670 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:24:04.927517 140260243740672 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 193.90
I0902 23:24:10.085017 140260243740672 replay_runner.py:36] Average training steps per second: 193.90

Steps executed: 387 Episode length: 191 Return: 191.0
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.79
I0902 23:24:15.590125 140260243740672 replay_runner.py:36] Average training steps per second: 197.79
I0902 23:24:15.727380 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 356 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 189.63
I0902 23:24:21.186702 140260243740672 replay_runner.py:36] Average training steps per second: 189.63
I0902 23:24:21.422145 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 26
I0902 23:24:21.609767 140260243740672 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 203.07

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:24:26.675842 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:24:26.869767 140260243740672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 193.38
I0902 23:24:32.041210 140260243740672 replay_runner.py:36] Average training steps per second: 193.38
I0902 23:24:32.177780 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:24:32.356641 140260243740672 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 204.67
I0902 23:24:37.242960 140260243740672 replay_runner.py:36] Average training steps per second: 204.67
I0902 23:24:37.377557 140260243740672 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:24:37.562194 140260243740672 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 200.87
I0902 23:24:42.540910 140260243740672 replay_runner.py:36] Average training steps per second: 200.87

Done fixed training!Episode length: 200 Return: 200.0