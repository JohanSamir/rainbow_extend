I0905 16:21:33.228147 140199535331328 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 16:21:33.228760 140199535331328 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 16:21:33.299086 140199535331328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:33.300166 140199535331328 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:33.300268 140199535331328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:33.300342 140199535331328 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:33.300399 140199535331328 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:33.300488 140199535331328 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:33.300546 140199535331328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:33.300645 140199535331328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:33.300736 140199535331328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:33.300802 140199535331328 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:33.300856 140199535331328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:33.300921 140199535331328 dqn_agent.py:283] 	 seed: 1630858893299033
I0905 16:21:33.302534 140199535331328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:33.302689 140199535331328 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:33.302760 140199535331328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:33.302820 140199535331328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:33.302880 140199535331328 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:33.302958 140199535331328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:33.303023 140199535331328 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:33.303121 140199535331328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:33.303207 140199535331328 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0905 16:21:34.848084 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.129576 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.261526 140199535331328 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:21:35.266496 140199535331328 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:21:35.266651 140199535331328 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:21:35.266723 140199535331328 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:21:35.266806 140199535331328 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:21:35.266900 140199535331328 dqn_agent.py:275] 	 update_period: 4
I0905 16:21:35.266997 140199535331328 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:21:35.267095 140199535331328 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:21:35.267224 140199535331328 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:21:35.267279 140199535331328 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:21:35.267327 140199535331328 dqn_agent.py:280] 	 optimizer: adam
I0905 16:21:35.267401 140199535331328 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:21:35.267470 140199535331328 dqn_agent.py:283] 	 seed: 1630858895266461
I0905 16:21:35.268924 140199535331328 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:21:35.269045 140199535331328 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:21:35.269116 140199535331328 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:21:35.269180 140199535331328 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:21:35.269236 140199535331328 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:21:35.269306 140199535331328 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:21:35.269364 140199535331328 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:21:35.269441 140199535331328 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:21:35.269520 140199535331328 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:21:35.286937 140199535331328 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:21:35.297833 140199535331328 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:21:35.298018 140199535331328 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 296.13
I0905 16:21:38.675141 140199535331328 replay_runner.py:36] Average training steps per second: 296.13
Steps executed: 244 Episode length: 244 Return: -443.53348537284654
I0905 16:21:39.324887 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.53
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 203 Return: -276.21219983859623
INFO:tensorflow:Average training steps per second: 416.37
I0905 16:21:44.809699 140199535331328 replay_runner.py:36] Average training steps per second: 416.37
I0905 16:21:44.909477 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -276.21
INFO:tensorflow:Starting iteration 2

Steps executed: 230 Episode length: 141 Return: -384.27082060173333
INFO:tensorflow:Average training steps per second: 413.51
I0905 16:21:50.394746 140199535331328 replay_runner.py:36] Average training steps per second: 413.51
I0905 16:21:50.488382 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.19
INFO:tensorflow:Starting iteration 3

Steps executed: 241 Episode length: 80 Return: -342.450037764589153
INFO:tensorflow:Average training steps per second: 416.73
I0905 16:21:55.975661 140199535331328 replay_runner.py:36] Average training steps per second: 416.73
I0905 16:21:56.058485 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.36
INFO:tensorflow:Starting iteration 4

Steps executed: 236 Episode length: 152 Return: -313.21968509370723
INFO:tensorflow:Average training steps per second: 419.68
I0905 16:22:01.521884 140199535331328 replay_runner.py:36] Average training steps per second: 419.68
I0905 16:22:01.612975 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.81
INFO:tensorflow:Starting iteration 5

Steps executed: 326 Episode length: 154 Return: -377.01296260907543
INFO:tensorflow:Average training steps per second: 407.98
I0905 16:22:07.137362 140199535331328 replay_runner.py:36] Average training steps per second: 407.98
I0905 16:22:07.273323 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.79
INFO:tensorflow:Starting iteration 6

Steps executed: 215 Episode length: 148 Return: -323.41325390358183
INFO:tensorflow:Average training steps per second: 417.83
I0905 16:22:12.747358 140199535331328 replay_runner.py:36] Average training steps per second: 417.83
I0905 16:22:12.840091 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.81
INFO:tensorflow:Starting iteration 7

Steps executed: 336 Episode length: 172 Return: -420.94014895196993
INFO:tensorflow:Average training steps per second: 398.65
I0905 16:22:18.432334 140199535331328 replay_runner.py:36] Average training steps per second: 398.65
I0905 16:22:18.613416 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.36
INFO:tensorflow:Starting iteration 8

Steps executed: 403 Episode length: 251 Return: -395.60656421371937
INFO:tensorflow:Average training steps per second: 397.95
I0905 16:22:24.209978 140199535331328 replay_runner.py:36] Average training steps per second: 397.95
I0905 16:22:24.409063 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.42
INFO:tensorflow:Starting iteration 9

Steps executed: 95 Episode length: 95 Return: -190.3119613831111737
INFO:tensorflow:Average training steps per second: 410.19

Steps executed: 1095 Episode length: 1000 Return: -120.11346868415609
I0905 16:22:32.148835 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.21
INFO:tensorflow:Starting iteration 10

Steps executed: 808 Episode length: 738 Return: -347.5662024090972609
INFO:tensorflow:Average training steps per second: 417.04
I0905 16:22:37.634405 140199535331328 replay_runner.py:36] Average training steps per second: 417.04
I0905 16:22:38.438580 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.82
INFO:tensorflow:Starting iteration 11

Steps executed: 241 Episode length: 143 Return: -352.3230724281575609
INFO:tensorflow:Average training steps per second: 421.56
I0905 16:22:43.915078 140199535331328 replay_runner.py:36] Average training steps per second: 421.56
I0905 16:22:44.009811 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.75
INFO:tensorflow:Starting iteration 12

Steps executed: 261 Episode length: 67 Return: -273.27928947569495709
INFO:tensorflow:Average training steps per second: 418.39
I0905 16:22:49.485641 140199535331328 replay_runner.py:36] Average training steps per second: 418.39
I0905 16:22:49.601539 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.37
INFO:tensorflow:Starting iteration 13
I0905 16:22:52.701231 140199535331328 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 417.64

Steps executed: 366 Episode length: 215 Return: -467.0891174613929709
I0905 16:22:55.275988 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.69
INFO:tensorflow:Starting iteration 14

Steps executed: 278 Episode length: 86 Return: -337.76520827723004709
INFO:tensorflow:Average training steps per second: 419.31
I0905 16:23:00.746512 140199535331328 replay_runner.py:36] Average training steps per second: 419.31
I0905 16:23:00.845273 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.72
INFO:tensorflow:Starting iteration 15

Steps executed: 201 Episode length: 60 Return: -521.38002047084464709
INFO:tensorflow:Average training steps per second: 419.51
I0905 16:23:06.321172 140199535331328 replay_runner.py:36] Average training steps per second: 419.51
I0905 16:23:06.398298 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.16
INFO:tensorflow:Starting iteration 16

Steps executed: 221 Episode length: 72 Return: -446.69011737929065709
INFO:tensorflow:Average training steps per second: 430.39
I0905 16:23:11.633591 140199535331328 replay_runner.py:36] Average training steps per second: 430.39
I0905 16:23:11.718457 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.43
INFO:tensorflow:Starting iteration 17

Steps executed: 277 Episode length: 84 Return: -313.54798988683296709
INFO:tensorflow:Average training steps per second: 283.25
I0905 16:23:18.676089 140199535331328 replay_runner.py:36] Average training steps per second: 283.25
I0905 16:23:18.779565 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.68
INFO:tensorflow:Starting iteration 18

Steps executed: 230 Episode length: 52 Return: -431.83966444402074709
INFO:tensorflow:Average training steps per second: 419.04
I0905 16:23:24.231110 140199535331328 replay_runner.py:36] Average training steps per second: 419.04
I0905 16:23:24.324744 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.20
INFO:tensorflow:Starting iteration 19

Steps executed: 264 Episode length: 79 Return: -524.61183482920176709
INFO:tensorflow:Average training steps per second: 414.24
I0905 16:23:29.815372 140199535331328 replay_runner.py:36] Average training steps per second: 414.24
I0905 16:23:29.918625 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.17
INFO:tensorflow:Starting iteration 20

Steps executed: 244 Episode length: 67 Return: -518.32527135054314709
INFO:tensorflow:Average training steps per second: 414.35
I0905 16:23:35.419585 140199535331328 replay_runner.py:36] Average training steps per second: 414.35
I0905 16:23:35.514651 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -438.52
INFO:tensorflow:Starting iteration 21

Steps executed: 68 Episode length: 68 Return: -506.249905369574814709
INFO:tensorflow:Average training steps per second: 417.48

Steps executed: 784 Episode length: 716 Return: -54.86037465073257709
I0905 16:23:41.913902 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.56
INFO:tensorflow:Starting iteration 22
I0905 16:23:45.000760 140199535331328 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 418.38

Steps executed: 237 Episode length: 51 Return: -445.95138841688737709
I0905 16:23:47.486092 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -494.45
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 60 Return: -446.92910791929945709
INFO:tensorflow:Average training steps per second: 418.02
I0905 16:23:52.970560 140199535331328 replay_runner.py:36] Average training steps per second: 418.02
I0905 16:23:53.049307 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.90
INFO:tensorflow:Starting iteration 24

Steps executed: 245 Episode length: 66 Return: -563.76213776934785709
INFO:tensorflow:Average training steps per second: 418.08
I0905 16:23:58.529664 140199535331328 replay_runner.py:36] Average training steps per second: 418.08
I0905 16:23:58.622350 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -450.26
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 60 Return: -127.79290456984418709
INFO:tensorflow:Average training steps per second: 407.09
I0905 16:24:04.174001 140199535331328 replay_runner.py:36] Average training steps per second: 407.09
I0905 16:24:04.250066 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.67
INFO:tensorflow:Starting iteration 26

Steps executed: 237 Episode length: 57 Return: -331.83429479074063709
INFO:tensorflow:Average training steps per second: 403.61
I0905 16:24:09.836181 140199535331328 replay_runner.py:36] Average training steps per second: 403.61
I0905 16:24:09.930371 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.50
INFO:tensorflow:Starting iteration 27

Steps executed: 129 Episode length: 67 Return: -359.38972732449593709
INFO:tensorflow:Average training steps per second: 410.04
I0905 16:24:15.495063 140199535331328 replay_runner.py:36] Average training steps per second: 410.04

Steps executed: 208 Episode length: 79 Return: -670.98032089886753709
INFO:tensorflow:Starting iteration 28

Steps executed: 251 Episode length: 56 Return: -141.06534905408944709
INFO:tensorflow:Average training steps per second: 413.89
I0905 16:24:21.082130 140199535331328 replay_runner.py:36] Average training steps per second: 413.89
I0905 16:24:21.162426 140199535331328 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.90
INFO:tensorflow:Starting iteration 29

Steps executed: 223 Episode length: 68 Return: -509.42397500383964709
INFO:tensorflow:Average training steps per second: 416.19
I0905 16:24:26.655686 140199535331328 replay_runner.py:36] Average training steps per second: 416.19

Done fixed training!Episode length: 68 Return: -509.42397500383964709