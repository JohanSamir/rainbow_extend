I0910 11:25:31.726847 139947463223296 run_experiment.py:549] Creating TrainRunner ...
I0910 11:25:31.733288 139947463223296 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:25:31.733421 139947463223296 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:25:31.733474 139947463223296 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:25:31.733516 139947463223296 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:25:31.733578 139947463223296 dqn_agent.py:275] 	 update_period: 4
I0910 11:25:31.733621 139947463223296 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:25:31.733698 139947463223296 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:25:31.733743 139947463223296 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:25:31.733818 139947463223296 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:25:31.733898 139947463223296 dqn_agent.py:280] 	 optimizer: adam
I0910 11:25:31.733993 139947463223296 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:25:31.734074 139947463223296 dqn_agent.py:283] 	 seed: 1631273131733256
I0910 11:25:31.735617 139947463223296 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:25:31.735725 139947463223296 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:25:31.735794 139947463223296 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:25:31.735854 139947463223296 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:25:31.735904 139947463223296 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:25:31.735969 139947463223296 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:25:31.736045 139947463223296 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:25:31.736120 139947463223296 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:25:31.736190 139947463223296 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:25:31.759041 139947463223296 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:25:31.777981 139947463223296 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:25:31.778107 139947463223296 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:25:31.778172 139947463223296 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:25:31.778248 139947463223296 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:25:31.778306 139947463223296 dqn_agent.py:275] 	 update_period: 4
I0910 11:25:31.778357 139947463223296 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:25:31.778412 139947463223296 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:25:31.778528 139947463223296 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:25:31.778582 139947463223296 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:25:31.778651 139947463223296 dqn_agent.py:280] 	 optimizer: adam
I0910 11:25:31.778719 139947463223296 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:25:31.778787 139947463223296 dqn_agent.py:283] 	 seed: 1631273131777954
I0910 11:25:31.780143 139947463223296 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:25:31.780251 139947463223296 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:25:31.780337 139947463223296 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:25:31.780411 139947463223296 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:25:31.780466 139947463223296 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:25:31.780521 139947463223296 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:25:31.780590 139947463223296 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:25:31.780671 139947463223296 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:25:31.780742 139947463223296 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:25:31.799460 139947463223296 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:25:31.813637 139947463223296 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:25:31.813769 139947463223296 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 912003.48
I0910 11:25:31.814978 139947463223296 replay_runner.py:39] Average training steps per second: 912003.48
I0910 11:25:32.567455 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:25:32.614047 139947463223296 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 886370.25
I0910 11:25:32.615396 139947463223296 replay_runner.py:39] Average training steps per second: 886370.25
I0910 11:25:32.780159 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:25:32.821643 139947463223296 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 813953.81
I0910 11:25:32.823122 139947463223296 replay_runner.py:39] Average training steps per second: 813953.81
I0910 11:25:33.000009 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:25:33.045164 139947463223296 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 792275.03
I0910 11:25:33.046700 139947463223296 replay_runner.py:39] Average training steps per second: 792275.03
I0910 11:25:33.223663 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 4
I0910 11:25:33.267516 139947463223296 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 820161.13
I0910 11:25:33.268949 139947463223296 replay_runner.py:39] Average training steps per second: 820161.13
I0910 11:25:33.434294 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:25:33.476126 139947463223296 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 797547.82
I0910 11:25:33.477606 139947463223296 replay_runner.py:39] Average training steps per second: 797547.82
I0910 11:25:33.638042 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:25:33.678996 139947463223296 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 700802.67
I0910 11:25:33.680669 139947463223296 replay_runner.py:39] Average training steps per second: 700802.67
I0910 11:25:33.876461 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:25:33.918002 139947463223296 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 882454.03
I0910 11:25:33.919355 139947463223296 replay_runner.py:39] Average training steps per second: 882454.03
I0910 11:25:34.084009 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:25:34.125000 139947463223296 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 880971.22
I0910 11:25:34.126347 139947463223296 replay_runner.py:39] Average training steps per second: 880971.22
I0910 11:25:34.292394 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:25:34.332808 139947463223296 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 886932.54
I0910 11:25:34.334156 139947463223296 replay_runner.py:39] Average training steps per second: 886932.54
I0910 11:25:34.502162 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:25:34.545669 139947463223296 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 843076.18
I0910 11:25:34.547092 139947463223296 replay_runner.py:39] Average training steps per second: 843076.18
I0910 11:25:34.708959 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:25:34.750973 139947463223296 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 789739.03
I0910 11:25:34.752474 139947463223296 replay_runner.py:39] Average training steps per second: 789739.03
I0910 11:25:34.921904 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:25:34.963079 139947463223296 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 817443.77
I0910 11:25:34.964511 139947463223296 replay_runner.py:39] Average training steps per second: 817443.77
I0910 11:25:35.123576 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:25:35.165452 139947463223296 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 891077.97
I0910 11:25:35.166782 139947463223296 replay_runner.py:39] Average training steps per second: 891077.97
I0910 11:25:35.335636 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:25:35.377953 139947463223296 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 816330.09
I0910 11:25:35.379416 139947463223296 replay_runner.py:39] Average training steps per second: 816330.09
I0910 11:25:35.543737 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:25:35.585726 139947463223296 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 785597.30
I0910 11:25:35.587208 139947463223296 replay_runner.py:39] Average training steps per second: 785597.30
I0910 11:25:35.765364 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:25:35.807914 139947463223296 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 828095.56
I0910 11:25:35.809333 139947463223296 replay_runner.py:39] Average training steps per second: 828095.56
I0910 11:25:35.975602 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:25:36.017455 139947463223296 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 860193.60
I0910 11:25:36.018864 139947463223296 replay_runner.py:39] Average training steps per second: 860193.60
I0910 11:25:36.182967 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:25:36.225087 139947463223296 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 836852.35
I0910 11:25:36.226494 139947463223296 replay_runner.py:39] Average training steps per second: 836852.35
I0910 11:25:36.397763 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:25:36.439824 139947463223296 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 790185.38
I0910 11:25:36.441303 139947463223296 replay_runner.py:39] Average training steps per second: 790185.38
I0910 11:25:36.605930 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:25:36.648837 139947463223296 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 738303.82
I0910 11:25:36.650441 139947463223296 replay_runner.py:39] Average training steps per second: 738303.82
I0910 11:25:36.845254 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:25:36.892576 139947463223296 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 706587.60
I0910 11:25:36.894258 139947463223296 replay_runner.py:39] Average training steps per second: 706587.60
I0910 11:25:37.085975 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:25:37.127358 139947463223296 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 693388.00

Done fixed training!Episode length: 600 Return: -600.0
I0910 11:25:37.320889 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:25:37.362162 139947463223296 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 685567.83
I0910 11:25:37.363871 139947463223296 replay_runner.py:39] Average training steps per second: 685567.83
I0910 11:25:37.550353 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:25:37.591693 139947463223296 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 783103.81
I0910 11:25:37.593187 139947463223296 replay_runner.py:39] Average training steps per second: 783103.81
I0910 11:25:37.790658 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:25:37.830621 139947463223296 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 802737.61
I0910 11:25:37.832075 139947463223296 replay_runner.py:39] Average training steps per second: 802737.61
I0910 11:25:37.991679 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:25:38.034437 139947463223296 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 798306.81
I0910 11:25:38.035928 139947463223296 replay_runner.py:39] Average training steps per second: 798306.81
I0910 11:25:38.197599 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:25:38.239101 139947463223296 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 878020.51
I0910 11:25:38.240448 139947463223296 replay_runner.py:39] Average training steps per second: 878020.51
I0910 11:25:38.410766 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:25:38.451575 139947463223296 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 780335.63
I0910 11:25:38.453083 139947463223296 replay_runner.py:39] Average training steps per second: 780335.63
I0910 11:25:38.616171 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:25:38.659624 139947463223296 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 768469.04
I0910 11:25:38.661208 139947463223296 replay_runner.py:39] Average training steps per second: 768469.04
I0910 11:25:38.832524 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00