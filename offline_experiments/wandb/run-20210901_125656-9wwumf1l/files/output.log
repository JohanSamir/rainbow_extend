Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 12:57:03.376949 139675548379136 run_experiment.py:549] Creating TrainRunner ...
I0901 12:57:03.387884 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:57:03.388095 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:57:03.388207 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:57:03.388315 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:57:03.388450 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 12:57:03.388510 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:57:03.388596 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:57:03.388659 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:57:03.388741 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:57:03.388811 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 12:57:03.388882 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:57:03.388954 139675548379136 dqn_agent.py:283] 	 seed: 1630501023387831
I0901 12:57:03.391534 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:57:03.391772 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:57:03.391962 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:57:03.392103 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:57:03.392225 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:57:03.392345 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:57:03.392479 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:57:03.392620 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:57:03.392773 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:57:03.435547 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:57:03.934225 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:57:03.946891 139675548379136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:57:03.956109 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:57:03.956286 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:57:03.956682 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:57:03.956864 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:57:03.956986 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 12:57:03.957257 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:57:03.957545 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:57:03.957690 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:57:03.958009 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:57:03.958186 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 12:57:03.958317 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:57:03.958425 139675548379136 dqn_agent.py:283] 	 seed: 1630501023956064
I0901 12:57:03.961066 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:57:03.961246 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:57:03.961383 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:57:03.961544 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:57:03.961749 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:57:03.961870 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:57:03.962016 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:57:03.962146 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:57:03.962261 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:57:04.001538 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:57:04.025411 139675548379136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:57:04.025797 139675548379136 replay_runner.py:41] Starting iteration 0
Steps executed: 259 Episode length: 259 Return: -258.0
INFO:tensorflow:Average training steps per second: 135.32
I0901 12:57:11.416944 139675548379136 replay_runner.py:36] Average training steps per second: 135.32
I0901 12:57:12.862388 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.49
I0901 12:57:18.334724 139675548379136 replay_runner.py:36] Average training steps per second: 191.49
I0901 12:57:18.759055 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 358 Episode length: 358 Return: -357.0
INFO:tensorflow:Average training steps per second: 196.21
I0901 12:57:24.097448 139675548379136 replay_runner.py:36] Average training steps per second: 196.21
I0901 12:57:24.412560 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.00
INFO:tensorflow:Starting iteration 3

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.87
I0901 12:57:29.898626 139675548379136 replay_runner.py:36] Average training steps per second: 189.87
I0901 12:57:30.335843 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 287 Episode length: 287 Return: -286.0
INFO:tensorflow:Average training steps per second: 189.90
I0901 12:57:35.844081 139675548379136 replay_runner.py:36] Average training steps per second: 189.90
I0901 12:57:36.101432 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -286.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.49
I0901 12:57:41.576465 139675548379136 replay_runner.py:36] Average training steps per second: 191.49
I0901 12:57:42.032026 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:57:42.284468 139675548379136 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 192.31
I0901 12:57:47.484734 139675548379136 replay_runner.py:36] Average training steps per second: 192.31
I0901 12:57:47.925399 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:57:48.173897 139675548379136 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 190.58
I0901 12:57:53.421561 139675548379136 replay_runner.py:36] Average training steps per second: 190.58
I0901 12:57:53.874234 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 12:57:54.126899 139675548379136 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 192.80

Steps executed: 246 Episode length: 147 Return: -146.0
I0901 12:57:59.535991 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 9

Steps executed: 231 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 189.38
I0901 12:58:05.062173 139675548379136 replay_runner.py:36] Average training steps per second: 189.38
I0901 12:58:05.264291 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.31
I0901 12:58:10.792129 139675548379136 replay_runner.py:36] Average training steps per second: 189.31
I0901 12:58:11.244587 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 255 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 190.92
I0901 12:58:16.727059 139675548379136 replay_runner.py:36] Average training steps per second: 190.92
I0901 12:58:16.965338 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 12

Steps executed: 256 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 187.23
I0901 12:58:22.533701 139675548379136 replay_runner.py:36] Average training steps per second: 187.23
I0901 12:58:22.769392 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 13

Steps executed: 211 Episode length: 211 Return: -210.0
INFO:tensorflow:Average training steps per second: 193.16
I0901 12:58:28.175225 139675548379136 replay_runner.py:36] Average training steps per second: 193.16
I0901 12:58:28.358669 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.00
INFO:tensorflow:Starting iteration 14

Steps executed: 254 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 190.55
I0901 12:58:33.841780 139675548379136 replay_runner.py:36] Average training steps per second: 190.55
I0901 12:58:34.056149 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 15

Steps executed: 232 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 188.20
I0901 12:58:39.594690 139675548379136 replay_runner.py:36] Average training steps per second: 188.20
I0901 12:58:39.793412 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 16

Steps executed: 201 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 193.56
I0901 12:58:45.197071 139675548379136 replay_runner.py:36] Average training steps per second: 193.56
I0901 12:58:45.384693 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 17

Steps executed: 223 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 187.17
I0901 12:58:50.977463 139675548379136 replay_runner.py:36] Average training steps per second: 187.17
I0901 12:58:51.164111 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 18

Steps executed: 215 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 190.09
I0901 12:58:56.662996 139675548379136 replay_runner.py:36] Average training steps per second: 190.09
I0901 12:58:56.856550 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 19

Steps executed: 290 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 188.54
I0901 12:59:02.414085 139675548379136 replay_runner.py:36] Average training steps per second: 188.54
I0901 12:59:02.681230 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 20

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.42
I0901 12:59:08.298693 139675548379136 replay_runner.py:36] Average training steps per second: 186.42
I0901 12:59:08.745789 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 236 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 183.17
I0901 12:59:14.455396 139675548379136 replay_runner.py:36] Average training steps per second: 183.17
I0901 12:59:14.662255 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 22

Steps executed: 226 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 192.75
I0901 12:59:20.097626 139675548379136 replay_runner.py:36] Average training steps per second: 192.75
I0901 12:59:20.298572 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 23

Steps executed: 211 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 186.24
I0901 12:59:25.915460 139675548379136 replay_runner.py:36] Average training steps per second: 186.24
I0901 12:59:26.100682 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.50
INFO:tensorflow:Starting iteration 24
I0901 12:59:26.350356 139675548379136 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 188.18

Steps executed: 229 Episode length: 133 Return: -132.0
I0901 12:59:31.879004 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 25

Steps executed: 163 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 191.08
I0901 12:59:37.378483 139675548379136 replay_runner.py:36] Average training steps per second: 191.08
I0901 12:59:37.594852 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 26


Steps executed: 216 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 184.62
I0901 12:59:43.251889 139675548379136 replay_runner.py:36] Average training steps per second: 184.62
I0901 12:59:43.430699 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 27

Steps executed: 282 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 188.50
I0901 12:59:48.968108 139675548379136 replay_runner.py:36] Average training steps per second: 188.50
I0901 12:59:49.199015 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 28

Steps executed: 263 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 191.19
I0901 12:59:54.660058 139675548379136 replay_runner.py:36] Average training steps per second: 191.19
I0901 12:59:54.889268 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 29
I0901 12:59:55.145473 139675548379136 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 194.91
I0901 13:00:00.276310 139675548379136 replay_runner.py:36] Average training steps per second: 194.91

Done fixed training!Episode length: 292 Return: -291.0