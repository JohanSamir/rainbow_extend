Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0901 12:28:35.038596 139675548379136 run_experiment.py:549] Creating TrainRunner ...
I0901 12:28:35.049154 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:35.049414 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:35.049525 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:35.049611 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:35.049691 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:35.049768 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:35.049844 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:35.049897 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:35.049950 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:35.050006 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:35.050057 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:35.050122 139675548379136 dqn_agent.py:283] 	 seed: 1630499315049079
I0901 12:28:35.053491 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:35.053791 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:35.053958 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:35.054167 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:35.054400 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:35.054557 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:35.054738 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:35.054900 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:35.054994 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:35.138864 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:35.617352 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:35.633361 139675548379136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:28:35.642945 139675548379136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:28:35.643125 139675548379136 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:28:35.643240 139675548379136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:28:35.643305 139675548379136 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:28:35.643411 139675548379136 dqn_agent.py:275] 	 update_period: 4
I0901 12:28:35.643475 139675548379136 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:28:35.643527 139675548379136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:28:35.643625 139675548379136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:28:35.643720 139675548379136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:28:35.643857 139675548379136 dqn_agent.py:280] 	 optimizer: adam
I0901 12:28:35.644024 139675548379136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:28:35.644189 139675548379136 dqn_agent.py:283] 	 seed: 1630499315642900
I0901 12:28:35.647433 139675548379136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:28:35.647708 139675548379136 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:28:35.648000 139675548379136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:28:35.648157 139675548379136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:28:35.648274 139675548379136 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:28:35.648391 139675548379136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:28:35.648643 139675548379136 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:28:35.648773 139675548379136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:28:35.648855 139675548379136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:28:35.684615 139675548379136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:28:35.707844 139675548379136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:28:35.708141 139675548379136 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 143.85
I0901 12:28:42.660319 139675548379136 replay_runner.py:36] Average training steps per second: 143.85
I0901 12:28:44.244253 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:28:44.489780 139675548379136 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 193.26
I0901 12:28:49.664588 139675548379136 replay_runner.py:36] Average training steps per second: 193.26
I0901 12:28:50.096535 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:28:50.316426 139675548379136 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.82
I0901 12:28:55.503083 139675548379136 replay_runner.py:36] Average training steps per second: 192.82
I0901 12:28:55.942442 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:28:56.181815 139675548379136 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 192.96
I0901 12:29:01.364681 139675548379136 replay_runner.py:36] Average training steps per second: 192.96
I0901 12:29:01.801131 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:29:02.056214 139675548379136 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 194.41
I0901 12:29:07.200237 139675548379136 replay_runner.py:36] Average training steps per second: 194.41
I0901 12:29:07.614329 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:29:07.858439 139675548379136 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 197.13
I0901 12:29:12.931653 139675548379136 replay_runner.py:36] Average training steps per second: 197.13
I0901 12:29:13.348732 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:29:13.582024 139675548379136 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.39
I0901 12:29:18.700649 139675548379136 replay_runner.py:36] Average training steps per second: 195.39
I0901 12:29:19.129919 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 177 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 189.79

Steps executed: 438 Episode length: 261 Return: -260.0
I0901 12:29:25.021312 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.27
I0901 12:29:30.437365 139675548379136 replay_runner.py:36] Average training steps per second: 193.27
I0901 12:29:30.880538 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 274 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 196.57
I0901 12:29:36.214636 139675548379136 replay_runner.py:36] Average training steps per second: 196.57
I0901 12:29:36.434668 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.06
I0901 12:29:41.740361 139675548379136 replay_runner.py:36] Average training steps per second: 197.06
I0901 12:29:42.164917 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 298 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 194.46
I0901 12:29:47.541158 139675548379136 replay_runner.py:36] Average training steps per second: 194.46
I0901 12:29:47.788985 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.33
INFO:tensorflow:Starting iteration 12
I0901 12:29:48.042613 139675548379136 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 194.40

Steps executed: 265 Episode length: 102 Return: -101.0
I0901 12:29:53.398945 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 13

Steps executed: 281 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 198.23
I0901 12:29:58.684505 139675548379136 replay_runner.py:36] Average training steps per second: 198.23
I0901 12:29:58.921122 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 14

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.81
I0901 12:30:04.266307 139675548379136 replay_runner.py:36] Average training steps per second: 195.81
I0901 12:30:04.678543 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15

Steps executed: 254 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 200.83
I0901 12:30:09.955835 139675548379136 replay_runner.py:36] Average training steps per second: 200.83
I0901 12:30:10.173894 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 16

Steps executed: 264 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 196.38
I0901 12:30:15.507272 139675548379136 replay_runner.py:36] Average training steps per second: 196.38
I0901 12:30:15.735410 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00
INFO:tensorflow:Starting iteration 17
I0901 12:30:15.986194 139675548379136 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 199.39
I0901 12:30:21.001904 139675548379136 replay_runner.py:36] Average training steps per second: 199.39

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 18
I0901 12:30:21.720064 139675548379136 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 192.82
I0901 12:30:26.906551 139675548379136 replay_runner.py:36] Average training steps per second: 192.82
I0901 12:30:27.154443 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.00
INFO:tensorflow:Starting iteration 19


Steps executed: 275 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 193.84
I0901 12:30:32.559123 139675548379136 replay_runner.py:36] Average training steps per second: 193.84
I0901 12:30:32.810883 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 20

Steps executed: 265 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 196.97
I0901 12:30:38.128920 139675548379136 replay_runner.py:36] Average training steps per second: 196.97
I0901 12:30:38.352855 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 21

Steps executed: 246 Episode length: 73 Return: -72.000
INFO:tensorflow:Average training steps per second: 192.22
I0901 12:30:43.793715 139675548379136 replay_runner.py:36] Average training steps per second: 192.22
I0901 12:30:44.000444 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 22
I0901 12:30:44.246623 139675548379136 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.45

Steps executed: 272 Episode length: 185 Return: -184.0
I0901 12:30:49.508407 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 23

Steps executed: 308 Episode length: 134 Return: -133.0
INFO:tensorflow:Average training steps per second: 201.28
I0901 12:30:54.713327 139675548379136 replay_runner.py:36] Average training steps per second: 201.28
I0901 12:30:54.956011 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 24

Steps executed: 273 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 207.02
I0901 12:31:00.075877 139675548379136 replay_runner.py:36] Average training steps per second: 207.02
I0901 12:31:00.308599 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 25
I0901 12:31:00.564556 139675548379136 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 205.51

Steps executed: 221 Episode length: 109 Return: -108.0
I0901 12:31:05.611760 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 26

Steps executed: 254 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 197.87
I0901 12:31:10.902879 139675548379136 replay_runner.py:36] Average training steps per second: 197.87
I0901 12:31:11.144354 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 27

Steps executed: 424 Episode length: 244 Return: -243.0
INFO:tensorflow:Average training steps per second: 196.45
I0901 12:31:16.479425 139675548379136 replay_runner.py:36] Average training steps per second: 196.45
I0901 12:31:16.834248 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.33
INFO:tensorflow:Starting iteration 28

Steps executed: 221 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 194.52
I0901 12:31:22.220651 139675548379136 replay_runner.py:36] Average training steps per second: 194.52
I0901 12:31:22.378997 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 29
I0901 12:31:22.605091 139675548379136 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 201.58

Done fixed training!Episode length: 73 Return: -72.0.0
I0901 12:31:27.784392 139675548379136 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.00