Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 00:00:10.202318 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:00:10.213760 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:00:10.213961 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:00:10.214085 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:00:10.214164 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:00:10.214223 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:00:10.214278 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:00:10.214375 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:00:10.214432 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:00:10.214500 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:00:10.214593 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:00:10.214682 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:00:10.214798 140053067847680 dqn_agent.py:283] 	 seed: 1630540810213709
I0902 00:00:10.218188 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:00:10.218458 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:00:10.218666 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:00:10.218912 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:00:10.219029 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:00:10.219249 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:00:10.219481 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:00:10.219607 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:00:10.219683 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:00:10.255259 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:10.626523 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:10.640552 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:00:10.651059 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:00:10.651344 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:00:10.651462 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:00:10.651571 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:00:10.651689 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:00:10.651795 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:00:10.651877 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:00:10.651950 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:00:10.652032 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:00:10.652101 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:00:10.652238 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:00:10.652534 140053067847680 dqn_agent.py:283] 	 seed: 1630540810650988
I0902 00:00:10.655141 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:00:10.655304 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:00:10.655463 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:00:10.655656 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:00:10.655761 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:00:10.655838 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:00:10.655919 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:00:10.656053 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:00:10.656187 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:00:10.700111 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:00:11.143244 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:00:11.143492 140053067847680 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.53
I0902 00:00:17.148892 140053067847680 replay_runner.py:36] Average training steps per second: 166.53
Steps executed: 231 Episode length: 136 Return: -218.5203440654145
I0902 00:00:18.438226 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.21
INFO:tensorflow:Starting iteration 1

Steps executed: 348 Episode length: 150 Return: -469.1197546426499
INFO:tensorflow:Average training steps per second: 226.76
I0902 00:00:27.252692 140053067847680 replay_runner.py:36] Average training steps per second: 226.76
I0902 00:00:27.548343 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.98
INFO:tensorflow:Starting iteration 2

Steps executed: 286 Episode length: 170 Return: -595.23715672170214
INFO:tensorflow:Average training steps per second: 222.17
I0902 00:00:36.498149 140053067847680 replay_runner.py:36] Average training steps per second: 222.17
I0902 00:00:36.770629 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.20
INFO:tensorflow:Starting iteration 3
I0902 00:00:41.175114 140053067847680 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 212.84

Steps executed: 693 Episode length: 693 Return: -434.46996980771297
I0902 00:00:47.430359 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.47
INFO:tensorflow:Starting iteration 4
I0902 00:00:51.699043 140053067847680 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 215.06

Steps executed: 1000 Episode length: 1000 Return: -148.0949060896334
I0902 00:00:59.103347 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -148.09
INFO:tensorflow:Starting iteration 5
I0902 00:01:03.437831 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.46

Steps executed: 963 Episode length: 963 Return: -318.271379145575134
I0902 00:01:11.563141 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.27
INFO:tensorflow:Starting iteration 6

Steps executed: 273 Episode length: 273 Return: -33.4065259480668154
INFO:tensorflow:Average training steps per second: 218.37
I0902 00:01:20.496795 140053067847680 replay_runner.py:36] Average training steps per second: 218.37
I0902 00:01:20.806452 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -33.41
INFO:tensorflow:Starting iteration 7
I0902 00:01:25.057367 140053067847680 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 225.63

Steps executed: 1000 Episode length: 1000 Return: -193.45124714555652
I0902 00:01:32.703386 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.45
INFO:tensorflow:Starting iteration 8
I0902 00:01:36.876321 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 219.16

Steps executed: 1000 Episode length: 1000 Return: -154.69571611850515
I0902 00:01:44.979644 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.70
INFO:tensorflow:Starting iteration 9
I0902 00:01:49.237559 140053067847680 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 227.31

Steps executed: 651 Episode length: 651 Return: -236.4315930604463215
I0902 00:01:55.557644 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -236.43
INFO:tensorflow:Starting iteration 10
I0902 00:01:59.914191 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.99

Steps executed: 1000 Episode length: 1000 Return: -169.97984957104515
I0902 00:02:07.437453 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.98
INFO:tensorflow:Starting iteration 11
I0902 00:02:11.734066 140053067847680 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 229.40

Steps executed: 1000 Episode length: 1000 Return: -45.531264351811415
I0902 00:02:19.680497 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -45.53
INFO:tensorflow:Starting iteration 12
I0902 00:02:23.926065 140053067847680 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 217.21

Steps executed: 1000 Episode length: 1000 Return: -245.61414555911745
I0902 00:02:31.667946 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -245.61
INFO:tensorflow:Starting iteration 13
I0902 00:02:35.779276 140053067847680 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 217.79

Steps executed: 1000 Episode length: 1000 Return: -176.58708110871498
I0902 00:02:42.803622 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.59
INFO:tensorflow:Starting iteration 14
I0902 00:02:46.901875 140053067847680 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 227.98

Steps executed: 1000 Episode length: 1000 Return: -197.03842231743954
I0902 00:02:53.828198 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.04
INFO:tensorflow:Starting iteration 15
I0902 00:02:58.101789 140053067847680 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 230.26

Steps executed: 1000 Episode length: 1000 Return: -281.38672346393935
I0902 00:03:05.858562 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.39
INFO:tensorflow:Starting iteration 16

Steps executed: 474 Episode length: 474 Return: -285.9322653934625935
INFO:tensorflow:Average training steps per second: 217.96
I0902 00:03:14.715385 140053067847680 replay_runner.py:36] Average training steps per second: 217.96
I0902 00:03:15.524047 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.93
INFO:tensorflow:Starting iteration 17
I0902 00:03:19.847916 140053067847680 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 225.88

Steps executed: 420 Episode length: 276 Return: -412.8658901676451535
I0902 00:03:24.715498 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.53
INFO:tensorflow:Starting iteration 18

Steps executed: 434 Episode length: 316 Return: -270.2915706004248535
INFO:tensorflow:Average training steps per second: 224.18
I0902 00:03:33.580801 140053067847680 replay_runner.py:36] Average training steps per second: 224.18
I0902 00:03:34.133569 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.21
INFO:tensorflow:Starting iteration 19

Steps executed: 287 Episode length: 136 Return: -531.4631956541582535
INFO:tensorflow:Average training steps per second: 231.36
I0902 00:03:42.842664 140053067847680 replay_runner.py:36] Average training steps per second: 231.36
I0902 00:03:43.101435 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -419.85
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 148 Return: -263.2195771116278535
INFO:tensorflow:Average training steps per second: 223.70
I0902 00:03:52.109086 140053067847680 replay_runner.py:36] Average training steps per second: 223.70
I0902 00:03:52.338678 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.67
INFO:tensorflow:Starting iteration 21

Steps executed: 225 Episode length: 99 Return: -557.99187046895128535
INFO:tensorflow:Average training steps per second: 229.01
I0902 00:04:00.915298 140053067847680 replay_runner.py:36] Average training steps per second: 229.01
I0902 00:04:01.133953 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -549.52
INFO:tensorflow:Starting iteration 22

Steps executed: 251 Episode length: 63 Return: -450.99356959644965535
INFO:tensorflow:Average training steps per second: 226.94
I0902 00:04:09.988030 140053067847680 replay_runner.py:36] Average training steps per second: 226.94
I0902 00:04:10.191619 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.78
INFO:tensorflow:Starting iteration 23

Steps executed: 262 Episode length: 65 Return: -622.32905438239135535
INFO:tensorflow:Average training steps per second: 225.00
I0902 00:04:19.048118 140053067847680 replay_runner.py:36] Average training steps per second: 225.00
I0902 00:04:19.281061 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -572.78
INFO:tensorflow:Starting iteration 24

Steps executed: 219 Episode length: 76 Return: -496.22878822999535535
INFO:tensorflow:Average training steps per second: 229.38
I0902 00:04:28.083233 140053067847680 replay_runner.py:36] Average training steps per second: 229.38
I0902 00:04:28.256245 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.45
INFO:tensorflow:Starting iteration 25

Steps executed: 250 Episode length: 70 Return: -388.90326280136442535
INFO:tensorflow:Average training steps per second: 226.24
I0902 00:04:36.943466 140053067847680 replay_runner.py:36] Average training steps per second: 226.24
I0902 00:04:37.138473 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.36
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 57 Return: -346.34429894556393535
INFO:tensorflow:Average training steps per second: 226.71
I0902 00:04:45.908957 140053067847680 replay_runner.py:36] Average training steps per second: 226.71
I0902 00:04:46.081248 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -471.17
INFO:tensorflow:Starting iteration 27

Steps executed: 270 Episode length: 72 Return: -503.10879135496513535
INFO:tensorflow:Average training steps per second: 230.50
I0902 00:04:54.756228 140053067847680 replay_runner.py:36] Average training steps per second: 230.50
I0902 00:04:54.986769 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.22
INFO:tensorflow:Starting iteration 28

Steps executed: 262 Episode length: 124 Return: -320.6277664064272735
INFO:tensorflow:Average training steps per second: 230.65
I0902 00:05:03.568215 140053067847680 replay_runner.py:36] Average training steps per second: 230.65
I0902 00:05:03.796691 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -461.49
INFO:tensorflow:Starting iteration 29

Steps executed: 203 Episode length: 54 Return: -352.35599597465992735
INFO:tensorflow:Average training steps per second: 222.80
I0902 00:05:12.650691 140053067847680 replay_runner.py:36] Average training steps per second: 222.80

Done fixed training!Episode length: 54 Return: -352.35599597465992735