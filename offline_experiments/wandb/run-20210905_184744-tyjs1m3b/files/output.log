I0905 18:47:51.562766 140074183452672 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.563286 140074183452672 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.633532 140074183452672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.634675 140074183452672 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.634786 140074183452672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.634922 140074183452672 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.635072 140074183452672 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.635138 140074183452672 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:51.635211 140074183452672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.635286 140074183452672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.635356 140074183452672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.635437 140074183452672 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.635512 140074183452672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.635575 140074183452672 dqn_agent.py:283] 	 seed: 1630867671633474
I0905 18:47:51.637295 140074183452672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.637437 140074183452672 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:51.637509 140074183452672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.637570 140074183452672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.637626 140074183452672 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.637688 140074183452672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.637761 140074183452672 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.637850 140074183452672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.637915 140074183452672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.808631 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0905 18:47:53.129208 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.156490 140074183452672 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:53.162439 140074183452672 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:53.162585 140074183452672 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:53.162657 140074183452672 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:53.162715 140074183452672 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:53.162768 140074183452672 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:53.162844 140074183452672 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:53.162930 140074183452672 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:53.162999 140074183452672 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:53.163066 140074183452672 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:53.163133 140074183452672 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:53.163199 140074183452672 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:53.163279 140074183452672 dqn_agent.py:283] 	 seed: 1630867673162408
I0905 18:47:53.164733 140074183452672 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:53.164852 140074183452672 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:53.164930 140074183452672 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:53.164993 140074183452672 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:53.165048 140074183452672 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:53.165138 140074183452672 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:53.165207 140074183452672 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:53.165265 140074183452672 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:53.165342 140074183452672 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:53.179821 140074183452672 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:53.189377 140074183452672 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:53.189526 140074183452672 replay_runner.py:41] Starting iteration 0
Steps executed: 167 Episode length: 83 Return: -464.2620333064755
INFO:tensorflow:Average training steps per second: 315.85

Steps executed: 390 Episode length: 223 Return: -95.21379825836917
I0905 18:47:57.122399 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.92
INFO:tensorflow:Starting iteration 1

Steps executed: 266 Episode length: 266 Return: -83.14631251645388
INFO:tensorflow:Average training steps per second: 419.67
I0905 18:48:02.588580 140074183452672 replay_runner.py:36] Average training steps per second: 419.67
I0905 18:48:02.756158 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.15
INFO:tensorflow:Starting iteration 2

Steps executed: 384 Episode length: 244 Return: -98.14969697642911
INFO:tensorflow:Average training steps per second: 410.03
I0905 18:48:08.268930 140074183452672 replay_runner.py:36] Average training steps per second: 410.03
I0905 18:48:08.463491 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.48
INFO:tensorflow:Starting iteration 3

Steps executed: 213 Episode length: 213 Return: -284.0045932825661
INFO:tensorflow:Average training steps per second: 410.59
I0905 18:48:13.996383 140074183452672 replay_runner.py:36] Average training steps per second: 410.59
I0905 18:48:14.120825 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.00
INFO:tensorflow:Starting iteration 4

Steps executed: 247 Episode length: 124 Return: -217.66031244017432
INFO:tensorflow:Average training steps per second: 415.51
I0905 18:48:19.622178 140074183452672 replay_runner.py:36] Average training steps per second: 415.51
I0905 18:48:19.753739 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.43
INFO:tensorflow:Starting iteration 5

Steps executed: 258 Episode length: 138 Return: -67.454362936432892
INFO:tensorflow:Average training steps per second: 412.01
I0905 18:48:25.289390 140074183452672 replay_runner.py:36] Average training steps per second: 412.01
I0905 18:48:25.401432 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.47
INFO:tensorflow:Starting iteration 6

Steps executed: 324 Episode length: 179 Return: -260.59498412961982
INFO:tensorflow:Average training steps per second: 415.06
I0905 18:48:30.891430 140074183452672 replay_runner.py:36] Average training steps per second: 415.06
I0905 18:48:31.039224 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.82
INFO:tensorflow:Starting iteration 7

Steps executed: 287 Episode length: 144 Return: -284.81396869241125
INFO:tensorflow:Average training steps per second: 401.97
I0905 18:48:36.601243 140074183452672 replay_runner.py:36] Average training steps per second: 401.97
I0905 18:48:36.733227 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.36
INFO:tensorflow:Starting iteration 8

Steps executed: 288 Episode length: 117 Return: -29.438897640736784
INFO:tensorflow:Average training steps per second: 420.76
I0905 18:48:42.198995 140074183452672 replay_runner.py:36] Average training steps per second: 420.76
I0905 18:48:42.335153 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.56
INFO:tensorflow:Starting iteration 9

Steps executed: 254 Episode length: 121 Return: -194.43751407616412
INFO:tensorflow:Average training steps per second: 413.83
I0905 18:48:47.829746 140074183452672 replay_runner.py:36] Average training steps per second: 413.83
I0905 18:48:47.929001 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.06
INFO:tensorflow:Starting iteration 10

Steps executed: 279 Episode length: 137 Return: -284.46898113612352
INFO:tensorflow:Average training steps per second: 414.30
I0905 18:48:53.461749 140074183452672 replay_runner.py:36] Average training steps per second: 414.30
I0905 18:48:53.578584 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.61
INFO:tensorflow:Starting iteration 11

Steps executed: 207 Episode length: 103 Return: -341.47197461024712
INFO:tensorflow:Average training steps per second: 415.32
I0905 18:48:59.055144 140074183452672 replay_runner.py:36] Average training steps per second: 415.32
I0905 18:48:59.134784 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.14
INFO:tensorflow:Starting iteration 12

Steps executed: 234 Episode length: 234 Return: -378.83804715249732
INFO:tensorflow:Average training steps per second: 412.27
I0905 18:49:04.646947 140074183452672 replay_runner.py:36] Average training steps per second: 412.27
I0905 18:49:04.773751 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -378.84
INFO:tensorflow:Starting iteration 13

Steps executed: 263 Episode length: 263 Return: -278.81763265362772
INFO:tensorflow:Average training steps per second: 415.79
I0905 18:49:10.273002 140074183452672 replay_runner.py:36] Average training steps per second: 415.79
I0905 18:49:10.416449 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.82
INFO:tensorflow:Starting iteration 14

Steps executed: 279 Episode length: 102 Return: -287.00827875663052
INFO:tensorflow:Average training steps per second: 414.63
I0905 18:49:15.908381 140074183452672 replay_runner.py:36] Average training steps per second: 414.63
I0905 18:49:16.031365 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.75
INFO:tensorflow:Starting iteration 15

Steps executed: 333 Episode length: 195 Return: -202.23961455034642
INFO:tensorflow:Average training steps per second: 403.56
I0905 18:49:21.626438 140074183452672 replay_runner.py:36] Average training steps per second: 403.56
I0905 18:49:21.782537 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -426.53
INFO:tensorflow:Starting iteration 16

Steps executed: 304 Episode length: 304 Return: -44.841268617916872
INFO:tensorflow:Average training steps per second: 436.20
I0905 18:49:27.067222 140074183452672 replay_runner.py:36] Average training steps per second: 436.20
I0905 18:49:27.268100 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.84
INFO:tensorflow:Starting iteration 17

Steps executed: 586 Episode length: 478 Return: -500.40006620496492
INFO:tensorflow:Average training steps per second: 293.66
I0905 18:49:33.976795 140074183452672 replay_runner.py:36] Average training steps per second: 293.66
I0905 18:49:34.669332 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.48
INFO:tensorflow:Starting iteration 18

Steps executed: 555 Episode length: 479 Return: -304.24471017439592
INFO:tensorflow:Average training steps per second: 267.05
I0905 18:49:41.881869 140074183452672 replay_runner.py:36] Average training steps per second: 267.05
I0905 18:49:42.488686 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -430.52
INFO:tensorflow:Starting iteration 19

Steps executed: 204 Episode length: 204 Return: -317.01456162662662
INFO:tensorflow:Average training steps per second: 247.58
I0905 18:49:50.685862 140074183452672 replay_runner.py:36] Average training steps per second: 247.58
I0905 18:49:50.860703 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.01
INFO:tensorflow:Starting iteration 20

Steps executed: 362 Episode length: 213 Return: -258.25730027255865
INFO:tensorflow:Average training steps per second: 243.28
I0905 18:49:59.189870 140074183452672 replay_runner.py:36] Average training steps per second: 243.28
I0905 18:49:59.481797 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.66
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 66 Return: -313.196734941556375
INFO:tensorflow:Average training steps per second: 236.96
I0905 18:50:07.946845 140074183452672 replay_runner.py:36] Average training steps per second: 236.96
I0905 18:50:08.156959 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.22
INFO:tensorflow:Starting iteration 22

Steps executed: 298 Episode length: 153 Return: -488.98304997934645
INFO:tensorflow:Average training steps per second: 240.12
I0905 18:50:16.576366 140074183452672 replay_runner.py:36] Average training steps per second: 240.12
I0905 18:50:16.808220 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.63
INFO:tensorflow:Starting iteration 23

Steps executed: 116 Episode length: 116 Return: -664.24604907826865
INFO:tensorflow:Average training steps per second: 239.62

Steps executed: 440 Episode length: 324 Return: -65.740899233473465
I0905 18:50:25.733589 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.99
INFO:tensorflow:Starting iteration 24

Steps executed: 269 Episode length: 269 Return: -16.690944423763465
INFO:tensorflow:Average training steps per second: 240.35
I0905 18:50:34.175521 140074183452672 replay_runner.py:36] Average training steps per second: 240.35
I0905 18:50:34.408236 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -16.69
INFO:tensorflow:Starting iteration 25

Steps executed: 239 Episode length: 154 Return: -315.02912047614274
INFO:tensorflow:Average training steps per second: 239.22
I0905 18:50:42.827722 140074183452672 replay_runner.py:36] Average training steps per second: 239.22
I0905 18:50:43.017852 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -271.22
INFO:tensorflow:Starting iteration 26

Steps executed: 165 Episode length: 165 Return: -193.62708695287031
INFO:tensorflow:Average training steps per second: 239.54

Steps executed: 828 Episode length: 663 Return: -402.78726635820681
I0905 18:50:53.195943 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.21
INFO:tensorflow:Starting iteration 27
I0905 18:50:57.447022 140074183452672 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 239.53

Steps executed: 308 Episode length: 255 Return: -270.90447785397691
I0905 18:51:01.886021 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.21
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 50 Return: -307.355600494752141
INFO:tensorflow:Average training steps per second: 240.85
I0905 18:51:10.274687 140074183452672 replay_runner.py:36] Average training steps per second: 240.85
I0905 18:51:10.414931 140074183452672 run_experiment.py:428] Average undiscounted return per evaluation episode: -530.10
INFO:tensorflow:Starting iteration 29

Steps executed: 234 Episode length: 84 Return: -739.009431027956511
INFO:tensorflow:Average training steps per second: 242.00
I0905 18:51:18.818752 140074183452672 replay_runner.py:36] Average training steps per second: 242.00

Done fixed training!Episode length: 84 Return: -739.009431027956511