I0905 16:25:02.649379 139861514946560 run_experiment.py:549] Creating TrainRunner ...
I0905 16:25:02.656129 139861514946560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:02.656264 139861514946560 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:02.656349 139861514946560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:02.656413 139861514946560 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:02.656470 139861514946560 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:02.656555 139861514946560 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:02.656659 139861514946560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:02.656736 139861514946560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:02.656804 139861514946560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:02.656859 139861514946560 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:02.656910 139861514946560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:25:02.656991 139861514946560 dqn_agent.py:283] 	 seed: 1630859102656096
I0905 16:25:02.658719 139861514946560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:02.658832 139861514946560 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:02.658907 139861514946560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:02.658973 139861514946560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:02.659029 139861514946560 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:02.659081 139861514946560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:02.659192 139861514946560 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:02.659257 139861514946560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:02.659309 139861514946560 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0905 16:25:04.243349 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:04.746532 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:04.764209 139861514946560 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:25:04.776654 139861514946560 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:25:04.776987 139861514946560 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:25:04.777145 139861514946560 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:25:04.777274 139861514946560 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:25:04.777388 139861514946560 dqn_agent.py:275] 	 update_period: 4
I0905 16:25:04.777497 139861514946560 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:25:04.777604 139861514946560 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:25:04.777714 139861514946560 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:25:04.777823 139861514946560 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:25:04.777930 139861514946560 dqn_agent.py:280] 	 optimizer: adam
I0905 16:25:04.778034 139861514946560 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:25:04.778137 139861514946560 dqn_agent.py:283] 	 seed: 1630859104776606
I0905 16:25:04.780907 139861514946560 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:25:04.781064 139861514946560 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:25:04.781185 139861514946560 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:25:04.781308 139861514946560 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:25:04.781418 139861514946560 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:25:04.781525 139861514946560 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:25:04.781672 139861514946560 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:25:04.781787 139861514946560 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:25:04.781912 139861514946560 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:25:04.813857 139861514946560 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:25:04.834848 139861514946560 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:25:04.835170 139861514946560 replay_runner.py:41] Starting iteration 0
Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 230.45
I0905 16:25:09.174983 139861514946560 replay_runner.py:36] Average training steps per second: 230.45
I0905 16:25:09.808728 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.04
INFO:tensorflow:Starting iteration 1

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 343.92
I0905 16:25:12.848830 139861514946560 replay_runner.py:36] Average training steps per second: 343.92
I0905 16:25:12.911172 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 2

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 346.26
I0905 16:25:15.930310 139861514946560 replay_runner.py:36] Average training steps per second: 346.26
I0905 16:25:15.991031 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 351.12
I0905 16:25:18.965900 139861514946560 replay_runner.py:36] Average training steps per second: 351.12
I0905 16:25:19.032369 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 4

Steps executed: 252 Episode length: 64 Return: 64.0
INFO:tensorflow:Average training steps per second: 347.02
I0905 16:25:22.039281 139861514946560 replay_runner.py:36] Average training steps per second: 347.02
I0905 16:25:22.110722 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 63.00
INFO:tensorflow:Starting iteration 5

Steps executed: 278 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 355.52
I0905 16:25:25.050254 139861514946560 replay_runner.py:36] Average training steps per second: 355.52
I0905 16:25:25.142091 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 350.83
I0905 16:25:28.122403 139861514946560 replay_runner.py:36] Average training steps per second: 350.83
I0905 16:25:28.183502 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0905 16:25:28.314381 139861514946560 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 344.59
I0905 16:25:31.216632 139861514946560 replay_runner.py:36] Average training steps per second: 344.59
I0905 16:25:31.277930 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0905 16:25:31.405885 139861514946560 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 341.59
I0905 16:25:34.333608 139861514946560 replay_runner.py:36] Average training steps per second: 341.59
I0905 16:25:34.391967 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0905 16:25:34.520148 139861514946560 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 352.71
I0905 16:25:37.355571 139861514946560 replay_runner.py:36] Average training steps per second: 352.71
I0905 16:25:37.411353 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 323 Episode length: 183 Return: 183.0
INFO:tensorflow:Average training steps per second: 348.69
I0905 16:25:40.403169 139861514946560 replay_runner.py:36] Average training steps per second: 348.69
I0905 16:25:40.500296 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.50
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 354.55
I0905 16:25:43.454524 139861514946560 replay_runner.py:36] Average training steps per second: 354.55
I0905 16:25:43.511721 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 352 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 357.17
I0905 16:25:46.435654 139861514946560 replay_runner.py:36] Average training steps per second: 357.17
I0905 16:25:46.541743 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 352.32
I0905 16:25:49.514910 139861514946560 replay_runner.py:36] Average training steps per second: 352.32
I0905 16:25:49.576659 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 349 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 351.15
I0905 16:25:52.549391 139861514946560 replay_runner.py:36] Average training steps per second: 351.15
I0905 16:25:52.648464 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 15

Steps executed: 356 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 352.95
I0905 16:25:55.606174 139861514946560 replay_runner.py:36] Average training steps per second: 352.95
I0905 16:25:55.711197 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 178.00
INFO:tensorflow:Starting iteration 16
I0905 16:25:55.837286 139861514946560 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 348.05
I0905 16:25:58.710732 139861514946560 replay_runner.py:36] Average training steps per second: 348.05

Steps executed: 302 Episode length: 152 Return: 152.0
INFO:tensorflow:Starting iteration 17

Steps executed: 285 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 355.63
I0905 16:26:01.761024 139861514946560 replay_runner.py:36] Average training steps per second: 355.63
I0905 16:26:01.841254 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 18
I0905 16:26:01.966226 139861514946560 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 347.86

Steps executed: 336 Episode length: 160 Return: 160.0
I0905 16:26:04.950481 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 19

Steps executed: 318 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 350.28
I0905 16:26:07.945744 139861514946560 replay_runner.py:36] Average training steps per second: 350.28
I0905 16:26:08.040887 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 20

Steps executed: 276 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 355.30
I0905 16:26:10.981302 139861514946560 replay_runner.py:36] Average training steps per second: 355.30
I0905 16:26:11.062753 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 21

Steps executed: 301 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 344.98
I0905 16:26:14.090028 139861514946560 replay_runner.py:36] Average training steps per second: 344.98
I0905 16:26:14.183969 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 22

Steps executed: 327 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 356.09
I0905 16:26:17.121689 139861514946560 replay_runner.py:36] Average training steps per second: 356.09
I0905 16:26:17.212280 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 23

Steps executed: 335 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 351.87
I0905 16:26:20.178752 139861514946560 replay_runner.py:36] Average training steps per second: 351.87
I0905 16:26:20.290198 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.50
INFO:tensorflow:Starting iteration 24

Steps executed: 353 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 355.90
I0905 16:26:23.229441 139861514946560 replay_runner.py:36] Average training steps per second: 355.90
I0905 16:26:23.330801 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 25

Steps executed: 338 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 356.04
I0905 16:26:26.268902 139861514946560 replay_runner.py:36] Average training steps per second: 356.04
I0905 16:26:26.377782 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 26

Steps executed: 345 Episode length: 184 Return: 184.0
INFO:tensorflow:Average training steps per second: 354.12
I0905 16:26:29.326719 139861514946560 replay_runner.py:36] Average training steps per second: 354.12
I0905 16:26:29.426675 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 27

Steps executed: 373 Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 358.04
I0905 16:26:32.352497 139861514946560 replay_runner.py:36] Average training steps per second: 358.04
I0905 16:26:32.451768 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 353.34
I0905 16:26:35.406246 139861514946560 replay_runner.py:36] Average training steps per second: 353.34
I0905 16:26:35.467653 139861514946560 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0905 16:26:35.603835 139861514946560 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 344.92
I0905 16:26:38.503293 139861514946560 replay_runner.py:36] Average training steps per second: 344.92

Done fixed training!Episode length: 200 Return: 200.0