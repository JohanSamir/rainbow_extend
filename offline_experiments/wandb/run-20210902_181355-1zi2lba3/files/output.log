Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0902 18:14:01.279010 140613433649152 run_experiment.py:549] Creating TrainRunner ...
I0902 18:14:01.285971 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:01.286105 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:01.286209 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:01.286275 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:01.286359 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:01.286414 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:01.286466 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:01.286519 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:01.286613 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:01.286692 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:01.286745 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:01.286797 140613433649152 dqn_agent.py:283] 	 seed: 1630606441285938
I0902 18:14:01.288909 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:01.289119 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:01.289269 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:01.289359 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:01.289435 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:01.289508 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:01.289622 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:01.289749 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:01.289845 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:01.313900 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:01.573763 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:01.582876 140613433649152 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:14:01.589316 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:14:01.589499 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:14:01.589597 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:14:01.589680 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:14:01.589762 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:14:01.589838 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:14:01.589917 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:14:01.590006 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:14:01.590060 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:14:01.590121 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:14:01.590195 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:14:01.590264 140613433649152 dqn_agent.py:283] 	 seed: 1630606441589277
I0902 18:14:01.592145 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:14:01.592350 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:14:01.592459 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:14:01.592545 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:14:01.592620 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:14:01.592742 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:14:01.592860 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:14:01.592964 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:14:01.593072 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:14:01.613103 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.003125
I0902 18:14:01.629599 140613433649152 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:14:01.629796 140613433649152 replay_runner.py:41] Starting iteration 0
Steps executed: 215 Episode length: 132 Return: -368.10619014678673
INFO:tensorflow:Average training steps per second: 250.54
I0902 18:14:05.621332 140613433649152 replay_runner.py:36] Average training steps per second: 250.54
I0902 18:14:06.333787 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.03
INFO:tensorflow:Starting iteration 1

Steps executed: 293 Episode length: 111 Return: -345.43247112260294
INFO:tensorflow:Average training steps per second: 354.60
I0902 18:14:12.574081 140613433649152 replay_runner.py:36] Average training steps per second: 354.60
I0902 18:14:12.738051 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.21
INFO:tensorflow:Starting iteration 2

Steps executed: 265 Episode length: 136 Return: -315.62083356478757
INFO:tensorflow:Average training steps per second: 347.70
I0902 18:14:19.050642 140613433649152 replay_runner.py:36] Average training steps per second: 347.70
I0902 18:14:19.206443 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.21
INFO:tensorflow:Starting iteration 3

Steps executed: 323 Episode length: 166 Return: -259.78677288658537
INFO:tensorflow:Average training steps per second: 348.24
I0902 18:14:25.569714 140613433649152 replay_runner.py:36] Average training steps per second: 348.24
I0902 18:14:25.764511 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.61
INFO:tensorflow:Starting iteration 4
I0902 18:14:29.269522 140613433649152 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 350.06
I0902 18:14:32.126625 140613433649152 replay_runner.py:36] Average training steps per second: 350.06

Steps executed: 265 Episode length: 129 Return: -135.39338238713538
INFO:tensorflow:Starting iteration 5
I0902 18:14:35.754034 140613433649152 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 346.46

Steps executed: 940 Episode length: 940 Return: -287.98548792031556
I0902 18:14:40.019679 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.99
INFO:tensorflow:Starting iteration 6
I0902 18:14:43.462874 140613433649152 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 354.83
I0902 18:14:46.281446 140613433649152 replay_runner.py:36] Average training steps per second: 354.83

Steps executed: 499 Episode length: 499 Return: -1239.8837480110296
INFO:tensorflow:Starting iteration 7
I0902 18:14:50.221486 140613433649152 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 345.10

Steps executed: 538 Episode length: 538 Return: -262.24277004019546
I0902 18:14:53.834367 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.24
INFO:tensorflow:Starting iteration 8

Steps executed: 496 Episode length: 496 Return: -288.62341421855524
INFO:tensorflow:Average training steps per second: 337.12
I0902 18:15:00.121039 140613433649152 replay_runner.py:36] Average training steps per second: 337.12
I0902 18:15:00.584249 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.62
INFO:tensorflow:Starting iteration 9

Steps executed: 240 Episode length: 240 Return: -184.08338509336484
INFO:tensorflow:Average training steps per second: 328.37
I0902 18:15:06.883985 140613433649152 replay_runner.py:36] Average training steps per second: 328.37
I0902 18:15:07.056256 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.08
INFO:tensorflow:Starting iteration 10
I0902 18:15:10.307292 140613433649152 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 338.29

Steps executed: 656 Episode length: 656 Return: -258.20781295015274
I0902 18:15:14.219547 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -258.21
INFO:tensorflow:Starting iteration 11

Steps executed: 644 Episode length: 644 Return: -191.36480700537774
INFO:tensorflow:Average training steps per second: 336.56
I0902 18:15:20.423365 140613433649152 replay_runner.py:36] Average training steps per second: 336.56
I0902 18:15:21.247138 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.36
INFO:tensorflow:Starting iteration 12

Steps executed: 806 Episode length: 806 Return: -270.25752509383544
INFO:tensorflow:Average training steps per second: 338.15
I0902 18:15:27.494177 140613433649152 replay_runner.py:36] Average training steps per second: 338.15
I0902 18:15:28.471557 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.26
INFO:tensorflow:Starting iteration 13
I0902 18:15:31.710307 140613433649152 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 345.35

Steps executed: 1000 Episode length: 1000 Return: -50.701294227848166
I0902 18:15:35.981808 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -50.70
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 118 Return: -92.03349917279411166
INFO:tensorflow:Average training steps per second: 359.92
I0902 18:15:42.084448 140613433649152 replay_runner.py:36] Average training steps per second: 359.92
I0902 18:15:42.209328 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.25
INFO:tensorflow:Starting iteration 15

Steps executed: 792 Episode length: 792 Return: 125.55137404685732166
INFO:tensorflow:Average training steps per second: 356.91
I0902 18:15:48.452880 140613433649152 replay_runner.py:36] Average training steps per second: 356.91
I0902 18:15:49.369917 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.55
INFO:tensorflow:Starting iteration 16
I0902 18:15:52.781593 140613433649152 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 361.83

Steps executed: 1000 Episode length: 1000 Return: -138.81465246313456
I0902 18:15:58.034201 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.81
INFO:tensorflow:Starting iteration 17

Steps executed: 664 Episode length: 664 Return: -272.2290639794483756
INFO:tensorflow:Average training steps per second: 355.16
I0902 18:16:04.152996 140613433649152 replay_runner.py:36] Average training steps per second: 355.16
I0902 18:16:05.009479 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.23
INFO:tensorflow:Starting iteration 18
I0902 18:16:08.460144 140613433649152 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 369.33

Steps executed: 593 Episode length: 593 Return: -454.2430586410493756
I0902 18:16:12.121140 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.24
INFO:tensorflow:Starting iteration 19

Steps executed: 414 Episode length: 414 Return: -405.0263557620165756
INFO:tensorflow:Average training steps per second: 344.73
I0902 18:16:18.457984 140613433649152 replay_runner.py:36] Average training steps per second: 344.73
I0902 18:16:18.825347 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.03
INFO:tensorflow:Starting iteration 20
I0902 18:16:22.155359 140613433649152 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 341.18

Steps executed: 1000 Episode length: 1000 Return: -90.401603895596376
I0902 18:16:26.785709 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.40
INFO:tensorflow:Starting iteration 21
I0902 18:16:30.022233 140613433649152 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 313.66
I0902 18:16:33.210759 140613433649152 replay_runner.py:36] Average training steps per second: 313.66

Steps executed: 1000 Episode length: 1000 Return: -155.65526817431558
INFO:tensorflow:Starting iteration 22

Steps executed: 355 Episode length: 355 Return: -231.6550777813381858
INFO:tensorflow:Average training steps per second: 352.61
I0902 18:16:41.499826 140613433649152 replay_runner.py:36] Average training steps per second: 352.61
I0902 18:16:41.924449 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -231.66
INFO:tensorflow:Starting iteration 23

Steps executed: 240 Episode length: 126 Return: -124.0555604136029558
INFO:tensorflow:Average training steps per second: 341.88
I0902 18:16:48.224774 140613433649152 replay_runner.py:36] Average training steps per second: 341.88
I0902 18:16:48.360346 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.96
INFO:tensorflow:Starting iteration 24

Steps executed: 229 Episode length: 229 Return: -186.7731052368948558
INFO:tensorflow:Average training steps per second: 345.84
I0902 18:16:54.603883 140613433649152 replay_runner.py:36] Average training steps per second: 345.84
I0902 18:16:54.784884 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.77
INFO:tensorflow:Starting iteration 25

Steps executed: 305 Episode length: 111 Return: -289.2491348303267558
INFO:tensorflow:Average training steps per second: 358.20
I0902 18:17:01.002801 140613433649152 replay_runner.py:36] Average training steps per second: 358.20
I0902 18:17:01.160136 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.64
INFO:tensorflow:Starting iteration 26
I0902 18:17:04.620891 140613433649152 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 363.45
I0902 18:17:07.372624 140613433649152 replay_runner.py:36] Average training steps per second: 363.45

Steps executed: 245 Episode length: 130 Return: -327.7619257544182458
INFO:tensorflow:Starting iteration 27

Steps executed: 309 Episode length: 309 Return: -277.2207259527516558
INFO:tensorflow:Average training steps per second: 349.55
I0902 18:17:13.792522 140613433649152 replay_runner.py:36] Average training steps per second: 349.55
I0902 18:17:14.044622 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.22
INFO:tensorflow:Starting iteration 28

Steps executed: 250 Episode length: 133 Return: -462.3044427239265858
INFO:tensorflow:Average training steps per second: 359.12
I0902 18:17:20.251217 140613433649152 replay_runner.py:36] Average training steps per second: 359.12
I0902 18:17:20.386514 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.17
INFO:tensorflow:Starting iteration 29

Steps executed: 305 Episode length: 158 Return: -463.3569015222217358
INFO:tensorflow:Average training steps per second: 346.30
I0902 18:17:26.660429 140613433649152 replay_runner.py:36] Average training steps per second: 346.30

Done fixed training!Episode length: 158 Return: -463.3569015222217358