Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0902 23:40:54.433202 140369919707136 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:54.444339 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:54.444600 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:54.444771 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:54.444946 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:54.445089 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:54.445195 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:54.445301 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:54.445372 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:54.445438 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:54.445501 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:54.445564 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:54.445626 140369919707136 dqn_agent.py:283] 	 seed: 1630626054444237
I0902 23:40:54.448381 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:54.448608 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:54.448748 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:54.448893 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:54.449012 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:54.449140 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:54.449273 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:54.449404 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:54.449512 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:54.487713 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:54.859574 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:54.875229 140369919707136 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:54.884887 140369919707136 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:54.885220 140369919707136 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:54.885437 140369919707136 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:54.885679 140369919707136 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:54.885911 140369919707136 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:54.886042 140369919707136 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:54.886177 140369919707136 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:54.886306 140369919707136 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:54.886448 140369919707136 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:54.886680 140369919707136 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:54.886827 140369919707136 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:54.886949 140369919707136 dqn_agent.py:283] 	 seed: 1630626054884812
I0902 23:40:54.890311 140369919707136 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:54.890479 140369919707136 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:54.890625 140369919707136 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:54.890730 140369919707136 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:54.890796 140369919707136 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:54.890853 140369919707136 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:54.890906 140369919707136 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:54.890957 140369919707136 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:54.891008 140369919707136 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:54.966029 140369919707136 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:54.991527 140369919707136 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:54.991798 140369919707136 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.72
I0902 23:41:01.026315 140369919707136 replay_runner.py:36] Average training steps per second: 165.72
Steps executed: 227 Episode length: 87 Return: -393.121260338803106
I0902 23:41:02.314716 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.69
INFO:tensorflow:Starting iteration 1

Steps executed: 277 Episode length: 154 Return: -342.21499617062125
INFO:tensorflow:Average training steps per second: 223.10
I0902 23:41:11.182500 140369919707136 replay_runner.py:36] Average training steps per second: 223.10
I0902 23:41:11.445625 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.84
INFO:tensorflow:Starting iteration 2

Steps executed: 315 Episode length: 121 Return: -626.88263674464125
INFO:tensorflow:Average training steps per second: 229.76
I0902 23:41:20.114655 140369919707136 replay_runner.py:36] Average training steps per second: 229.76
I0902 23:41:20.397786 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -635.45
INFO:tensorflow:Starting iteration 3
I0902 23:41:24.761021 140369919707136 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 223.55

Steps executed: 727 Episode length: 727 Return: -110.82138190737955
I0902 23:41:30.887484 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.82
INFO:tensorflow:Starting iteration 4
I0902 23:41:35.385445 140369919707136 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 227.42
I0902 23:41:39.782959 140369919707136 replay_runner.py:36] Average training steps per second: 227.42

Steps executed: 1000 Episode length: 1000 Return: -1.0857202761873623
INFO:tensorflow:Starting iteration 5
I0902 23:41:46.568814 140369919707136 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 219.88

Steps executed: 1000 Episode length: 1000 Return: -44.284524648765223
I0902 23:41:53.614645 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -44.28
INFO:tensorflow:Starting iteration 6

Steps executed: 736 Episode length: 736 Return: -319.6585968671210523
INFO:tensorflow:Average training steps per second: 218.76
I0902 23:42:02.533577 140369919707136 replay_runner.py:36] Average training steps per second: 218.76
I0902 23:42:04.060103 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.66
INFO:tensorflow:Starting iteration 7

Steps executed: 491 Episode length: 491 Return: -194.1298015827972323
INFO:tensorflow:Average training steps per second: 223.56
I0902 23:42:12.803014 140369919707136 replay_runner.py:36] Average training steps per second: 223.56
I0902 23:42:13.565413 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -194.13
INFO:tensorflow:Starting iteration 8

Steps executed: 254 Episode length: 85 Return: -351.31560233658412923
INFO:tensorflow:Average training steps per second: 217.55
I0902 23:42:22.548384 140369919707136 replay_runner.py:36] Average training steps per second: 217.55
I0902 23:42:22.788544 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.23
INFO:tensorflow:Starting iteration 9
I0902 23:42:27.047775 140369919707136 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 217.97

Steps executed: 808 Episode length: 808 Return: -355.7300570990669923
I0902 23:42:34.304942 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.73
INFO:tensorflow:Starting iteration 10

Steps executed: 571 Episode length: 571 Return: -180.6735430503466923
INFO:tensorflow:Average training steps per second: 220.27
I0902 23:42:43.119353 140369919707136 replay_runner.py:36] Average training steps per second: 220.27
I0902 23:42:44.194986 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.67
INFO:tensorflow:Starting iteration 11
I0902 23:42:48.331007 140369919707136 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 222.92

Steps executed: 1000 Episode length: 1000 Return: -157.07800585834735
I0902 23:42:55.810849 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.08
INFO:tensorflow:Starting iteration 12
I0902 23:43:00.080968 140369919707136 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 226.36

Steps executed: 761 Episode length: 761 Return: -408.7855409343894735
I0902 23:43:05.767045 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -408.79
INFO:tensorflow:Starting iteration 13
I0902 23:43:10.138311 140369919707136 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 225.38

Steps executed: 1000 Episode length: 1000 Return: -83.584527405286885
I0902 23:43:17.118150 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.58
INFO:tensorflow:Starting iteration 14

Steps executed: 263 Episode length: 263 Return: -157.0574679589486885
INFO:tensorflow:Average training steps per second: 227.01
I0902 23:43:25.936488 140369919707136 replay_runner.py:36] Average training steps per second: 227.01
I0902 23:43:26.202977 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.06
INFO:tensorflow:Starting iteration 15

Steps executed: 215 Episode length: 215 Return: -193.0777356571742385
INFO:tensorflow:Average training steps per second: 228.27
I0902 23:43:34.960744 140369919707136 replay_runner.py:36] Average training steps per second: 228.27
I0902 23:43:35.184796 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.08
INFO:tensorflow:Starting iteration 16

Steps executed: 217 Episode length: 217 Return: -138.6204524193589485
INFO:tensorflow:Average training steps per second: 228.10
I0902 23:43:43.890041 140369919707136 replay_runner.py:36] Average training steps per second: 228.10
I0902 23:43:44.110021 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.62
INFO:tensorflow:Starting iteration 17
I0902 23:43:48.412812 140369919707136 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 225.71

Steps executed: 227 Episode length: 227 Return: 28.056849416640006485
I0902 23:43:53.065891 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: 28.06
INFO:tensorflow:Starting iteration 18

Steps executed: 219 Episode length: 101 Return: -382.9247277604019485
INFO:tensorflow:Average training steps per second: 230.46
I0902 23:44:01.747664 140369919707136 replay_runner.py:36] Average training steps per second: 230.46
I0902 23:44:01.919584 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -374.65
INFO:tensorflow:Starting iteration 19

Steps executed: 350 Episode length: 193 Return: -750.2844255287571485
INFO:tensorflow:Average training steps per second: 227.17
I0902 23:44:10.701128 140369919707136 replay_runner.py:36] Average training steps per second: 227.17
I0902 23:44:11.069454 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.41
INFO:tensorflow:Starting iteration 20

Steps executed: 204 Episode length: 106 Return: -279.1585746395851485
INFO:tensorflow:Average training steps per second: 224.87
I0902 23:44:19.968503 140369919707136 replay_runner.py:36] Average training steps per second: 224.87
I0902 23:44:20.148066 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -466.05
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 86 Return: -425.87078569683285485
INFO:tensorflow:Average training steps per second: 233.32
I0902 23:44:28.834559 140369919707136 replay_runner.py:36] Average training steps per second: 233.32
I0902 23:44:29.052263 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.74
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 86 Return: -794.53084824058833485
INFO:tensorflow:Average training steps per second: 225.11
I0902 23:44:37.837357 140369919707136 replay_runner.py:36] Average training steps per second: 225.11
I0902 23:44:38.070973 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -601.80
INFO:tensorflow:Starting iteration 23
I0902 23:44:42.261582 140369919707136 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 223.29

Steps executed: 220 Episode length: 126 Return: -378.7928012939702385
I0902 23:44:46.949233 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -549.20
INFO:tensorflow:Starting iteration 24

Steps executed: 208 Episode length: 85 Return: -542.30474655454322385
INFO:tensorflow:Average training steps per second: 220.20
I0902 23:44:55.829461 140369919707136 replay_runner.py:36] Average training steps per second: 220.20
I0902 23:44:56.004081 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.57
INFO:tensorflow:Starting iteration 25
I0902 23:45:00.241123 140369919707136 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 216.12

Steps executed: 243 Episode length: 72 Return: -467.64065343231271485
I0902 23:45:05.100543 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.07
INFO:tensorflow:Starting iteration 26

Steps executed: 221 Episode length: 74 Return: -676.65642872651021485
INFO:tensorflow:Average training steps per second: 218.76
I0902 23:45:14.113238 140369919707136 replay_runner.py:36] Average training steps per second: 218.76
I0902 23:45:14.313106 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -622.93
INFO:tensorflow:Starting iteration 27

Steps executed: 233 Episode length: 125 Return: -583.5799483061907485
INFO:tensorflow:Average training steps per second: 221.55
I0902 23:45:23.204679 140369919707136 replay_runner.py:36] Average training steps per second: 221.55
I0902 23:45:23.412454 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -468.28
INFO:tensorflow:Starting iteration 28

Steps executed: 285 Episode length: 127 Return: -799.2481822765748485
INFO:tensorflow:Average training steps per second: 222.77
I0902 23:45:32.174072 140369919707136 replay_runner.py:36] Average training steps per second: 222.77
I0902 23:45:32.414869 140369919707136 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.34
INFO:tensorflow:Starting iteration 29
I0902 23:45:36.659384 140369919707136 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 233.27
I0902 23:45:40.946748 140369919707136 replay_runner.py:36] Average training steps per second: 233.27


Done fixed training!Episode length: 77 Return: -227.86204150046568485