I0905 16:24:38.852550 140439533856768 run_experiment.py:549] Creating TrainRunner ...
I0905 16:24:38.859578 140439533856768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:38.859734 140439533856768 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:38.859807 140439533856768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:38.859867 140439533856768 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:38.859923 140439533856768 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:38.859976 140439533856768 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:38.860061 140439533856768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:38.860116 140439533856768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:38.860166 140439533856768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:38.860216 140439533856768 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:38.860265 140439533856768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:38.860327 140439533856768 dqn_agent.py:283] 	 seed: 1630859078859539
I0905 16:24:38.862069 140439533856768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:38.862192 140439533856768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:38.862272 140439533856768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:38.862337 140439533856768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:38.862394 140439533856768 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:38.862473 140439533856768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:38.862531 140439533856768 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:38.862627 140439533856768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:38.862713 140439533856768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.312415 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
I0905 16:24:40.626936 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.634763 140439533856768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:24:40.639976 140439533856768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:24:40.640112 140439533856768 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:24:40.640199 140439533856768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:24:40.640271 140439533856768 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:24:40.640361 140439533856768 dqn_agent.py:275] 	 update_period: 4
I0905 16:24:40.640434 140439533856768 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:24:40.640565 140439533856768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:24:40.640629 140439533856768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:24:40.640710 140439533856768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:24:40.640805 140439533856768 dqn_agent.py:280] 	 optimizer: adam
I0905 16:24:40.640877 140439533856768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:24:40.640945 140439533856768 dqn_agent.py:283] 	 seed: 1630859080639951
I0905 16:24:40.642433 140439533856768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:24:40.642544 140439533856768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:24:40.642615 140439533856768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:24:40.642678 140439533856768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:24:40.642737 140439533856768 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:24:40.642795 140439533856768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:24:40.642866 140439533856768 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:24:40.642950 140439533856768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:24:40.643005 140439533856768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:24:40.660724 140439533856768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:24:40.672634 140439533856768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:24:40.672775 140439533856768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 294.02
I0905 16:24:44.074093 140439533856768 replay_runner.py:36] Average training steps per second: 294.02
Steps executed: 210 Episode length: 116 Return: -203.39937995161694
I0905 16:24:44.710064 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.46
INFO:tensorflow:Starting iteration 1

Steps executed: 203 Episode length: 87 Return: -359.934795395853672
INFO:tensorflow:Average training steps per second: 414.25
I0905 16:24:50.290119 140439533856768 replay_runner.py:36] Average training steps per second: 414.25
I0905 16:24:50.372877 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.24
INFO:tensorflow:Starting iteration 2

Steps executed: 232 Episode length: 112 Return: -251.69131774999175
INFO:tensorflow:Average training steps per second: 406.33
I0905 16:24:55.852412 140439533856768 replay_runner.py:36] Average training steps per second: 406.33
I0905 16:24:55.945913 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.58
INFO:tensorflow:Starting iteration 3

Steps executed: 206 Episode length: 107 Return: -177.36134414723256
INFO:tensorflow:Average training steps per second: 319.87
I0905 16:25:02.358121 140439533856768 replay_runner.py:36] Average training steps per second: 319.87
I0905 16:25:02.439233 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.79
INFO:tensorflow:Starting iteration 4

Steps executed: 337 Episode length: 147 Return: -320.35415847928766
INFO:tensorflow:Average training steps per second: 361.11
I0905 16:25:08.702059 140439533856768 replay_runner.py:36] Average training steps per second: 361.11
I0905 16:25:08.852859 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.95
INFO:tensorflow:Starting iteration 5

Steps executed: 275 Episode length: 135 Return: -68.792533302938526
INFO:tensorflow:Average training steps per second: 404.91
I0905 16:25:14.471950 140439533856768 replay_runner.py:36] Average training steps per second: 404.91
I0905 16:25:14.600926 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.40
INFO:tensorflow:Starting iteration 6

Steps executed: 243 Episode length: 243 Return: -222.40060650620404
INFO:tensorflow:Average training steps per second: 396.79
I0905 16:25:20.258528 140439533856768 replay_runner.py:36] Average training steps per second: 396.79
I0905 16:25:20.413176 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -222.40
INFO:tensorflow:Starting iteration 7

Steps executed: 470 Episode length: 399 Return: -218.17403780636054
INFO:tensorflow:Average training steps per second: 410.26
I0905 16:25:25.951780 140439533856768 replay_runner.py:36] Average training steps per second: 410.26
I0905 16:25:26.426094 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.29
INFO:tensorflow:Starting iteration 8

Steps executed: 337 Episode length: 337 Return: -221.25180037340647
INFO:tensorflow:Average training steps per second: 400.26
I0905 16:25:32.092767 140439533856768 replay_runner.py:36] Average training steps per second: 400.26
I0905 16:25:32.364845 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.25
INFO:tensorflow:Starting iteration 9

Steps executed: 204 Episode length: 204 Return: -184.86841982431397
INFO:tensorflow:Average training steps per second: 385.06
I0905 16:25:38.110431 140439533856768 replay_runner.py:36] Average training steps per second: 385.06
I0905 16:25:38.204812 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.87
INFO:tensorflow:Starting iteration 10

Steps executed: 395 Episode length: 285 Return: -278.43183063025057
INFO:tensorflow:Average training steps per second: 386.59
I0905 16:25:43.967276 140439533856768 replay_runner.py:36] Average training steps per second: 386.59
I0905 16:25:44.186830 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.31
INFO:tensorflow:Starting iteration 11

Steps executed: 276 Episode length: 127 Return: -127.94740011778978
INFO:tensorflow:Average training steps per second: 382.12
I0905 16:25:49.966292 140439533856768 replay_runner.py:36] Average training steps per second: 382.12
I0905 16:25:50.077144 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.16
INFO:tensorflow:Starting iteration 12

Steps executed: 430 Episode length: 430 Return: -2798.4569530382878
INFO:tensorflow:Average training steps per second: 407.15
I0905 16:25:55.654195 140439533856768 replay_runner.py:36] Average training steps per second: 407.15
I0905 16:25:55.999563 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -2798.46
INFO:tensorflow:Starting iteration 13

Steps executed: 845 Episode length: 845 Return: -714.82189078787358
INFO:tensorflow:Average training steps per second: 402.72
I0905 16:26:01.594552 140439533856768 replay_runner.py:36] Average training steps per second: 402.72
I0905 16:26:02.608304 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -714.82
INFO:tensorflow:Starting iteration 14

Steps executed: 324 Episode length: 324 Return: -64.504205673378668
INFO:tensorflow:Average training steps per second: 404.51
I0905 16:26:08.206856 140439533856768 replay_runner.py:36] Average training steps per second: 404.51
I0905 16:26:08.465346 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.50
INFO:tensorflow:Starting iteration 15

Steps executed: 260 Episode length: 260 Return: -280.40979376304665
INFO:tensorflow:Average training steps per second: 380.81
I0905 16:26:14.278480 140439533856768 replay_runner.py:36] Average training steps per second: 380.81
I0905 16:26:14.441897 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.41
INFO:tensorflow:Starting iteration 16
I0905 16:26:17.589396 140439533856768 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 389.94

Steps executed: 961 Episode length: 961 Return: -233.50955480105435
I0905 16:26:21.503645 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -233.51
INFO:tensorflow:Starting iteration 17

Steps executed: 322 Episode length: 322 Return: -192.78338493092224
INFO:tensorflow:Average training steps per second: 396.06
I0905 16:26:27.166120 140439533856768 replay_runner.py:36] Average training steps per second: 396.06
I0905 16:26:27.416337 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.78
INFO:tensorflow:Starting iteration 18
I0905 16:26:30.600046 140439533856768 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 404.50

Steps executed: 224 Episode length: 86 Return: -504.120041960470824
I0905 16:26:33.161743 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.04
INFO:tensorflow:Starting iteration 19
I0905 16:26:36.261643 140439533856768 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 407.51
I0905 16:26:38.715857 140439533856768 replay_runner.py:36] Average training steps per second: 407.51

Steps executed: 201 Episode length: 104 Return: -230.85600156382947
INFO:tensorflow:Starting iteration 20
I0905 16:26:41.974171 140439533856768 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 394.77
I0905 16:26:44.507627 140439533856768 replay_runner.py:36] Average training steps per second: 394.77

Steps executed: 396 Episode length: 396 Return: -274.63603420267937
INFO:tensorflow:Starting iteration 21
I0905 16:26:48.154743 140439533856768 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 374.96
I0905 16:26:50.821935 140439533856768 replay_runner.py:36] Average training steps per second: 374.96

Steps executed: 338 Episode length: 263 Return: -216.84253301904624
INFO:tensorflow:Starting iteration 22

Steps executed: 209 Episode length: 209 Return: -21.830382205899014
INFO:tensorflow:Average training steps per second: 308.00
I0905 16:26:57.875723 140439533856768 replay_runner.py:36] Average training steps per second: 308.00
I0905 16:26:58.027456 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -21.83
INFO:tensorflow:Starting iteration 23

Steps executed: 102 Episode length: 102 Return: -512.30097630448244
INFO:tensorflow:Average training steps per second: 327.19

Steps executed: 369 Episode length: 267 Return: -504.24526893921884
I0905 16:27:04.858895 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.27
INFO:tensorflow:Starting iteration 24

Steps executed: 237 Episode length: 57 Return: -277.767942156758824
INFO:tensorflow:Average training steps per second: 299.53
I0905 16:27:11.881900 140439533856768 replay_runner.py:36] Average training steps per second: 299.53
I0905 16:27:12.007889 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.91
INFO:tensorflow:Starting iteration 25

Steps executed: 208 Episode length: 96 Return: -360.831657609559677
INFO:tensorflow:Average training steps per second: 303.63
I0905 16:27:18.998682 140439533856768 replay_runner.py:36] Average training steps per second: 303.63
I0905 16:27:19.118252 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.20
INFO:tensorflow:Starting iteration 26

Steps executed: 345 Episode length: 245 Return: -180.54384034560695
INFO:tensorflow:Average training steps per second: 303.39
I0905 16:27:26.086230 140439533856768 replay_runner.py:36] Average training steps per second: 303.39
I0905 16:27:26.325890 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.43
INFO:tensorflow:Starting iteration 27

Steps executed: 323 Episode length: 146 Return: 11.7349731895306635
INFO:tensorflow:Average training steps per second: 296.02
I0905 16:27:33.388916 140439533856768 replay_runner.py:36] Average training steps per second: 296.02
I0905 16:27:33.591839 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.58
INFO:tensorflow:Starting iteration 28

Steps executed: 247 Episode length: 90 Return: -239.370020573396035
INFO:tensorflow:Average training steps per second: 300.75
I0905 16:27:40.590435 140439533856768 replay_runner.py:36] Average training steps per second: 300.75
I0905 16:27:40.733906 140439533856768 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.51
INFO:tensorflow:Starting iteration 29

Steps executed: 277 Episode length: 100 Return: -168.91739663550825
INFO:tensorflow:Average training steps per second: 301.04
I0905 16:27:47.717359 140439533856768 replay_runner.py:36] Average training steps per second: 301.04

Done fixed training!Episode length: 100 Return: -168.91739663550825