Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0902 00:05:59.186015 140372375062528 run_experiment.py:549] Creating TrainRunner ...
I0902 00:05:59.195287 140372375062528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:59.195568 140372375062528 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:59.195700 140372375062528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:59.195808 140372375062528 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:59.196037 140372375062528 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:59.196210 140372375062528 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:05:59.196342 140372375062528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:59.196477 140372375062528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:59.196608 140372375062528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:59.196731 140372375062528 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:59.196825 140372375062528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:59.196923 140372375062528 dqn_agent.py:283] 	 seed: 1630541159195223
I0902 00:05:59.200000 140372375062528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:59.200192 140372375062528 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:05:59.200329 140372375062528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:59.200461 140372375062528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:59.200572 140372375062528 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:59.200713 140372375062528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:59.200824 140372375062528 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:59.200935 140372375062528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:59.201040 140372375062528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:59.240728 140372375062528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:59.716341 140372375062528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:59.732019 140372375062528 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:05:59.741847 140372375062528 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:05:59.742189 140372375062528 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:05:59.742358 140372375062528 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:05:59.742464 140372375062528 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:05:59.742577 140372375062528 dqn_agent.py:275] 	 update_period: 4
I0902 00:05:59.742822 140372375062528 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:05:59.742976 140372375062528 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:05:59.743097 140372375062528 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:05:59.743207 140372375062528 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:05:59.743483 140372375062528 dqn_agent.py:280] 	 optimizer: adam
I0902 00:05:59.743605 140372375062528 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:05:59.743682 140372375062528 dqn_agent.py:283] 	 seed: 1630541159741785
I0902 00:05:59.746048 140372375062528 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:05:59.746325 140372375062528 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:05:59.746622 140372375062528 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:05:59.746736 140372375062528 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:05:59.746825 140372375062528 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:05:59.746948 140372375062528 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:05:59.747093 140372375062528 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:05:59.747310 140372375062528 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:05:59.747452 140372375062528 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:05:59.780061 140372375062528 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:05:59.802727 140372375062528 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:05:59.803022 140372375062528 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 149.15
I0902 00:06:06.507943 140372375062528 replay_runner.py:36] Average training steps per second: 149.15
Steps executed: 355 Episode length: 355 Return: -354.0
I0902 00:06:07.861683 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.00
INFO:tensorflow:Starting iteration 1

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.25
I0902 00:06:13.072910 140372375062528 replay_runner.py:36] Average training steps per second: 201.25
I0902 00:06:13.486263 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 00:06:13.723137 140372375062528 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 197.12
I0902 00:06:18.796672 140372375062528 replay_runner.py:36] Average training steps per second: 197.12
I0902 00:06:19.206380 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 255 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 203.21
I0902 00:06:24.365283 140372375062528 replay_runner.py:36] Average training steps per second: 203.21
I0902 00:06:24.588125 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.50
INFO:tensorflow:Starting iteration 4

Steps executed: 354 Episode length: 354 Return: -353.0
INFO:tensorflow:Average training steps per second: 201.70
I0902 00:06:29.787538 140372375062528 replay_runner.py:36] Average training steps per second: 201.70
I0902 00:06:30.075356 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.81
I0902 00:06:35.450792 140372375062528 replay_runner.py:36] Average training steps per second: 194.81
I0902 00:06:35.891943 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 00:06:36.109003 140372375062528 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 202.72

Steps executed: 305 Episode length: 305 Return: -304.0
I0902 00:06:41.279001 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.00
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.10
I0902 00:06:46.500901 140372375062528 replay_runner.py:36] Average training steps per second: 200.10
I0902 00:06:46.918388 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 286 Episode length: 286 Return: -285.0
INFO:tensorflow:Average training steps per second: 202.65
I0902 00:06:52.090843 140372375062528 replay_runner.py:36] Average training steps per second: 202.65
I0902 00:06:52.324351 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.08
I0902 00:06:57.687443 140372375062528 replay_runner.py:36] Average training steps per second: 195.08
I0902 00:06:58.117962 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 00:06:58.363512 140372375062528 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 196.95
I0902 00:07:03.441350 140372375062528 replay_runner.py:36] Average training steps per second: 196.95
I0902 00:07:03.860617 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 00:07:04.095902 140372375062528 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 198.84

Steps executed: 307 Episode length: 307 Return: -306.0
I0902 00:07:09.384002 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.00
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.51
I0902 00:07:14.775096 140372375062528 replay_runner.py:36] Average training steps per second: 194.51
I0902 00:07:15.197909 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 252 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 200.84
I0902 00:07:20.420075 140372375062528 replay_runner.py:36] Average training steps per second: 200.84
I0902 00:07:20.621901 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.00
INFO:tensorflow:Starting iteration 14

Steps executed: 269 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 193.63
I0902 00:07:26.032020 140372375062528 replay_runner.py:36] Average training steps per second: 193.63
I0902 00:07:26.281401 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 15
I0902 00:07:26.528908 140372375062528 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 205.54

Steps executed: 275 Episode length: 114 Return: -113.0
I0902 00:07:31.632450 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.67
INFO:tensorflow:Starting iteration 16
I0902 00:07:31.877940 140372375062528 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 191.17

Steps executed: 220 Episode length: 63 Return: -62.0.0
I0902 00:07:37.292385 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.33
INFO:tensorflow:Starting iteration 17

Steps executed: 265 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 208.88
I0902 00:07:42.309758 140372375062528 replay_runner.py:36] Average training steps per second: 208.88
I0902 00:07:42.519623 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 18

Steps executed: 276 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 197.82
I0902 00:07:47.814090 140372375062528 replay_runner.py:36] Average training steps per second: 197.82
I0902 00:07:48.031402 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 19
I0902 00:07:48.265505 140372375062528 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 203.35

Steps executed: 270 Episode length: 84 Return: -83.0.0
I0902 00:07:53.412399 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 20

Steps executed: 216 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 199.99
I0902 00:07:58.638459 140372375062528 replay_runner.py:36] Average training steps per second: 199.99
I0902 00:07:58.828561 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.00
INFO:tensorflow:Starting iteration 21

Steps executed: 295 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 203.99
I0902 00:08:03.979888 140372375062528 replay_runner.py:36] Average training steps per second: 203.99
I0902 00:08:04.239798 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 22

Steps executed: 224 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 199.46
I0902 00:08:09.534741 140372375062528 replay_runner.py:36] Average training steps per second: 199.46
I0902 00:08:09.716486 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 23

Steps executed: 213 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 199.76
I0902 00:08:14.958282 140372375062528 replay_runner.py:36] Average training steps per second: 199.76
I0902 00:08:15.139868 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.00
INFO:tensorflow:Starting iteration 24

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.68
I0902 00:08:20.494449 140372375062528 replay_runner.py:36] Average training steps per second: 195.68
I0902 00:08:20.927953 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 258 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 197.09
I0902 00:08:26.241846 140372375062528 replay_runner.py:36] Average training steps per second: 197.09
I0902 00:08:26.473472 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 26

Steps executed: 254 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 196.83
I0902 00:08:31.811322 140372375062528 replay_runner.py:36] Average training steps per second: 196.83
I0902 00:08:32.036394 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.67
INFO:tensorflow:Starting iteration 27

Steps executed: 191 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 196.94
I0902 00:08:37.405709 140372375062528 replay_runner.py:36] Average training steps per second: 196.94

Steps executed: 267 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Starting iteration 28

Steps executed: 238 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 199.87
I0902 00:08:42.866329 140372375062528 replay_runner.py:36] Average training steps per second: 199.87
I0902 00:08:43.076576 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 205.92
I0902 00:08:48.158918 140372375062528 replay_runner.py:36] Average training steps per second: 205.92
I0902 00:08:48.342409 140372375062528 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.50