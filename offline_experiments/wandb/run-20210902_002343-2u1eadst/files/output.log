Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 00:23:49.611565 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:23:49.620977 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:49.621153 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:49.621268 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:49.621373 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:49.621474 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:49.621531 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:49.621598 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:49.621679 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:49.621764 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:49.621833 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:49.621912 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:49.621971 140053067847680 dqn_agent.py:283] 	 seed: 1630542229620933
I0902 00:23:49.623697 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:49.623812 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:49.623893 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:49.623959 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:49.624047 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:49.624104 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:49.624187 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:49.624255 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:49.624324 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:49.653787 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:49.926267 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:49.936077 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:23:49.942969 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:23:49.943168 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:23:49.943253 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:23:49.943318 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:23:49.943399 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:23:49.943459 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:23:49.943513 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:23:49.943567 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:23:49.943628 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:23:49.943719 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:23:49.943775 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:23:49.943853 140053067847680 dqn_agent.py:283] 	 seed: 1630542229942914
I0902 00:23:49.945481 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:23:49.945613 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:23:49.945700 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:23:49.945770 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:23:49.945841 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:23:49.945904 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:23:49.945992 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:23:49.946093 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:23:49.946181 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:23:49.969561 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:23:49.986175 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:23:49.986396 140053067847680 replay_runner.py:41] Starting iteration 0
Steps executed: 312 Episode length: 165 Return: -593.2983651484394
INFO:tensorflow:Average training steps per second: 246.17
I0902 00:23:54.048979 140053067847680 replay_runner.py:36] Average training steps per second: 246.17
I0902 00:23:54.830034 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.41
INFO:tensorflow:Starting iteration 1
I0902 00:23:58.172473 140053067847680 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 323.81

Steps executed: 300 Episode length: 174 Return: -574.6877364151941
I0902 00:24:01.425243 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -491.88
INFO:tensorflow:Starting iteration 2

Steps executed: 248 Episode length: 248 Return: -441.4296439242392
INFO:tensorflow:Average training steps per second: 332.90
I0902 00:24:07.575739 140053067847680 replay_runner.py:36] Average training steps per second: 332.90
I0902 00:24:07.782732 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -441.43
INFO:tensorflow:Starting iteration 3

Steps executed: 393 Episode length: 248 Return: -271.01927224499764
INFO:tensorflow:Average training steps per second: 340.93
I0902 00:24:13.997558 140053067847680 replay_runner.py:36] Average training steps per second: 340.93
I0902 00:24:14.264758 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.80
INFO:tensorflow:Starting iteration 4
I0902 00:24:17.577657 140053067847680 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 334.12

Steps executed: 1000 Episode length: 1000 Return: -201.44405780225313
I0902 00:24:22.085226 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.44
INFO:tensorflow:Starting iteration 5
I0902 00:24:25.408067 140053067847680 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 344.54

Steps executed: 1000 Episode length: 1000 Return: -5.3359177128951413
I0902 00:24:31.027509 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.34
INFO:tensorflow:Starting iteration 6
I0902 00:24:34.374612 140053067847680 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 337.33

Steps executed: 1000 Episode length: 1000 Return: -29.165029469977934
I0902 00:24:39.383983 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -29.17
INFO:tensorflow:Starting iteration 7

Steps executed: 1000 Episode length: 1000 Return: 3.76572653927819454
INFO:tensorflow:Average training steps per second: 325.66
I0902 00:24:45.718349 140053067847680 replay_runner.py:36] Average training steps per second: 325.66
I0902 00:24:47.261843 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: 3.77
INFO:tensorflow:Starting iteration 8
I0902 00:24:50.588861 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 337.75

Steps executed: 1000 Episode length: 1000 Return: -177.88200621795372
I0902 00:24:55.135283 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.88
INFO:tensorflow:Starting iteration 9
I0902 00:24:58.437167 140053067847680 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 344.39

Steps executed: 1000 Episode length: 1000 Return: -109.23062566165082
I0902 00:25:03.383210 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.23
INFO:tensorflow:Starting iteration 10
I0902 00:25:06.689047 140053067847680 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 343.09

Steps executed: 1000 Episode length: 1000 Return: -115.07494330410218
I0902 00:25:11.912151 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.07
INFO:tensorflow:Starting iteration 11

Steps executed: 286 Episode length: 286 Return: -171.9194048404867218
INFO:tensorflow:Average training steps per second: 347.62
I0902 00:25:17.953634 140053067847680 replay_runner.py:36] Average training steps per second: 347.62
I0902 00:25:18.201091 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.92
INFO:tensorflow:Starting iteration 12
I0902 00:25:21.610193 140053067847680 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 339.32

Steps executed: 1000 Episode length: 1000 Return: -82.849984228980458
I0902 00:25:27.011133 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.85
INFO:tensorflow:Starting iteration 13

Steps executed: 68 Episode length: 68 Return: -32.4508920458849560458
INFO:tensorflow:Average training steps per second: 323.95

Steps executed: 1068 Episode length: 1000 Return: -21.369082940333296
I0902 00:25:35.520838 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.91
INFO:tensorflow:Starting iteration 14

Steps executed: 241 Episode length: 147 Return: -376.1049198665652496
INFO:tensorflow:Average training steps per second: 323.17
I0902 00:25:41.915755 140053067847680 replay_runner.py:36] Average training steps per second: 323.17
I0902 00:25:42.051606 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.73
INFO:tensorflow:Starting iteration 15

Steps executed: 839 Episode length: 839 Return: -327.1531902302687496
INFO:tensorflow:Average training steps per second: 322.47
I0902 00:25:48.449856 140053067847680 replay_runner.py:36] Average training steps per second: 322.47
I0902 00:25:49.755522 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.15
INFO:tensorflow:Starting iteration 16

Steps executed: 708 Episode length: 708 Return: -305.0018686558221496
INFO:tensorflow:Average training steps per second: 331.11
I0902 00:25:56.127953 140053067847680 replay_runner.py:36] Average training steps per second: 331.11
I0902 00:25:56.919932 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.00
INFO:tensorflow:Starting iteration 17

Steps executed: 247 Episode length: 165 Return: -49.37164177229361496
INFO:tensorflow:Average training steps per second: 334.29
I0902 00:26:03.350536 140053067847680 replay_runner.py:36] Average training steps per second: 334.29
I0902 00:26:03.493113 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.40
INFO:tensorflow:Starting iteration 18
I0902 00:26:06.948302 140053067847680 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 336.07
I0902 00:26:09.924212 140053067847680 replay_runner.py:36] Average training steps per second: 336.07

Steps executed: 203 Episode length: 56 Return: -134.37211025863412496
INFO:tensorflow:Starting iteration 19

Steps executed: 207 Episode length: 80 Return: -103.96692217868173496
INFO:tensorflow:Average training steps per second: 337.57
I0902 00:26:16.425650 140053067847680 replay_runner.py:36] Average training steps per second: 337.57
I0902 00:26:16.538742 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.41
INFO:tensorflow:Starting iteration 20

Steps executed: 335 Episode length: 335 Return: -244.1381571322410596
INFO:tensorflow:Average training steps per second: 335.19
I0902 00:26:22.958178 140053067847680 replay_runner.py:36] Average training steps per second: 335.19
I0902 00:26:23.282092 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.14
INFO:tensorflow:Starting iteration 21

Steps executed: 216 Episode length: 64 Return: -150.79638925209346596
INFO:tensorflow:Average training steps per second: 321.66
I0902 00:26:29.759436 140053067847680 replay_runner.py:36] Average training steps per second: 321.66
I0902 00:26:29.864207 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.29
INFO:tensorflow:Starting iteration 22

Steps executed: 320 Episode length: 320 Return: -43.47641504608905596
INFO:tensorflow:Average training steps per second: 320.64
I0902 00:26:36.307017 140053067847680 replay_runner.py:36] Average training steps per second: 320.64
I0902 00:26:36.591005 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -43.48
INFO:tensorflow:Starting iteration 23

Steps executed: 271 Episode length: 138 Return: -91.51631728406344596
INFO:tensorflow:Average training steps per second: 320.97
I0902 00:26:43.036987 140053067847680 replay_runner.py:36] Average training steps per second: 320.97
I0902 00:26:43.201001 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.43
INFO:tensorflow:Starting iteration 24

Steps executed: 237 Episode length: 111 Return: -211.2346793983267696
INFO:tensorflow:Average training steps per second: 328.77
I0902 00:26:49.587249 140053067847680 replay_runner.py:36] Average training steps per second: 328.77
I0902 00:26:49.727165 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.49
INFO:tensorflow:Starting iteration 25
I0902 00:26:53.066042 140053067847680 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 359.51

Steps executed: 272 Episode length: 103 Return: -199.7156715239106696
I0902 00:26:55.969002 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.77
INFO:tensorflow:Starting iteration 26

Steps executed: 357 Episode length: 228 Return: -639.8690074028449696
INFO:tensorflow:Average training steps per second: 367.64
I0902 00:27:02.105747 140053067847680 replay_runner.py:36] Average training steps per second: 367.64
I0902 00:27:02.343692 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.69
INFO:tensorflow:Starting iteration 27

Steps executed: 308 Episode length: 210 Return: -267.0003587509418796
INFO:tensorflow:Average training steps per second: 347.06
I0902 00:27:08.561933 140053067847680 replay_runner.py:36] Average training steps per second: 347.06
I0902 00:27:08.774258 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -475.54
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 122 Return: -10.65808970886176696
INFO:tensorflow:Average training steps per second: 348.71
I0902 00:27:14.901911 140053067847680 replay_runner.py:36] Average training steps per second: 348.71
I0902 00:27:15.037650 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -35.59
INFO:tensorflow:Starting iteration 29

Steps executed: 316 Episode length: 121 Return: -667.4734619771634696
INFO:tensorflow:Average training steps per second: 355.08
I0902 00:27:21.212620 140053067847680 replay_runner.py:36] Average training steps per second: 355.08

Done fixed training!Episode length: 121 Return: -667.4734619771634696