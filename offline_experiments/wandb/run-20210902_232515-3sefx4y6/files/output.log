Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0902 23:25:21.957253 139650945370112 run_experiment.py:549] Creating TrainRunner ...
I0902 23:25:21.967963 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:21.968240 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:21.968369 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:21.968756 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:21.968935 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:21.969030 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:21.969118 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:21.969247 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:21.969493 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:21.969620 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:21.969742 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:21.969923 139650945370112 dqn_agent.py:283] 	 seed: 1630625121967888
I0902 23:25:21.972046 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:21.972175 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:21.972254 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:21.972334 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:21.972393 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:21.972462 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:21.972594 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:21.972750 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:21.972862 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:22.013840 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:22.571572 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:22.587401 139650945370112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:25:22.597919 139650945370112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:22.598176 139650945370112 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:22.598284 139650945370112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:22.598350 139650945370112 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:22.598405 139650945370112 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:22.598465 139650945370112 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:25:22.598523 139650945370112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:22.598620 139650945370112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:22.598875 139650945370112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:22.599071 139650945370112 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:22.599182 139650945370112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:22.599288 139650945370112 dqn_agent.py:283] 	 seed: 1630625122597855
I0902 23:25:22.602169 139650945370112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:22.602397 139650945370112 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:25:22.602505 139650945370112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:22.602590 139650945370112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:22.602724 139650945370112 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:22.602834 139650945370112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:22.603136 139650945370112 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:22.603374 139650945370112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:22.603489 139650945370112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:22.639757 139650945370112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:22.664041 139650945370112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:25:22.664404 139650945370112 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.17
I0902 23:25:29.413966 139650945370112 replay_runner.py:36] Average training steps per second: 148.17
Steps executed: 230 Episode length: 35 Return: 35.0
I0902 23:25:30.561298 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.56
INFO:tensorflow:Starting iteration 1

Steps executed: 349 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 187.12
I0902 23:25:36.085465 139650945370112 replay_runner.py:36] Average training steps per second: 187.12
I0902 23:25:36.312650 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.50
INFO:tensorflow:Starting iteration 2
I0902 23:25:36.500620 139650945370112 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 197.94

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:25:41.681871 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3

Steps executed: 385 Episode length: 188 Return: 188.0
INFO:tensorflow:Average training steps per second: 185.81
I0902 23:25:47.246652 139650945370112 replay_runner.py:36] Average training steps per second: 185.81
I0902 23:25:47.491397 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 4

Steps executed: 358 Episode length: 190 Return: 190.0
INFO:tensorflow:Average training steps per second: 195.04
I0902 23:25:52.808576 139650945370112 replay_runner.py:36] Average training steps per second: 195.04
I0902 23:25:53.055016 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.00
I0902 23:25:58.631472 139650945370112 replay_runner.py:36] Average training steps per second: 189.00
I0902 23:25:58.764544 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 307 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 192.08
I0902 23:26:04.158143 139650945370112 replay_runner.py:36] Average training steps per second: 192.08
I0902 23:26:04.366338 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 7
I0902 23:26:04.556034 139650945370112 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 187.23

Steps executed: 200 Episode length: 200 Return: 200.0
I0902 23:26:10.043698 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 284 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 192.11
I0902 23:26:15.443474 139650945370112 replay_runner.py:36] Average training steps per second: 192.11
I0902 23:26:15.634752 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 9

Steps executed: 395 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.02
I0902 23:26:21.192399 139650945370112 replay_runner.py:36] Average training steps per second: 186.02
I0902 23:26:21.475735 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.50
INFO:tensorflow:Starting iteration 10

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.85
I0902 23:26:26.828008 139650945370112 replay_runner.py:36] Average training steps per second: 193.85
I0902 23:26:26.959198 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 263 Episode length: 134 Return: 134.0
INFO:tensorflow:Average training steps per second: 188.34
I0902 23:26:32.456792 139650945370112 replay_runner.py:36] Average training steps per second: 188.34
I0902 23:26:32.635821 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.50
INFO:tensorflow:Starting iteration 12
I0902 23:26:32.831776 139650945370112 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 190.71

Steps executed: 270 Episode length: 143 Return: 143.0
I0902 23:26:38.248013 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 135.00
INFO:tensorflow:Starting iteration 13

Steps executed: 276 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 187.16
I0902 23:26:43.784697 139650945370112 replay_runner.py:36] Average training steps per second: 187.16
I0902 23:26:43.972607 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.00
INFO:tensorflow:Starting iteration 14

Steps executed: 345 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.90
I0902 23:26:49.354432 139650945370112 replay_runner.py:36] Average training steps per second: 192.90
I0902 23:26:49.586435 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.50
I0902 23:26:55.134537 139650945370112 replay_runner.py:36] Average training steps per second: 186.50
I0902 23:26:55.274604 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0902 23:26:55.469546 139650945370112 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 190.70
I0902 23:27:00.714158 139650945370112 replay_runner.py:36] Average training steps per second: 190.70
I0902 23:27:00.839996 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0902 23:27:01.025864 139650945370112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 188.54
I0902 23:27:06.330320 139650945370112 replay_runner.py:36] Average training steps per second: 188.54
I0902 23:27:06.468588 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 23:27:06.663794 139650945370112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 191.98
I0902 23:27:11.873092 139650945370112 replay_runner.py:36] Average training steps per second: 191.98
I0902 23:27:11.998714 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 360 Episode length: 193 Return: 193.0
INFO:tensorflow:Average training steps per second: 187.32
I0902 23:27:17.523526 139650945370112 replay_runner.py:36] Average training steps per second: 187.32
I0902 23:27:17.775033 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 180.00
INFO:tensorflow:Starting iteration 20

Steps executed: 383 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.11
I0902 23:27:23.202531 139650945370112 replay_runner.py:36] Average training steps per second: 191.11
I0902 23:27:23.460256 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 191.50
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.88
I0902 23:27:28.977702 139650945370112 replay_runner.py:36] Average training steps per second: 187.88
I0902 23:27:29.116132 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:27:29.317884 139650945370112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 187.72
I0902 23:27:34.645464 139650945370112 replay_runner.py:36] Average training steps per second: 187.72
I0902 23:27:34.780417 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:27:34.962227 139650945370112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 190.44
I0902 23:27:40.213639 139650945370112 replay_runner.py:36] Average training steps per second: 190.44
I0902 23:27:40.355391 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 399 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.85
I0902 23:27:45.707439 139650945370112 replay_runner.py:36] Average training steps per second: 193.85
I0902 23:27:45.954117 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.71
I0902 23:27:51.284830 139650945370112 replay_runner.py:36] Average training steps per second: 194.71
I0902 23:27:51.406534 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:27:51.587801 139650945370112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 194.43
I0902 23:27:56.731575 139650945370112 replay_runner.py:36] Average training steps per second: 194.43
I0902 23:27:56.852541 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:27:57.028768 139650945370112 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.55
I0902 23:28:02.222475 139650945370112 replay_runner.py:36] Average training steps per second: 192.55
I0902 23:28:02.355940 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:28:02.548561 139650945370112 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 188.16
I0902 23:28:07.863745 139650945370112 replay_runner.py:36] Average training steps per second: 188.16
I0902 23:28:07.998653 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.66
I0902 23:28:13.525338 139650945370112 replay_runner.py:36] Average training steps per second: 187.66
I0902 23:28:13.659939 139650945370112 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00