Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0902 00:11:09.994855 140156774885376 run_experiment.py:549] Creating TrainRunner ...
I0902 00:11:10.004088 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:11:10.004366 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:11:10.004757 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:11:10.004863 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:11:10.004996 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0902 00:11:10.005082 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:11:10.005184 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:11:10.005279 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:11:10.005349 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:11:10.005427 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0902 00:11:10.005527 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:11:10.005640 140156774885376 dqn_agent.py:283] 	 seed: 1630541470004018
I0902 00:11:10.008465 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:11:10.008700 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:11:10.008867 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:11:10.008991 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:11:10.009135 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:11:10.009244 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:11:10.009348 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:11:10.009473 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:11:10.009608 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:11:10.051023 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:11:10.583806 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:11:10.599377 140156774885376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:11:10.610702 140156774885376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:11:10.610924 140156774885376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:11:10.611075 140156774885376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:11:10.611226 140156774885376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:11:10.611326 140156774885376 dqn_agent.py:275] 	 update_period: 4
I0902 00:11:10.611420 140156774885376 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:11:10.611536 140156774885376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:11:10.611610 140156774885376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:11:10.611686 140156774885376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:11:10.611804 140156774885376 dqn_agent.py:280] 	 optimizer: adam
I0902 00:11:10.611904 140156774885376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:11:10.612027 140156774885376 dqn_agent.py:283] 	 seed: 1630541470610652
I0902 00:11:10.614375 140156774885376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:11:10.614598 140156774885376 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 00:11:10.614753 140156774885376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:11:10.614929 140156774885376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:11:10.615089 140156774885376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:11:10.615325 140156774885376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:11:10.615549 140156774885376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:11:10.615749 140156774885376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:11:10.615861 140156774885376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:11:10.652000 140156774885376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:11:10.676520 140156774885376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:11:10.676820 140156774885376 replay_runner.py:41] Starting iteration 0
Steps executed: 253 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 134.36
I0902 00:11:18.120180 140156774885376 replay_runner.py:36] Average training steps per second: 134.36
I0902 00:11:19.371926 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 50.60
INFO:tensorflow:Starting iteration 1

Steps executed: 208 Episode length: 13 Return: 13.0.0
INFO:tensorflow:Average training steps per second: 194.14
I0902 00:11:24.708145 140156774885376 replay_runner.py:36] Average training steps per second: 194.14
I0902 00:11:24.859864 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.00
INFO:tensorflow:Starting iteration 2

Steps executed: 222 Episode length: 57 Return: 57.0.0
INFO:tensorflow:Average training steps per second: 189.99
I0902 00:11:30.323346 140156774885376 replay_runner.py:36] Average training steps per second: 189.99
I0902 00:11:30.464024 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 31.71
INFO:tensorflow:Starting iteration 3

Steps executed: 67 Episode length: 67 Return: 67.00.0
INFO:tensorflow:Average training steps per second: 199.49

Steps executed: 203 Episode length: 63 Return: 63.0.0
I0902 00:11:35.794588 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 67.67
INFO:tensorflow:Starting iteration 4

Steps executed: 254 Episode length: 85 Return: 85.0.0
INFO:tensorflow:Average training steps per second: 193.26
I0902 00:11:41.163230 140156774885376 replay_runner.py:36] Average training steps per second: 193.26
I0902 00:11:41.323549 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 84.67
INFO:tensorflow:Starting iteration 5

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.68
I0902 00:11:46.671142 140156774885376 replay_runner.py:36] Average training steps per second: 193.68
I0902 00:11:46.816837 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6
I0902 00:11:47.007980 140156774885376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 197.57
I0902 00:11:52.070034 140156774885376 replay_runner.py:36] Average training steps per second: 197.57
I0902 00:11:52.203143 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 00:11:52.382588 140156774885376 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 206.01
I0902 00:11:57.237221 140156774885376 replay_runner.py:36] Average training steps per second: 206.01
I0902 00:11:57.391793 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 39.33
INFO:tensorflow:Starting iteration 8


Steps executed: 317 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 207.36
I0902 00:12:02.466756 140156774885376 replay_runner.py:36] Average training steps per second: 207.36
I0902 00:12:02.649843 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 9
I0902 00:12:02.826852 140156774885376 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 200.42
I0902 00:12:07.816855 140156774885376 replay_runner.py:36] Average training steps per second: 200.42

Steps executed: 296 Episode length: 145 Return: 145.0
INFO:tensorflow:Starting iteration 10
I0902 00:12:08.203805 140156774885376 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 201.31
I0902 00:12:13.171814 140156774885376 replay_runner.py:36] Average training steps per second: 201.31
I0902 00:12:13.352524 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 11


Steps executed: 299 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 195.12
I0902 00:12:18.667838 140156774885376 replay_runner.py:36] Average training steps per second: 195.12
I0902 00:12:18.864219 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.50
INFO:tensorflow:Starting iteration 12
I0902 00:12:19.045565 140156774885376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 192.00

Steps executed: 256 Episode length: 126 Return: 126.0
I0902 00:12:24.428022 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 13

Steps executed: 247 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 195.91
I0902 00:12:29.727351 140156774885376 replay_runner.py:36] Average training steps per second: 195.91
I0902 00:12:29.884936 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 123.50
INFO:tensorflow:Starting iteration 14

Steps executed: 245 Episode length: 125 Return: 125.0
INFO:tensorflow:Average training steps per second: 194.42
I0902 00:12:35.214416 140156774885376 replay_runner.py:36] Average training steps per second: 194.42
I0902 00:12:35.377851 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.50
INFO:tensorflow:Starting iteration 15

Steps executed: 248 Episode length: 126 Return: 126.0
INFO:tensorflow:Average training steps per second: 195.00
I0902 00:12:40.699920 140156774885376 replay_runner.py:36] Average training steps per second: 195.00
I0902 00:12:40.870797 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 16

Steps executed: 273 Episode length: 133 Return: 133.0
INFO:tensorflow:Average training steps per second: 192.89
I0902 00:12:46.239268 140156774885376 replay_runner.py:36] Average training steps per second: 192.89
I0902 00:12:46.426684 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.77
I0902 00:12:51.784443 140156774885376 replay_runner.py:36] Average training steps per second: 193.77
I0902 00:12:51.929751 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0902 00:12:52.125534 140156774885376 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.69
I0902 00:12:57.262495 140156774885376 replay_runner.py:36] Average training steps per second: 194.69
I0902 00:12:57.402705 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 00:12:57.592855 140156774885376 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.51
I0902 00:13:02.815103 140156774885376 replay_runner.py:36] Average training steps per second: 191.51
I0902 00:13:02.953555 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 00:13:03.150220 140156774885376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 195.45
I0902 00:13:08.266856 140156774885376 replay_runner.py:36] Average training steps per second: 195.45
I0902 00:13:08.406830 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 00:13:08.589597 140156774885376 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.83
I0902 00:13:13.670565 140156774885376 replay_runner.py:36] Average training steps per second: 196.83
I0902 00:13:13.812417 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 00:13:14.009277 140156774885376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 195.25
I0902 00:13:19.131637 140156774885376 replay_runner.py:36] Average training steps per second: 195.25
I0902 00:13:19.263711 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 00:13:19.457081 140156774885376 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 193.63
I0902 00:13:24.621929 140156774885376 replay_runner.py:36] Average training steps per second: 193.63
I0902 00:13:24.764163 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 00:13:24.954823 140156774885376 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 195.00
I0902 00:13:30.083469 140156774885376 replay_runner.py:36] Average training steps per second: 195.00
I0902 00:13:30.216581 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 00:13:30.411898 140156774885376 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.63
I0902 00:13:35.523918 140156774885376 replay_runner.py:36] Average training steps per second: 195.63
I0902 00:13:35.662291 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 00:13:35.859173 140156774885376 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 200.35
I0902 00:13:40.851112 140156774885376 replay_runner.py:36] Average training steps per second: 200.35
I0902 00:13:40.986815 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 00:13:41.178847 140156774885376 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.76
I0902 00:13:46.366822 140156774885376 replay_runner.py:36] Average training steps per second: 192.76
I0902 00:13:46.502506 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 00:13:46.698721 140156774885376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.77
I0902 00:13:51.781436 140156774885376 replay_runner.py:36] Average training steps per second: 196.77
I0902 00:13:51.916956 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.53
I0902 00:13:57.352131 140156774885376 replay_runner.py:36] Average training steps per second: 190.53
I0902 00:13:57.509398 140156774885376 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00