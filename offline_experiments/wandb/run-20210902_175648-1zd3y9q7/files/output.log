Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0902 17:56:55.171507 140228977166336 run_experiment.py:549] Creating TrainRunner ...
I0902 17:56:55.181814 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:55.182110 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:55.182620 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:55.182821 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:55.182978 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:55.183116 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:55.183202 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:55.183468 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:55.183607 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:55.183687 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:55.183758 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:55.183825 140228977166336 dqn_agent.py:283] 	 seed: 1630605415181746
I0902 17:56:55.186474 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:55.186717 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:55.186880 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:55.187034 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:55.187165 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:55.187273 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:55.187397 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:55.187551 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:55.187674 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:55.225347 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:55.646341 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:55.702273 140228977166336 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:56:55.717196 140228977166336 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:56:55.717464 140228977166336 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:56:55.717632 140228977166336 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:56:55.717800 140228977166336 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:56:55.717946 140228977166336 dqn_agent.py:275] 	 update_period: 4
I0902 17:56:55.718093 140228977166336 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:56:55.718225 140228977166336 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:56:55.718362 140228977166336 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:56:55.718495 140228977166336 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:56:55.718642 140228977166336 dqn_agent.py:280] 	 optimizer: adam
I0902 17:56:55.718765 140228977166336 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:56:55.718890 140228977166336 dqn_agent.py:283] 	 seed: 1630605415717136
I0902 17:56:55.723573 140228977166336 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:56:55.723774 140228977166336 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:56:55.723915 140228977166336 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:56:55.724677 140228977166336 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:56:55.724808 140228977166336 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:56:55.725220 140228977166336 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:56:55.725326 140228977166336 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:56:55.725439 140228977166336 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:56:55.725909 140228977166336 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:56:55.772339 140228977166336 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 17:56:55.801768 140228977166336 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:56:55.802030 140228977166336 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 146.37
I0902 17:57:02.634515 140228977166336 replay_runner.py:36] Average training steps per second: 146.37
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 17:57:04.151204 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:57:04.387823 140228977166336 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 203.01
I0902 17:57:09.314087 140228977166336 replay_runner.py:36] Average training steps per second: 203.01
I0902 17:57:09.736124 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:57:09.977973 140228977166336 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 193.56
I0902 17:57:15.144685 140228977166336 replay_runner.py:36] Average training steps per second: 193.56
I0902 17:57:15.549127 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:57:15.784702 140228977166336 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 196.20
I0902 17:57:20.881932 140228977166336 replay_runner.py:36] Average training steps per second: 196.20
I0902 17:57:21.288955 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 318 Episode length: 177 Return: -176.0
INFO:tensorflow:Average training steps per second: 196.02
I0902 17:57:26.631354 140228977166336 replay_runner.py:36] Average training steps per second: 196.02
I0902 17:57:26.892817 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.43
I0902 17:57:32.221339 140228977166336 replay_runner.py:36] Average training steps per second: 196.43
I0902 17:57:32.655640 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 17:57:32.882620 140228977166336 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 188.93
I0902 17:57:38.176054 140228977166336 replay_runner.py:36] Average training steps per second: 188.93
I0902 17:57:38.592658 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0902 17:57:38.837853 140228977166336 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.75
I0902 17:57:43.920775 140228977166336 replay_runner.py:36] Average training steps per second: 196.75
I0902 17:57:44.309244 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 17:57:44.550323 140228977166336 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.71
I0902 17:57:49.608662 140228977166336 replay_runner.py:36] Average training steps per second: 197.71
I0902 17:57:50.011106 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:57:50.255596 140228977166336 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 198.99
I0902 17:57:55.281349 140228977166336 replay_runner.py:36] Average training steps per second: 198.99
I0902 17:57:55.701564 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 17:57:55.952021 140228977166336 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 196.36
I0902 17:58:01.045357 140228977166336 replay_runner.py:36] Average training steps per second: 196.36
I0902 17:58:01.460219 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0902 17:58:01.709672 140228977166336 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 193.36
I0902 17:58:06.881884 140228977166336 replay_runner.py:36] Average training steps per second: 193.36
I0902 17:58:07.302513 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 269 Episode length: 269 Return: -268.0
INFO:tensorflow:Average training steps per second: 197.84
I0902 17:58:12.607731 140228977166336 replay_runner.py:36] Average training steps per second: 197.84
I0902 17:58:12.819936 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.00
INFO:tensorflow:Starting iteration 13

Steps executed: 288 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 190.78
I0902 17:58:18.306416 140228977166336 replay_runner.py:36] Average training steps per second: 190.78
I0902 17:58:18.540405 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.00
INFO:tensorflow:Starting iteration 14

Steps executed: 283 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 199.88
I0902 17:58:23.793423 140228977166336 replay_runner.py:36] Average training steps per second: 199.88
I0902 17:58:24.034881 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.50
INFO:tensorflow:Starting iteration 15
I0902 17:58:24.292508 140228977166336 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 197.78

Steps executed: 272 Episode length: 118 Return: -117.0
I0902 17:58:29.569652 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.00
INFO:tensorflow:Starting iteration 16

Steps executed: 93 Episode length: 93 Return: -92.07.0
INFO:tensorflow:Average training steps per second: 199.48
I0902 17:58:34.826731 140228977166336 replay_runner.py:36] Average training steps per second: 199.48
I0902 17:58:35.193942 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.50
INFO:tensorflow:Starting iteration 17


Steps executed: 284 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.35
I0902 17:58:40.433124 140228977166336 replay_runner.py:36] Average training steps per second: 200.35
I0902 17:58:40.678107 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 18

Steps executed: 226 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 191.68
I0902 17:58:46.140766 140228977166336 replay_runner.py:36] Average training steps per second: 191.68
I0902 17:58:46.324942 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -112.00
INFO:tensorflow:Starting iteration 19

Steps executed: 260 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 196.88
I0902 17:58:51.636370 140228977166336 replay_runner.py:36] Average training steps per second: 196.88
I0902 17:58:51.852729 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 20

Steps executed: 100 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 199.63

Steps executed: 229 Episode length: 129 Return: -128.0
I0902 17:58:57.292170 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 21

Steps executed: 228 Episode length: 112 Return: -111.0
INFO:tensorflow:Average training steps per second: 203.43
I0902 17:59:02.444556 140228977166336 replay_runner.py:36] Average training steps per second: 203.43
I0902 17:59:02.618294 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 22

Steps executed: 224 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 219.03
I0902 17:59:07.404628 140228977166336 replay_runner.py:36] Average training steps per second: 219.03
I0902 17:59:07.578025 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 23

Steps executed: 247 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 203.89
I0902 17:59:12.706558 140228977166336 replay_runner.py:36] Average training steps per second: 203.89
I0902 17:59:12.895978 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 24

Steps executed: 205 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 207.33
I0902 17:59:17.954573 140228977166336 replay_runner.py:36] Average training steps per second: 207.33
I0902 17:59:18.130139 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 25

Steps executed: 108 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 198.90

Steps executed: 302 Episode length: 103 Return: -102.0
I0902 17:59:23.648496 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.67
INFO:tensorflow:Starting iteration 26

Steps executed: 269 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 201.97
I0902 17:59:28.818398 140228977166336 replay_runner.py:36] Average training steps per second: 201.97
I0902 17:59:29.055370 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.67
INFO:tensorflow:Starting iteration 27

Steps executed: 247 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 201.69
I0902 17:59:34.263758 140228977166336 replay_runner.py:36] Average training steps per second: 201.69
I0902 17:59:34.459336 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 195.21
I0902 17:59:39.825166 140228977166336 replay_runner.py:36] Average training steps per second: 195.21
I0902 17:59:39.993984 140228977166336 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 29

Steps executed: 303 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 196.60
I0902 17:59:45.319159 140228977166336 replay_runner.py:36] Average training steps per second: 196.60

Done fixed training!Episode length: 122 Return: -121.0