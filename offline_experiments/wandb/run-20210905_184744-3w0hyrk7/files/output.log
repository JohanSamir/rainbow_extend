I0905 18:47:51.323371 139914690385920 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.323936 139914690385920 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.399598 139914690385920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.400734 139914690385920 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.400810 139914690385920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.400892 139914690385920 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.400949 139914690385920 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.401008 139914690385920 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:51.401075 139914690385920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.401130 139914690385920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.401212 139914690385920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.401329 139914690385920 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.401411 139914690385920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.401470 139914690385920 dqn_agent.py:283] 	 seed: 1630867671399546
I0905 18:47:51.403146 139914690385920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.403280 139914690385920 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:51.403469 139914690385920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.403592 139914690385920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.403658 139914690385920 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.403720 139914690385920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.403770 139914690385920 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.403817 139914690385920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.403872 139914690385920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.542794 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 6, please be patient, may be a while...
I0905 18:47:52.859162 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.887501 139914690385920 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:52.892028 139914690385920 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:52.892160 139914690385920 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:52.892224 139914690385920 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:52.892329 139914690385920 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:52.892416 139914690385920 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:52.892572 139914690385920 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:47:52.892628 139914690385920 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:52.892692 139914690385920 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:52.892749 139914690385920 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:52.892900 139914690385920 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:52.893023 139914690385920 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:52.893096 139914690385920 dqn_agent.py:283] 	 seed: 1630867672891985
I0905 18:47:52.894486 139914690385920 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:52.894652 139914690385920 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:47:52.894718 139914690385920 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:52.894795 139914690385920 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:52.894847 139914690385920 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:52.894902 139914690385920 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:52.894955 139914690385920 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:52.895007 139914690385920 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:52.895088 139914690385920 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.909139 139914690385920 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.918179 139914690385920 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:52.918346 139914690385920 replay_runner.py:41] Starting iteration 0
Steps executed: 203 Episode length: 107 Return: -205.32025365855483
INFO:tensorflow:Average training steps per second: 319.94
I0905 18:47:56.044063 139914690385920 replay_runner.py:36] Average training steps per second: 319.94
I0905 18:47:56.631700 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -200.24
INFO:tensorflow:Starting iteration 1

Steps executed: 402 Episode length: 240 Return: -260.95262776802736
INFO:tensorflow:Average training steps per second: 417.41
I0905 18:48:02.100300 139914690385920 replay_runner.py:36] Average training steps per second: 417.41
I0905 18:48:02.328019 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.23
INFO:tensorflow:Starting iteration 2

Steps executed: 295 Episode length: 140 Return: -276.07233453011315
INFO:tensorflow:Average training steps per second: 414.49
I0905 18:48:07.822629 139914690385920 replay_runner.py:36] Average training steps per second: 414.49
I0905 18:48:07.974136 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.17
INFO:tensorflow:Starting iteration 3

Steps executed: 316 Episode length: 168 Return: -325.86314362381165
INFO:tensorflow:Average training steps per second: 417.04
I0905 18:48:13.459423 139914690385920 replay_runner.py:36] Average training steps per second: 417.04
I0905 18:48:13.597609 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.24
INFO:tensorflow:Starting iteration 4

Steps executed: 207 Episode length: 88 Return: -342.165551242137865
INFO:tensorflow:Average training steps per second: 415.21
I0905 18:48:19.089251 139914690385920 replay_runner.py:36] Average training steps per second: 415.21
I0905 18:48:19.166599 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -175.22
INFO:tensorflow:Starting iteration 5

Steps executed: 244 Episode length: 101 Return: -161.46312740836493
INFO:tensorflow:Average training steps per second: 424.28
I0905 18:48:24.618919 139914690385920 replay_runner.py:36] Average training steps per second: 424.28
I0905 18:48:24.734059 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.94
INFO:tensorflow:Starting iteration 6

Steps executed: 251 Episode length: 126 Return: -208.09190158928383
INFO:tensorflow:Average training steps per second: 427.34
I0905 18:48:30.161940 139914690385920 replay_runner.py:36] Average training steps per second: 427.34
I0905 18:48:30.266236 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.11
INFO:tensorflow:Starting iteration 7

Steps executed: 153 Episode length: 153 Return: -266.47103543660283
INFO:tensorflow:Average training steps per second: 429.89

Steps executed: 1153 Episode length: 1000 Return: -26.970936923865526
I0905 18:48:37.148064 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.72
INFO:tensorflow:Starting iteration 8

Steps executed: 220 Episode length: 136 Return: -56.45306274191522526
INFO:tensorflow:Average training steps per second: 422.13
I0905 18:48:42.598936 139914690385920 replay_runner.py:36] Average training steps per second: 422.13
I0905 18:48:42.679394 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.47
INFO:tensorflow:Starting iteration 9

Steps executed: 333 Episode length: 177 Return: 30.990115496234722426
INFO:tensorflow:Average training steps per second: 419.08
I0905 18:48:48.149854 139914690385920 replay_runner.py:36] Average training steps per second: 419.08
I0905 18:48:48.310358 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.00
INFO:tensorflow:Starting iteration 10

Steps executed: 323 Episode length: 234 Return: -374.1147537615365426
INFO:tensorflow:Average training steps per second: 419.76
I0905 18:48:53.766981 139914690385920 replay_runner.py:36] Average training steps per second: 419.76
I0905 18:48:53.924468 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -186.08
INFO:tensorflow:Starting iteration 11

Steps executed: 264 Episode length: 134 Return: -56.94159659116275226
INFO:tensorflow:Average training steps per second: 420.25
I0905 18:48:59.382847 139914690385920 replay_runner.py:36] Average training steps per second: 420.25
I0905 18:48:59.502124 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.88
INFO:tensorflow:Starting iteration 12

Steps executed: 322 Episode length: 182 Return: -138.1390962496127826
INFO:tensorflow:Average training steps per second: 424.64
I0905 18:49:04.938798 139914690385920 replay_runner.py:36] Average training steps per second: 424.64
I0905 18:49:05.084540 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -191.69
INFO:tensorflow:Starting iteration 13

Steps executed: 245 Episode length: 116 Return: -527.1972736720006826
INFO:tensorflow:Average training steps per second: 422.29
I0905 18:49:10.540725 139914690385920 replay_runner.py:36] Average training steps per second: 422.29
I0905 18:49:10.642199 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.95
INFO:tensorflow:Starting iteration 14

Steps executed: 202 Episode length: 202 Return: -489.1215244520376826
INFO:tensorflow:Average training steps per second: 420.13
I0905 18:49:16.101005 139914690385920 replay_runner.py:36] Average training steps per second: 420.13
I0905 18:49:16.213207 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.12
INFO:tensorflow:Starting iteration 15

Steps executed: 225 Episode length: 137 Return: -702.2690524958873826
INFO:tensorflow:Average training steps per second: 426.22
I0905 18:49:21.626607 139914690385920 replay_runner.py:36] Average training steps per second: 426.22
I0905 18:49:21.726345 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -541.67
INFO:tensorflow:Starting iteration 16

Steps executed: 254 Episode length: 254 Return: -442.0617478612854826
INFO:tensorflow:Average training steps per second: 452.96
I0905 18:49:26.924518 139914690385920 replay_runner.py:36] Average training steps per second: 452.96
I0905 18:49:27.097895 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.06
INFO:tensorflow:Starting iteration 17

Steps executed: 312 Episode length: 131 Return: -291.2843574840260326
INFO:tensorflow:Average training steps per second: 272.83
I0905 18:49:33.818909 139914690385920 replay_runner.py:36] Average training steps per second: 272.83
I0905 18:49:33.954763 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.72
INFO:tensorflow:Starting iteration 18

Steps executed: 339 Episode length: 154 Return: -313.0984701519450426
INFO:tensorflow:Average training steps per second: 275.27
I0905 18:49:41.072092 139914690385920 replay_runner.py:36] Average training steps per second: 275.27
I0905 18:49:41.329434 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.48
INFO:tensorflow:Starting iteration 19

Steps executed: 237 Episode length: 91 Return: -617.64320628933053426
INFO:tensorflow:Average training steps per second: 245.73
I0905 18:49:49.561043 139914690385920 replay_runner.py:36] Average training steps per second: 245.73
I0905 18:49:49.756304 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.97
INFO:tensorflow:Starting iteration 20

Steps executed: 215 Episode length: 100 Return: -589.8906603384036426
INFO:tensorflow:Average training steps per second: 242.57
I0905 18:49:58.069383 139914690385920 replay_runner.py:36] Average training steps per second: 242.57
I0905 18:49:58.219475 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -623.24
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 110 Return: -224.1683858327544426
INFO:tensorflow:Average training steps per second: 246.05
I0905 18:50:06.563916 139914690385920 replay_runner.py:36] Average training steps per second: 246.05
I0905 18:50:06.728887 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.29
INFO:tensorflow:Starting iteration 22

Steps executed: 208 Episode length: 123 Return: -335.4571477058978426
INFO:tensorflow:Average training steps per second: 241.57
I0905 18:50:15.149883 139914690385920 replay_runner.py:36] Average training steps per second: 241.57
I0905 18:50:15.291904 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.60
INFO:tensorflow:Starting iteration 23

Steps executed: 253 Episode length: 96 Return: -92.474121708682160426
INFO:tensorflow:Average training steps per second: 235.73
I0905 18:50:23.807472 139914690385920 replay_runner.py:36] Average training steps per second: 235.73
I0905 18:50:23.996584 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.67
INFO:tensorflow:Starting iteration 24

Steps executed: 326 Episode length: 149 Return: -969.9100687966935426
INFO:tensorflow:Average training steps per second: 246.26
I0905 18:50:32.310054 139914690385920 replay_runner.py:36] Average training steps per second: 246.26
I0905 18:50:32.552100 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -568.49
INFO:tensorflow:Starting iteration 25

Steps executed: 246 Episode length: 65 Return: -600.20762623147687626
INFO:tensorflow:Average training steps per second: 244.16
I0905 18:50:40.907956 139914690385920 replay_runner.py:36] Average training steps per second: 244.16
I0905 18:50:41.097652 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -517.27
INFO:tensorflow:Starting iteration 26
I0905 18:50:45.350948 139914690385920 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 247.63
I0905 18:50:49.389858 139914690385920 replay_runner.py:36] Average training steps per second: 247.63

Steps executed: 259 Episode length: 98 Return: -646.21084950308987626
INFO:tensorflow:Starting iteration 27

Steps executed: 216 Episode length: 125 Return: -640.5005946801103626
INFO:tensorflow:Average training steps per second: 243.92
I0905 18:50:57.923677 139914690385920 replay_runner.py:36] Average training steps per second: 243.92
I0905 18:50:58.091476 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -686.95
INFO:tensorflow:Starting iteration 28

Steps executed: 219 Episode length: 59 Return: -436.19103335575114626
INFO:tensorflow:Average training steps per second: 245.78
I0905 18:51:06.378345 139914690385920 replay_runner.py:36] Average training steps per second: 245.78
I0905 18:51:06.544882 139914690385920 run_experiment.py:428] Average undiscounted return per evaluation episode: -434.96
INFO:tensorflow:Starting iteration 29

Steps executed: 212 Episode length: 87 Return: -855.73586023631924626
INFO:tensorflow:Average training steps per second: 244.68
I0905 18:51:14.899883 139914690385920 replay_runner.py:36] Average training steps per second: 244.68

Done fixed training!Episode length: 87 Return: -855.73586023631924626