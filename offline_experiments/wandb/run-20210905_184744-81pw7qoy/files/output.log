Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0905 18:47:51.210279 140076563105792 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0905 18:47:51.210769 140076563105792 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0905 18:47:51.270687 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:51.271733 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:51.271800 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:51.271861 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:51.271963 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:51.272032 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:47:51.272105 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:51.272251 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:51.272324 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:51.272391 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:51.272443 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:51.272496 140076563105792 dqn_agent.py:283] 	 seed: 1630867671270635
I0905 18:47:51.274261 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:51.274409 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:47:51.274492 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:51.274551 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:51.274607 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:51.274664 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:51.274717 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:51.274774 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:51.274841 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.426559 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.778350 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.803241 140076563105792 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:47:52.806986 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:47:52.807143 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:47:52.807240 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:47:52.807333 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:47:52.807401 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:47:52.807457 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:47:52.807523 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:47:52.807589 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:47:52.807661 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:47:52.807732 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:47:52.807798 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:47:52.807869 140076563105792 dqn_agent.py:283] 	 seed: 1630867672806951
I0905 18:47:52.809330 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:47:52.809447 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:47:52.809516 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:47:52.809578 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:47:52.809634 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:47:52.809689 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:47:52.809741 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:47:52.809812 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:47:52.809879 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:47:52.826069 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:47:52.835647 140076563105792 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:47:52.835802 140076563105792 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 277.08
I0905 18:47:56.445048 140076563105792 replay_runner.py:36] Average training steps per second: 277.08
Steps executed: 208 Episode length: 12 Return: 12.0
I0905 18:47:57.031916 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 12.24
INFO:tensorflow:Starting iteration 1
I0905 18:47:57.158845 140076563105792 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 353.71
I0905 18:47:59.986287 140076563105792 replay_runner.py:36] Average training steps per second: 353.71
I0905 18:48:00.047595 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 348.34
I0905 18:48:03.043794 140076563105792 replay_runner.py:36] Average training steps per second: 348.34
I0905 18:48:03.100696 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.14
INFO:tensorflow:Starting iteration 3

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 352.76
I0905 18:48:06.059641 140076563105792 replay_runner.py:36] Average training steps per second: 352.76
I0905 18:48:06.119394 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.50
INFO:tensorflow:Starting iteration 4

Steps executed: 209 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 347.80
I0905 18:48:09.118776 140076563105792 replay_runner.py:36] Average training steps per second: 347.80
I0905 18:48:09.178581 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 5

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 354.10
I0905 18:48:12.164733 140076563105792 replay_runner.py:36] Average training steps per second: 354.10
I0905 18:48:12.224191 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 6

Steps executed: 201 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 350.89
I0905 18:48:15.199776 140076563105792 replay_runner.py:36] Average training steps per second: 350.89
I0905 18:48:15.262080 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 7


Steps executed: 204 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 351.73
I0905 18:48:18.228951 140076563105792 replay_runner.py:36] Average training steps per second: 351.73
I0905 18:48:18.286300 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 8

Steps executed: 204 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 355.84
I0905 18:48:21.221537 140076563105792 replay_runner.py:36] Average training steps per second: 355.84
I0905 18:48:21.285837 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 9

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 352.44
I0905 18:48:24.247105 140076563105792 replay_runner.py:36] Average training steps per second: 352.44
I0905 18:48:24.311086 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 10

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 355.31
I0905 18:48:27.250251 140076563105792 replay_runner.py:36] Average training steps per second: 355.31
I0905 18:48:27.310711 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 11

Steps executed: 203 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 350.29
I0905 18:48:30.288823 140076563105792 replay_runner.py:36] Average training steps per second: 350.29
I0905 18:48:30.349302 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 12

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 361.79
I0905 18:48:33.238065 140076563105792 replay_runner.py:36] Average training steps per second: 361.79
I0905 18:48:33.294608 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 13

Steps executed: 206 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 344.42
I0905 18:48:36.321600 140076563105792 replay_runner.py:36] Average training steps per second: 344.42
I0905 18:48:36.391598 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 14

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 353.82
I0905 18:48:39.344579 140076563105792 replay_runner.py:36] Average training steps per second: 353.82
I0905 18:48:39.403167 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 15

Steps executed: 202 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 353.43
I0905 18:48:42.355936 140076563105792 replay_runner.py:36] Average training steps per second: 353.43
I0905 18:48:42.415585 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.62
INFO:tensorflow:Starting iteration 16


Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 354.25
I0905 18:48:45.361418 140076563105792 replay_runner.py:36] Average training steps per second: 354.25
I0905 18:48:45.423205 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 17

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 352.89
I0905 18:48:48.381018 140076563105792 replay_runner.py:36] Average training steps per second: 352.89
I0905 18:48:48.446058 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 18

Steps executed: 208 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 359.51
I0905 18:48:51.349662 140076563105792 replay_runner.py:36] Average training steps per second: 359.51
I0905 18:48:51.411420 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 19

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 355.74
I0905 18:48:54.346370 140076563105792 replay_runner.py:36] Average training steps per second: 355.74
I0905 18:48:54.403029 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 20
I0905 18:48:54.525217 140076563105792 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 361.31
I0905 18:48:57.293182 140076563105792 replay_runner.py:36] Average training steps per second: 361.31

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Starting iteration 21
I0905 18:48:57.487861 140076563105792 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 341.31
I0905 18:49:00.418012 140076563105792 replay_runner.py:36] Average training steps per second: 341.31
I0905 18:49:00.473448 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 22
I0905 18:49:00.596090 140076563105792 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 356.40
I0905 18:49:03.402139 140076563105792 replay_runner.py:36] Average training steps per second: 356.40

Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Starting iteration 23

Steps executed: 203 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 359.37
I0905 18:49:06.371617 140076563105792 replay_runner.py:36] Average training steps per second: 359.37
I0905 18:49:06.427583 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.23
INFO:tensorflow:Starting iteration 24
I0905 18:49:06.549170 140076563105792 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 359.57
I0905 18:49:09.330552 140076563105792 replay_runner.py:36] Average training steps per second: 359.57
I0905 18:49:09.385601 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 25


Steps executed: 204 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 359.39
I0905 18:49:12.292630 140076563105792 replay_runner.py:36] Average training steps per second: 359.39
I0905 18:49:12.354780 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 26

Steps executed: 205 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 356.18
I0905 18:49:15.285068 140076563105792 replay_runner.py:36] Average training steps per second: 356.18
I0905 18:49:15.349650 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 27

Steps executed: 204 Episode length: 8 Return: 8.0.0
INFO:tensorflow:Average training steps per second: 356.25
I0905 18:49:18.280749 140076563105792 replay_runner.py:36] Average training steps per second: 356.25
I0905 18:49:18.337451 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.27
INFO:tensorflow:Starting iteration 28


Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 354.69
I0905 18:49:21.278584 140076563105792 replay_runner.py:36] Average training steps per second: 354.69
I0905 18:49:21.338923 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 29
I0905 18:49:21.462641 140076563105792 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 362.42
I0905 18:49:24.222142 140076563105792 replay_runner.py:36] Average training steps per second: 362.42

Done fixed training!Episode length: 9 Return: 9.0.0