Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0901 23:50:16.599498 140608390211584 run_experiment.py:549] Creating TrainRunner ...
I0901 23:50:16.608711 140608390211584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:16.609028 140608390211584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:16.609284 140608390211584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:16.609480 140608390211584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:16.609646 140608390211584 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:16.609788 140608390211584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:16.609918 140608390211584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:16.610046 140608390211584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:16.610194 140608390211584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:16.610340 140608390211584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:16.610691 140608390211584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:16.610797 140608390211584 dqn_agent.py:283] 	 seed: 1630540216608642
I0901 23:50:16.613938 140608390211584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:16.614148 140608390211584 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:50:16.614331 140608390211584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:16.614448 140608390211584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:16.614533 140608390211584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:16.614664 140608390211584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:16.614765 140608390211584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:16.614851 140608390211584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:16.614941 140608390211584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:16.657544 140608390211584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:17.535988 140608390211584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:17.554549 140608390211584 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:50:17.566013 140608390211584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:50:17.566414 140608390211584 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:50:17.566556 140608390211584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:50:17.566651 140608390211584 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:50:17.566729 140608390211584 dqn_agent.py:275] 	 update_period: 4
I0901 23:50:17.566844 140608390211584 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:50:17.566931 140608390211584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:50:17.567001 140608390211584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:50:17.567056 140608390211584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:50:17.567111 140608390211584 dqn_agent.py:280] 	 optimizer: adam
I0901 23:50:17.567165 140608390211584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:50:17.567218 140608390211584 dqn_agent.py:283] 	 seed: 1630540217565941
I0901 23:50:17.570199 140608390211584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:50:17.570413 140608390211584 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:50:17.570786 140608390211584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:50:17.571266 140608390211584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:50:17.571639 140608390211584 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:50:17.571742 140608390211584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:50:17.571825 140608390211584 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:50:17.571913 140608390211584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:50:17.572134 140608390211584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:50:17.606975 140608390211584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:50:17.628990 140608390211584 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:50:17.629230 140608390211584 replay_runner.py:41] Starting iteration 0
Steps executed: 296 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 144.56
I0901 23:50:24.547525 140608390211584 replay_runner.py:36] Average training steps per second: 144.56
I0901 23:50:25.892849 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 1

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.20
I0901 23:50:30.997544 140608390211584 replay_runner.py:36] Average training steps per second: 203.20
I0901 23:50:31.162490 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 2
I0901 23:50:31.351124 140608390211584 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 204.77
I0901 23:50:36.234882 140608390211584 replay_runner.py:36] Average training steps per second: 204.77
I0901 23:50:36.360797 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0901 23:50:36.540622 140608390211584 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 212.67
I0901 23:50:41.242993 140608390211584 replay_runner.py:36] Average training steps per second: 212.67
I0901 23:50:41.357971 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 390 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.85
I0901 23:50:46.532633 140608390211584 replay_runner.py:36] Average training steps per second: 199.85
I0901 23:50:46.790313 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 5

Steps executed: 309 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 212.73
I0901 23:50:51.662290 140608390211584 replay_runner.py:36] Average training steps per second: 212.73
I0901 23:50:51.856456 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.50
INFO:tensorflow:Starting iteration 6

Steps executed: 366 Episode length: 185 Return: 185.0
INFO:tensorflow:Average training steps per second: 205.61
I0901 23:50:56.906851 140608390211584 replay_runner.py:36] Average training steps per second: 205.61
I0901 23:50:57.142700 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00
INFO:tensorflow:Starting iteration 7

Steps executed: 281 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 202.01
I0901 23:51:02.284813 140608390211584 replay_runner.py:36] Average training steps per second: 202.01
I0901 23:51:02.459954 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 8

Steps executed: 266 Episode length: 132 Return: 132.0
INFO:tensorflow:Average training steps per second: 201.16
I0901 23:51:07.599813 140608390211584 replay_runner.py:36] Average training steps per second: 201.16
I0901 23:51:07.808064 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 9

Steps executed: 214 Episode length: 106 Return: 106.0
INFO:tensorflow:Average training steps per second: 192.99
I0901 23:51:13.186963 140608390211584 replay_runner.py:36] Average training steps per second: 192.99
I0901 23:51:13.319257 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 107.00
INFO:tensorflow:Starting iteration 10

Steps executed: 318 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 200.27
I0901 23:51:18.498936 140608390211584 replay_runner.py:36] Average training steps per second: 200.27
I0901 23:51:18.720534 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 11

Steps executed: 236 Episode length: 116 Return: 116.0
INFO:tensorflow:Average training steps per second: 192.03
I0901 23:51:24.119387 140608390211584 replay_runner.py:36] Average training steps per second: 192.03
I0901 23:51:24.279983 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.00
INFO:tensorflow:Starting iteration 12

Steps executed: 279 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 195.85
I0901 23:51:29.564230 140608390211584 replay_runner.py:36] Average training steps per second: 195.85
I0901 23:51:29.766211 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.50
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.02
I0901 23:51:35.117952 140608390211584 replay_runner.py:36] Average training steps per second: 194.02
I0901 23:51:35.261071 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0901 23:51:35.442962 140608390211584 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 195.27
I0901 23:51:40.564605 140608390211584 replay_runner.py:36] Average training steps per second: 195.27
I0901 23:51:40.699398 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15
I0901 23:51:40.893719 140608390211584 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 189.81
I0901 23:51:46.162633 140608390211584 replay_runner.py:36] Average training steps per second: 189.81
I0901 23:51:46.296944 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16
I0901 23:51:46.483377 140608390211584 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 195.60
I0901 23:51:51.596323 140608390211584 replay_runner.py:36] Average training steps per second: 195.60
I0901 23:51:51.734687 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0901 23:51:51.927133 140608390211584 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 195.77
I0901 23:51:57.035731 140608390211584 replay_runner.py:36] Average training steps per second: 195.77
I0901 23:51:57.192834 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 390 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.60
I0901 23:52:02.613664 140608390211584 replay_runner.py:36] Average training steps per second: 191.60
I0901 23:52:02.870728 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.66
I0901 23:52:08.227162 140608390211584 replay_runner.py:36] Average training steps per second: 193.66
I0901 23:52:08.367279 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 23:52:08.537978 140608390211584 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 195.03
I0901 23:52:13.665895 140608390211584 replay_runner.py:36] Average training steps per second: 195.03
I0901 23:52:13.802552 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:52:13.990678 140608390211584 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.82
I0901 23:52:18.995674 140608390211584 replay_runner.py:36] Average training steps per second: 199.82
I0901 23:52:19.142081 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:52:19.337720 140608390211584 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 190.05
I0901 23:52:24.600206 140608390211584 replay_runner.py:36] Average training steps per second: 190.05
I0901 23:52:24.742221 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0901 23:52:24.923412 140608390211584 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 193.84
I0901 23:52:30.082627 140608390211584 replay_runner.py:36] Average training steps per second: 193.84
I0901 23:52:30.230277 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 23:52:30.416034 140608390211584 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 191.90
I0901 23:52:35.627471 140608390211584 replay_runner.py:36] Average training steps per second: 191.90
I0901 23:52:35.755174 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:52:35.944043 140608390211584 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.23
I0901 23:52:41.066435 140608390211584 replay_runner.py:36] Average training steps per second: 195.23
I0901 23:52:41.209540 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:52:41.407461 140608390211584 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 195.57
I0901 23:52:46.521295 140608390211584 replay_runner.py:36] Average training steps per second: 195.57
I0901 23:52:46.660900 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:52:46.851285 140608390211584 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.89
I0901 23:52:51.930817 140608390211584 replay_runner.py:36] Average training steps per second: 196.89
I0901 23:52:52.063091 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:52:52.243454 140608390211584 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 196.06
I0901 23:52:57.344417 140608390211584 replay_runner.py:36] Average training steps per second: 196.06
I0901 23:52:57.482652 140608390211584 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0901 23:52:57.669003 140608390211584 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 202.40
I0901 23:53:02.610003 140608390211584 replay_runner.py:36] Average training steps per second: 202.40

Done fixed training!Episode length: 200 Return: 200.0