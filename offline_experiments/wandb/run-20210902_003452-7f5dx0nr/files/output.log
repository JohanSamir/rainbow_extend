I0902 00:34:58.585410 140053067847680 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:58.596020 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:58.596218 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:58.596359 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:58.596529 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:58.596649 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:58.596814 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:58.596935 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:58.597081 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:58.597200 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:58.597324 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:58.597448 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:58.597586 140053067847680 dqn_agent.py:283] 	 seed: 1630542898595972
I0902 00:34:58.600444 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:58.600605 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:58.600761 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:58.600884 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:58.601005 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:58.601138 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:58.601257 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:58.601430 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:58.601555 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:58.636830 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:58.913548 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:58.925203 140053067847680 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:58.931812 140053067847680 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:58.932013 140053067847680 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:58.932149 140053067847680 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:58.932287 140053067847680 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:58.932423 140053067847680 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:58.932532 140053067847680 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:58.932620 140053067847680 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:58.932839 140053067847680 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:58.932926 140053067847680 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:58.932999 140053067847680 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:58.933071 140053067847680 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:58.933141 140053067847680 dqn_agent.py:283] 	 seed: 1630542898931779
I0902 00:34:58.934635 140053067847680 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:58.934785 140053067847680 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:58.934861 140053067847680 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:58.934929 140053067847680 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:58.934986 140053067847680 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:58.935059 140053067847680 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:58.935121 140053067847680 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:58.935202 140053067847680 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:58.935269 140053067847680 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:58.960953 140053067847680 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:58.977668 140053067847680 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:58.977940 140053067847680 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 248.04
I0902 00:35:03.010174 140053067847680 replay_runner.py:36] Average training steps per second: 248.04
I0902 00:35:03.697911 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.56
Steps executed: 280 Episode length: 88 Return: -26.175510418252017
INFO:tensorflow:Starting iteration 1

Steps executed: 146 Episode length: 73 Return: -635.12953148839327
INFO:tensorflow:Average training steps per second: 341.09
I0902 00:35:10.072104 140053067847680 replay_runner.py:36] Average training steps per second: 341.09

Steps executed: 211 Episode length: 65 Return: -468.25701633528177
INFO:tensorflow:Starting iteration 2

Steps executed: 296 Episode length: 100 Return: -857.13689338221216
INFO:tensorflow:Average training steps per second: 338.26
I0902 00:35:16.538398 140053067847680 replay_runner.py:36] Average training steps per second: 338.26
I0902 00:35:16.714936 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -607.98
INFO:tensorflow:Starting iteration 3

Steps executed: 219 Episode length: 88 Return: -105.538050369008544
INFO:tensorflow:Average training steps per second: 345.01
I0902 00:35:23.094034 140053067847680 replay_runner.py:36] Average training steps per second: 345.01
I0902 00:35:23.206147 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.46
INFO:tensorflow:Starting iteration 4

Steps executed: 219 Episode length: 89 Return: -474.611315197558956
INFO:tensorflow:Average training steps per second: 340.58
I0902 00:35:29.555124 140053067847680 replay_runner.py:36] Average training steps per second: 340.58
I0902 00:35:29.704588 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -451.68
INFO:tensorflow:Starting iteration 5

Steps executed: 323 Episode length: 175 Return: -228.87574539540148
INFO:tensorflow:Average training steps per second: 337.20
I0902 00:35:36.034728 140053067847680 replay_runner.py:36] Average training steps per second: 337.20
I0902 00:35:36.216164 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.10
INFO:tensorflow:Starting iteration 6

Steps executed: 275 Episode length: 275 Return: -444.60170269844198
INFO:tensorflow:Average training steps per second: 327.65
I0902 00:35:42.603972 140053067847680 replay_runner.py:36] Average training steps per second: 327.65
I0902 00:35:42.841906 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.60
INFO:tensorflow:Starting iteration 7

Steps executed: 265 Episode length: 265 Return: -193.00347161842748
INFO:tensorflow:Average training steps per second: 320.71
I0902 00:35:49.225925 140053067847680 replay_runner.py:36] Average training steps per second: 320.71
I0902 00:35:49.440371 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.00
INFO:tensorflow:Starting iteration 8
I0902 00:35:52.725055 140053067847680 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 326.11

Steps executed: 568 Episode length: 568 Return: -404.29696867743068
I0902 00:35:56.582015 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.30
INFO:tensorflow:Starting iteration 9

Steps executed: 270 Episode length: 212 Return: -163.10677499824322
INFO:tensorflow:Average training steps per second: 324.26
I0902 00:36:03.001122 140053067847680 replay_runner.py:36] Average training steps per second: 324.26
I0902 00:36:03.190033 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.92
INFO:tensorflow:Starting iteration 10

Steps executed: 346 Episode length: 185 Return: -123.90331676465917
INFO:tensorflow:Average training steps per second: 329.67
I0902 00:36:09.552548 140053067847680 replay_runner.py:36] Average training steps per second: 329.67
I0902 00:36:09.775225 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.22
INFO:tensorflow:Starting iteration 11

Steps executed: 218 Episode length: 150 Return: -324.33348969034887
INFO:tensorflow:Average training steps per second: 331.63
I0902 00:36:16.164142 140053067847680 replay_runner.py:36] Average training steps per second: 331.63
I0902 00:36:16.297745 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -423.75
INFO:tensorflow:Starting iteration 12

Steps executed: 298 Episode length: 147 Return: -462.33145964968387
INFO:tensorflow:Average training steps per second: 333.24
I0902 00:36:22.725789 140053067847680 replay_runner.py:36] Average training steps per second: 333.24
I0902 00:36:22.903431 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -553.87
INFO:tensorflow:Starting iteration 13

Steps executed: 216 Episode length: 216 Return: -601.00724978599717
INFO:tensorflow:Average training steps per second: 344.92
I0902 00:36:29.205028 140053067847680 replay_runner.py:36] Average training steps per second: 344.92
I0902 00:36:29.344827 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -601.01
INFO:tensorflow:Starting iteration 14

Steps executed: 259 Episode length: 63 Return: -257.968042253755137
INFO:tensorflow:Average training steps per second: 341.22
I0902 00:36:35.686034 140053067847680 replay_runner.py:36] Average training steps per second: 341.22
I0902 00:36:35.830332 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.85
INFO:tensorflow:Starting iteration 15

Steps executed: 242 Episode length: 52 Return: -165.970322389971337
INFO:tensorflow:Average training steps per second: 338.85
I0902 00:36:42.229519 140053067847680 replay_runner.py:36] Average training steps per second: 338.85
I0902 00:36:42.357913 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.07
INFO:tensorflow:Starting iteration 16

Steps executed: 118 Episode length: 118 Return: -327.00748819655706
INFO:tensorflow:Average training steps per second: 339.21
I0902 00:36:48.672911 140053067847680 replay_runner.py:36] Average training steps per second: 339.21

Steps executed: 223 Episode length: 105 Return: -597.73855505182796
INFO:tensorflow:Starting iteration 17

Steps executed: 325 Episode length: 189 Return: 6.89254487496940366
INFO:tensorflow:Average training steps per second: 331.87
I0902 00:36:55.223154 140053067847680 replay_runner.py:36] Average training steps per second: 331.87
I0902 00:36:55.439004 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.00
INFO:tensorflow:Starting iteration 18

Steps executed: 359 Episode length: 170 Return: -182.70975266392134
INFO:tensorflow:Average training steps per second: 328.92
I0902 00:37:01.911235 140053067847680 replay_runner.py:36] Average training steps per second: 328.92
I0902 00:37:02.108662 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.92
INFO:tensorflow:Starting iteration 19
I0902 00:37:05.527902 140053067847680 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 332.15
I0902 00:37:08.538984 140053067847680 replay_runner.py:36] Average training steps per second: 332.15

Steps executed: 286 Episode length: 286 Return: -692.37567813502884
INFO:tensorflow:Starting iteration 20

Steps executed: 276 Episode length: 101 Return: -576.01429193774024
INFO:tensorflow:Average training steps per second: 329.63
I0902 00:37:15.204440 140053067847680 replay_runner.py:36] Average training steps per second: 329.63
I0902 00:37:15.352730 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.65
INFO:tensorflow:Starting iteration 21

Steps executed: 307 Episode length: 132 Return: -220.66585894997502
INFO:tensorflow:Average training steps per second: 332.22
I0902 00:37:21.785243 140053067847680 replay_runner.py:36] Average training steps per second: 332.22
I0902 00:37:21.992023 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.91
INFO:tensorflow:Starting iteration 22

Steps executed: 117 Episode length: 57 Return: -310.597328248885962
INFO:tensorflow:Average training steps per second: 335.44
I0902 00:37:28.412513 140053067847680 replay_runner.py:36] Average training steps per second: 335.44

Steps executed: 248 Episode length: 52 Return: -332.560365619141462
INFO:tensorflow:Starting iteration 23

Steps executed: 215 Episode length: 160 Return: -329.25451425714862
INFO:tensorflow:Average training steps per second: 342.75
I0902 00:37:34.854582 140053067847680 replay_runner.py:36] Average training steps per second: 342.75
I0902 00:37:34.992153 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.13
INFO:tensorflow:Starting iteration 24

Steps executed: 244 Episode length: 63 Return: -493.445118477696942
INFO:tensorflow:Average training steps per second: 341.26
I0902 00:37:41.331030 140053067847680 replay_runner.py:36] Average training steps per second: 341.26
I0902 00:37:41.477264 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -475.84
INFO:tensorflow:Starting iteration 25

Steps executed: 273 Episode length: 81 Return: -482.913694460001962
INFO:tensorflow:Average training steps per second: 333.77
I0902 00:37:47.902462 140053067847680 replay_runner.py:36] Average training steps per second: 333.77
I0902 00:37:48.056337 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.70
INFO:tensorflow:Starting iteration 26

Steps executed: 277 Episode length: 115 Return: -545.08960290151132
INFO:tensorflow:Average training steps per second: 335.74
I0902 00:37:54.393960 140053067847680 replay_runner.py:36] Average training steps per second: 335.74
I0902 00:37:54.526015 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -481.42
INFO:tensorflow:Starting iteration 27
I0902 00:37:57.783102 140053067847680 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 334.56

Steps executed: 243 Episode length: 59 Return: -420.375527216232742
I0902 00:38:00.909539 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.74
INFO:tensorflow:Starting iteration 28

Steps executed: 250 Episode length: 52 Return: -456.701729461821662
INFO:tensorflow:Average training steps per second: 337.34
I0902 00:38:07.238843 140053067847680 replay_runner.py:36] Average training steps per second: 337.34
I0902 00:38:07.383470 140053067847680 run_experiment.py:428] Average undiscounted return per evaluation episode: -546.21
INFO:tensorflow:Starting iteration 29

Steps executed: 245 Episode length: 50 Return: -381.157090765452342
INFO:tensorflow:Average training steps per second: 330.14
I0902 00:38:13.667166 140053067847680 replay_runner.py:36] Average training steps per second: 330.14

Done fixed training!Episode length: 50 Return: -381.157090765452342