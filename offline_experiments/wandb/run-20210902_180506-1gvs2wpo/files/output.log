Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0902 18:05:12.861865 140613433649152 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:12.871660 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:12.871940 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:12.872093 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:12.872222 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:12.872358 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:12.872514 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:12.872642 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:12.872922 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:12.873130 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:12.873286 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:12.873457 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:12.873583 140613433649152 dqn_agent.py:283] 	 seed: 1630605912871591
I0902 18:05:12.876337 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:12.876595 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:12.876741 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:12.876834 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:12.876913 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:12.877030 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:12.877126 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:12.877207 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:12.877303 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:12.921386 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:13.276242 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:13.291240 140613433649152 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:13.301728 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:13.302021 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:13.302170 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:13.302269 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:13.302345 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:13.302472 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:13.302588 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:13.302670 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:13.302797 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:13.302955 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:13.303119 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:13.303218 140613433649152 dqn_agent.py:283] 	 seed: 1630605913301660
I0902 18:05:13.305130 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:13.305322 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:13.305469 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:13.305610 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:13.305732 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:13.305846 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:13.305948 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:13.306087 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:13.306206 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:13.336183 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:13.389902 140613433649152 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:13.390124 140613433649152 replay_runner.py:41] Starting iteration 0
Steps executed: 212 Episode length: 105 Return: -167.67031226369719
INFO:tensorflow:Average training steps per second: 171.29
I0902 18:05:19.228210 140613433649152 replay_runner.py:36] Average training steps per second: 171.29
I0902 18:05:20.377151 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.98
INFO:tensorflow:Starting iteration 1

Steps executed: 334 Episode length: 155 Return: -252.08340582006173
INFO:tensorflow:Average training steps per second: 221.14
I0902 18:05:29.140773 140613433649152 replay_runner.py:36] Average training steps per second: 221.14
I0902 18:05:29.425749 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.70
INFO:tensorflow:Starting iteration 2

Steps executed: 208 Episode length: 105 Return: -400.78101689910125
INFO:tensorflow:Average training steps per second: 221.15
I0902 18:05:38.260681 140613433649152 replay_runner.py:36] Average training steps per second: 221.15
I0902 18:05:38.435054 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -332.79
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: -252.26918581359104
INFO:tensorflow:Average training steps per second: 224.21
I0902 18:05:47.219262 140613433649152 replay_runner.py:36] Average training steps per second: 224.21
I0902 18:05:47.393034 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -252.27
INFO:tensorflow:Starting iteration 4

Steps executed: 316 Episode length: 178 Return: -261.74162745971344
INFO:tensorflow:Average training steps per second: 229.92
I0902 18:05:55.969061 140613433649152 replay_runner.py:36] Average training steps per second: 229.92
I0902 18:05:56.219957 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.10
INFO:tensorflow:Starting iteration 5

Steps executed: 490 Episode length: 303 Return: -43.276765376159934
INFO:tensorflow:Average training steps per second: 228.78
I0902 18:06:04.868786 140613433649152 replay_runner.py:36] Average training steps per second: 228.78
I0902 18:06:05.418934 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.69
INFO:tensorflow:Starting iteration 6

Steps executed: 267 Episode length: 103 Return: -230.47762487935914
INFO:tensorflow:Average training steps per second: 224.06
I0902 18:06:14.061059 140613433649152 replay_runner.py:36] Average training steps per second: 224.06
I0902 18:06:14.312041 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -246.51
INFO:tensorflow:Starting iteration 7

Steps executed: 306 Episode length: 194 Return: -421.37604423982265
INFO:tensorflow:Average training steps per second: 217.92
I0902 18:06:23.252352 140613433649152 replay_runner.py:36] Average training steps per second: 217.92
I0902 18:06:23.544993 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -358.80
INFO:tensorflow:Starting iteration 8

Steps executed: 268 Episode length: 119 Return: -209.92197676498915
INFO:tensorflow:Average training steps per second: 215.78
I0902 18:06:32.501814 140613433649152 replay_runner.py:36] Average training steps per second: 215.78
I0902 18:06:32.736920 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.19
INFO:tensorflow:Starting iteration 9

Steps executed: 224 Episode length: 100 Return: -692.32013266675698
INFO:tensorflow:Average training steps per second: 216.24
I0902 18:06:41.531016 140613433649152 replay_runner.py:36] Average training steps per second: 216.24
I0902 18:06:41.720628 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -422.13
INFO:tensorflow:Starting iteration 10
I0902 18:06:46.112406 140613433649152 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 217.12

Steps executed: 300 Episode length: 143 Return: -396.79438787709296
I0902 18:06:50.998341 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -473.85
INFO:tensorflow:Starting iteration 11

Steps executed: 308 Episode length: 183 Return: -373.22736750465964
INFO:tensorflow:Average training steps per second: 220.02
I0902 18:06:59.915289 140613433649152 replay_runner.py:36] Average training steps per second: 220.02
I0902 18:07:00.200819 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.02
INFO:tensorflow:Starting iteration 12

Steps executed: 337 Episode length: 185 Return: -69.128563285947684
INFO:tensorflow:Average training steps per second: 218.27
I0902 18:07:09.060577 140613433649152 replay_runner.py:36] Average training steps per second: 218.27
I0902 18:07:09.371415 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.47
INFO:tensorflow:Starting iteration 13

Steps executed: 232 Episode length: 98 Return: -193.876085273175054
INFO:tensorflow:Average training steps per second: 218.19
I0902 18:07:18.313433 140613433649152 replay_runner.py:36] Average training steps per second: 218.19
I0902 18:07:18.512840 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.94
INFO:tensorflow:Starting iteration 14

Steps executed: 324 Episode length: 173 Return: -293.03790808572285
INFO:tensorflow:Average training steps per second: 220.85
I0902 18:07:27.204160 140613433649152 replay_runner.py:36] Average training steps per second: 220.85
I0902 18:07:27.505265 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.70
INFO:tensorflow:Starting iteration 15

Steps executed: 211 Episode length: 101 Return: -420.85879375777847
INFO:tensorflow:Average training steps per second: 234.76
I0902 18:07:36.087667 140613433649152 replay_runner.py:36] Average training steps per second: 234.76
I0902 18:07:36.255159 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.13
INFO:tensorflow:Starting iteration 16

Steps executed: 244 Episode length: 96 Return: -258.196794406055067
INFO:tensorflow:Average training steps per second: 223.43
I0902 18:07:44.886422 140613433649152 replay_runner.py:36] Average training steps per second: 223.43
I0902 18:07:45.092941 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -326.55
INFO:tensorflow:Starting iteration 17

Steps executed: 291 Episode length: 146 Return: -379.11909853533375
INFO:tensorflow:Average training steps per second: 222.18
I0902 18:07:53.870636 140613433649152 replay_runner.py:36] Average training steps per second: 222.18
I0902 18:07:54.152453 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.90
INFO:tensorflow:Starting iteration 18
I0902 18:07:58.385809 140613433649152 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 233.74
I0902 18:08:02.664436 140613433649152 replay_runner.py:36] Average training steps per second: 233.74

Steps executed: 219 Episode length: 96 Return: -631.884907698580275
INFO:tensorflow:Starting iteration 19

Steps executed: 271 Episode length: 140 Return: -85.593164280288425
INFO:tensorflow:Average training steps per second: 231.11
I0902 18:08:11.375555 140613433649152 replay_runner.py:36] Average training steps per second: 231.11
I0902 18:08:11.642936 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.62
INFO:tensorflow:Starting iteration 20

Steps executed: 218 Episode length: 87 Return: -446.352802892580611
INFO:tensorflow:Average training steps per second: 225.52
I0902 18:08:20.366896 140613433649152 replay_runner.py:36] Average training steps per second: 225.52
I0902 18:08:20.545953 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -282.78
INFO:tensorflow:Starting iteration 21
I0902 18:08:24.851597 140613433649152 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 230.79

Steps executed: 248 Episode length: 138 Return: -308.23737936753711
I0902 18:08:29.407408 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.60
INFO:tensorflow:Starting iteration 22

Steps executed: 102 Episode length: 102 Return: -634.18604352446891
INFO:tensorflow:Average training steps per second: 220.47
I0902 18:08:38.223886 140613433649152 replay_runner.py:36] Average training steps per second: 220.47

Steps executed: 478 Episode length: 376 Return: 156.692029022559271
INFO:tensorflow:Starting iteration 23

Steps executed: 208 Episode length: 78 Return: -495.733322084123251
INFO:tensorflow:Average training steps per second: 219.44
I0902 18:08:47.662074 140613433649152 replay_runner.py:36] Average training steps per second: 219.44
I0902 18:08:47.855676 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -414.06
INFO:tensorflow:Starting iteration 24

Steps executed: 259 Episode length: 142 Return: -105.15441613581274
INFO:tensorflow:Average training steps per second: 219.65
I0902 18:08:56.782376 140613433649152 replay_runner.py:36] Average training steps per second: 219.65
I0902 18:08:56.998322 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.03
INFO:tensorflow:Starting iteration 25

Steps executed: 240 Episode length: 150 Return: -111.84482061013846
INFO:tensorflow:Average training steps per second: 221.07
I0902 18:09:05.769798 140613433649152 replay_runner.py:36] Average training steps per second: 221.07
I0902 18:09:05.965871 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.90
INFO:tensorflow:Starting iteration 26

Steps executed: 217 Episode length: 127 Return: -188.48192706199612
INFO:tensorflow:Average training steps per second: 226.60
I0902 18:09:14.646548 140613433649152 replay_runner.py:36] Average training steps per second: 226.60
I0902 18:09:14.834851 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.87
INFO:tensorflow:Starting iteration 27

Steps executed: 295 Episode length: 136 Return: -128.51638089306232
INFO:tensorflow:Average training steps per second: 225.75
I0902 18:09:23.656090 140613433649152 replay_runner.py:36] Average training steps per second: 225.75
I0902 18:09:23.914792 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.71
INFO:tensorflow:Starting iteration 28

Steps executed: 209 Episode length: 92 Return: -454.943828974405996
INFO:tensorflow:Average training steps per second: 221.47
I0902 18:09:32.673082 140613433649152 replay_runner.py:36] Average training steps per second: 221.47
I0902 18:09:32.835750 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -399.32
INFO:tensorflow:Starting iteration 29

Steps executed: 217 Episode length: 217 Return: -128.61075312583136
INFO:tensorflow:Average training steps per second: 223.35
I0902 18:09:41.570699 140613433649152 replay_runner.py:36] Average training steps per second: 223.35

Done fixed training!Episode length: 217 Return: -128.61075312583136