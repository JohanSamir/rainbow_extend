Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 18:21:34.000699 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 18:21:34.008800 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:34.008930 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:34.009004 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:34.009066 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:34.009124 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:34.009206 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:34.009259 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:34.009356 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:34.009434 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:34.009509 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:34.009582 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:34.009648 140016423897088 dqn_agent.py:283] 	 seed: 1630606894008752
I0902 18:21:34.011328 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:34.011445 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:34.011520 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:34.011582 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:34.011639 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:34.011709 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:34.011770 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:34.011849 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:34.011902 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:34.033589 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:34.331711 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:34.340799 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:21:34.350010 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:21:34.350141 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:21:34.350207 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:21:34.350261 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:21:34.350310 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:21:34.350355 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:21:34.350400 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:21:34.350444 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:21:34.350487 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:21:34.350531 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:21:34.350608 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:21:34.350652 140016423897088 dqn_agent.py:283] 	 seed: 1630606894349980
I0902 18:21:34.352896 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:21:34.353042 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:21:34.353144 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:21:34.353312 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:21:34.353410 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:21:34.353494 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:21:34.353600 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:21:34.353710 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:21:34.353803 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:21:34.373411 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000031
I0902 18:21:34.391704 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:21:34.391901 140016423897088 replay_runner.py:41] Starting iteration 0
Steps executed: 288 Episode length: 161 Return: -289.84403428218025
INFO:tensorflow:Average training steps per second: 241.95
I0902 18:21:38.525119 140016423897088 replay_runner.py:36] Average training steps per second: 241.95
I0902 18:21:39.290250 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.56
INFO:tensorflow:Starting iteration 1

Steps executed: 328 Episode length: 166 Return: -490.59536891261615
INFO:tensorflow:Average training steps per second: 351.42
I0902 18:21:45.374278 140016423897088 replay_runner.py:36] Average training steps per second: 351.42
I0902 18:21:45.546215 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.95
INFO:tensorflow:Starting iteration 2

Steps executed: 295 Episode length: 116 Return: -277.66108893934235
INFO:tensorflow:Average training steps per second: 325.59
I0902 18:21:51.912297 140016423897088 replay_runner.py:36] Average training steps per second: 325.59
I0902 18:21:52.086433 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.85
INFO:tensorflow:Starting iteration 3
I0902 18:21:55.321982 140016423897088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 337.53

Steps executed: 1000 Episode length: 1000 Return: -141.19998883198164
I0902 18:22:00.135633 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.20
INFO:tensorflow:Starting iteration 4
I0902 18:22:03.475322 140016423897088 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 332.77

Steps executed: 1000 Episode length: 1000 Return: -109.90745377172144
I0902 18:22:08.157294 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.91
INFO:tensorflow:Starting iteration 5
I0902 18:22:11.474571 140016423897088 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 325.71

Steps executed: 1000 Episode length: 1000 Return: -317.13094743672624
I0902 18:22:16.282499 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.13
INFO:tensorflow:Starting iteration 6
I0902 18:22:19.641134 140016423897088 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 347.34

Steps executed: 938 Episode length: 938 Return: -523.6663220369699624
I0902 18:22:24.186381 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -523.67
INFO:tensorflow:Starting iteration 7

Steps executed: 308 Episode length: 157 Return: -155.0429926367753224
INFO:tensorflow:Average training steps per second: 360.16
I0902 18:22:30.320755 140016423897088 replay_runner.py:36] Average training steps per second: 360.16
I0902 18:22:30.499195 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.75
INFO:tensorflow:Starting iteration 8
I0902 18:22:33.939544 140016423897088 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 360.44

Steps executed: 869 Episode length: 869 Return: -315.2024330935996724
I0902 18:22:38.302037 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.20
INFO:tensorflow:Starting iteration 9
I0902 18:22:41.791884 140016423897088 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 365.48

Steps executed: 1000 Episode length: 1000 Return: -359.75081793986484
I0902 18:22:46.723489 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.75
INFO:tensorflow:Starting iteration 10
I0902 18:22:50.180468 140016423897088 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 350.47

Steps executed: 753 Episode length: 753 Return: -409.3524217944225484
I0902 18:22:54.335026 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.35
INFO:tensorflow:Starting iteration 11

Steps executed: 659 Episode length: 659 Return: -238.8731740306984484
INFO:tensorflow:Average training steps per second: 343.69
I0902 18:23:00.658550 140016423897088 replay_runner.py:36] Average training steps per second: 343.69
I0902 18:23:01.581142 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.87
INFO:tensorflow:Starting iteration 12

Steps executed: 320 Episode length: 320 Return: -296.6577908227904484
INFO:tensorflow:Average training steps per second: 359.27
I0902 18:23:07.782739 140016423897088 replay_runner.py:36] Average training steps per second: 359.27
I0902 18:23:08.045666 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -296.66
INFO:tensorflow:Starting iteration 13
I0902 18:23:11.474875 140016423897088 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 340.53

Steps executed: 1000 Episode length: 1000 Return: -90.182802336945884
I0902 18:23:16.487291 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.18
INFO:tensorflow:Starting iteration 14

Steps executed: 264 Episode length: 91 Return: -343.41879980674366884
INFO:tensorflow:Average training steps per second: 353.71
I0902 18:23:22.699436 140016423897088 replay_runner.py:36] Average training steps per second: 353.71
I0902 18:23:22.864527 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.62
INFO:tensorflow:Starting iteration 15

Steps executed: 290 Episode length: 151 Return: -208.8574886136272884
INFO:tensorflow:Average training steps per second: 371.24
I0902 18:23:29.040081 140016423897088 replay_runner.py:36] Average training steps per second: 371.24
I0902 18:23:29.195941 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -216.28
INFO:tensorflow:Starting iteration 16
I0902 18:23:32.606000 140016423897088 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 333.86

Steps executed: 1000 Episode length: 1000 Return: -90.148704829480544
I0902 18:23:37.615939 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.15
INFO:tensorflow:Starting iteration 17
I0902 18:23:41.019486 140016423897088 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 331.41

Steps executed: 1000 Episode length: 1000 Return: -61.137643512591744
I0902 18:23:45.091490 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -61.14
INFO:tensorflow:Starting iteration 18
I0902 18:23:48.471366 140016423897088 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 331.35

Steps executed: 669 Episode length: 669 Return: -701.3432109958372744
I0902 18:23:52.637351 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -701.34
INFO:tensorflow:Starting iteration 19

Steps executed: 412 Episode length: 412 Return: -78.80985036604591744
INFO:tensorflow:Average training steps per second: 335.23
I0902 18:23:58.984766 140016423897088 replay_runner.py:36] Average training steps per second: 335.23
I0902 18:23:59.379390 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.81
INFO:tensorflow:Starting iteration 20
I0902 18:24:02.773775 140016423897088 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 334.92

Steps executed: 1000 Episode length: 1000 Return: -39.007444533053054
I0902 18:24:08.520871 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -39.01
INFO:tensorflow:Starting iteration 21

Steps executed: 374 Episode length: 229 Return: -104.5845204157720554
INFO:tensorflow:Average training steps per second: 336.26
I0902 18:24:14.845602 140016423897088 replay_runner.py:36] Average training steps per second: 336.26
I0902 18:24:15.100513 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.27
INFO:tensorflow:Starting iteration 22
I0902 18:24:18.426145 140016423897088 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 340.62

Steps executed: 1000 Episode length: 1000 Return: -169.32754740345964
I0902 18:24:23.857409 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.33
INFO:tensorflow:Starting iteration 23
I0902 18:24:26.939990 140016423897088 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 317.57
I0902 18:24:30.089258 140016423897088 replay_runner.py:36] Average training steps per second: 317.57

Steps executed: 220 Episode length: 54 Return: -126.31748164222047964
INFO:tensorflow:Starting iteration 24
I0902 18:24:33.391861 140016423897088 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 337.01

Steps executed: 1000 Episode length: 1000 Return: -110.58254542292046
I0902 18:24:39.233814 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.58
INFO:tensorflow:Starting iteration 25
I0902 18:24:42.446851 140016423897088 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 320.91

Steps executed: 834 Episode length: 834 Return: -147.1393033771297246
I0902 18:24:47.223578 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.14
INFO:tensorflow:Starting iteration 26
I0902 18:24:50.376777 140016423897088 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 322.36

Steps executed: 1000 Episode length: 1000 Return: 48.1910120051979246
I0902 18:24:55.621436 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: 48.19
INFO:tensorflow:Starting iteration 27
I0902 18:24:58.741518 140016423897088 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 324.50

Steps executed: 516 Episode length: 516 Return: -447.0759738847501746
I0902 18:25:02.344779 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -447.08
INFO:tensorflow:Starting iteration 28
I0902 18:25:05.446460 140016423897088 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 343.74

Steps executed: 345 Episode length: 161 Return: -442.8624280496061446
I0902 18:25:08.545726 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.79
INFO:tensorflow:Starting iteration 29

Steps executed: 844 Episode length: 844 Return: 234.61577096624598446
INFO:tensorflow:Average training steps per second: 341.11
I0902 18:25:14.508769 140016423897088 replay_runner.py:36] Average training steps per second: 341.11

Done fixed training!Episode length: 844 Return: 234.61577096624598446