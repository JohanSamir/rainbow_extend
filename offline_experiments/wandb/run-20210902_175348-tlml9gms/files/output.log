Loaded trained dqn in acrobot
Training fixed agent 10, please be patient, may be a while...
I0902 17:53:55.024366 140668698150912 run_experiment.py:549] Creating TrainRunner ...
I0902 17:53:55.034092 140668698150912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:55.034393 140668698150912 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:55.034635 140668698150912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:55.034809 140668698150912 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:55.034888 140668698150912 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:55.034963 140668698150912 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:55.035038 140668698150912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:55.035143 140668698150912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:55.035223 140668698150912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:55.035311 140668698150912 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:55.035553 140668698150912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:55.035726 140668698150912 dqn_agent.py:283] 	 seed: 1630605235034021
I0902 17:53:55.039411 140668698150912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:55.039623 140668698150912 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:55.039740 140668698150912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:55.039828 140668698150912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:55.039904 140668698150912 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:55.040009 140668698150912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:55.040121 140668698150912 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:55.040193 140668698150912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:55.040282 140668698150912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:55.079771 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:55.505907 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:55.542363 140668698150912 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 17:53:55.553285 140668698150912 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 17:53:55.553623 140668698150912 dqn_agent.py:272] 	 gamma: 0.990000
I0902 17:53:55.553864 140668698150912 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 17:53:55.554119 140668698150912 dqn_agent.py:274] 	 min_replay_history: 500
I0902 17:53:55.554226 140668698150912 dqn_agent.py:275] 	 update_period: 4
I0902 17:53:55.554350 140668698150912 dqn_agent.py:276] 	 target_update_period: 100
I0902 17:53:55.554483 140668698150912 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 17:53:55.554595 140668698150912 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 17:53:55.554737 140668698150912 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 17:53:55.554820 140668698150912 dqn_agent.py:280] 	 optimizer: adam
I0902 17:53:55.554989 140668698150912 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 17:53:55.555088 140668698150912 dqn_agent.py:283] 	 seed: 1630605235553218
I0902 17:53:55.558003 140668698150912 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 17:53:55.558197 140668698150912 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 17:53:55.558358 140668698150912 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 17:53:55.558500 140668698150912 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 17:53:55.558582 140668698150912 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 17:53:55.558663 140668698150912 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 17:53:55.558766 140668698150912 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 17:53:55.559026 140668698150912 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 17:53:55.559214 140668698150912 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 17:53:55.594345 140668698150912 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 17:53:55.613437 140668698150912 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 17:53:55.613664 140668698150912 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 138.95
I0902 17:54:02.810961 140668698150912 replay_runner.py:36] Average training steps per second: 138.95
I0902 17:54:04.349590 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 17:54:04.602249 140668698150912 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 196.71
I0902 17:54:09.686489 140668698150912 replay_runner.py:36] Average training steps per second: 196.71
I0902 17:54:10.098418 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 17:54:10.356181 140668698150912 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 190.74
I0902 17:54:15.599351 140668698150912 replay_runner.py:36] Average training steps per second: 190.74
I0902 17:54:16.014010 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 17:54:16.243628 140668698150912 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 193.02
I0902 17:54:21.424928 140668698150912 replay_runner.py:36] Average training steps per second: 193.02
I0902 17:54:21.860524 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 17:54:22.103427 140668698150912 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 194.14
I0902 17:54:27.254929 140668698150912 replay_runner.py:36] Average training steps per second: 194.14
I0902 17:54:27.685185 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 17:54:27.935278 140668698150912 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 191.71
I0902 17:54:33.152076 140668698150912 replay_runner.py:36] Average training steps per second: 191.71
I0902 17:54:33.572031 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 323 Episode length: 185 Return: -184.0
INFO:tensorflow:Average training steps per second: 191.74
I0902 17:54:39.028607 140668698150912 replay_runner.py:36] Average training steps per second: 191.74
I0902 17:54:39.305341 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.50
INFO:tensorflow:Starting iteration 7

Steps executed: 204 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 193.84
I0902 17:54:44.710258 140668698150912 replay_runner.py:36] Average training steps per second: 193.84
I0902 17:54:44.887512 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.00
INFO:tensorflow:Starting iteration 8

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 191.93
I0902 17:54:50.345957 140668698150912 replay_runner.py:36] Average training steps per second: 191.93
I0902 17:54:50.763134 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 17:54:51.016393 140668698150912 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 191.61
I0902 17:54:56.236166 140668698150912 replay_runner.py:36] Average training steps per second: 191.61
I0902 17:54:56.671164 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 377 Episode length: 377 Return: -376.0
INFO:tensorflow:Average training steps per second: 190.53
I0902 17:55:02.174615 140668698150912 replay_runner.py:36] Average training steps per second: 190.53
I0902 17:55:02.482234 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.00
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 192.99
I0902 17:55:07.906267 140668698150912 replay_runner.py:36] Average training steps per second: 192.99
I0902 17:55:08.304938 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0902 17:55:08.541463 140668698150912 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 193.82
I0902 17:55:13.701271 140668698150912 replay_runner.py:36] Average training steps per second: 193.82
I0902 17:55:14.097450 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13
I0902 17:55:14.337765 140668698150912 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 192.33
I0902 17:55:19.537583 140668698150912 replay_runner.py:36] Average training steps per second: 192.33
I0902 17:55:19.937381 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0902 17:55:20.181920 140668698150912 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 196.49
I0902 17:55:25.271961 140668698150912 replay_runner.py:36] Average training steps per second: 196.49
I0902 17:55:25.659557 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0902 17:55:25.895438 140668698150912 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 205.39
I0902 17:55:30.764880 140668698150912 replay_runner.py:36] Average training steps per second: 205.39
I0902 17:55:31.221102 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 346 Episode length: 167 Return: -166.0
INFO:tensorflow:Average training steps per second: 195.58
I0902 17:55:36.575165 140668698150912 replay_runner.py:36] Average training steps per second: 195.58
I0902 17:55:36.837515 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.00
INFO:tensorflow:Starting iteration 17

Steps executed: 333 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 196.48
I0902 17:55:42.161463 140668698150912 replay_runner.py:36] Average training steps per second: 196.48
I0902 17:55:42.418225 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.50
INFO:tensorflow:Starting iteration 18

Steps executed: 282 Episode length: 142 Return: -141.0
INFO:tensorflow:Average training steps per second: 191.89
I0902 17:55:47.876356 140668698150912 replay_runner.py:36] Average training steps per second: 191.89
I0902 17:55:48.124099 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.00
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.26
I0902 17:55:53.522981 140668698150912 replay_runner.py:36] Average training steps per second: 194.26
I0902 17:55:53.921935 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 553 Episode length: 386 Return: -385.0
INFO:tensorflow:Average training steps per second: 195.70
I0902 17:55:59.273719 140668698150912 replay_runner.py:36] Average training steps per second: 195.70
I0902 17:55:59.707679 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -275.50
INFO:tensorflow:Starting iteration 21

Steps executed: 374 Episode length: 374 Return: -373.0
INFO:tensorflow:Average training steps per second: 206.63
I0902 17:56:04.795311 140668698150912 replay_runner.py:36] Average training steps per second: 206.63
I0902 17:56:05.056673 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.00
INFO:tensorflow:Starting iteration 22

Steps executed: 225 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 200.98
I0902 17:56:10.252068 140668698150912 replay_runner.py:36] Average training steps per second: 200.98
I0902 17:56:10.472451 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 205.70
I0902 17:56:15.551478 140668698150912 replay_runner.py:36] Average training steps per second: 205.70
I0902 17:56:15.940983 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0902 17:56:16.163705 140668698150912 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 192.06

Steps executed: 224 Episode length: 130 Return: -129.0
I0902 17:56:21.556795 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 25

Steps executed: 235 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 196.06
I0902 17:56:26.898849 140668698150912 replay_runner.py:36] Average training steps per second: 196.06
I0902 17:56:27.098491 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 26

Steps executed: 300 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 195.14
I0902 17:56:32.470128 140668698150912 replay_runner.py:36] Average training steps per second: 195.14
I0902 17:56:32.720944 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 27

Steps executed: 245 Episode length: 129 Return: -128.0
INFO:tensorflow:Average training steps per second: 197.16
I0902 17:56:38.038928 140668698150912 replay_runner.py:36] Average training steps per second: 197.16
I0902 17:56:38.227368 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 28
I0902 17:56:38.466731 140668698150912 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 203.84

Steps executed: 279 Episode length: 89 Return: -88.0.0
I0902 17:56:43.600286 140668698150912 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 29

Steps executed: 341 Episode length: 148 Return: -147.0
INFO:tensorflow:Average training steps per second: 206.90
I0902 17:56:48.668714 140668698150912 replay_runner.py:36] Average training steps per second: 206.90

Done fixed training!Episode length: 148 Return: -147.0