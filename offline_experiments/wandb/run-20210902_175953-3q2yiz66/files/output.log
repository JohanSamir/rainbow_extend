Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0902 18:00:00.348166 140568413935616 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:00.358035 140568413935616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:00.358336 140568413935616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:00.358487 140568413935616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:00.358676 140568413935616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:00.358814 140568413935616 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:00.359000 140568413935616 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:00:00.359135 140568413935616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:00.359277 140568413935616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:00.359426 140568413935616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:00.359550 140568413935616 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:00.359672 140568413935616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:00.359787 140568413935616 dqn_agent.py:283] 	 seed: 1630605600357961
I0902 18:00:00.362931 140568413935616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:00.363126 140568413935616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:00:00.363299 140568413935616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:00.363573 140568413935616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:00.363755 140568413935616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:00.363937 140568413935616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:00.364177 140568413935616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:00.364296 140568413935616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:00.364496 140568413935616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:00.402486 140568413935616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:00.867163 140568413935616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:00.882095 140568413935616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:00.891055 140568413935616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:00.891315 140568413935616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:00.891452 140568413935616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:00.891595 140568413935616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:00.891774 140568413935616 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:00.892013 140568413935616 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:00:00.892219 140568413935616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:00.892433 140568413935616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:00.892567 140568413935616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:00.892695 140568413935616 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:00.892816 140568413935616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:00.892937 140568413935616 dqn_agent.py:283] 	 seed: 1630605600890998
I0902 18:00:00.895939 140568413935616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:00.896150 140568413935616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:00:00.896357 140568413935616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:00.896513 140568413935616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:00.896650 140568413935616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:00.896883 140568413935616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:00.897102 140568413935616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:00.897229 140568413935616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:00.897339 140568413935616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:00.934016 140568413935616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:00.954258 140568413935616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:00.954559 140568413935616 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 143.59
I0902 18:00:07.919251 140568413935616 replay_runner.py:36] Average training steps per second: 143.59
I0902 18:00:09.555674 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 219 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 203.56
I0902 18:00:14.700300 140568413935616 replay_runner.py:36] Average training steps per second: 203.56
I0902 18:00:14.870198 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.50
INFO:tensorflow:Starting iteration 2
I0902 18:00:15.103863 140568413935616 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 204.26

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:00:20.384869 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 18:00:20.610826 140568413935616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 205.39
I0902 18:00:25.480029 140568413935616 replay_runner.py:36] Average training steps per second: 205.39
I0902 18:00:25.889220 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 18:00:26.141190 140568413935616 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 192.07
I0902 18:00:31.348187 140568413935616 replay_runner.py:36] Average training steps per second: 192.07
I0902 18:00:31.735889 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 240 Episode length: 142 Return: -141.0
INFO:tensorflow:Average training steps per second: 201.80
I0902 18:00:36.927567 140568413935616 replay_runner.py:36] Average training steps per second: 201.80
I0902 18:00:37.130004 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 6
I0902 18:00:37.372396 140568413935616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 199.32
I0902 18:00:42.390050 140568413935616 replay_runner.py:36] Average training steps per second: 199.32
I0902 18:00:42.623156 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 7

Steps executed: 272 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 193.83
I0902 18:00:48.024492 140568413935616 replay_runner.py:36] Average training steps per second: 193.83

Steps executed: 92 Episode length: 92 Return: -91.00.0
INFO:tensorflow:Starting iteration 8

Steps executed: 253 Episode length: 161 Return: -160.0
INFO:tensorflow:Average training steps per second: 196.86
I0902 18:00:53.573374 140568413935616 replay_runner.py:36] Average training steps per second: 196.86
I0902 18:00:53.760995 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 9


Steps executed: 206 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 191.29
I0902 18:00:59.236240 140568413935616 replay_runner.py:36] Average training steps per second: 191.29
I0902 18:00:59.408811 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 10

Steps executed: 314 Episode length: 214 Return: -213.0
INFO:tensorflow:Average training steps per second: 193.39
I0902 18:01:04.828737 140568413935616 replay_runner.py:36] Average training steps per second: 193.39
I0902 18:01:05.116751 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.00
INFO:tensorflow:Starting iteration 11
I0902 18:01:05.365377 140568413935616 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 195.93
I0902 18:01:10.469698 140568413935616 replay_runner.py:36] Average training steps per second: 195.93
I0902 18:01:10.697191 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 12

Steps executed: 256 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 189.74
I0902 18:01:16.214344 140568413935616 replay_runner.py:36] Average training steps per second: 189.74

Steps executed: 266 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Starting iteration 13

Steps executed: 201 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 205.01
I0902 18:01:21.582771 140568413935616 replay_runner.py:36] Average training steps per second: 205.01
I0902 18:01:21.756631 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 14

Steps executed: 246 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 192.04
I0902 18:01:27.195585 140568413935616 replay_runner.py:36] Average training steps per second: 192.04
I0902 18:01:27.401167 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 15

Steps executed: 229 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 197.37
I0902 18:01:32.713129 140568413935616 replay_runner.py:36] Average training steps per second: 197.37
I0902 18:01:32.913792 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 16
I0902 18:01:33.167543 140568413935616 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.82

Steps executed: 247 Episode length: 71 Return: -70.0.0
I0902 18:01:38.458230 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 17

Steps executed: 221 Episode length: 70 Return: -69.0.0
INFO:tensorflow:Average training steps per second: 192.80
I0902 18:01:43.879342 140568413935616 replay_runner.py:36] Average training steps per second: 192.80
I0902 18:01:44.081948 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 18

Steps executed: 245 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 202.48
I0902 18:01:49.278253 140568413935616 replay_runner.py:36] Average training steps per second: 202.48
I0902 18:01:49.492629 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 19

Steps executed: 218 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 193.30
I0902 18:01:54.923570 140568413935616 replay_runner.py:36] Average training steps per second: 193.30
I0902 18:01:55.101553 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.67
INFO:tensorflow:Starting iteration 20

Steps executed: 245 Episode length: 72 Return: -71.000
INFO:tensorflow:Average training steps per second: 204.62
I0902 18:02:00.218400 140568413935616 replay_runner.py:36] Average training steps per second: 204.62
I0902 18:02:00.411410 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.67
INFO:tensorflow:Starting iteration 21

Steps executed: 305 Episode length: 138 Return: -137.0
INFO:tensorflow:Average training steps per second: 205.98
I0902 18:02:05.504399 140568413935616 replay_runner.py:36] Average training steps per second: 205.98
I0902 18:02:05.728083 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 205.38
I0902 18:02:10.854088 140568413935616 replay_runner.py:36] Average training steps per second: 205.38
I0902 18:02:11.065035 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 23

Steps executed: 263 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 211.43
I0902 18:02:16.037830 140568413935616 replay_runner.py:36] Average training steps per second: 211.43
I0902 18:02:16.247877 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 24

Steps executed: 241 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 198.25
I0902 18:02:21.535575 140568413935616 replay_runner.py:36] Average training steps per second: 198.25
I0902 18:02:21.722160 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 25

Steps executed: 221 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 202.67
I0902 18:02:26.897531 140568413935616 replay_runner.py:36] Average training steps per second: 202.67
I0902 18:02:27.079856 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.67
INFO:tensorflow:Starting iteration 26
I0902 18:02:27.321384 140568413935616 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 195.37
I0902 18:02:32.440241 140568413935616 replay_runner.py:36] Average training steps per second: 195.37

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 27

Steps executed: 244 Episode length: 72 Return: -71.0.0
INFO:tensorflow:Average training steps per second: 193.74
I0902 18:02:38.232645 140568413935616 replay_runner.py:36] Average training steps per second: 193.74
I0902 18:02:38.445346 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 28

Steps executed: 273 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 206.39
I0902 18:02:43.537674 140568413935616 replay_runner.py:36] Average training steps per second: 206.39
I0902 18:02:43.751721 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 166 Return: -165.0
INFO:tensorflow:Average training steps per second: 194.57
I0902 18:02:49.134093 140568413935616 replay_runner.py:36] Average training steps per second: 194.57
I0902 18:02:49.332548 140568413935616 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.00