Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:56:26.491451 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:56:26.500648 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:56:26.500897 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:56:26.501010 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:56:26.501194 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:56:26.501299 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:56:26.501391 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:56:26.501491 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:56:26.501580 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:56:26.501659 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:56:26.501738 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:56:26.501822 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:56:26.501913 140320049072128 dqn_agent.py:283] 	 seed: 1630500986500583
I0901 12:56:26.505019 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:56:26.505238 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:56:26.505333 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:56:26.505415 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:56:26.505491 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:56:26.505562 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:56:26.505636 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:56:26.505707 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:56:26.505965 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:56:26.545704 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:56:27.014312 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:56:27.029453 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:56:27.090169 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:56:27.090451 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:56:27.090591 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:56:27.090709 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:56:27.090821 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:56:27.090978 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:56:27.091102 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:56:27.091225 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:56:27.091335 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:56:27.091449 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:56:27.091556 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:56:27.091707 140320049072128 dqn_agent.py:283] 	 seed: 1630500987090084
I0901 12:56:27.094360 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:56:27.094568 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:56:27.094740 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:56:27.094959 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:56:27.095165 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:56:27.095419 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:56:27.095550 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:56:27.095659 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:56:27.095923 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:56:27.136499 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:56:27.161592 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:56:27.162042 140320049072128 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 137.13
I0901 12:56:34.454624 140320049072128 replay_runner.py:36] Average training steps per second: 137.13
I0901 12:56:36.003955 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:56:36.256124 140320049072128 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 200.93
I0901 12:56:41.233462 140320049072128 replay_runner.py:36] Average training steps per second: 200.93
I0901 12:56:41.666511 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:56:41.903480 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 208.55
I0901 12:56:46.698740 140320049072128 replay_runner.py:36] Average training steps per second: 208.55
I0901 12:56:47.122435 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:56:47.426596 140320049072128 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 200.85
I0901 12:56:52.405912 140320049072128 replay_runner.py:36] Average training steps per second: 200.85
I0901 12:56:52.819293 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:56:53.059574 140320049072128 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 195.59
I0901 12:56:58.172787 140320049072128 replay_runner.py:36] Average training steps per second: 195.59
I0901 12:56:58.594328 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:56:58.826585 140320049072128 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 193.81
I0901 12:57:03.986636 140320049072128 replay_runner.py:36] Average training steps per second: 193.81
I0901 12:57:04.429860 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:57:04.679787 140320049072128 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.86
I0901 12:57:09.785661 140320049072128 replay_runner.py:36] Average training steps per second: 195.86
I0901 12:57:10.205323 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 247 Episode length: 144 Return: -143.0
INFO:tensorflow:Average training steps per second: 194.91
I0901 12:57:15.589670 140320049072128 replay_runner.py:36] Average training steps per second: 194.91
I0901 12:57:15.806891 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.50
INFO:tensorflow:Starting iteration 8

Steps executed: 318 Episode length: 170 Return: -169.0
INFO:tensorflow:Average training steps per second: 197.93
I0901 12:57:21.093384 140320049072128 replay_runner.py:36] Average training steps per second: 197.93
I0901 12:57:21.378070 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 9

Steps executed: 208 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 194.53
I0901 12:57:26.768964 140320049072128 replay_runner.py:36] Average training steps per second: 194.53
I0901 12:57:26.949244 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 10

Steps executed: 283 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 196.09
I0901 12:57:32.286380 140320049072128 replay_runner.py:36] Average training steps per second: 196.09
I0901 12:57:32.537042 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 11

Steps executed: 260 Episode length: 188 Return: -187.0
INFO:tensorflow:Average training steps per second: 194.78
I0901 12:57:37.920352 140320049072128 replay_runner.py:36] Average training steps per second: 194.78
I0901 12:57:38.144703 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.00
INFO:tensorflow:Starting iteration 12

Steps executed: 270 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 187.96
I0901 12:57:43.709282 140320049072128 replay_runner.py:36] Average training steps per second: 187.96
I0901 12:57:43.943847 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.00
INFO:tensorflow:Starting iteration 13

Steps executed: 267 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 192.36
I0901 12:57:49.403589 140320049072128 replay_runner.py:36] Average training steps per second: 192.36
I0901 12:57:49.629432 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.00
INFO:tensorflow:Starting iteration 14

Steps executed: 327 Episode length: 192 Return: -191.0
INFO:tensorflow:Average training steps per second: 196.05
I0901 12:57:54.970963 140320049072128 replay_runner.py:36] Average training steps per second: 196.05
I0901 12:57:55.256197 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.50
INFO:tensorflow:Starting iteration 15

Steps executed: 265 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 190.85
I0901 12:58:00.746165 140320049072128 replay_runner.py:36] Average training steps per second: 190.85
I0901 12:58:01.005502 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -87.33
INFO:tensorflow:Starting iteration 16
I0901 12:58:01.261656 140320049072128 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 197.00

Steps executed: 271 Episode length: 82 Return: -81.0.0
I0901 12:58:06.575133 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 17

Steps executed: 291 Episode length: 174 Return: -173.0
INFO:tensorflow:Average training steps per second: 203.60
I0901 12:58:11.717949 140320049072128 replay_runner.py:36] Average training steps per second: 203.60
I0901 12:58:11.981600 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.50
INFO:tensorflow:Starting iteration 18

Steps executed: 312 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 192.70
I0901 12:58:17.406390 140320049072128 replay_runner.py:36] Average training steps per second: 192.70
I0901 12:58:17.685253 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 19

Steps executed: 294 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 192.84
I0901 12:58:23.112136 140320049072128 replay_runner.py:36] Average training steps per second: 192.84
I0901 12:58:23.360253 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.00
INFO:tensorflow:Starting iteration 20
I0901 12:58:23.609330 140320049072128 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.43

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:58:29.093967 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21

Steps executed: 276 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 199.55
I0901 12:58:34.349206 140320049072128 replay_runner.py:36] Average training steps per second: 199.55
I0901 12:58:34.582715 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.00
INFO:tensorflow:Starting iteration 22

Steps executed: 213 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 197.54
I0901 12:58:39.899307 140320049072128 replay_runner.py:36] Average training steps per second: 197.54
I0901 12:58:40.098674 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 195.12
I0901 12:58:45.466458 140320049072128 replay_runner.py:36] Average training steps per second: 195.12
I0901 12:58:45.646517 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 24

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.26
I0901 12:58:51.057154 140320049072128 replay_runner.py:36] Average training steps per second: 193.26
I0901 12:58:51.474063 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25
I0901 12:58:51.701483 140320049072128 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 193.24

Steps executed: 235 Episode length: 140 Return: -139.0
I0901 12:58:57.096148 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 26

Steps executed: 87 Episode length: 87 Return: -86.09.0
INFO:tensorflow:Average training steps per second: 185.10

Steps executed: 304 Episode length: 108 Return: -107.0
I0901 12:59:03.031793 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.33
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 190.70
I0901 12:59:08.526221 140320049072128 replay_runner.py:36] Average training steps per second: 190.70
I0901 12:59:08.704253 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 28

Steps executed: 273 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 190.10
I0901 12:59:14.189584 140320049072128 replay_runner.py:36] Average training steps per second: 190.10
I0901 12:59:14.426335 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 197.23
I0901 12:59:19.744330 140320049072128 replay_runner.py:36] Average training steps per second: 197.23
I0901 12:59:19.944125 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00