I0901 12:09:44.547941 139982171817984 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 12:09:44.548493 139982171817984 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 12:09:44.637618 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:44.640132 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:44.640384 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:44.640483 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:44.640602 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:44.640664 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:44.640717 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:44.640828 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:44.640993 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:44.641115 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:44.641231 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:44.641324 139982171817984 dqn_agent.py:283] 	 seed: 1630498184637539
I0901 12:09:44.643557 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:44.643715 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:44.643820 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:44.643958 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:44.644044 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:44.644127 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:44.644201 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:44.644279 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:44.644359 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0901 12:09:46.145629 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.484784 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.492765 139982171817984 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:09:46.497105 139982171817984 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:09:46.497242 139982171817984 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:09:46.497319 139982171817984 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:09:46.497380 139982171817984 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:09:46.497435 139982171817984 dqn_agent.py:275] 	 update_period: 4
I0901 12:09:46.497488 139982171817984 dqn_agent.py:276] 	 target_update_period: 300
I0901 12:09:46.497563 139982171817984 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:09:46.497654 139982171817984 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:09:46.497723 139982171817984 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:09:46.497776 139982171817984 dqn_agent.py:280] 	 optimizer: adam
I0901 12:09:46.497828 139982171817984 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:09:46.497895 139982171817984 dqn_agent.py:283] 	 seed: 1630498186497070
I0901 12:09:46.499344 139982171817984 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:09:46.499453 139982171817984 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 12:09:46.499527 139982171817984 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:09:46.499592 139982171817984 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:09:46.499649 139982171817984 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:09:46.499702 139982171817984 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:09:46.499778 139982171817984 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:09:46.499864 139982171817984 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:09:46.499932 139982171817984 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:09:46.516744 139982171817984 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:09:46.558585 139982171817984 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:09:46.558784 139982171817984 replay_runner.py:41] Starting iteration 0
Steps executed: 247 Episode length: 120 Return: -336.51060240715003
INFO:tensorflow:Average training steps per second: 163.57
I0901 12:09:52.672870 139982171817984 replay_runner.py:36] Average training steps per second: 163.57
I0901 12:09:53.840154 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.46
INFO:tensorflow:Starting iteration 1

Steps executed: 282 Episode length: 115 Return: -143.20422349681178
INFO:tensorflow:Average training steps per second: 207.01
I0901 12:10:03.019574 139982171817984 replay_runner.py:36] Average training steps per second: 207.01
I0901 12:10:03.271160 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.71
INFO:tensorflow:Starting iteration 2

Steps executed: 227 Episode length: 123 Return: -12.154898349011873
INFO:tensorflow:Average training steps per second: 206.01
I0901 12:10:12.497874 139982171817984 replay_runner.py:36] Average training steps per second: 206.01
I0901 12:10:12.703921 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.54
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 130 Return: -157.24248979485486
INFO:tensorflow:Average training steps per second: 210.77
I0901 12:10:21.852674 139982171817984 replay_runner.py:36] Average training steps per second: 210.77
I0901 12:10:22.027536 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.22
INFO:tensorflow:Starting iteration 4

Steps executed: 296 Episode length: 106 Return: -426.73860568577607
INFO:tensorflow:Average training steps per second: 209.91
I0901 12:10:30.929482 139982171817984 replay_runner.py:36] Average training steps per second: 209.91
I0901 12:10:31.187397 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.41
INFO:tensorflow:Starting iteration 5

Steps executed: 100 Episode length: 100 Return: -363.57212587550214
INFO:tensorflow:Average training steps per second: 211.20

Steps executed: 241 Episode length: 141 Return: -173.90180191789506
I0901 12:10:40.368382 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -268.74
INFO:tensorflow:Starting iteration 6

Steps executed: 257 Episode length: 84 Return: -657.575566191384706
INFO:tensorflow:Average training steps per second: 212.99
I0901 12:10:49.321979 139982171817984 replay_runner.py:36] Average training steps per second: 212.99
I0901 12:10:49.531786 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -699.02
INFO:tensorflow:Starting iteration 7

Steps executed: 264 Episode length: 88 Return: -468.973258740861876
INFO:tensorflow:Average training steps per second: 213.10
I0901 12:10:58.435677 139982171817984 replay_runner.py:36] Average training steps per second: 213.10
I0901 12:10:58.638724 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.19
INFO:tensorflow:Starting iteration 8

Steps executed: 233 Episode length: 233 Return: -215.22493828688446
INFO:tensorflow:Average training steps per second: 211.87
I0901 12:11:07.544707 139982171817984 replay_runner.py:36] Average training steps per second: 211.87
I0901 12:11:07.797437 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.22
INFO:tensorflow:Starting iteration 9

Steps executed: 231 Episode length: 121 Return: -299.16508094894246
INFO:tensorflow:Average training steps per second: 214.09
I0901 12:11:16.762783 139982171817984 replay_runner.py:36] Average training steps per second: 214.09
I0901 12:11:16.953941 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -425.98
INFO:tensorflow:Starting iteration 10

Steps executed: 343 Episode length: 173 Return: -451.07798357921476
INFO:tensorflow:Average training steps per second: 211.77
I0901 12:11:25.871553 139982171817984 replay_runner.py:36] Average training steps per second: 211.77
I0901 12:11:26.154619 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.48
INFO:tensorflow:Starting iteration 11

Steps executed: 246 Episode length: 162 Return: -27.729131869553825
INFO:tensorflow:Average training steps per second: 213.91
I0901 12:11:35.006268 139982171817984 replay_runner.py:36] Average training steps per second: 213.91
I0901 12:11:35.223930 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -237.60
INFO:tensorflow:Starting iteration 12

Steps executed: 229 Episode length: 137 Return: -560.84318503706625
INFO:tensorflow:Average training steps per second: 215.50
I0901 12:11:44.135622 139982171817984 replay_runner.py:36] Average training steps per second: 215.50
I0901 12:11:44.340446 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -601.27
INFO:tensorflow:Starting iteration 13

Steps executed: 258 Episode length: 104 Return: -564.23935580395645
INFO:tensorflow:Average training steps per second: 213.48
I0901 12:11:53.397717 139982171817984 replay_runner.py:36] Average training steps per second: 213.48
I0901 12:11:53.626281 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -484.26
INFO:tensorflow:Starting iteration 14

Steps executed: 87 Episode length: 87 Return: -553.3034552777798645
INFO:tensorflow:Average training steps per second: 214.03

Steps executed: 217 Episode length: 130 Return: -374.63929006348645
I0901 12:12:02.747298 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -463.97
INFO:tensorflow:Starting iteration 15

Steps executed: 295 Episode length: 116 Return: -125.88046779003655
INFO:tensorflow:Average training steps per second: 210.93
I0901 12:12:11.659407 139982171817984 replay_runner.py:36] Average training steps per second: 210.93
I0901 12:12:11.917946 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -533.83
INFO:tensorflow:Starting iteration 16
I0901 12:12:16.088608 139982171817984 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 213.28

Steps executed: 304 Episode length: 178 Return: -407.49217814044204
I0901 12:12:21.091287 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -446.59
INFO:tensorflow:Starting iteration 17

Steps executed: 301 Episode length: 141 Return: -78.535810714102374
INFO:tensorflow:Average training steps per second: 215.82
I0901 12:12:30.015654 139982171817984 replay_runner.py:36] Average training steps per second: 215.82
I0901 12:12:30.261785 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -249.46
INFO:tensorflow:Starting iteration 18

Steps executed: 329 Episode length: 142 Return: -407.08452664614814
INFO:tensorflow:Average training steps per second: 243.19
I0901 12:12:38.599387 139982171817984 replay_runner.py:36] Average training steps per second: 243.19
I0901 12:12:38.828226 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.85
INFO:tensorflow:Starting iteration 19
I0901 12:12:42.709966 139982171817984 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 252.27
I0901 12:12:46.675178 139982171817984 replay_runner.py:36] Average training steps per second: 252.27

Steps executed: 230 Episode length: 121 Return: -41.088307125027178
INFO:tensorflow:Starting iteration 20

Steps executed: 203 Episode length: 81 Return: -409.696751006476678
INFO:tensorflow:Average training steps per second: 237.45
I0901 12:12:55.033987 139982171817984 replay_runner.py:36] Average training steps per second: 237.45
I0901 12:12:55.186549 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.40
INFO:tensorflow:Starting iteration 21

Steps executed: 281 Episode length: 83 Return: -717.538623337504127
INFO:tensorflow:Average training steps per second: 225.17
I0901 12:13:03.944245 139982171817984 replay_runner.py:36] Average training steps per second: 225.17
I0901 12:13:04.192100 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -586.45
INFO:tensorflow:Starting iteration 22

Steps executed: 252 Episode length: 80 Return: -199.039644735416747
INFO:tensorflow:Average training steps per second: 220.67
I0901 12:13:13.083738 139982171817984 replay_runner.py:36] Average training steps per second: 220.67
I0901 12:13:13.284810 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.60
INFO:tensorflow:Starting iteration 23

Steps executed: 243 Episode length: 170 Return: -532.51044081812157
INFO:tensorflow:Average training steps per second: 222.20
I0901 12:13:22.087134 139982171817984 replay_runner.py:36] Average training steps per second: 222.20
I0901 12:13:22.300269 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -472.41
INFO:tensorflow:Starting iteration 24
I0901 12:13:26.615099 139982171817984 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 225.61

Steps executed: 241 Episode length: 87 Return: -552.554863067275257
I0901 12:13:31.233267 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -493.29
INFO:tensorflow:Starting iteration 25

Steps executed: 215 Episode length: 137 Return: -68.121416838922137
INFO:tensorflow:Average training steps per second: 218.20
I0901 12:13:39.829344 139982171817984 replay_runner.py:36] Average training steps per second: 218.20
I0901 12:13:40.006832 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.87
INFO:tensorflow:Starting iteration 26
I0901 12:13:44.277447 139982171817984 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 221.42
I0901 12:13:48.794227 139982171817984 replay_runner.py:36] Average training steps per second: 221.42

Steps executed: 386 Episode length: 187 Return: -275.95915168876567
INFO:tensorflow:Starting iteration 27

Steps executed: 274 Episode length: 121 Return: -398.47837144011527
INFO:tensorflow:Average training steps per second: 222.03
I0901 12:13:57.955947 139982171817984 replay_runner.py:36] Average training steps per second: 222.03
I0901 12:13:58.180230 139982171817984 run_experiment.py:428] Average undiscounted return per evaluation episode: -362.86
INFO:tensorflow:Starting iteration 28
I0901 12:14:02.369731 139982171817984 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 219.30
I0901 12:14:06.930088 139982171817984 replay_runner.py:36] Average training steps per second: 219.30

Steps executed: 274 Episode length: 81 Return: -312.198584329899544
INFO:tensorflow:Starting iteration 29

Steps executed: 266 Episode length: 71 Return: -416.234928154397974
INFO:tensorflow:Average training steps per second: 220.41
I0901 12:14:15.488816 139982171817984 replay_runner.py:36] Average training steps per second: 220.41

Done fixed training!Episode length: 71 Return: -416.234928154397974