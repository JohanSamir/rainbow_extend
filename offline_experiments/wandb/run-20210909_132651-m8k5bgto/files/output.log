Loaded trained dqn in mountaincar
Training fixed agent 1, please be patient, may be a while...
I0909 13:26:56.801710 140680613763072 run_experiment.py:549] Creating TrainRunner ...
I0909 13:26:56.808565 140680613763072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:26:56.808717 140680613763072 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:26:56.808793 140680613763072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:26:56.808925 140680613763072 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:26:56.809057 140680613763072 dqn_agent.py:275] 	 update_period: 4
I0909 13:26:56.809285 140680613763072 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:26:56.809472 140680613763072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:26:56.809556 140680613763072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:26:56.809668 140680613763072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:26:56.809777 140680613763072 dqn_agent.py:280] 	 optimizer: adam
I0909 13:26:56.809882 140680613763072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:26:56.809971 140680613763072 dqn_agent.py:283] 	 seed: 1631194016808524
I0909 13:26:56.811567 140680613763072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:26:56.811676 140680613763072 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:26:56.811755 140680613763072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:26:56.811819 140680613763072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:26:56.811878 140680613763072 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:26:56.811933 140680613763072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:26:56.812001 140680613763072 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:26:56.812052 140680613763072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:26:56.812103 140680613763072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:26:56.851717 140680613763072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:57.026104 140680613763072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:57.035220 140680613763072 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:26:57.040756 140680613763072 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:26:57.040913 140680613763072 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:26:57.041124 140680613763072 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:26:57.041248 140680613763072 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:26:57.041328 140680613763072 dqn_agent.py:275] 	 update_period: 4
I0909 13:26:57.041402 140680613763072 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:26:57.041523 140680613763072 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:26:57.041597 140680613763072 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:26:57.041684 140680613763072 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:26:57.041779 140680613763072 dqn_agent.py:280] 	 optimizer: adam
I0909 13:26:57.041906 140680613763072 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:26:57.041992 140680613763072 dqn_agent.py:283] 	 seed: 1631194017040720
I0909 13:26:57.043593 140680613763072 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:26:57.043714 140680613763072 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:26:57.043792 140680613763072 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:26:57.043860 140680613763072 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:26:57.043924 140680613763072 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:26:57.043995 140680613763072 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:26:57.044057 140680613763072 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:26:57.044136 140680613763072 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:26:57.044211 140680613763072 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:26:57.154891 140680613763072 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:26:57.183465 140680613763072 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:26:57.183643 140680613763072 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 168.19
I0909 13:27:03.129593 140680613763072 replay_runner.py:36] Average training steps per second: 168.19
I0909 13:27:04.504362 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:27:04.620906 140680613763072 replay_runner.py:41] Starting iteration 1
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 210.77
I0909 13:27:09.365909 140680613763072 replay_runner.py:36] Average training steps per second: 210.77
I0909 13:27:09.810327 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:27:09.925961 140680613763072 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 206.20
I0909 13:27:14.775978 140680613763072 replay_runner.py:36] Average training steps per second: 206.20
I0909 13:27:15.211157 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:27:15.328963 140680613763072 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 203.84
I0909 13:27:20.235135 140680613763072 replay_runner.py:36] Average training steps per second: 203.84
I0909 13:27:20.665083 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:27:20.784341 140680613763072 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 183.72
I0909 13:27:26.227939 140680613763072 replay_runner.py:36] Average training steps per second: 183.72
I0909 13:27:26.674351 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:27:26.797933 140680613763072 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.60
I0909 13:27:31.884774 140680613763072 replay_runner.py:36] Average training steps per second: 196.60
I0909 13:27:32.531545 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:27:32.683078 140680613763072 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 189.44
I0909 13:27:37.962277 140680613763072 replay_runner.py:36] Average training steps per second: 189.44
I0909 13:27:38.402473 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:27:38.527366 140680613763072 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 196.73
I0909 13:27:43.611174 140680613763072 replay_runner.py:36] Average training steps per second: 196.73
I0909 13:27:44.069982 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:27:44.198382 140680613763072 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.39
I0909 13:27:49.239534 140680613763072 replay_runner.py:36] Average training steps per second: 198.39
I0909 13:27:49.696820 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:27:49.819407 140680613763072 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 198.82
I0909 13:27:54.849569 140680613763072 replay_runner.py:36] Average training steps per second: 198.82
I0909 13:27:55.305482 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:27:55.425482 140680613763072 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 201.40
I0909 13:28:00.391108 140680613763072 replay_runner.py:36] Average training steps per second: 201.40
I0909 13:28:00.840510 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11

Steps executed: 264 Episode length: 134 Return: -134.0
INFO:tensorflow:Average training steps per second: 199.97
I0909 13:28:05.958231 140680613763072 replay_runner.py:36] Average training steps per second: 199.97
I0909 13:28:06.163650 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.00
INFO:tensorflow:Starting iteration 12

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 198.14
I0909 13:28:11.331986 140680613763072 replay_runner.py:36] Average training steps per second: 198.14
I0909 13:28:11.789509 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0909 13:28:11.911517 140680613763072 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.72

Steps executed: 743 Episode length: 600 Return: -600.0
I0909 13:28:17.500441 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -371.50
INFO:tensorflow:Starting iteration 14
I0909 13:28:17.626804 140680613763072 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 199.71
I0909 13:28:22.634713 140680613763072 replay_runner.py:36] Average training steps per second: 199.71
I0909 13:28:22.866319 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 15


Steps executed: 273 Episode length: 101 Return: -101.0
INFO:tensorflow:Average training steps per second: 199.51
I0909 13:28:28.003463 140680613763072 replay_runner.py:36] Average training steps per second: 199.51
I0909 13:28:28.219616 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 16

Steps executed: 220 Episode length: 111 Return: -111.0
INFO:tensorflow:Average training steps per second: 198.44
I0909 13:28:33.390276 140680613763072 replay_runner.py:36] Average training steps per second: 198.44
I0909 13:28:33.559061 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 17
I0909 13:28:33.690580 140680613763072 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 197.05
I0909 13:28:38.766001 140680613763072 replay_runner.py:36] Average training steps per second: 197.05
I0909 13:28:38.976855 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.00
INFO:tensorflow:Starting iteration 18


Steps executed: 381 Episode length: 193 Return: -193.0
INFO:tensorflow:Average training steps per second: 193.22
I0909 13:28:44.272792 140680613763072 replay_runner.py:36] Average training steps per second: 193.22
I0909 13:28:44.572692 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -190.50
INFO:tensorflow:Starting iteration 19

Steps executed: 208 Episode length: 104 Return: -104.0
INFO:tensorflow:Average training steps per second: 196.02
I0909 13:28:49.799943 140680613763072 replay_runner.py:36] Average training steps per second: 196.02
I0909 13:28:49.964069 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 20

Steps executed: 709 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 197.38
I0909 13:28:55.154488 140680613763072 replay_runner.py:36] Average training steps per second: 197.38
I0909 13:28:55.673074 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.50
INFO:tensorflow:Starting iteration 21

Steps executed: 169 Episode length: 169 Return: -169.0
INFO:tensorflow:Average training steps per second: 198.51

Steps executed: 338 Episode length: 169 Return: -169.0
I0909 13:29:01.078302 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.00
INFO:tensorflow:Starting iteration 22

Steps executed: 244 Episode length: 159 Return: -159.0
INFO:tensorflow:Average training steps per second: 197.60
I0909 13:29:06.260829 140680613763072 replay_runner.py:36] Average training steps per second: 197.60
I0909 13:29:06.450235 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 23

Steps executed: 241 Episode length: 155 Return: -155.0
INFO:tensorflow:Average training steps per second: 193.25
I0909 13:29:11.751892 140680613763072 replay_runner.py:36] Average training steps per second: 193.25
I0909 13:29:11.934335 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 24

Steps executed: 308 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 194.52
I0909 13:29:17.200453 140680613763072 replay_runner.py:36] Average training steps per second: 194.52
I0909 13:29:17.431862 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.00
INFO:tensorflow:Starting iteration 25

Steps executed: 282 Episode length: 129 Return: -129.0
INFO:tensorflow:Average training steps per second: 196.60
I0909 13:29:22.640848 140680613763072 replay_runner.py:36] Average training steps per second: 196.60
I0909 13:29:22.855496 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.00
INFO:tensorflow:Starting iteration 26

Steps executed: 328 Episode length: 205 Return: -205.0
INFO:tensorflow:Average training steps per second: 195.69
I0909 13:29:28.092507 140680613763072 replay_runner.py:36] Average training steps per second: 195.69
I0909 13:29:28.341449 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.00
INFO:tensorflow:Starting iteration 27

Steps executed: 340 Episode length: 170 Return: -170.0
INFO:tensorflow:Average training steps per second: 197.27
I0909 13:29:33.543114 140680613763072 replay_runner.py:36] Average training steps per second: 197.27
I0909 13:29:33.811439 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -170.00
INFO:tensorflow:Starting iteration 28
I0909 13:29:33.932867 140680613763072 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 195.68

Steps executed: 600 Episode length: 600 Return: -600.0
I0909 13:29:39.482702 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 107 Return: -107.0
INFO:tensorflow:Average training steps per second: 203.68
I0909 13:29:44.523017 140680613763072 replay_runner.py:36] Average training steps per second: 203.68
I0909 13:29:44.678077 140680613763072 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00