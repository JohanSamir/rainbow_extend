I0901 23:29:06.045088 139876902283264 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 23:29:06.045653 139876902283264 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 23:29:06.110806 139876902283264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:06.112239 139876902283264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:06.112350 139876902283264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:06.112416 139876902283264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:06.112494 139876902283264 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:06.112576 139876902283264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:29:06.112787 139876902283264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:06.112882 139876902283264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:06.112939 139876902283264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:06.112994 139876902283264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:06.113045 139876902283264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:06.113097 139876902283264 dqn_agent.py:283] 	 seed: 1630538946110733
I0901 23:29:06.115268 139876902283264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:06.115432 139876902283264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:29:06.115521 139876902283264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:06.115587 139876902283264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:06.115645 139876902283264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:06.115725 139876902283264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:06.115806 139876902283264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:06.115893 139876902283264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:06.116025 139876902283264 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
I0901 23:29:12.373912 139876902283264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.319907 139876902283264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.327660 139876902283264 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:29:13.332912 139876902283264 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:13.333063 139876902283264 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:13.333158 139876902283264 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:13.333231 139876902283264 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:13.333309 139876902283264 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:13.333361 139876902283264 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:29:13.333436 139876902283264 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:13.333521 139876902283264 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:13.333577 139876902283264 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:13.333637 139876902283264 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:13.333722 139876902283264 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:13.333771 139876902283264 dqn_agent.py:283] 	 seed: 1630538953332878
I0901 23:29:13.335263 139876902283264 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:13.335389 139876902283264 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 23:29:13.335458 139876902283264 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:13.335524 139876902283264 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:13.335582 139876902283264 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:13.335653 139876902283264 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:13.335708 139876902283264 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:13.335777 139876902283264 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:13.335845 139876902283264 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 3, please be patient, may be a while...
I0901 23:29:14.148198 139876902283264 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:14.303983 139876902283264 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:29:14.304361 139876902283264 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 116.20
I0901 23:29:22.910357 139876902283264 replay_runner.py:36] Average training steps per second: 116.20
Steps executed: 205 Episode length: 8 Return: 8.0.0
I0901 23:29:23.884545 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.32
INFO:tensorflow:Starting iteration 1

Steps executed: 208 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 202.43
I0901 23:29:28.979940 139876902283264 replay_runner.py:36] Average training steps per second: 202.43
I0901 23:29:29.161072 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 2

Steps executed: 259 Episode length: 129 Return: 129.0
INFO:tensorflow:Average training steps per second: 186.66
I0901 23:29:34.722982 139876902283264 replay_runner.py:36] Average training steps per second: 186.66
I0901 23:29:34.908257 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.50
INFO:tensorflow:Starting iteration 3

Steps executed: 316 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 193.54
I0901 23:29:40.265719 139876902283264 replay_runner.py:36] Average training steps per second: 193.54
I0901 23:29:40.531395 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 4
I0901 23:29:40.743182 139876902283264 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.83

Steps executed: 372 Episode length: 190 Return: 190.0
I0901 23:29:46.053893 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 5

Steps executed: 152 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 185.17
I0901 23:29:51.644176 139876902283264 replay_runner.py:36] Average training steps per second: 185.17

Steps executed: 310 Episode length: 158 Return: 158.0
INFO:tensorflow:Starting iteration 6

Steps executed: 318 Episode length: 156 Return: 156.0
INFO:tensorflow:Average training steps per second: 206.50
I0901 23:29:56.917470 139876902283264 replay_runner.py:36] Average training steps per second: 206.50
I0901 23:29:57.149027 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 7

Steps executed: 322 Episode length: 164 Return: 164.0
INFO:tensorflow:Average training steps per second: 189.61
I0901 23:30:02.617442 139876902283264 replay_runner.py:36] Average training steps per second: 189.61
I0901 23:30:02.851372 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 8
I0901 23:30:03.059344 139876902283264 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 204.97

Steps executed: 281 Episode length: 139 Return: 139.0
I0901 23:30:08.132436 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 140.50
INFO:tensorflow:Starting iteration 9

Steps executed: 352 Episode length: 187 Return: 187.0
INFO:tensorflow:Average training steps per second: 194.13
I0901 23:30:13.479940 139876902283264 replay_runner.py:36] Average training steps per second: 194.13
I0901 23:30:13.728044 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 10

Steps executed: 298 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 204.18
I0901 23:30:18.830622 139876902283264 replay_runner.py:36] Average training steps per second: 204.18
I0901 23:30:19.026460 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 149.00
INFO:tensorflow:Starting iteration 11
I0901 23:30:19.216605 139876902283264 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 204.50

Steps executed: 310 Episode length: 166 Return: 166.0
I0901 23:30:24.370654 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 12

Steps executed: 328 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 194.74
I0901 23:30:29.713924 139876902283264 replay_runner.py:36] Average training steps per second: 194.74
I0901 23:30:29.941881 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 13

Steps executed: 304 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 203.43
I0901 23:30:35.075808 139876902283264 replay_runner.py:36] Average training steps per second: 203.43
I0901 23:30:35.289274 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.00
INFO:tensorflow:Starting iteration 14

Steps executed: 303 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 195.77
I0901 23:30:40.599493 139876902283264 replay_runner.py:36] Average training steps per second: 195.77
I0901 23:30:40.803164 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 15

Steps executed: 388 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.16
I0901 23:30:45.990539 139876902283264 replay_runner.py:36] Average training steps per second: 200.16
I0901 23:30:46.261676 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.00
INFO:tensorflow:Starting iteration 16

Steps executed: 295 Episode length: 139 Return: 139.0
INFO:tensorflow:Average training steps per second: 192.91
I0901 23:30:51.646476 139876902283264 replay_runner.py:36] Average training steps per second: 192.91
I0901 23:30:51.856747 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.50
INFO:tensorflow:Starting iteration 17

Steps executed: 397 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.51
I0901 23:30:56.972272 139876902283264 replay_runner.py:36] Average training steps per second: 203.51
I0901 23:30:57.233139 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.50
INFO:tensorflow:Starting iteration 18

Steps executed: 294 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 190.42
I0901 23:31:02.658911 139876902283264 replay_runner.py:36] Average training steps per second: 190.42
I0901 23:31:02.861657 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 19
I0901 23:31:03.059859 139876902283264 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 203.65
I0901 23:31:07.970564 139876902283264 replay_runner.py:36] Average training steps per second: 203.65

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.86
I0901 23:31:13.466241 139876902283264 replay_runner.py:36] Average training steps per second: 193.86
I0901 23:31:13.606349 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 23:31:13.797467 139876902283264 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 199.81
I0901 23:31:18.802581 139876902283264 replay_runner.py:36] Average training steps per second: 199.81
I0901 23:31:18.952095 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0901 23:31:19.242966 139876902283264 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 194.54
I0901 23:31:24.384182 139876902283264 replay_runner.py:36] Average training steps per second: 194.54
I0901 23:31:24.520250 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 359 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 195.02
I0901 23:31:29.841318 139876902283264 replay_runner.py:36] Average training steps per second: 195.02
I0901 23:31:30.088227 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.50
INFO:tensorflow:Starting iteration 24

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.34
I0901 23:31:35.271853 139876902283264 replay_runner.py:36] Average training steps per second: 200.34
I0901 23:31:35.403989 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 23:31:35.599546 139876902283264 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.62
I0901 23:31:40.660129 139876902283264 replay_runner.py:36] Average training steps per second: 197.62
I0901 23:31:40.797548 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0901 23:31:40.986176 139876902283264 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 201.16
I0901 23:31:45.957624 139876902283264 replay_runner.py:36] Average training steps per second: 201.16
I0901 23:31:46.100742 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0901 23:31:46.290708 139876902283264 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 200.01
I0901 23:31:51.290929 139876902283264 replay_runner.py:36] Average training steps per second: 200.01
I0901 23:31:51.427975 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0901 23:31:51.625390 139876902283264 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 204.48
I0901 23:31:56.516176 139876902283264 replay_runner.py:36] Average training steps per second: 204.48
I0901 23:31:56.647090 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.45
I0901 23:32:01.872220 139876902283264 replay_runner.py:36] Average training steps per second: 198.45
I0901 23:32:02.007551 139876902283264 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00