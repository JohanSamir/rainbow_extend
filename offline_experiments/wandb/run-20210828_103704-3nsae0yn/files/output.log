Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0828 10:37:11.331022 140160266885120 run_experiment.py:549] Creating TrainRunner ...
I0828 10:37:11.340999 140160266885120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:11.341261 140160266885120 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:11.341394 140160266885120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:11.341502 140160266885120 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:11.341845 140160266885120 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:11.342100 140160266885120 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:37:11.342288 140160266885120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:11.342411 140160266885120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:11.342529 140160266885120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:11.342639 140160266885120 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:11.342749 140160266885120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:11.342855 140160266885120 dqn_agent.py:283] 	 seed: 1630147031340918
I0828 10:37:11.346284 140160266885120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:11.346493 140160266885120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:37:11.346646 140160266885120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:11.346776 140160266885120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:11.346904 140160266885120 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:11.347052 140160266885120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:11.347168 140160266885120 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:11.347274 140160266885120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:11.347375 140160266885120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:11.390677 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:11.868435 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:11.882846 140160266885120 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:37:11.891503 140160266885120 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:37:11.891661 140160266885120 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:37:11.891736 140160266885120 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:37:11.891796 140160266885120 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:37:11.891854 140160266885120 dqn_agent.py:275] 	 update_period: 4
I0828 10:37:11.891932 140160266885120 dqn_agent.py:276] 	 target_update_period: 100
I0828 10:37:11.892023 140160266885120 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:37:11.892084 140160266885120 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:37:11.892148 140160266885120 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:37:11.892230 140160266885120 dqn_agent.py:280] 	 optimizer: adam
I0828 10:37:11.892311 140160266885120 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:37:11.892402 140160266885120 dqn_agent.py:283] 	 seed: 1630147031891463
I0828 10:37:11.894995 140160266885120 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:37:11.895330 140160266885120 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0828 10:37:11.895554 140160266885120 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:37:11.895712 140160266885120 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:37:11.895872 140160266885120 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:37:11.896016 140160266885120 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:37:11.896170 140160266885120 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:37:11.896351 140160266885120 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:37:11.896497 140160266885120 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:37:11.928401 140160266885120 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:37:11.949166 140160266885120 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:37:11.949378 140160266885120 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.91
I0828 10:37:18.446837 140160266885120 replay_runner.py:36] Average training steps per second: 153.91
Steps executed: 500 Episode length: 500 Return: -500.0
I0828 10:37:19.770963 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0828 10:37:20.006778 140160266885120 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 204.52

Steps executed: 353 Episode length: 353 Return: -352.0
I0828 10:37:25.184189 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 201.26
I0828 10:37:30.380466 140160266885120 replay_runner.py:36] Average training steps per second: 201.26
I0828 10:37:30.744800 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 255 Episode length: 255 Return: -254.0
INFO:tensorflow:Average training steps per second: 210.46
I0828 10:37:35.723068 140160266885120 replay_runner.py:36] Average training steps per second: 210.46
I0828 10:37:35.921988 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.00
INFO:tensorflow:Starting iteration 4

Steps executed: 239 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 196.06
I0828 10:37:41.254589 140160266885120 replay_runner.py:36] Average training steps per second: 196.06
I0828 10:37:41.439582 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.24
I0828 10:37:46.669327 140160266885120 replay_runner.py:36] Average training steps per second: 200.24
I0828 10:37:47.096225 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0828 10:37:47.345875 140160266885120 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.45
I0828 10:37:52.515713 140160266885120 replay_runner.py:36] Average training steps per second: 193.45
I0828 10:37:52.917328 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7

Steps executed: 370 Episode length: 370 Return: -369.0
INFO:tensorflow:Average training steps per second: 198.14
I0828 10:37:58.207224 140160266885120 replay_runner.py:36] Average training steps per second: 198.14
I0828 10:37:58.521203 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.00
INFO:tensorflow:Starting iteration 8

Steps executed: 292 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 197.67
I0828 10:38:03.823958 140160266885120 replay_runner.py:36] Average training steps per second: 197.67
I0828 10:38:04.074970 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.33
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.75
I0828 10:38:09.462206 140160266885120 replay_runner.py:36] Average training steps per second: 194.75
I0828 10:38:09.877346 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0828 10:38:10.122146 140160266885120 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 197.06
I0828 10:38:15.197124 140160266885120 replay_runner.py:36] Average training steps per second: 197.06
I0828 10:38:15.626899 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 249 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 193.21
I0828 10:38:21.054555 140160266885120 replay_runner.py:36] Average training steps per second: 193.21
I0828 10:38:21.258276 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 12

Steps executed: 619 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.78
I0828 10:38:26.507043 140160266885120 replay_runner.py:36] Average training steps per second: 199.78
I0828 10:38:27.020518 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.00
INFO:tensorflow:Starting iteration 13

Steps executed: 263 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 200.37
I0828 10:38:32.256565 140160266885120 replay_runner.py:36] Average training steps per second: 200.37
I0828 10:38:32.473317 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.67
INFO:tensorflow:Starting iteration 14

Steps executed: 236 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 195.88
I0828 10:38:37.825510 140160266885120 replay_runner.py:36] Average training steps per second: 195.88
I0828 10:38:38.029355 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 15

Steps executed: 591 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.72
I0828 10:38:43.384271 140160266885120 replay_runner.py:36] Average training steps per second: 195.72
I0828 10:38:43.915676 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -295.00
INFO:tensorflow:Starting iteration 16
I0828 10:38:44.141574 140160266885120 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 196.77

Steps executed: 622 Episode length: 500 Return: -500.0
I0828 10:38:49.752091 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -310.50
INFO:tensorflow:Starting iteration 17

Steps executed: 105 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 200.58

Steps executed: 605 Episode length: 500 Return: -500.0
I0828 10:38:55.492780 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.00
INFO:tensorflow:Starting iteration 18

Steps executed: 240 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 196.14
I0828 10:39:00.835802 140160266885120 replay_runner.py:36] Average training steps per second: 196.14
I0828 10:39:01.057523 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 19

Steps executed: 235 Episode length: 152 Return: -151.0
INFO:tensorflow:Average training steps per second: 199.48
I0828 10:39:06.323427 140160266885120 replay_runner.py:36] Average training steps per second: 199.48
I0828 10:39:06.521493 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 20

Steps executed: 297 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 199.65
I0828 10:39:11.785943 140160266885120 replay_runner.py:36] Average training steps per second: 199.65
I0828 10:39:12.014394 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.00
INFO:tensorflow:Starting iteration 21

Steps executed: 317 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 207.47
I0828 10:39:17.065859 140160266885120 replay_runner.py:36] Average training steps per second: 207.47
I0828 10:39:17.329172 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.67
INFO:tensorflow:Starting iteration 22

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.18
I0828 10:39:22.715340 140160266885120 replay_runner.py:36] Average training steps per second: 194.18
I0828 10:39:23.103819 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0828 10:39:23.318328 140160266885120 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 204.84
I0828 10:39:28.200515 140160266885120 replay_runner.py:36] Average training steps per second: 204.84
I0828 10:39:28.607925 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 228 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 204.32
I0828 10:39:33.736594 140160266885120 replay_runner.py:36] Average training steps per second: 204.32
I0828 10:39:33.921458 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 25
I0828 10:39:34.158788 140160266885120 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 197.94
I0828 10:39:39.211229 140160266885120 replay_runner.py:36] Average training steps per second: 197.94

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 26
I0828 10:39:39.901348 140160266885120 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 205.08
I0828 10:39:44.778037 140160266885120 replay_runner.py:36] Average training steps per second: 205.08
I0828 10:39:45.212493 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 255 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 198.75
I0828 10:39:50.486943 140160266885120 replay_runner.py:36] Average training steps per second: 198.75
I0828 10:39:50.691249 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 28

Steps executed: 237 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 194.74
I0828 10:39:56.058731 140160266885120 replay_runner.py:36] Average training steps per second: 194.74
I0828 10:39:56.262686 140160266885120 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00
INFO:tensorflow:Starting iteration 29

Steps executed: 230 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 199.58
I0828 10:40:01.519045 140160266885120 replay_runner.py:36] Average training steps per second: 199.58

Done fixed training!Episode length: 75 Return: -74.0.0