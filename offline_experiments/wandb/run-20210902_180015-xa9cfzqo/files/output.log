I0902 18:00:21.657493 140182397114368 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:21.670238 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:21.670560 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:21.670758 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:21.671312 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:21.671529 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:21.671684 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:21.671921 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:21.672076 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:21.672162 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:21.672268 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:21.672401 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:21.672517 140182397114368 dqn_agent.py:283] 	 seed: 1630605621670075
I0902 18:00:21.675814 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:21.676037 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:21.676202 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:21.676689 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:21.676856 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:21.677030 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:21.677378 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:21.677684 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:21.677814 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:21.722865 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:22.101633 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:22.115831 140182397114368 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:22.124904 140182397114368 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:22.125176 140182397114368 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:22.125324 140182397114368 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:22.125509 140182397114368 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:22.125879 140182397114368 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:22.126077 140182397114368 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:22.126253 140182397114368 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:22.126457 140182397114368 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:22.126592 140182397114368 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:22.126674 140182397114368 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:22.126755 140182397114368 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:22.126879 140182397114368 dqn_agent.py:283] 	 seed: 1630605622124849
I0902 18:00:22.129334 140182397114368 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:22.129484 140182397114368 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:22.129590 140182397114368 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:22.129677 140182397114368 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:22.129765 140182397114368 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:22.129820 140182397114368 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:22.129924 140182397114368 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:22.130010 140182397114368 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:22.130077 140182397114368 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:22.207891 140182397114368 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:22.231056 140182397114368 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:22.231307 140182397114368 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 167.73
I0902 18:00:28.194098 140182397114368 replay_runner.py:36] Average training steps per second: 167.73
Steps executed: 235 Episode length: 87 Return: -749.0286896797169
I0902 18:00:29.430110 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -659.42
INFO:tensorflow:Starting iteration 1

Steps executed: 300 Episode length: 126 Return: -541.7042900440163
INFO:tensorflow:Average training steps per second: 231.69
I0902 18:00:37.835602 140182397114368 replay_runner.py:36] Average training steps per second: 231.69
I0902 18:00:38.117186 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -638.42
INFO:tensorflow:Starting iteration 2

Steps executed: 210 Episode length: 92 Return: -664.12002212244722
INFO:tensorflow:Average training steps per second: 227.21
I0902 18:00:46.671310 140182397114368 replay_runner.py:36] Average training steps per second: 227.21
I0902 18:00:46.875651 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -648.06
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 94 Return: -452.821577203361497
INFO:tensorflow:Average training steps per second: 222.73
I0902 18:00:55.735593 140182397114368 replay_runner.py:36] Average training steps per second: 222.73
I0902 18:00:55.915185 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.23
INFO:tensorflow:Starting iteration 4

Steps executed: 310 Episode length: 236 Return: -527.91532119818187
INFO:tensorflow:Average training steps per second: 237.71
I0902 18:01:04.099629 140182397114368 replay_runner.py:36] Average training steps per second: 237.71
I0902 18:01:04.432134 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.03
INFO:tensorflow:Starting iteration 5
I0902 18:01:08.744412 140182397114368 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 222.40
I0902 18:01:13.241368 140182397114368 replay_runner.py:36] Average training steps per second: 222.40

Steps executed: 205 Episode length: 205 Return: -252.54640728172998
INFO:tensorflow:Starting iteration 6

Steps executed: 322 Episode length: 133 Return: -193.80103930709657
INFO:tensorflow:Average training steps per second: 227.50
I0902 18:01:22.226347 140182397114368 replay_runner.py:36] Average training steps per second: 227.50
I0902 18:01:22.502815 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.15
INFO:tensorflow:Starting iteration 7

Steps executed: 238 Episode length: 101 Return: -410.41741159503584
INFO:tensorflow:Average training steps per second: 231.01
I0902 18:01:31.306074 140182397114368 replay_runner.py:36] Average training steps per second: 231.01
I0902 18:01:31.528189 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.82
INFO:tensorflow:Starting iteration 8

Steps executed: 219 Episode length: 137 Return: -273.12875132124924
INFO:tensorflow:Average training steps per second: 230.08
I0902 18:01:40.271959 140182397114368 replay_runner.py:36] Average training steps per second: 230.08
I0902 18:01:40.479922 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.14
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 90 Return: -264.449902592023144
INFO:tensorflow:Average training steps per second: 229.40
I0902 18:01:49.319842 140182397114368 replay_runner.py:36] Average training steps per second: 229.40
I0902 18:01:49.488795 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -180.44
INFO:tensorflow:Starting iteration 10

Steps executed: 204 Episode length: 84 Return: -207.607741791688957
INFO:tensorflow:Average training steps per second: 233.14
I0902 18:01:58.095100 140182397114368 replay_runner.py:36] Average training steps per second: 233.14
I0902 18:01:58.268159 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -199.37
INFO:tensorflow:Starting iteration 11

Steps executed: 293 Episode length: 197 Return: -455.99948814305844
INFO:tensorflow:Average training steps per second: 247.64
I0902 18:02:06.659717 140182397114368 replay_runner.py:36] Average training steps per second: 247.64
I0902 18:02:06.914072 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -509.43
INFO:tensorflow:Starting iteration 12

Steps executed: 227 Episode length: 85 Return: -258.985323195828234
INFO:tensorflow:Average training steps per second: 242.20
I0902 18:02:15.485697 140182397114368 replay_runner.py:36] Average training steps per second: 242.20
I0902 18:02:15.670826 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.23
INFO:tensorflow:Starting iteration 13

Steps executed: 266 Episode length: 157 Return: -62.798357620782473
INFO:tensorflow:Average training steps per second: 234.98
I0902 18:02:24.222625 140182397114368 replay_runner.py:36] Average training steps per second: 234.98
I0902 18:02:24.433833 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.35
INFO:tensorflow:Starting iteration 14

Steps executed: 297 Episode length: 113 Return: -295.53170273481805
INFO:tensorflow:Average training steps per second: 232.37
I0902 18:02:33.059005 140182397114368 replay_runner.py:36] Average training steps per second: 232.37
I0902 18:02:33.300589 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.09
INFO:tensorflow:Starting iteration 15
I0902 18:02:37.715285 140182397114368 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 235.32

Steps executed: 206 Episode length: 206 Return: -368.52637295808825
I0902 18:02:42.167773 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -368.53
INFO:tensorflow:Starting iteration 16

Steps executed: 253 Episode length: 147 Return: -301.28919701734414
INFO:tensorflow:Average training steps per second: 239.23
I0902 18:02:50.561781 140182397114368 replay_runner.py:36] Average training steps per second: 239.23
I0902 18:02:50.768840 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.25
INFO:tensorflow:Starting iteration 17

Steps executed: 259 Episode length: 164 Return: -478.63946832004834
INFO:tensorflow:Average training steps per second: 224.59
I0902 18:02:59.449564 140182397114368 replay_runner.py:36] Average training steps per second: 224.59
I0902 18:02:59.650127 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -354.84
INFO:tensorflow:Starting iteration 18

Steps executed: 220 Episode length: 220 Return: -210.86950802419534
INFO:tensorflow:Average training steps per second: 229.46
I0902 18:03:08.276770 140182397114368 replay_runner.py:36] Average training steps per second: 229.46
I0902 18:03:08.487299 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.87
INFO:tensorflow:Starting iteration 19

Steps executed: 273 Episode length: 106 Return: -239.61958105584958
INFO:tensorflow:Average training steps per second: 226.42
I0902 18:03:17.313207 140182397114368 replay_runner.py:36] Average training steps per second: 226.42
I0902 18:03:17.547552 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.25
INFO:tensorflow:Starting iteration 20

Steps executed: 281 Episode length: 122 Return: -183.96287550597253
INFO:tensorflow:Average training steps per second: 222.85
I0902 18:03:26.240698 140182397114368 replay_runner.py:36] Average training steps per second: 222.85
I0902 18:03:26.488734 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.83
INFO:tensorflow:Starting iteration 21

Steps executed: 274 Episode length: 153 Return: -309.94569404441913
INFO:tensorflow:Average training steps per second: 223.89
I0902 18:03:35.174473 140182397114368 replay_runner.py:36] Average training steps per second: 223.89
I0902 18:03:35.401150 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.74
INFO:tensorflow:Starting iteration 22

Steps executed: 387 Episode length: 192 Return: -10.303949299571286
INFO:tensorflow:Average training steps per second: 223.32
I0902 18:03:44.284042 140182397114368 replay_runner.py:36] Average training steps per second: 223.32
I0902 18:03:44.636937 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -8.81
INFO:tensorflow:Starting iteration 23

Steps executed: 267 Episode length: 97 Return: -381.798420499597746
INFO:tensorflow:Average training steps per second: 222.26
I0902 18:03:53.337138 140182397114368 replay_runner.py:36] Average training steps per second: 222.26
I0902 18:03:53.562484 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -324.49
INFO:tensorflow:Starting iteration 24

Steps executed: 254 Episode length: 112 Return: -328.75914520418716
INFO:tensorflow:Average training steps per second: 223.25
I0902 18:04:02.424813 140182397114368 replay_runner.py:36] Average training steps per second: 223.25
I0902 18:04:02.634498 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.77
INFO:tensorflow:Starting iteration 25

Steps executed: 249 Episode length: 157 Return: -388.79725208880576
INFO:tensorflow:Average training steps per second: 219.35
I0902 18:04:11.521936 140182397114368 replay_runner.py:36] Average training steps per second: 219.35
I0902 18:04:11.732720 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -406.03
INFO:tensorflow:Starting iteration 26

Steps executed: 251 Episode length: 88 Return: -196.111471791913856
INFO:tensorflow:Average training steps per second: 217.52
I0902 18:04:20.704942 140182397114368 replay_runner.py:36] Average training steps per second: 217.52
I0902 18:04:20.920108 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -285.13
INFO:tensorflow:Starting iteration 27

Steps executed: 83 Episode length: 83 Return: -497.5482639280811856
INFO:tensorflow:Average training steps per second: 220.48

Steps executed: 270 Episode length: 80 Return: -556.936043335915202
I0902 18:04:30.070617 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.65
INFO:tensorflow:Starting iteration 28

Steps executed: 348 Episode length: 348 Return: 189.364593255663862
INFO:tensorflow:Average training steps per second: 221.23
I0902 18:04:38.953199 140182397114368 replay_runner.py:36] Average training steps per second: 221.23
I0902 18:04:39.386735 140182397114368 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.36
INFO:tensorflow:Starting iteration 29

Steps executed: 204 Episode length: 80 Return: -389.963079506292214
INFO:tensorflow:Average training steps per second: 222.80
I0902 18:04:48.208376 140182397114368 replay_runner.py:36] Average training steps per second: 222.80

Done fixed training!Episode length: 80 Return: -389.963079506292214