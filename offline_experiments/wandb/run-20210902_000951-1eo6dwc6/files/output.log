Loaded trained dqn in acrobot
Training fixed agent 4, please be patient, may be a while...
I0902 00:09:58.127475 140268518520832 run_experiment.py:549] Creating TrainRunner ...
I0902 00:09:58.137620 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:09:58.137916 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:09:58.138056 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:09:58.138240 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:09:58.138352 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0902 00:09:58.138454 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:09:58.138545 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:09:58.138644 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:09:58.138734 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:09:58.138819 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0902 00:09:58.138908 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:09:58.138995 140268518520832 dqn_agent.py:283] 	 seed: 1630541398137557
I0902 00:09:58.142155 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:09:58.142445 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:09:58.142811 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:09:58.143038 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:09:58.143452 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:09:58.143623 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:09:58.143764 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:09:58.143903 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:09:58.144041 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:09:58.188472 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:58.648741 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:58.664562 140268518520832 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:09:58.675915 140268518520832 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:09:58.676136 140268518520832 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:09:58.676339 140268518520832 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:09:58.676653 140268518520832 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:09:58.676842 140268518520832 dqn_agent.py:275] 	 update_period: 4
I0902 00:09:58.676936 140268518520832 dqn_agent.py:276] 	 target_update_period: 100
I0902 00:09:58.677015 140268518520832 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:09:58.677088 140268518520832 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:09:58.677171 140268518520832 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:09:58.677252 140268518520832 dqn_agent.py:280] 	 optimizer: adam
I0902 00:09:58.677358 140268518520832 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:09:58.677446 140268518520832 dqn_agent.py:283] 	 seed: 1630541398675866
I0902 00:09:58.680390 140268518520832 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:09:58.680702 140268518520832 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 00:09:58.680851 140268518520832 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:09:58.680954 140268518520832 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:09:58.681050 140268518520832 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:09:58.681190 140268518520832 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:09:58.681384 140268518520832 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:09:58.681625 140268518520832 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:09:58.681727 140268518520832 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:09:58.716354 140268518520832 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:09:58.748232 140268518520832 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:09:58.748791 140268518520832 replay_runner.py:41] Starting iteration 0
Steps executed: 317 Episode length: 138 Return: -137.0
INFO:tensorflow:Average training steps per second: 137.95
I0902 00:10:05.998093 140268518520832 replay_runner.py:36] Average training steps per second: 137.95
I0902 00:10:07.486145 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -157.50
INFO:tensorflow:Starting iteration 1
I0902 00:10:07.735155 140268518520832 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 192.32
I0902 00:10:12.934995 140268518520832 replay_runner.py:36] Average training steps per second: 192.32
I0902 00:10:13.353592 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.84
I0902 00:10:18.953437 140268518520832 replay_runner.py:36] Average training steps per second: 186.84
I0902 00:10:19.205125 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.00
INFO:tensorflow:Starting iteration 3


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.39
I0902 00:10:24.742903 140268518520832 replay_runner.py:36] Average training steps per second: 188.39
I0902 00:10:25.179723 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4

Steps executed: 305 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 188.92
I0902 00:10:30.724113 140268518520832 replay_runner.py:36] Average training steps per second: 188.92
I0902 00:10:30.983004 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.74
I0902 00:10:36.522378 140268518520832 replay_runner.py:36] Average training steps per second: 188.74
I0902 00:10:36.918143 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0902 00:10:37.157696 140268518520832 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 195.75
I0902 00:10:42.266777 140268518520832 replay_runner.py:36] Average training steps per second: 195.75
I0902 00:10:42.559707 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.50
INFO:tensorflow:Starting iteration 7


Steps executed: 180 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 196.02
I0902 00:10:47.897456 140268518520832 replay_runner.py:36] Average training steps per second: 196.02
I0902 00:10:48.111660 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 8


Steps executed: 488 Episode length: 488 Return: -487.0
INFO:tensorflow:Average training steps per second: 192.51
I0902 00:10:53.546017 140268518520832 replay_runner.py:36] Average training steps per second: 192.51
I0902 00:10:53.970970 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.00
INFO:tensorflow:Starting iteration 9
I0902 00:10:54.217140 140268518520832 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 197.22
I0902 00:10:59.288365 140268518520832 replay_runner.py:36] Average training steps per second: 197.22
I0902 00:10:59.695331 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 189.42
I0902 00:11:05.218375 140268518520832 replay_runner.py:36] Average training steps per second: 189.42
I0902 00:11:05.448833 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 11

Steps executed: 274 Episode length: 201 Return: -200.0
INFO:tensorflow:Average training steps per second: 190.26
I0902 00:11:10.931273 140268518520832 replay_runner.py:36] Average training steps per second: 190.26
I0902 00:11:11.147201 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.00
INFO:tensorflow:Starting iteration 12

Steps executed: 254 Episode length: 151 Return: -150.0
INFO:tensorflow:Average training steps per second: 187.70
I0902 00:11:16.704155 140268518520832 replay_runner.py:36] Average training steps per second: 187.70
I0902 00:11:16.879596 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.67
INFO:tensorflow:Starting iteration 13

Steps executed: 206 Episode length: 65 Return: -64.0.0
INFO:tensorflow:Average training steps per second: 190.78
I0902 00:11:22.355359 140268518520832 replay_runner.py:36] Average training steps per second: 190.78
I0902 00:11:22.524022 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 14

Steps executed: 208 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 188.86

Steps executed: 273 Episode length: 93 Return: -92.0.0
I0902 00:11:28.286839 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 15

Steps executed: 241 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 195.70
I0902 00:11:33.640879 140268518520832 replay_runner.py:36] Average training steps per second: 195.70
I0902 00:11:33.842165 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 16

Steps executed: 236 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 188.60
I0902 00:11:39.386606 140268518520832 replay_runner.py:36] Average training steps per second: 188.60
I0902 00:11:39.580436 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 17

Steps executed: 229 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Average training steps per second: 199.51
I0902 00:11:44.829701 140268518520832 replay_runner.py:36] Average training steps per second: 199.51
I0902 00:11:45.028395 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 18

Steps executed: 258 Episode length: 139 Return: -138.0
INFO:tensorflow:Average training steps per second: 195.95
I0902 00:11:50.400456 140268518520832 replay_runner.py:36] Average training steps per second: 195.95
I0902 00:11:50.608987 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.00
INFO:tensorflow:Starting iteration 19
I0902 00:11:50.845114 140268518520832 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 203.33
I0902 00:11:55.763677 140268518520832 replay_runner.py:36] Average training steps per second: 203.33
I0902 00:11:55.912461 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 20


Steps executed: 307 Episode length: 136 Return: -135.0
INFO:tensorflow:Average training steps per second: 199.99
I0902 00:12:01.142772 140268518520832 replay_runner.py:36] Average training steps per second: 199.99
I0902 00:12:01.373620 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.33
INFO:tensorflow:Starting iteration 21

Steps executed: 284 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 202.61
I0902 00:12:06.544897 140268518520832 replay_runner.py:36] Average training steps per second: 202.61
I0902 00:12:06.770790 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 22
I0902 00:12:07.053898 140268518520832 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 191.98
I0902 00:12:12.263421 140268518520832 replay_runner.py:36] Average training steps per second: 191.98
I0902 00:12:12.664801 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.30
I0902 00:12:18.073322 140268518520832 replay_runner.py:36] Average training steps per second: 193.30

Steps executed: 319 Episode length: 124 Return: -123.0
INFO:tensorflow:Starting iteration 24

Steps executed: 284 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 190.96
I0902 00:12:23.815145 140268518520832 replay_runner.py:36] Average training steps per second: 190.96
I0902 00:12:24.054740 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.67
INFO:tensorflow:Starting iteration 25

Steps executed: 244 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 192.26
I0902 00:12:29.512227 140268518520832 replay_runner.py:36] Average training steps per second: 192.26
I0902 00:12:29.691357 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 26

Steps executed: 299 Episode length: 101 Return: -100.0
INFO:tensorflow:Average training steps per second: 190.15
I0902 00:12:35.183438 140268518520832 replay_runner.py:36] Average training steps per second: 190.15
I0902 00:12:35.431624 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.67
INFO:tensorflow:Starting iteration 27

Steps executed: 210 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 193.40
I0902 00:12:40.832054 140268518520832 replay_runner.py:36] Average training steps per second: 193.40
I0902 00:12:41.018641 140268518520832 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 28

Steps executed: 72 Episode length: 72 Return: -71.00.0
INFO:tensorflow:Average training steps per second: 187.20
I0902 00:12:46.609494 140268518520832 replay_runner.py:36] Average training steps per second: 187.20

Steps executed: 224 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Starting iteration 29

Steps executed: 326 Episode length: 263 Return: -262.0
INFO:tensorflow:Average training steps per second: 190.93
I0902 00:12:52.290136 140268518520832 replay_runner.py:36] Average training steps per second: 190.93

Done fixed training!Episode length: 263 Return: -262.0