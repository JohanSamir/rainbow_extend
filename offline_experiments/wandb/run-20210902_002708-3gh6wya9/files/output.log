Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 00:27:14.325827 139965167532032 run_experiment.py:549] Creating TrainRunner ...
I0902 00:27:14.335796 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:14.336001 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:14.336121 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:14.336233 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:14.336368 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:14.336511 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:14.336613 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:14.336720 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:14.336821 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:14.336916 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:14.337009 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:14.337121 139965167532032 dqn_agent.py:283] 	 seed: 1630542434335744
I0902 00:27:14.340018 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:14.340188 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:14.340351 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:14.340494 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:14.340632 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:14.340779 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:14.340910 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:14.341017 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:14.341138 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:14.377119 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:14.676636 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:14.686552 139965167532032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:27:14.693606 139965167532032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:27:14.693846 139965167532032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:27:14.693999 139965167532032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:27:14.694342 139965167532032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:27:14.694474 139965167532032 dqn_agent.py:275] 	 update_period: 4
I0902 00:27:14.694568 139965167532032 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:27:14.694658 139965167532032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:27:14.694789 139965167532032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:27:14.694897 139965167532032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:27:14.694980 139965167532032 dqn_agent.py:280] 	 optimizer: adam
I0902 00:27:14.695105 139965167532032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:27:14.695196 139965167532032 dqn_agent.py:283] 	 seed: 1630542434693573
I0902 00:27:14.697225 139965167532032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:27:14.697337 139965167532032 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:27:14.697408 139965167532032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:27:14.697483 139965167532032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:27:14.697539 139965167532032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:27:14.697608 139965167532032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:27:14.697671 139965167532032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:27:14.697744 139965167532032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:27:14.697809 139965167532032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:27:14.720201 139965167532032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:27:14.736881 139965167532032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:27:14.737030 139965167532032 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 256.12
I0902 00:27:18.641828 139965167532032 replay_runner.py:36] Average training steps per second: 256.12
I0902 00:27:19.444698 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.32
Steps executed: 257 Episode length: 112 Return: -410.85441117048724
INFO:tensorflow:Starting iteration 1

Steps executed: 348 Episode length: 153 Return: -299.59313089679017
INFO:tensorflow:Average training steps per second: 338.91
I0902 00:27:25.690066 139965167532032 replay_runner.py:36] Average training steps per second: 338.91
I0902 00:27:25.905116 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -400.14
INFO:tensorflow:Starting iteration 2

Steps executed: 215 Episode length: 107 Return: -370.19242130806515
INFO:tensorflow:Average training steps per second: 345.60
I0902 00:27:32.086971 139965167532032 replay_runner.py:36] Average training steps per second: 345.60
I0902 00:27:32.200476 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -449.14
INFO:tensorflow:Starting iteration 3
I0902 00:27:35.605288 139965167532032 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 344.78
I0902 00:27:38.505984 139965167532032 replay_runner.py:36] Average training steps per second: 344.78

Steps executed: 591 Episode length: 591 Return: -152.07573933999083
INFO:tensorflow:Starting iteration 4
I0902 00:27:42.786915 139965167532032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 349.45

Steps executed: 1000 Episode length: 1000 Return: -230.11660555104132
I0902 00:27:48.497892 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -230.12
INFO:tensorflow:Starting iteration 5
I0902 00:27:51.867477 139965167532032 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 334.43

Steps executed: 1000 Episode length: 1000 Return: -40.996769421604334
I0902 00:27:56.421801 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.00
INFO:tensorflow:Starting iteration 6
I0902 00:27:59.755723 139965167532032 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 325.66
I0902 00:28:02.826723 139965167532032 replay_runner.py:36] Average training steps per second: 325.66

Steps executed: 1000 Episode length: 1000 Return: -24.314085002090366
INFO:tensorflow:Starting iteration 7

Steps executed: 783 Episode length: 783 Return: -301.5401132891045766
INFO:tensorflow:Average training steps per second: 343.78
I0902 00:28:10.400999 139965167532032 replay_runner.py:36] Average training steps per second: 343.78
I0902 00:28:11.997419 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.54
INFO:tensorflow:Starting iteration 8
I0902 00:28:15.413216 139965167532032 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 353.03

Steps executed: 641 Episode length: 641 Return: -161.4866811223453766
I0902 00:28:19.044494 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.49
INFO:tensorflow:Starting iteration 9
I0902 00:28:22.492990 139965167532032 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 337.52

Steps executed: 1000 Episode length: 1000 Return: -59.176922171601866
I0902 00:28:26.986521 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -59.18
INFO:tensorflow:Starting iteration 10
I0902 00:28:30.417739 139965167532032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 339.18

Steps executed: 963 Episode length: 963 Return: -235.0049639197354766
I0902 00:28:35.226173 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -235.00
INFO:tensorflow:Starting iteration 11

Steps executed: 204 Episode length: 204 Return: -161.4426810435512766
INFO:tensorflow:Average training steps per second: 346.30
I0902 00:28:41.468191 139965167532032 replay_runner.py:36] Average training steps per second: 346.30
I0902 00:28:41.599942 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.44
INFO:tensorflow:Starting iteration 12
I0902 00:28:44.793766 139965167532032 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 318.96
I0902 00:28:47.929209 139965167532032 replay_runner.py:36] Average training steps per second: 318.96

Steps executed: 1000 Episode length: 1000 Return: -255.16980065967366
INFO:tensorflow:Starting iteration 13

Steps executed: 215 Episode length: 215 Return: -256.6699484237115666
INFO:tensorflow:Average training steps per second: 339.19
I0902 00:28:56.840188 139965167532032 replay_runner.py:36] Average training steps per second: 339.19
I0902 00:28:56.985550 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.67
INFO:tensorflow:Starting iteration 14

Steps executed: 261 Episode length: 261 Return: -375.5024823495062466
INFO:tensorflow:Average training steps per second: 331.26
I0902 00:29:03.313217 139965167532032 replay_runner.py:36] Average training steps per second: 331.26
I0902 00:29:03.517256 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.50
INFO:tensorflow:Starting iteration 15

Steps executed: 59 Episode length: 59 Return: -168.967208028709082466
INFO:tensorflow:Average training steps per second: 348.10

Steps executed: 752 Episode length: 693 Return: -160.7283590563898866
I0902 00:29:10.973249 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.85
INFO:tensorflow:Starting iteration 16

Steps executed: 270 Episode length: 144 Return: -110.4088590334090666
INFO:tensorflow:Average training steps per second: 356.09
I0902 00:29:17.180989 139965167532032 replay_runner.py:36] Average training steps per second: 356.09
I0902 00:29:17.343572 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.05
INFO:tensorflow:Starting iteration 17

Steps executed: 254 Episode length: 70 Return: -203.03724200436296666
INFO:tensorflow:Average training steps per second: 353.37
I0902 00:29:23.709429 139965167532032 replay_runner.py:36] Average training steps per second: 353.37
I0902 00:29:23.810240 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.04
INFO:tensorflow:Starting iteration 18

Steps executed: 318 Episode length: 167 Return: -631.5829571263923266
INFO:tensorflow:Average training steps per second: 358.27
I0902 00:29:30.055628 139965167532032 replay_runner.py:36] Average training steps per second: 358.27
I0902 00:29:30.247562 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -389.66
INFO:tensorflow:Starting iteration 19

Steps executed: 214 Episode length: 109 Return: -752.0134142474146266
INFO:tensorflow:Average training steps per second: 344.90
I0902 00:29:36.628853 139965167532032 replay_runner.py:36] Average training steps per second: 344.90
I0902 00:29:36.761584 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -751.29
INFO:tensorflow:Starting iteration 20

Steps executed: 385 Episode length: 254 Return: -614.3866466724053366
INFO:tensorflow:Average training steps per second: 342.66
I0902 00:29:43.143615 139965167532032 replay_runner.py:36] Average training steps per second: 342.66
I0902 00:29:43.414585 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -384.21
INFO:tensorflow:Starting iteration 21

Steps executed: 206 Episode length: 93 Return: -425.70148338686226666
INFO:tensorflow:Average training steps per second: 348.33
I0902 00:29:49.743389 139965167532032 replay_runner.py:36] Average training steps per second: 348.33
I0902 00:29:49.873827 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.37
INFO:tensorflow:Starting iteration 22

Steps executed: 111 Episode length: 111 Return: -433.8044466873855666
INFO:tensorflow:Average training steps per second: 350.56
I0902 00:29:56.224334 139965167532032 replay_runner.py:36] Average training steps per second: 350.56

Steps executed: 230 Episode length: 119 Return: -152.6146153712547366
INFO:tensorflow:Starting iteration 23

Steps executed: 286 Episode length: 94 Return: -190.30195186961652366
INFO:tensorflow:Average training steps per second: 346.86
I0902 00:30:02.766050 139965167532032 replay_runner.py:36] Average training steps per second: 346.86
I0902 00:30:02.922206 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.59
INFO:tensorflow:Starting iteration 24

Steps executed: 368 Episode length: 183 Return: -80.53770596941592366
INFO:tensorflow:Average training steps per second: 345.14
I0902 00:30:09.285898 139965167532032 replay_runner.py:36] Average training steps per second: 345.14
I0902 00:30:09.502019 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.56
INFO:tensorflow:Starting iteration 25

Steps executed: 415 Episode length: 255 Return: 34.341599691221868366
INFO:tensorflow:Average training steps per second: 341.21
I0902 00:30:15.845944 139965167532032 replay_runner.py:36] Average training steps per second: 341.21
I0902 00:30:16.098672 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.94
INFO:tensorflow:Starting iteration 26
I0902 00:30:19.470670 139965167532032 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 329.75

Steps executed: 363 Episode length: 170 Return: -167.4708918080022566
I0902 00:30:22.760493 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -260.05
INFO:tensorflow:Starting iteration 27

Steps executed: 207 Episode length: 51 Return: -155.93270211660484566
INFO:tensorflow:Average training steps per second: 333.74
I0902 00:30:29.136895 139965167532032 replay_runner.py:36] Average training steps per second: 333.74
I0902 00:30:29.234277 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.39
INFO:tensorflow:Starting iteration 28

Steps executed: 270 Episode length: 72 Return: -366.81688079426117566
INFO:tensorflow:Average training steps per second: 327.85
I0902 00:30:35.561422 139965167532032 replay_runner.py:36] Average training steps per second: 327.85
I0902 00:30:35.721783 139965167532032 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.57
INFO:tensorflow:Starting iteration 29

Steps executed: 279 Episode length: 123 Return: -149.2906726738493166
INFO:tensorflow:Average training steps per second: 331.07
I0902 00:30:42.023592 139965167532032 replay_runner.py:36] Average training steps per second: 331.07

Done fixed training!Episode length: 123 Return: -149.2906726738493166