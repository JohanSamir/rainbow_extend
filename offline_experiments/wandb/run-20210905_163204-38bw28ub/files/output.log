I0905 16:32:11.336384 140396052076544 run_experiment.py:549] Creating TrainRunner ...
I0905 16:32:11.344858 140396052076544 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:32:11.345083 140396052076544 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:32:11.345180 140396052076544 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:32:11.345255 140396052076544 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:32:11.345383 140396052076544 dqn_agent.py:275] 	 update_period: 4
I0905 16:32:11.345470 140396052076544 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:32:11.345595 140396052076544 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:32:11.345674 140396052076544 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:32:11.345772 140396052076544 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:32:11.345889 140396052076544 dqn_agent.py:280] 	 optimizer: adam
I0905 16:32:11.345985 140396052076544 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:32:11.346066 140396052076544 dqn_agent.py:283] 	 seed: 1630859531344801
I0905 16:32:11.348540 140396052076544 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:32:11.348725 140396052076544 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:32:11.349092 140396052076544 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:32:11.349314 140396052076544 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:32:11.349435 140396052076544 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:32:11.349545 140396052076544 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:32:11.349652 140396052076544 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:32:11.349750 140396052076544 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:32:11.349851 140396052076544 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0905 16:32:13.257824 140396052076544 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:32:14.102840 140396052076544 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:32:14.119872 140396052076544 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:32:14.131400 140396052076544 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:32:14.131701 140396052076544 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:32:14.131923 140396052076544 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:32:14.132142 140396052076544 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:32:14.132646 140396052076544 dqn_agent.py:275] 	 update_period: 4
I0905 16:32:14.132851 140396052076544 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:32:14.133057 140396052076544 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:32:14.133263 140396052076544 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:32:14.133357 140396052076544 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:32:14.133431 140396052076544 dqn_agent.py:280] 	 optimizer: adam
I0905 16:32:14.133541 140396052076544 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:32:14.133748 140396052076544 dqn_agent.py:283] 	 seed: 1630859534131332
I0905 16:32:14.137507 140396052076544 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:32:14.137704 140396052076544 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:32:14.137794 140396052076544 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:32:14.137860 140396052076544 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:32:14.137923 140396052076544 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:32:14.138028 140396052076544 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:32:14.138347 140396052076544 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:32:14.138516 140396052076544 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:32:14.138670 140396052076544 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:32:14.196659 140396052076544 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:32:14.223241 140396052076544 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:32:14.223570 140396052076544 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 120.29
I0905 16:32:22.537781 140396052076544 replay_runner.py:36] Average training steps per second: 120.29
Steps executed: 206 Episode length: 10 Return: 10.0
I0905 16:32:24.073405 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.36
INFO:tensorflow:Starting iteration 1
I0905 16:32:24.324755 140396052076544 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 150.26

Steps executed: 281 Episode length: 89 Return: 89.0
I0905 16:32:31.536917 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 93.67
INFO:tensorflow:Starting iteration 2
I0905 16:32:31.781868 140396052076544 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 145.33

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:32:39.282711 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0905 16:32:39.499955 140396052076544 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 142.06
I0905 16:32:46.540034 140396052076544 replay_runner.py:36] Average training steps per second: 142.06
I0905 16:32:46.978041 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0905 16:32:47.192958 140396052076544 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 133.80
I0905 16:32:54.667799 140396052076544 replay_runner.py:36] Average training steps per second: 133.80
I0905 16:32:55.081093 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5
I0905 16:32:55.347770 140396052076544 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 137.10
I0905 16:33:02.642648 140396052076544 replay_runner.py:36] Average training steps per second: 137.10
I0905 16:33:03.126396 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 6

Steps executed: 154 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 136.81

Steps executed: 296 Episode length: 142 Return: 142.0
I0905 16:33:11.229513 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 148.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 140.53
I0905 16:33:18.551497 140396052076544 replay_runner.py:36] Average training steps per second: 140.53
I0905 16:33:18.891640 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0905 16:33:19.132413 140396052076544 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 137.09
I0905 16:33:26.428045 140396052076544 replay_runner.py:36] Average training steps per second: 137.09
I0905 16:33:27.089639 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0905 16:33:27.353863 140396052076544 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 136.23
I0905 16:33:34.695295 140396052076544 replay_runner.py:36] Average training steps per second: 136.23
I0905 16:33:35.389278 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0905 16:33:35.701339 140396052076544 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 140.01

Steps executed: 306 Episode length: 156 Return: 156.0
I0905 16:33:43.686539 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.00
INFO:tensorflow:Starting iteration 11
I0905 16:33:43.968164 140396052076544 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 146.40

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 16:33:51.521577 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12
I0905 16:33:51.758940 140396052076544 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 145.04
I0905 16:33:58.654387 140396052076544 replay_runner.py:36] Average training steps per second: 145.04
I0905 16:33:59.198630 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 13

Steps executed: 342 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 148.22
I0905 16:34:06.166864 140396052076544 replay_runner.py:36] Average training steps per second: 148.22
I0905 16:34:07.136010 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 14

Steps executed: 144 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 141.35
I0905 16:34:14.490237 140396052076544 replay_runner.py:36] Average training steps per second: 141.35

Steps executed: 298 Episode length: 154 Return: 154.0
INFO:tensorflow:Starting iteration 15
I0905 16:34:15.624806 140396052076544 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 132.99

Steps executed: 376 Episode length: 200 Return: 200.0
I0905 16:34:24.021530 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.00
INFO:tensorflow:Starting iteration 16

Steps executed: 315 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 134.81
I0905 16:34:31.731698 140396052076544 replay_runner.py:36] Average training steps per second: 134.81
I0905 16:34:32.439957 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 157.50
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 139.99
I0905 16:34:39.895826 140396052076544 replay_runner.py:36] Average training steps per second: 139.99
I0905 16:34:40.412126 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 16:34:40.686319 140396052076544 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 136.30
I0905 16:34:48.024052 140396052076544 replay_runner.py:36] Average training steps per second: 136.30
I0905 16:34:48.784001 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 16:34:49.061858 140396052076544 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 132.81
I0905 16:34:56.593289 140396052076544 replay_runner.py:36] Average training steps per second: 132.81
I0905 16:34:57.272298 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 16:34:57.593917 140396052076544 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 150.43
I0905 16:35:04.243097 140396052076544 replay_runner.py:36] Average training steps per second: 150.43
I0905 16:35:04.917891 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0905 16:35:05.263490 140396052076544 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 139.39
I0905 16:35:12.438608 140396052076544 replay_runner.py:36] Average training steps per second: 139.39
I0905 16:35:12.892725 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0905 16:35:13.173419 140396052076544 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 140.55
I0905 16:35:20.289342 140396052076544 replay_runner.py:36] Average training steps per second: 140.55
I0905 16:35:20.767187 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23

Steps executed: 269 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 143.62
I0905 16:35:27.973038 140396052076544 replay_runner.py:36] Average training steps per second: 143.62
I0905 16:35:28.646831 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 134.50
INFO:tensorflow:Starting iteration 24

Steps executed: 325 Episode length: 146 Return: 146.0
INFO:tensorflow:Average training steps per second: 138.84
I0905 16:35:36.106674 140396052076544 replay_runner.py:36] Average training steps per second: 138.84
I0905 16:35:36.981531 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 25

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 143.16
I0905 16:35:44.218259 140396052076544 replay_runner.py:36] Average training steps per second: 143.16
I0905 16:35:44.706550 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0905 16:35:44.971868 140396052076544 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 140.31
I0905 16:35:52.100304 140396052076544 replay_runner.py:36] Average training steps per second: 140.31
I0905 16:35:52.381724 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0905 16:35:52.626836 140396052076544 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 207.48
I0905 16:35:57.447231 140396052076544 replay_runner.py:36] Average training steps per second: 207.48
I0905 16:35:57.823180 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 342 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 156.80
I0905 16:36:04.462744 140396052076544 replay_runner.py:36] Average training steps per second: 156.80
I0905 16:36:05.024134 140396052076544 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 29
I0905 16:36:05.236896 140396052076544 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 159.27
I0905 16:36:11.516071 140396052076544 replay_runner.py:36] Average training steps per second: 159.27

Done fixed training!Episode length: 200 Return: 200.0