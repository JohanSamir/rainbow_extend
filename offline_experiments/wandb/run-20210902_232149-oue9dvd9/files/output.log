I0902 23:21:56.020027 139766973487104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:21:56.030513 139766973487104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:56.030832 139766973487104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:56.031000 139766973487104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:56.031135 139766973487104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:56.031258 139766973487104 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:56.031383 139766973487104 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:56.031509 139766973487104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:56.031626 139766973487104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:56.031789 139766973487104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:56.031979 139766973487104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:56.032105 139766973487104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:56.032243 139766973487104 dqn_agent.py:283] 	 seed: 1630624916030448
I0902 23:21:56.035538 139766973487104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:56.035747 139766973487104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:56.035931 139766973487104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:56.036079 139766973487104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:56.036203 139766973487104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:56.036475 139766973487104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:56.036623 139766973487104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:56.036800 139766973487104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:56.037000 139766973487104 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 6, please be patient, may be a while...
I0902 23:21:58.152623 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:58.643602 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:58.657815 139766973487104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:21:58.664849 139766973487104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:21:58.665098 139766973487104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:21:58.665237 139766973487104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:21:58.665351 139766973487104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:21:58.665579 139766973487104 dqn_agent.py:275] 	 update_period: 4
I0902 23:21:58.665669 139766973487104 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:21:58.665773 139766973487104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:21:58.666050 139766973487104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:21:58.666203 139766973487104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:21:58.666337 139766973487104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:21:58.666429 139766973487104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:21:58.666546 139766973487104 dqn_agent.py:283] 	 seed: 1630624918664803
I0902 23:21:58.670027 139766973487104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:21:58.670302 139766973487104 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:21:58.670423 139766973487104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:21:58.670659 139766973487104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:21:58.670773 139766973487104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:21:58.670855 139766973487104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:21:58.670983 139766973487104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:21:58.671100 139766973487104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:21:58.671180 139766973487104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:21:58.705717 139766973487104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:21:58.725804 139766973487104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:21:58.726073 139766973487104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 153.43
I0902 23:22:05.244100 139766973487104 replay_runner.py:36] Average training steps per second: 153.43
Steps executed: 208 Episode length: 9 Return: 9.0.0
I0902 23:22:06.361229 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 195 Episode length: 99 Return: 99.0
INFO:tensorflow:Average training steps per second: 205.25
I0902 23:22:11.437394 139766973487104 replay_runner.py:36] Average training steps per second: 205.25
I0902 23:22:11.617731 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 98.00
INFO:tensorflow:Starting iteration 2


Steps executed: 336 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 213.38
I0902 23:22:16.480709 139766973487104 replay_runner.py:36] Average training steps per second: 213.38
I0902 23:22:16.655109 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 3

Steps executed: 394 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.73
I0902 23:22:21.807018 139766973487104 replay_runner.py:36] Average training steps per second: 200.73
I0902 23:22:22.057915 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.00
INFO:tensorflow:Starting iteration 4

Steps executed: 334 Episode length: 167 Return: 167.0
INFO:tensorflow:Average training steps per second: 216.84
I0902 23:22:26.848607 139766973487104 replay_runner.py:36] Average training steps per second: 216.84
I0902 23:22:27.072282 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 167.00
INFO:tensorflow:Starting iteration 5

Steps executed: 285 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 197.71
I0902 23:22:32.312344 139766973487104 replay_runner.py:36] Average training steps per second: 197.71
I0902 23:22:32.501356 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 6
I0902 23:22:32.689357 139766973487104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 196.62

Steps executed: 341 Episode length: 175 Return: 175.0
I0902 23:22:38.019615 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 7

Steps executed: 310 Episode length: 152 Return: 152.0
INFO:tensorflow:Average training steps per second: 196.88
I0902 23:22:43.297642 139766973487104 replay_runner.py:36] Average training steps per second: 196.88
I0902 23:22:43.501238 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 8

Steps executed: 348 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 190.27
I0902 23:22:48.938119 139766973487104 replay_runner.py:36] Average training steps per second: 190.27
I0902 23:22:49.180376 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 174.00
INFO:tensorflow:Starting iteration 9

Steps executed: 340 Episode length: 168 Return: 168.0
INFO:tensorflow:Average training steps per second: 198.26
I0902 23:22:54.411823 139766973487104 replay_runner.py:36] Average training steps per second: 198.26
I0902 23:22:54.645637 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 10
I0902 23:22:54.816972 139766973487104 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 193.45

Steps executed: 294 Episode length: 137 Return: 137.0
I0902 23:23:00.181105 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 189.63
I0902 23:23:05.637247 139766973487104 replay_runner.py:36] Average training steps per second: 189.63
I0902 23:23:05.790040 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 346 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.85
I0902 23:23:11.099286 139766973487104 replay_runner.py:36] Average training steps per second: 195.85
I0902 23:23:11.336780 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.00
INFO:tensorflow:Starting iteration 13

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.24
I0902 23:23:16.669107 139766973487104 replay_runner.py:36] Average training steps per second: 194.24
I0902 23:23:16.814976 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14

Steps executed: 347 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.08
I0902 23:23:21.966319 139766973487104 replay_runner.py:36] Average training steps per second: 202.08
I0902 23:23:22.214550 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 173.50
INFO:tensorflow:Starting iteration 15

Steps executed: 192 Episode length: 192 Return: 192.0
INFO:tensorflow:Average training steps per second: 191.82
I0902 23:23:27.627520 139766973487104 replay_runner.py:36] Average training steps per second: 191.82
I0902 23:23:27.896313 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.00
INFO:tensorflow:Starting iteration 16


Steps executed: 313 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 191.48
I0902 23:23:33.308650 139766973487104 replay_runner.py:36] Average training steps per second: 191.48
I0902 23:23:33.538960 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 17

Steps executed: 377 Episode length: 197 Return: 197.0
INFO:tensorflow:Average training steps per second: 194.69
I0902 23:23:38.880576 139766973487104 replay_runner.py:36] Average training steps per second: 194.69
I0902 23:23:39.136980 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.50
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.75
I0902 23:23:44.651855 139766973487104 replay_runner.py:36] Average training steps per second: 187.75
I0902 23:23:44.794376 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:23:44.970624 139766973487104 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 197.67
I0902 23:23:50.030105 139766973487104 replay_runner.py:36] Average training steps per second: 197.67
I0902 23:23:50.326455 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 20


Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.35
I0902 23:23:55.752588 139766973487104 replay_runner.py:36] Average training steps per second: 191.35
I0902 23:23:55.894496 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 386 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.08
I0902 23:24:01.296939 139766973487104 replay_runner.py:36] Average training steps per second: 192.08
I0902 23:24:01.579230 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 193.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.22
I0902 23:24:06.824844 139766973487104 replay_runner.py:36] Average training steps per second: 198.22
I0902 23:24:06.959033 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:24:07.152578 139766973487104 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.61
I0902 23:24:12.371808 139766973487104 replay_runner.py:36] Average training steps per second: 191.61
I0902 23:24:12.508418 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:24:12.693735 139766973487104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 198.40
I0902 23:24:17.734577 139766973487104 replay_runner.py:36] Average training steps per second: 198.40
I0902 23:24:17.873197 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:24:18.057320 139766973487104 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 191.40
I0902 23:24:23.282532 139766973487104 replay_runner.py:36] Average training steps per second: 191.40
I0902 23:24:23.416290 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:24:23.600736 139766973487104 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 198.52
I0902 23:24:28.638343 139766973487104 replay_runner.py:36] Average training steps per second: 198.52
I0902 23:24:28.790109 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 379 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.67
I0902 23:24:34.026641 139766973487104 replay_runner.py:36] Average training steps per second: 198.67
I0902 23:24:34.286153 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.50
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.39
I0902 23:24:39.275131 139766973487104 replay_runner.py:36] Average training steps per second: 208.39
I0902 23:24:39.414471 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29
I0902 23:24:39.608381 139766973487104 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 202.19

Done fixed training!Episode length: 200 Return: 200.0
I0902 23:24:44.800424 139766973487104 run_experiment.py:428] Average undiscounted return per evaluation episode: 183.00