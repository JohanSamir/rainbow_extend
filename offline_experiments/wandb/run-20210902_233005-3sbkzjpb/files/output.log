I0902 23:30:11.824057 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0902 23:30:11.836182 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:30:11.836422 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:30:11.836516 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:30:11.836596 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:30:11.836687 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:30:11.836818 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:30:11.837012 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:30:11.837260 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:30:11.837430 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:30:11.837626 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:30:11.837851 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:30:11.837998 139735608805376 dqn_agent.py:283] 	 seed: 1630625411836110
I0902 23:30:11.840863 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:30:11.841002 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:30:11.841073 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:30:11.841131 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:30:11.841182 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:30:11.841251 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:30:11.841307 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:30:11.841354 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:30:11.841401 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 23:30:13.716525 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:30:14.125378 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:30:14.138857 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:30:14.149063 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:30:14.149315 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:30:14.149405 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:30:14.149503 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:30:14.149674 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:30:14.149770 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:30:14.149845 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:30:14.149927 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:30:14.150034 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:30:14.150172 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:30:14.150273 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:30:14.150350 139735608805376 dqn_agent.py:283] 	 seed: 1630625414149016
I0902 23:30:14.152474 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:30:14.152642 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:30:14.152749 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:30:14.152904 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:30:14.153036 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:30:14.153168 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:30:14.153255 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:30:14.153350 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:30:14.153451 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:30:14.186232 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:30:14.207787 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:30:14.207994 139735608805376 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.10
I0902 23:30:20.265279 139735608805376 replay_runner.py:36] Average training steps per second: 165.10
Steps executed: 209 Episode length: 135 Return: -283.51842486941814
I0902 23:30:21.522017 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.17
INFO:tensorflow:Starting iteration 1

Steps executed: 266 Episode length: 128 Return: -266.90723652604055
INFO:tensorflow:Average training steps per second: 220.45
I0902 23:30:30.417295 139735608805376 replay_runner.py:36] Average training steps per second: 220.45
I0902 23:30:30.652592 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.35
INFO:tensorflow:Starting iteration 2

Steps executed: 313 Episode length: 161 Return: -317.85677265819429
INFO:tensorflow:Average training steps per second: 219.69
I0902 23:30:39.550271 139735608805376 replay_runner.py:36] Average training steps per second: 219.69
I0902 23:30:39.851329 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.98
INFO:tensorflow:Starting iteration 3

Steps executed: 286 Episode length: 286 Return: -547.21828062857419
INFO:tensorflow:Average training steps per second: 230.74
I0902 23:30:48.568092 139735608805376 replay_runner.py:36] Average training steps per second: 230.74
I0902 23:30:48.880190 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -547.22
INFO:tensorflow:Starting iteration 4
I0902 23:30:53.178243 139735608805376 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 231.98

Steps executed: 1000 Episode length: 1000 Return: -143.7366686995322
I0902 23:31:00.616079 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.74
INFO:tensorflow:Starting iteration 5

Steps executed: 51 Episode length: 51 Return: -134.77365361549866322
INFO:tensorflow:Average training steps per second: 222.82

Steps executed: 1051 Episode length: 1000 Return: -135.19050961147076
I0902 23:31:13.117780 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.98
INFO:tensorflow:Starting iteration 6
I0902 23:31:17.474982 139735608805376 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 241.83

Steps executed: 1000 Episode length: 1000 Return: -197.54520830799032
I0902 23:31:24.523822 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.55
INFO:tensorflow:Starting iteration 7
I0902 23:31:28.818635 139735608805376 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 248.17

Steps executed: 990 Episode length: 990 Return: -301.0040958844791032
I0902 23:31:35.522920 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -301.00
INFO:tensorflow:Starting iteration 8

Steps executed: 389 Episode length: 389 Return: -353.0480384560055432
INFO:tensorflow:Average training steps per second: 230.53
I0902 23:31:44.188055 139735608805376 replay_runner.py:36] Average training steps per second: 230.53
I0902 23:31:44.846478 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -353.05
INFO:tensorflow:Starting iteration 9
I0902 23:31:49.097546 139735608805376 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 225.84

Steps executed: 352 Episode length: 352 Return: -251.0046764881363432
I0902 23:31:53.950055 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.00
INFO:tensorflow:Starting iteration 10

Steps executed: 77 Episode length: 77 Return: -166.648797897238243432
INFO:tensorflow:Average training steps per second: 226.14

Steps executed: 1027 Episode length: 950 Return: -410.949604757648532
I0902 23:32:04.985706 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -288.80
INFO:tensorflow:Starting iteration 11
I0902 23:32:09.107063 139735608805376 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 224.72
I0902 23:32:13.557593 139735608805376 replay_runner.py:36] Average training steps per second: 224.72

Steps executed: 291 Episode length: 291 Return: -648.4594009055909532
INFO:tensorflow:Starting iteration 12
I0902 23:32:18.235299 139735608805376 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 220.03

Steps executed: 1000 Episode length: 1000 Return: -144.37268747473817
I0902 23:32:25.750176 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.37
INFO:tensorflow:Starting iteration 13
I0902 23:32:30.064657 139735608805376 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 217.23

Steps executed: 1000 Episode length: 1000 Return: -226.79775669957987
I0902 23:32:37.726338 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.80
INFO:tensorflow:Starting iteration 14

Steps executed: 276 Episode length: 276 Return: -215.3938765061475487
INFO:tensorflow:Average training steps per second: 217.48
I0902 23:32:46.638001 139735608805376 replay_runner.py:36] Average training steps per second: 217.48
I0902 23:32:46.991441 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.39
INFO:tensorflow:Starting iteration 15

Steps executed: 247 Episode length: 122 Return: -410.0833580545064587
INFO:tensorflow:Average training steps per second: 224.06
I0902 23:32:55.821155 139735608805376 replay_runner.py:36] Average training steps per second: 224.06
I0902 23:32:56.058164 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.37
INFO:tensorflow:Starting iteration 16

Steps executed: 210 Episode length: 61 Return: -124.74326515794185587
INFO:tensorflow:Average training steps per second: 220.90
I0902 23:33:04.927107 139735608805376 replay_runner.py:36] Average training steps per second: 220.90
I0902 23:33:05.112383 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.57
INFO:tensorflow:Starting iteration 17
I0902 23:33:09.279642 139735608805376 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 223.76

Steps executed: 444 Episode length: 387 Return: -373.9479712951101687
I0902 23:33:14.467588 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -335.23
INFO:tensorflow:Starting iteration 18

Steps executed: 325 Episode length: 134 Return: -316.4537181868074687
INFO:tensorflow:Average training steps per second: 221.12
I0902 23:33:23.231969 139735608805376 replay_runner.py:36] Average training steps per second: 221.12
I0902 23:33:23.537255 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -337.39
INFO:tensorflow:Starting iteration 19

Steps executed: 205 Episode length: 150 Return: -365.6543316725948687
INFO:tensorflow:Average training steps per second: 218.17
I0902 23:33:32.287566 139735608805376 replay_runner.py:36] Average training steps per second: 218.17
I0902 23:33:32.500926 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.39
INFO:tensorflow:Starting iteration 20

Steps executed: 263 Episode length: 263 Return: 17.981988293679393687
INFO:tensorflow:Average training steps per second: 226.91
I0902 23:33:41.259960 139735608805376 replay_runner.py:36] Average training steps per second: 226.91
I0902 23:33:41.549133 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: 17.98
INFO:tensorflow:Starting iteration 21

Steps executed: 239 Episode length: 106 Return: -240.8169702766813687
INFO:tensorflow:Average training steps per second: 225.64
I0902 23:33:50.221665 139735608805376 replay_runner.py:36] Average training steps per second: 225.64
I0902 23:33:50.439462 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.43
INFO:tensorflow:Starting iteration 22

Steps executed: 279 Episode length: 123 Return: -315.5327268486905687
INFO:tensorflow:Average training steps per second: 220.62
I0902 23:33:59.304840 139735608805376 replay_runner.py:36] Average training steps per second: 220.62
I0902 23:33:59.569950 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -351.75
INFO:tensorflow:Starting iteration 23

Steps executed: 253 Episode length: 57 Return: -162.64064514793066687
INFO:tensorflow:Average training steps per second: 220.70
I0902 23:34:08.317904 139735608805376 replay_runner.py:36] Average training steps per second: 220.70
I0902 23:34:08.538902 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -431.23
INFO:tensorflow:Starting iteration 24

Steps executed: 208 Episode length: 130 Return: -206.7129128418421887
INFO:tensorflow:Average training steps per second: 224.50
I0902 23:34:17.218104 139735608805376 replay_runner.py:36] Average training steps per second: 224.50
I0902 23:34:17.414846 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.11
INFO:tensorflow:Starting iteration 25

Steps executed: 211 Episode length: 79 Return: -652.23125350260531887
INFO:tensorflow:Average training steps per second: 231.39
I0902 23:34:25.930533 139735608805376 replay_runner.py:36] Average training steps per second: 231.39
I0902 23:34:26.129318 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -550.06
INFO:tensorflow:Starting iteration 26

Steps executed: 278 Episode length: 82 Return: -399.72999564770413887
INFO:tensorflow:Average training steps per second: 234.64
I0902 23:34:34.592962 139735608805376 replay_runner.py:36] Average training steps per second: 234.64
I0902 23:34:34.812385 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -327.26
INFO:tensorflow:Starting iteration 27

Steps executed: 242 Episode length: 73 Return: -136.17189352409707887
INFO:tensorflow:Average training steps per second: 227.66
I0902 23:34:43.458234 139735608805376 replay_runner.py:36] Average training steps per second: 227.66
I0902 23:34:43.656899 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -256.57
INFO:tensorflow:Starting iteration 28

Steps executed: 203 Episode length: 55 Return: -119.60034402493245887
INFO:tensorflow:Average training steps per second: 224.37
I0902 23:34:52.448672 139735608805376 replay_runner.py:36] Average training steps per second: 224.37
I0902 23:34:52.604557 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.19
INFO:tensorflow:Starting iteration 29

Steps executed: 203 Episode length: 55 Return: -124.15428402804735887
INFO:tensorflow:Average training steps per second: 214.64
I0902 23:35:01.596531 139735608805376 replay_runner.py:36] Average training steps per second: 214.64

Done fixed training!Episode length: 55 Return: -124.15428402804735887