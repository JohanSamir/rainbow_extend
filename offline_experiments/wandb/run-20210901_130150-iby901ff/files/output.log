I0901 13:01:56.851044 140540456830976 run_experiment.py:549] Creating TrainRunner ...
I0901 13:01:56.862411 140540456830976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:01:56.862660 140540456830976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:01:56.862798 140540456830976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:01:56.862907 140540456830976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:01:56.863144 140540456830976 dqn_agent.py:275] 	 update_period: 4
I0901 13:01:56.863282 140540456830976 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:01:56.863358 140540456830976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:01:56.863415 140540456830976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:01:56.863469 140540456830976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:01:56.863521 140540456830976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:01:56.863574 140540456830976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:01:56.863626 140540456830976 dqn_agent.py:283] 	 seed: 1630501316862348
I0901 13:01:56.865976 140540456830976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:01:56.866142 140540456830976 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:01:56.866227 140540456830976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:01:56.866286 140540456830976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:01:56.866347 140540456830976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:01:56.866395 140540456830976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:01:56.866443 140540456830976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:01:56.866491 140540456830976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:01:56.866539 140540456830976 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 7, please be patient, may be a while...
I0901 13:01:58.495573 140540456830976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:01:59.095205 140540456830976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:01:59.110962 140540456830976 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 13:01:59.120771 140540456830976 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 13:01:59.121020 140540456830976 dqn_agent.py:272] 	 gamma: 0.990000
I0901 13:01:59.121138 140540456830976 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 13:01:59.121240 140540456830976 dqn_agent.py:274] 	 min_replay_history: 500
I0901 13:01:59.121421 140540456830976 dqn_agent.py:275] 	 update_period: 4
I0901 13:01:59.121533 140540456830976 dqn_agent.py:276] 	 target_update_period: 100
I0901 13:01:59.121674 140540456830976 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 13:01:59.121737 140540456830976 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 13:01:59.121843 140540456830976 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 13:01:59.122031 140540456830976 dqn_agent.py:280] 	 optimizer: adam
I0901 13:01:59.122320 140540456830976 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 13:01:59.122427 140540456830976 dqn_agent.py:283] 	 seed: 1630501319120708
I0901 13:01:59.125665 140540456830976 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 13:01:59.125927 140540456830976 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 13:01:59.126078 140540456830976 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 13:01:59.126219 140540456830976 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 13:01:59.126331 140540456830976 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 13:01:59.126603 140540456830976 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 13:01:59.126867 140540456830976 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 13:01:59.127022 140540456830976 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 13:01:59.127221 140540456830976 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 13:01:59.162910 140540456830976 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 13:01:59.185998 140540456830976 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 13:01:59.186278 140540456830976 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 138.81
I0901 13:02:06.390717 140540456830976 replay_runner.py:36] Average training steps per second: 138.81
Steps executed: 202 Episode length: 10 Return: 10.0
I0901 13:02:07.572378 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 1

Steps executed: 201 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 192.68
I0901 13:02:12.951407 140540456830976 replay_runner.py:36] Average training steps per second: 192.68
I0901 13:02:13.088398 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 2

Steps executed: 201 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 195.00
I0901 13:02:18.405129 140540456830976 replay_runner.py:36] Average training steps per second: 195.00
I0901 13:02:18.542870 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.57
INFO:tensorflow:Starting iteration 3

Steps executed: 207 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 192.67
I0901 13:02:23.933402 140540456830976 replay_runner.py:36] Average training steps per second: 192.67
I0901 13:02:24.066573 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.86
INFO:tensorflow:Starting iteration 4

Steps executed: 206 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 190.59
I0901 13:02:29.501447 140540456830976 replay_runner.py:36] Average training steps per second: 190.59
I0901 13:02:29.640169 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 10.30
INFO:tensorflow:Starting iteration 5
I0901 13:02:29.841087 140540456830976 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 202.10

Steps executed: 210 Episode length: 27 Return: 27.0
I0901 13:02:35.314966 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 26.25
INFO:tensorflow:Starting iteration 6
I0901 13:02:35.509026 140540456830976 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 190.28

Steps executed: 248 Episode length: 147 Return: 147.0
I0901 13:02:40.921466 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 124.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.64
I0901 13:02:46.148810 140540456830976 replay_runner.py:36] Average training steps per second: 198.64
I0901 13:02:46.277434 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8
I0901 13:02:46.465739 140540456830976 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 197.62
I0901 13:02:51.526445 140540456830976 replay_runner.py:36] Average training steps per second: 197.62
I0901 13:02:51.649218 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 9
I0901 13:02:51.832695 140540456830976 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 196.50
I0901 13:02:56.922454 140540456830976 replay_runner.py:36] Average training steps per second: 196.50
I0901 13:02:57.045556 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10

Steps executed: 316 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 208.54
I0901 13:03:02.028046 140540456830976 replay_runner.py:36] Average training steps per second: 208.54
I0901 13:03:02.218909 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 11

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.55
I0901 13:03:07.419009 140540456830976 replay_runner.py:36] Average training steps per second: 199.55
I0901 13:03:07.539952 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 12

Steps executed: 273 Episode length: 137 Return: 137.0
INFO:tensorflow:Average training steps per second: 215.65
I0901 13:03:12.353760 140540456830976 replay_runner.py:36] Average training steps per second: 215.65
I0901 13:03:12.510031 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 13

Steps executed: 292 Episode length: 148 Return: 148.0
INFO:tensorflow:Average training steps per second: 208.88
I0901 13:03:17.479023 140540456830976 replay_runner.py:36] Average training steps per second: 208.88
I0901 13:03:17.637371 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 210.44
I0901 13:03:22.560609 140540456830976 replay_runner.py:36] Average training steps per second: 210.44
I0901 13:03:22.677379 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 369 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 208.60
I0901 13:03:27.653168 140540456830976 replay_runner.py:36] Average training steps per second: 208.60
I0901 13:03:27.868108 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.50
INFO:tensorflow:Starting iteration 16
I0901 13:03:28.046401 140540456830976 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 204.99
I0901 13:03:32.925176 140540456830976 replay_runner.py:36] Average training steps per second: 204.99
I0901 13:03:33.056946 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17


Steps executed: 293 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 208.43
I0901 13:03:38.039844 140540456830976 replay_runner.py:36] Average training steps per second: 208.43
I0901 13:03:38.209624 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.50
INFO:tensorflow:Starting iteration 18

Steps executed: 216 Episode length: 24 Return: 24.0.0
INFO:tensorflow:Average training steps per second: 207.33
I0901 13:03:43.218590 140540456830976 replay_runner.py:36] Average training steps per second: 207.33
I0901 13:03:43.338302 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 24.00
INFO:tensorflow:Starting iteration 19

Steps executed: 213 Episode length: 23 Return: 23.0.0
INFO:tensorflow:Average training steps per second: 219.40
I0901 13:03:48.069399 140540456830976 replay_runner.py:36] Average training steps per second: 219.40
I0901 13:03:48.190057 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 23.67
INFO:tensorflow:Starting iteration 20

Steps executed: 127 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 209.50

Steps executed: 258 Episode length: 131 Return: 131.0
I0901 13:03:53.291352 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 129.00
INFO:tensorflow:Starting iteration 21

Steps executed: 275 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 211.19
I0901 13:03:58.196105 140540456830976 replay_runner.py:36] Average training steps per second: 211.19
I0901 13:03:58.363073 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 22

Steps executed: 353 Episode length: 181 Return: 181.0
INFO:tensorflow:Average training steps per second: 220.64
I0901 13:04:03.076714 140540456830976 replay_runner.py:36] Average training steps per second: 220.64
I0901 13:04:03.262856 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.50
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 211.53
I0901 13:04:08.162255 140540456830976 replay_runner.py:36] Average training steps per second: 211.53
I0901 13:04:08.272430 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24

Steps executed: 341 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 218.01
I0901 13:04:13.031516 140540456830976 replay_runner.py:36] Average training steps per second: 218.01
I0901 13:04:13.230579 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.50
INFO:tensorflow:Starting iteration 25

Steps executed: 262 Episode length: 128 Return: 128.0
INFO:tensorflow:Average training steps per second: 211.08
I0901 13:04:18.149003 140540456830976 replay_runner.py:36] Average training steps per second: 211.08
I0901 13:04:18.289645 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 131.00
INFO:tensorflow:Starting iteration 26

Steps executed: 285 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 223.09
I0901 13:04:22.945462 140540456830976 replay_runner.py:36] Average training steps per second: 223.09
I0901 13:04:23.101502 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 27
I0901 13:04:23.275914 140540456830976 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 228.91

Steps executed: 289 Episode length: 137 Return: 137.0
I0901 13:04:27.800847 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 28

Steps executed: 389 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 219.24
I0901 13:04:32.533644 140540456830976 replay_runner.py:36] Average training steps per second: 219.24
I0901 13:04:32.725493 140540456830976 run_experiment.py:428] Average undiscounted return per evaluation episode: 194.50
INFO:tensorflow:Starting iteration 29

Steps executed: 325 Episode length: 163 Return: 163.0
INFO:tensorflow:Average training steps per second: 235.85
I0901 13:04:37.133754 140540456830976 replay_runner.py:36] Average training steps per second: 235.85

Done fixed training!Episode length: 163 Return: 163.0