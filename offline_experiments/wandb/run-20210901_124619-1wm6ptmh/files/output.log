Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0901 12:46:26.387704 140321497724928 run_experiment.py:549] Creating TrainRunner ...
I0901 12:46:26.397929 140321497724928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:46:26.398243 140321497724928 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:46:26.398431 140321497724928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:46:26.398571 140321497724928 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:46:26.398691 140321497724928 dqn_agent.py:275] 	 update_period: 4
I0901 12:46:26.398807 140321497724928 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:46:26.398919 140321497724928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:46:26.399206 140321497724928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:46:26.399457 140321497724928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:46:26.399722 140321497724928 dqn_agent.py:280] 	 optimizer: adam
I0901 12:46:26.399907 140321497724928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:46:26.400010 140321497724928 dqn_agent.py:283] 	 seed: 1630500386397862
I0901 12:46:26.403232 140321497724928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:46:26.403406 140321497724928 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:46:26.403548 140321497724928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:46:26.403637 140321497724928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:46:26.403713 140321497724928 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:46:26.403913 140321497724928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:46:26.403980 140321497724928 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:46:26.404033 140321497724928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:46:26.404092 140321497724928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:46:26.558796 140321497724928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:27.060573 140321497724928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:27.073860 140321497724928 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:46:27.083532 140321497724928 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:46:27.083803 140321497724928 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:46:27.083959 140321497724928 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:46:27.084090 140321497724928 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:46:27.084174 140321497724928 dqn_agent.py:275] 	 update_period: 4
I0901 12:46:27.084261 140321497724928 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:46:27.084360 140321497724928 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:46:27.084540 140321497724928 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:46:27.084669 140321497724928 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:46:27.085109 140321497724928 dqn_agent.py:280] 	 optimizer: adam
I0901 12:46:27.085303 140321497724928 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:46:27.085588 140321497724928 dqn_agent.py:283] 	 seed: 1630500387083477
I0901 12:46:27.088492 140321497724928 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:46:27.088631 140321497724928 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0901 12:46:27.088796 140321497724928 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:46:27.088964 140321497724928 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:46:27.089065 140321497724928 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:46:27.089142 140321497724928 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:46:27.089306 140321497724928 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:46:27.089499 140321497724928 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:46:27.089660 140321497724928 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:46:27.125355 140321497724928 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:46:27.148928 140321497724928 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:46:27.149168 140321497724928 replay_runner.py:41] Starting iteration 0
Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 143.09
I0901 12:46:34.138194 140321497724928 replay_runner.py:36] Average training steps per second: 143.09
I0901 12:46:35.322010 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.52
INFO:tensorflow:Starting iteration 1

Steps executed: 275 Episode length: 81 Return: 81.0.0
INFO:tensorflow:Average training steps per second: 194.38
I0901 12:46:40.670238 140321497724928 replay_runner.py:36] Average training steps per second: 194.38
I0901 12:46:40.873997 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 91.67
INFO:tensorflow:Starting iteration 2

Steps executed: 227 Episode length: 48 Return: 48.0.0
INFO:tensorflow:Average training steps per second: 191.07
I0901 12:46:46.290676 140321497724928 replay_runner.py:36] Average training steps per second: 191.07
I0901 12:46:46.459158 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 45.40
INFO:tensorflow:Starting iteration 3
I0901 12:46:46.658684 140321497724928 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 190.40

Steps executed: 385 Episode length: 200 Return: 200.0
I0901 12:46:52.199211 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 192.50
INFO:tensorflow:Starting iteration 4

Steps executed: 264 Episode length: 142 Return: 142.0
INFO:tensorflow:Average training steps per second: 194.66
I0901 12:46:57.523166 140321497724928 replay_runner.py:36] Average training steps per second: 194.66
I0901 12:46:57.705941 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 132.00
INFO:tensorflow:Starting iteration 5

Steps executed: 215 Episode length: 74 Return: 74.0.0
INFO:tensorflow:Average training steps per second: 193.19
I0901 12:47:03.071060 140321497724928 replay_runner.py:36] Average training steps per second: 193.19
I0901 12:47:03.235116 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 71.67
INFO:tensorflow:Starting iteration 6

Steps executed: 209 Episode length: 111 Return: 111.0
INFO:tensorflow:Average training steps per second: 191.14
I0901 12:47:08.663336 140321497724928 replay_runner.py:36] Average training steps per second: 191.14
I0901 12:47:08.812832 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 104.50
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.65
I0901 12:47:14.021449 140321497724928 replay_runner.py:36] Average training steps per second: 199.65
I0901 12:47:14.155365 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 393 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 192.16
I0901 12:47:19.550307 140321497724928 replay_runner.py:36] Average training steps per second: 192.16
I0901 12:47:19.838009 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 196.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 203.24
I0901 12:47:24.950354 140321497724928 replay_runner.py:36] Average training steps per second: 203.24
I0901 12:47:25.089161 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0901 12:47:25.276352 140321497724928 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 194.75

Steps executed: 333 Episode length: 179 Return: 179.0
I0901 12:47:30.630917 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 166.50
INFO:tensorflow:Starting iteration 11

Steps executed: 286 Episode length: 131 Return: 131.0
INFO:tensorflow:Average training steps per second: 200.91
I0901 12:47:35.795964 140321497724928 replay_runner.py:36] Average training steps per second: 200.91
I0901 12:47:35.984124 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 143.00
INFO:tensorflow:Starting iteration 12

Steps executed: 237 Episode length: 121 Return: 121.0
INFO:tensorflow:Average training steps per second: 196.20
I0901 12:47:41.260805 140321497724928 replay_runner.py:36] Average training steps per second: 196.20
I0901 12:47:41.404286 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 118.50
INFO:tensorflow:Starting iteration 13
I0901 12:47:41.585110 140321497724928 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 198.20

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 12:47:46.779822 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14
I0901 12:47:46.977779 140321497724928 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 194.94
I0901 12:47:52.107991 140321497724928 replay_runner.py:36] Average training steps per second: 194.94
I0901 12:47:52.300395 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 141.50
INFO:tensorflow:Starting iteration 15


Steps executed: 305 Episode length: 154 Return: 154.0
INFO:tensorflow:Average training steps per second: 194.52
I0901 12:47:57.629874 140321497724928 replay_runner.py:36] Average training steps per second: 194.52
I0901 12:47:57.844642 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 152.50
INFO:tensorflow:Starting iteration 16

Steps executed: 325 Episode length: 153 Return: 153.0
INFO:tensorflow:Average training steps per second: 195.46
I0901 12:48:03.140957 140321497724928 replay_runner.py:36] Average training steps per second: 195.46
I0901 12:48:03.365837 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 17

Steps executed: 390 Episode length: 194 Return: 194.0
INFO:tensorflow:Average training steps per second: 190.32
I0901 12:48:08.820256 140321497724928 replay_runner.py:36] Average training steps per second: 190.32
I0901 12:48:09.088791 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 195.00
INFO:tensorflow:Starting iteration 18
I0901 12:48:09.272408 140321497724928 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 194.41

Steps executed: 200 Episode length: 200 Return: 200.0
I0901 12:48:14.562515 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0901 12:48:14.757494 140321497724928 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 193.74
I0901 12:48:19.919416 140321497724928 replay_runner.py:36] Average training steps per second: 193.74
I0901 12:48:20.064698 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0901 12:48:20.258749 140321497724928 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 194.83
I0901 12:48:25.391732 140321497724928 replay_runner.py:36] Average training steps per second: 194.83
I0901 12:48:25.537778 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0901 12:48:25.719710 140321497724928 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 193.62
I0901 12:48:30.884844 140321497724928 replay_runner.py:36] Average training steps per second: 193.62
I0901 12:48:31.014188 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22

Steps executed: 191 Episode length: 191 Return: 191.0
INFO:tensorflow:Average training steps per second: 194.67
I0901 12:48:36.346494 140321497724928 replay_runner.py:36] Average training steps per second: 194.67

Steps executed: 391 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.39
I0901 12:48:41.944340 140321497724928 replay_runner.py:36] Average training steps per second: 195.39
I0901 12:48:42.078819 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0901 12:48:42.263886 140321497724928 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 190.50
I0901 12:48:47.513495 140321497724928 replay_runner.py:36] Average training steps per second: 190.50
I0901 12:48:47.650461 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0901 12:48:47.844390 140321497724928 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 200.13

Steps executed: 324 Episode length: 158 Return: 158.0
I0901 12:48:53.072295 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.25
I0901 12:48:58.412612 140321497724928 replay_runner.py:36] Average training steps per second: 194.25
I0901 12:48:58.553306 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 256 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 195.78
I0901 12:49:03.839485 140321497724928 replay_runner.py:36] Average training steps per second: 195.78
I0901 12:49:04.012310 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.00
INFO:tensorflow:Starting iteration 28

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 197.28
I0901 12:49:09.274316 140321497724928 replay_runner.py:36] Average training steps per second: 197.28
I0901 12:49:09.405584 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.10
I0901 12:49:14.850594 140321497724928 replay_runner.py:36] Average training steps per second: 190.10
I0901 12:49:14.988877 140321497724928 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00