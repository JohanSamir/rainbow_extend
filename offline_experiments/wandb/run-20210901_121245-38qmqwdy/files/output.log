Loaded trained dqn in acrobot
Training fixed agent 9, please be patient, may be a while...
I0901 12:12:51.861817 140320049072128 run_experiment.py:549] Creating TrainRunner ...
I0901 12:12:51.872056 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:51.872317 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:51.872459 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:51.872572 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:51.872687 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:51.872926 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:51.873184 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:51.873473 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:51.873685 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:51.873853 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:51.873988 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:51.874104 140320049072128 dqn_agent.py:283] 	 seed: 1630498371871994
I0901 12:12:51.877693 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:51.877955 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:12:51.878378 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:51.878940 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:51.879153 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:51.879329 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:51.879473 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:51.879796 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:51.879933 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:51.946087 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:52.479578 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:52.496298 140320049072128 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:12:52.505857 140320049072128 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:12:52.506152 140320049072128 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:12:52.506345 140320049072128 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:12:52.506626 140320049072128 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:12:52.506787 140320049072128 dqn_agent.py:275] 	 update_period: 4
I0901 12:12:52.506970 140320049072128 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:12:52.507131 140320049072128 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:12:52.507281 140320049072128 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:12:52.507394 140320049072128 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:12:52.507521 140320049072128 dqn_agent.py:280] 	 optimizer: adam
I0901 12:12:52.507626 140320049072128 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:12:52.507728 140320049072128 dqn_agent.py:283] 	 seed: 1630498372505794
I0901 12:12:52.510374 140320049072128 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:12:52.510509 140320049072128 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:12:52.510589 140320049072128 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:12:52.510655 140320049072128 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:12:52.510713 140320049072128 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:12:52.510792 140320049072128 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:12:52.510853 140320049072128 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:12:52.510910 140320049072128 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:12:52.510978 140320049072128 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:12:52.545528 140320049072128 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:12:52.569224 140320049072128 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:12:52.569596 140320049072128 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.19
I0901 12:12:59.318430 140320049072128 replay_runner.py:36] Average training steps per second: 148.19
Steps executed: 315 Episode length: 146 Return: -145.0
I0901 12:13:00.645684 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -156.50
INFO:tensorflow:Starting iteration 1

Steps executed: 276 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 196.11
I0901 12:13:05.993090 140320049072128 replay_runner.py:36] Average training steps per second: 196.11
I0901 12:13:06.215069 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.00
INFO:tensorflow:Starting iteration 2
I0901 12:13:06.449716 140320049072128 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 192.06

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:13:12.071471 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 159 Episode length: 159 Return: -158.0
INFO:tensorflow:Average training steps per second: 200.27

Steps executed: 659 Episode length: 500 Return: -500.0
I0901 12:13:17.875779 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -329.00
INFO:tensorflow:Starting iteration 4

Steps executed: 215 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 189.88
I0901 12:13:23.378304 140320049072128 replay_runner.py:36] Average training steps per second: 189.88
I0901 12:13:23.540816 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 5

Steps executed: 292 Episode length: 155 Return: -154.0
INFO:tensorflow:Average training steps per second: 196.15
I0901 12:13:28.879199 140320049072128 replay_runner.py:36] Average training steps per second: 196.15
I0901 12:13:29.128115 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.00
INFO:tensorflow:Starting iteration 6

Steps executed: 239 Episode length: 239 Return: -238.0
INFO:tensorflow:Average training steps per second: 201.55
I0901 12:13:34.329092 140320049072128 replay_runner.py:36] Average training steps per second: 201.55
I0901 12:13:34.534026 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.00
INFO:tensorflow:Starting iteration 7

Steps executed: 212 Episode length: 111 Return: -110.0
INFO:tensorflow:Average training steps per second: 192.39
I0901 12:13:39.976953 140320049072128 replay_runner.py:36] Average training steps per second: 192.39
I0901 12:13:40.148328 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.00
INFO:tensorflow:Starting iteration 8

Steps executed: 221 Episode length: 221 Return: -220.0
INFO:tensorflow:Average training steps per second: 190.99
I0901 12:13:45.626240 140320049072128 replay_runner.py:36] Average training steps per second: 190.99
I0901 12:13:45.826174 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.57
I0901 12:13:51.136029 140320049072128 replay_runner.py:36] Average training steps per second: 197.57
I0901 12:13:51.561476 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0901 12:13:51.803006 140320049072128 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 197.16
I0901 12:13:56.875485 140320049072128 replay_runner.py:36] Average training steps per second: 197.16
I0901 12:13:57.279222 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11
I0901 12:13:57.522828 140320049072128 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 202.93
I0901 12:14:02.451123 140320049072128 replay_runner.py:36] Average training steps per second: 202.93
I0901 12:14:02.872554 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 246 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 189.97
I0901 12:14:08.387127 140320049072128 replay_runner.py:36] Average training steps per second: 189.97
I0901 12:14:08.582646 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 13

Steps executed: 249 Episode length: 86 Return: -85.0.0
INFO:tensorflow:Average training steps per second: 190.71
I0901 12:14:14.059058 140320049072128 replay_runner.py:36] Average training steps per second: 190.71
I0901 12:14:14.274736 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 14

Steps executed: 239 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 204.20
I0901 12:14:19.414133 140320049072128 replay_runner.py:36] Average training steps per second: 204.20
I0901 12:14:19.600651 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.67
INFO:tensorflow:Starting iteration 15

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 216.68
I0901 12:14:24.454907 140320049072128 replay_runner.py:36] Average training steps per second: 216.68
I0901 12:14:24.843736 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 257 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 199.02
I0901 12:14:30.101043 140320049072128 replay_runner.py:36] Average training steps per second: 199.02
I0901 12:14:30.297195 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67
INFO:tensorflow:Starting iteration 17
I0901 12:14:30.550699 140320049072128 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 201.72
I0901 12:14:35.508589 140320049072128 replay_runner.py:36] Average training steps per second: 201.72

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 18

Steps executed: 222 Episode length: 88 Return: -87.0.0
INFO:tensorflow:Average training steps per second: 194.10
I0901 12:14:41.329766 140320049072128 replay_runner.py:36] Average training steps per second: 194.10
I0901 12:14:41.523370 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 19

Steps executed: 232 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 196.35
I0901 12:14:46.857442 140320049072128 replay_runner.py:36] Average training steps per second: 196.35
I0901 12:14:47.062418 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.33
INFO:tensorflow:Starting iteration 20

Steps executed: 279 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 197.74
I0901 12:14:52.370025 140320049072128 replay_runner.py:36] Average training steps per second: 197.74
I0901 12:14:52.593110 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 21
I0901 12:14:52.828205 140320049072128 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 190.61

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:14:58.500261 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0901 12:14:58.734811 140320049072128 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 208.28
I0901 12:15:03.536374 140320049072128 replay_runner.py:36] Average training steps per second: 208.28
I0901 12:15:03.963802 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 122 Return: -121.0
INFO:tensorflow:Average training steps per second: 194.90
I0901 12:15:09.341023 140320049072128 replay_runner.py:36] Average training steps per second: 194.90
I0901 12:15:09.504414 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 24

Steps executed: 272 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 201.21
I0901 12:15:14.713413 140320049072128 replay_runner.py:36] Average training steps per second: 201.21
I0901 12:15:14.935235 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 190.74
I0901 12:15:20.423249 140320049072128 replay_runner.py:36] Average training steps per second: 190.74
I0901 12:15:20.808113 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 12:15:21.045726 140320049072128 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.74
I0901 12:15:26.103297 140320049072128 replay_runner.py:36] Average training steps per second: 197.74
I0901 12:15:26.506408 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0901 12:15:26.749049 140320049072128 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 196.33
I0901 12:15:31.842901 140320049072128 replay_runner.py:36] Average training steps per second: 196.33
I0901 12:15:32.235963 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 250 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 222.64
I0901 12:15:36.960289 140320049072128 replay_runner.py:36] Average training steps per second: 222.64
I0901 12:15:37.120036 140320049072128 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 29
I0901 12:15:37.336207 140320049072128 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 204.65
I0901 12:15:42.223144 140320049072128 replay_runner.py:36] Average training steps per second: 204.65

Done fixed training!Episode length: 120 Return: -119.0