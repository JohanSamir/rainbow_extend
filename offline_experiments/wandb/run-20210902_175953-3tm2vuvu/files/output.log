Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0902 18:00:00.635118 140123653724160 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:00.644679 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:00.645000 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:00.645309 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:00.645669 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:00.645818 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:00.645914 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:00:00.645991 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:00.646071 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:00.646148 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:00.646224 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:00.646303 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:00.646423 140123653724160 dqn_agent.py:283] 	 seed: 1630605600644616
I0902 18:00:00.648943 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:00.649116 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:00:00.649273 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:00.649363 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:00.649506 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:00.649654 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:00.649729 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:00.649815 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:00.649884 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:00.682027 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:01.094316 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:01.105842 140123653724160 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:01.114766 140123653724160 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:01.115634 140123653724160 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:01.115799 140123653724160 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:01.115889 140123653724160 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:01.115964 140123653724160 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:01.116037 140123653724160 dqn_agent.py:276] 	 target_update_period: 100
I0902 18:00:01.116112 140123653724160 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:01.116247 140123653724160 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:01.116452 140123653724160 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:01.137436 140123653724160 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:01.137635 140123653724160 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:01.146239 140123653724160 dqn_agent.py:283] 	 seed: 1630605601114713
I0902 18:00:01.149725 140123653724160 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:01.150009 140123653724160 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 18:00:01.150141 140123653724160 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:01.150275 140123653724160 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:01.150399 140123653724160 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:01.150530 140123653724160 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:01.150640 140123653724160 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:01.150804 140123653724160 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:01.150899 140123653724160 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:01.182494 140123653724160 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:00:01.205650 140123653724160 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:01.206038 140123653724160 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 144.03
I0902 18:00:08.149878 140123653724160 replay_runner.py:36] Average training steps per second: 144.03
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 18:00:09.769691 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 234 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 202.12
I0902 18:00:14.951133 140123653724160 replay_runner.py:36] Average training steps per second: 202.12
I0902 18:00:15.130350 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 2

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 195.00
I0902 18:00:20.490248 140123653724160 replay_runner.py:36] Average training steps per second: 195.00
I0902 18:00:20.873676 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 235 Episode length: 235 Return: -234.0
INFO:tensorflow:Average training steps per second: 202.09
I0902 18:00:26.069307 140123653724160 replay_runner.py:36] Average training steps per second: 202.09
I0902 18:00:26.259395 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.00
INFO:tensorflow:Starting iteration 4

Steps executed: 698 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.04
I0902 18:00:31.427714 140123653724160 replay_runner.py:36] Average training steps per second: 203.04
I0902 18:00:31.957519 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.50
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.16
I0902 18:00:37.184806 140123653724160 replay_runner.py:36] Average training steps per second: 200.16
I0902 18:00:37.619356 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 217 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 202.07
I0902 18:00:42.828292 140123653724160 replay_runner.py:36] Average training steps per second: 202.07
I0902 18:00:43.009922 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -107.50
INFO:tensorflow:Starting iteration 7

Steps executed: 125 Episode length: 125 Return: -124.0
INFO:tensorflow:Average training steps per second: 192.89

Steps executed: 246 Episode length: 121 Return: -120.0
I0902 18:00:48.644781 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -122.00
INFO:tensorflow:Starting iteration 8

Steps executed: 258 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Average training steps per second: 201.20
I0902 18:00:53.841418 140123653724160 replay_runner.py:36] Average training steps per second: 201.20
I0902 18:00:54.057876 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.00
INFO:tensorflow:Starting iteration 9

Steps executed: 260 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 189.56
I0902 18:00:59.588281 140123653724160 replay_runner.py:36] Average training steps per second: 189.56
I0902 18:00:59.805479 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 10

Steps executed: 211 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 192.85
I0902 18:01:05.208454 140123653724160 replay_runner.py:36] Average training steps per second: 192.85
I0902 18:01:05.395104 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.33
INFO:tensorflow:Starting iteration 11
I0902 18:01:05.649879 140123653724160 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 196.16

Steps executed: 293 Episode length: 95 Return: -94.0.0
I0902 18:01:11.021809 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 12

Steps executed: 249 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 192.79
I0902 18:01:16.541617 140123653724160 replay_runner.py:36] Average training steps per second: 192.79
I0902 18:01:16.757350 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.00
INFO:tensorflow:Starting iteration 13

Steps executed: 224 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 203.50
I0902 18:01:21.919420 140123653724160 replay_runner.py:36] Average training steps per second: 203.50
I0902 18:01:22.121768 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.67
INFO:tensorflow:Starting iteration 14

Steps executed: 209 Episode length: 132 Return: -131.0
INFO:tensorflow:Average training steps per second: 191.53
I0902 18:01:27.595562 140123653724160 replay_runner.py:36] Average training steps per second: 191.53
I0902 18:01:27.763274 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 15

Steps executed: 234 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 195.91
I0902 18:01:33.110160 140123653724160 replay_runner.py:36] Average training steps per second: 195.91
I0902 18:01:33.322034 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.00
INFO:tensorflow:Starting iteration 16
I0902 18:01:33.571353 140123653724160 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 194.19
I0902 18:01:38.721447 140123653724160 replay_runner.py:36] Average training steps per second: 194.19

Steps executed: 291 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Starting iteration 17
I0902 18:01:39.254407 140123653724160 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 189.29
I0902 18:01:44.537843 140123653724160 replay_runner.py:36] Average training steps per second: 189.29

Steps executed: 290 Episode length: 116 Return: -115.0
INFO:tensorflow:Starting iteration 18

Steps executed: 230 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 200.72
I0902 18:01:50.025330 140123653724160 replay_runner.py:36] Average training steps per second: 200.72
I0902 18:01:50.226659 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.67
INFO:tensorflow:Starting iteration 19

Steps executed: 236 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 192.31
I0902 18:01:55.676198 140123653724160 replay_runner.py:36] Average training steps per second: 192.31
I0902 18:01:55.866368 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.67
INFO:tensorflow:Starting iteration 20

Steps executed: 212 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 205.65
I0902 18:02:00.974228 140123653724160 replay_runner.py:36] Average training steps per second: 205.65
I0902 18:02:01.148863 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.67
INFO:tensorflow:Starting iteration 21

Steps executed: 238 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 210.35
I0902 18:02:06.143042 140123653724160 replay_runner.py:36] Average training steps per second: 210.35
I0902 18:02:06.322798 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 22

Steps executed: 272 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 193.92
I0902 18:02:11.701957 140123653724160 replay_runner.py:36] Average training steps per second: 193.92
I0902 18:02:11.930961 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.67
INFO:tensorflow:Starting iteration 23

Steps executed: 238 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 210.64
I0902 18:02:16.923892 140123653724160 replay_runner.py:36] Average training steps per second: 210.64
I0902 18:02:17.120104 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.33
INFO:tensorflow:Starting iteration 24

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 198.19
I0902 18:02:22.411496 140123653724160 replay_runner.py:36] Average training steps per second: 198.19
I0902 18:02:22.841279 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 25

Steps executed: 206 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 205.14
I0902 18:02:27.959410 140123653724160 replay_runner.py:36] Average training steps per second: 205.14
I0902 18:02:28.139928 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 26

Steps executed: 246 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 199.45
I0902 18:02:33.381667 140123653724160 replay_runner.py:36] Average training steps per second: 199.45
I0902 18:02:33.575767 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 27

Steps executed: 292 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 188.99
I0902 18:02:39.104443 140123653724160 replay_runner.py:36] Average training steps per second: 188.99
I0902 18:02:39.342394 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.33
INFO:tensorflow:Starting iteration 28

Steps executed: 274 Episode length: 94 Return: -93.000
INFO:tensorflow:Average training steps per second: 204.19
I0902 18:02:44.484757 140123653724160 replay_runner.py:36] Average training steps per second: 204.19
I0902 18:02:44.733343 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 458 Return: -457.0
INFO:tensorflow:Average training steps per second: 197.52
I0902 18:02:50.043749 140123653724160 replay_runner.py:36] Average training steps per second: 197.52
I0902 18:02:50.507452 140123653724160 run_experiment.py:428] Average undiscounted return per evaluation episode: -208.33