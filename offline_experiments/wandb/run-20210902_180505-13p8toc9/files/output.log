Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 18:05:11.605545 140016423897088 run_experiment.py:549] Creating TrainRunner ...
I0902 18:05:11.616340 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:11.616541 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:11.616627 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:11.616716 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:11.616789 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:11.616861 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:11.616947 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:11.617064 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:11.617142 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:11.617213 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:11.617296 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:11.617368 140016423897088 dqn_agent.py:283] 	 seed: 1630605911616273
I0902 18:05:11.619188 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:11.619323 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:11.619411 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:11.619494 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:11.619605 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:11.619669 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:11.620005 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:11.620120 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:11.620236 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:11.655082 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:11.986248 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:11.999170 140016423897088 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:05:12.006810 140016423897088 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:05:12.007034 140016423897088 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:05:12.007172 140016423897088 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:05:12.007355 140016423897088 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:05:12.007454 140016423897088 dqn_agent.py:275] 	 update_period: 4
I0902 18:05:12.007630 140016423897088 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:05:12.007726 140016423897088 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:05:12.007831 140016423897088 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:05:12.007974 140016423897088 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:05:12.008110 140016423897088 dqn_agent.py:280] 	 optimizer: adam
I0902 18:05:12.008222 140016423897088 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:05:12.008346 140016423897088 dqn_agent.py:283] 	 seed: 1630605912006754
I0902 18:05:12.011242 140016423897088 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:05:12.011505 140016423897088 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:05:12.011663 140016423897088 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:05:12.011767 140016423897088 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:05:12.011916 140016423897088 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:05:12.012068 140016423897088 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:05:12.012201 140016423897088 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:05:12.012340 140016423897088 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:05:12.012557 140016423897088 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:05:12.038286 140016423897088 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.312500
I0902 18:05:12.057871 140016423897088 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:05:12.058177 140016423897088 replay_runner.py:41] Starting iteration 0
Steps executed: 190 Episode length: 107 Return: -660.1728697898894
INFO:tensorflow:Average training steps per second: 168.04
I0902 18:05:18.009534 140016423897088 replay_runner.py:36] Average training steps per second: 168.04

Steps executed: 272 Episode length: 82 Return: -555.47263909360484
INFO:tensorflow:Starting iteration 1

Steps executed: 252 Episode length: 81 Return: -161.73224956650765
INFO:tensorflow:Average training steps per second: 225.14
I0902 18:05:27.760261 140016423897088 replay_runner.py:36] Average training steps per second: 225.14
I0902 18:05:27.972475 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -508.21
INFO:tensorflow:Starting iteration 2

Steps executed: 225 Episode length: 117 Return: -60.778173018022136
INFO:tensorflow:Average training steps per second: 223.89
I0902 18:05:36.627579 140016423897088 replay_runner.py:36] Average training steps per second: 223.89
I0902 18:05:36.817276 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.75
INFO:tensorflow:Starting iteration 3
I0902 18:05:40.876925 140016423897088 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 228.23

Steps executed: 464 Episode length: 293 Return: -209.11996388025346
I0902 18:05:45.750932 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.31
INFO:tensorflow:Starting iteration 4

Steps executed: 283 Episode length: 108 Return: -506.27567261982325
INFO:tensorflow:Average training steps per second: 231.27
I0902 18:05:54.298510 140016423897088 replay_runner.py:36] Average training steps per second: 231.27
I0902 18:05:54.564927 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.15
INFO:tensorflow:Starting iteration 5

Steps executed: 214 Episode length: 91 Return: -277.320051294719645
INFO:tensorflow:Average training steps per second: 232.82
I0902 18:06:03.180608 140016423897088 replay_runner.py:36] Average training steps per second: 232.82
I0902 18:06:03.359478 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.29
INFO:tensorflow:Starting iteration 6

Steps executed: 213 Episode length: 112 Return: -271.72091674187145
INFO:tensorflow:Average training steps per second: 228.90
I0902 18:06:11.981999 140016423897088 replay_runner.py:36] Average training steps per second: 228.90
I0902 18:06:12.164781 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.37
INFO:tensorflow:Starting iteration 7

Steps executed: 239 Episode length: 108 Return: -254.86299641459375
INFO:tensorflow:Average training steps per second: 230.64
I0902 18:06:20.898594 140016423897088 replay_runner.py:36] Average training steps per second: 230.64
I0902 18:06:21.114675 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.11
INFO:tensorflow:Starting iteration 8

Steps executed: 208 Episode length: 208 Return: -24.108307755723416
INFO:tensorflow:Average training steps per second: 229.57
I0902 18:06:29.785588 140016423897088 replay_runner.py:36] Average training steps per second: 229.57
I0902 18:06:30.038410 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.11
INFO:tensorflow:Starting iteration 9

Steps executed: 232 Episode length: 232 Return: -278.53881216088216
INFO:tensorflow:Average training steps per second: 228.39
I0902 18:06:38.861117 140016423897088 replay_runner.py:36] Average training steps per second: 228.39
I0902 18:06:39.108449 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -278.54
INFO:tensorflow:Starting iteration 10

Steps executed: 313 Episode length: 143 Return: -463.30910788389547
INFO:tensorflow:Average training steps per second: 223.86
I0902 18:06:47.928397 140016423897088 replay_runner.py:36] Average training steps per second: 223.86
I0902 18:06:48.224095 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.19
INFO:tensorflow:Starting iteration 11

Steps executed: 361 Episode length: 186 Return: -182.28911827810435
INFO:tensorflow:Average training steps per second: 225.03
I0902 18:06:57.185038 140016423897088 replay_runner.py:36] Average training steps per second: 225.03
I0902 18:06:57.539286 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -294.44
INFO:tensorflow:Starting iteration 12

Steps executed: 271 Episode length: 156 Return: -263.90886898357155
INFO:tensorflow:Average training steps per second: 226.99
I0902 18:07:06.379897 140016423897088 replay_runner.py:36] Average training steps per second: 226.99
I0902 18:07:06.623374 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.26
INFO:tensorflow:Starting iteration 13

Steps executed: 209 Episode length: 84 Return: -681.231550283266173
INFO:tensorflow:Average training steps per second: 225.61
I0902 18:07:15.318238 140016423897088 replay_runner.py:36] Average training steps per second: 225.61
I0902 18:07:15.501830 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -512.07
INFO:tensorflow:Starting iteration 14

Steps executed: 242 Episode length: 129 Return: -393.60958708336843
INFO:tensorflow:Average training steps per second: 222.12
I0902 18:07:24.286343 140016423897088 replay_runner.py:36] Average training steps per second: 222.12
I0902 18:07:24.507367 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -334.74
INFO:tensorflow:Starting iteration 15

Steps executed: 309 Episode length: 174 Return: -326.02709688363293
INFO:tensorflow:Average training steps per second: 229.31
I0902 18:07:33.282383 140016423897088 replay_runner.py:36] Average training steps per second: 229.31
I0902 18:07:33.555253 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -364.84
INFO:tensorflow:Starting iteration 16
I0902 18:07:37.622508 140016423897088 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 232.82

Steps executed: 295 Episode length: 136 Return: -211.05899377393712
I0902 18:07:42.195142 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.10
INFO:tensorflow:Starting iteration 17

Steps executed: 402 Episode length: 207 Return: -231.17952854432562
INFO:tensorflow:Average training steps per second: 227.77
I0902 18:07:50.880013 140016423897088 replay_runner.py:36] Average training steps per second: 227.77
I0902 18:07:51.268759 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.01
INFO:tensorflow:Starting iteration 18
I0902 18:07:55.501718 140016423897088 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 238.62
I0902 18:07:59.692947 140016423897088 replay_runner.py:36] Average training steps per second: 238.62

Steps executed: 223 Episode length: 139 Return: -361.02598078557642
INFO:tensorflow:Starting iteration 19

Steps executed: 295 Episode length: 131 Return: -103.28610372016463
INFO:tensorflow:Average training steps per second: 235.76
I0902 18:08:08.447296 140016423897088 replay_runner.py:36] Average training steps per second: 235.76
I0902 18:08:08.693167 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -177.99
INFO:tensorflow:Starting iteration 20

Steps executed: 233 Episode length: 124 Return: -330.50785054392895
INFO:tensorflow:Average training steps per second: 232.39
I0902 18:08:17.339113 140016423897088 replay_runner.py:36] Average training steps per second: 232.39
I0902 18:08:17.541702 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.80
INFO:tensorflow:Starting iteration 21

Steps executed: 304 Episode length: 172 Return: -207.99461067711616
INFO:tensorflow:Average training steps per second: 227.51
I0902 18:08:26.190148 140016423897088 replay_runner.py:36] Average training steps per second: 227.51
I0902 18:08:26.473682 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.28
INFO:tensorflow:Starting iteration 22

Steps executed: 293 Episode length: 163 Return: -111.62789309737497
INFO:tensorflow:Average training steps per second: 226.46
I0902 18:08:35.238478 140016423897088 replay_runner.py:36] Average training steps per second: 226.46
I0902 18:08:35.504447 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.26
INFO:tensorflow:Starting iteration 23

Steps executed: 345 Episode length: 184 Return: -218.11165937930758
INFO:tensorflow:Average training steps per second: 227.46
I0902 18:08:44.130295 140016423897088 replay_runner.py:36] Average training steps per second: 227.46
I0902 18:08:44.459114 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.99
INFO:tensorflow:Starting iteration 24

Steps executed: 203 Episode length: 88 Return: -501.097811031114678
INFO:tensorflow:Average training steps per second: 231.37
I0902 18:08:53.077517 140016423897088 replay_runner.py:36] Average training steps per second: 231.37
I0902 18:08:53.240435 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.52
INFO:tensorflow:Starting iteration 25

Steps executed: 148 Episode length: 148 Return: -247.76824041455743
INFO:tensorflow:Average training steps per second: 238.68

Steps executed: 378 Episode length: 230 Return: -41.418258871130723
I0902 18:09:02.038978 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.59
INFO:tensorflow:Starting iteration 26

Steps executed: 325 Episode length: 133 Return: -265.03846799596013
INFO:tensorflow:Average training steps per second: 234.56
I0902 18:09:10.534367 140016423897088 replay_runner.py:36] Average training steps per second: 234.56
I0902 18:09:10.781301 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -415.57
INFO:tensorflow:Starting iteration 27

Steps executed: 237 Episode length: 75 Return: -451.851711123945853
INFO:tensorflow:Average training steps per second: 228.56
I0902 18:09:19.499082 140016423897088 replay_runner.py:36] Average training steps per second: 228.56
I0902 18:09:19.691745 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -397.45
INFO:tensorflow:Starting iteration 28

Steps executed: 348 Episode length: 150 Return: -259.68227936851343
INFO:tensorflow:Average training steps per second: 232.28
I0902 18:09:28.330001 140016423897088 replay_runner.py:36] Average training steps per second: 232.28
I0902 18:09:28.626427 140016423897088 run_experiment.py:428] Average undiscounted return per evaluation episode: -302.74
INFO:tensorflow:Starting iteration 29

Steps executed: 214 Episode length: 131 Return: -197.36800401928113
INFO:tensorflow:Average training steps per second: 225.22
I0902 18:09:37.540459 140016423897088 replay_runner.py:36] Average training steps per second: 225.22

Done fixed training!Episode length: 131 Return: -197.36800401928113