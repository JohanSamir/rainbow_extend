Loaded trained dqn in mountaincar
Training fixed agent 2, please be patient, may be a while...
Steps executed: 236 Episode length: 116 Return: -116.0
I0910 11:19:54.913628 140666432555008 run_experiment.py:549] Creating TrainRunner ...
I0910 11:19:54.923438 140666432555008 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:54.923674 140666432555008 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:54.923829 140666432555008 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:54.923952 140666432555008 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:54.924062 140666432555008 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:54.924177 140666432555008 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:54.924354 140666432555008 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:54.924463 140666432555008 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:54.924558 140666432555008 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:54.924654 140666432555008 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:54.924715 140666432555008 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:54.924769 140666432555008 dqn_agent.py:283] 	 seed: 1631272794923379
I0910 11:19:54.927121 140666432555008 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:54.927282 140666432555008 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:54.927420 140666432555008 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:54.927514 140666432555008 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:54.927575 140666432555008 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:54.927629 140666432555008 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:54.927682 140666432555008 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:54.927733 140666432555008 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:54.927784 140666432555008 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:54.957168 140666432555008 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:54.977574 140666432555008 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:19:54.977743 140666432555008 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:19:54.977810 140666432555008 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:19:54.977874 140666432555008 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:19:54.977970 140666432555008 dqn_agent.py:275] 	 update_period: 4
I0910 11:19:54.978027 140666432555008 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:19:54.978091 140666432555008 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:19:54.978265 140666432555008 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:19:54.978331 140666432555008 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:19:54.978390 140666432555008 dqn_agent.py:280] 	 optimizer: adam
I0910 11:19:54.978471 140666432555008 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:19:54.978562 140666432555008 dqn_agent.py:283] 	 seed: 1631272794977528
I0910 11:19:54.980115 140666432555008 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:19:54.980239 140666432555008 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:19:54.980324 140666432555008 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:19:54.980424 140666432555008 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:19:54.980493 140666432555008 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:19:54.980548 140666432555008 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:19:54.980616 140666432555008 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:19:54.980710 140666432555008 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:19:54.980772 140666432555008 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:19:55.004508 140666432555008 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:19:55.019935 140666432555008 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:19:55.020132 140666432555008 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 838525.39
I0910 11:19:55.021461 140666432555008 replay_runner.py:39] Average training steps per second: 838525.39
I0910 11:19:55.701758 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 1
I0910 11:19:55.775517 140666432555008 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 783835.54
I0910 11:19:55.777321 140666432555008 replay_runner.py:39] Average training steps per second: 783835.54
I0910 11:19:55.848917 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 2
I0910 11:19:55.926555 140666432555008 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 842906.75
I0910 11:19:55.928150 140666432555008 replay_runner.py:39] Average training steps per second: 842906.75
I0910 11:19:56.000720 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 3
I0910 11:19:56.068970 140666432555008 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 820642.54
I0910 11:19:56.070418 140666432555008 replay_runner.py:39] Average training steps per second: 820642.54
I0910 11:19:56.139568 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.00
INFO:tensorflow:Starting iteration 4
I0910 11:19:56.222620 140666432555008 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 578604.50
I0910 11:19:56.224647 140666432555008 replay_runner.py:39] Average training steps per second: 578604.50
I0910 11:19:56.305411 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 5
I0910 11:19:56.378912 140666432555008 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 825000.79

Steps executed: 232 Episode length: 115 Return: -115.0
I0910 11:19:56.469955 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 6
I0910 11:19:56.537331 140666432555008 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 829077.68
I0910 11:19:56.538802 140666432555008 replay_runner.py:39] Average training steps per second: 829077.68
I0910 11:19:56.621889 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 7
I0910 11:19:56.689554 140666432555008 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 828586.33
I0910 11:19:56.691015 140666432555008 replay_runner.py:39] Average training steps per second: 828586.33
I0910 11:19:56.767610 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 8
I0910 11:19:56.835154 140666432555008 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 807839.75
I0910 11:19:56.836636 140666432555008 replay_runner.py:39] Average training steps per second: 807839.75
I0910 11:19:56.940479 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 9
I0910 11:19:57.008560 140666432555008 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 825650.39
I0910 11:19:57.010027 140666432555008 replay_runner.py:39] Average training steps per second: 825650.39
I0910 11:19:57.196933 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:19:57.279648 140666432555008 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 816330.09
I0910 11:19:57.281130 140666432555008 replay_runner.py:39] Average training steps per second: 816330.09
I0910 11:19:57.360117 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.50
INFO:tensorflow:Starting iteration 11
I0910 11:19:57.432487 140666432555008 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 813007.17
I0910 11:19:57.434000 140666432555008 replay_runner.py:39] Average training steps per second: 813007.17
I0910 11:19:57.515967 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 12
I0910 11:19:57.584937 140666432555008 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 819840.50
I0910 11:19:57.586440 140666432555008 replay_runner.py:39] Average training steps per second: 819840.50
I0910 11:19:57.663469 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.50
INFO:tensorflow:Starting iteration 13
I0910 11:19:57.731799 140666432555008 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 794978.01
I0910 11:19:57.733346 140666432555008 replay_runner.py:39] Average training steps per second: 794978.01
I0910 11:19:57.816245 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 14
I0910 11:19:57.885103 140666432555008 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 675846.60
I0910 11:19:57.886865 140666432555008 replay_runner.py:39] Average training steps per second: 675846.60
I0910 11:19:57.974030 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 15
I0910 11:19:58.044609 140666432555008 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 812849.61
I0910 11:19:58.046121 140666432555008 replay_runner.py:39] Average training steps per second: 812849.61
I0910 11:19:58.122876 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 16
I0910 11:19:58.443846 140666432555008 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 763433.56

Steps executed: 115 Episode length: 115 Return: -115.0
I0910 11:19:58.535878 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00
INFO:tensorflow:Starting iteration 17
I0910 11:19:58.618922 140666432555008 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 267493.88
I0910 11:19:58.623011 140666432555008 replay_runner.py:39] Average training steps per second: 267493.88
I0910 11:19:58.695147 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 18
I0910 11:19:58.767360 140666432555008 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 815061.02
I0910 11:19:58.768829 140666432555008 replay_runner.py:39] Average training steps per second: 815061.02
I0910 11:19:58.991549 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:19:59.059530 140666432555008 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 822896.61
I0910 11:19:59.061009 140666432555008 replay_runner.py:39] Average training steps per second: 822896.61
I0910 11:19:59.140363 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 20
I0910 11:19:59.228654 140666432555008 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 762739.41
I0910 11:19:59.230240 140666432555008 replay_runner.py:39] Average training steps per second: 762739.41
I0910 11:19:59.302732 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.00
INFO:tensorflow:Starting iteration 21
I0910 11:19:59.372002 140666432555008 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 739866.64
I0910 11:19:59.373627 140666432555008 replay_runner.py:39] Average training steps per second: 739866.64
I0910 11:19:59.578700 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:19:59.647316 140666432555008 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 824190.21
I0910 11:19:59.648778 140666432555008 replay_runner.py:39] Average training steps per second: 824190.21
I0910 11:19:59.728089 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 23
I0910 11:19:59.795907 140666432555008 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 801510.41
I0910 11:19:59.797387 140666432555008 replay_runner.py:39] Average training steps per second: 801510.41
I0910 11:19:59.877475 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.50
INFO:tensorflow:Starting iteration 24
I0910 11:19:59.950152 140666432555008 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 834189.34
I0910 11:19:59.951626 140666432555008 replay_runner.py:39] Average training steps per second: 834189.34
I0910 11:20:00.040698 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.00
INFO:tensorflow:Starting iteration 25
I0910 11:20:00.110542 140666432555008 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 822896.61
I0910 11:20:00.111990 140666432555008 replay_runner.py:39] Average training steps per second: 822896.61
I0910 11:20:00.193442 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 26
I0910 11:20:00.268802 140666432555008 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 425731.22

Done fixed training!Episode length: 116 Return: -116.0
I0910 11:20:00.542172 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.50
INFO:tensorflow:Starting iteration 27
I0910 11:20:00.610824 140666432555008 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 832864.18
I0910 11:20:00.612281 140666432555008 replay_runner.py:39] Average training steps per second: 832864.18
I0910 11:20:00.689460 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 28
I0910 11:20:00.757770 140666432555008 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 825000.79
I0910 11:20:00.759232 140666432555008 replay_runner.py:39] Average training steps per second: 825000.79
I0910 11:20:00.827872 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -113.50
INFO:tensorflow:Starting iteration 29
I0910 11:20:00.894912 140666432555008 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 832698.83
I0910 11:20:00.896341 140666432555008 replay_runner.py:39] Average training steps per second: 832698.83
I0910 11:20:00.991304 140666432555008 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.00