I0902 23:09:47.185923 140170650351616 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 23:09:47.186539 140170650351616 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 23:09:47.272958 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:47.274802 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:47.274946 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:47.275061 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:47.275197 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:47.275302 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:47.275494 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:47.275603 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:47.275722 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:47.275839 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:47.275943 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:47.276049 140170650351616 dqn_agent.py:283] 	 seed: 1630624187272864
I0902 23:09:47.279076 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:47.279262 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:47.279337 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:47.279404 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:47.279478 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:47.279529 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:47.279610 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:47.279828 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:47.279957 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:52.646975 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in cartpole
I0902 23:09:53.616905 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:53.718584 140170650351616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:09:53.758053 140170650351616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:09:53.758393 140170650351616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:09:53.758670 140170650351616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:09:53.758911 140170650351616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:09:53.759139 140170650351616 dqn_agent.py:275] 	 update_period: 4
I0902 23:09:53.759377 140170650351616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:09:53.759608 140170650351616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:09:53.759832 140170650351616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:09:53.760060 140170650351616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:09:53.760283 140170650351616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:09:53.760533 140170650351616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:09:53.761017 140170650351616 dqn_agent.py:283] 	 seed: 1630624193758004
I0902 23:09:53.772497 140170650351616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:09:53.778493 140170650351616 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:09:53.779682 140170650351616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:09:53.780801 140170650351616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:09:53.781883 140170650351616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:09:53.782831 140170650351616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:09:53.783736 140170650351616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:09:53.784727 140170650351616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:09:53.785859 140170650351616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:09:54.972255 140170650351616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:09:55.102703 140170650351616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:09:55.103104 140170650351616 replay_runner.py:41] Starting iteration 0
Training fixed agent 3, please be patient, may be a while...
Steps executed: 200 Episode length: 9 Return: 9.0.0
INFO:tensorflow:Average training steps per second: 120.14
I0902 23:10:03.428102 140170650351616 replay_runner.py:36] Average training steps per second: 120.14
I0902 23:10:04.315509 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.09
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 194.75
I0902 23:10:09.602188 140170650351616 replay_runner.py:36] Average training steps per second: 194.75
I0902 23:10:09.795217 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.41
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 182.42
I0902 23:10:15.484572 140170650351616 replay_runner.py:36] Average training steps per second: 182.42
I0902 23:10:15.618682 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:10:15.806342 140170650351616 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 184.13
I0902 23:10:21.238040 140170650351616 replay_runner.py:36] Average training steps per second: 184.13
I0902 23:10:21.388241 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 368 Episode length: 199 Return: 199.0
INFO:tensorflow:Average training steps per second: 193.60
I0902 23:10:26.758691 140170650351616 replay_runner.py:36] Average training steps per second: 193.60
I0902 23:10:27.003806 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 5

Steps executed: 350 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 181.77
I0902 23:10:32.705144 140170650351616 replay_runner.py:36] Average training steps per second: 181.77
I0902 23:10:32.939104 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 175.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.25
I0902 23:10:38.123620 140170650351616 replay_runner.py:36] Average training steps per second: 200.25
I0902 23:10:38.257596 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7

Steps executed: 316 Episode length: 160 Return: 160.0
INFO:tensorflow:Average training steps per second: 184.64
I0902 23:10:43.870321 140170650351616 replay_runner.py:36] Average training steps per second: 184.64
I0902 23:10:44.104095 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 8

Steps executed: 294 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 199.15
I0902 23:10:49.324903 140170650351616 replay_runner.py:36] Average training steps per second: 199.15
I0902 23:10:49.526458 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 147.00
INFO:tensorflow:Starting iteration 9

Steps executed: 278 Episode length: 140 Return: 140.0
INFO:tensorflow:Average training steps per second: 189.29
I0902 23:10:55.007974 140170650351616 replay_runner.py:36] Average training steps per second: 189.29
I0902 23:10:55.201964 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 139.00
INFO:tensorflow:Starting iteration 10

Steps executed: 275 Episode length: 135 Return: 135.0
INFO:tensorflow:Average training steps per second: 201.15
I0902 23:11:00.369116 140170650351616 replay_runner.py:36] Average training steps per second: 201.15
I0902 23:11:00.560124 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 137.50
INFO:tensorflow:Starting iteration 11

Steps executed: 330 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 187.88
I0902 23:11:06.081454 140170650351616 replay_runner.py:36] Average training steps per second: 187.88
I0902 23:11:06.311092 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 165.00
INFO:tensorflow:Starting iteration 12
I0902 23:11:06.506735 140170650351616 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 201.52

Steps executed: 352 Episode length: 174 Return: 174.0
I0902 23:11:11.715052 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 176.00
INFO:tensorflow:Starting iteration 13
I0902 23:11:11.909324 140170650351616 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 189.66
I0902 23:11:17.182443 140170650351616 replay_runner.py:36] Average training steps per second: 189.66
I0902 23:11:17.323060 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 14


Steps executed: 302 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 204.98
I0902 23:11:22.395192 140170650351616 replay_runner.py:36] Average training steps per second: 204.98
I0902 23:11:22.596883 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 15

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 188.30
I0902 23:11:28.102589 140170650351616 replay_runner.py:36] Average training steps per second: 188.30
I0902 23:11:28.249374 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 16

Steps executed: 338 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 189.90
I0902 23:11:33.706597 140170650351616 replay_runner.py:36] Average training steps per second: 189.90
I0902 23:11:33.929048 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 169.00
INFO:tensorflow:Starting iteration 17
I0902 23:11:34.129562 140170650351616 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 193.18
I0902 23:11:39.306876 140170650351616 replay_runner.py:36] Average training steps per second: 193.18
I0902 23:11:39.435431 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.05
I0902 23:11:44.502093 140170650351616 replay_runner.py:36] Average training steps per second: 205.05
I0902 23:11:44.645246 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:11:44.830067 140170650351616 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 191.59
I0902 23:11:50.050196 140170650351616 replay_runner.py:36] Average training steps per second: 191.59
I0902 23:11:50.182065 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20

Steps executed: 308 Episode length: 159 Return: 159.0
INFO:tensorflow:Average training steps per second: 198.18
I0902 23:11:55.431532 140170650351616 replay_runner.py:36] Average training steps per second: 198.18
I0902 23:11:55.658884 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 154.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.33
I0902 23:12:00.981325 140170650351616 replay_runner.py:36] Average training steps per second: 194.33
I0902 23:12:01.114267 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:12:01.295848 140170650351616 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 198.97
I0902 23:12:06.322604 140170650351616 replay_runner.py:36] Average training steps per second: 198.97
I0902 23:12:06.464696 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:12:06.665879 140170650351616 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 191.26
I0902 23:12:11.894976 140170650351616 replay_runner.py:36] Average training steps per second: 191.26
I0902 23:12:12.022260 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:12:12.216882 140170650351616 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 195.89
I0902 23:12:17.322414 140170650351616 replay_runner.py:36] Average training steps per second: 195.89
I0902 23:12:17.461456 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 354 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.44
I0902 23:12:22.822820 140170650351616 replay_runner.py:36] Average training steps per second: 193.44
I0902 23:12:23.042576 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 177.00
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 202.13
I0902 23:12:28.173130 140170650351616 replay_runner.py:36] Average training steps per second: 202.13
I0902 23:12:28.315572 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:12:28.516951 140170650351616 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 192.48
I0902 23:12:33.712626 140170650351616 replay_runner.py:36] Average training steps per second: 192.48
I0902 23:12:33.840855 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:12:34.024343 140170650351616 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 199.76
I0902 23:12:39.030739 140170650351616 replay_runner.py:36] Average training steps per second: 199.76
I0902 23:12:39.172293 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 195.27
I0902 23:12:44.489413 140170650351616 replay_runner.py:36] Average training steps per second: 195.27
I0902 23:12:44.612102 140170650351616 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00