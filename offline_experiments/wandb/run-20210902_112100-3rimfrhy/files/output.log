Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0902 11:21:06.963188 140176592435200 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0902 11:21:06.963714 140176592435200 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0902 11:21:07.061822 140176592435200 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:07.063262 140176592435200 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:07.063376 140176592435200 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:07.063458 140176592435200 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:07.063805 140176592435200 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:07.063965 140176592435200 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:07.064048 140176592435200 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:07.064115 140176592435200 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:07.064174 140176592435200 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:07.064252 140176592435200 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:07.064356 140176592435200 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:07.064445 140176592435200 dqn_agent.py:283] 	 seed: 1630581667061755
I0902 11:21:07.066254 140176592435200 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:07.066386 140176592435200 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:07.066462 140176592435200 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:07.066522 140176592435200 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:07.066606 140176592435200 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:07.066661 140176592435200 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:07.066715 140176592435200 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:07.066851 140176592435200 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:07.066942 140176592435200 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.487653 140176592435200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.829370 140176592435200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.838270 140176592435200 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 11:21:08.843001 140176592435200 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 11:21:08.843139 140176592435200 dqn_agent.py:272] 	 gamma: 0.990000
I0902 11:21:08.843227 140176592435200 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 11:21:08.843291 140176592435200 dqn_agent.py:274] 	 min_replay_history: 500
I0902 11:21:08.843348 140176592435200 dqn_agent.py:275] 	 update_period: 4
I0902 11:21:08.843402 140176592435200 dqn_agent.py:276] 	 target_update_period: 300
I0902 11:21:08.843455 140176592435200 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 11:21:08.843506 140176592435200 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 11:21:08.843557 140176592435200 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 11:21:08.843608 140176592435200 dqn_agent.py:280] 	 optimizer: adam
I0902 11:21:08.843658 140176592435200 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 11:21:08.843709 140176592435200 dqn_agent.py:283] 	 seed: 1630581668842966
I0902 11:21:08.845235 140176592435200 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 11:21:08.845349 140176592435200 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 11:21:08.845431 140176592435200 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 11:21:08.845496 140176592435200 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 11:21:08.845553 140176592435200 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 11:21:08.845607 140176592435200 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 11:21:08.845696 140176592435200 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 11:21:08.845750 140176592435200 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 11:21:08.845817 140176592435200 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 11:21:08.863366 140176592435200 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 11:21:08.875667 140176592435200 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 11:21:08.875862 140176592435200 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 169.19
I0902 11:21:14.786497 140176592435200 replay_runner.py:36] Average training steps per second: 169.19
Steps executed: 300 Episode length: 143 Return: -365.55417976966125
I0902 11:21:15.823963 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.40
INFO:tensorflow:Starting iteration 1

Steps executed: 264 Episode length: 111 Return: -287.18118533327726
INFO:tensorflow:Average training steps per second: 209.55
I0902 11:21:24.809630 140176592435200 replay_runner.py:36] Average training steps per second: 209.55
I0902 11:21:25.059960 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.10
INFO:tensorflow:Starting iteration 2

Steps executed: 324 Episode length: 153 Return: -350.40026973548646
INFO:tensorflow:Average training steps per second: 204.12
I0902 11:21:34.134582 140176592435200 replay_runner.py:36] Average training steps per second: 204.12
I0902 11:21:34.460379 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -359.64
INFO:tensorflow:Starting iteration 3
I0902 11:21:38.693765 140176592435200 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 212.29

Steps executed: 1000 Episode length: 1000 Return: -24.03260453880075
I0902 11:21:46.802768 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -24.03
INFO:tensorflow:Starting iteration 4
I0902 11:21:51.199001 140176592435200 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 219.12

Steps executed: 1000 Episode length: 1000 Return: -141.21385507350496
I0902 11:21:58.118500 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.21
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -127.84619308978719
INFO:tensorflow:Average training steps per second: 227.37
I0902 11:22:06.864303 140176592435200 replay_runner.py:36] Average training steps per second: 227.37
I0902 11:22:08.508312 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.85
INFO:tensorflow:Starting iteration 6
I0902 11:22:12.839065 140176592435200 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 221.84

Steps executed: 685 Episode length: 685 Return: -465.1824537006880319
I0902 11:22:18.943717 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -465.18
INFO:tensorflow:Starting iteration 7
I0902 11:22:23.217533 140176592435200 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 223.95

Steps executed: 680 Episode length: 680 Return: -347.3866466787006319
I0902 11:22:29.332197 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.39
INFO:tensorflow:Starting iteration 8
I0902 11:22:33.578987 140176592435200 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 219.37

Steps executed: 1000 Episode length: 1000 Return: -405.91926951480895
I0902 11:22:41.069671 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -405.92
INFO:tensorflow:Starting iteration 9
I0902 11:22:45.434724 140176592435200 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 224.00

Steps executed: 1000 Episode length: 1000 Return: -284.12145004113565
I0902 11:22:52.340977 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -284.12
INFO:tensorflow:Starting iteration 10
I0902 11:22:56.731621 140176592435200 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 232.48

Steps executed: 1000 Episode length: 1000 Return: -212.91594506802556
I0902 11:23:02.891582 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.92
INFO:tensorflow:Starting iteration 11
I0902 11:23:07.242522 140176592435200 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 229.26

Steps executed: 1000 Episode length: 1000 Return: -211.38876942365357
I0902 11:23:16.086140 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -211.39
INFO:tensorflow:Starting iteration 12
I0902 11:23:20.450126 140176592435200 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 218.40

Steps executed: 1000 Episode length: 1000 Return: -114.66269169738351
I0902 11:23:28.143747 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.66
INFO:tensorflow:Starting iteration 13
I0902 11:23:32.540511 140176592435200 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 220.31

Steps executed: 1000 Episode length: 1000 Return: -99.477968013021481
I0902 11:23:40.747936 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.48
INFO:tensorflow:Starting iteration 14
I0902 11:23:45.054723 140176592435200 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 226.96
I0902 11:23:49.461597 140176592435200 replay_runner.py:36] Average training steps per second: 226.96

Steps executed: 1000 Episode length: 1000 Return: -91.911630453426911
INFO:tensorflow:Starting iteration 15
I0902 11:23:57.294334 140176592435200 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 267.72

Steps executed: 460 Episode length: 460 Return: -20.38794762862799811
I0902 11:24:01.582202 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -20.39
INFO:tensorflow:Starting iteration 16
I0902 11:24:05.312486 140176592435200 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 241.77
I0902 11:24:09.449126 140176592435200 replay_runner.py:36] Average training steps per second: 241.77

Steps executed: 812 Episode length: 812 Return: 134.80967211881077811
INFO:tensorflow:Starting iteration 17

Steps executed: 254 Episode length: 136 Return: -430.0230261148202811
INFO:tensorflow:Average training steps per second: 227.72
I0902 11:24:19.737547 140176592435200 replay_runner.py:36] Average training steps per second: 227.72
I0902 11:24:19.956357 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.74
INFO:tensorflow:Starting iteration 18
I0902 11:24:24.233020 140176592435200 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 220.58

Steps executed: 450 Episode length: 450 Return: -42.12938864746277511
I0902 11:24:29.511152 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -42.13
INFO:tensorflow:Starting iteration 19

Steps executed: 267 Episode length: 172 Return: -53.32715249349228511
INFO:tensorflow:Average training steps per second: 222.24
I0902 11:24:38.240387 140176592435200 replay_runner.py:36] Average training steps per second: 222.24
I0902 11:24:38.478315 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -53.95
INFO:tensorflow:Starting iteration 20
I0902 11:24:42.580079 140176592435200 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 224.44

Steps executed: 448 Episode length: 303 Return: -265.2266540670912511
I0902 11:24:47.561169 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.36
INFO:tensorflow:Starting iteration 21

Steps executed: 261 Episode length: 135 Return: -227.4371507098646411
INFO:tensorflow:Average training steps per second: 219.35
I0902 11:24:56.508603 140176592435200 replay_runner.py:36] Average training steps per second: 219.35
I0902 11:24:56.730065 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 22
I0902 11:25:01.107774 140176592435200 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 219.51

Steps executed: 1000 Episode length: 1000 Return: -15.693465221916618
I0902 11:25:08.005954 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.69
INFO:tensorflow:Starting iteration 23

Steps executed: 165 Episode length: 165 Return: -151.9008726876024618
INFO:tensorflow:Average training steps per second: 219.73
I0902 11:25:16.931780 140176592435200 replay_runner.py:36] Average training steps per second: 219.73

Steps executed: 332 Episode length: 167 Return: -558.3655686322203618
INFO:tensorflow:Starting iteration 24

Steps executed: 257 Episode length: 257 Return: -204.8217262998800318
INFO:tensorflow:Average training steps per second: 222.43
I0902 11:25:26.030275 140176592435200 replay_runner.py:36] Average training steps per second: 222.43
I0902 11:25:26.345608 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -204.82
INFO:tensorflow:Starting iteration 25
I0902 11:25:30.725714 140176592435200 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 222.34
I0902 11:25:35.223908 140176592435200 replay_runner.py:36] Average training steps per second: 222.34

Steps executed: 231 Episode length: 88 Return: -474.70370340045725318
INFO:tensorflow:Starting iteration 26

Steps executed: 504 Episode length: 315 Return: -49.75849202641281218
INFO:tensorflow:Average training steps per second: 223.53
I0902 11:25:44.183166 140176592435200 replay_runner.py:36] Average training steps per second: 223.53
I0902 11:25:44.838946 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.06
INFO:tensorflow:Starting iteration 27
I0902 11:25:49.211373 140176592435200 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 227.20

Steps executed: 280 Episode length: 140 Return: -61.67892674375844618
I0902 11:25:53.898068 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.42
INFO:tensorflow:Starting iteration 28

Steps executed: 131 Episode length: 131 Return: -192.8670602166324618
INFO:tensorflow:Average training steps per second: 228.49

Steps executed: 1131 Episode length: 1000 Return: -147.08278460220828
I0902 11:26:06.044805 140176592435200 run_experiment.py:428] Average undiscounted return per evaluation episode: -169.97
INFO:tensorflow:Starting iteration 29

Steps executed: 104 Episode length: 104 Return: -153.1420358104838628
INFO:tensorflow:Average training steps per second: 232.05

Steps executed: 956 Episode length: 852 Return: 115.27945674297632628

Done fixed training!Episode length: 852 Return: 115.27945674297632628