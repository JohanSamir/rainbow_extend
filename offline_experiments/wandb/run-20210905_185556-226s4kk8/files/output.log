Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0905 18:56:03.372041 140681815287808 run_experiment.py:549] Creating TrainRunner ...
I0905 18:56:03.380333 140681815287808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:56:03.380524 140681815287808 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:56:03.380667 140681815287808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:56:03.380773 140681815287808 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:56:03.380946 140681815287808 dqn_agent.py:275] 	 update_period: 4
I0905 18:56:03.381093 140681815287808 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:56:03.381206 140681815287808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:56:03.381288 140681815287808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:56:03.381377 140681815287808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:56:03.381506 140681815287808 dqn_agent.py:280] 	 optimizer: adam
I0905 18:56:03.381629 140681815287808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:56:03.381804 140681815287808 dqn_agent.py:283] 	 seed: 1630868163380276
I0905 18:56:03.385143 140681815287808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:56:03.385355 140681815287808 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:56:03.385544 140681815287808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:56:03.385978 140681815287808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:56:03.386175 140681815287808 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:56:03.386331 140681815287808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:56:03.386463 140681815287808 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:56:03.386703 140681815287808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:56:03.386802 140681815287808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:56:03.445262 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:56:03.948095 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:56:03.965129 140681815287808 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:56:03.975333 140681815287808 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:56:03.975660 140681815287808 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:56:03.975933 140681815287808 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:56:03.976279 140681815287808 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:56:03.976629 140681815287808 dqn_agent.py:275] 	 update_period: 4
I0905 18:56:03.976820 140681815287808 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:56:03.977023 140681815287808 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:56:03.977129 140681815287808 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:56:03.977272 140681815287808 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:56:03.977446 140681815287808 dqn_agent.py:280] 	 optimizer: adam
I0905 18:56:03.977590 140681815287808 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:56:03.977694 140681815287808 dqn_agent.py:283] 	 seed: 1630868163975259
I0905 18:56:03.980782 140681815287808 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:56:03.981034 140681815287808 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:56:03.981188 140681815287808 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:56:03.981378 140681815287808 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:56:03.981622 140681815287808 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:56:03.981740 140681815287808 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:56:03.981884 140681815287808 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:56:03.982007 140681815287808 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:56:03.982376 140681815287808 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:56:04.036480 140681815287808 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:56:04.067705 140681815287808 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:56:04.067910 140681815287808 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 107.67
I0905 18:56:13.355988 140681815287808 replay_runner.py:36] Average training steps per second: 107.67
Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:56:15.523508 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 18:56:15.822710 140681815287808 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 154.10
I0905 18:56:22.312714 140681815287808 replay_runner.py:36] Average training steps per second: 154.10
I0905 18:56:23.094614 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0905 18:56:23.396119 140681815287808 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 170.00
I0905 18:56:29.279039 140681815287808 replay_runner.py:36] Average training steps per second: 170.00
I0905 18:56:30.107209 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0905 18:56:30.399157 140681815287808 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 160.05
I0905 18:56:36.648206 140681815287808 replay_runner.py:36] Average training steps per second: 160.05
I0905 18:56:37.367504 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0905 18:56:37.622453 140681815287808 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 157.23
I0905 18:56:43.983088 140681815287808 replay_runner.py:36] Average training steps per second: 157.23
I0905 18:56:44.785225 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 18:56:45.037221 140681815287808 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 155.38
I0905 18:56:51.474264 140681815287808 replay_runner.py:36] Average training steps per second: 155.38
I0905 18:56:52.314777 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0905 18:56:52.626416 140681815287808 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 160.66
I0905 18:56:58.851086 140681815287808 replay_runner.py:36] Average training steps per second: 160.66
I0905 18:56:59.601015 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0905 18:56:59.902157 140681815287808 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 167.34
I0905 18:57:05.878582 140681815287808 replay_runner.py:36] Average training steps per second: 167.34
I0905 18:57:06.609381 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0905 18:57:06.919968 140681815287808 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 153.47
I0905 18:57:13.436234 140681815287808 replay_runner.py:36] Average training steps per second: 153.47
I0905 18:57:14.217250 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0905 18:57:14.505228 140681815287808 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 151.12
I0905 18:57:21.122983 140681815287808 replay_runner.py:36] Average training steps per second: 151.12
I0905 18:57:21.851798 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 308 Episode length: 120 Return: -119.0
INFO:tensorflow:Average training steps per second: 160.97
I0905 18:57:28.370409 140681815287808 replay_runner.py:36] Average training steps per second: 160.97
I0905 18:57:28.808242 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.67
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 149.95
I0905 18:57:35.770921 140681815287808 replay_runner.py:36] Average training steps per second: 149.95
I0905 18:57:36.593992 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12
I0905 18:57:37.000102 140681815287808 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 157.36

Steps executed: 608 Episode length: 500 Return: -500.0
I0905 18:57:44.307336 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.50
INFO:tensorflow:Starting iteration 13
I0905 18:57:44.610313 140681815287808 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 150.06

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:57:52.003962 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14
I0905 18:57:52.299339 140681815287808 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 154.46
I0905 18:57:58.774108 140681815287808 replay_runner.py:36] Average training steps per second: 154.46
I0905 18:57:59.583639 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 15
I0905 18:57:59.909624 140681815287808 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 149.77
I0905 18:58:06.587303 140681815287808 replay_runner.py:36] Average training steps per second: 149.77
I0905 18:58:07.533712 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 16

Steps executed: 231 Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 152.48
I0905 18:58:14.410494 140681815287808 replay_runner.py:36] Average training steps per second: 152.48
I0905 18:58:14.778991 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.00
INFO:tensorflow:Starting iteration 17
I0905 18:58:15.078448 140681815287808 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 156.06

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:58:22.606307 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18
I0905 18:58:22.922780 140681815287808 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 153.91
I0905 18:58:29.420509 140681815287808 replay_runner.py:36] Average training steps per second: 153.91
I0905 18:58:30.302863 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19
I0905 18:58:30.613477 140681815287808 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 155.87
I0905 18:58:37.029864 140681815287808 replay_runner.py:36] Average training steps per second: 155.87
I0905 18:58:37.807070 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 576 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 154.06
I0905 18:58:44.612339 140681815287808 replay_runner.py:36] Average training steps per second: 154.06
I0905 18:58:45.614259 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -287.50
INFO:tensorflow:Starting iteration 21

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 151.50
I0905 18:58:52.536650 140681815287808 replay_runner.py:36] Average training steps per second: 151.50
I0905 18:58:53.449623 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0905 18:58:53.777602 140681815287808 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 149.57
I0905 18:59:00.463940 140681815287808 replay_runner.py:36] Average training steps per second: 149.57
I0905 18:59:01.266849 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 23
I0905 18:59:01.514775 140681815287808 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 150.95
I0905 18:59:08.139963 140681815287808 replay_runner.py:36] Average training steps per second: 150.95
I0905 18:59:09.037814 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24
I0905 18:59:09.347281 140681815287808 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 162.20

Steps executed: 241 Episode length: 82 Return: -81.0.0
I0905 18:59:15.887151 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 25

Steps executed: 241 Episode length: 68 Return: -67.0.0
INFO:tensorflow:Average training steps per second: 160.52
I0905 18:59:22.410613 140681815287808 replay_runner.py:36] Average training steps per second: 160.52
I0905 18:59:22.675709 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.33
INFO:tensorflow:Starting iteration 26

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.70
I0905 18:59:28.336916 140681815287808 replay_runner.py:36] Average training steps per second: 185.70
I0905 18:59:28.875070 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 377 Episode length: 377 Return: -376.0
INFO:tensorflow:Average training steps per second: 185.45
I0905 18:59:34.555915 140681815287808 replay_runner.py:36] Average training steps per second: 185.45
I0905 18:59:34.929694 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.00
INFO:tensorflow:Starting iteration 28

Steps executed: 235 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 193.00
I0905 18:59:40.370597 140681815287808 replay_runner.py:36] Average training steps per second: 193.00
I0905 18:59:40.601825 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 29
I0905 18:59:40.854522 140681815287808 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 202.65

Done fixed training!Episode length: 70 Return: -69.0.0
I0905 18:59:46.022522 140681815287808 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00