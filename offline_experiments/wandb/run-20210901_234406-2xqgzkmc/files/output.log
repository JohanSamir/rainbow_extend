I0901 23:44:13.106142 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0901 23:44:13.120533 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:13.120872 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:13.121006 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:13.121089 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:13.121177 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:13.121288 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:44:13.121411 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:13.121570 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:13.121707 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:13.121829 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:13.121949 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:13.122099 139644712736768 dqn_agent.py:283] 	 seed: 1630539853120420
I0901 23:44:13.125349 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:13.125573 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:44:13.125762 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:13.125880 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:13.126018 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:13.126160 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:13.126286 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:13.126363 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:13.126442 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 23:44:14.792064 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:15.187695 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:15.203142 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:44:15.214571 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:44:15.214817 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:44:15.214918 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:44:15.215000 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:44:15.215074 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:44:15.215159 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:44:15.215240 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:44:15.215357 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:44:15.215432 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:44:15.215487 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:44:15.215553 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:44:15.215625 139644712736768 dqn_agent.py:283] 	 seed: 1630539855214512
I0901 23:44:15.218809 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:44:15.219044 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:44:15.219201 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:44:15.219302 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:44:15.219387 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:44:15.219465 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:44:15.219570 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:44:15.219704 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:44:15.219794 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:44:15.255692 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:44:15.279619 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:44:15.279912 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 158.91
I0901 23:44:21.572986 139644712736768 replay_runner.py:36] Average training steps per second: 158.91
I0901 23:44:22.812176 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -170.22
Steps executed: 267 Episode length: 128 Return: -164.50786709557096
INFO:tensorflow:Starting iteration 1

Steps executed: 205 Episode length: 92 Return: -240.787288111408038
INFO:tensorflow:Average training steps per second: 241.78
I0901 23:44:31.391083 139644712736768 replay_runner.py:36] Average training steps per second: 241.78
I0901 23:44:31.542606 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.05
INFO:tensorflow:Starting iteration 2

Steps executed: 318 Episode length: 318 Return: -173.23981616322188
INFO:tensorflow:Average training steps per second: 233.12
I0901 23:44:40.093564 139644712736768 replay_runner.py:36] Average training steps per second: 233.12
I0901 23:44:40.502655 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.24
INFO:tensorflow:Starting iteration 3
I0901 23:44:44.733066 139644712736768 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 224.84

Steps executed: 1000 Episode length: 1000 Return: -129.00206157957078
I0901 23:44:52.260318 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.00
INFO:tensorflow:Starting iteration 4
I0901 23:44:56.355698 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 223.86

Steps executed: 939 Episode length: 939 Return: -265.4796204150715078
I0901 23:45:03.060657 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -265.48
INFO:tensorflow:Starting iteration 5
I0901 23:45:07.237204 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 223.66

Steps executed: 929 Episode length: 929 Return: -1729.311268902282678
I0901 23:45:13.860499 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -1729.31
INFO:tensorflow:Starting iteration 6
I0901 23:45:18.216402 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 216.43

Steps executed: 1000 Episode length: 1000 Return: -80.319351871485988
I0901 23:45:25.954703 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.32
INFO:tensorflow:Starting iteration 7

Steps executed: 199 Episode length: 199 Return: -81.03148593967059988
INFO:tensorflow:Average training steps per second: 224.81

Steps executed: 794 Episode length: 595 Return: -202.1219166893631988
I0901 23:45:36.262065 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -141.58
INFO:tensorflow:Starting iteration 8
I0901 23:45:40.443992 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 221.26

Steps executed: 1000 Episode length: 1000 Return: -173.39568804273253
I0901 23:45:47.395005 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.40
INFO:tensorflow:Starting iteration 9
I0901 23:45:51.665172 139644712736768 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 220.20

Steps executed: 819 Episode length: 819 Return: -250.2136602111919253
I0901 23:45:58.525973 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.21
INFO:tensorflow:Starting iteration 10
I0901 23:46:02.957998 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 224.14

Steps executed: 1000 Episode length: 1000 Return: -158.54154170525226
I0901 23:46:10.341562 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.54
INFO:tensorflow:Starting iteration 11
I0901 23:46:14.669849 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 222.88

Steps executed: 675 Episode length: 675 Return: -225.9274045733410526
I0901 23:46:20.814768 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -225.93
INFO:tensorflow:Starting iteration 12
I0901 23:46:25.199553 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 227.72

Steps executed: 1000 Episode length: 1000 Return: -217.57801721126947
I0901 23:46:32.756676 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.58
INFO:tensorflow:Starting iteration 13
I0901 23:46:37.065877 139644712736768 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 226.22

Steps executed: 1000 Episode length: 1000 Return: -99.265228800012687
I0901 23:46:44.642470 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.27
INFO:tensorflow:Starting iteration 14

Steps executed: 568 Episode length: 568 Return: -411.5982148652761687
INFO:tensorflow:Average training steps per second: 223.94
I0901 23:46:53.519738 139644712736768 replay_runner.py:36] Average training steps per second: 223.94
I0901 23:46:54.431563 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.60
INFO:tensorflow:Starting iteration 15
I0901 23:46:58.731117 139644712736768 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 214.41

Steps executed: 528 Episode length: 528 Return: -22.61130526585918787
I0901 23:47:04.254041 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -22.61
INFO:tensorflow:Starting iteration 16

Steps executed: 358 Episode length: 358 Return: -21.63099589529498787
INFO:tensorflow:Average training steps per second: 223.87
I0901 23:47:12.992057 139644712736768 replay_runner.py:36] Average training steps per second: 223.87
I0901 23:47:13.382662 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -21.63
INFO:tensorflow:Starting iteration 17

Steps executed: 232 Episode length: 56 Return: -86.147257394083118787
INFO:tensorflow:Average training steps per second: 227.95
I0901 23:47:21.698337 139644712736768 replay_runner.py:36] Average training steps per second: 227.95
I0901 23:47:21.906397 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.07
INFO:tensorflow:Starting iteration 18

Steps executed: 126 Episode length: 126 Return: -372.4180250245582387
INFO:tensorflow:Average training steps per second: 224.03
I0901 23:47:30.674659 139644712736768 replay_runner.py:36] Average training steps per second: 224.03

Steps executed: 470 Episode length: 344 Return: -353.8491425177284387
INFO:tensorflow:Starting iteration 19

Steps executed: 499 Episode length: 499 Return: -86.29095708425987387
INFO:tensorflow:Average training steps per second: 234.92
I0901 23:47:39.720978 139644712736768 replay_runner.py:36] Average training steps per second: 234.92
I0901 23:47:40.588788 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.29
INFO:tensorflow:Starting iteration 20
I0901 23:47:44.941720 139644712736768 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 228.54
I0901 23:47:49.317790 139644712736768 replay_runner.py:36] Average training steps per second: 228.54

Steps executed: 286 Episode length: 151 Return: -19.85687268368575587
INFO:tensorflow:Starting iteration 21

Steps executed: 309 Episode length: 187 Return: -293.5795996491599587
INFO:tensorflow:Average training steps per second: 226.78
I0901 23:47:58.422288 139644712736768 replay_runner.py:36] Average training steps per second: 226.78
I0901 23:47:58.700838 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -196.11
INFO:tensorflow:Starting iteration 22

Steps executed: 285 Episode length: 129 Return: -44.02756013817064587
INFO:tensorflow:Average training steps per second: 217.49
I0901 23:48:07.605864 139644712736768 replay_runner.py:36] Average training steps per second: 217.49
I0901 23:48:07.879327 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.18
INFO:tensorflow:Starting iteration 23
I0901 23:48:12.226439 139644712736768 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 217.59

Steps executed: 482 Episode length: 482 Return: -72.75043335249083587
I0901 23:48:17.750872 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.75
INFO:tensorflow:Starting iteration 24
I0901 23:48:22.050378 139644712736768 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 225.94
I0901 23:48:26.476804 139644712736768 replay_runner.py:36] Average training steps per second: 225.94

Steps executed: 1000 Episode length: 1000 Return: 56.0108724881188287
INFO:tensorflow:Starting iteration 25

Steps executed: 230 Episode length: 65 Return: -217.46736116477786287
INFO:tensorflow:Average training steps per second: 225.17
I0901 23:48:38.263084 139644712736768 replay_runner.py:36] Average training steps per second: 225.17
I0901 23:48:38.472439 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -274.32
INFO:tensorflow:Starting iteration 26

Steps executed: 126 Episode length: 126 Return: -659.9684291252353287
INFO:tensorflow:Average training steps per second: 224.71
I0901 23:48:47.308694 139644712736768 replay_runner.py:36] Average training steps per second: 224.71

Steps executed: 232 Episode length: 106 Return: -700.7061703236076287
INFO:tensorflow:Starting iteration 27
I0901 23:48:51.670748 139644712736768 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 225.68

Steps executed: 1000 Episode length: 1000 Return: -94.563429877509537
I0901 23:48:59.149261 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.56
INFO:tensorflow:Starting iteration 28

Steps executed: 579 Episode length: 579 Return: 225.79332922068149537
INFO:tensorflow:Average training steps per second: 227.30
I0901 23:49:07.934717 139644712736768 replay_runner.py:36] Average training steps per second: 227.30
I0901 23:49:09.241017 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: 225.79
INFO:tensorflow:Starting iteration 29

Steps executed: 332 Episode length: 217 Return: 9.8252118674835467537
INFO:tensorflow:Average training steps per second: 224.61
I0901 23:49:17.842848 139644712736768 replay_runner.py:36] Average training steps per second: 224.61

Done fixed training!Episode length: 217 Return: 9.8252118674835467537