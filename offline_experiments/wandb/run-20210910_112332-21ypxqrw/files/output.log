Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
I0910 11:23:37.203906 139947463223296 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 11:23:37.204460 139947463223296 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 11:23:37.260108 139947463223296 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:37.261223 139947463223296 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:37.261344 139947463223296 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:37.261408 139947463223296 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:37.261464 139947463223296 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:37.261548 139947463223296 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:37.261608 139947463223296 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:37.261726 139947463223296 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:37.261815 139947463223296 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:37.261886 139947463223296 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:37.261955 139947463223296 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:37.262024 139947463223296 dqn_agent.py:283] 	 seed: 1631273017260050
I0910 11:23:37.263641 139947463223296 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:37.263765 139947463223296 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:37.263840 139947463223296 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:37.263908 139947463223296 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:37.263958 139947463223296 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:37.264024 139947463223296 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:37.264091 139947463223296 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:37.264161 139947463223296 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:37.264226 139947463223296 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.487303 139947463223296 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.558334 139947463223296 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:38.558491 139947463223296 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:38.558576 139947463223296 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:38.558635 139947463223296 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:38.558687 139947463223296 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:38.558735 139947463223296 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:38.558856 139947463223296 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:38.558908 139947463223296 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:38.558970 139947463223296 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:38.559035 139947463223296 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:38.559113 139947463223296 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:38.559175 139947463223296 dqn_agent.py:283] 	 seed: 1631273018558293
I0910 11:23:38.560632 139947463223296 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:38.560755 139947463223296 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:38.560825 139947463223296 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:38.560887 139947463223296 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:38.560944 139947463223296 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:38.561002 139947463223296 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:38.561080 139947463223296 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:38.561151 139947463223296 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:38.561251 139947463223296 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:38.580355 139947463223296 dqn_agent.py:70] Creating Adam optimizer with settings lr=10.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:38.591567 139947463223296 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:23:38.591711 139947463223296 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 812062.73
I0910 11:23:38.593087 139947463223296 replay_runner.py:39] Average training steps per second: 812062.73
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:23:39.306388 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:23:39.362993 139947463223296 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 898715.23
I0910 11:23:39.364303 139947463223296 replay_runner.py:39] Average training steps per second: 898715.23
I0910 11:23:39.519965 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:23:39.571656 139947463223296 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 818720.28
I0910 11:23:39.573188 139947463223296 replay_runner.py:39] Average training steps per second: 818720.28
I0910 11:23:39.732221 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:23:39.784323 139947463223296 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 819520.13
I0910 11:23:39.785794 139947463223296 replay_runner.py:39] Average training steps per second: 819520.13
I0910 11:23:39.949745 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:23:40.002665 139947463223296 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 891077.97
I0910 11:23:40.003993 139947463223296 replay_runner.py:39] Average training steps per second: 891077.97
I0910 11:23:40.169477 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:23:40.221947 139947463223296 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 805667.31
I0910 11:23:40.223440 139947463223296 replay_runner.py:39] Average training steps per second: 805667.31
I0910 11:23:40.388857 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:23:40.441183 139947463223296 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 794978.01
I0910 11:23:40.442667 139947463223296 replay_runner.py:39] Average training steps per second: 794978.01
I0910 11:23:40.610346 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:23:40.663710 139947463223296 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 748314.72
I0910 11:23:40.665271 139947463223296 replay_runner.py:39] Average training steps per second: 748314.72
I0910 11:23:40.832303 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:23:40.885020 139947463223296 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 842229.72
I0910 11:23:40.886427 139947463223296 replay_runner.py:39] Average training steps per second: 842229.72
I0910 11:23:41.050124 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:23:41.103516 139947463223296 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 790185.38
I0910 11:23:41.105031 139947463223296 replay_runner.py:39] Average training steps per second: 790185.38
I0910 11:23:41.281764 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:23:41.335023 139947463223296 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 837186.43
I0910 11:23:41.336444 139947463223296 replay_runner.py:39] Average training steps per second: 837186.43
I0910 11:23:41.518768 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:23:41.570924 139947463223296 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 748849.13
I0910 11:23:41.572541 139947463223296 replay_runner.py:39] Average training steps per second: 748849.13
I0910 11:23:41.736887 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:23:41.788654 139947463223296 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 815853.72
I0910 11:23:41.790096 139947463223296 replay_runner.py:39] Average training steps per second: 815853.72
I0910 11:23:41.949508 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:23:42.002125 139947463223296 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 678470.40
I0910 11:23:42.003865 139947463223296 replay_runner.py:39] Average training steps per second: 678470.40
I0910 11:23:42.171236 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:23:42.225067 139947463223296 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 836852.35
I0910 11:23:42.226470 139947463223296 replay_runner.py:39] Average training steps per second: 836852.35
I0910 11:23:42.407185 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:23:42.461547 139947463223296 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 774857.57
I0910 11:23:42.463064 139947463223296 replay_runner.py:39] Average training steps per second: 774857.57
I0910 11:23:42.629430 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:23:42.683173 139947463223296 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 758189.44
I0910 11:23:42.684736 139947463223296 replay_runner.py:39] Average training steps per second: 758189.44
I0910 11:23:42.855185 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:23:42.907207 139947463223296 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 816647.98
I0910 11:23:42.908642 139947463223296 replay_runner.py:39] Average training steps per second: 816647.98
I0910 11:23:43.069520 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:23:43.122190 139947463223296 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 855980.41
I0910 11:23:43.123613 139947463223296 replay_runner.py:39] Average training steps per second: 855980.41
I0910 11:23:43.306777 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:23:43.358327 139947463223296 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 847847.99
I0910 11:23:43.359724 139947463223296 replay_runner.py:39] Average training steps per second: 847847.99
I0910 11:23:43.521375 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:23:43.573805 139947463223296 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 876919.09
I0910 11:23:43.575170 139947463223296 replay_runner.py:39] Average training steps per second: 876919.09
I0910 11:23:43.734626 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:23:43.787512 139947463223296 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 766923.39
I0910 11:23:43.789041 139947463223296 replay_runner.py:39] Average training steps per second: 766923.39
I0910 11:23:43.949794 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:23:44.002596 139947463223296 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 822251.32
I0910 11:23:44.004052 139947463223296 replay_runner.py:39] Average training steps per second: 822251.32
I0910 11:23:44.175764 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:23:44.241686 139947463223296 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 586451.90
I0910 11:23:44.243689 139947463223296 replay_runner.py:39] Average training steps per second: 586451.90
I0910 11:23:44.456990 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:23:44.518776 139947463223296 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 877285.92
I0910 11:23:44.520145 139947463223296 replay_runner.py:39] Average training steps per second: 877285.92
I0910 11:23:44.728266 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:23:44.784131 139947463223296 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 791228.82
I0910 11:23:44.785637 139947463223296 replay_runner.py:39] Average training steps per second: 791228.82
I0910 11:23:44.956679 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:23:45.009421 139947463223296 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 961334.86
I0910 11:23:45.010663 139947463223296 replay_runner.py:39] Average training steps per second: 961334.86
I0910 11:23:45.183590 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:23:45.244856 139947463223296 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 826789.67
I0910 11:23:45.246393 139947463223296 replay_runner.py:39] Average training steps per second: 826789.67
I0910 11:23:45.435948 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:23:45.489714 139947463223296 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 732373.67
I0910 11:23:45.491340 139947463223296 replay_runner.py:39] Average training steps per second: 732373.67
I0910 11:23:45.656644 139947463223296 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:23:45.709605 139947463223296 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 803198.77
I0910 11:23:45.711129 139947463223296 replay_runner.py:39] Average training steps per second: 803198.77

Done fixed training!Episode length: 600 Return: -600.0