I0902 23:22:14.085931 139758623574016 run_experiment.py:549] Creating TrainRunner ...
I0902 23:22:14.096138 139758623574016 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:14.096425 139758623574016 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:14.096572 139758623574016 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:14.096692 139758623574016 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:14.096837 139758623574016 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:14.096984 139758623574016 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:14.097152 139758623574016 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:14.097305 139758623574016 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:14.097455 139758623574016 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:14.097574 139758623574016 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:14.097714 139758623574016 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:14.097839 139758623574016 dqn_agent.py:283] 	 seed: 1630624934096080
I0902 23:22:14.100812 139758623574016 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:14.100983 139758623574016 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:22:14.101143 139758623574016 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:14.101271 139758623574016 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:14.101392 139758623574016 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:14.101500 139758623574016 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:14.101635 139758623574016 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:14.101772 139758623574016 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:14.101886 139758623574016 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in cartpole
Training fixed agent 1, please be patient, may be a while...
I0902 23:22:16.044150 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.571698 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.583217 139758623574016 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:22:16.590184 139758623574016 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:16.590421 139758623574016 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:16.590510 139758623574016 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:16.590580 139758623574016 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:16.590643 139758623574016 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:16.590703 139758623574016 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:16.590763 139758623574016 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:16.590822 139758623574016 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:16.590881 139758623574016 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:16.590939 139758623574016 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:16.590997 139758623574016 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:16.591058 139758623574016 dqn_agent.py:283] 	 seed: 1630624936590126
I0902 23:22:16.594997 139758623574016 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:16.595227 139758623574016 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:22:16.595526 139758623574016 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:16.595759 139758623574016 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:16.595905 139758623574016 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:16.596038 139758623574016 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:16.596142 139758623574016 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:16.596365 139758623574016 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:16.596557 139758623574016 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:22:16.625411 139758623574016 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.644907 139758623574016 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:22:16.645134 139758623574016 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.21
I0902 23:22:23.392724 139758623574016 replay_runner.py:36] Average training steps per second: 148.21
Steps executed: 208 Episode length: 10 Return: 10.0
I0902 23:22:24.484828 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1

Steps executed: 235 Episode length: 79 Return: 79.0
INFO:tensorflow:Average training steps per second: 192.35
I0902 23:22:29.864774 139758623574016 replay_runner.py:36] Average training steps per second: 192.35
I0902 23:22:30.025653 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 78.33
INFO:tensorflow:Starting iteration 2

Steps executed: 251 Episode length: 118 Return: 118.0
INFO:tensorflow:Average training steps per second: 191.08
I0902 23:22:35.444281 139758623574016 replay_runner.py:36] Average training steps per second: 191.08
I0902 23:22:35.618669 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 125.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 184.29
I0902 23:22:41.231475 139758623574016 replay_runner.py:36] Average training steps per second: 184.29
I0902 23:22:41.366626 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4

Steps executed: 329 Episode length: 170 Return: 170.0
INFO:tensorflow:Average training steps per second: 189.65
I0902 23:22:46.821755 139758623574016 replay_runner.py:36] Average training steps per second: 189.65
I0902 23:22:47.045076 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.50
INFO:tensorflow:Starting iteration 5

Steps executed: 316 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 191.26
I0902 23:22:52.468487 139758623574016 replay_runner.py:36] Average training steps per second: 191.26
I0902 23:22:52.681451 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.00
INFO:tensorflow:Starting iteration 6

Steps executed: 317 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 183.12
I0902 23:22:58.330796 139758623574016 replay_runner.py:36] Average training steps per second: 183.12
I0902 23:22:58.555301 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 158.50
INFO:tensorflow:Starting iteration 7
I0902 23:22:58.742767 139758623574016 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 193.35

Steps executed: 289 Episode length: 140 Return: 140.0
I0902 23:23:04.139932 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 144.50
INFO:tensorflow:Starting iteration 8

Steps executed: 358 Episode length: 182 Return: 182.0
INFO:tensorflow:Average training steps per second: 186.75
I0902 23:23:09.786040 139758623574016 replay_runner.py:36] Average training steps per second: 186.75
I0902 23:23:10.021295 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 179.00
INFO:tensorflow:Starting iteration 9

Steps executed: 377 Episode length: 198 Return: 198.0
INFO:tensorflow:Average training steps per second: 188.84
I0902 23:23:15.492715 139758623574016 replay_runner.py:36] Average training steps per second: 188.84
I0902 23:23:15.764057 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 188.50
INFO:tensorflow:Starting iteration 10

Steps executed: 300 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 193.68
I0902 23:23:21.117288 139758623574016 replay_runner.py:36] Average training steps per second: 193.68
I0902 23:23:21.324172 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 11

Steps executed: 373 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 183.52
I0902 23:23:26.963852 139758623574016 replay_runner.py:36] Average training steps per second: 183.52
I0902 23:23:27.208569 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 12

Steps executed: 284 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 189.79
I0902 23:23:32.664174 139758623574016 replay_runner.py:36] Average training steps per second: 189.79
I0902 23:23:32.873500 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.00
INFO:tensorflow:Starting iteration 13
I0902 23:23:33.052117 139758623574016 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 188.78

Steps executed: 318 Episode length: 153 Return: 153.0
I0902 23:23:38.576217 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 159.00
INFO:tensorflow:Starting iteration 14
I0902 23:23:38.757316 139758623574016 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 183.46
I0902 23:23:44.208572 139758623574016 replay_runner.py:36] Average training steps per second: 183.46

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Starting iteration 15

Steps executed: 368 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 193.68
I0902 23:23:49.696880 139758623574016 replay_runner.py:36] Average training steps per second: 193.68
I0902 23:23:49.948858 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 184.00
INFO:tensorflow:Starting iteration 16

Steps executed: 322 Episode length: 171 Return: 171.0
INFO:tensorflow:Average training steps per second: 184.40
I0902 23:23:55.559630 139758623574016 replay_runner.py:36] Average training steps per second: 184.40
I0902 23:23:55.772486 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 161.00
INFO:tensorflow:Starting iteration 17

Steps executed: 364 Episode length: 188 Return: 188.0
INFO:tensorflow:Average training steps per second: 183.93
I0902 23:24:01.396487 139758623574016 replay_runner.py:36] Average training steps per second: 183.93
I0902 23:24:01.675848 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 182.00
INFO:tensorflow:Starting iteration 18

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 194.10
I0902 23:24:07.025923 139758623574016 replay_runner.py:36] Average training steps per second: 194.10
I0902 23:24:07.160455 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0902 23:24:07.355203 139758623574016 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 184.52
I0902 23:24:12.775131 139758623574016 replay_runner.py:36] Average training steps per second: 184.52
I0902 23:24:12.911534 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:24:13.101832 139758623574016 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 196.40
I0902 23:24:18.193995 139758623574016 replay_runner.py:36] Average training steps per second: 196.40
I0902 23:24:18.343142 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 394 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 187.81
I0902 23:24:23.867753 139758623574016 replay_runner.py:36] Average training steps per second: 187.81
I0902 23:24:24.125944 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 197.00
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 186.68
I0902 23:24:29.662311 139758623574016 replay_runner.py:36] Average training steps per second: 186.68
I0902 23:24:29.800822 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:24:29.989913 139758623574016 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 195.34
I0902 23:24:35.109497 139758623574016 replay_runner.py:36] Average training steps per second: 195.34
I0902 23:24:35.232206 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:24:35.411104 139758623574016 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 196.88
I0902 23:24:40.490744 139758623574016 replay_runner.py:36] Average training steps per second: 196.88
I0902 23:24:40.627585 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:24:40.816102 139758623574016 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 195.93
I0902 23:24:45.920567 139758623574016 replay_runner.py:36] Average training steps per second: 195.93
I0902 23:24:46.048164 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:24:46.223674 139758623574016 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 206.27
I0902 23:24:51.072280 139758623574016 replay_runner.py:36] Average training steps per second: 206.27
I0902 23:24:51.197762 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:24:51.372060 139758623574016 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 194.68
I0902 23:24:56.509409 139758623574016 replay_runner.py:36] Average training steps per second: 194.68
I0902 23:24:56.647377 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28

Steps executed: 396 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 190.18
I0902 23:25:02.095458 139758623574016 replay_runner.py:36] Average training steps per second: 190.18
I0902 23:25:02.360001 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 198.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 191.72
I0902 23:25:07.762518 139758623574016 replay_runner.py:36] Average training steps per second: 191.72
I0902 23:25:07.889087 139758623574016 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00