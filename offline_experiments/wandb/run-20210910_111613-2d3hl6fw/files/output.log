I0910 11:16:19.743930 139656004839424 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0910 11:16:19.744500 139656004839424 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0910 11:16:19.804440 139656004839424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:16:19.805527 139656004839424 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:16:19.805651 139656004839424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:16:19.805733 139656004839424 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:16:19.805811 139656004839424 dqn_agent.py:275] 	 update_period: 4
I0910 11:16:19.805949 139656004839424 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:16:19.806042 139656004839424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:16:19.806124 139656004839424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:16:19.806207 139656004839424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:16:19.806298 139656004839424 dqn_agent.py:280] 	 optimizer: adam
I0910 11:16:19.806381 139656004839424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:16:19.806461 139656004839424 dqn_agent.py:283] 	 seed: 1631272579804387
I0910 11:16:19.808591 139656004839424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:16:19.808761 139656004839424 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:16:19.808862 139656004839424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:16:19.808944 139656004839424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:16:19.809021 139656004839424 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:16:19.809106 139656004839424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:16:19.809186 139656004839424 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:16:19.809319 139656004839424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:16:19.809406 139656004839424 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in mountaincar
Training fixed agent 7, please be patient, may be a while...
I0910 11:16:22.751887 139656004839424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:16:22.834124 139656004839424 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:16:22.834290 139656004839424 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:16:22.834367 139656004839424 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:16:22.834429 139656004839424 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:16:22.834483 139656004839424 dqn_agent.py:275] 	 update_period: 4
I0910 11:16:22.834558 139656004839424 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:16:22.834655 139656004839424 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:16:22.834714 139656004839424 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:16:22.834785 139656004839424 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:16:22.834863 139656004839424 dqn_agent.py:280] 	 optimizer: adam
I0910 11:16:22.834937 139656004839424 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:16:22.835010 139656004839424 dqn_agent.py:283] 	 seed: 1631272582834082
I0910 11:16:22.836591 139656004839424 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:16:22.836703 139656004839424 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:16:22.836781 139656004839424 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:16:22.836864 139656004839424 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:16:22.836921 139656004839424 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:16:22.836991 139656004839424 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:16:22.837073 139656004839424 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:16:22.837136 139656004839424 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:16:22.837210 139656004839424 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:16:22.859285 139656004839424 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:16:22.870887 139656004839424 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:16:22.871071 139656004839424 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 793924.66
I0910 11:16:22.872448 139656004839424 replay_runner.py:39] Average training steps per second: 793924.66
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:16:24.494842 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:16:24.571924 139656004839424 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 342896.01
I0910 11:16:24.575460 139656004839424 replay_runner.py:39] Average training steps per second: 342896.01
I0910 11:16:24.958746 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:16:25.022993 139656004839424 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 634731.23
I0910 11:16:25.025016 139656004839424 replay_runner.py:39] Average training steps per second: 634731.23
I0910 11:16:25.246254 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:16:25.302204 139656004839424 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 763294.63
I0910 11:16:25.303782 139656004839424 replay_runner.py:39] Average training steps per second: 763294.63
I0910 11:16:25.535757 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:16:25.592825 139656004839424 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 836852.35
I0910 11:16:25.594240 139656004839424 replay_runner.py:39] Average training steps per second: 836852.35
I0910 11:16:25.804790 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:16:25.863403 139656004839424 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 756275.51
I0910 11:16:25.864961 139656004839424 replay_runner.py:39] Average training steps per second: 756275.51
I0910 11:16:26.062005 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:16:26.116343 139656004839424 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 823058.08
I0910 11:16:26.117816 139656004839424 replay_runner.py:39] Average training steps per second: 823058.08
I0910 11:16:26.329425 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:16:26.385381 139656004839424 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 816489.00
I0910 11:16:26.386836 139656004839424 replay_runner.py:39] Average training steps per second: 816489.00
I0910 11:16:26.574309 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:16:26.644926 139656004839424 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 823219.63
I0910 11:16:26.646454 139656004839424 replay_runner.py:39] Average training steps per second: 823219.63
I0910 11:16:26.869819 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:16:26.961338 139656004839424 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 443700.84
I0910 11:16:26.963916 139656004839424 replay_runner.py:39] Average training steps per second: 443700.84
I0910 11:16:27.179705 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:16:27.259510 139656004839424 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 339454.84
I0910 11:16:27.262815 139656004839424 replay_runner.py:39] Average training steps per second: 339454.84
I0910 11:16:27.543246 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:16:27.598055 139656004839424 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 813164.79
I0910 11:16:27.599515 139656004839424 replay_runner.py:39] Average training steps per second: 813164.79
I0910 11:16:27.803271 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:16:27.860285 139656004839424 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 835185.98
I0910 11:16:27.861737 139656004839424 replay_runner.py:39] Average training steps per second: 835185.98
I0910 11:16:28.080487 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:16:28.151417 139656004839424 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 655462.42
I0910 11:16:28.153267 139656004839424 replay_runner.py:39] Average training steps per second: 655462.42
I0910 11:16:28.353486 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:16:28.439475 139656004839424 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 335544.32
I0910 11:16:28.443033 139656004839424 replay_runner.py:39] Average training steps per second: 335544.32
I0910 11:16:28.725134 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:16:28.791459 139656004839424 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 807528.69
I0910 11:16:28.792953 139656004839424 replay_runner.py:39] Average training steps per second: 807528.69
I0910 11:16:29.106725 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:16:29.169002 139656004839424 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 782811.50
I0910 11:16:29.170519 139656004839424 replay_runner.py:39] Average training steps per second: 782811.50
I0910 11:16:29.443304 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:16:29.533144 139656004839424 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 394981.07
I0910 11:16:29.540024 139656004839424 replay_runner.py:39] Average training steps per second: 394981.07
I0910 11:16:29.834621 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:16:29.891749 139656004839424 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 792574.45
I0910 11:16:29.893243 139656004839424 replay_runner.py:39] Average training steps per second: 792574.45
I0910 11:16:30.087742 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:16:30.146473 139656004839424 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 727672.45
I0910 11:16:30.148140 139656004839424 replay_runner.py:39] Average training steps per second: 727672.45
I0910 11:16:30.331969 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:16:30.390247 139656004839424 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 807684.19
I0910 11:16:30.391744 139656004839424 replay_runner.py:39] Average training steps per second: 807684.19
I0910 11:16:30.587829 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:16:30.644522 139656004839424 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 734425.49
I0910 11:16:30.646164 139656004839424 replay_runner.py:39] Average training steps per second: 734425.49
I0910 11:16:30.978829 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:16:31.039685 139656004839424 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 805048.75
I0910 11:16:31.041161 139656004839424 replay_runner.py:39] Average training steps per second: 805048.75
I0910 11:16:31.286074 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:16:31.371710 139656004839424 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 348393.06
I0910 11:16:31.375050 139656004839424 replay_runner.py:39] Average training steps per second: 348393.06
I0910 11:16:31.716610 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:16:31.806299 139656004839424 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 823381.23
I0910 11:16:31.807729 139656004839424 replay_runner.py:39] Average training steps per second: 823381.23
I0910 11:16:31.996690 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:16:32.051876 139656004839424 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 717588.37
I0910 11:16:32.053511 139656004839424 replay_runner.py:39] Average training steps per second: 717588.37
I0910 11:16:32.250748 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:16:32.306543 139656004839424 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 807528.69
I0910 11:16:32.308027 139656004839424 replay_runner.py:39] Average training steps per second: 807528.69
I0910 11:16:32.537580 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:16:32.594470 139656004839424 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 733269.93
I0910 11:16:32.596113 139656004839424 replay_runner.py:39] Average training steps per second: 733269.93
I0910 11:16:32.815261 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:16:32.872229 139656004839424 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 808151.06
I0910 11:16:32.873715 139656004839424 replay_runner.py:39] Average training steps per second: 808151.06
I0910 11:16:33.082508 139656004839424 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:16:33.139671 139656004839424 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 816171.24
I0910 11:16:33.141123 139656004839424 replay_runner.py:39] Average training steps per second: 816171.24

Done fixed training!Episode length: 600 Return: -600.0