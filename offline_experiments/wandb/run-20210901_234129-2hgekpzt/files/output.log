I0901 23:41:35.972149 139919604459520 run_experiment.py:549] Creating TrainRunner ...
I0901 23:41:35.981075 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:41:35.981295 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:41:35.981403 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:41:35.981467 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:41:35.981568 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:41:35.981663 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:41:35.981723 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:41:35.981788 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:41:35.981843 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:41:35.981908 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:41:35.981960 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:41:35.982043 139919604459520 dqn_agent.py:283] 	 seed: 1630539695981019
I0901 23:41:35.985114 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:41:35.985359 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:41:35.985595 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:41:35.985771 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:41:35.985937 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:41:35.986055 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:41:35.986225 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:41:35.986361 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:41:35.986467 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 2, please be patient, may be a while...
I0901 23:41:37.959566 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:41:38.340742 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:41:38.353516 139919604459520 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:41:38.360684 139919604459520 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:41:38.360948 139919604459520 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:41:38.361109 139919604459520 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:41:38.361246 139919604459520 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:41:38.361464 139919604459520 dqn_agent.py:275] 	 update_period: 4
I0901 23:41:38.361564 139919604459520 dqn_agent.py:276] 	 target_update_period: 100
I0901 23:41:38.361640 139919604459520 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:41:38.361715 139919604459520 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:41:38.361801 139919604459520 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:41:38.361961 139919604459520 dqn_agent.py:280] 	 optimizer: adam
I0901 23:41:38.362100 139919604459520 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:41:38.362293 139919604459520 dqn_agent.py:283] 	 seed: 1630539698360629
I0901 23:41:38.364730 139919604459520 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:41:38.364890 139919604459520 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 23:41:38.365046 139919604459520 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:41:38.365247 139919604459520 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:41:38.365369 139919604459520 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:41:38.365456 139919604459520 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:41:38.365538 139919604459520 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:41:38.365675 139919604459520 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:41:38.365826 139919604459520 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:41:38.401819 139919604459520 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:41:38.423559 139919604459520 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:41:38.423772 139919604459520 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.27
I0901 23:41:45.078539 139919604459520 replay_runner.py:36] Average training steps per second: 150.27
Steps executed: 214 Episode length: 214 Return: -213.0
I0901 23:41:46.293430 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -213.00
INFO:tensorflow:Starting iteration 1
I0901 23:41:46.545191 139919604459520 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 198.16

Steps executed: 388 Episode length: 388 Return: -387.0
I0901 23:41:51.918031 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.00
INFO:tensorflow:Starting iteration 2
I0901 23:41:52.209193 139919604459520 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 195.63

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:41:57.743353 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 23:41:57.989832 139919604459520 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 195.25
I0901 23:42:03.111806 139919604459520 replay_runner.py:36] Average training steps per second: 195.25
I0901 23:42:03.330900 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -124.50
INFO:tensorflow:Starting iteration 4


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.43
I0901 23:42:08.636439 139919604459520 replay_runner.py:36] Average training steps per second: 197.43
I0901 23:42:09.092468 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 23:42:09.343611 139919604459520 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 196.59
I0901 23:42:14.431342 139919604459520 replay_runner.py:36] Average training steps per second: 196.59
I0901 23:42:14.859560 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 23:42:15.155783 139919604459520 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 197.31
I0901 23:42:20.224401 139919604459520 replay_runner.py:36] Average training steps per second: 197.31
I0901 23:42:20.682277 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 23:42:20.929911 139919604459520 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 199.32
I0901 23:42:25.947735 139919604459520 replay_runner.py:36] Average training steps per second: 199.32
I0901 23:42:26.393006 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0901 23:42:26.645256 139919604459520 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 195.38
I0901 23:42:31.763988 139919604459520 replay_runner.py:36] Average training steps per second: 195.38
I0901 23:42:32.176202 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9

Steps executed: 237 Episode length: 84 Return: -83.0.0
INFO:tensorflow:Average training steps per second: 197.92
I0901 23:42:37.475773 139919604459520 replay_runner.py:36] Average training steps per second: 197.92
I0901 23:42:37.674075 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.50
INFO:tensorflow:Starting iteration 10

Steps executed: 279 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 196.96
I0901 23:42:43.023534 139919604459520 replay_runner.py:36] Average training steps per second: 196.96
I0901 23:42:43.268970 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.00
INFO:tensorflow:Starting iteration 11

Steps executed: 602 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 197.47
I0901 23:42:48.572335 139919604459520 replay_runner.py:36] Average training steps per second: 197.47
I0901 23:42:49.074491 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.50
INFO:tensorflow:Starting iteration 12

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.19
I0901 23:42:54.241448 139919604459520 replay_runner.py:36] Average training steps per second: 203.19
I0901 23:42:54.673768 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 121 Episode length: 121 Return: -120.0
INFO:tensorflow:Average training steps per second: 199.05
I0901 23:42:59.945343 139919604459520 replay_runner.py:36] Average training steps per second: 199.05

Steps executed: 261 Episode length: 140 Return: -139.0
INFO:tensorflow:Starting iteration 14

Steps executed: 240 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 192.90
I0901 23:43:05.598725 139919604459520 replay_runner.py:36] Average training steps per second: 192.90
I0901 23:43:05.804736 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.00
INFO:tensorflow:Starting iteration 15

Steps executed: 233 Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 199.74
I0901 23:43:11.066098 139919604459520 replay_runner.py:36] Average training steps per second: 199.74
I0901 23:43:11.254896 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -76.67
INFO:tensorflow:Starting iteration 16

Steps executed: 260 Episode length: 91 Return: -90.0.0
INFO:tensorflow:Average training steps per second: 195.62
I0901 23:43:16.611768 139919604459520 replay_runner.py:36] Average training steps per second: 195.62
I0901 23:43:16.827936 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 17


Steps executed: 283 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 196.99
I0901 23:43:22.143792 139919604459520 replay_runner.py:36] Average training steps per second: 196.99
I0901 23:43:22.392686 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.33
INFO:tensorflow:Starting iteration 18

Steps executed: 287 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 198.21
I0901 23:43:27.686097 139919604459520 replay_runner.py:36] Average training steps per second: 198.21
I0901 23:43:27.926994 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -94.67
INFO:tensorflow:Starting iteration 19

Steps executed: 262 Episode length: 92 Return: -91.0.0
INFO:tensorflow:Average training steps per second: 196.77
I0901 23:43:33.251608 139919604459520 replay_runner.py:36] Average training steps per second: 196.77
I0901 23:43:33.477322 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 20

Steps executed: 218 Episode length: 80 Return: -79.0.0
INFO:tensorflow:Average training steps per second: 197.65
I0901 23:43:38.772287 139919604459520 replay_runner.py:36] Average training steps per second: 197.65
I0901 23:43:38.958572 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.67
INFO:tensorflow:Starting iteration 21

Steps executed: 268 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 192.67
I0901 23:43:44.395786 139919604459520 replay_runner.py:36] Average training steps per second: 192.67
I0901 23:43:44.616798 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 22
I0901 23:43:44.855036 139919604459520 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 197.41
I0901 23:43:49.921220 139919604459520 replay_runner.py:36] Average training steps per second: 197.41

Steps executed: 269 Episode length: 75 Return: -74.0.0
INFO:tensorflow:Starting iteration 23

Steps executed: 229 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 199.40
I0901 23:43:55.406628 139919604459520 replay_runner.py:36] Average training steps per second: 199.40
I0901 23:43:55.585426 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.33
INFO:tensorflow:Starting iteration 24

Steps executed: 259 Episode length: 93 Return: -92.0.0
INFO:tensorflow:Average training steps per second: 206.20
I0901 23:44:00.662039 139919604459520 replay_runner.py:36] Average training steps per second: 206.20
I0901 23:44:00.867401 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.33
INFO:tensorflow:Starting iteration 25
I0901 23:44:01.096158 139919604459520 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 206.68

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 23:44:06.331419 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0901 23:44:06.553818 139919604459520 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 209.78
I0901 23:44:11.321094 139919604459520 replay_runner.py:36] Average training steps per second: 209.78
I0901 23:44:11.705114 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 208 Episode length: 99 Return: -98.0.0
INFO:tensorflow:Average training steps per second: 195.22
I0901 23:44:17.064336 139919604459520 replay_runner.py:36] Average training steps per second: 195.22
I0901 23:44:17.241447 139919604459520 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 28
I0901 23:44:17.479995 139919604459520 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 206.76
I0901 23:44:22.317064 139919604459520 replay_runner.py:36] Average training steps per second: 206.76

Steps executed: 218 Episode length: 85 Return: -84.0.0
INFO:tensorflow:Starting iteration 29

Steps executed: 274 Episode length: 110 Return: -109.0
INFO:tensorflow:Average training steps per second: 197.34
I0901 23:44:27.805841 139919604459520 replay_runner.py:36] Average training steps per second: 197.34

Done fixed training!Episode length: 110 Return: -109.0