I0910 11:23:57.175179 139967107905536 run_experiment.py:549] Creating TrainRunner ...
I0910 11:23:57.180685 139967107905536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:57.180817 139967107905536 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:57.180886 139967107905536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:57.180951 139967107905536 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:57.181014 139967107905536 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:57.181076 139967107905536 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:57.181165 139967107905536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:57.181226 139967107905536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:57.181320 139967107905536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:57.181405 139967107905536 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:57.181486 139967107905536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:57.181571 139967107905536 dqn_agent.py:283] 	 seed: 1631273037180651
I0910 11:23:57.183311 139967107905536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:57.183431 139967107905536 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:57.183510 139967107905536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:57.183586 139967107905536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:57.183649 139967107905536 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:57.183710 139967107905536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:57.183771 139967107905536 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:57.183847 139967107905536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:57.183921 139967107905536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:57.206516 139967107905536 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:57.222191 139967107905536 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:23:57.222318 139967107905536 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:23:57.222399 139967107905536 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:23:57.222466 139967107905536 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:23:57.222527 139967107905536 dqn_agent.py:275] 	 update_period: 4
I0910 11:23:57.222596 139967107905536 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:23:57.222673 139967107905536 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:23:57.222787 139967107905536 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:23:57.222846 139967107905536 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:23:57.222928 139967107905536 dqn_agent.py:280] 	 optimizer: adam
I0910 11:23:57.223008 139967107905536 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:23:57.223082 139967107905536 dqn_agent.py:283] 	 seed: 1631273037222164
I0910 11:23:57.224523 139967107905536 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:23:57.224640 139967107905536 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:23:57.224708 139967107905536 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:23:57.224767 139967107905536 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:23:57.224825 139967107905536 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:23:57.224912 139967107905536 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:23:57.224978 139967107905536 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:23:57.225067 139967107905536 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:23:57.225116 139967107905536 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:23:57.243582 139967107905536 dqn_agent.py:70] Creating Adam optimizer with settings lr=5.000000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:23:57.257091 139967107905536 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:23:57.257228 139967107905536 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 822896.61
I0910 11:23:57.258564 139967107905536 replay_runner.py:39] Average training steps per second: 822896.61
I0910 11:23:57.972415 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:23:58.065054 139967107905536 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 809398.69
I0910 11:23:58.066513 139967107905536 replay_runner.py:39] Average training steps per second: 809398.69
I0910 11:23:58.238983 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:23:58.332688 139967107905536 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 788254.84
I0910 11:23:58.334180 139967107905536 replay_runner.py:39] Average training steps per second: 788254.84
I0910 11:23:58.508536 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0910 11:23:58.601791 139967107905536 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 772005.15
I0910 11:23:58.603308 139967107905536 replay_runner.py:39] Average training steps per second: 772005.15
Loaded trained dqn in mountaincar
Training fixed agent 6, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
I0910 11:23:58.774465 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:23:58.862347 139967107905536 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 806907.27
I0910 11:23:58.863842 139967107905536 replay_runner.py:39] Average training steps per second: 806907.27
I0910 11:23:59.031124 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:23:59.120920 139967107905536 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 851808.29
I0910 11:23:59.122327 139967107905536 replay_runner.py:39] Average training steps per second: 851808.29
I0910 11:23:59.311992 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:23:59.401772 139967107905536 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 802891.27
I0910 11:23:59.403239 139967107905536 replay_runner.py:39] Average training steps per second: 802891.27
I0910 11:23:59.568943 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:23:59.655810 139967107905536 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 860546.57
I0910 11:23:59.657196 139967107905536 replay_runner.py:39] Average training steps per second: 860546.57
I0910 11:23:59.858204 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:23:59.960287 139967107905536 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 801816.86
I0910 11:23:59.961784 139967107905536 replay_runner.py:39] Average training steps per second: 801816.86
I0910 11:24:00.133108 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:24:00.219102 139967107905536 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 809086.42
I0910 11:24:00.220556 139967107905536 replay_runner.py:39] Average training steps per second: 809086.42
I0910 11:24:00.378574 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:24:00.468130 139967107905536 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 898522.71
I0910 11:24:00.469468 139967107905536 replay_runner.py:39] Average training steps per second: 898522.71
I0910 11:24:00.627977 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:24:00.721414 139967107905536 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 797396.20
I0910 11:24:00.722930 139967107905536 replay_runner.py:39] Average training steps per second: 797396.20
I0910 11:24:00.881125 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:24:00.974853 139967107905536 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 945301.78
I0910 11:24:00.976117 139967107905536 replay_runner.py:39] Average training steps per second: 945301.78
I0910 11:24:01.135567 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:24:01.231925 139967107905536 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 771153.52
I0910 11:24:01.233561 139967107905536 replay_runner.py:39] Average training steps per second: 771153.52
I0910 11:24:01.413105 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:24:01.503886 139967107905536 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 760526.56
I0910 11:24:01.505456 139967107905536 replay_runner.py:39] Average training steps per second: 760526.56
I0910 11:24:01.675783 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:24:01.764821 139967107905536 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 851116.88
I0910 11:24:01.766257 139967107905536 replay_runner.py:39] Average training steps per second: 851116.88
I0910 11:24:01.932277 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:24:02.024681 139967107905536 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 772147.28
I0910 11:24:02.026462 139967107905536 replay_runner.py:39] Average training steps per second: 772147.28
I0910 11:24:02.188619 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:24:02.280866 139967107905536 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 863914.32
I0910 11:24:02.282269 139967107905536 replay_runner.py:39] Average training steps per second: 863914.32
I0910 11:24:02.448081 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:24:02.535966 139967107905536 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 778452.86
I0910 11:24:02.537477 139967107905536 replay_runner.py:39] Average training steps per second: 778452.86
I0910 11:24:02.699109 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:24:02.971358 139967107905536 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 878204.36
I0910 11:24:02.972725 139967107905536 replay_runner.py:39] Average training steps per second: 878204.36
I0910 11:24:03.130111 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:24:03.226881 139967107905536 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 901806.92
I0910 11:24:03.228235 139967107905536 replay_runner.py:39] Average training steps per second: 901806.92
I0910 11:24:03.392030 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:24:03.483258 139967107905536 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 801204.20
I0910 11:24:03.484734 139967107905536 replay_runner.py:39] Average training steps per second: 801204.20
I0910 11:24:03.643541 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:24:03.731370 139967107905536 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 798762.90
I0910 11:24:03.732829 139967107905536 replay_runner.py:39] Average training steps per second: 798762.90
I0910 11:24:03.891341 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:24:03.980817 139967107905536 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 868026.49
I0910 11:24:03.982299 139967107905536 replay_runner.py:39] Average training steps per second: 868026.49
I0910 11:24:04.139080 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:24:04.224539 139967107905536 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 959355.90
I0910 11:24:04.225797 139967107905536 replay_runner.py:39] Average training steps per second: 959355.90
I0910 11:24:04.377954 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:24:04.465330 139967107905536 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 897753.42
I0910 11:24:04.466647 139967107905536 replay_runner.py:39] Average training steps per second: 897753.42
I0910 11:24:04.617123 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:24:04.702037 139967107905536 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 816012.45
I0910 11:24:04.703559 139967107905536 replay_runner.py:39] Average training steps per second: 816012.45

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 27
I0910 11:24:04.946126 139967107905536 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 306444.36
I0910 11:24:04.949695 139967107905536 replay_runner.py:39] Average training steps per second: 306444.36
I0910 11:24:05.103188 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28
I0910 11:24:05.187847 139967107905536 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 946795.49
I0910 11:24:05.189099 139967107905536 replay_runner.py:39] Average training steps per second: 946795.49
I0910 11:24:05.343533 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:24:05.426923 139967107905536 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 889000.42
I0910 11:24:05.428236 139967107905536 replay_runner.py:39] Average training steps per second: 889000.42
I0910 11:24:05.578270 139967107905536 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00