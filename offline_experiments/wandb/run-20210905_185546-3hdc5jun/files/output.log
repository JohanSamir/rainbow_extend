Loaded trained dqn in cartpole
Training fixed agent 2, please be patient, may be a while...
I0905 18:55:52.965750 140076563105792 run_experiment.py:549] Creating TrainRunner ...
I0905 18:55:52.975102 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:52.975343 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:52.975448 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:52.975538 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:52.975615 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:52.975697 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:52.975882 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:52.975976 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:52.976064 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:52.976154 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:52.976240 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:52.976341 140076563105792 dqn_agent.py:283] 	 seed: 1630868152975048
I0905 18:55:52.979159 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:52.979363 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:52.979551 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:52.979823 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:52.980003 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:52.980130 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:52.980248 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:52.980395 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:52.980537 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:53.034430 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.565155 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.580465 140076563105792 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:55:53.589282 140076563105792 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:53.589536 140076563105792 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:53.589692 140076563105792 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:53.589811 140076563105792 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:53.589920 140076563105792 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:53.590044 140076563105792 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:53.590182 140076563105792 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:53.590362 140076563105792 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:53.590502 140076563105792 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:53.590646 140076563105792 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:53.590810 140076563105792 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:53.590935 140076563105792 dqn_agent.py:283] 	 seed: 1630868153589228
I0905 18:55:53.593594 140076563105792 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:53.593769 140076563105792 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 18:55:53.593902 140076563105792 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:53.594017 140076563105792 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:53.594159 140076563105792 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:53.594378 140076563105792 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:53.594540 140076563105792 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:53.594655 140076563105792 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:53.594825 140076563105792 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:53.644938 140076563105792 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:53.676278 140076563105792 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:55:53.676563 140076563105792 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 120.86
I0905 18:56:01.950769 140076563105792 replay_runner.py:36] Average training steps per second: 120.86
Steps executed: 203 Episode length: 9 Return: 9.0.0
I0905 18:56:03.431037 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.67
INFO:tensorflow:Starting iteration 1

Steps executed: 212 Episode length: 28 Return: 28.0
INFO:tensorflow:Average training steps per second: 171.43
I0905 18:56:09.473200 140076563105792 replay_runner.py:36] Average training steps per second: 171.43
I0905 18:56:09.714471 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 30.29
INFO:tensorflow:Starting iteration 2

Steps executed: 173 Episode length: 173 Return: 173.0
INFO:tensorflow:Average training steps per second: 157.42

Steps executed: 373 Episode length: 200 Return: 200.0
I0905 18:56:16.703953 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.50
INFO:tensorflow:Starting iteration 3

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 159.07
I0905 18:56:23.214093 140076563105792 replay_runner.py:36] Average training steps per second: 159.07
I0905 18:56:23.446979 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0905 18:56:23.665751 140076563105792 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 160.99
I0905 18:56:29.877977 140076563105792 replay_runner.py:36] Average training steps per second: 160.99
I0905 18:56:30.116985 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 190 Episode length: 92 Return: 92.0.0
INFO:tensorflow:Average training steps per second: 164.94

Steps executed: 283 Episode length: 93 Return: 93.0.0
I0905 18:56:36.749552 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 94.33
INFO:tensorflow:Starting iteration 6

Steps executed: 239 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 158.05
I0905 18:56:43.283785 140076563105792 replay_runner.py:36] Average training steps per second: 158.05
I0905 18:56:43.579964 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 119.50
INFO:tensorflow:Starting iteration 7

Steps executed: 228 Episode length: 117 Return: 117.0
INFO:tensorflow:Average training steps per second: 158.56
I0905 18:56:50.140778 140076563105792 replay_runner.py:36] Average training steps per second: 158.56
I0905 18:56:50.425542 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 114.00
INFO:tensorflow:Starting iteration 8
I0905 18:56:50.667598 140076563105792 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 166.09

Steps executed: 213 Episode length: 102 Return: 102.0
I0905 18:56:56.965021 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 106.50
INFO:tensorflow:Starting iteration 9

Steps executed: 218 Episode length: 107 Return: 107.0
INFO:tensorflow:Average training steps per second: 153.77
I0905 18:57:03.691831 140076563105792 replay_runner.py:36] Average training steps per second: 153.77
I0905 18:57:03.969210 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 109.00
INFO:tensorflow:Starting iteration 10

Steps executed: 285 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 161.01
I0905 18:57:10.385313 140076563105792 replay_runner.py:36] Average training steps per second: 161.01
I0905 18:57:10.760091 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 142.50
INFO:tensorflow:Starting iteration 11

Steps executed: 328 Episode length: 176 Return: 176.0
INFO:tensorflow:Average training steps per second: 151.32
I0905 18:57:17.609713 140076563105792 replay_runner.py:36] Average training steps per second: 151.32
I0905 18:57:18.055154 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 164.00
INFO:tensorflow:Starting iteration 12

Steps executed: 136 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 158.92

Steps executed: 273 Episode length: 137 Return: 137.0
I0905 18:57:24.956935 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 136.50
INFO:tensorflow:Starting iteration 13

Steps executed: 292 Episode length: 147 Return: 147.0
INFO:tensorflow:Average training steps per second: 150.14
I0905 18:57:31.938671 140076563105792 replay_runner.py:36] Average training steps per second: 150.14
I0905 18:57:32.273324 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 146.00
INFO:tensorflow:Starting iteration 14

Steps executed: 326 Episode length: 179 Return: 179.0
INFO:tensorflow:Average training steps per second: 152.18
I0905 18:57:39.046014 140076563105792 replay_runner.py:36] Average training steps per second: 152.18
I0905 18:57:39.520495 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.00
INFO:tensorflow:Starting iteration 15

Steps executed: 303 Episode length: 162 Return: 162.0
INFO:tensorflow:Average training steps per second: 155.29
I0905 18:57:46.215997 140076563105792 replay_runner.py:36] Average training steps per second: 155.29
I0905 18:57:46.576869 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 16

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 151.65
I0905 18:57:53.419358 140076563105792 replay_runner.py:36] Average training steps per second: 151.65
I0905 18:57:53.682328 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 17
I0905 18:57:53.930258 140076563105792 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 158.46
I0905 18:58:00.241793 140076563105792 replay_runner.py:36] Average training steps per second: 158.46
I0905 18:58:00.529195 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 18:58:00.782415 140076563105792 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 150.47
I0905 18:58:07.428684 140076563105792 replay_runner.py:36] Average training steps per second: 150.47
I0905 18:58:07.695345 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19

Steps executed: 302 Episode length: 145 Return: 145.0
INFO:tensorflow:Average training steps per second: 157.73
I0905 18:58:14.272902 140076563105792 replay_runner.py:36] Average training steps per second: 157.73
I0905 18:58:14.631266 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.00
INFO:tensorflow:Starting iteration 20

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 151.83
I0905 18:58:21.413025 140076563105792 replay_runner.py:36] Average training steps per second: 151.83
I0905 18:58:21.724006 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 378 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 158.34
I0905 18:58:28.268380 140076563105792 replay_runner.py:36] Average training steps per second: 158.34
I0905 18:58:28.751278 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 189.00
INFO:tensorflow:Starting iteration 22

Steps executed: 398 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 149.49
I0905 18:58:35.683726 140076563105792 replay_runner.py:36] Average training steps per second: 149.49
I0905 18:58:36.244641 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 199.00
INFO:tensorflow:Starting iteration 23

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 180.16
I0905 18:58:42.041308 140076563105792 replay_runner.py:36] Average training steps per second: 180.16
I0905 18:58:42.286692 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0905 18:58:42.521657 140076563105792 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 164.73
I0905 18:58:48.592625 140076563105792 replay_runner.py:36] Average training steps per second: 164.73
I0905 18:58:48.864058 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0905 18:58:49.103095 140076563105792 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 152.10
I0905 18:58:55.678148 140076563105792 replay_runner.py:36] Average training steps per second: 152.10
I0905 18:58:55.946647 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26

Steps executed: 380 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 171.32
I0905 18:59:02.020733 140076563105792 replay_runner.py:36] Average training steps per second: 171.32
I0905 18:59:02.518989 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 190.00
INFO:tensorflow:Starting iteration 27
I0905 18:59:02.759636 140076563105792 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 155.20

Steps executed: 200 Episode length: 200 Return: 200.0
I0905 18:59:09.412647 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0905 18:59:09.643211 140076563105792 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 168.62
I0905 18:59:15.574954 140076563105792 replay_runner.py:36] Average training steps per second: 168.62
I0905 18:59:15.814715 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 189 Return: 189.0
INFO:tensorflow:Average training steps per second: 165.05
I0905 18:59:22.121174 140076563105792 replay_runner.py:36] Average training steps per second: 165.05
I0905 18:59:22.449198 140076563105792 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.00