I0910 11:21:36.749555 139776518731776 run_experiment.py:549] Creating TrainRunner ...
I0910 11:21:36.759202 139776518731776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:36.759414 139776518731776 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:36.759541 139776518731776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:36.759648 139776518731776 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:36.759750 139776518731776 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:36.759875 139776518731776 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:36.760029 139776518731776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:36.760170 139776518731776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:36.760272 139776518731776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:36.760402 139776518731776 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:36.760509 139776518731776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:36.760609 139776518731776 dqn_agent.py:283] 	 seed: 1631272896759152
I0910 11:21:36.763320 139776518731776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:36.763510 139776518731776 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:36.763634 139776518731776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:36.763744 139776518731776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:36.763843 139776518731776 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:36.763945 139776518731776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:36.764043 139776518731776 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:36.764138 139776518731776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:36.764237 139776518731776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:36.806619 139776518731776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:36.837736 139776518731776 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0910 11:21:36.837972 139776518731776 dqn_agent.py:272] 	 gamma: 0.990000
I0910 11:21:36.838097 139776518731776 dqn_agent.py:273] 	 update_horizon: 1.000000
I0910 11:21:36.838204 139776518731776 dqn_agent.py:274] 	 min_replay_history: 500
I0910 11:21:36.838307 139776518731776 dqn_agent.py:275] 	 update_period: 4
I0910 11:21:36.838417 139776518731776 dqn_agent.py:276] 	 target_update_period: 100
I0910 11:21:36.838516 139776518731776 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0910 11:21:36.838614 139776518731776 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0910 11:21:36.838714 139776518731776 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0910 11:21:36.838811 139776518731776 dqn_agent.py:280] 	 optimizer: adam
I0910 11:21:36.838906 139776518731776 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0910 11:21:36.839001 139776518731776 dqn_agent.py:283] 	 seed: 1631272896837682
I0910 11:21:36.840781 139776518731776 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0910 11:21:36.840901 139776518731776 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0910 11:21:36.840971 139776518731776 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0910 11:21:36.841032 139776518731776 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0910 11:21:36.841101 139776518731776 circular_replay_buffer.py:159] 	 stack_size: 1
I0910 11:21:36.841178 139776518731776 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0910 11:21:36.841234 139776518731776 circular_replay_buffer.py:161] 	 batch_size: 128
I0910 11:21:36.841314 139776518731776 circular_replay_buffer.py:162] 	 update_horizon: 1
I0910 11:21:36.841413 139776518731776 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0910 11:21:36.865609 139776518731776 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0910 11:21:36.881499 139776518731776 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0910 11:21:36.881671 139776518731776 replay_runner.py:44] Starting iteration 0
INFO:tensorflow:Average training steps per second: 837520.77
I0910 11:21:36.883047 139776518731776 replay_runner.py:39] Average training steps per second: 837520.77
I0910 11:21:37.780790 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0910 11:21:37.828451 139776518731776 replay_runner.py:44] Starting iteration 1
INFO:tensorflow:Average training steps per second: 798915.05
I0910 11:21:37.829919 139776518731776 replay_runner.py:39] Average training steps per second: 798915.05
I0910 11:21:38.016777 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0910 11:21:38.057653 139776518731776 replay_runner.py:44] Starting iteration 2
INFO:tensorflow:Average training steps per second: 841891.61
I0910 11:21:38.059087 139776518731776 replay_runner.py:39] Average training steps per second: 841891.61
I0910 11:21:38.236216 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
Loaded trained dqn in mountaincar
Training fixed agent 10, please be patient, may be a while...
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 3
I0910 11:21:38.279090 139776518731776 replay_runner.py:44] Starting iteration 3
INFO:tensorflow:Average training steps per second: 810493.53
I0910 11:21:38.280608 139776518731776 replay_runner.py:39] Average training steps per second: 810493.53
I0910 11:21:38.455745 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0910 11:21:38.495442 139776518731776 replay_runner.py:44] Starting iteration 4
INFO:tensorflow:Average training steps per second: 776866.83
I0910 11:21:38.496956 139776518731776 replay_runner.py:39] Average training steps per second: 776866.83
I0910 11:21:38.670349 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0910 11:21:38.712942 139776518731776 replay_runner.py:44] Starting iteration 5
INFO:tensorflow:Average training steps per second: 859136.42
I0910 11:21:38.714325 139776518731776 replay_runner.py:39] Average training steps per second: 859136.42
I0910 11:21:38.937342 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0910 11:21:38.978673 139776518731776 replay_runner.py:44] Starting iteration 6
INFO:tensorflow:Average training steps per second: 793024.01
I0910 11:21:38.980161 139776518731776 replay_runner.py:39] Average training steps per second: 793024.01
I0910 11:21:39.162642 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0910 11:21:39.205989 139776518731776 replay_runner.py:44] Starting iteration 7
INFO:tensorflow:Average training steps per second: 798610.81
I0910 11:21:39.207497 139776518731776 replay_runner.py:39] Average training steps per second: 798610.81
I0910 11:21:39.388154 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0910 11:21:39.429725 139776518731776 replay_runner.py:44] Starting iteration 8
INFO:tensorflow:Average training steps per second: 800745.32
I0910 11:21:39.431209 139776518731776 replay_runner.py:39] Average training steps per second: 800745.32
I0910 11:21:39.603042 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0910 11:21:39.644671 139776518731776 replay_runner.py:44] Starting iteration 9
INFO:tensorflow:Average training steps per second: 816489.00
I0910 11:21:39.646152 139776518731776 replay_runner.py:39] Average training steps per second: 816489.00
I0910 11:21:39.872537 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0910 11:21:39.916954 139776518731776 replay_runner.py:44] Starting iteration 10
INFO:tensorflow:Average training steps per second: 800134.30
I0910 11:21:39.918432 139776518731776 replay_runner.py:39] Average training steps per second: 800134.30
I0910 11:21:40.102873 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0910 11:21:40.144225 139776518731776 replay_runner.py:44] Starting iteration 11
INFO:tensorflow:Average training steps per second: 801816.86
I0910 11:21:40.145725 139776518731776 replay_runner.py:39] Average training steps per second: 801816.86
I0910 11:21:40.322960 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12
I0910 11:21:40.364439 139776518731776 replay_runner.py:44] Starting iteration 12
INFO:tensorflow:Average training steps per second: 792724.25
I0910 11:21:40.365965 139776518731776 replay_runner.py:39] Average training steps per second: 792724.25
I0910 11:21:40.542675 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 13
I0910 11:21:40.586765 139776518731776 replay_runner.py:44] Starting iteration 13
INFO:tensorflow:Average training steps per second: 711743.42
I0910 11:21:40.588427 139776518731776 replay_runner.py:39] Average training steps per second: 711743.42
I0910 11:21:40.778635 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 14
I0910 11:21:40.821552 139776518731776 replay_runner.py:44] Starting iteration 14
INFO:tensorflow:Average training steps per second: 791676.86
I0910 11:21:40.823043 139776518731776 replay_runner.py:39] Average training steps per second: 791676.86
I0910 11:21:41.028608 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 15
I0910 11:21:41.075098 139776518731776 replay_runner.py:44] Starting iteration 15
INFO:tensorflow:Average training steps per second: 811905.54
I0910 11:21:41.076566 139776518731776 replay_runner.py:39] Average training steps per second: 811905.54
I0910 11:21:41.299446 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16
I0910 11:21:41.349020 139776518731776 replay_runner.py:44] Starting iteration 16
INFO:tensorflow:Average training steps per second: 697771.42
I0910 11:21:41.350695 139776518731776 replay_runner.py:39] Average training steps per second: 697771.42
I0910 11:21:41.549803 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 17
I0910 11:21:41.594086 139776518731776 replay_runner.py:44] Starting iteration 17
INFO:tensorflow:Average training steps per second: 699050.67
I0910 11:21:41.595788 139776518731776 replay_runner.py:39] Average training steps per second: 699050.67
I0910 11:21:41.804348 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 18
I0910 11:21:41.845677 139776518731776 replay_runner.py:44] Starting iteration 18
INFO:tensorflow:Average training steps per second: 805203.30
I0910 11:21:41.847164 139776518731776 replay_runner.py:39] Average training steps per second: 805203.30
I0910 11:21:42.064547 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 19
I0910 11:21:42.117816 139776518731776 replay_runner.py:44] Starting iteration 19
INFO:tensorflow:Average training steps per second: 834521.29
I0910 11:21:42.119261 139776518731776 replay_runner.py:39] Average training steps per second: 834521.29
I0910 11:21:42.321713 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 20
I0910 11:21:42.364532 139776518731776 replay_runner.py:44] Starting iteration 20
INFO:tensorflow:Average training steps per second: 662921.45
I0910 11:21:42.366300 139776518731776 replay_runner.py:39] Average training steps per second: 662921.45
I0910 11:21:42.562740 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 21
I0910 11:21:42.613617 139776518731776 replay_runner.py:44] Starting iteration 21
INFO:tensorflow:Average training steps per second: 728557.23
I0910 11:21:42.615252 139776518731776 replay_runner.py:39] Average training steps per second: 728557.23
I0910 11:21:42.812739 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 22
I0910 11:21:42.859699 139776518731776 replay_runner.py:44] Starting iteration 22
INFO:tensorflow:Average training steps per second: 795581.18
I0910 11:21:42.861212 139776518731776 replay_runner.py:39] Average training steps per second: 795581.18
I0910 11:21:43.123769 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23
I0910 11:21:43.165292 139776518731776 replay_runner.py:44] Starting iteration 23
INFO:tensorflow:Average training steps per second: 777875.37
I0910 11:21:43.166852 139776518731776 replay_runner.py:39] Average training steps per second: 777875.37
I0910 11:21:43.362096 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 24
I0910 11:21:43.403847 139776518731776 replay_runner.py:44] Starting iteration 24
INFO:tensorflow:Average training steps per second: 787662.72
I0910 11:21:43.405362 139776518731776 replay_runner.py:39] Average training steps per second: 787662.72
I0910 11:21:43.588758 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 25
I0910 11:21:43.630251 139776518731776 replay_runner.py:44] Starting iteration 25
INFO:tensorflow:Average training steps per second: 790632.23
I0910 11:21:43.631809 139776518731776 replay_runner.py:39] Average training steps per second: 790632.23
I0910 11:21:43.815965 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0910 11:21:43.870590 139776518731776 replay_runner.py:44] Starting iteration 26
INFO:tensorflow:Average training steps per second: 587437.54
I0910 11:21:43.872608 139776518731776 replay_runner.py:39] Average training steps per second: 587437.54
I0910 11:21:44.094648 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0910 11:21:44.137505 139776518731776 replay_runner.py:44] Starting iteration 27
INFO:tensorflow:Average training steps per second: 773714.07
I0910 11:21:44.139056 139776518731776 replay_runner.py:39] Average training steps per second: 773714.07

Done fixed training!Episode length: 600 Return: -600.0
INFO:tensorflow:Starting iteration 28
I0910 11:21:44.367887 139776518731776 replay_runner.py:44] Starting iteration 28
INFO:tensorflow:Average training steps per second: 767203.95
I0910 11:21:44.369453 139776518731776 replay_runner.py:39] Average training steps per second: 767203.95
I0910 11:21:44.558088 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 29
I0910 11:21:44.601191 139776518731776 replay_runner.py:44] Starting iteration 29
INFO:tensorflow:Average training steps per second: 775287.25
I0910 11:21:44.602731 139776518731776 replay_runner.py:39] Average training steps per second: 775287.25
I0910 11:21:44.890894 139776518731776 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00