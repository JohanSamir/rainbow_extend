Loaded trained dqn in lunarlander
Training fixed agent 1, please be patient, may be a while...
I0902 18:10:13.644257 140451420674048 run_experiment.py:549] Creating TrainRunner ...
I0902 18:10:13.656294 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:10:13.656635 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:10:13.656906 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:10:13.657084 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:10:13.657217 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:10:13.657318 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:10:13.657446 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:10:13.657632 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:10:13.657983 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:10:13.658416 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:10:13.658611 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:10:13.658818 140451420674048 dqn_agent.py:283] 	 seed: 1630606213656205
I0902 18:10:13.661744 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:10:13.661911 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:10:13.662074 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:10:13.662220 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:10:13.662348 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:10:13.662425 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:10:13.662624 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:10:13.662955 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:10:13.663047 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:10:13.701817 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:14.111249 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:14.127921 140451420674048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:10:14.156515 140451420674048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:10:14.156865 140451420674048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:10:14.157044 140451420674048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:10:14.157485 140451420674048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:10:14.157670 140451420674048 dqn_agent.py:275] 	 update_period: 4
I0902 18:10:14.157853 140451420674048 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:10:14.157978 140451420674048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:10:14.158064 140451420674048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:10:14.158151 140451420674048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:10:14.158267 140451420674048 dqn_agent.py:280] 	 optimizer: adam
I0902 18:10:14.158397 140451420674048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:10:14.158626 140451420674048 dqn_agent.py:283] 	 seed: 1630606214156454
I0902 18:10:14.161900 140451420674048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:10:14.162137 140451420674048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:10:14.162324 140451420674048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:10:14.162443 140451420674048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:10:14.162575 140451420674048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:10:14.162738 140451420674048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:10:14.162865 140451420674048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:10:14.162981 140451420674048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:10:14.163090 140451420674048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:10:14.195463 140451420674048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.031250
I0902 18:10:14.218577 140451420674048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:10:14.218901 140451420674048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.42
I0902 18:10:20.338409 140451420674048 replay_runner.py:36] Average training steps per second: 163.42
Steps executed: 207 Episode length: 207 Return: -293.60090660673507
I0902 18:10:21.920346 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -293.60
INFO:tensorflow:Starting iteration 1

Steps executed: 218 Episode length: 113 Return: -146.58154421039023
INFO:tensorflow:Average training steps per second: 219.06
I0902 18:10:30.901722 140451420674048 replay_runner.py:36] Average training steps per second: 219.06
I0902 18:10:31.100914 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.17
INFO:tensorflow:Starting iteration 2

Steps executed: 206 Episode length: 206 Return: -34.934206649722356
INFO:tensorflow:Average training steps per second: 222.51
I0902 18:10:40.061212 140451420674048 replay_runner.py:36] Average training steps per second: 222.51
I0902 18:10:40.292681 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -34.93
INFO:tensorflow:Starting iteration 3

Steps executed: 305 Episode length: 126 Return: -261.50731183893976
INFO:tensorflow:Average training steps per second: 225.97
I0902 18:10:49.066063 140451420674048 replay_runner.py:36] Average training steps per second: 225.97
I0902 18:10:49.337951 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.22
INFO:tensorflow:Starting iteration 4

Steps executed: 323 Episode length: 236 Return: -5.6709714264933176
INFO:tensorflow:Average training steps per second: 234.75
I0902 18:10:57.926423 140451420674048 replay_runner.py:36] Average training steps per second: 234.75
I0902 18:10:58.254416 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -257.96
INFO:tensorflow:Starting iteration 5

Steps executed: 288 Episode length: 100 Return: -270.21623875037326
INFO:tensorflow:Average training steps per second: 242.79
I0902 18:11:06.582521 140451420674048 replay_runner.py:36] Average training steps per second: 242.79
I0902 18:11:06.801046 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -315.11
INFO:tensorflow:Starting iteration 6

Steps executed: 248 Episode length: 123 Return: -375.31528090140284
INFO:tensorflow:Average training steps per second: 255.55
I0902 18:11:14.835616 140451420674048 replay_runner.py:36] Average training steps per second: 255.55
I0902 18:11:15.046865 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.50
INFO:tensorflow:Starting iteration 7

Steps executed: 249 Episode length: 97 Return: -591.015338751912284
INFO:tensorflow:Average training steps per second: 262.92
I0902 18:11:22.862456 140451420674048 replay_runner.py:36] Average training steps per second: 262.92
I0902 18:11:23.033626 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -479.27
INFO:tensorflow:Starting iteration 8

Steps executed: 203 Episode length: 115 Return: -258.35999893205246
INFO:tensorflow:Average training steps per second: 263.02
I0902 18:11:30.840877 140451420674048 replay_runner.py:36] Average training steps per second: 263.02
I0902 18:11:30.981767 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.25
INFO:tensorflow:Starting iteration 9

Steps executed: 295 Episode length: 125 Return: -393.62733590342566
INFO:tensorflow:Average training steps per second: 269.27
I0902 18:11:38.686146 140451420674048 replay_runner.py:36] Average training steps per second: 269.27
I0902 18:11:38.889402 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -412.65
INFO:tensorflow:Starting iteration 10

Steps executed: 257 Episode length: 139 Return: -143.37235746999966
INFO:tensorflow:Average training steps per second: 280.46
I0902 18:11:46.439399 140451420674048 replay_runner.py:36] Average training steps per second: 280.46
I0902 18:11:46.629918 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -167.78
INFO:tensorflow:Starting iteration 11

Steps executed: 201 Episode length: 83 Return: -288.866111843497386
INFO:tensorflow:Average training steps per second: 294.46
I0902 18:11:53.937370 140451420674048 replay_runner.py:36] Average training steps per second: 294.46
I0902 18:11:54.069455 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.50
INFO:tensorflow:Starting iteration 12

Steps executed: 209 Episode length: 112 Return: -167.27911938001636
INFO:tensorflow:Average training steps per second: 304.71
I0902 18:12:01.010869 140451420674048 replay_runner.py:36] Average training steps per second: 304.71
I0902 18:12:01.150276 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.84
INFO:tensorflow:Starting iteration 13
I0902 18:12:04.705095 140451420674048 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 329.56

Steps executed: 367 Episode length: 264 Return: -158.69797155325557
I0902 18:12:08.042047 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -171.30
INFO:tensorflow:Starting iteration 14

Steps executed: 373 Episode length: 281 Return: -303.75962730683147
INFO:tensorflow:Average training steps per second: 334.12
I0902 18:12:14.586182 140451420674048 replay_runner.py:36] Average training steps per second: 334.12
I0902 18:12:14.889105 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -254.31
INFO:tensorflow:Starting iteration 15

Steps executed: 220 Episode length: 220 Return: -373.64311378082965
INFO:tensorflow:Average training steps per second: 340.57
I0902 18:12:21.285680 140451420674048 replay_runner.py:36] Average training steps per second: 340.57
I0902 18:12:21.449972 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.64
INFO:tensorflow:Starting iteration 16
I0902 18:12:24.918783 140451420674048 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 342.22

Steps executed: 459 Episode length: 459 Return: -2468.4229766612055
I0902 18:12:28.427823 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -2468.42
INFO:tensorflow:Starting iteration 17
I0902 18:12:31.816118 140451420674048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 330.26
I0902 18:12:34.844362 140451420674048 replay_runner.py:36] Average training steps per second: 330.26

Steps executed: 689 Episode length: 689 Return: -225.85788310818775
INFO:tensorflow:Starting iteration 18

Steps executed: 402 Episode length: 402 Return: -181.46593635838363
INFO:tensorflow:Average training steps per second: 327.50
I0902 18:12:42.322950 140451420674048 replay_runner.py:36] Average training steps per second: 327.50
I0902 18:12:42.780436 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.47
INFO:tensorflow:Starting iteration 19

Steps executed: 209 Episode length: 80 Return: -212.944473174046677
INFO:tensorflow:Average training steps per second: 331.45
I0902 18:12:49.171372 140451420674048 replay_runner.py:36] Average training steps per second: 331.45
I0902 18:12:49.287303 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -239.92
INFO:tensorflow:Starting iteration 20

Steps executed: 84 Episode length: 84 Return: -293.9907852688984377
INFO:tensorflow:Average training steps per second: 331.29


Steps executed: 1044 Episode length: 890 Return: 134.60463524576577
I0902 18:12:57.908498 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.17
INFO:tensorflow:Starting iteration 21
I0902 18:13:01.277982 140451420674048 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 342.94

Steps executed: 1000 Episode length: 1000 Return: -32.26413559705619
I0902 18:13:05.969291 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -32.26
INFO:tensorflow:Starting iteration 22

Steps executed: 202 Episode length: 63 Return: -227.2900736567091819
INFO:tensorflow:Average training steps per second: 341.28
I0902 18:13:12.187129 140451420674048 replay_runner.py:36] Average training steps per second: 341.28
I0902 18:13:12.292018 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -168.70
INFO:tensorflow:Starting iteration 23

Steps executed: 304 Episode length: 160 Return: -360.658564704802649
INFO:tensorflow:Average training steps per second: 342.36
I0902 18:13:18.650584 140451420674048 replay_runner.py:36] Average training steps per second: 342.36
I0902 18:13:18.841997 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -172.92
INFO:tensorflow:Starting iteration 24

Steps executed: 283 Episode length: 170 Return: -260.929714365931559
INFO:tensorflow:Average training steps per second: 340.36
I0902 18:13:25.217127 140451420674048 replay_runner.py:36] Average training steps per second: 340.36
I0902 18:13:25.409962 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.53
INFO:tensorflow:Starting iteration 25

Steps executed: 207 Episode length: 99 Return: -217.7372567713911269
INFO:tensorflow:Average training steps per second: 335.49
I0902 18:13:31.818687 140451420674048 replay_runner.py:36] Average training steps per second: 335.49
I0902 18:13:31.921574 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.27
INFO:tensorflow:Starting iteration 26

Steps executed: 131 Episode length: 131 Return: 44.29036547008007669
INFO:tensorflow:Average training steps per second: 336.01

Steps executed: 1131 Episode length: 1000 Return: -76.23724655394483
I0902 18:13:40.149677 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.97
INFO:tensorflow:Starting iteration 27

Steps executed: 215 Episode length: 118 Return: -86.4654411935054883
INFO:tensorflow:Average training steps per second: 333.78
I0902 18:13:46.344992 140451420674048 replay_runner.py:36] Average training steps per second: 333.78
I0902 18:13:46.462202 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -138.92
INFO:tensorflow:Starting iteration 28

Steps executed: 298 Episode length: 200 Return: -305.601702894169583
INFO:tensorflow:Average training steps per second: 356.79
I0902 18:13:52.253329 140451420674048 replay_runner.py:36] Average training steps per second: 356.79
I0902 18:13:52.401301 140451420674048 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.27
INFO:tensorflow:Starting iteration 29

Steps executed: 290 Episode length: 183 Return: -226.007653542065473
INFO:tensorflow:Average training steps per second: 373.87
I0902 18:13:58.319232 140451420674048 replay_runner.py:36] Average training steps per second: 373.87

Done fixed training!Episode length: 183 Return: -226.007653542065473