Loaded trained dqn in lunarlander
Training fixed agent 4, please be patient, may be a while...
I0902 23:46:04.699450 140310902786048 run_experiment.py:549] Creating TrainRunner ...
I0902 23:46:04.711466 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:04.711770 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:04.711935 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:04.712052 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:04.712161 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:04.712260 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:46:04.712386 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:04.712496 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:04.712671 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:04.712793 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:04.712895 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:04.713066 140310902786048 dqn_agent.py:283] 	 seed: 1630626364711401
I0902 23:46:04.716206 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:04.716451 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:46:04.716609 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:04.716732 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:04.716861 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:04.716956 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:04.717046 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:04.717135 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:04.717223 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:04.757416 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:05.159722 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:05.176070 140310902786048 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:46:05.208572 140310902786048 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:05.208859 140310902786048 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:05.209032 140310902786048 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:05.209461 140310902786048 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:05.209685 140310902786048 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:05.209895 140310902786048 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:46:05.210059 140310902786048 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:05.210185 140310902786048 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:05.210291 140310902786048 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:05.210397 140310902786048 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:05.210512 140310902786048 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:05.210647 140310902786048 dqn_agent.py:283] 	 seed: 1630626365208519
I0902 23:46:05.214187 140310902786048 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:05.214420 140310902786048 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:46:05.214563 140310902786048 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:05.214702 140310902786048 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:05.214827 140310902786048 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:05.215045 140310902786048 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:05.215188 140310902786048 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:05.215311 140310902786048 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:05.215460 140310902786048 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:05.250400 140310902786048 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:05.273701 140310902786048 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:46:05.274102 140310902786048 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 163.68
I0902 23:46:11.383983 140310902786048 replay_runner.py:36] Average training steps per second: 163.68
I0902 23:46:12.673259 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -370.12
Steps executed: 240 Episode length: 133 Return: -407.96066671810053
INFO:tensorflow:Starting iteration 1

Steps executed: 156 Episode length: 156 Return: -321.74246324480513
INFO:tensorflow:Average training steps per second: 229.20
I0902 23:46:21.559162 140310902786048 replay_runner.py:36] Average training steps per second: 229.20

Steps executed: 595 Episode length: 439 Return: -147.94067135285954
INFO:tensorflow:Starting iteration 2
I0902 23:46:26.765392 140310902786048 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 227.51
I0902 23:46:31.161311 140310902786048 replay_runner.py:36] Average training steps per second: 227.51

Steps executed: 302 Episode length: 134 Return: -90.325637567542875
INFO:tensorflow:Starting iteration 3

Steps executed: 284 Episode length: 97 Return: -464.874912791578655
INFO:tensorflow:Average training steps per second: 227.68
I0902 23:46:40.154939 140310902786048 replay_runner.py:36] Average training steps per second: 227.68
I0902 23:46:40.376881 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -444.30
INFO:tensorflow:Starting iteration 4

Steps executed: 238 Episode length: 110 Return: -536.89567211817315
INFO:tensorflow:Average training steps per second: 225.97
I0902 23:46:49.176731 140310902786048 replay_runner.py:36] Average training steps per second: 225.97
I0902 23:46:49.381516 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -532.66
INFO:tensorflow:Starting iteration 5
I0902 23:46:53.710402 140310902786048 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 228.35

Steps executed: 1000 Episode length: 1000 Return: -15.625561086261984
I0902 23:47:00.998444 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -15.63
INFO:tensorflow:Starting iteration 6

Steps executed: 553 Episode length: 393 Return: -520.6926909874944684
INFO:tensorflow:Average training steps per second: 226.05
I0902 23:47:09.739955 140310902786048 replay_runner.py:36] Average training steps per second: 226.05
I0902 23:47:10.397964 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -361.01
INFO:tensorflow:Starting iteration 7

Steps executed: 273 Episode length: 273 Return: -17.93504499453266684
INFO:tensorflow:Average training steps per second: 226.40
I0902 23:47:19.110235 140310902786048 replay_runner.py:36] Average training steps per second: 226.40
I0902 23:47:19.422860 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -17.94
INFO:tensorflow:Starting iteration 8

Steps executed: 117 Episode length: 58 Return: -320.95875772527415684
INFO:tensorflow:Average training steps per second: 224.34

Steps executed: 1102 Episode length: 985 Return: -406.500748157035784
I0902 23:47:31.251774 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -350.37
INFO:tensorflow:Starting iteration 9
I0902 23:47:35.591339 140310902786048 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 226.83

Steps executed: 1000 Episode length: 1000 Return: -110.58893390294372
I0902 23:47:43.407749 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.59
INFO:tensorflow:Starting iteration 10

Steps executed: 293 Episode length: 293 Return: -323.7777196977109572
INFO:tensorflow:Average training steps per second: 226.76
I0902 23:47:52.152591 140310902786048 replay_runner.py:36] Average training steps per second: 226.76
I0902 23:47:52.533776 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.78
INFO:tensorflow:Starting iteration 11
I0902 23:47:56.942696 140310902786048 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 223.39

Steps executed: 1000 Episode length: 1000 Return: -90.924800443945532
I0902 23:48:04.520502 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.92
INFO:tensorflow:Starting iteration 12

Steps executed: 287 Episode length: 287 Return: -116.2071412372309432
INFO:tensorflow:Average training steps per second: 224.20
I0902 23:48:13.409535 140310902786048 replay_runner.py:36] Average training steps per second: 224.20
I0902 23:48:13.742780 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.21
INFO:tensorflow:Starting iteration 13

Steps executed: 187 Episode length: 187 Return: -63.24233918369001432
INFO:tensorflow:Average training steps per second: 222.13
I0902 23:48:22.596887 140310902786048 replay_runner.py:36] Average training steps per second: 222.13

Steps executed: 351 Episode length: 164 Return: -117.4843748976269232
INFO:tensorflow:Starting iteration 14

Steps executed: 406 Episode length: 247 Return: -236.0410904274567232
INFO:tensorflow:Average training steps per second: 223.63
I0902 23:48:31.617931 140310902786048 replay_runner.py:36] Average training steps per second: 223.63
I0902 23:48:32.056019 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.75
INFO:tensorflow:Starting iteration 15
I0902 23:48:36.454146 140310902786048 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 226.07

Steps executed: 576 Episode length: 418 Return: -168.8041551773639232
I0902 23:48:41.789705 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.52
INFO:tensorflow:Starting iteration 16

Steps executed: 271 Episode length: 124 Return: -673.4846333484504832
INFO:tensorflow:Average training steps per second: 224.17
I0902 23:48:50.585214 140310902786048 replay_runner.py:36] Average training steps per second: 224.17
I0902 23:48:50.864161 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -387.53
INFO:tensorflow:Starting iteration 17
I0902 23:48:55.144979 140310902786048 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 229.06

Steps executed: 1000 Episode length: 1000 Return: -77.081104644893072
I0902 23:49:02.989864 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.08
INFO:tensorflow:Starting iteration 18

Steps executed: 254 Episode length: 183 Return: -71.69374478177261072
INFO:tensorflow:Average training steps per second: 219.58
I0902 23:49:11.888819 140310902786048 replay_runner.py:36] Average training steps per second: 219.58
I0902 23:49:12.118342 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.42
INFO:tensorflow:Starting iteration 19

Steps executed: 234 Episode length: 106 Return: -350.1895536504892072
INFO:tensorflow:Average training steps per second: 221.11
I0902 23:49:21.007078 140310902786048 replay_runner.py:36] Average training steps per second: 221.11
I0902 23:49:21.189843 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.67
INFO:tensorflow:Starting iteration 20

Steps executed: 428 Episode length: 292 Return: -73.29764021459297072
INFO:tensorflow:Average training steps per second: 223.55
I0902 23:49:29.772225 140310902786048 replay_runner.py:36] Average training steps per second: 223.55
I0902 23:49:30.245235 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.75
INFO:tensorflow:Starting iteration 21

Steps executed: 337 Episode length: 173 Return: -186.8096787307137672
INFO:tensorflow:Average training steps per second: 229.32
I0902 23:49:38.959999 140310902786048 replay_runner.py:36] Average training steps per second: 229.32
I0902 23:49:39.208739 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.24
INFO:tensorflow:Starting iteration 22

Steps executed: 207 Episode length: 107 Return: -264.4702811242254672
INFO:tensorflow:Average training steps per second: 219.50
I0902 23:49:47.985425 140310902786048 replay_runner.py:36] Average training steps per second: 219.50
I0902 23:49:48.151049 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.52
INFO:tensorflow:Starting iteration 23

Steps executed: 110 Episode length: 110 Return: -585.4436182195741672
INFO:tensorflow:Average training steps per second: 225.15
I0902 23:49:56.777726 140310902786048 replay_runner.py:36] Average training steps per second: 225.15

Steps executed: 256 Episode length: 146 Return: -483.2920149538464372
INFO:tensorflow:Starting iteration 24

Steps executed: 205 Episode length: 115 Return: -98.47058285262989372
INFO:tensorflow:Average training steps per second: 227.11
I0902 23:50:05.766534 140310902786048 replay_runner.py:36] Average training steps per second: 227.11
I0902 23:50:05.932780 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.77
INFO:tensorflow:Starting iteration 25

Steps executed: 227 Episode length: 131 Return: -205.2327705462606772
INFO:tensorflow:Average training steps per second: 220.33
I0902 23:50:14.688535 140310902786048 replay_runner.py:36] Average training steps per second: 220.33
I0902 23:50:14.907248 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -418.98
INFO:tensorflow:Starting iteration 26

Steps executed: 280 Episode length: 83 Return: -93.477144535306174572
INFO:tensorflow:Average training steps per second: 223.14
I0902 23:50:23.716232 140310902786048 replay_runner.py:36] Average training steps per second: 223.14
I0902 23:50:23.946799 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -255.66
INFO:tensorflow:Starting iteration 27

Steps executed: 295 Episode length: 108 Return: -727.3670238423186572
INFO:tensorflow:Average training steps per second: 220.11
I0902 23:50:32.775674 140310902786048 replay_runner.py:36] Average training steps per second: 220.11
I0902 23:50:33.042361 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.29
INFO:tensorflow:Starting iteration 28

Steps executed: 271 Episode length: 108 Return: -71.67830966545549572
INFO:tensorflow:Average training steps per second: 211.91
I0902 23:50:42.038590 140310902786048 replay_runner.py:36] Average training steps per second: 211.91
I0902 23:50:42.243722 140310902786048 run_experiment.py:428] Average undiscounted return per evaluation episode: -135.19
INFO:tensorflow:Starting iteration 29
I0902 23:50:46.573276 140310902786048 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 221.58

Steps executed: 344 Episode length: 194 Return: -363.7176373178133472

Done fixed training!Episode length: 194 Return: -363.7176373178133472