Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0903 00:15:45.967846 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0903 00:15:45.977001 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:15:45.977191 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:15:45.977316 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:15:45.977427 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:15:45.977521 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0903 00:15:45.977646 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:15:45.977759 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:15:45.977889 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:15:45.978003 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:15:45.978077 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0903 00:15:45.978146 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:15:45.978226 139926926592000 dqn_agent.py:283] 	 seed: 1630628145976952
I0903 00:15:45.980237 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:15:45.980400 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:15:45.980514 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:15:45.980617 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:15:45.980765 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:15:45.980842 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:15:45.980918 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:15:45.980976 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:15:45.981052 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:15:46.006152 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:46.301056 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:46.311931 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:15:46.319840 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:15:46.320034 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:15:46.320184 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:15:46.320341 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:15:46.320435 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0903 00:15:46.320510 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:15:46.320606 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:15:46.320738 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:15:46.320829 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:15:46.320940 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0903 00:15:46.321080 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:15:46.321171 139926926592000 dqn_agent.py:283] 	 seed: 1630628146319796
I0903 00:15:46.322894 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:15:46.323008 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:15:46.323077 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:15:46.323139 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:15:46.323207 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:15:46.323260 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:15:46.323312 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:15:46.323384 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:15:46.323471 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:15:46.345924 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:15:46.366990 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:15:46.367230 139926926592000 replay_runner.py:41] Starting iteration 0
Steps executed: 294 Episode length: 111 Return: -470.68807607457807
INFO:tensorflow:Average training steps per second: 238.30
I0903 00:15:50.563912 139926926592000 replay_runner.py:36] Average training steps per second: 238.30
I0903 00:15:51.328592 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.23
INFO:tensorflow:Starting iteration 1

Steps executed: 274 Episode length: 94 Return: -516.230176509300275
INFO:tensorflow:Average training steps per second: 347.82
I0903 00:15:57.665224 139926926592000 replay_runner.py:36] Average training steps per second: 347.82
I0903 00:15:57.869237 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -375.42
INFO:tensorflow:Starting iteration 2

Steps executed: 320 Episode length: 134 Return: -584.73405614096126
INFO:tensorflow:Average training steps per second: 350.17
I0903 00:16:04.201027 139926926592000 replay_runner.py:36] Average training steps per second: 350.17
I0903 00:16:04.401944 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.13
INFO:tensorflow:Starting iteration 3

Steps executed: 219 Episode length: 131 Return: -415.90226092402346
INFO:tensorflow:Average training steps per second: 334.78
I0903 00:16:10.899678 139926926592000 replay_runner.py:36] Average training steps per second: 334.78
I0903 00:16:11.018064 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -435.86
INFO:tensorflow:Starting iteration 4

Steps executed: 158 Episode length: 158 Return: -270.47005653084955
INFO:tensorflow:Average training steps per second: 332.41
I0903 00:16:17.436393 139926926592000 replay_runner.py:36] Average training steps per second: 332.41

Steps executed: 409 Episode length: 251 Return: -226.22829432998478
INFO:tensorflow:Starting iteration 5

Steps executed: 207 Episode length: 207 Return: -615.87700919875158
INFO:tensorflow:Average training steps per second: 335.19
I0903 00:16:24.171542 139926926592000 replay_runner.py:36] Average training steps per second: 335.19
I0903 00:16:24.319790 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -615.88
INFO:tensorflow:Starting iteration 6

Steps executed: 774 Episode length: 647 Return: -446.74540176515904
INFO:tensorflow:Average training steps per second: 332.79
I0903 00:16:30.703406 139926926592000 replay_runner.py:36] Average training steps per second: 332.79
I0903 00:16:31.479942 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.61
INFO:tensorflow:Starting iteration 7
I0903 00:16:34.925736 139926926592000 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 348.10


Steps executed: 1168 Episode length: 1000 Return: -216.0605172884082
I0903 00:16:39.968095 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.06
INFO:tensorflow:Starting iteration 8

Steps executed: 608 Episode length: 526 Return: -475.254698600744752
INFO:tensorflow:Average training steps per second: 347.98
I0903 00:16:46.292681 139926926592000 replay_runner.py:36] Average training steps per second: 347.98
I0903 00:16:46.975958 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -560.16
INFO:tensorflow:Starting iteration 9

Steps executed: 227 Episode length: 141 Return: -165.337095899171232
INFO:tensorflow:Average training steps per second: 353.41
I0903 00:16:53.264719 139926926592000 replay_runner.py:36] Average training steps per second: 353.41
I0903 00:16:53.394131 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.19
INFO:tensorflow:Starting iteration 10
I0903 00:16:56.942189 139926926592000 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 356.84

Steps executed: 537 Episode length: 537 Return: -263.820899715338562
I0903 00:17:00.535863 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -263.82
INFO:tensorflow:Starting iteration 11
I0903 00:17:04.001236 139926926592000 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 340.49

Steps executed: 1000 Episode length: 1000 Return: -309.6525270779175
I0903 00:17:08.715079 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -309.65
INFO:tensorflow:Starting iteration 12

Steps executed: 608 Episode length: 608 Return: -497.177720463541565
INFO:tensorflow:Average training steps per second: 324.58
I0903 00:17:15.140537 139926926592000 replay_runner.py:36] Average training steps per second: 324.58
I0903 00:17:15.794101 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -497.18
INFO:tensorflow:Starting iteration 13

Steps executed: 213 Episode length: 213 Return: -234.078238819013855
INFO:tensorflow:Average training steps per second: 326.38
I0903 00:17:22.271802 139926926592000 replay_runner.py:36] Average training steps per second: 326.38
I0903 00:17:22.434266 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.08
INFO:tensorflow:Starting iteration 14
I0903 00:17:25.780322 139926926592000 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 326.31

Steps executed: 1000 Episode length: 1000 Return: -261.77634176302644
I0903 00:17:31.815369 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.78
INFO:tensorflow:Starting iteration 15
I0903 00:17:35.223061 139926926592000 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 323.42

Steps executed: 303 Episode length: 147 Return: -127.2606253779097944
I0903 00:17:38.511191 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -128.39
INFO:tensorflow:Starting iteration 16

Steps executed: 237 Episode length: 237 Return: -321.6217311143554944
INFO:tensorflow:Average training steps per second: 324.59
I0903 00:17:44.939798 139926926592000 replay_runner.py:36] Average training steps per second: 324.59
I0903 00:17:45.118327 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.62
INFO:tensorflow:Starting iteration 17

Steps executed: 205 Episode length: 151 Return: -242.7049202126939344
INFO:tensorflow:Average training steps per second: 324.26
I0903 00:17:51.622691 139926926592000 replay_runner.py:36] Average training steps per second: 324.26
I0903 00:17:51.733486 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -238.07
INFO:tensorflow:Starting iteration 18

Steps executed: 315 Episode length: 315 Return: -227.1505100396018444
INFO:tensorflow:Average training steps per second: 310.13
I0903 00:17:58.268352 139926926592000 replay_runner.py:36] Average training steps per second: 310.13
I0903 00:17:58.500700 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.15
INFO:tensorflow:Starting iteration 19

Steps executed: 266 Episode length: 83 Return: -692.11284088789098444
INFO:tensorflow:Average training steps per second: 308.47
I0903 00:18:05.042394 139926926592000 replay_runner.py:36] Average training steps per second: 308.47
I0903 00:18:05.216165 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.35
INFO:tensorflow:Starting iteration 20

Steps executed: 332 Episode length: 140 Return: -116.2200010191174344
INFO:tensorflow:Average training steps per second: 303.01
I0903 00:18:11.859404 139926926592000 replay_runner.py:36] Average training steps per second: 303.01
I0903 00:18:12.067725 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.23
INFO:tensorflow:Starting iteration 21

Steps executed: 201 Episode length: 201 Return: -318.5631084800915344
INFO:tensorflow:Average training steps per second: 312.44
I0903 00:18:18.592834 139926926592000 replay_runner.py:36] Average training steps per second: 312.44
I0903 00:18:18.733851 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.56
INFO:tensorflow:Starting iteration 22

Steps executed: 537 Episode length: 343 Return: -198.5453952963168344
INFO:tensorflow:Average training steps per second: 306.09
I0903 00:18:25.295117 139926926592000 replay_runner.py:36] Average training steps per second: 306.09
I0903 00:18:25.662420 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.30
INFO:tensorflow:Starting iteration 23
I0903 00:18:28.919393 139926926592000 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 314.75

Steps executed: 382 Episode length: 306 Return: -150.5085589964908844
I0903 00:18:32.403918 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.06
INFO:tensorflow:Starting iteration 24

Steps executed: 210 Episode length: 61 Return: -229.40855649120698844
INFO:tensorflow:Average training steps per second: 314.99
I0903 00:18:38.895616 139926926592000 replay_runner.py:36] Average training steps per second: 314.99
I0903 00:18:39.014224 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.34
INFO:tensorflow:Starting iteration 25

Steps executed: 374 Episode length: 191 Return: -572.2924440435497844
INFO:tensorflow:Average training steps per second: 315.63
I0903 00:18:45.506256 139926926592000 replay_runner.py:36] Average training steps per second: 315.63
I0903 00:18:45.743607 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.56
INFO:tensorflow:Starting iteration 26
I0903 00:18:48.979080 139926926592000 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 312.42
I0903 00:18:52.180171 139926926592000 replay_runner.py:36] Average training steps per second: 312.42

Steps executed: 304 Episode length: 178 Return: -170.8807013414948444
INFO:tensorflow:Starting iteration 27

Steps executed: 279 Episode length: 151 Return: -288.2116573305553444
INFO:tensorflow:Average training steps per second: 318.27
I0903 00:18:58.743906 139926926592000 replay_runner.py:36] Average training steps per second: 318.27
I0903 00:18:58.907615 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -205.76
INFO:tensorflow:Starting iteration 28

Steps executed: 205 Episode length: 52 Return: -165.94242687927318544
INFO:tensorflow:Average training steps per second: 328.31
I0903 00:19:05.279687 139926926592000 replay_runner.py:36] Average training steps per second: 328.31
I0903 00:19:05.392796 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.43
INFO:tensorflow:Starting iteration 29

Steps executed: 275 Episode length: 96 Return: -860.25244151869991544
INFO:tensorflow:Average training steps per second: 333.52
I0903 00:19:11.774441 139926926592000 replay_runner.py:36] Average training steps per second: 333.52

Done fixed training!Episode length: 96 Return: -860.25244151869991544