Loaded trained dqn in acrobot
Training fixed agent 5, please be patient, may be a while...
I0902 23:46:48.283159 140687300532224 run_experiment.py:549] Creating TrainRunner ...
I0902 23:46:48.293116 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:48.293333 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:48.293435 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:48.293577 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:48.293639 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:48.293693 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:46:48.293743 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:48.293795 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:48.293846 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:48.294035 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:48.294112 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:48.294204 140687300532224 dqn_agent.py:283] 	 seed: 1630626408293067
I0902 23:46:48.296418 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:48.296555 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:46:48.296634 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:48.296697 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:48.296978 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:48.297077 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:48.297149 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:48.297208 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:48.297265 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:48.338124 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:48.791842 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:48.805834 140687300532224 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:46:48.815181 140687300532224 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:46:48.815376 140687300532224 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:46:48.815559 140687300532224 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:46:48.815764 140687300532224 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:46:48.815968 140687300532224 dqn_agent.py:275] 	 update_period: 4
I0902 23:46:48.816114 140687300532224 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:46:48.816208 140687300532224 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:46:48.816351 140687300532224 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:46:48.816489 140687300532224 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:46:48.816621 140687300532224 dqn_agent.py:280] 	 optimizer: adam
I0902 23:46:48.816794 140687300532224 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:46:48.816903 140687300532224 dqn_agent.py:283] 	 seed: 1630626408815137
I0902 23:46:48.819699 140687300532224 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:46:48.819918 140687300532224 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:46:48.820069 140687300532224 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:46:48.820216 140687300532224 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:46:48.820331 140687300532224 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:46:48.820408 140687300532224 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:46:48.820513 140687300532224 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:46:48.820634 140687300532224 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:46:48.820765 140687300532224 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:46:48.853534 140687300532224 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:46:48.875959 140687300532224 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:46:48.876192 140687300532224 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 145.19
I0902 23:46:55.764033 140687300532224 replay_runner.py:36] Average training steps per second: 145.19
Steps executed: 318 Episode length: 145 Return: -144.0
I0902 23:46:57.160834 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -158.00
INFO:tensorflow:Starting iteration 1

Steps executed: 386 Episode length: 210 Return: -209.0
INFO:tensorflow:Average training steps per second: 209.10
I0902 23:47:02.169968 140687300532224 replay_runner.py:36] Average training steps per second: 209.10
I0902 23:47:02.474282 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -192.00
INFO:tensorflow:Starting iteration 2
I0902 23:47:02.700962 140687300532224 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 196.32

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:47:08.191933 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:47:08.442097 140687300532224 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 203.54
I0902 23:47:13.355616 140687300532224 replay_runner.py:36] Average training steps per second: 203.54
I0902 23:47:13.790557 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0902 23:47:14.034022 140687300532224 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 194.30
I0902 23:47:19.181312 140687300532224 replay_runner.py:36] Average training steps per second: 194.30
I0902 23:47:19.574791 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0902 23:47:19.813134 140687300532224 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 199.82
I0902 23:47:24.818035 140687300532224 replay_runner.py:36] Average training steps per second: 199.82
I0902 23:47:25.242995 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 313 Episode length: 126 Return: -125.0
INFO:tensorflow:Average training steps per second: 202.51
I0902 23:47:30.432865 140687300532224 replay_runner.py:36] Average training steps per second: 202.51
I0902 23:47:30.691043 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.50
INFO:tensorflow:Starting iteration 7
I0902 23:47:30.930388 140687300532224 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 198.06

Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:47:36.413347 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:47:36.653172 140687300532224 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 198.74
I0902 23:47:41.685249 140687300532224 replay_runner.py:36] Average training steps per second: 198.74
I0902 23:47:42.115696 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 9
I0902 23:47:42.364043 140687300532224 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 199.01
I0902 23:47:47.389174 140687300532224 replay_runner.py:36] Average training steps per second: 199.01
I0902 23:47:47.800678 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10
I0902 23:47:48.046561 140687300532224 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 199.20
I0902 23:47:53.067314 140687300532224 replay_runner.py:36] Average training steps per second: 199.20
I0902 23:47:53.462104 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 11

Steps executed: 210 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 203.89
I0902 23:47:58.620932 140687300532224 replay_runner.py:36] Average training steps per second: 203.89
I0902 23:47:58.793331 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -104.00
INFO:tensorflow:Starting iteration 12
I0902 23:47:59.011397 140687300532224 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 194.33
I0902 23:48:04.157919 140687300532224 replay_runner.py:36] Average training steps per second: 194.33

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 13

Steps executed: 247 Episode length: 69 Return: -68.0.0
INFO:tensorflow:Average training steps per second: 193.17
I0902 23:48:09.981155 140687300532224 replay_runner.py:36] Average training steps per second: 193.17
I0902 23:48:10.190604 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.33
INFO:tensorflow:Starting iteration 14

Steps executed: 252 Episode length: 252 Return: -251.0
INFO:tensorflow:Average training steps per second: 196.61
I0902 23:48:15.524284 140687300532224 replay_runner.py:36] Average training steps per second: 196.61
I0902 23:48:15.728736 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -251.00
INFO:tensorflow:Starting iteration 15

Steps executed: 328 Episode length: 146 Return: -145.0
INFO:tensorflow:Average training steps per second: 196.03
I0902 23:48:21.067839 140687300532224 replay_runner.py:36] Average training steps per second: 196.03
I0902 23:48:21.354815 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -108.33
INFO:tensorflow:Starting iteration 16

Steps executed: 305 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 202.01
I0902 23:48:26.564297 140687300532224 replay_runner.py:36] Average training steps per second: 202.01
I0902 23:48:26.805367 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.67
INFO:tensorflow:Starting iteration 17

Steps executed: 221 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 192.37
I0902 23:48:32.243454 140687300532224 replay_runner.py:36] Average training steps per second: 192.37
I0902 23:48:32.431480 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.50
INFO:tensorflow:Starting iteration 18

Steps executed: 276 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 191.27
I0902 23:48:37.902352 140687300532224 replay_runner.py:36] Average training steps per second: 191.27
I0902 23:48:38.137613 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 19

Steps executed: 208 Episode length: 102 Return: -101.0
INFO:tensorflow:Average training steps per second: 199.01
I0902 23:48:43.408756 140687300532224 replay_runner.py:36] Average training steps per second: 199.01
I0902 23:48:43.578829 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 20

Steps executed: 274 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 194.46
I0902 23:48:48.955597 140687300532224 replay_runner.py:36] Average training steps per second: 194.46
I0902 23:48:49.194107 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.33
INFO:tensorflow:Starting iteration 21
I0902 23:48:49.440792 140687300532224 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 202.15

Steps executed: 250 Episode length: 103 Return: -102.0
I0902 23:48:54.595693 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 22

Steps executed: 293 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 202.16
I0902 23:48:59.777252 140687300532224 replay_runner.py:36] Average training steps per second: 202.16
I0902 23:49:00.015019 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 23

Steps executed: 595 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 204.85
I0902 23:49:05.131280 140687300532224 replay_runner.py:36] Average training steps per second: 204.85
I0902 23:49:05.618218 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.00
INFO:tensorflow:Starting iteration 24

Steps executed: 262 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 192.39
I0902 23:49:11.054126 140687300532224 replay_runner.py:36] Average training steps per second: 192.39
I0902 23:49:11.286914 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 25
I0902 23:49:11.531167 140687300532224 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 200.58

Steps executed: 271 Episode length: 74 Return: -73.0.0
I0902 23:49:16.749554 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -89.33
INFO:tensorflow:Starting iteration 26

Steps executed: 222 Episode length: 100 Return: -99.00
INFO:tensorflow:Average training steps per second: 194.68
I0902 23:49:22.115437 140687300532224 replay_runner.py:36] Average training steps per second: 194.68
I0902 23:49:22.308642 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 27

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.16
I0902 23:49:27.716614 140687300532224 replay_runner.py:36] Average training steps per second: 193.16
I0902 23:49:28.122907 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 296 Episode length: 108 Return: -107.0
INFO:tensorflow:Average training steps per second: 196.70
I0902 23:49:33.452652 140687300532224 replay_runner.py:36] Average training steps per second: 196.70
I0902 23:49:33.705209 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.67
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 63 Return: -62.0.0
INFO:tensorflow:Average training steps per second: 199.74
I0902 23:49:38.945764 140687300532224 replay_runner.py:36] Average training steps per second: 199.74
I0902 23:49:39.137000 140687300532224 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.00