Loaded trained dqn in mountaincar
Training fixed agent 10, please be patient, may be a while...
I0909 13:20:34.506078 140364676536320 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0909 13:20:34.506508 140364676536320 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0909 13:20:34.557519 140364676536320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:20:34.558431 140364676536320 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:20:34.558491 140364676536320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:20:34.558547 140364676536320 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:20:34.558628 140364676536320 dqn_agent.py:275] 	 update_period: 4
I0909 13:20:34.558680 140364676536320 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:20:34.558769 140364676536320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:20:34.558854 140364676536320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:20:34.558915 140364676536320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:20:34.558974 140364676536320 dqn_agent.py:280] 	 optimizer: adam
I0909 13:20:34.559033 140364676536320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:20:34.559092 140364676536320 dqn_agent.py:283] 	 seed: 1631193634557473
I0909 13:20:34.560415 140364676536320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:20:34.560539 140364676536320 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:20:34.560610 140364676536320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:20:34.560665 140364676536320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:20:34.560714 140364676536320 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:20:34.560807 140364676536320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:20:34.560855 140364676536320 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:20:34.560930 140364676536320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:20:34.561008 140364676536320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:20:35.586279 140364676536320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.762374 140364676536320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.786700 140364676536320 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0909 13:20:35.790386 140364676536320 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0909 13:20:35.790514 140364676536320 dqn_agent.py:272] 	 gamma: 0.990000
I0909 13:20:35.790584 140364676536320 dqn_agent.py:273] 	 update_horizon: 1.000000
I0909 13:20:35.790642 140364676536320 dqn_agent.py:274] 	 min_replay_history: 500
I0909 13:20:35.790694 140364676536320 dqn_agent.py:275] 	 update_period: 4
I0909 13:20:35.790762 140364676536320 dqn_agent.py:276] 	 target_update_period: 100
I0909 13:20:35.790845 140364676536320 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0909 13:20:35.790921 140364676536320 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0909 13:20:35.790998 140364676536320 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0909 13:20:35.791077 140364676536320 dqn_agent.py:280] 	 optimizer: adam
I0909 13:20:35.791142 140364676536320 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0909 13:20:35.791207 140364676536320 dqn_agent.py:283] 	 seed: 1631193635790357
I0909 13:20:35.792476 140364676536320 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0909 13:20:35.792600 140364676536320 circular_replay_buffer.py:156] 	 observation_shape: (2, 1)
I0909 13:20:35.792680 140364676536320 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0909 13:20:35.792740 140364676536320 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0909 13:20:35.792831 140364676536320 circular_replay_buffer.py:159] 	 stack_size: 1
I0909 13:20:35.792891 140364676536320 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0909 13:20:35.792966 140364676536320 circular_replay_buffer.py:161] 	 batch_size: 128
I0909 13:20:35.793038 140364676536320 circular_replay_buffer.py:162] 	 update_horizon: 1
I0909 13:20:35.793100 140364676536320 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0909 13:20:35.807050 140364676536320 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.010000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0909 13:20:35.815395 140364676536320 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0909 13:20:35.815509 140364676536320 replay_runner.py:41] Starting iteration 0
Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 314.84
I0909 13:20:38.991861 140364676536320 replay_runner.py:36] Average training steps per second: 314.84
I0909 13:20:39.628890 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 1
I0909 13:20:39.693923 140364676536320 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 395.92
I0909 13:20:42.219973 140364676536320 replay_runner.py:36] Average training steps per second: 395.92
I0909 13:20:42.343094 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 2
I0909 13:20:42.407505 140364676536320 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 397.65
I0909 13:20:44.922628 140364676536320 replay_runner.py:36] Average training steps per second: 397.65
I0909 13:20:45.046315 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 3
I0909 13:20:45.114783 140364676536320 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 396.06
I0909 13:20:47.639943 140364676536320 replay_runner.py:36] Average training steps per second: 396.06
I0909 13:20:47.763899 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 4
I0909 13:20:47.827209 140364676536320 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 394.53
I0909 13:20:50.362190 140364676536320 replay_runner.py:36] Average training steps per second: 394.53
I0909 13:20:50.481750 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 5
I0909 13:20:50.544890 140364676536320 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 404.51
I0909 13:20:53.017273 140364676536320 replay_runner.py:36] Average training steps per second: 404.51
I0909 13:20:53.133522 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 6
I0909 13:20:53.197890 140364676536320 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 407.08
I0909 13:20:55.654672 140364676536320 replay_runner.py:36] Average training steps per second: 407.08
I0909 13:20:55.772066 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 7
I0909 13:20:55.834079 140364676536320 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 404.97
I0909 13:20:58.303648 140364676536320 replay_runner.py:36] Average training steps per second: 404.97
I0909 13:20:58.421257 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 8
I0909 13:20:58.486462 140364676536320 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 404.61
I0909 13:21:00.958315 140364676536320 replay_runner.py:36] Average training steps per second: 404.61
I0909 13:21:01.079167 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 9
I0909 13:21:01.143517 140364676536320 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 406.82
I0909 13:21:03.601801 140364676536320 replay_runner.py:36] Average training steps per second: 406.82
I0909 13:21:03.722227 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 10
I0909 13:21:03.786151 140364676536320 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 411.10
I0909 13:21:06.218884 140364676536320 replay_runner.py:36] Average training steps per second: 411.10
I0909 13:21:06.337222 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 11
I0909 13:21:06.399726 140364676536320 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 409.39
I0909 13:21:08.842670 140364676536320 replay_runner.py:36] Average training steps per second: 409.39
I0909 13:21:08.958641 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 12

Steps executed: 243 Episode length: 156 Return: -156.0
INFO:tensorflow:Average training steps per second: 411.64
I0909 13:21:11.456231 140364676536320 replay_runner.py:36] Average training steps per second: 411.64
I0909 13:21:11.502822 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.50
INFO:tensorflow:Starting iteration 13

Steps executed: 284 Episode length: 174 Return: -174.0
INFO:tensorflow:Average training steps per second: 418.68
I0909 13:21:13.952600 140364676536320 replay_runner.py:36] Average training steps per second: 418.68
I0909 13:21:14.010398 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -142.00
INFO:tensorflow:Starting iteration 14

Steps executed: 231 Episode length: 116 Return: -116.0
INFO:tensorflow:Average training steps per second: 411.97
I0909 13:21:16.499463 140364676536320 replay_runner.py:36] Average training steps per second: 411.97
I0909 13:21:16.545990 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.50
INFO:tensorflow:Starting iteration 15

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 416.63
I0909 13:21:19.011455 140364676536320 replay_runner.py:36] Average training steps per second: 416.63
I0909 13:21:19.128649 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 16

Steps executed: 240 Episode length: 155 Return: -155.0
INFO:tensorflow:Average training steps per second: 413.51
I0909 13:21:21.610313 140364676536320 replay_runner.py:36] Average training steps per second: 413.51
I0909 13:21:21.658466 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.00
INFO:tensorflow:Starting iteration 17

Steps executed: 325 Episode length: 150 Return: -150.0
INFO:tensorflow:Average training steps per second: 414.45
I0909 13:21:24.133661 140364676536320 replay_runner.py:36] Average training steps per second: 414.45
I0909 13:21:24.196197 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.50
INFO:tensorflow:Starting iteration 18

Steps executed: 752 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 407.11
I0909 13:21:26.714526 140364676536320 replay_runner.py:36] Average training steps per second: 407.11
I0909 13:21:26.859950 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.00
INFO:tensorflow:Starting iteration 19

Steps executed: 287 Episode length: 112 Return: -112.0
INFO:tensorflow:Average training steps per second: 408.35
I0909 13:21:29.372965 140364676536320 replay_runner.py:36] Average training steps per second: 408.35
I0909 13:21:29.428908 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.67
INFO:tensorflow:Starting iteration 20

Steps executed: 269 Episode length: 148 Return: -148.0
INFO:tensorflow:Average training steps per second: 408.81
I0909 13:21:31.937044 140364676536320 replay_runner.py:36] Average training steps per second: 408.81
I0909 13:21:31.989201 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -134.50
INFO:tensorflow:Starting iteration 21

Steps executed: 320 Episode length: 175 Return: -175.0
INFO:tensorflow:Average training steps per second: 412.62
I0909 13:21:34.475394 140364676536320 replay_runner.py:36] Average training steps per second: 412.62
I0909 13:21:34.536958 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.00
INFO:tensorflow:Starting iteration 22

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 407.16
I0909 13:21:37.056457 140364676536320 replay_runner.py:36] Average training steps per second: 407.16
I0909 13:21:37.177439 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 23

Steps executed: 319 Episode length: 167 Return: -167.0
INFO:tensorflow:Average training steps per second: 402.07
I0909 13:21:39.728359 140364676536320 replay_runner.py:36] Average training steps per second: 402.07
I0909 13:21:39.787576 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -159.50
INFO:tensorflow:Starting iteration 24

Steps executed: 309 Episode length: 160 Return: -160.0
INFO:tensorflow:Average training steps per second: 409.44
I0909 13:21:42.292074 140364676536320 replay_runner.py:36] Average training steps per second: 409.44
I0909 13:21:42.352161 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.50
INFO:tensorflow:Starting iteration 25

Steps executed: 600 Episode length: 600 Return: -600.0
INFO:tensorflow:Average training steps per second: 408.16
I0909 13:21:44.865307 140364676536320 replay_runner.py:36] Average training steps per second: 408.16
I0909 13:21:44.981610 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 26
I0909 13:21:45.046260 140364676536320 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 411.21
I0909 13:21:47.478296 140364676536320 replay_runner.py:36] Average training steps per second: 411.21
I0909 13:21:47.592721 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 27
I0909 13:21:47.654202 140364676536320 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 406.69
I0909 13:21:50.113308 140364676536320 replay_runner.py:36] Average training steps per second: 406.69
I0909 13:21:50.230354 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -600.00
INFO:tensorflow:Starting iteration 28

Steps executed: 157 Episode length: 157 Return: -157.0
INFO:tensorflow:Average training steps per second: 407.06
I0909 13:21:52.753198 140364676536320 replay_runner.py:36] Average training steps per second: 407.06

Steps executed: 311 Episode length: 154 Return: -154.0
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 166 Return: -166.0
INFO:tensorflow:Average training steps per second: 409.88
I0909 13:21:55.316190 140364676536320 replay_runner.py:36] Average training steps per second: 409.88
I0909 13:21:55.379817 140364676536320 run_experiment.py:428] Average undiscounted return per evaluation episode: -165.50