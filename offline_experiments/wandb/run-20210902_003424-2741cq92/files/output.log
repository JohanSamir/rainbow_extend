Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0902 00:34:29.814220 140252174653440 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:29.832323 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:29.832518 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:29.832703 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:29.832876 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:29.832991 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:29.833144 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:29.833327 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:29.833466 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:29.833552 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:29.833645 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:29.833734 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:29.833821 140252174653440 dqn_agent.py:283] 	 seed: 1630542869832273
I0902 00:34:29.836593 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:29.836767 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:29.836882 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:29.837028 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:29.837244 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:29.837396 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:29.837486 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:29.837568 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:29.837647 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:29.876470 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:30.158042 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:30.168095 140252174653440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:30.174634 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:30.174798 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:30.174875 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:30.174940 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:30.175000 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:30.175063 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:30.175122 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:30.175180 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:30.175232 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:30.175310 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:30.175396 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:30.175483 140252174653440 dqn_agent.py:283] 	 seed: 1630542870174601
I0902 00:34:30.177096 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:30.177247 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:30.177320 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:30.177382 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:30.177440 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:30.177512 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:30.177570 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:30.177661 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:30.177757 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:30.199643 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:30.218086 140252174653440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:30.218331 140252174653440 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 249.17
I0902 00:34:34.231798 140252174653440 replay_runner.py:36] Average training steps per second: 249.17
I0902 00:34:35.026980 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.33
Steps executed: 247 Episode length: 130 Return: -293.17661982735444
INFO:tensorflow:Starting iteration 1

Steps executed: 262 Episode length: 127 Return: -504.04621761498146
INFO:tensorflow:Average training steps per second: 372.31
I0902 00:34:41.040770 140252174653440 replay_runner.py:36] Average training steps per second: 372.31
I0902 00:34:41.180282 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -499.00
INFO:tensorflow:Starting iteration 2
I0902 00:34:44.544765 140252174653440 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 355.15

Steps executed: 226 Episode length: 77 Return: -407.867316417313536
I0902 00:34:47.482402 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -471.55
INFO:tensorflow:Starting iteration 3

Steps executed: 210 Episode length: 65 Return: -316.439844499844876
INFO:tensorflow:Average training steps per second: 328.00
I0902 00:34:53.904075 140252174653440 replay_runner.py:36] Average training steps per second: 328.00
I0902 00:34:54.012758 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -267.63
INFO:tensorflow:Starting iteration 4

Steps executed: 343 Episode length: 343 Return: -680.13190471869066
INFO:tensorflow:Average training steps per second: 328.96
I0902 00:35:00.393500 140252174653440 replay_runner.py:36] Average training steps per second: 328.96
I0902 00:35:00.741055 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -680.13
INFO:tensorflow:Starting iteration 5

Steps executed: 220 Episode length: 100 Return: -428.19898464127726
INFO:tensorflow:Average training steps per second: 335.38
I0902 00:35:07.020428 140252174653440 replay_runner.py:36] Average training steps per second: 335.38
I0902 00:35:07.163208 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -502.60
INFO:tensorflow:Starting iteration 6

Steps executed: 223 Episode length: 75 Return: -192.205516007393846
INFO:tensorflow:Average training steps per second: 340.87
I0902 00:35:13.471164 140252174653440 replay_runner.py:36] Average training steps per second: 340.87
I0902 00:35:13.584335 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.74
INFO:tensorflow:Starting iteration 7

Steps executed: 444 Episode length: 444 Return: -587.40062724290536
INFO:tensorflow:Average training steps per second: 340.14
I0902 00:35:19.919352 140252174653440 replay_runner.py:36] Average training steps per second: 340.14
I0902 00:35:20.373294 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -587.40
INFO:tensorflow:Starting iteration 8

Steps executed: 483 Episode length: 483 Return: -352.97883545579054
INFO:tensorflow:Average training steps per second: 340.92
I0902 00:35:26.701145 140252174653440 replay_runner.py:36] Average training steps per second: 340.92
I0902 00:35:27.381855 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.98
INFO:tensorflow:Starting iteration 9

Steps executed: 1000 Episode length: 1000 Return: -483.95601695879606
INFO:tensorflow:Average training steps per second: 318.92
I0902 00:35:33.933838 140252174653440 replay_runner.py:36] Average training steps per second: 318.92
I0902 00:35:35.170429 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -483.96
INFO:tensorflow:Starting iteration 10
I0902 00:35:38.516006 140252174653440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 323.50

Steps executed: 273 Episode length: 273 Return: -485.0337908564826606
I0902 00:35:41.831641 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -485.03
INFO:tensorflow:Starting iteration 11
I0902 00:35:45.110884 140252174653440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 319.62

Steps executed: 1000 Episode length: 1000 Return: -365.81999625822306
I0902 00:35:49.946832 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.82
INFO:tensorflow:Starting iteration 12

Steps executed: 293 Episode length: 138 Return: -696.7474288023974306
INFO:tensorflow:Average training steps per second: 324.28
I0902 00:35:56.415631 140252174653440 replay_runner.py:36] Average training steps per second: 324.28
I0902 00:35:56.587560 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -667.48
INFO:tensorflow:Starting iteration 13

Steps executed: 154 Episode length: 154 Return: -363.9667224164654306
INFO:tensorflow:Average training steps per second: 325.90

Steps executed: 1154 Episode length: 1000 Return: -51.213715229496955
I0902 00:36:04.639484 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.59
INFO:tensorflow:Starting iteration 14

Steps executed: 282 Episode length: 137 Return: -255.0026494642693355
INFO:tensorflow:Average training steps per second: 333.10
I0902 00:36:11.104055 140252174653440 replay_runner.py:36] Average training steps per second: 333.10
I0902 00:36:11.261398 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.90
INFO:tensorflow:Starting iteration 15

Steps executed: 227 Episode length: 227 Return: -154.4171363001914355
INFO:tensorflow:Average training steps per second: 340.84
I0902 00:36:17.632111 140252174653440 replay_runner.py:36] Average training steps per second: 340.84
I0902 00:36:17.795124 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.42
INFO:tensorflow:Starting iteration 16
I0902 00:36:21.254156 140252174653440 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 353.75

Steps executed: 1000 Episode length: 1000 Return: -67.087221495204295
I0902 00:36:26.154558 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.09
INFO:tensorflow:Starting iteration 17

Steps executed: 308 Episode length: 153 Return: -370.3897513654008495
INFO:tensorflow:Average training steps per second: 337.52
I0902 00:36:32.546859 140252174653440 replay_runner.py:36] Average training steps per second: 337.52
I0902 00:36:32.743401 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.56
INFO:tensorflow:Starting iteration 18

Steps executed: 371 Episode length: 298 Return: -440.8878379160501695
INFO:tensorflow:Average training steps per second: 340.70
I0902 00:36:39.094729 140252174653440 replay_runner.py:36] Average training steps per second: 340.70
I0902 00:36:39.402078 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.20
INFO:tensorflow:Starting iteration 19

Steps executed: 97 Episode length: 97 Return: -87.0061516413178401695
INFO:tensorflow:Average training steps per second: 355.33
I0902 00:36:45.617197 140252174653440 replay_runner.py:36] Average training steps per second: 355.33

Steps executed: 327 Episode length: 230 Return: -202.3822948628538895
INFO:tensorflow:Starting iteration 20

Steps executed: 231 Episode length: 89 Return: -423.08328001028144895
INFO:tensorflow:Average training steps per second: 347.63
I0902 00:36:52.137183 140252174653440 replay_runner.py:36] Average training steps per second: 347.63
I0902 00:36:52.291019 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.84
INFO:tensorflow:Starting iteration 21

Steps executed: 252 Episode length: 144 Return: -197.7547366136461295
INFO:tensorflow:Average training steps per second: 344.46
I0902 00:36:58.648268 140252174653440 replay_runner.py:36] Average training steps per second: 344.46
I0902 00:36:58.808278 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -474.76
INFO:tensorflow:Starting iteration 22

Steps executed: 284 Episode length: 146 Return: -668.3011958354481295
INFO:tensorflow:Average training steps per second: 343.78
I0902 00:37:05.195964 140252174653440 replay_runner.py:36] Average training steps per second: 343.78
I0902 00:37:05.385787 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -697.73
INFO:tensorflow:Starting iteration 23

Steps executed: 146 Episode length: 146 Return: -665.4359841934291295
INFO:tensorflow:Average training steps per second: 349.23
I0902 00:37:11.718587 140252174653440 replay_runner.py:36] Average training steps per second: 349.23

Steps executed: 207 Episode length: 61 Return: -129.81407684754654295
INFO:tensorflow:Starting iteration 24

Steps executed: 207 Episode length: 86 Return: -244.39922376816756295
INFO:tensorflow:Average training steps per second: 351.34
I0902 00:37:18.174934 140252174653440 replay_runner.py:36] Average training steps per second: 351.34
I0902 00:37:18.296757 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.31
INFO:tensorflow:Starting iteration 25

Steps executed: 247 Episode length: 70 Return: -658.45303102482868295
INFO:tensorflow:Average training steps per second: 351.68
I0902 00:37:24.635959 140252174653440 replay_runner.py:36] Average training steps per second: 351.68
I0902 00:37:24.770129 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -349.69
INFO:tensorflow:Starting iteration 26

Steps executed: 202 Episode length: 62 Return: -147.09498257523758295
INFO:tensorflow:Average training steps per second: 354.38
I0902 00:37:31.079856 140252174653440 replay_runner.py:36] Average training steps per second: 354.38
I0902 00:37:31.181747 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.30
INFO:tensorflow:Starting iteration 27

Steps executed: 200 Episode length: 71 Return: -562.31756785952422295
INFO:tensorflow:Average training steps per second: 347.75
I0902 00:37:37.464755 140252174653440 replay_runner.py:36] Average training steps per second: 347.75
I0902 00:37:37.569990 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -404.45
INFO:tensorflow:Starting iteration 28

Steps executed: 212 Episode length: 83 Return: -759.91359275439672295
INFO:tensorflow:Average training steps per second: 351.31
I0902 00:37:43.780480 140252174653440 replay_runner.py:36] Average training steps per second: 351.31
I0902 00:37:43.901448 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -628.50
INFO:tensorflow:Starting iteration 29

Steps executed: 241 Episode length: 56 Return: -514.14410036832532295
INFO:tensorflow:Average training steps per second: 354.95
I0902 00:37:50.235901 140252174653440 replay_runner.py:36] Average training steps per second: 354.95

Done fixed training!Episode length: 56 Return: -514.14410036832532295