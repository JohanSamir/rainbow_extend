I0905 16:42:20.815740 140275076675584 run_experiment.py:549] Creating TrainRunner ...
I0905 16:42:20.826608 140275076675584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:20.826782 140275076675584 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:20.826897 140275076675584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:20.826963 140275076675584 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:20.827022 140275076675584 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:20.827135 140275076675584 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:20.827219 140275076675584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:20.827278 140275076675584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:20.827355 140275076675584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:20.827425 140275076675584 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:20.827501 140275076675584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:20.827588 140275076675584 dqn_agent.py:283] 	 seed: 1630860140826556
I0905 16:42:20.829324 140275076675584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:20.829447 140275076675584 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:20.829526 140275076675584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:20.829596 140275076675584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:20.829657 140275076675584 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:20.829727 140275076675584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:20.829804 140275076675584 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:20.829885 140275076675584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:20.829951 140275076675584 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0905 16:42:22.347333 140275076675584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:23.209697 140275076675584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:23.222649 140275076675584 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:42:23.229653 140275076675584 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:42:23.229894 140275076675584 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:42:23.230071 140275076675584 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:42:23.230319 140275076675584 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:42:23.230547 140275076675584 dqn_agent.py:275] 	 update_period: 4
I0905 16:42:23.230715 140275076675584 dqn_agent.py:276] 	 target_update_period: 300
I0905 16:42:23.230861 140275076675584 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:42:23.230998 140275076675584 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:42:23.231127 140275076675584 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:42:23.231247 140275076675584 dqn_agent.py:280] 	 optimizer: adam
I0905 16:42:23.231368 140275076675584 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:42:23.231473 140275076675584 dqn_agent.py:283] 	 seed: 1630860143229596
I0905 16:42:23.234215 140275076675584 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:42:23.234380 140275076675584 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 16:42:23.234500 140275076675584 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:42:23.234620 140275076675584 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:42:23.234773 140275076675584 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:42:23.234971 140275076675584 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:42:23.235169 140275076675584 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:42:23.235301 140275076675584 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:42:23.235409 140275076675584 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:42:23.265857 140275076675584 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:42:23.289148 140275076675584 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:42:23.289444 140275076675584 replay_runner.py:41] Starting iteration 0
Steps executed: 326 Episode length: 130 Return: -264.0953042740285
INFO:tensorflow:Average training steps per second: 168.28
I0905 16:42:29.232279 140275076675584 replay_runner.py:36] Average training steps per second: 168.28
I0905 16:42:30.421581 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -259.96
INFO:tensorflow:Starting iteration 1

Steps executed: 209 Episode length: 98 Return: -267.07963614800287
INFO:tensorflow:Average training steps per second: 229.56
I0905 16:42:38.734369 140275076675584 replay_runner.py:36] Average training steps per second: 229.56
I0905 16:42:38.931710 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -272.40
INFO:tensorflow:Starting iteration 2

Steps executed: 309 Episode length: 157 Return: -322.8271950621514
INFO:tensorflow:Average training steps per second: 221.73
I0905 16:42:47.400955 140275076675584 replay_runner.py:36] Average training steps per second: 221.73
I0905 16:42:47.759828 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -381.43
INFO:tensorflow:Starting iteration 3

Steps executed: 335 Episode length: 335 Return: -75.11361320875325
INFO:tensorflow:Average training steps per second: 265.58
I0905 16:42:55.506839 140275076675584 replay_runner.py:36] Average training steps per second: 265.58
I0905 16:42:56.115415 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -75.11
INFO:tensorflow:Starting iteration 4
I0905 16:43:00.298534 140275076675584 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 245.83

Steps executed: 1000 Episode length: 1000 Return: -146.49186150574272
I0905 16:43:07.774762 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.49
INFO:tensorflow:Starting iteration 5
I0905 16:43:11.787407 140275076675584 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 235.44

Steps executed: 1000 Episode length: 1000 Return: -201.98448411860306
I0905 16:43:19.598717 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -201.98
INFO:tensorflow:Starting iteration 6
I0905 16:43:23.618055 140275076675584 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 236.52

Steps executed: 882 Episode length: 882 Return: -453.6494890928456306
I0905 16:43:30.160289 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -453.65
INFO:tensorflow:Starting iteration 7
I0905 16:43:34.142570 140275076675584 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 238.39

Steps executed: 391 Episode length: 391 Return: -761.2189597266416306
I0905 16:43:39.046728 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -761.22
INFO:tensorflow:Starting iteration 8

Steps executed: 566 Episode length: 415 Return: -391.0688589283761306
INFO:tensorflow:Average training steps per second: 240.99
I0905 16:43:47.211335 140275076675584 replay_runner.py:36] Average training steps per second: 240.99
I0905 16:43:48.028407 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.10
INFO:tensorflow:Starting iteration 9
I0905 16:43:52.065919 140275076675584 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 250.04

Steps executed: 668 Episode length: 668 Return: -459.2959756992625306
I0905 16:43:57.454217 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -459.30
INFO:tensorflow:Starting iteration 10
I0905 16:44:01.473613 140275076675584 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 249.66

Steps executed: 1000 Episode length: 1000 Return: -280.40815475265546
I0905 16:44:08.697919 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.41
INFO:tensorflow:Starting iteration 11
I0905 16:44:12.620185 140275076675584 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 240.85

Steps executed: 1000 Episode length: 1000 Return: -101.63195750749442
I0905 16:44:19.187777 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.63
INFO:tensorflow:Starting iteration 12
I0905 16:44:22.866733 140275076675584 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 230.77

Steps executed: 1000 Episode length: 1000 Return: -136.48661954901402
I0905 16:44:30.060173 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.49
INFO:tensorflow:Starting iteration 13
I0905 16:44:33.678823 140275076675584 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 220.55

Steps executed: 1000 Episode length: 1000 Return: -64.639233281490682
I0905 16:44:40.569329 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -64.64
INFO:tensorflow:Starting iteration 14
I0905 16:44:44.379143 140275076675584 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 219.32

Steps executed: 1000 Episode length: 1000 Return: -130.88669185347226
I0905 16:44:52.110164 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.89
INFO:tensorflow:Starting iteration 15
I0905 16:44:56.303190 140275076675584 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 237.01
I0905 16:45:00.522842 140275076675584 replay_runner.py:36] Average training steps per second: 237.01

Steps executed: 1000 Episode length: 1000 Return: -45.194636046545246
INFO:tensorflow:Starting iteration 16
I0905 16:45:06.924992 140275076675584 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 237.24

Steps executed: 1000 Episode length: 1000 Return: -68.027016603517246
I0905 16:45:13.813029 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -68.03
INFO:tensorflow:Starting iteration 17

Steps executed: 126 Episode length: 126 Return: -154.2552625473415246
INFO:tensorflow:Average training steps per second: 238.54

Steps executed: 1126 Episode length: 1000 Return: -52.106913769327576
I0905 16:45:25.620015 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.18
INFO:tensorflow:Starting iteration 18

Steps executed: 331 Episode length: 160 Return: -272.0912236824336376
INFO:tensorflow:Average training steps per second: 241.02
I0905 16:45:33.815279 140275076675584 replay_runner.py:36] Average training steps per second: 241.02
I0905 16:45:34.162258 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -281.95
INFO:tensorflow:Starting iteration 19
I0905 16:45:38.299670 140275076675584 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 244.44

Steps executed: 1000 Episode length: 1000 Return: -46.042213004671746
I0905 16:45:46.629069 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -46.04
INFO:tensorflow:Starting iteration 20
I0905 16:45:50.572149 140275076675584 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 247.08

Steps executed: 1000 Episode length: 1000 Return: -57.417668117132596
I0905 16:45:57.862628 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.42
INFO:tensorflow:Starting iteration 21
I0905 16:46:01.609756 140275076675584 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 217.55

Steps executed: 1000 Episode length: 1000 Return: 25.0169127493508056
I0905 16:46:09.894745 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: 25.02
INFO:tensorflow:Starting iteration 22
I0905 16:46:13.698581 140275076675584 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 226.54
I0905 16:46:18.113528 140275076675584 replay_runner.py:36] Average training steps per second: 226.54

Steps executed: 1000 Episode length: 1000 Return: -370.30980537363536
INFO:tensorflow:Starting iteration 23
I0905 16:46:25.494069 140275076675584 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 232.77

Steps executed: 1000 Episode length: 1000 Return: 13.8684415755057066
I0905 16:46:32.228020 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: 13.87
INFO:tensorflow:Starting iteration 24
I0905 16:46:35.997280 140275076675584 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 228.55

Steps executed: 1000 Episode length: 1000 Return: -49.722297220175925
I0905 16:46:42.981537 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.72
INFO:tensorflow:Starting iteration 25
I0905 16:46:47.188761 140275076675584 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 260.68
I0905 16:46:51.025317 140275076675584 replay_runner.py:36] Average training steps per second: 260.68

Steps executed: 343 Episode length: 197 Return: -322.7638159422521725
INFO:tensorflow:Starting iteration 26
I0905 16:46:55.173468 140275076675584 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 277.60

Steps executed: 1000 Episode length: 1000 Return: -45.483883548987525
I0905 16:47:01.021337 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -45.48
INFO:tensorflow:Starting iteration 27

Steps executed: 248 Episode length: 248 Return: -8.301157270553176525
INFO:tensorflow:Average training steps per second: 312.96
I0905 16:47:07.942542 140275076675584 replay_runner.py:36] Average training steps per second: 312.96
I0905 16:47:08.162621 140275076675584 run_experiment.py:428] Average undiscounted return per evaluation episode: -8.30
INFO:tensorflow:Starting iteration 28
I0905 16:47:11.560241 140275076675584 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 323.43
I0905 16:47:14.652411 140275076675584 replay_runner.py:36] Average training steps per second: 323.43

Steps executed: 652 Episode length: 652 Return: -49.08149477731057425
INFO:tensorflow:Starting iteration 29

Steps executed: 1000 Episode length: 1000 Return: -80.641068308840335
INFO:tensorflow:Average training steps per second: 303.70
I0905 16:47:21.468202 140275076675584 replay_runner.py:36] Average training steps per second: 303.70

Done fixed training! Episode length: 1000 Return: -80.641068308840335