Loaded trained dqn in lunarlander
Training fixed agent 3, please be patient, may be a while...
I0902 18:00:24.822540 140613433649152 run_experiment.py:549] Creating TrainRunner ...
I0902 18:00:24.833898 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:24.834153 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:24.834264 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:24.834368 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:24.834472 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:24.834604 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:24.834696 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:24.834784 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:24.834880 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:24.834968 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:24.835060 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:24.835148 140613433649152 dqn_agent.py:283] 	 seed: 1630605624833833
I0902 18:00:24.838198 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:24.838442 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:24.838588 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:24.838706 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:24.838875 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:24.838985 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:24.839092 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:24.839203 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:24.839305 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:24.875867 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:25.260038 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:25.275567 140613433649152 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 18:00:25.285319 140613433649152 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 18:00:25.285588 140613433649152 dqn_agent.py:272] 	 gamma: 0.990000
I0902 18:00:25.285957 140613433649152 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 18:00:25.286140 140613433649152 dqn_agent.py:274] 	 min_replay_history: 500
I0902 18:00:25.286292 140613433649152 dqn_agent.py:275] 	 update_period: 4
I0902 18:00:25.286489 140613433649152 dqn_agent.py:276] 	 target_update_period: 300
I0902 18:00:25.286730 140613433649152 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 18:00:25.286849 140613433649152 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 18:00:25.286999 140613433649152 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 18:00:25.287110 140613433649152 dqn_agent.py:280] 	 optimizer: adam
I0902 18:00:25.287232 140613433649152 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 18:00:25.287356 140613433649152 dqn_agent.py:283] 	 seed: 1630605625285258
I0902 18:00:25.290322 140613433649152 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 18:00:25.290518 140613433649152 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 18:00:25.290649 140613433649152 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 18:00:25.290772 140613433649152 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 18:00:25.291076 140613433649152 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 18:00:25.291239 140613433649152 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 18:00:25.291369 140613433649152 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 18:00:25.291489 140613433649152 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 18:00:25.291606 140613433649152 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 18:00:25.367618 140613433649152 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.500000
I0902 18:00:25.392720 140613433649152 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 18:00:25.393137 140613433649152 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 165.19
I0902 18:00:31.447370 140613433649152 replay_runner.py:36] Average training steps per second: 165.19
Steps executed: 246 Episode length: 75 Return: -109.31131808296945
I0902 18:00:32.558665 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -217.44
INFO:tensorflow:Starting iteration 1

Steps executed: 255 Episode length: 56 Return: -137.24294611609663
INFO:tensorflow:Average training steps per second: 226.71
I0902 18:00:41.271732 140613433649152 replay_runner.py:36] Average training steps per second: 226.71
I0902 18:00:41.480822 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.88
INFO:tensorflow:Starting iteration 2

Steps executed: 86 Episode length: 86 Return: -155.788878780890363
INFO:tensorflow:Average training steps per second: 221.17

Steps executed: 290 Episode length: 204 Return: -90.86485479814687
I0902 18:00:50.589968 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.33
INFO:tensorflow:Starting iteration 3

Steps executed: 241 Episode length: 74 Return: -165.63719571733816
INFO:tensorflow:Average training steps per second: 222.80
I0902 18:00:59.399680 140613433649152 replay_runner.py:36] Average training steps per second: 222.80
I0902 18:00:59.593682 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.67
INFO:tensorflow:Starting iteration 4

Steps executed: 188 Episode length: 91 Return: -434.93541149177476
INFO:tensorflow:Average training steps per second: 223.49

Steps executed: 264 Episode length: 76 Return: -364.87366871618356
I0902 18:01:08.587013 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.07
INFO:tensorflow:Starting iteration 5

Steps executed: 341 Episode length: 162 Return: -475.40661620823613
INFO:tensorflow:Average training steps per second: 223.35
I0902 18:01:17.363186 140613433649152 replay_runner.py:36] Average training steps per second: 223.35
I0902 18:01:17.654042 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -432.87
INFO:tensorflow:Starting iteration 6

Steps executed: 211 Episode length: 86 Return: -223.398171716114865
INFO:tensorflow:Average training steps per second: 218.84
I0902 18:01:26.455081 140613433649152 replay_runner.py:36] Average training steps per second: 218.84
I0902 18:01:26.609447 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -184.26
INFO:tensorflow:Starting iteration 7

Steps executed: 215 Episode length: 86 Return: -274.688967651526315
INFO:tensorflow:Average training steps per second: 220.87
I0902 18:01:35.525076 140613433649152 replay_runner.py:36] Average training steps per second: 220.87
I0902 18:01:35.703248 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -207.74
INFO:tensorflow:Starting iteration 8
I0902 18:01:40.057358 140613433649152 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 213.91

Steps executed: 252 Episode length: 93 Return: -352.748154618169865
I0902 18:01:44.976793 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -455.49
INFO:tensorflow:Starting iteration 9

Steps executed: 270 Episode length: 145 Return: -567.46750236219457
INFO:tensorflow:Average training steps per second: 219.29
I0902 18:01:53.837054 140613433649152 replay_runner.py:36] Average training steps per second: 219.29
I0902 18:01:54.079153 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -355.65
INFO:tensorflow:Starting iteration 10
I0902 18:01:58.354583 140613433649152 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 233.02

Steps executed: 256 Episode length: 103 Return: -244.94241608033767
I0902 18:02:02.862757 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.28
INFO:tensorflow:Starting iteration 11

Steps executed: 257 Episode length: 172 Return: -507.60378973507835
INFO:tensorflow:Average training steps per second: 224.69
I0902 18:02:11.582840 140613433649152 replay_runner.py:36] Average training steps per second: 224.69
I0902 18:02:11.792640 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.96
INFO:tensorflow:Starting iteration 12

Steps executed: 306 Episode length: 197 Return: -606.98468552205485
INFO:tensorflow:Average training steps per second: 227.17
I0902 18:02:20.391767 140613433649152 replay_runner.py:36] Average training steps per second: 227.17
I0902 18:02:20.677563 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -598.50
INFO:tensorflow:Starting iteration 13

Steps executed: 303 Episode length: 141 Return: -0.22307027034671023
INFO:tensorflow:Average training steps per second: 224.43
I0902 18:02:29.406781 140613433649152 replay_runner.py:36] Average training steps per second: 224.43
I0902 18:02:29.674247 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -210.33
INFO:tensorflow:Starting iteration 14

Steps executed: 164 Episode length: 164 Return: -379.922300329649623
INFO:tensorflow:Average training steps per second: 215.69
I0902 18:02:38.640192 140613433649152 replay_runner.py:36] Average training steps per second: 215.69

Steps executed: 350 Episode length: 186 Return: -342.599199155233123
INFO:tensorflow:Starting iteration 15

Steps executed: 321 Episode length: 156 Return: -503.018303846286963
INFO:tensorflow:Average training steps per second: 225.65
I0902 18:02:47.638953 140613433649152 replay_runner.py:36] Average training steps per second: 225.65
I0902 18:02:47.947827 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.05
INFO:tensorflow:Starting iteration 16

Steps executed: 306 Episode length: 147 Return: -473.109578681954863
INFO:tensorflow:Average training steps per second: 225.64
I0902 18:02:56.551031 140613433649152 replay_runner.py:36] Average training steps per second: 225.64
I0902 18:02:56.799826 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -454.40
INFO:tensorflow:Starting iteration 17

Steps executed: 329 Episode length: 139 Return: -460.720411066038253
INFO:tensorflow:Average training steps per second: 225.65
I0902 18:03:05.449916 140613433649152 replay_runner.py:36] Average training steps per second: 225.65
I0902 18:03:05.774271 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -410.21
INFO:tensorflow:Starting iteration 18

Steps executed: 228 Episode length: 93 Return: -325.0834804221283453
INFO:tensorflow:Average training steps per second: 222.83
I0902 18:03:14.551488 140613433649152 replay_runner.py:36] Average training steps per second: 222.83
I0902 18:03:14.761249 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -318.57
INFO:tensorflow:Starting iteration 19

Steps executed: 246 Episode length: 145 Return: -399.458290096052953
INFO:tensorflow:Average training steps per second: 219.14
I0902 18:03:23.667646 140613433649152 replay_runner.py:36] Average training steps per second: 219.14
I0902 18:03:23.913506 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -330.39
INFO:tensorflow:Starting iteration 20

Steps executed: 248 Episode length: 129 Return: -455.666724301993273
INFO:tensorflow:Average training steps per second: 221.46
I0902 18:03:32.753856 140613433649152 replay_runner.py:36] Average training steps per second: 221.46
I0902 18:03:32.995544 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.01
INFO:tensorflow:Starting iteration 21

Steps executed: 231 Episode length: 231 Return: -321.761816617389473
INFO:tensorflow:Average training steps per second: 210.35
I0902 18:03:42.095834 140613433649152 replay_runner.py:36] Average training steps per second: 210.35
I0902 18:03:42.336364 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -321.76
INFO:tensorflow:Starting iteration 22
I0902 18:03:46.689901 140613433649152 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 220.30

Steps executed: 246 Episode length: 110 Return: -238.334341368251873
I0902 18:03:51.447903 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.88
INFO:tensorflow:Starting iteration 23

Steps executed: 324 Episode length: 222 Return: 3.798582975775005473
INFO:tensorflow:Average training steps per second: 217.19
I0902 18:04:00.385078 140613433649152 replay_runner.py:36] Average training steps per second: 217.19
I0902 18:04:00.708301 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -342.49
INFO:tensorflow:Starting iteration 24

Steps executed: 205 Episode length: 98 Return: -591.9957670952138773
INFO:tensorflow:Average training steps per second: 217.27
I0902 18:04:09.480148 140613433649152 replay_runner.py:36] Average training steps per second: 217.27
I0902 18:04:09.665512 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -608.79
INFO:tensorflow:Starting iteration 25

Steps executed: 258 Episode length: 258 Return: -21.6600562073843723
INFO:tensorflow:Average training steps per second: 214.79
I0902 18:04:18.593361 140613433649152 replay_runner.py:36] Average training steps per second: 214.79
I0902 18:04:18.871142 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -21.66
INFO:tensorflow:Starting iteration 26

Steps executed: 285 Episode length: 128 Return: -419.722395150664453
INFO:tensorflow:Average training steps per second: 216.17
I0902 18:04:27.777066 140613433649152 replay_runner.py:36] Average training steps per second: 216.17
I0902 18:04:28.044970 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.43
INFO:tensorflow:Starting iteration 27

Steps executed: 275 Episode length: 131 Return: -435.290283096682133
INFO:tensorflow:Average training steps per second: 219.28
I0902 18:04:36.698909 140613433649152 replay_runner.py:36] Average training steps per second: 219.28
I0902 18:04:36.948707 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -269.31
INFO:tensorflow:Starting iteration 28

Steps executed: 243 Episode length: 149 Return: -358.467180838153073
INFO:tensorflow:Average training steps per second: 220.79
I0902 18:04:45.901602 140613433649152 replay_runner.py:36] Average training steps per second: 220.79
I0902 18:04:46.119288 140613433649152 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.95
INFO:tensorflow:Starting iteration 29

Steps executed: 265 Episode length: 81 Return: -445.3886809870083443
INFO:tensorflow:Average training steps per second: 222.35
I0902 18:04:54.745718 140613433649152 replay_runner.py:36] Average training steps per second: 222.35

Done fixed training!Episode length: 81 Return: -445.3886809870083443