Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 23:15:09.109565 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:15:09.121338 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:09.121599 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:09.121739 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:09.121842 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:09.121930 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:09.122016 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:09.122145 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:09.122251 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:09.122348 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:09.122450 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:09.122548 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:09.123013 140006414895104 dqn_agent.py:283] 	 seed: 1630624509121276
I0902 23:15:09.126140 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:09.126365 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:09.126535 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:09.126643 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:09.126730 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:09.126800 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:09.126877 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:09.126985 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:09.127084 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:09.158935 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:09.592816 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:09.628372 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:15:09.637205 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:15:09.637492 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:15:09.637868 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:15:09.638025 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:15:09.638197 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:15:09.638289 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:15:09.638417 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:15:09.638557 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:15:09.638748 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:15:09.638863 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:15:09.638973 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:15:09.639108 140006414895104 dqn_agent.py:283] 	 seed: 1630624509637152
I0902 23:15:09.641728 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:15:09.641900 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:15:09.641999 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:15:09.642104 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:15:09.642184 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:15:09.642269 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:15:09.642486 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:15:09.642644 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:15:09.642989 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:15:09.669661 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:15:09.692827 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:15:09.693139 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 166.97
I0902 23:15:15.682676 140006414895104 replay_runner.py:36] Average training steps per second: 166.97
Steps executed: 214 Episode length: 86 Return: -114.18249947883453
I0902 23:15:16.841014 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.71
INFO:tensorflow:Starting iteration 1

Steps executed: 202 Episode length: 53 Return: -70.302332944551384
INFO:tensorflow:Average training steps per second: 217.36
I0902 23:15:25.942341 140006414895104 replay_runner.py:36] Average training steps per second: 217.36
I0902 23:15:26.074567 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.36
INFO:tensorflow:Starting iteration 2

Steps executed: 201 Episode length: 64 Return: -109.47725684584279
INFO:tensorflow:Average training steps per second: 221.64
I0902 23:15:34.890840 140006414895104 replay_runner.py:36] Average training steps per second: 221.64
I0902 23:15:35.024488 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -143.47
INFO:tensorflow:Starting iteration 3

Steps executed: 253 Episode length: 58 Return: -135.50144056236442
INFO:tensorflow:Average training steps per second: 230.02
I0902 23:15:43.669624 140006414895104 replay_runner.py:36] Average training steps per second: 230.02
I0902 23:15:43.830521 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.13
INFO:tensorflow:Starting iteration 4

Steps executed: 237 Episode length: 59 Return: -139.16240371194738
INFO:tensorflow:Average training steps per second: 229.37
I0902 23:15:52.415156 140006414895104 replay_runner.py:36] Average training steps per second: 229.37
I0902 23:15:52.535997 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.33
INFO:tensorflow:Starting iteration 5

Steps executed: 208 Episode length: 67 Return: -35.328384614193254
INFO:tensorflow:Average training steps per second: 244.61
I0902 23:16:00.605763 140006414895104 replay_runner.py:36] Average training steps per second: 244.61
I0902 23:16:00.722388 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.79
INFO:tensorflow:Starting iteration 6

Steps executed: 225 Episode length: 72 Return: -48.320379973472031
INFO:tensorflow:Average training steps per second: 234.14
I0902 23:16:09.150710 140006414895104 replay_runner.py:36] Average training steps per second: 234.14
I0902 23:16:09.302559 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.38
INFO:tensorflow:Starting iteration 7

Steps executed: 275 Episode length: 86 Return: -191.06855678105953
INFO:tensorflow:Average training steps per second: 219.98
I0902 23:16:18.108357 140006414895104 replay_runner.py:36] Average training steps per second: 219.98
I0902 23:16:18.281360 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -162.79
INFO:tensorflow:Starting iteration 8

Steps executed: 254 Episode length: 58 Return: -148.06805515876954
INFO:tensorflow:Average training steps per second: 220.09
I0902 23:16:27.190705 140006414895104 replay_runner.py:36] Average training steps per second: 220.09
I0902 23:16:27.350141 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.94
INFO:tensorflow:Starting iteration 9

Steps executed: 219 Episode length: 69 Return: -142.71991962564599
INFO:tensorflow:Average training steps per second: 218.64
I0902 23:16:36.270626 140006414895104 replay_runner.py:36] Average training steps per second: 218.64
I0902 23:16:36.407523 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.56
INFO:tensorflow:Starting iteration 10

Steps executed: 233 Episode length: 84 Return: -123.17529761046047
INFO:tensorflow:Average training steps per second: 219.51
I0902 23:16:45.264820 140006414895104 replay_runner.py:36] Average training steps per second: 219.51
I0902 23:16:45.409965 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.57
INFO:tensorflow:Starting iteration 11

Steps executed: 206 Episode length: 75 Return: -187.63921623048162
INFO:tensorflow:Average training steps per second: 218.31
I0902 23:16:54.356450 140006414895104 replay_runner.py:36] Average training steps per second: 218.31
I0902 23:16:54.486087 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.45
INFO:tensorflow:Starting iteration 12

Steps executed: 241 Episode length: 75 Return: -147.05600615321838
INFO:tensorflow:Average training steps per second: 221.64
I0902 23:17:03.360123 140006414895104 replay_runner.py:36] Average training steps per second: 221.64
I0902 23:17:03.515212 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.99
INFO:tensorflow:Starting iteration 13

Steps executed: 252 Episode length: 54 Return: -104.12274827124119
INFO:tensorflow:Average training steps per second: 220.26
I0902 23:17:12.466105 140006414895104 replay_runner.py:36] Average training steps per second: 220.26
I0902 23:17:12.623481 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.29
INFO:tensorflow:Starting iteration 14

Steps executed: 229 Episode length: 93 Return: -27.188801918303483
INFO:tensorflow:Average training steps per second: 216.54
I0902 23:17:21.663203 140006414895104 replay_runner.py:36] Average training steps per second: 216.54
I0902 23:17:21.803936 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.04
INFO:tensorflow:Starting iteration 15

Steps executed: 253 Episode length: 60 Return: -99.191391537405486
INFO:tensorflow:Average training steps per second: 220.28
I0902 23:17:30.758268 140006414895104 replay_runner.py:36] Average training steps per second: 220.28
I0902 23:17:30.926182 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.97
INFO:tensorflow:Starting iteration 16

Steps executed: 248 Episode length: 53 Return: -134.28719001099813
INFO:tensorflow:Average training steps per second: 221.21
I0902 23:17:39.864236 140006414895104 replay_runner.py:36] Average training steps per second: 221.21
I0902 23:17:40.027706 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -131.87
INFO:tensorflow:Starting iteration 17

Steps executed: 92 Episode length: 92 Return: 23.34402055735488813
INFO:tensorflow:Average training steps per second: 218.81
I0902 23:17:48.869815 140006414895104 replay_runner.py:36] Average training steps per second: 218.81

Steps executed: 254 Episode length: 76 Return: -204.61659886410615
INFO:tensorflow:Starting iteration 18

Steps executed: 230 Episode length: 90 Return: -115.95978502205178
INFO:tensorflow:Average training steps per second: 218.85
I0902 23:17:57.814323 140006414895104 replay_runner.py:36] Average training steps per second: 218.85
I0902 23:17:57.964890 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -154.52
INFO:tensorflow:Starting iteration 19

Steps executed: 131 Episode length: 76 Return: -138.17845816516115
INFO:tensorflow:Average training steps per second: 220.00
I0902 23:18:06.908254 140006414895104 replay_runner.py:36] Average training steps per second: 220.00

Steps executed: 214 Episode length: 83 Return: -195.01446205035757
INFO:tensorflow:Starting iteration 20

Steps executed: 251 Episode length: 78 Return: -114.77982803102444
INFO:tensorflow:Average training steps per second: 215.63
I0902 23:18:16.030696 140006414895104 replay_runner.py:36] Average training steps per second: 215.63
I0902 23:18:16.196304 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.62
INFO:tensorflow:Starting iteration 21
I0902 23:18:20.637081 140006414895104 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 220.79

Steps executed: 248 Episode length: 57 Return: -107.70381360713642
I0902 23:18:25.325431 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -123.05
INFO:tensorflow:Starting iteration 22

Steps executed: 260 Episode length: 77 Return: -131.62641575836415
INFO:tensorflow:Average training steps per second: 218.34
I0902 23:18:34.330795 140006414895104 replay_runner.py:36] Average training steps per second: 218.34
I0902 23:18:34.490510 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -116.34
INFO:tensorflow:Starting iteration 23

Steps executed: 142 Episode length: 61 Return: -129.85265372869148
INFO:tensorflow:Average training steps per second: 228.34
I0902 23:18:43.148954 140006414895104 replay_runner.py:36] Average training steps per second: 228.34

Steps executed: 228 Episode length: 86 Return: -151.83481579653466
INFO:tensorflow:Starting iteration 24

Steps executed: 266 Episode length: 77 Return: -166.39752276947314
INFO:tensorflow:Average training steps per second: 231.53
I0902 23:18:51.953203 140006414895104 replay_runner.py:36] Average training steps per second: 231.53
I0902 23:18:52.110493 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.76
INFO:tensorflow:Starting iteration 25

Steps executed: 276 Episode length: 87 Return: -162.66156744690365
INFO:tensorflow:Average training steps per second: 244.25
I0902 23:19:00.444073 140006414895104 replay_runner.py:36] Average training steps per second: 244.25
I0902 23:19:00.600215 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.86
INFO:tensorflow:Starting iteration 26

Steps executed: 244 Episode length: 68 Return: -159.16494063388032
INFO:tensorflow:Average training steps per second: 230.76
I0902 23:19:09.173404 140006414895104 replay_runner.py:36] Average training steps per second: 230.76
I0902 23:19:09.311380 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.54
INFO:tensorflow:Starting iteration 27

Steps executed: 219 Episode length: 72 Return: -159.88486962881818
INFO:tensorflow:Average training steps per second: 239.72
I0902 23:19:17.793219 140006414895104 replay_runner.py:36] Average training steps per second: 239.72
I0902 23:19:17.924949 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.60
INFO:tensorflow:Starting iteration 28

Steps executed: 272 Episode length: 83 Return: -107.38219556657589
INFO:tensorflow:Average training steps per second: 224.05
I0902 23:19:26.743305 140006414895104 replay_runner.py:36] Average training steps per second: 224.05
I0902 23:19:26.917477 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.65
INFO:tensorflow:Starting iteration 29

Steps executed: 200 Episode length: 77 Return: -146.51033616518493
INFO:tensorflow:Average training steps per second: 222.33
I0902 23:19:35.824518 140006414895104 replay_runner.py:36] Average training steps per second: 222.33

Done fixed training!Episode length: 77 Return: -146.51033616518493