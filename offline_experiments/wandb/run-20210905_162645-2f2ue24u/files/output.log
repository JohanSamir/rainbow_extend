Loaded trained dqn in cartpole
Training fixed agent 4, please be patient, may be a while...
I0905 16:26:51.298083 140532473354240 run_experiment.py:549] Creating TrainRunner ...
I0905 16:26:51.304425 140532473354240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:26:51.304587 140532473354240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:26:51.304705 140532473354240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:26:51.304778 140532473354240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:26:51.304853 140532473354240 dqn_agent.py:275] 	 update_period: 4
I0905 16:26:51.304978 140532473354240 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:26:51.305086 140532473354240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:26:51.305196 140532473354240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:26:51.305314 140532473354240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:26:51.305420 140532473354240 dqn_agent.py:280] 	 optimizer: adam
I0905 16:26:51.305530 140532473354240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:26:51.305622 140532473354240 dqn_agent.py:283] 	 seed: 1630859211304386
I0905 16:26:51.307795 140532473354240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:26:51.307920 140532473354240 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:26:51.308007 140532473354240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:26:51.308080 140532473354240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:26:51.308145 140532473354240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:26:51.308213 140532473354240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:26:51.308292 140532473354240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:26:51.308401 140532473354240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:26:51.308477 140532473354240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:26:52.611616 140532473354240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:26:53.030676 140532473354240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:26:53.039169 140532473354240 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 16:26:53.044618 140532473354240 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 16:26:53.044761 140532473354240 dqn_agent.py:272] 	 gamma: 0.990000
I0905 16:26:53.044839 140532473354240 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 16:26:53.044901 140532473354240 dqn_agent.py:274] 	 min_replay_history: 500
I0905 16:26:53.044957 140532473354240 dqn_agent.py:275] 	 update_period: 4
I0905 16:26:53.045028 140532473354240 dqn_agent.py:276] 	 target_update_period: 100
I0905 16:26:53.045112 140532473354240 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 16:26:53.045205 140532473354240 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 16:26:53.045265 140532473354240 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 16:26:53.045334 140532473354240 dqn_agent.py:280] 	 optimizer: adam
I0905 16:26:53.045405 140532473354240 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 16:26:53.045481 140532473354240 dqn_agent.py:283] 	 seed: 1630859213044584
I0905 16:26:53.046918 140532473354240 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 16:26:53.047038 140532473354240 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0905 16:26:53.047122 140532473354240 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 16:26:53.047205 140532473354240 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 16:26:53.047263 140532473354240 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 16:26:53.047330 140532473354240 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 16:26:53.047420 140532473354240 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 16:26:53.047481 140532473354240 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 16:26:53.047556 140532473354240 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 16:26:53.066612 140532473354240 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 16:26:53.089469 140532473354240 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 16:26:53.089715 140532473354240 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 186.26
I0905 16:26:58.458864 140532473354240 replay_runner.py:36] Average training steps per second: 186.26
I0905 16:26:59.164996 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1
I0905 16:26:59.301489 140532473354240 replay_runner.py:41] Starting iteration 1

Steps executed: 202 Episode length: 10 Return: 10.0
INFO:tensorflow:Average training steps per second: 289.82
I0905 16:27:02.752121 140532473354240 replay_runner.py:36] Average training steps per second: 289.82
I0905 16:27:02.828405 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.18
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 273.29
I0905 16:27:06.630123 140532473354240 replay_runner.py:36] Average training steps per second: 273.29
I0905 16:27:06.716765 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0905 16:27:06.868956 140532473354240 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 271.83
I0905 16:27:10.548006 140532473354240 replay_runner.py:36] Average training steps per second: 271.83
I0905 16:27:10.627312 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0905 16:27:10.784058 140532473354240 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 261.48
I0905 16:27:14.608676 140532473354240 replay_runner.py:36] Average training steps per second: 261.48
I0905 16:27:14.691739 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 340 Episode length: 180 Return: 180.0
INFO:tensorflow:Average training steps per second: 264.03
I0905 16:27:18.640063 140532473354240 replay_runner.py:36] Average training steps per second: 264.03
I0905 16:27:18.790217 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 170.00
INFO:tensorflow:Starting iteration 6

Steps executed: 290 Episode length: 144 Return: 144.0
INFO:tensorflow:Average training steps per second: 254.14
I0905 16:27:22.873016 140532473354240 replay_runner.py:36] Average training steps per second: 254.14
I0905 16:27:23.005614 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 145.00
INFO:tensorflow:Starting iteration 7

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 268.46
I0905 16:27:26.898001 140532473354240 replay_runner.py:36] Average training steps per second: 268.46
I0905 16:27:26.979656 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 8

Steps executed: 303 Episode length: 149 Return: 149.0
INFO:tensorflow:Average training steps per second: 268.45
I0905 16:27:30.862203 140532473354240 replay_runner.py:36] Average training steps per second: 268.45
I0905 16:27:30.996124 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 151.50
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 269.02
I0905 16:27:34.885118 140532473354240 replay_runner.py:36] Average training steps per second: 269.02
I0905 16:27:34.971766 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0905 16:27:35.202422 140532473354240 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 265.47
I0905 16:27:38.969749 140532473354240 replay_runner.py:36] Average training steps per second: 265.47
I0905 16:27:39.061720 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 372 Episode length: 195 Return: 195.0
INFO:tensorflow:Average training steps per second: 267.85
I0905 16:27:42.948763 140532473354240 replay_runner.py:36] Average training steps per second: 267.85
I0905 16:27:43.112860 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 186.00
INFO:tensorflow:Starting iteration 12

Steps executed: 301 Episode length: 151 Return: 151.0
INFO:tensorflow:Average training steps per second: 273.72
I0905 16:27:46.917014 140532473354240 replay_runner.py:36] Average training steps per second: 273.72
I0905 16:27:47.050587 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.50
INFO:tensorflow:Starting iteration 13

Steps executed: 310 Episode length: 158 Return: 158.0
INFO:tensorflow:Average training steps per second: 256.92
I0905 16:27:51.093760 140532473354240 replay_runner.py:36] Average training steps per second: 256.92
I0905 16:27:51.228485 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 155.00
INFO:tensorflow:Starting iteration 14

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 269.78
I0905 16:27:55.103043 140532473354240 replay_runner.py:36] Average training steps per second: 269.78
I0905 16:27:55.188487 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 15

Steps executed: 336 Episode length: 169 Return: 169.0
INFO:tensorflow:Average training steps per second: 259.16
I0905 16:27:59.196008 140532473354240 replay_runner.py:36] Average training steps per second: 259.16
I0905 16:27:59.341197 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 168.00
INFO:tensorflow:Starting iteration 16

Steps executed: 324 Episode length: 165 Return: 165.0
INFO:tensorflow:Average training steps per second: 262.14
I0905 16:28:03.387577 140532473354240 replay_runner.py:36] Average training steps per second: 262.14
I0905 16:28:03.531826 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.00
INFO:tensorflow:Starting iteration 17

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 262.74
I0905 16:28:07.488494 140532473354240 replay_runner.py:36] Average training steps per second: 262.74
I0905 16:28:07.571304 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 18
I0905 16:28:07.721326 140532473354240 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 242.11
I0905 16:28:11.852220 140532473354240 replay_runner.py:36] Average training steps per second: 242.11
I0905 16:28:11.966548 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 19
I0905 16:28:12.127290 140532473354240 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 265.38
I0905 16:28:15.895846 140532473354240 replay_runner.py:36] Average training steps per second: 265.38
I0905 16:28:15.976491 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0905 16:28:16.134259 140532473354240 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 250.69
I0905 16:28:20.123574 140532473354240 replay_runner.py:36] Average training steps per second: 250.69
I0905 16:28:20.205825 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21

Steps executed: 325 Episode length: 143 Return: 143.0
INFO:tensorflow:Average training steps per second: 260.19
I0905 16:28:24.198214 140532473354240 replay_runner.py:36] Average training steps per second: 260.19
I0905 16:28:24.343851 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 162.50
INFO:tensorflow:Starting iteration 22

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 262.58
I0905 16:28:28.315322 140532473354240 replay_runner.py:36] Average training steps per second: 262.58
I0905 16:28:28.400284 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0905 16:28:28.553485 140532473354240 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 262.49
I0905 16:28:32.363542 140532473354240 replay_runner.py:36] Average training steps per second: 262.49
I0905 16:28:32.453052 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0905 16:28:32.613604 140532473354240 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 266.03
I0905 16:28:36.372899 140532473354240 replay_runner.py:36] Average training steps per second: 266.03
I0905 16:28:36.460531 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25

Steps executed: 345 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 263.95
I0905 16:28:40.405229 140532473354240 replay_runner.py:36] Average training steps per second: 263.95
I0905 16:28:40.562520 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 172.50
INFO:tensorflow:Starting iteration 26

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 264.18
I0905 16:28:44.519859 140532473354240 replay_runner.py:36] Average training steps per second: 264.18
I0905 16:28:44.606582 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27

Steps executed: 307 Episode length: 157 Return: 157.0
INFO:tensorflow:Average training steps per second: 266.87
I0905 16:28:48.510700 140532473354240 replay_runner.py:36] Average training steps per second: 266.87
I0905 16:28:48.652615 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.50
INFO:tensorflow:Starting iteration 28

Steps executed: 327 Episode length: 166 Return: 166.0
INFO:tensorflow:Average training steps per second: 274.70
I0905 16:28:52.449103 140532473354240 replay_runner.py:36] Average training steps per second: 274.70
I0905 16:28:52.590320 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 163.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 275.46
I0905 16:28:56.377667 140532473354240 replay_runner.py:36] Average training steps per second: 275.46
I0905 16:28:56.461428 140532473354240 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00