Loaded trained dqn in cartpole
Training fixed agent 10, please be patient, may be a while...
I0902 23:33:42.825460 140082076076032 run_experiment.py:549] Creating TrainRunner ...
I0902 23:33:42.834214 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:33:42.834412 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:33:42.834485 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:33:42.834546 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:33:42.834644 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:33:42.834731 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:33:42.834823 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:33:42.834900 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:33:42.834972 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:33:42.835027 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:33:42.835086 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:33:42.835140 140082076076032 dqn_agent.py:283] 	 seed: 1630625622834160
I0902 23:33:42.837147 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:33:42.837307 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:33:42.837456 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:33:42.837606 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:33:42.837775 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:33:42.837909 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:33:42.838010 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:33:42.838135 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:33:42.838263 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:33:42.879525 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:33:43.401023 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:33:43.418743 140082076076032 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:33:43.426954 140082076076032 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:33:43.427185 140082076076032 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:33:43.427295 140082076076032 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:33:43.427396 140082076076032 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:33:43.427479 140082076076032 dqn_agent.py:275] 	 update_period: 4
I0902 23:33:43.427557 140082076076032 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:33:43.427670 140082076076032 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:33:43.427765 140082076076032 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:33:43.427843 140082076076032 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:33:43.427997 140082076076032 dqn_agent.py:280] 	 optimizer: adam
I0902 23:33:43.428089 140082076076032 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:33:43.428218 140082076076032 dqn_agent.py:283] 	 seed: 1630625623426886
I0902 23:33:43.430549 140082076076032 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:33:43.430759 140082076076032 circular_replay_buffer.py:156] 	 observation_shape: (4, 1)
I0902 23:33:43.430855 140082076076032 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:33:43.430943 140082076076032 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:33:43.431022 140082076076032 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:33:43.431098 140082076076032 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:33:43.431172 140082076076032 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:33:43.431257 140082076076032 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:33:43.431328 140082076076032 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:33:43.458876 140082076076032 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:33:43.477709 140082076076032 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:33:43.477975 140082076076032 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 148.66
I0902 23:33:50.204855 140082076076032 replay_runner.py:36] Average training steps per second: 148.66
Steps executed: 208 Episode length: 10 Return: 10.0
I0902 23:33:51.355555 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 9.45
INFO:tensorflow:Starting iteration 1
I0902 23:33:51.545586 140082076076032 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 205.78

Steps executed: 375 Episode length: 198 Return: 198.0
I0902 23:33:56.672406 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 187.50
INFO:tensorflow:Starting iteration 2

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 196.31
I0902 23:34:01.956677 140082076076032 replay_runner.py:36] Average training steps per second: 196.31
I0902 23:34:02.078405 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 3
I0902 23:34:02.260653 140082076076032 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 197.23
I0902 23:34:07.331332 140082076076032 replay_runner.py:36] Average training steps per second: 197.23
I0902 23:34:07.473003 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 4
I0902 23:34:07.660230 140082076076032 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 194.40
I0902 23:34:12.804891 140082076076032 replay_runner.py:36] Average training steps per second: 194.40
I0902 23:34:12.947194 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 5

Steps executed: 244 Episode length: 112 Return: 112.0
INFO:tensorflow:Average training steps per second: 194.59
I0902 23:34:18.274345 140082076076032 replay_runner.py:36] Average training steps per second: 194.59
I0902 23:34:18.434103 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 122.00
INFO:tensorflow:Starting iteration 6

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 204.23
I0902 23:34:23.527668 140082076076032 replay_runner.py:36] Average training steps per second: 204.23
I0902 23:34:23.658581 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 7
I0902 23:34:23.844474 140082076076032 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 204.66

Steps executed: 342 Episode length: 176 Return: 176.0
I0902 23:34:28.944231 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.00
INFO:tensorflow:Starting iteration 8

Steps executed: 300 Episode length: 150 Return: 150.0
INFO:tensorflow:Average training steps per second: 202.34
I0902 23:34:34.074918 140082076076032 replay_runner.py:36] Average training steps per second: 202.34
I0902 23:34:34.262674 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 150.00
INFO:tensorflow:Starting iteration 9

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 205.19
I0902 23:34:39.318970 140082076076032 replay_runner.py:36] Average training steps per second: 205.19
I0902 23:34:39.449011 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 10
I0902 23:34:39.637212 140082076076032 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 205.92
I0902 23:34:44.493794 140082076076032 replay_runner.py:36] Average training steps per second: 205.92
I0902 23:34:44.632503 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 11

Steps executed: 266 Episode length: 136 Return: 136.0
INFO:tensorflow:Average training steps per second: 202.85
I0902 23:34:49.759319 140082076076032 replay_runner.py:36] Average training steps per second: 202.85
I0902 23:34:49.940401 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 133.00
INFO:tensorflow:Starting iteration 12
I0902 23:34:50.120212 140082076076032 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 202.80

Steps executed: 257 Episode length: 125 Return: 125.0
I0902 23:34:55.237167 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 13
I0902 23:34:55.444870 140082076076032 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 199.35
I0902 23:35:00.461532 140082076076032 replay_runner.py:36] Average training steps per second: 199.35
I0902 23:35:00.640986 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 128.50
INFO:tensorflow:Starting iteration 14

Steps executed: 255 Episode length: 127 Return: 127.0
INFO:tensorflow:Average training steps per second: 206.89
I0902 23:35:05.672828 140082076076032 replay_runner.py:36] Average training steps per second: 206.89
I0902 23:35:05.844826 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 127.50
INFO:tensorflow:Starting iteration 15

Steps executed: 240 Episode length: 122 Return: 122.0
INFO:tensorflow:Average training steps per second: 203.43
I0902 23:35:10.955404 140082076076032 replay_runner.py:36] Average training steps per second: 203.43
I0902 23:35:11.104928 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 16

Steps executed: 277 Episode length: 141 Return: 141.0
INFO:tensorflow:Average training steps per second: 193.95
I0902 23:35:16.447238 140082076076032 replay_runner.py:36] Average training steps per second: 193.95
I0902 23:35:16.607149 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 138.50
INFO:tensorflow:Starting iteration 17

Steps executed: 240 Episode length: 119 Return: 119.0
INFO:tensorflow:Average training steps per second: 205.87
I0902 23:35:21.640399 140082076076032 replay_runner.py:36] Average training steps per second: 205.87
I0902 23:35:21.810378 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 120.00
INFO:tensorflow:Starting iteration 18

Steps executed: 313 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 198.29
I0902 23:35:27.049831 140082076076032 replay_runner.py:36] Average training steps per second: 198.29
I0902 23:35:27.243454 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 156.50
INFO:tensorflow:Starting iteration 19

Steps executed: 200 Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 200.36
I0902 23:35:32.417922 140082076076032 replay_runner.py:36] Average training steps per second: 200.36
I0902 23:35:32.547972 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 20
I0902 23:35:32.734471 140082076076032 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 197.55
I0902 23:35:37.797031 140082076076032 replay_runner.py:36] Average training steps per second: 197.55
I0902 23:35:37.934199 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 21
I0902 23:35:38.127407 140082076076032 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 196.75
I0902 23:35:43.210307 140082076076032 replay_runner.py:36] Average training steps per second: 196.75
I0902 23:35:43.350609 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 22
I0902 23:35:43.544982 140082076076032 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 199.80
I0902 23:35:48.550291 140082076076032 replay_runner.py:36] Average training steps per second: 199.80
I0902 23:35:48.694662 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 23
I0902 23:35:48.895374 140082076076032 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 193.12
I0902 23:35:54.073943 140082076076032 replay_runner.py:36] Average training steps per second: 193.12
I0902 23:35:54.217500 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 24
I0902 23:35:54.418175 140082076076032 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 193.44
I0902 23:35:59.588031 140082076076032 replay_runner.py:36] Average training steps per second: 193.44
I0902 23:35:59.724761 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 25
I0902 23:35:59.900799 140082076076032 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 196.38
I0902 23:36:04.993610 140082076076032 replay_runner.py:36] Average training steps per second: 196.38
I0902 23:36:05.144107 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 26
I0902 23:36:05.329981 140082076076032 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 197.69
I0902 23:36:10.388709 140082076076032 replay_runner.py:36] Average training steps per second: 197.69
I0902 23:36:10.530265 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 27
I0902 23:36:10.716152 140082076076032 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 199.08
I0902 23:36:15.739893 140082076076032 replay_runner.py:36] Average training steps per second: 199.08
I0902 23:36:15.884816 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 28
I0902 23:36:16.076640 140082076076032 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 201.59
I0902 23:36:21.037735 140082076076032 replay_runner.py:36] Average training steps per second: 201.59
I0902 23:36:21.165841 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 200 Return: 200.0
INFO:tensorflow:Average training steps per second: 199.66
I0902 23:36:26.352129 140082076076032 replay_runner.py:36] Average training steps per second: 199.66
I0902 23:36:26.485926 140082076076032 run_experiment.py:428] Average undiscounted return per evaluation episode: 200.00