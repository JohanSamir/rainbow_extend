Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0905 18:55:51.853706 140258042054656 run_experiment.py:549] Creating TrainRunner ...
I0905 18:55:51.864939 140258042054656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:51.865246 140258042054656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:51.865434 140258042054656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:51.865597 140258042054656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:51.865839 140258042054656 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:51.865989 140258042054656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:51.866099 140258042054656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:51.866388 140258042054656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:51.866547 140258042054656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:51.866644 140258042054656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:51.866874 140258042054656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:51.867060 140258042054656 dqn_agent.py:283] 	 seed: 1630868151864880
I0905 18:55:51.869848 140258042054656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:51.869977 140258042054656 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:55:51.870374 140258042054656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:51.870529 140258042054656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:51.870661 140258042054656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:51.870779 140258042054656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:51.870952 140258042054656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:51.871070 140258042054656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:51.871187 140258042054656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:52.014931 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:52.458869 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:52.473877 140258042054656 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:55:52.482879 140258042054656 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:55:52.483125 140258042054656 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:55:52.483295 140258042054656 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:55:52.483473 140258042054656 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:55:52.483595 140258042054656 dqn_agent.py:275] 	 update_period: 4
I0905 18:55:52.483700 140258042054656 dqn_agent.py:276] 	 target_update_period: 100
I0905 18:55:52.483838 140258042054656 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:55:52.484000 140258042054656 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:55:52.484275 140258042054656 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:55:52.484449 140258042054656 dqn_agent.py:280] 	 optimizer: adam
I0905 18:55:52.484590 140258042054656 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:55:52.484715 140258042054656 dqn_agent.py:283] 	 seed: 1630868152482823
I0905 18:55:52.487226 140258042054656 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:55:52.487414 140258042054656 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0905 18:55:52.487524 140258042054656 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:55:52.487625 140258042054656 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:55:52.487717 140258042054656 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:55:52.487801 140258042054656 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:55:52.487879 140258042054656 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:55:52.488009 140258042054656 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:55:52.488127 140258042054656 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:55:52.533277 140258042054656 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:55:52.559422 140258042054656 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:55:52.559710 140258042054656 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 122.28
I0905 18:56:00.738185 140258042054656 replay_runner.py:36] Average training steps per second: 122.28
Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:56:02.601103 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0905 18:56:02.899678 140258042054656 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 174.55
I0905 18:56:08.629121 140258042054656 replay_runner.py:36] Average training steps per second: 174.55
I0905 18:56:09.310031 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0905 18:56:09.588997 140258042054656 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 158.34
I0905 18:56:15.905184 140258042054656 replay_runner.py:36] Average training steps per second: 158.34
I0905 18:56:16.551875 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0905 18:56:16.787932 140258042054656 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 160.84
I0905 18:56:23.005740 140258042054656 replay_runner.py:36] Average training steps per second: 160.84
I0905 18:56:23.666418 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0905 18:56:23.960645 140258042054656 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 171.28
I0905 18:56:29.799674 140258042054656 replay_runner.py:36] Average training steps per second: 171.28
I0905 18:56:30.517658 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0905 18:56:30.813214 140258042054656 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 164.33
I0905 18:56:36.899147 140258042054656 replay_runner.py:36] Average training steps per second: 164.33
I0905 18:56:37.605875 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0905 18:56:37.891814 140258042054656 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 169.24
I0905 18:56:43.801186 140258042054656 replay_runner.py:36] Average training steps per second: 169.24
I0905 18:56:44.556183 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0905 18:56:44.803664 140258042054656 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 166.29
I0905 18:56:50.817800 140258042054656 replay_runner.py:36] Average training steps per second: 166.29
I0905 18:56:51.658428 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 202 Episode length: 90 Return: -89.0.0
INFO:tensorflow:Average training steps per second: 158.01
I0905 18:56:58.283071 140258042054656 replay_runner.py:36] Average training steps per second: 158.01
I0905 18:56:58.581379 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.00
INFO:tensorflow:Starting iteration 9
I0905 18:56:58.830125 140258042054656 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 162.99

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:57:05.776810 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 253 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 157.20
I0905 18:57:12.447138 140258042054656 replay_runner.py:36] Average training steps per second: 157.20
I0905 18:57:12.811619 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -83.33
INFO:tensorflow:Starting iteration 11

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 178.27
I0905 18:57:18.689142 140258042054656 replay_runner.py:36] Average training steps per second: 178.27
I0905 18:57:19.445266 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 12

Steps executed: 584 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 159.04
I0905 18:57:26.035533 140258042054656 replay_runner.py:36] Average training steps per second: 159.04
I0905 18:57:27.062245 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.50
INFO:tensorflow:Starting iteration 13
I0905 18:57:27.376021 140258042054656 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 155.73

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:57:34.585629 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 14

Steps executed: 116 Episode length: 116 Return: -115.0
INFO:tensorflow:Average training steps per second: 150.42

Steps executed: 222 Episode length: 106 Return: -105.0
I0905 18:57:41.892464 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 15

Steps executed: 232 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 196.87
I0905 18:57:47.216653 140258042054656 replay_runner.py:36] Average training steps per second: 196.87
I0905 18:57:47.759821 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.00
INFO:tensorflow:Starting iteration 16

Steps executed: 294 Episode length: 181 Return: -180.0
INFO:tensorflow:Average training steps per second: 154.00
I0905 18:57:54.569963 140258042054656 replay_runner.py:36] Average training steps per second: 154.00
I0905 18:57:55.018344 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -146.00
INFO:tensorflow:Starting iteration 17
I0905 18:57:55.319033 140258042054656 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 155.36

Steps executed: 215 Episode length: 70 Return: -69.0.0
I0905 18:58:02.087707 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.67
INFO:tensorflow:Starting iteration 18

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 152.28
I0905 18:58:08.976135 140258042054656 replay_runner.py:36] Average training steps per second: 152.28
I0905 18:58:09.797093 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 19

Steps executed: 251 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 160.60
I0905 18:58:16.336588 140258042054656 replay_runner.py:36] Average training steps per second: 160.60
I0905 18:58:16.756938 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 20
I0905 18:58:17.058181 140258042054656 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 151.80

Steps executed: 500 Episode length: 500 Return: -500.0
I0905 18:58:24.421368 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 21
I0905 18:58:24.719915 140258042054656 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 156.42
I0905 18:58:31.113372 140258042054656 replay_runner.py:36] Average training steps per second: 156.42
I0905 18:58:32.004172 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 22
I0905 18:58:32.241514 140258042054656 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 170.63

Steps executed: 201 Episode length: 91 Return: -90.0.0
I0905 18:58:38.391143 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 158.13
I0905 18:58:45.014153 140258042054656 replay_runner.py:36] Average training steps per second: 158.13
I0905 18:58:45.861873 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 214 Episode length: 61 Return: -60.0.0
INFO:tensorflow:Average training steps per second: 182.42
I0905 18:58:51.648200 140258042054656 replay_runner.py:36] Average training steps per second: 182.42
I0905 18:58:52.022123 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.33
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 154.95
I0905 18:58:58.793896 140258042054656 replay_runner.py:36] Average training steps per second: 154.95
I0905 18:58:59.573027 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0905 18:58:59.876356 140258042054656 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 160.25
I0905 18:59:06.117364 140258042054656 replay_runner.py:36] Average training steps per second: 160.25
I0905 18:59:06.868208 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27
I0905 18:59:07.168036 140258042054656 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 161.59
I0905 18:59:13.357070 140258042054656 replay_runner.py:36] Average training steps per second: 161.59
I0905 18:59:14.114799 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 28

Steps executed: 268 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 163.53
I0905 18:59:20.466567 140258042054656 replay_runner.py:36] Average training steps per second: 163.53
I0905 18:59:20.863512 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -88.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 188.43
I0905 18:59:26.408293 140258042054656 replay_runner.py:36] Average training steps per second: 188.43
I0905 18:59:26.679013 140258042054656 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00