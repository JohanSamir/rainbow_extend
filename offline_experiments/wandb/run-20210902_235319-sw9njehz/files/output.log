Loaded trained dqn in acrobot
Training fixed agent 1, please be patient, may be a while...
I0902 23:53:26.103228 139719487477760 run_experiment.py:549] Creating TrainRunner ...
I0902 23:53:26.113075 139719487477760 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:53:26.113333 139719487477760 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:53:26.113479 139719487477760 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:53:26.113620 139719487477760 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:53:26.113738 139719487477760 dqn_agent.py:275] 	 update_period: 4
I0902 23:53:26.113898 139719487477760 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:53:26.114020 139719487477760 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:53:26.114163 139719487477760 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:53:26.114283 139719487477760 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:53:26.114411 139719487477760 dqn_agent.py:280] 	 optimizer: adam
I0902 23:53:26.114521 139719487477760 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:53:26.114714 139719487477760 dqn_agent.py:283] 	 seed: 1630626806113014
I0902 23:53:26.117908 139719487477760 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:53:26.118112 139719487477760 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:53:26.118249 139719487477760 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:53:26.118364 139719487477760 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:53:26.118475 139719487477760 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:53:26.118575 139719487477760 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:53:26.118671 139719487477760 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:53:26.118765 139719487477760 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:53:26.118859 139719487477760 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:53:26.160388 139719487477760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:53:26.627714 139719487477760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:53:26.642957 139719487477760 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:53:26.652231 139719487477760 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:53:26.652454 139719487477760 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:53:26.652571 139719487477760 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:53:26.652660 139719487477760 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:53:26.652748 139719487477760 dqn_agent.py:275] 	 update_period: 4
I0902 23:53:26.652848 139719487477760 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:53:26.653002 139719487477760 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:53:26.653117 139719487477760 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:53:26.653223 139719487477760 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:53:26.653326 139719487477760 dqn_agent.py:280] 	 optimizer: adam
I0902 23:53:26.653428 139719487477760 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:53:26.653558 139719487477760 dqn_agent.py:283] 	 seed: 1630626806652189
I0902 23:53:26.656929 139719487477760 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:53:26.657156 139719487477760 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:53:26.657351 139719487477760 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:53:26.657559 139719487477760 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:53:26.657682 139719487477760 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:53:26.657801 139719487477760 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:53:26.657921 139719487477760 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:53:26.658023 139719487477760 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:53:26.658121 139719487477760 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:53:26.693713 139719487477760 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:53:26.719639 139719487477760 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:53:26.719913 139719487477760 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 142.29
I0902 23:53:33.748250 139719487477760 replay_runner.py:36] Average training steps per second: 142.29
I0902 23:53:35.310222 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0902 23:53:35.555978 139719487477760 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 194.81
I0902 23:53:40.689546 139719487477760 replay_runner.py:36] Average training steps per second: 194.81
I0902 23:53:41.127562 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0902 23:53:41.376502 139719487477760 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 189.49
I0902 23:53:46.654144 139719487477760 replay_runner.py:36] Average training steps per second: 189.49
I0902 23:53:47.048897 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0902 23:53:47.276646 139719487477760 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 187.69
I0902 23:53:52.605104 139719487477760 replay_runner.py:36] Average training steps per second: 187.69
I0902 23:53:52.824729 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.00
INFO:tensorflow:Starting iteration 4

Steps executed: 238 Episode length: 124 Return: -123.0
INFO:tensorflow:Average training steps per second: 190.52
I0902 23:53:58.322468 139719487477760 replay_runner.py:36] Average training steps per second: 190.52
I0902 23:53:58.755470 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.72
I0902 23:54:04.384163 139719487477760 replay_runner.py:36] Average training steps per second: 185.72
I0902 23:54:04.731293 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -202.50
INFO:tensorflow:Starting iteration 6

Steps executed: 407 Episode length: 258 Return: -257.0
INFO:tensorflow:Average training steps per second: 189.74
I0902 23:54:10.240043 139719487477760 replay_runner.py:36] Average training steps per second: 189.74
I0902 23:54:10.800085 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -305.00
INFO:tensorflow:Starting iteration 7


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 194.16
I0902 23:54:16.206793 139719487477760 replay_runner.py:36] Average training steps per second: 194.16
I0902 23:54:16.610414 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8
I0902 23:54:16.851534 139719487477760 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 191.19
I0902 23:54:22.082174 139719487477760 replay_runner.py:36] Average training steps per second: 191.19
I0902 23:54:22.343397 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 9

Steps executed: 295 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 194.57
I0902 23:54:27.727825 139719487477760 replay_runner.py:36] Average training steps per second: 194.57
I0902 23:54:27.898439 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 10


Steps executed: 239 Episode length: 143 Return: -142.0
INFO:tensorflow:Average training steps per second: 189.66
I0902 23:54:33.424631 139719487477760 replay_runner.py:36] Average training steps per second: 189.66
I0902 23:54:33.639289 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -118.50
INFO:tensorflow:Starting iteration 11
I0902 23:54:33.910117 139719487477760 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 188.34
I0902 23:54:39.220260 139719487477760 replay_runner.py:36] Average training steps per second: 188.34
I0902 23:54:39.417029 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 12

Steps executed: 224 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 199.53
I0902 23:54:44.679086 139719487477760 replay_runner.py:36] Average training steps per second: 199.53
I0902 23:54:44.902915 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.33
INFO:tensorflow:Starting iteration 13

Steps executed: 262 Episode length: 83 Return: -82.0.0
INFO:tensorflow:Average training steps per second: 192.52

Steps executed: 215 Episode length: 107 Return: -106.0
I0902 23:54:50.498735 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -106.50
INFO:tensorflow:Starting iteration 14

Steps executed: 273 Episode length: 74 Return: -73.0.0
INFO:tensorflow:Average training steps per second: 194.32
I0902 23:54:55.878055 139719487477760 replay_runner.py:36] Average training steps per second: 194.32
I0902 23:54:56.108944 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -90.00
INFO:tensorflow:Starting iteration 15

Steps executed: 274 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 197.35
I0902 23:55:01.398056 139719487477760 replay_runner.py:36] Average training steps per second: 197.35
I0902 23:55:01.618551 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.00
INFO:tensorflow:Starting iteration 16
I0902 23:55:01.832938 139719487477760 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 188.47
I0902 23:55:07.139320 139719487477760 replay_runner.py:36] Average training steps per second: 188.47
I0902 23:55:07.352593 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -125.00
INFO:tensorflow:Starting iteration 17

Steps executed: 252 Episode length: 127 Return: -126.0
INFO:tensorflow:Average training steps per second: 201.71
I0902 23:55:12.556512 139719487477760 replay_runner.py:36] Average training steps per second: 201.71
I0902 23:55:12.742476 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.00
INFO:tensorflow:Starting iteration 18

Steps executed: 206 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 200.76


Steps executed: 200 Episode length: 90 Return: -89.0.0
I0902 23:55:18.132968 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 19

Steps executed: 288 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 192.12
I0902 23:55:23.572042 139719487477760 replay_runner.py:36] Average training steps per second: 192.12
I0902 23:55:23.831611 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -95.00
INFO:tensorflow:Starting iteration 20

Steps executed: 223 Episode length: 77 Return: -76.0.0
INFO:tensorflow:Average training steps per second: 194.34
I0902 23:55:29.227327 139719487477760 replay_runner.py:36] Average training steps per second: 194.34
I0902 23:55:29.399201 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 21

Steps executed: 374 Episode length: 374 Return: -373.0
INFO:tensorflow:Average training steps per second: 191.70
I0902 23:55:34.850768 139719487477760 replay_runner.py:36] Average training steps per second: 191.70
I0902 23:55:35.153845 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -373.00
INFO:tensorflow:Starting iteration 22

Steps executed: 683 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 200.61
I0902 23:55:40.384918 139719487477760 replay_runner.py:36] Average training steps per second: 200.61
I0902 23:55:40.960245 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -227.00
INFO:tensorflow:Starting iteration 23

Steps executed: 307 Episode length: 128 Return: -127.0
INFO:tensorflow:Average training steps per second: 195.07
I0902 23:55:46.396117 139719487477760 replay_runner.py:36] Average training steps per second: 195.07
I0902 23:55:46.651126 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.50
INFO:tensorflow:Starting iteration 24
I0902 23:55:46.882177 139719487477760 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 199.53
I0902 23:55:51.894236 139719487477760 replay_runner.py:36] Average training steps per second: 199.53
I0902 23:55:52.090574 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.33
INFO:tensorflow:Starting iteration 25


Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.55
I0902 23:55:57.245298 139719487477760 replay_runner.py:36] Average training steps per second: 203.55
I0902 23:55:57.632555 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26
I0902 23:55:57.863554 139719487477760 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 201.48
I0902 23:56:02.827188 139719487477760 replay_runner.py:36] Average training steps per second: 201.48
I0902 23:56:03.228118 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 27

Steps executed: 225 Episode length: 76 Return: -75.0.0
INFO:tensorflow:Average training steps per second: 201.92
I0902 23:56:08.407209 139719487477760 replay_runner.py:36] Average training steps per second: 201.92
I0902 23:56:08.588457 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.00
INFO:tensorflow:Starting iteration 28

Steps executed: 276 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 196.84
I0902 23:56:13.912505 139719487477760 replay_runner.py:36] Average training steps per second: 196.84
I0902 23:56:14.130117 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.85
I0902 23:56:19.528320 139719487477760 replay_runner.py:36] Average training steps per second: 193.85
I0902 23:56:19.922759 139719487477760 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00