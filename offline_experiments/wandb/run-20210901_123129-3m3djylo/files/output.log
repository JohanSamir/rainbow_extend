Loaded trained dqn in acrobot
Training fixed agent 6, please be patient, may be a while...
I0901 12:31:36.473336 140606607828992 run_experiment.py:549] Creating TrainRunner ...
I0901 12:31:36.484420 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:36.484719 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:36.484898 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:36.485208 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:36.485380 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:36.485485 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:36.485592 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:36.485669 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:36.485735 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:36.485801 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:36.485873 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:36.485968 140606607828992 dqn_agent.py:283] 	 seed: 1630499496484345
I0901 12:31:36.488542 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:36.488764 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:36.488925 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:36.489038 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:36.489165 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:36.489246 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:36.489314 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:36.489385 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:36.489448 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:36.533872 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:36.992614 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:37.009877 140606607828992 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:31:37.019917 140606607828992 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:31:37.020206 140606607828992 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:31:37.020347 140606607828992 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:31:37.020463 140606607828992 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:31:37.020567 140606607828992 dqn_agent.py:275] 	 update_period: 4
I0901 12:31:37.020766 140606607828992 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:31:37.021155 140606607828992 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:31:37.021304 140606607828992 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:31:37.021452 140606607828992 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:31:37.021569 140606607828992 dqn_agent.py:280] 	 optimizer: adam
I0901 12:31:37.021759 140606607828992 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:31:37.021930 140606607828992 dqn_agent.py:283] 	 seed: 1630499497019867
I0901 12:31:37.025912 140606607828992 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:31:37.026283 140606607828992 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:31:37.026611 140606607828992 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:31:37.026840 140606607828992 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:31:37.026943 140606607828992 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:31:37.027029 140606607828992 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:31:37.027130 140606607828992 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:31:37.027230 140606607828992 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:31:37.027315 140606607828992 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:31:37.060635 140606607828992 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:31:37.084636 140606607828992 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:31:37.084926 140606607828992 replay_runner.py:41] Starting iteration 0
Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 138.19
I0901 12:31:44.321874 140606607828992 replay_runner.py:36] Average training steps per second: 138.19
I0901 12:31:45.888791 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:31:46.135921 140606607828992 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 201.32
I0901 12:31:51.103617 140606607828992 replay_runner.py:36] Average training steps per second: 201.32
I0901 12:31:51.520256 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:31:51.763545 140606607828992 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 195.18
I0901 12:31:56.887406 140606607828992 replay_runner.py:36] Average training steps per second: 195.18
I0901 12:31:57.313463 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3

Steps executed: 275 Episode length: 171 Return: -170.0
INFO:tensorflow:Average training steps per second: 198.56
I0901 12:32:02.585361 140606607828992 replay_runner.py:36] Average training steps per second: 198.56
I0901 12:32:02.841022 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -136.50
INFO:tensorflow:Starting iteration 4
I0901 12:32:03.097619 140606607828992 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 197.83

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:32:08.583919 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:32:08.825239 140606607828992 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 192.73
I0901 12:32:14.014144 140606607828992 replay_runner.py:36] Average training steps per second: 192.73
I0901 12:32:14.469473 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6
I0901 12:32:14.726721 140606607828992 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 200.02
I0901 12:32:19.727087 140606607828992 replay_runner.py:36] Average training steps per second: 200.02
I0901 12:32:20.151338 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 7
I0901 12:32:20.397345 140606607828992 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 191.55
I0901 12:32:25.618408 140606607828992 replay_runner.py:36] Average training steps per second: 191.55
I0901 12:32:26.013596 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.50
INFO:tensorflow:Starting iteration 8


Steps executed: 224 Episode length: 105 Return: -104.0
INFO:tensorflow:Average training steps per second: 190.29
I0901 12:32:31.505884 140606607828992 replay_runner.py:36] Average training steps per second: 190.29
I0901 12:32:31.700086 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 9

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.85
I0901 12:32:36.951735 140606607828992 replay_runner.py:36] Average training steps per second: 199.85
I0901 12:32:37.374329 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10

Steps executed: 282 Episode length: 94 Return: -93.0.0
INFO:tensorflow:Average training steps per second: 189.40
I0901 12:32:42.889843 140606607828992 replay_runner.py:36] Average training steps per second: 189.40
I0901 12:32:43.127540 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -93.00
INFO:tensorflow:Starting iteration 11

Steps executed: 65 Episode length: 65 Return: -64.00.0
INFO:tensorflow:Average training steps per second: 194.74

Steps executed: 243 Episode length: 95 Return: -94.0.0
I0901 12:32:48.736382 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -80.00
INFO:tensorflow:Starting iteration 12

Steps executed: 182 Episode length: 182 Return: -181.0
INFO:tensorflow:Average training steps per second: 191.62

Steps executed: 682 Episode length: 500 Return: -500.0
I0901 12:32:54.815631 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.50
INFO:tensorflow:Starting iteration 13
I0901 12:32:55.061166 140606607828992 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 188.99

Steps executed: 580 Episode length: 500 Return: -500.0
I0901 12:33:00.853412 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.50
INFO:tensorflow:Starting iteration 14

Steps executed: 149 Episode length: 79 Return: -78.0.0
INFO:tensorflow:Average training steps per second: 196.84

Steps executed: 255 Episode length: 106 Return: -105.0
I0901 12:33:06.405691 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.00
INFO:tensorflow:Starting iteration 15

Steps executed: 277 Episode length: 172 Return: -171.0
INFO:tensorflow:Average training steps per second: 192.64
I0901 12:33:11.841194 140606607828992 replay_runner.py:36] Average training steps per second: 192.64
I0901 12:33:12.086749 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -137.50
INFO:tensorflow:Starting iteration 16

Steps executed: 222 Episode length: 98 Return: -97.0.0
INFO:tensorflow:Average training steps per second: 191.34
I0901 12:33:17.561506 140606607828992 replay_runner.py:36] Average training steps per second: 191.34
I0901 12:33:17.751925 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 17

Steps executed: 203 Episode length: 123 Return: -122.0
INFO:tensorflow:Average training steps per second: 194.35
I0901 12:33:23.147162 140606607828992 replay_runner.py:36] Average training steps per second: 194.35
I0901 12:33:23.321351 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 18

Steps executed: 224 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 191.11
I0901 12:33:28.805089 140606607828992 replay_runner.py:36] Average training steps per second: 191.11
I0901 12:33:28.990929 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.00
INFO:tensorflow:Starting iteration 19

Steps executed: 281 Episode length: 104 Return: -103.0
INFO:tensorflow:Average training steps per second: 197.55
I0901 12:33:34.294459 140606607828992 replay_runner.py:36] Average training steps per second: 197.55
I0901 12:33:34.529579 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -92.67
INFO:tensorflow:Starting iteration 20

Steps executed: 207 Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 192.28
I0901 12:33:39.974386 140606607828992 replay_runner.py:36] Average training steps per second: 192.28
I0901 12:33:40.146756 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.50
INFO:tensorflow:Starting iteration 21

Steps executed: 330 Episode length: 133 Return: -132.0
INFO:tensorflow:Average training steps per second: 193.40
I0901 12:33:45.553623 140606607828992 replay_runner.py:36] Average training steps per second: 193.40
I0901 12:33:45.825703 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 22

Steps executed: 231 Episode length: 113 Return: -112.0
INFO:tensorflow:Average training steps per second: 198.09
I0901 12:33:51.121861 140606607828992 replay_runner.py:36] Average training steps per second: 198.09
I0901 12:33:51.308066 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.50
INFO:tensorflow:Starting iteration 23
I0901 12:33:51.542043 140606607828992 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 198.22

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:33:56.998621 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 293 Episode length: 115 Return: -114.0
INFO:tensorflow:Average training steps per second: 208.78
I0901 12:34:02.021596 140606607828992 replay_runner.py:36] Average training steps per second: 208.78
I0901 12:34:02.253365 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.67
INFO:tensorflow:Starting iteration 25

Steps executed: 672 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 202.90
I0901 12:34:07.417665 140606607828992 replay_runner.py:36] Average training steps per second: 202.90
I0901 12:34:07.980723 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.33
INFO:tensorflow:Starting iteration 26

Steps executed: 203 Episode length: 109 Return: -108.0
INFO:tensorflow:Average training steps per second: 192.42
I0901 12:34:13.424076 140606607828992 replay_runner.py:36] Average training steps per second: 192.42
I0901 12:34:13.601704 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.50
INFO:tensorflow:Starting iteration 27

Steps executed: 213 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 190.93
I0901 12:34:19.090900 140606607828992 replay_runner.py:36] Average training steps per second: 190.93
I0901 12:34:19.272283 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -105.50
INFO:tensorflow:Starting iteration 28

Steps executed: 201 Episode length: 106 Return: -105.0
INFO:tensorflow:Average training steps per second: 193.28
I0901 12:34:24.691866 140606607828992 replay_runner.py:36] Average training steps per second: 193.28
I0901 12:34:24.858730 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.50
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 193.22
I0901 12:34:30.279431 140606607828992 replay_runner.py:36] Average training steps per second: 193.22
I0901 12:34:30.681415 140606607828992 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00