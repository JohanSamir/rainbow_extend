Loaded trained dqn in lunarlander
Training fixed agent 2, please be patient, may be a while...
I0902 23:19:49.867130 139735608805376 run_experiment.py:549] Creating TrainRunner ...
I0902 23:19:49.878669 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:49.879036 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:49.879310 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:49.879901 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:49.880098 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:49.880255 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:19:49.880424 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:49.880554 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:49.880682 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:49.880780 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:49.881016 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:49.881173 139735608805376 dqn_agent.py:283] 	 seed: 1630624789878591
I0902 23:19:49.884182 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:49.884377 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:19:49.884531 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:49.884646 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:49.884754 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:49.884856 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:49.885117 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:49.885237 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:49.885338 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:19:49.916672 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:50.293556 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:50.305970 139735608805376 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:19:50.314003 139735608805376 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:19:50.314197 139735608805376 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:19:50.314295 139735608805376 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:19:50.314482 139735608805376 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:19:50.314679 139735608805376 dqn_agent.py:275] 	 update_period: 4
I0902 23:19:50.314817 139735608805376 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:19:50.314904 139735608805376 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:19:50.315067 139735608805376 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:19:50.315165 139735608805376 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:19:50.315286 139735608805376 dqn_agent.py:280] 	 optimizer: adam
I0902 23:19:50.315432 139735608805376 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:19:50.315546 139735608805376 dqn_agent.py:283] 	 seed: 1630624790313959
I0902 23:19:50.317156 139735608805376 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:19:50.317273 139735608805376 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:19:50.317367 139735608805376 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:19:50.317630 139735608805376 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:19:50.317789 139735608805376 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:19:50.318006 139735608805376 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:19:50.318142 139735608805376 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:19:50.318273 139735608805376 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:19:50.318364 139735608805376 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:19:50.341820 139735608805376 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:19:50.394468 139735608805376 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:19:50.394667 139735608805376 replay_runner.py:41] Starting iteration 0
Steps executed: 222 Episode length: 73 Return: -770.1151098474452
INFO:tensorflow:Average training steps per second: 172.25
I0902 23:19:56.200433 139735608805376 replay_runner.py:36] Average training steps per second: 172.25
I0902 23:19:57.368267 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -646.79
INFO:tensorflow:Starting iteration 1

Steps executed: 245 Episode length: 58 Return: -548.34836531368616
INFO:tensorflow:Average training steps per second: 223.60
I0902 23:20:06.107960 139735608805376 replay_runner.py:36] Average training steps per second: 223.60
I0902 23:20:06.316800 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.03
INFO:tensorflow:Starting iteration 2

Steps executed: 212 Episode length: 60 Return: -584.55266442307246
INFO:tensorflow:Average training steps per second: 221.49
I0902 23:20:15.127265 139735608805376 replay_runner.py:36] Average training steps per second: 221.49
I0902 23:20:15.322438 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -670.16
INFO:tensorflow:Starting iteration 3

Steps executed: 226 Episode length: 55 Return: -414.20459340244126
INFO:tensorflow:Average training steps per second: 214.54
I0902 23:20:24.339768 139735608805376 replay_runner.py:36] Average training steps per second: 214.54
I0902 23:20:24.540895 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -489.01
INFO:tensorflow:Starting iteration 4

Steps executed: 238 Episode length: 54 Return: -470.41044914524936
INFO:tensorflow:Average training steps per second: 218.09
I0902 23:20:33.237279 139735608805376 replay_runner.py:36] Average training steps per second: 218.09
I0902 23:20:33.454675 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -472.70
INFO:tensorflow:Starting iteration 5

Steps executed: 201 Episode length: 54 Return: -405.66533525913684
INFO:tensorflow:Average training steps per second: 215.88
I0902 23:20:42.348126 139735608805376 replay_runner.py:36] Average training steps per second: 215.88
I0902 23:20:42.531250 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.21
INFO:tensorflow:Starting iteration 6

Steps executed: 192 Episode length: 82 Return: -439.87020769494416
INFO:tensorflow:Average training steps per second: 219.79
I0902 23:20:51.328086 139735608805376 replay_runner.py:36] Average training steps per second: 219.79

Steps executed: 387 Episode length: 195 Return: -1303.0519135244397
INFO:tensorflow:Starting iteration 7

Steps executed: 273 Episode length: 84 Return: -364.988083724587787
INFO:tensorflow:Average training steps per second: 217.62
I0902 23:21:00.661570 139735608805376 replay_runner.py:36] Average training steps per second: 217.62
I0902 23:21:00.928499 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.87
INFO:tensorflow:Starting iteration 8

Steps executed: 159 Episode length: 159 Return: -827.88555182876817
INFO:tensorflow:Average training steps per second: 217.12

Steps executed: 266 Episode length: 107 Return: -547.54160690382477
I0902 23:21:09.909319 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -687.71
INFO:tensorflow:Starting iteration 9

Steps executed: 214 Episode length: 126 Return: -917.84705653383467
INFO:tensorflow:Average training steps per second: 218.31
I0902 23:21:18.814935 139735608805376 replay_runner.py:36] Average training steps per second: 218.31
I0902 23:21:19.036872 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -774.68
INFO:tensorflow:Starting iteration 10

Steps executed: 264 Episode length: 80 Return: -417.023586296792647
INFO:tensorflow:Average training steps per second: 216.07
I0902 23:21:28.061271 139735608805376 replay_runner.py:36] Average training steps per second: 216.07
I0902 23:21:28.329811 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -522.61
INFO:tensorflow:Starting iteration 11

Steps executed: 233 Episode length: 153 Return: -880.42917120203257
INFO:tensorflow:Average training steps per second: 222.40
I0902 23:21:37.168960 139735608805376 replay_runner.py:36] Average training steps per second: 222.40
I0902 23:21:37.423198 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -755.83
INFO:tensorflow:Starting iteration 12

Steps executed: 241 Episode length: 78 Return: -505.462955999146557
INFO:tensorflow:Average training steps per second: 219.69
I0902 23:21:46.303120 139735608805376 replay_runner.py:36] Average training steps per second: 219.69
I0902 23:21:46.522441 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -546.27
INFO:tensorflow:Starting iteration 13

Steps executed: 269 Episode length: 269 Return: -2579.2091804600173
INFO:tensorflow:Average training steps per second: 225.19
I0902 23:21:55.072474 139735608805376 replay_runner.py:36] Average training steps per second: 225.19
I0902 23:21:55.449099 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -2579.21
INFO:tensorflow:Starting iteration 14

Steps executed: 113 Episode length: 113 Return: -762.12190654543173
INFO:tensorflow:Average training steps per second: 230.95

Steps executed: 471 Episode length: 358 Return: -3893.4109841144033
I0902 23:22:04.648064 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -2327.77
INFO:tensorflow:Starting iteration 15

Steps executed: 289 Episode length: 145 Return: -660.93391290223263
INFO:tensorflow:Average training steps per second: 227.10
I0902 23:22:13.241126 139735608805376 replay_runner.py:36] Average training steps per second: 227.10
I0902 23:22:13.504950 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -855.87
INFO:tensorflow:Starting iteration 16

Steps executed: 259 Episode length: 79 Return: -466.353010203592963
INFO:tensorflow:Average training steps per second: 228.82
I0902 23:22:21.860679 139735608805376 replay_runner.py:36] Average training steps per second: 228.82
I0902 23:22:22.094714 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -484.93
INFO:tensorflow:Starting iteration 17

Steps executed: 225 Episode length: 132 Return: -670.73111496910773
INFO:tensorflow:Average training steps per second: 225.72
I0902 23:22:30.639078 139735608805376 replay_runner.py:36] Average training steps per second: 225.72
I0902 23:22:30.867455 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -640.67
INFO:tensorflow:Starting iteration 18
I0902 23:22:35.235361 139735608805376 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 218.44
I0902 23:22:39.813900 139735608805376 replay_runner.py:36] Average training steps per second: 218.44

Steps executed: 281 Episode length: 92 Return: -684.153651568348295
INFO:tensorflow:Starting iteration 19

Steps executed: 223 Episode length: 110 Return: -788.57944948550895
INFO:tensorflow:Average training steps per second: 217.40
I0902 23:22:48.987351 139735608805376 replay_runner.py:36] Average training steps per second: 217.40
I0902 23:22:49.210603 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -731.25
INFO:tensorflow:Starting iteration 20
I0902 23:22:53.537524 139735608805376 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 218.28

Steps executed: 252 Episode length: 252 Return: -1740.2207821472314
I0902 23:22:58.496278 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -1740.22
INFO:tensorflow:Starting iteration 21

Steps executed: 247 Episode length: 82 Return: -381.516393315847944
INFO:tensorflow:Average training steps per second: 214.41
I0902 23:23:07.458446 139735608805376 replay_runner.py:36] Average training steps per second: 214.41
I0902 23:23:07.730918 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -644.86
INFO:tensorflow:Starting iteration 22
I0902 23:23:11.994897 139735608805376 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 222.39

Steps executed: 315 Episode length: 122 Return: -695.23086790467994
I0902 23:23:16.802120 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -618.90
INFO:tensorflow:Starting iteration 23

Steps executed: 222 Episode length: 82 Return: -603.039180761964654
INFO:tensorflow:Average training steps per second: 214.18
I0902 23:23:25.745968 139735608805376 replay_runner.py:36] Average training steps per second: 214.18
I0902 23:23:25.970061 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -723.68
INFO:tensorflow:Starting iteration 24

Steps executed: 315 Episode length: 128 Return: -725.36447644722664
INFO:tensorflow:Average training steps per second: 212.54
I0902 23:23:34.966068 139735608805376 replay_runner.py:36] Average training steps per second: 212.54
I0902 23:23:35.289904 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -624.48
INFO:tensorflow:Starting iteration 25
I0902 23:23:39.550976 139735608805376 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 214.11
I0902 23:23:44.221908 139735608805376 replay_runner.py:36] Average training steps per second: 214.11

Steps executed: 339 Episode length: 165 Return: -1194.8307809144449
INFO:tensorflow:Starting iteration 26

Steps executed: 303 Episode length: 120 Return: -718.42610314566399
INFO:tensorflow:Average training steps per second: 216.23
I0902 23:23:53.577679 139735608805376 replay_runner.py:36] Average training steps per second: 216.23
I0902 23:23:53.879282 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -688.91
INFO:tensorflow:Starting iteration 27

Steps executed: 237 Episode length: 87 Return: -498.910945372968579
INFO:tensorflow:Average training steps per second: 213.04
I0902 23:24:02.833549 139735608805376 replay_runner.py:36] Average training steps per second: 213.04
I0902 23:24:03.081036 139735608805376 run_experiment.py:428] Average undiscounted return per evaluation episode: -531.62
INFO:tensorflow:Starting iteration 28
I0902 23:24:07.380640 139735608805376 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 214.47
I0902 23:24:12.043628 139735608805376 replay_runner.py:36] Average training steps per second: 214.47

Steps executed: 204 Episode length: 83 Return: -444.196276024504679
INFO:tensorflow:Starting iteration 29

Steps executed: 340 Episode length: 178 Return: -965.58479944889149
INFO:tensorflow:Average training steps per second: 215.56
I0902 23:24:21.237967 139735608805376 replay_runner.py:36] Average training steps per second: 215.56

Done fixed training!Episode length: 178 Return: -965.58479944889149