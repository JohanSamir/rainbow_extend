Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0901 23:54:54.446366 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0901 23:54:54.458307 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:54:54.458654 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:54:54.458896 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:54:54.459120 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:54:54.459293 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:54:54.459390 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:54:54.459474 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:54:54.459553 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:54:54.459629 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:54:54.459702 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:54:54.459774 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:54:54.459855 139644712736768 dqn_agent.py:283] 	 seed: 1630540494458234
I0901 23:54:54.463001 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:54:54.463308 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:54:54.463483 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:54:54.463645 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:54:54.463794 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:54:54.463935 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:54:54.464272 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:54:54.464480 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:54:54.464639 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:54:54.505182 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:54:54.909485 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:54:54.925668 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:54:54.955558 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:54:54.955777 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:54:54.955886 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:54:54.955953 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:54:54.956017 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0901 23:54:54.956164 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:54:54.956254 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:54:54.956386 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:54:54.956493 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:54:54.956586 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0901 23:54:54.956691 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:54:54.956768 139644712736768 dqn_agent.py:283] 	 seed: 1630540494955502
I0901 23:54:54.960186 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:54:54.960431 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:54:54.960534 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:54:54.960645 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:54:54.960767 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:54:54.960864 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:54:54.960937 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:54:54.961096 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:54:54.961441 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 23:54:54.993464 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:54:55.013470 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:54:55.013709 139644712736768 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 168.56
I0901 23:55:00.946682 139644712736768 replay_runner.py:36] Average training steps per second: 168.56
Steps executed: 237 Episode length: 120 Return: -198.72291622230964
I0901 23:55:02.200851 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.17
INFO:tensorflow:Starting iteration 1

Steps executed: 220 Episode length: 133 Return: -271.93741309037733
INFO:tensorflow:Average training steps per second: 226.56
I0901 23:55:11.058275 139644712736768 replay_runner.py:36] Average training steps per second: 226.56
I0901 23:55:11.240270 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.65
INFO:tensorflow:Starting iteration 2
I0901 23:55:15.552055 139644712736768 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 224.08

Steps executed: 237 Episode length: 132 Return: -296.51553645272223
I0901 23:55:20.210228 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -313.79
INFO:tensorflow:Starting iteration 3

Steps executed: 260 Episode length: 106 Return: -287.72130312514737
INFO:tensorflow:Average training steps per second: 220.18
I0901 23:55:28.926077 139644712736768 replay_runner.py:36] Average training steps per second: 220.18
I0901 23:55:29.156358 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -320.54
INFO:tensorflow:Starting iteration 4
I0901 23:55:33.489761 139644712736768 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 212.99

Steps executed: 1000 Episode length: 1000 Return: -31.55637152002661
I0901 23:55:41.456913 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -31.56
INFO:tensorflow:Starting iteration 5
I0901 23:55:45.859510 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 231.22

Steps executed: 217 Episode length: 217 Return: -1305.93566851255261
I0901 23:55:50.429086 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -1305.94
INFO:tensorflow:Starting iteration 6
I0901 23:55:54.709917 139644712736768 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 220.60

Steps executed: 1000 Episode length: 1000 Return: -49.48576088426106
I0901 23:56:01.674760 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.49
INFO:tensorflow:Starting iteration 7
I0901 23:56:05.852329 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 221.79

Steps executed: 1000 Episode length: 1000 Return: -6.8768366341642135
I0901 23:56:14.665505 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -6.88
INFO:tensorflow:Starting iteration 8
I0901 23:56:19.084866 139644712736768 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 228.97

Steps executed: 545 Episode length: 545 Return: -297.5320238903672135
I0901 23:56:24.927499 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -297.53
INFO:tensorflow:Starting iteration 9

Steps executed: 414 Episode length: 414 Return: -181.7698634723924135
INFO:tensorflow:Average training steps per second: 232.13
I0901 23:56:33.646438 139644712736768 replay_runner.py:36] Average training steps per second: 232.13
I0901 23:56:34.121925 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -181.77
INFO:tensorflow:Starting iteration 10
I0901 23:56:38.585125 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 226.09

Steps executed: 955 Episode length: 955 Return: -388.1166712735576135
I0901 23:56:44.990828 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -388.12
INFO:tensorflow:Starting iteration 11
I0901 23:56:49.170085 139644712736768 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 227.93

Steps executed: 1000 Episode length: 1000 Return: -516.03976760354395
I0901 23:56:55.357865 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -516.04
INFO:tensorflow:Starting iteration 12

Steps executed: 63 Episode length: 63 Return: -222.714278796292354395
INFO:tensorflow:Average training steps per second: 228.07

Steps executed: 541 Episode length: 478 Return: -273.2368645834606395
I0901 23:57:04.841866 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.98
INFO:tensorflow:Starting iteration 13
I0901 23:57:09.254370 139644712736768 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 222.22

Steps executed: 1000 Episode length: 1000 Return: -166.27912024942802
I0901 23:57:16.932687 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.28
INFO:tensorflow:Starting iteration 14

Steps executed: 219 Episode length: 219 Return: -821.4003179487884802
INFO:tensorflow:Average training steps per second: 222.21
I0901 23:57:25.739772 139644712736768 replay_runner.py:36] Average training steps per second: 222.21
I0901 23:57:25.988446 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -821.40
INFO:tensorflow:Starting iteration 15

Steps executed: 227 Episode length: 227 Return: -303.9769075246474602
INFO:tensorflow:Average training steps per second: 221.22
I0901 23:57:34.788804 139644712736768 replay_runner.py:36] Average training steps per second: 221.22
I0901 23:57:35.059561 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.98
INFO:tensorflow:Starting iteration 16

Steps executed: 266 Episode length: 97 Return: -516.82871684867863502
INFO:tensorflow:Average training steps per second: 227.62
I0901 23:57:43.697659 139644712736768 replay_runner.py:36] Average training steps per second: 227.62
I0901 23:57:43.943941 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -314.47
INFO:tensorflow:Starting iteration 17

Steps executed: 325 Episode length: 129 Return: -505.5776031300008502
INFO:tensorflow:Average training steps per second: 223.44
I0901 23:57:52.816668 139644712736768 replay_runner.py:36] Average training steps per second: 223.44
I0901 23:57:53.143277 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -247.64
INFO:tensorflow:Starting iteration 18

Steps executed: 373 Episode length: 203 Return: -42.10898492169043502
INFO:tensorflow:Average training steps per second: 216.80
I0901 23:58:02.078665 139644712736768 replay_runner.py:36] Average training steps per second: 216.80
I0901 23:58:02.479304 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.78
INFO:tensorflow:Starting iteration 19

Steps executed: 290 Episode length: 115 Return: -144.9762215481558202
INFO:tensorflow:Average training steps per second: 220.89
I0901 23:58:11.397931 139644712736768 replay_runner.py:36] Average training steps per second: 220.89
I0901 23:58:11.624447 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -147.20
INFO:tensorflow:Starting iteration 20

Steps executed: 172 Episode length: 172 Return: -259.3931797943083202
INFO:tensorflow:Average training steps per second: 220.51
I0901 23:58:20.450464 139644712736768 replay_runner.py:36] Average training steps per second: 220.51

Steps executed: 344 Episode length: 172 Return: -39.47657655307877202
INFO:tensorflow:Starting iteration 21

Steps executed: 365 Episode length: 245 Return: -925.0523716728779202
INFO:tensorflow:Average training steps per second: 221.78
I0901 23:58:29.743430 139644712736768 replay_runner.py:36] Average training steps per second: 221.78
I0901 23:58:30.171542 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -908.72
INFO:tensorflow:Starting iteration 22

Steps executed: 358 Episode length: 188 Return: -45.46083672259314202
INFO:tensorflow:Average training steps per second: 213.82
I0901 23:58:39.174848 139644712736768 replay_runner.py:36] Average training steps per second: 213.82
I0901 23:58:39.548746 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -65.23
INFO:tensorflow:Starting iteration 23

Steps executed: 211 Episode length: 102 Return: -679.1403199176212702
INFO:tensorflow:Average training steps per second: 227.45
I0901 23:58:48.339774 139644712736768 replay_runner.py:36] Average training steps per second: 227.45
I0901 23:58:48.527986 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -417.74
INFO:tensorflow:Starting iteration 24

Steps executed: 221 Episode length: 54 Return: -99.228968785376221702
INFO:tensorflow:Average training steps per second: 222.33
I0901 23:58:57.326674 139644712736768 replay_runner.py:36] Average training steps per second: 222.33
I0901 23:58:57.492064 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.97
INFO:tensorflow:Starting iteration 25

Steps executed: 310 Episode length: 189 Return: -561.6547900762773702
INFO:tensorflow:Average training steps per second: 226.20
I0901 23:59:06.256253 139644712736768 replay_runner.py:36] Average training steps per second: 226.20
I0901 23:59:06.580879 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.88
INFO:tensorflow:Starting iteration 26

Steps executed: 327 Episode length: 327 Return: -41.65826771993534702
INFO:tensorflow:Average training steps per second: 221.93
I0901 23:59:15.255816 139644712736768 replay_runner.py:36] Average training steps per second: 221.93
I0901 23:59:15.715185 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -41.66
INFO:tensorflow:Starting iteration 27

Steps executed: 120 Episode length: 120 Return: -56.94543982269314702
INFO:tensorflow:Average training steps per second: 222.09
I0901 23:59:24.408761 139644712736768 replay_runner.py:36] Average training steps per second: 222.09

Steps executed: 302 Episode length: 182 Return: -335.4236417718377702
INFO:tensorflow:Starting iteration 28

Steps executed: 340 Episode length: 143 Return: -135.6782037630673302
INFO:tensorflow:Average training steps per second: 212.75
I0901 23:59:33.694181 139644712736768 replay_runner.py:36] Average training steps per second: 212.75
I0901 23:59:34.045327 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -215.00
INFO:tensorflow:Starting iteration 29

Steps executed: 149 Episode length: 87 Return: -745.52656131988113302
INFO:tensorflow:Average training steps per second: 230.27
I0901 23:59:42.597011 139644712736768 replay_runner.py:36] Average training steps per second: 230.27


Done fixed training!Episode length: 53 Return: -127.43512611094363302