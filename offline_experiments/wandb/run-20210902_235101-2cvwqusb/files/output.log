Loaded trained dqn in lunarlander
Training fixed agent 9, please be patient, may be a while...
I0902 23:51:07.831102 140006414895104 run_experiment.py:549] Creating TrainRunner ...
I0902 23:51:07.843255 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:07.843598 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:07.843770 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:07.843888 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:07.843975 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:07.844047 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:51:07.844114 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:07.844179 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:07.844253 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:07.844332 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:07.844475 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:07.844589 140006414895104 dqn_agent.py:283] 	 seed: 1630626667843176
I0902 23:51:07.848699 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:07.848970 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:51:07.849119 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:07.849240 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:07.849333 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:07.849417 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:07.849500 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:07.849760 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:07.849930 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:07.889622 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:08.313047 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:08.348850 140006414895104 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:51:08.358912 140006414895104 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:51:08.359255 140006414895104 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:51:08.359541 140006414895104 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:51:08.359684 140006414895104 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:51:08.359944 140006414895104 dqn_agent.py:275] 	 update_period: 4
I0902 23:51:08.360097 140006414895104 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:51:08.360241 140006414895104 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:51:08.360396 140006414895104 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:51:08.360509 140006414895104 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:51:08.360619 140006414895104 dqn_agent.py:280] 	 optimizer: adam
I0902 23:51:08.360717 140006414895104 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:51:08.360818 140006414895104 dqn_agent.py:283] 	 seed: 1630626668358843
I0902 23:51:08.363332 140006414895104 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:51:08.363568 140006414895104 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:51:08.363709 140006414895104 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:51:08.363847 140006414895104 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:51:08.363949 140006414895104 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:51:08.364039 140006414895104 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:51:08.364143 140006414895104 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:51:08.364297 140006414895104 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:51:08.364472 140006414895104 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:51:08.398158 140006414895104 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:51:08.423283 140006414895104 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:51:08.423618 140006414895104 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 150.90
I0902 23:51:15.051204 140006414895104 replay_runner.py:36] Average training steps per second: 150.90
Steps executed: 255 Episode length: 116 Return: -320.34622825621716
I0902 23:51:16.404584 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -372.68
INFO:tensorflow:Starting iteration 1
I0902 23:51:20.746544 140006414895104 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 215.14

Steps executed: 298 Episode length: 146 Return: -290.20457759710996
I0902 23:51:25.712429 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -316.68
INFO:tensorflow:Starting iteration 2

Steps executed: 294 Episode length: 196 Return: -121.27740704702186
INFO:tensorflow:Average training steps per second: 217.20
I0902 23:51:34.632519 140006414895104 replay_runner.py:36] Average training steps per second: 217.20
I0902 23:51:34.916860 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -244.80
INFO:tensorflow:Starting iteration 3
I0902 23:51:39.260662 140006414895104 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 216.77

Steps executed: 748 Episode length: 748 Return: -155.71297321450405
I0902 23:51:45.766245 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -155.71
INFO:tensorflow:Starting iteration 4
I0902 23:51:50.123965 140006414895104 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 219.72

Steps executed: 665 Episode length: 665 Return: -510.08617205711085
I0902 23:51:55.954357 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.09
INFO:tensorflow:Starting iteration 5
I0902 23:52:00.239052 140006414895104 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 218.33

Steps executed: 873 Episode length: 873 Return: -374.76250888829725
I0902 23:52:07.603006 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -374.76
INFO:tensorflow:Starting iteration 6
I0902 23:52:11.917783 140006414895104 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 216.14
I0902 23:52:16.544873 140006414895104 replay_runner.py:36] Average training steps per second: 216.14

Steps executed: 1000 Episode length: 1000 Return: -245.53080259997265
INFO:tensorflow:Starting iteration 7
I0902 23:52:23.996027 140006414895104 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 210.09
I0902 23:52:28.756447 140006414895104 replay_runner.py:36] Average training steps per second: 210.09

Steps executed: 507 Episode length: 507 Return: -234.5365006158082865
INFO:tensorflow:Starting iteration 8

Steps executed: 295 Episode length: 142 Return: -391.4317589889557865
INFO:tensorflow:Average training steps per second: 215.24
I0902 23:52:38.523537 140006414895104 replay_runner.py:36] Average training steps per second: 215.24
I0902 23:52:38.793752 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -513.62
INFO:tensorflow:Starting iteration 9
I0902 23:52:42.969662 140006414895104 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 225.63

Steps executed: 1000 Episode length: 1000 Return: -221.38672548675175
I0902 23:52:50.297606 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -221.39
INFO:tensorflow:Starting iteration 10

Steps executed: 249 Episode length: 175 Return: -404.1706173206261175
INFO:tensorflow:Average training steps per second: 227.10
I0902 23:52:59.036754 140006414895104 replay_runner.py:36] Average training steps per second: 227.10
I0902 23:52:59.264378 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -439.47
INFO:tensorflow:Starting iteration 11
I0902 23:53:03.584694 140006414895104 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 226.28

Steps executed: 440 Episode length: 440 Return: -328.7474234396552175
I0902 23:53:08.686068 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -328.75
INFO:tensorflow:Starting iteration 12

Steps executed: 227 Episode length: 163 Return: -23.79280571634241475
INFO:tensorflow:Average training steps per second: 224.74
I0902 23:53:17.363080 140006414895104 replay_runner.py:36] Average training steps per second: 224.74
I0902 23:53:17.573554 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -214.60
INFO:tensorflow:Starting iteration 13

Steps executed: 639 Episode length: 639 Return: -402.6236760685754475
INFO:tensorflow:Average training steps per second: 219.12
I0902 23:53:26.528720 140006414895104 replay_runner.py:36] Average training steps per second: 219.12
I0902 23:53:27.561800 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.62
INFO:tensorflow:Starting iteration 14

Steps executed: 240 Episode length: 54 Return: -153.47031267190351475
INFO:tensorflow:Average training steps per second: 216.13
I0902 23:53:36.615137 140006414895104 replay_runner.py:36] Average training steps per second: 216.13
I0902 23:53:36.838378 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -132.79
INFO:tensorflow:Starting iteration 15
I0902 23:53:41.030709 140006414895104 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 210.62

Steps executed: 515 Episode length: 515 Return: -442.6796287021721475
I0902 23:53:46.830575 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -442.68
INFO:tensorflow:Starting iteration 16
I0902 23:53:51.224802 140006414895104 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 215.92

Steps executed: 1000 Episode length: 1000 Return: -347.52246986247635
I0902 23:53:58.964833 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -347.52
INFO:tensorflow:Starting iteration 17
I0902 23:54:03.464439 140006414895104 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 226.24
I0902 23:54:07.884813 140006414895104 replay_runner.py:36] Average training steps per second: 226.24

Steps executed: 312 Episode length: 145 Return: -117.7693166979252635
INFO:tensorflow:Starting iteration 18

Steps executed: 316 Episode length: 316 Return: -126.1229422639195735
INFO:tensorflow:Average training steps per second: 216.25
I0902 23:54:17.228973 140006414895104 replay_runner.py:36] Average training steps per second: 216.25
I0902 23:54:17.610441 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -126.12
INFO:tensorflow:Starting iteration 19

Steps executed: 401 Episode length: 234 Return: -419.7164207841016735
INFO:tensorflow:Average training steps per second: 224.46
I0902 23:54:26.497393 140006414895104 replay_runner.py:36] Average training steps per second: 224.46
I0902 23:54:26.948074 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -464.07
INFO:tensorflow:Starting iteration 20
I0902 23:54:31.403231 140006414895104 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 218.21

Steps executed: 1000 Episode length: 1000 Return: -343.91909510208535
I0902 23:54:39.663740 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -343.92
INFO:tensorflow:Starting iteration 21

Steps executed: 203 Episode length: 106 Return: -418.1167828100572635
INFO:tensorflow:Average training steps per second: 215.02
I0902 23:54:48.497225 140006414895104 replay_runner.py:36] Average training steps per second: 215.02
I0902 23:54:48.682767 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -488.86
INFO:tensorflow:Starting iteration 22

Steps executed: 235 Episode length: 235 Return: -319.6136406116234635
INFO:tensorflow:Average training steps per second: 216.70
I0902 23:54:57.717390 140006414895104 replay_runner.py:36] Average training steps per second: 216.70
I0902 23:54:57.964120 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.61
INFO:tensorflow:Starting iteration 23

Steps executed: 338 Episode length: 158 Return: -105.3183910795518235
INFO:tensorflow:Average training steps per second: 214.22
I0902 23:55:06.794591 140006414895104 replay_runner.py:36] Average training steps per second: 214.22
I0902 23:55:07.146243 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -129.15
INFO:tensorflow:Starting iteration 24
I0902 23:55:11.443052 140006414895104 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.41

Steps executed: 298 Episode length: 170 Return: -516.4407351534289535
I0902 23:55:16.254901 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -357.90
INFO:tensorflow:Starting iteration 25

Steps executed: 287 Episode length: 149 Return: -680.4611382450699535
INFO:tensorflow:Average training steps per second: 214.24
I0902 23:55:25.222345 140006414895104 replay_runner.py:36] Average training steps per second: 214.24
I0902 23:55:25.471282 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -290.53
INFO:tensorflow:Starting iteration 26

Steps executed: 210 Episode length: 99 Return: -407.34735875367129535
INFO:tensorflow:Average training steps per second: 218.86
I0902 23:55:34.404181 140006414895104 replay_runner.py:36] Average training steps per second: 218.86
I0902 23:55:34.591254 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -427.50
INFO:tensorflow:Starting iteration 27

Steps executed: 291 Episode length: 123 Return: -397.1804749604982635
INFO:tensorflow:Average training steps per second: 221.92
I0902 23:55:43.462065 140006414895104 replay_runner.py:36] Average training steps per second: 221.92
I0902 23:55:43.729534 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -317.58
INFO:tensorflow:Starting iteration 28

Steps executed: 236 Episode length: 144 Return: -477.1585832179103635
INFO:tensorflow:Average training steps per second: 228.84
I0902 23:55:52.486762 140006414895104 replay_runner.py:36] Average training steps per second: 228.84
I0902 23:55:52.693302 140006414895104 run_experiment.py:428] Average undiscounted return per evaluation episode: -623.29
INFO:tensorflow:Starting iteration 29

Steps executed: 252 Episode length: 97 Return: -522.77019692132423635
INFO:tensorflow:Average training steps per second: 222.06
I0902 23:56:01.597584 140006414895104 replay_runner.py:36] Average training steps per second: 222.06

Done fixed training!Episode length: 97 Return: -522.77019692132423635