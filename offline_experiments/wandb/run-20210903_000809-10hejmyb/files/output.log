I0903 00:08:15.909719 139900407642112 run_experiment.py:549] Creating TrainRunner ...
I0903 00:08:15.917720 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:08:15.917847 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:08:15.917918 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:08:15.917978 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:08:15.918032 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:08:15.918110 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:08:15.918174 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:08:15.918280 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:08:15.918356 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:08:15.918424 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:08:15.918491 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:08:15.918563 139900407642112 dqn_agent.py:283] 	 seed: 1630627695917686
I0903 00:08:15.920293 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:08:15.920424 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:08:15.920506 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:08:15.920569 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:08:15.920625 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:08:15.920720 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:08:15.920789 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:08:15.920852 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:08:15.920938 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:08:15.944354 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:16.462894 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:16.471805 139900407642112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0903 00:08:16.478433 139900407642112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0903 00:08:16.478588 139900407642112 dqn_agent.py:272] 	 gamma: 0.990000
I0903 00:08:16.478663 139900407642112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0903 00:08:16.478726 139900407642112 dqn_agent.py:274] 	 min_replay_history: 500
I0903 00:08:16.478783 139900407642112 dqn_agent.py:275] 	 update_period: 4
I0903 00:08:16.478869 139900407642112 dqn_agent.py:276] 	 target_update_period: 300
I0903 00:08:16.478973 139900407642112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0903 00:08:16.479033 139900407642112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0903 00:08:16.479118 139900407642112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0903 00:08:16.479184 139900407642112 dqn_agent.py:280] 	 optimizer: adam
I0903 00:08:16.479240 139900407642112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0903 00:08:16.479327 139900407642112 dqn_agent.py:283] 	 seed: 1630627696478400
I0903 00:08:16.480761 139900407642112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0903 00:08:16.480880 139900407642112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0903 00:08:16.480950 139900407642112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0903 00:08:16.481029 139900407642112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0903 00:08:16.481086 139900407642112 circular_replay_buffer.py:159] 	 stack_size: 1
I0903 00:08:16.481165 139900407642112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0903 00:08:16.481233 139900407642112 circular_replay_buffer.py:161] 	 batch_size: 128
I0903 00:08:16.481304 139900407642112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0903 00:08:16.481368 139900407642112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0903 00:08:16.501079 139900407642112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0903 00:08:16.515485 139900407642112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0903 00:08:16.515614 139900407642112 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 7, please be patient, may be a while...
Steps executed: 244 Episode length: 145 Return: -403.3495231385037
INFO:tensorflow:Average training steps per second: 241.56
I0903 00:08:20.655592 139900407642112 replay_runner.py:36] Average training steps per second: 241.56
I0903 00:08:21.386408 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -433.87
INFO:tensorflow:Starting iteration 1
I0903 00:08:24.610789 139900407642112 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 324.60
I0903 00:08:27.691761 139900407642112 replay_runner.py:36] Average training steps per second: 324.60

Steps executed: 270 Episode length: 108 Return: -443.51214290569175
INFO:tensorflow:Starting iteration 2

Steps executed: 345 Episode length: 186 Return: -360.07667197145635
INFO:tensorflow:Average training steps per second: 325.59
I0903 00:08:34.114434 139900407642112 replay_runner.py:36] Average training steps per second: 325.59
I0903 00:08:34.299984 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -360.29
INFO:tensorflow:Starting iteration 3

Steps executed: 269 Episode length: 148 Return: -71.881072554728632
INFO:tensorflow:Average training steps per second: 321.14
I0903 00:08:40.655950 139900407642112 replay_runner.py:36] Average training steps per second: 321.14
I0903 00:08:40.817102 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.83
INFO:tensorflow:Starting iteration 4

Steps executed: 242 Episode length: 242 Return: -153.56346648294552
INFO:tensorflow:Average training steps per second: 329.15
I0903 00:08:47.123957 139900407642112 replay_runner.py:36] Average training steps per second: 329.15
I0903 00:08:47.335841 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -153.56
INFO:tensorflow:Starting iteration 5
I0903 00:08:50.682717 139900407642112 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 327.34

Steps executed: 1000 Episode length: 1000 Return: -2.535084748411052
I0903 00:08:56.198239 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -2.54
INFO:tensorflow:Starting iteration 6
I0903 00:08:59.381592 139900407642112 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 309.87

Steps executed: 1000 Episode length: 1000 Return: -18.255782868785047
I0903 00:09:04.172472 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -18.26
INFO:tensorflow:Starting iteration 7

Steps executed: 374 Episode length: 374 Return: -352.1325323257555047
INFO:tensorflow:Average training steps per second: 316.27
I0903 00:09:10.548230 139900407642112 replay_runner.py:36] Average training steps per second: 316.27
I0903 00:09:10.896819 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -352.13
INFO:tensorflow:Starting iteration 8
I0903 00:09:14.220996 139900407642112 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 340.47

Steps executed: 1000 Episode length: 1000 Return: -5.5655698611950327
I0903 00:09:19.067262 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -5.57
INFO:tensorflow:Starting iteration 9
I0903 00:09:22.392398 139900407642112 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 323.34

Steps executed: 639 Episode length: 639 Return: -365.0771968924562427
I0903 00:09:26.406698 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.08
INFO:tensorflow:Starting iteration 10
I0903 00:09:29.715635 139900407642112 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 335.73

Steps executed: 1000 Episode length: 1000 Return: -98.122989505386517
I0903 00:09:34.498859 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -98.12
INFO:tensorflow:Starting iteration 11

Steps executed: 543 Episode length: 543 Return: -348.4339338853759517
INFO:tensorflow:Average training steps per second: 314.14
I0903 00:09:41.019978 139900407642112 replay_runner.py:36] Average training steps per second: 314.14
I0903 00:09:41.550607 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -348.43
INFO:tensorflow:Starting iteration 12
I0903 00:09:44.847562 139900407642112 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 319.66

Steps executed: 757 Episode length: 757 Return: -212.5205815794215617
I0903 00:09:49.622854 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -212.52
INFO:tensorflow:Starting iteration 13
I0903 00:09:52.901088 139900407642112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 329.59

Steps executed: 1000 Episode length: 1000 Return: -45.787143452252947
I0903 00:09:57.584926 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -45.79
INFO:tensorflow:Starting iteration 14

Steps executed: 263 Episode length: 263 Return: -243.3656928790389947
INFO:tensorflow:Average training steps per second: 349.82
I0903 00:10:03.878992 139900407642112 replay_runner.py:36] Average training steps per second: 349.82
I0903 00:10:04.061872 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -243.37
INFO:tensorflow:Starting iteration 15

Steps executed: 485 Episode length: 293 Return: -223.0360685209151747
INFO:tensorflow:Average training steps per second: 333.05
I0903 00:10:10.455032 139900407642112 replay_runner.py:36] Average training steps per second: 333.05
I0903 00:10:10.800462 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.86
INFO:tensorflow:Starting iteration 16

Steps executed: 211 Episode length: 156 Return: -58.67641703620301747
INFO:tensorflow:Average training steps per second: 326.79
I0903 00:10:17.211836 139900407642112 replay_runner.py:36] Average training steps per second: 326.79
I0903 00:10:17.339095 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -69.64
INFO:tensorflow:Starting iteration 17
I0903 00:10:20.672874 139900407642112 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 323.27
I0903 00:10:23.766567 139900407642112 replay_runner.py:36] Average training steps per second: 323.27

Steps executed: 204 Episode length: 152 Return: -373.6360843475466747
INFO:tensorflow:Starting iteration 18
I0903 00:10:27.230485 139900407642112 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 331.16

Steps executed: 576 Episode length: 576 Return: -96.54097221147785747
I0903 00:10:31.005089 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.54
INFO:tensorflow:Starting iteration 19

Steps executed: 332 Episode length: 332 Return: -26.48747476173187547
INFO:tensorflow:Average training steps per second: 324.49
I0903 00:10:37.450343 139900407642112 replay_runner.py:36] Average training steps per second: 324.49
I0903 00:10:37.762750 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -26.49
INFO:tensorflow:Starting iteration 20

Steps executed: 371 Episode length: 225 Return: 14.623166023498683547
INFO:tensorflow:Average training steps per second: 299.12
I0903 00:10:44.340197 139900407642112 replay_runner.py:36] Average training steps per second: 299.12
I0903 00:10:44.584907 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -306.46
INFO:tensorflow:Starting iteration 21

Steps executed: 213 Episode length: 88 Return: -241.04272181370914547
INFO:tensorflow:Average training steps per second: 300.14
I0903 00:10:51.139029 139900407642112 replay_runner.py:36] Average training steps per second: 300.14
I0903 00:10:51.257251 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.85
INFO:tensorflow:Starting iteration 22

Steps executed: 290 Episode length: 120 Return: -173.5787821236492647
INFO:tensorflow:Average training steps per second: 305.39
I0903 00:10:57.764654 139900407642112 replay_runner.py:36] Average training steps per second: 305.39
I0903 00:10:57.931236 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.69
INFO:tensorflow:Starting iteration 23

Steps executed: 258 Episode length: 128 Return: -176.1953825661724247
INFO:tensorflow:Average training steps per second: 314.87
I0903 00:11:04.337166 139900407642112 replay_runner.py:36] Average training steps per second: 314.87
I0903 00:11:04.488880 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -164.45
INFO:tensorflow:Starting iteration 24

Steps executed: 298 Episode length: 193 Return: -168.3354613916351447
INFO:tensorflow:Average training steps per second: 313.59
I0903 00:11:10.949557 139900407642112 replay_runner.py:36] Average training steps per second: 313.59
I0903 00:11:11.166923 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -303.14
INFO:tensorflow:Starting iteration 25

Steps executed: 302 Episode length: 111 Return: -81.46095875516374447
INFO:tensorflow:Average training steps per second: 310.68
I0903 00:11:17.671998 139900407642112 replay_runner.py:36] Average training steps per second: 310.68
I0903 00:11:17.885069 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -57.45
INFO:tensorflow:Starting iteration 26

Steps executed: 334 Episode length: 334 Return: -386.3009199591856547
INFO:tensorflow:Average training steps per second: 319.86
I0903 00:11:24.251293 139900407642112 replay_runner.py:36] Average training steps per second: 319.86
I0903 00:11:24.564759 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.30
INFO:tensorflow:Starting iteration 27

Steps executed: 222 Episode length: 141 Return: -266.1036092825495447
INFO:tensorflow:Average training steps per second: 313.33
I0903 00:11:31.029357 139900407642112 replay_runner.py:36] Average training steps per second: 313.33
I0903 00:11:31.165093 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.59
INFO:tensorflow:Starting iteration 28

Steps executed: 211 Episode length: 56 Return: -197.72829896264171447
INFO:tensorflow:Average training steps per second: 320.51
I0903 00:11:37.583195 139900407642112 replay_runner.py:36] Average training steps per second: 320.51
I0903 00:11:37.717103 139900407642112 run_experiment.py:428] Average undiscounted return per evaluation episode: -262.61
INFO:tensorflow:Starting iteration 29

Steps executed: 251 Episode length: 103 Return: -740.3504539022434447
INFO:tensorflow:Average training steps per second: 320.49
I0903 00:11:44.133085 139900407642112 replay_runner.py:36] Average training steps per second: 320.49

Done fixed training!Episode length: 103 Return: -740.3504539022434447