Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0905 18:57:17.125650 139802860935168 run_experiment.py:549] Creating TrainRunner ...
I0905 18:57:17.154977 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:57:17.155338 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:57:17.155602 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:57:17.155762 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:57:17.156356 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 18:57:17.156606 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:57:17.156915 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:57:17.157394 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:57:17.157558 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:57:17.157734 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 18:57:17.157948 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:57:17.158329 139802860935168 dqn_agent.py:283] 	 seed: 1630868237154894
I0905 18:57:17.162538 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:57:17.162782 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:57:17.163463 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:57:17.163815 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:57:17.164066 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:57:17.164258 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:57:17.164479 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:57:17.164631 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:57:17.164787 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:57:17.243314 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:57:17.779197 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:57:17.798669 139802860935168 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0905 18:57:17.811383 139802860935168 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0905 18:57:17.811720 139802860935168 dqn_agent.py:272] 	 gamma: 0.990000
I0905 18:57:17.812090 139802860935168 dqn_agent.py:273] 	 update_horizon: 1.000000
I0905 18:57:17.812356 139802860935168 dqn_agent.py:274] 	 min_replay_history: 500
I0905 18:57:17.812677 139802860935168 dqn_agent.py:275] 	 update_period: 4
I0905 18:57:17.813041 139802860935168 dqn_agent.py:276] 	 target_update_period: 300
I0905 18:57:17.813286 139802860935168 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0905 18:57:17.813550 139802860935168 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0905 18:57:17.813756 139802860935168 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0905 18:57:17.814035 139802860935168 dqn_agent.py:280] 	 optimizer: adam
I0905 18:57:17.814473 139802860935168 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0905 18:57:17.814714 139802860935168 dqn_agent.py:283] 	 seed: 1630868237811285
I0905 18:57:17.819681 139802860935168 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0905 18:57:17.820051 139802860935168 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0905 18:57:17.820567 139802860935168 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0905 18:57:17.820769 139802860935168 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0905 18:57:17.821100 139802860935168 circular_replay_buffer.py:159] 	 stack_size: 1
I0905 18:57:17.822360 139802860935168 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0905 18:57:17.823292 139802860935168 circular_replay_buffer.py:161] 	 batch_size: 128
I0905 18:57:17.823467 139802860935168 circular_replay_buffer.py:162] 	 update_horizon: 1
I0905 18:57:17.824282 139802860935168 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0905 18:57:17.894306 139802860935168 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0905 18:57:17.927711 139802860935168 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0905 18:57:17.928040 139802860935168 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 129.29
I0905 18:57:25.663805 139802860935168 replay_runner.py:36] Average training steps per second: 129.29
Steps executed: 211 Episode length: 99 Return: -560.36519247469073
I0905 18:57:27.515409 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -487.91
INFO:tensorflow:Starting iteration 1

Steps executed: 216 Episode length: 118 Return: -578.5578138662252
INFO:tensorflow:Average training steps per second: 164.90
I0905 18:57:37.995730 139802860935168 replay_runner.py:36] Average training steps per second: 164.90
I0905 18:57:38.368181 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -607.61
INFO:tensorflow:Starting iteration 2

Steps executed: 173 Episode length: 173 Return: -504.70871941371047
INFO:tensorflow:Average training steps per second: 167.51

Steps executed: 1173 Episode length: 1000 Return: -134.92828822993016
I0905 18:57:53.349315 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -319.82
INFO:tensorflow:Starting iteration 3
I0905 18:57:58.237658 139802860935168 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 171.30

Steps executed: 1000 Episode length: 1000 Return: -198.95370087431656
I0905 18:58:08.586174 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -198.95
INFO:tensorflow:Starting iteration 4
I0905 18:58:12.728233 139802860935168 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 171.00

Steps executed: 1000 Episode length: 1000 Return: -176.24281121321314
I0905 18:58:22.529137 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.24
INFO:tensorflow:Starting iteration 5
I0905 18:58:27.183051 139802860935168 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 170.25

Steps executed: 907 Episode length: 907 Return: -401.3950082764717314
I0905 18:58:35.926313 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -401.40
INFO:tensorflow:Starting iteration 6
I0905 18:58:40.836293 139802860935168 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 174.09

Steps executed: 480 Episode length: 480 Return: -402.9320436313982414
I0905 18:58:47.919538 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.93
INFO:tensorflow:Starting iteration 7
I0905 18:58:52.416539 139802860935168 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 168.00

Steps executed: 805 Episode length: 805 Return: -421.7365964348504714
I0905 18:59:01.757784 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -421.74
INFO:tensorflow:Starting iteration 8
I0905 18:59:06.720305 139802860935168 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 172.78

Steps executed: 537 Episode length: 537 Return: -325.4985774368432714
I0905 18:59:13.861682 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.50
INFO:tensorflow:Starting iteration 9
I0905 18:59:18.057570 139802860935168 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 192.13

Steps executed: 1000 Episode length: 1000 Return: -223.59492558139303
I0905 18:59:25.637486 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -223.59
INFO:tensorflow:Starting iteration 10
I0905 18:59:30.212045 139802860935168 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 213.57

Steps executed: 1000 Episode length: 1000 Return: -248.46303367995722
I0905 18:59:37.615428 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -248.46
INFO:tensorflow:Starting iteration 11
I0905 18:59:42.098433 139802860935168 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 234.75
I0905 18:59:46.358622 139802860935168 replay_runner.py:36] Average training steps per second: 234.75

Steps executed: 1000 Episode length: 1000 Return: -288.48980557726003
INFO:tensorflow:Starting iteration 12
I0905 18:59:52.509242 139802860935168 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 280.45

Steps executed: 911 Episode length: 911 Return: -144.2164465746351403
I0905 18:59:58.262340 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -144.22
INFO:tensorflow:Starting iteration 13
I0905 19:00:01.715781 139802860935168 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 279.19

Steps executed: 286 Episode length: 286 Return: -71.77524237762962403
I0905 19:00:05.538720 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -71.78
INFO:tensorflow:Starting iteration 14

Steps executed: 310 Episode length: 310 Return: 268.21781611563966403
INFO:tensorflow:Average training steps per second: 282.81
I0905 19:00:12.573599 139802860935168 replay_runner.py:36] Average training steps per second: 282.81
I0905 19:00:12.926911 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 268.22
INFO:tensorflow:Starting iteration 15

Steps executed: 347 Episode length: 156 Return: 4.9748508656590085403
INFO:tensorflow:Average training steps per second: 315.00
I0905 19:00:19.682976 139802860935168 replay_runner.py:36] Average training steps per second: 315.00
I0905 19:00:19.938308 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 18.04
INFO:tensorflow:Starting iteration 16

Steps executed: 295 Episode length: 155 Return: -451.3938265096619703
INFO:tensorflow:Average training steps per second: 296.43
I0905 19:00:27.004439 139802860935168 replay_runner.py:36] Average training steps per second: 296.43
I0905 19:00:27.211798 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -277.00
INFO:tensorflow:Starting iteration 17

Steps executed: 416 Episode length: 416 Return: 252.48878535197789703
INFO:tensorflow:Average training steps per second: 287.36
I0905 19:00:34.148768 139802860935168 replay_runner.py:36] Average training steps per second: 287.36
I0905 19:00:34.605335 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 252.49
INFO:tensorflow:Starting iteration 18
I0905 19:00:38.181778 139802860935168 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 298.16


Steps executed: 1183 Episode length: 1000 Return: -15.749484827318105
I0905 19:00:43.843050 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.67
INFO:tensorflow:Starting iteration 19

Steps executed: 332 Episode length: 134 Return: -473.9940150562233305
INFO:tensorflow:Average training steps per second: 314.80
I0905 19:00:50.663756 139802860935168 replay_runner.py:36] Average training steps per second: 314.80
I0905 19:00:50.899186 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -443.44
INFO:tensorflow:Starting iteration 20

Steps executed: 202 Episode length: 150 Return: -39.82684857267847305
INFO:tensorflow:Average training steps per second: 291.69
I0905 19:00:58.026822 139802860935168 replay_runner.py:36] Average training steps per second: 291.69
I0905 19:00:58.188002 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -163.26
INFO:tensorflow:Starting iteration 21
I0905 19:01:01.768223 139802860935168 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 286.78
I0905 19:01:05.255668 139802860935168 replay_runner.py:36] Average training steps per second: 286.78

Steps executed: 234 Episode length: 66 Return: -381.42365178729073305
INFO:tensorflow:Starting iteration 22

Steps executed: 369 Episode length: 283 Return: -248.5026748224704505
INFO:tensorflow:Average training steps per second: 286.96
I0905 19:01:12.369091 139802860935168 replay_runner.py:36] Average training steps per second: 286.96
I0905 19:01:12.677868 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -173.26
INFO:tensorflow:Starting iteration 23

Steps executed: 292 Episode length: 174 Return: -256.4060270371564305
INFO:tensorflow:Average training steps per second: 288.49
I0905 19:01:19.686928 139802860935168 replay_runner.py:36] Average training steps per second: 288.49
I0905 19:01:19.910722 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -345.31
INFO:tensorflow:Starting iteration 24

Steps executed: 350 Episode length: 215 Return: -9.563592390053856805
INFO:tensorflow:Average training steps per second: 283.08
I0905 19:01:26.857879 139802860935168 replay_runner.py:36] Average training steps per second: 283.08
I0905 19:01:27.192268 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -78.86
INFO:tensorflow:Starting iteration 25

Steps executed: 349 Episode length: 151 Return: 0.8908150533971906805
INFO:tensorflow:Average training steps per second: 292.19
I0905 19:01:34.031044 139802860935168 replay_runner.py:36] Average training steps per second: 292.19
I0905 19:01:34.312096 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.95
INFO:tensorflow:Starting iteration 26

Steps executed: 68 Episode length: 68 Return: -655.712090378515506805
INFO:tensorflow:Average training steps per second: 307.68

Steps executed: 443 Episode length: 375 Return: -33.47596773335483505
I0905 19:01:41.809011 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -344.59
INFO:tensorflow:Starting iteration 27
I0905 19:01:45.304039 139802860935168 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 306.69

Steps executed: 1000 Episode length: 1000 Return: 153.858125147834935
I0905 19:01:50.373201 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: 153.86
INFO:tensorflow:Starting iteration 28

Steps executed: 219 Episode length: 62 Return: -42.310471892012216935
INFO:tensorflow:Average training steps per second: 292.19
I0905 19:01:57.168295 139802860935168 replay_runner.py:36] Average training steps per second: 292.19
I0905 19:01:57.334938 139802860935168 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.49
INFO:tensorflow:Starting iteration 29

Steps executed: 357 Episode length: 200 Return: -64.12964388508912935
INFO:tensorflow:Average training steps per second: 289.96
I0905 19:02:04.337806 139802860935168 replay_runner.py:36] Average training steps per second: 289.96

Done fixed training!Episode length: 200 Return: -64.12964388508912935