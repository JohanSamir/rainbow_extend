I0902 23:24:59.257130 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0902 23:24:59.268701 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:24:59.268974 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:24:59.269130 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:24:59.269311 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:24:59.269443 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:24:59.269566 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:24:59.269682 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:24:59.269798 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:24:59.269918 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:24:59.270127 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:24:59.270267 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:24:59.270433 139926926592000 dqn_agent.py:283] 	 seed: 1630625099268630
I0902 23:24:59.273639 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:24:59.273840 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:24:59.274026 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:24:59.274166 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:24:59.274372 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:24:59.274699 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:24:59.274891 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:24:59.275043 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:24:59.275195 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:00.744209 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
I0902 23:25:01.124532 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:01.137637 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:25:01.146746 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:25:01.146967 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:25:01.147115 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:25:01.147292 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:25:01.147611 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:25:01.147820 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:25:01.147933 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:25:01.148033 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:25:01.148144 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:25:01.148223 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:25:01.148347 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:25:01.148451 139926926592000 dqn_agent.py:283] 	 seed: 1630625101146688
I0902 23:25:01.151279 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:25:01.151465 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:25:01.151614 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:25:01.151712 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:25:01.151792 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:25:01.151898 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:25:01.152021 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:25:01.152093 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:25:01.152197 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:25:01.184098 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:25:01.205405 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:25:01.205655 139926926592000 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.82
I0902 23:25:07.792548 139926926592000 replay_runner.py:36] Average training steps per second: 151.82
I0902 23:25:08.929352 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -377.93
Steps executed: 202 Episode length: 116 Return: -308.7894730067079
INFO:tensorflow:Starting iteration 1
I0902 23:25:13.074390 139926926592000 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 230.79
I0902 23:25:17.407680 139926926592000 replay_runner.py:36] Average training steps per second: 230.79

Steps executed: 274 Episode length: 124 Return: -270.42124848847584
INFO:tensorflow:Starting iteration 2
I0902 23:25:21.900389 139926926592000 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 223.36
I0902 23:25:26.378047 139926926592000 replay_runner.py:36] Average training steps per second: 223.36

Steps executed: 212 Episode length: 212 Return: -210.27025751986542
INFO:tensorflow:Starting iteration 3

Steps executed: 390 Episode length: 390 Return: -60.165745479808992
INFO:tensorflow:Average training steps per second: 215.28
I0902 23:25:35.367315 139926926592000 replay_runner.py:36] Average training steps per second: 215.28
I0902 23:25:35.966392 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.17
INFO:tensorflow:Starting iteration 4

Steps executed: 201 Episode length: 201 Return: -117.27817881854833
INFO:tensorflow:Average training steps per second: 225.31
I0902 23:25:44.443412 139926926592000 replay_runner.py:36] Average training steps per second: 225.31
I0902 23:25:44.651104 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -117.28
INFO:tensorflow:Starting iteration 5

Steps executed: 1000 Episode length: 1000 Return: -111.96400737237592
INFO:tensorflow:Average training steps per second: 226.19
I0902 23:25:53.331477 139926926592000 replay_runner.py:36] Average training steps per second: 226.19
I0902 23:25:55.203294 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.96
INFO:tensorflow:Starting iteration 6

Steps executed: 373 Episode length: 373 Return: -340.3063286870878592
INFO:tensorflow:Average training steps per second: 227.46
I0902 23:26:03.939977 139926926592000 replay_runner.py:36] Average training steps per second: 227.46
I0902 23:26:04.562340 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -340.31
INFO:tensorflow:Starting iteration 7

Steps executed: 461 Episode length: 461 Return: -261.7448270496776592
INFO:tensorflow:Average training steps per second: 223.01
I0902 23:26:13.454629 139926926592000 replay_runner.py:36] Average training steps per second: 223.01
I0902 23:26:14.133728 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -261.74
INFO:tensorflow:Starting iteration 8
I0902 23:26:18.330146 139926926592000 replay_runner.py:41] Starting iteration 8
INFO:tensorflow:Average training steps per second: 215.50

Steps executed: 703 Episode length: 703 Return: -403.5041308521698592
I0902 23:26:24.631839 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -403.50
INFO:tensorflow:Starting iteration 9

Steps executed: 565 Episode length: 565 Return: -522.8513477779834592
INFO:tensorflow:Average training steps per second: 217.09
I0902 23:26:33.564826 139926926592000 replay_runner.py:36] Average training steps per second: 217.09
I0902 23:26:34.886352 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -522.85
INFO:tensorflow:Starting iteration 10

Steps executed: 658 Episode length: 658 Return: -580.0813379162772592
INFO:tensorflow:Average training steps per second: 215.82
I0902 23:26:43.820930 139926926592000 replay_runner.py:36] Average training steps per second: 215.82
I0902 23:26:45.047174 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.08
INFO:tensorflow:Starting iteration 11
I0902 23:26:49.518278 139926926592000 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 220.45
I0902 23:26:54.055436 139926926592000 replay_runner.py:36] Average training steps per second: 220.45

Steps executed: 1000 Episode length: 1000 Return: -138.96909580955612
INFO:tensorflow:Starting iteration 12
I0902 23:27:01.673259 139926926592000 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 221.41

Steps executed: 1000 Episode length: 1000 Return: -161.19061188116981
I0902 23:27:08.542993 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.19
INFO:tensorflow:Starting iteration 13
I0902 23:27:12.828268 139926926592000 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 217.09

Steps executed: 1000 Episode length: 1000 Return: -174.13404423624348
I0902 23:27:20.440647 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -174.13
INFO:tensorflow:Starting iteration 14
I0902 23:27:24.749200 139926926592000 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 223.14
I0902 23:27:29.231093 139926926592000 replay_runner.py:36] Average training steps per second: 223.14

Steps executed: 1000 Episode length: 1000 Return: -91.716681822755678
INFO:tensorflow:Starting iteration 15
I0902 23:27:35.841434 139926926592000 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 224.34

Steps executed: 783 Episode length: 783 Return: -130.2267156957465878
I0902 23:27:42.447932 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -130.23
INFO:tensorflow:Starting iteration 16
I0902 23:27:46.438681 139926926592000 replay_runner.py:41] Starting iteration 16
INFO:tensorflow:Average training steps per second: 229.67

Steps executed: 543 Episode length: 543 Return: -463.5975721081643478
I0902 23:27:51.785646 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -463.60
INFO:tensorflow:Starting iteration 17

Steps executed: 416 Episode length: 416 Return: 36.452959935283423478
INFO:tensorflow:Average training steps per second: 226.53
I0902 23:28:00.480878 139926926592000 replay_runner.py:36] Average training steps per second: 226.53
I0902 23:28:01.119661 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 36.45
INFO:tensorflow:Starting iteration 18

Steps executed: 280 Episode length: 280 Return: -96.12937167064784478
INFO:tensorflow:Average training steps per second: 220.20
I0902 23:28:09.910935 139926926592000 replay_runner.py:36] Average training steps per second: 220.20
I0902 23:28:10.254631 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -96.13
INFO:tensorflow:Starting iteration 19

Steps executed: 267 Episode length: 187 Return: 280.32432011811174478
INFO:tensorflow:Average training steps per second: 232.24
I0902 23:28:18.875934 139926926592000 replay_runner.py:36] Average training steps per second: 232.24
I0902 23:28:19.085400 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 171.67
INFO:tensorflow:Starting iteration 20

Steps executed: 226 Episode length: 89 Return: -159.18822500609061478
INFO:tensorflow:Average training steps per second: 233.40
I0902 23:28:27.588763 139926926592000 replay_runner.py:36] Average training steps per second: 233.40
I0902 23:28:27.771227 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -140.52
INFO:tensorflow:Starting iteration 21

Steps executed: 302 Episode length: 128 Return: -386.9992526396488378
INFO:tensorflow:Average training steps per second: 222.68
I0902 23:28:36.495687 139926926592000 replay_runner.py:36] Average training steps per second: 222.68
I0902 23:28:36.805278 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -616.20
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 95 Return: -691.45224056176072478
INFO:tensorflow:Average training steps per second: 214.64
I0902 23:28:45.798272 139926926592000 replay_runner.py:36] Average training steps per second: 214.64
I0902 23:28:46.044359 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -436.94
INFO:tensorflow:Starting iteration 23

Steps executed: 252 Episode length: 252 Return: -56.33850951786716678
INFO:tensorflow:Average training steps per second: 217.89
I0902 23:28:54.957755 139926926592000 replay_runner.py:36] Average training steps per second: 217.89
I0902 23:28:55.281747 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -56.34
INFO:tensorflow:Starting iteration 24

Steps executed: 463 Episode length: 463 Return: -580.6031802942092678
INFO:tensorflow:Average training steps per second: 217.69
I0902 23:29:04.101636 139926926592000 replay_runner.py:36] Average training steps per second: 217.69
I0902 23:29:04.887671 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -580.60
INFO:tensorflow:Starting iteration 25

Steps executed: 213 Episode length: 213 Return: 20.483718657814182678
INFO:tensorflow:Average training steps per second: 216.13
I0902 23:29:13.884904 139926926592000 replay_runner.py:36] Average training steps per second: 216.13
I0902 23:29:14.124509 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 20.48
INFO:tensorflow:Starting iteration 26

Steps executed: 246 Episode length: 124 Return: -104.0904692362304378
INFO:tensorflow:Average training steps per second: 221.79
I0902 23:29:22.918826 139926926592000 replay_runner.py:36] Average training steps per second: 221.79
I0902 23:29:23.154172 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -102.62
INFO:tensorflow:Starting iteration 27

Steps executed: 265 Episode length: 114 Return: -166.6320681189011278
INFO:tensorflow:Average training steps per second: 222.07
I0902 23:29:32.058394 139926926592000 replay_runner.py:36] Average training steps per second: 222.07
I0902 23:29:32.268978 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -150.76
INFO:tensorflow:Starting iteration 28
I0902 23:29:36.687502 139926926592000 replay_runner.py:41] Starting iteration 28
INFO:tensorflow:Average training steps per second: 219.09
I0902 23:29:41.252269 139926926592000 replay_runner.py:36] Average training steps per second: 219.09

Steps executed: 335 Episode length: 335 Return: -379.4699600202824278
INFO:tensorflow:Starting iteration 29

Steps executed: 295 Episode length: 117 Return: -65.16769064453925278
INFO:tensorflow:Average training steps per second: 227.33
I0902 23:29:50.545051 139926926592000 replay_runner.py:36] Average training steps per second: 227.33

Done fixed training!Episode length: 117 Return: -65.16769064453925278