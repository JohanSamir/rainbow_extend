Loaded trained dqn in lunarlander
Training fixed agent 8, please be patient, may be a while...
I0828 10:50:38.712696 140220309850112 run_experiment.py:549] Creating TrainRunner ...
I0828 10:50:38.721155 140220309850112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:38.721279 140220309850112 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:38.721361 140220309850112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:38.721430 140220309850112 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:38.721492 140220309850112 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:38.721580 140220309850112 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:38.721662 140220309850112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:38.721751 140220309850112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:38.721821 140220309850112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:38.721892 140220309850112 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:38.721966 140220309850112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:38.722038 140220309850112 dqn_agent.py:283] 	 seed: 1630147838721124
I0828 10:50:38.723912 140220309850112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:38.724033 140220309850112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:38.724116 140220309850112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:38.724187 140220309850112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:38.724253 140220309850112 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:38.724328 140220309850112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:38.724408 140220309850112 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:38.724482 140220309850112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:38.724555 140220309850112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:38.749524 140220309850112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:38.989022 140220309850112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:38.997357 140220309850112 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0828 10:50:39.002907 140220309850112 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0828 10:50:39.003072 140220309850112 dqn_agent.py:272] 	 gamma: 0.990000
I0828 10:50:39.003207 140220309850112 dqn_agent.py:273] 	 update_horizon: 1.000000
I0828 10:50:39.003341 140220309850112 dqn_agent.py:274] 	 min_replay_history: 500
I0828 10:50:39.003494 140220309850112 dqn_agent.py:275] 	 update_period: 4
I0828 10:50:39.003720 140220309850112 dqn_agent.py:276] 	 target_update_period: 300
I0828 10:50:39.003827 140220309850112 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0828 10:50:39.003921 140220309850112 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0828 10:50:39.004006 140220309850112 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0828 10:50:39.004091 140220309850112 dqn_agent.py:280] 	 optimizer: adam
I0828 10:50:39.004202 140220309850112 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0828 10:50:39.004271 140220309850112 dqn_agent.py:283] 	 seed: 1630147839002735
I0828 10:50:39.006334 140220309850112 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0828 10:50:39.006456 140220309850112 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0828 10:50:39.006542 140220309850112 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0828 10:50:39.006617 140220309850112 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0828 10:50:39.006683 140220309850112 circular_replay_buffer.py:159] 	 stack_size: 1
I0828 10:50:39.006746 140220309850112 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0828 10:50:39.006839 140220309850112 circular_replay_buffer.py:161] 	 batch_size: 128
I0828 10:50:39.006921 140220309850112 circular_replay_buffer.py:162] 	 update_horizon: 1
I0828 10:50:39.006995 140220309850112 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0828 10:50:39.025956 140220309850112 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.000100, beta1=0.900000, beta2=0.999000, eps=0.000313
I0828 10:50:39.040408 140220309850112 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0828 10:50:39.040544 140220309850112 replay_runner.py:41] Starting iteration 0
Steps executed: 272 Episode length: 140 Return: -369.92690500616857
INFO:tensorflow:Average training steps per second: 256.92
I0828 10:50:42.932961 140220309850112 replay_runner.py:36] Average training steps per second: 256.92
I0828 10:50:43.737654 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -394.84
INFO:tensorflow:Starting iteration 1

Steps executed: 261 Episode length: 131 Return: -301.49859806846466
INFO:tensorflow:Average training steps per second: 349.12
I0828 10:50:49.605386 140220309850112 replay_runner.py:36] Average training steps per second: 349.12
I0828 10:50:49.755167 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -369.74
INFO:tensorflow:Starting iteration 2

Steps executed: 202 Episode length: 117 Return: -249.60022669457216
INFO:tensorflow:Average training steps per second: 346.01
I0828 10:50:55.861119 140220309850112 replay_runner.py:36] Average training steps per second: 346.01
I0828 10:50:55.968913 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.42
INFO:tensorflow:Starting iteration 3
I0828 10:50:59.382864 140220309850112 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 333.45

Steps executed: 322 Episode length: 161 Return: -44.548065198398296
I0828 10:51:02.590960 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -266.90
INFO:tensorflow:Starting iteration 4

Steps executed: 226 Episode length: 226 Return: -161.61833267593396
INFO:tensorflow:Average training steps per second: 334.43
I0828 10:51:08.972355 140220309850112 replay_runner.py:36] Average training steps per second: 334.43
I0828 10:51:09.143013 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.62
INFO:tensorflow:Starting iteration 5

Steps executed: 264 Episode length: 143 Return: -327.95521371383636
INFO:tensorflow:Average training steps per second: 352.12
I0828 10:51:15.395473 140220309850112 replay_runner.py:36] Average training steps per second: 352.12
I0828 10:51:15.556738 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -300.70
INFO:tensorflow:Starting iteration 6

Steps executed: 249 Episode length: 82 Return: -282.042658896048936
INFO:tensorflow:Average training steps per second: 357.45
I0828 10:51:21.791532 140220309850112 replay_runner.py:36] Average training steps per second: 357.45
I0828 10:51:21.916822 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -356.15
INFO:tensorflow:Starting iteration 7

Steps executed: 347 Episode length: 218 Return: -376.10568809906545
INFO:tensorflow:Average training steps per second: 353.32
I0828 10:51:28.191056 140220309850112 replay_runner.py:36] Average training steps per second: 353.32
I0828 10:51:28.447186 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -382.10
INFO:tensorflow:Starting iteration 8

Steps executed: 245 Episode length: 128 Return: -326.48580663968864
INFO:tensorflow:Average training steps per second: 357.77
I0828 10:51:34.669155 140220309850112 replay_runner.py:36] Average training steps per second: 357.77
I0828 10:51:34.824219 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -333.78
INFO:tensorflow:Starting iteration 9

Steps executed: 314 Episode length: 122 Return: -457.88904357963986
INFO:tensorflow:Average training steps per second: 351.09
I0828 10:51:41.177832 140220309850112 replay_runner.py:36] Average training steps per second: 351.09
I0828 10:51:41.368079 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -226.93
INFO:tensorflow:Starting iteration 10

Steps executed: 272 Episode length: 104 Return: -314.80329423442186
INFO:tensorflow:Average training steps per second: 361.82
I0828 10:51:47.618053 140220309850112 replay_runner.py:36] Average training steps per second: 361.82
I0828 10:51:47.758842 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -365.52
INFO:tensorflow:Starting iteration 11

Steps executed: 305 Episode length: 131 Return: -408.17354803629196
INFO:tensorflow:Average training steps per second: 363.60
I0828 10:51:54.030754 140220309850112 replay_runner.py:36] Average training steps per second: 363.60
I0828 10:51:54.193094 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -366.70
INFO:tensorflow:Starting iteration 12

Steps executed: 228 Episode length: 107 Return: -240.11041320685757
INFO:tensorflow:Average training steps per second: 366.90
I0828 10:52:00.460376 140220309850112 replay_runner.py:36] Average training steps per second: 366.90
I0828 10:52:00.585022 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.72
INFO:tensorflow:Starting iteration 13
I0828 10:52:04.125646 140220309850112 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 368.96

Steps executed: 264 Episode length: 151 Return: -317.10485184964773
I0828 10:52:06.984369 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -224.23
INFO:tensorflow:Starting iteration 14

Steps executed: 301 Episode length: 227 Return: -417.53202993845113
INFO:tensorflow:Average training steps per second: 364.06
I0828 10:52:13.242329 140220309850112 replay_runner.py:36] Average training steps per second: 364.06
I0828 10:52:13.446784 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -386.05
INFO:tensorflow:Starting iteration 15

Steps executed: 245 Episode length: 121 Return: -159.23099302936822
INFO:tensorflow:Average training steps per second: 368.23
I0828 10:52:19.693675 140220309850112 replay_runner.py:36] Average training steps per second: 368.23
I0828 10:52:19.833472 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -188.26
INFO:tensorflow:Starting iteration 16

Steps executed: 312 Episode length: 181 Return: -137.20311145665352
INFO:tensorflow:Average training steps per second: 351.37
I0828 10:52:26.193090 140220309850112 replay_runner.py:36] Average training steps per second: 351.37
I0828 10:52:26.383418 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -183.20
INFO:tensorflow:Starting iteration 17

Steps executed: 261 Episode length: 116 Return: -121.32256437392789
INFO:tensorflow:Average training steps per second: 353.23
I0828 10:52:32.707573 140220309850112 replay_runner.py:36] Average training steps per second: 353.23
I0828 10:52:32.863199 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.75
INFO:tensorflow:Starting iteration 18

Steps executed: 504 Episode length: 381 Return: 255.755822161097379
INFO:tensorflow:Average training steps per second: 349.67
I0828 10:52:39.212221 140220309850112 replay_runner.py:36] Average training steps per second: 349.67
I0828 10:52:39.785928 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: 72.78
INFO:tensorflow:Starting iteration 19

Steps executed: 269 Episode length: 142 Return: -660.89459654101059
INFO:tensorflow:Average training steps per second: 352.18
I0828 10:52:46.104945 140220309850112 replay_runner.py:36] Average training steps per second: 352.18
I0828 10:52:46.268292 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -623.83
INFO:tensorflow:Starting iteration 20

Steps executed: 296 Episode length: 199 Return: -94.983488569031669
INFO:tensorflow:Average training steps per second: 345.95
I0828 10:52:52.627124 140220309850112 replay_runner.py:36] Average training steps per second: 345.95
I0828 10:52:52.810771 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.53
INFO:tensorflow:Starting iteration 21
I0828 10:52:56.248079 140220309850112 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 343.04

Steps executed: 380 Episode length: 190 Return: -456.80072049303936
I0828 10:52:59.410748 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -390.73
INFO:tensorflow:Starting iteration 22
I0828 10:53:02.860745 140220309850112 replay_runner.py:41] Starting iteration 22
INFO:tensorflow:Average training steps per second: 351.58

Steps executed: 1000 Episode length: 1000 Return: -49.83891785336768
I0828 10:53:08.432198 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -49.84
INFO:tensorflow:Starting iteration 23
I0828 10:53:11.853586 140220309850112 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 344.91
I0828 10:53:14.753218 140220309850112 replay_runner.py:36] Average training steps per second: 344.91

Steps executed: 243 Episode length: 133 Return: -98.7319659799489568
INFO:tensorflow:Starting iteration 24

Steps executed: 850 Episode length: 704 Return: -206.234675144347658
INFO:tensorflow:Average training steps per second: 345.95
I0828 10:53:21.236576 140220309850112 replay_runner.py:36] Average training steps per second: 345.95
I0828 10:53:22.067877 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -280.68
INFO:tensorflow:Starting iteration 25

Steps executed: 202 Episode length: 101 Return: -585.683811647639828
INFO:tensorflow:Average training steps per second: 345.41
I0828 10:53:28.416245 140220309850112 replay_runner.py:36] Average training steps per second: 345.41
I0828 10:53:28.537877 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.14
INFO:tensorflow:Starting iteration 26
I0828 10:53:31.995017 140220309850112 replay_runner.py:41] Starting iteration 26
INFO:tensorflow:Average training steps per second: 353.64

Steps executed: 283 Episode length: 99 Return: -38.97108614473374678
I0828 10:53:34.990047 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -115.60
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 82 Return: -415.6520577748213478
INFO:tensorflow:Average training steps per second: 350.08
I0828 10:53:41.310348 140220309850112 replay_runner.py:36] Average training steps per second: 350.08
I0828 10:53:41.419502 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -232.33
INFO:tensorflow:Starting iteration 28

Steps executed: 333 Episode length: 172 Return: -57.1873651392391128
INFO:tensorflow:Average training steps per second: 352.56
I0828 10:53:47.655402 140220309850112 replay_runner.py:36] Average training steps per second: 352.56
I0828 10:53:47.872305 140220309850112 run_experiment.py:428] Average undiscounted return per evaluation episode: -86.97
INFO:tensorflow:Starting iteration 29

Steps executed: 300 Episode length: 136 Return: -39.8222502824778258
INFO:tensorflow:Average training steps per second: 361.86
I0828 10:53:54.079931 140220309850112 replay_runner.py:36] Average training steps per second: 361.86

Done fixed training!Episode length: 136 Return: -39.8222502824778258