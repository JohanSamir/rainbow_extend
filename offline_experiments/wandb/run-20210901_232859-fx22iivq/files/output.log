I0901 23:29:06.270245 140252174653440 run_experiment.py:549] Creating TrainRunner ...
WARNING:tensorflow:From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0901 23:29:06.270969 140252174653440 deprecation.py:345] From /home/joaoguilhermearujo/miniconda3/envs/rain/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:101: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
I0901 23:29:06.342540 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:06.343570 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:06.343655 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:06.343718 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:06.343773 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:06.343846 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:06.343993 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:06.344056 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:06.344125 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:06.344211 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:06.344278 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:06.344344 140252174653440 dqn_agent.py:283] 	 seed: 1630538946342488
I0901 23:29:06.346168 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:06.346296 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:06.346365 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:06.346424 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:06.346478 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:06.346544 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:06.346639 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:06.346705 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:06.346758 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in lunarlander
I0901 23:29:12.789313 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.638231 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:13.677323 140252174653440 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 23:29:13.693383 140252174653440 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 23:29:13.693580 140252174653440 dqn_agent.py:272] 	 gamma: 0.990000
I0901 23:29:13.704255 140252174653440 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 23:29:13.704398 140252174653440 dqn_agent.py:274] 	 min_replay_history: 500
I0901 23:29:13.705080 140252174653440 dqn_agent.py:275] 	 update_period: 4
I0901 23:29:13.705174 140252174653440 dqn_agent.py:276] 	 target_update_period: 300
I0901 23:29:13.705269 140252174653440 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 23:29:13.705991 140252174653440 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 23:29:13.706080 140252174653440 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 23:29:13.706631 140252174653440 dqn_agent.py:280] 	 optimizer: adam
I0901 23:29:13.706721 140252174653440 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 23:29:13.707203 140252174653440 dqn_agent.py:283] 	 seed: 1630538953693339
I0901 23:29:13.714000 140252174653440 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 23:29:13.714173 140252174653440 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0901 23:29:13.714290 140252174653440 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 23:29:13.714512 140252174653440 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 23:29:13.714682 140252174653440 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 23:29:13.714851 140252174653440 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 23:29:13.715194 140252174653440 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 23:29:13.715583 140252174653440 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 23:29:13.715951 140252174653440 circular_replay_buffer.py:163] 	 gamma: 0.990000
Training fixed agent 8, please be patient, may be a while...
I0901 23:29:14.445113 140252174653440 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 23:29:14.514955 140252174653440 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 23:29:14.515222 140252174653440 replay_runner.py:41] Starting iteration 0
Steps executed: 292 Episode length: 146 Return: -354.7808074311875
INFO:tensorflow:Average training steps per second: 130.62
I0901 23:29:22.170894 140252174653440 replay_runner.py:36] Average training steps per second: 130.62
I0901 23:29:23.444861 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -376.75
INFO:tensorflow:Starting iteration 1

Steps executed: 207 Episode length: 109 Return: -285.5912569251449
INFO:tensorflow:Average training steps per second: 211.69
I0901 23:29:32.305356 140252174653440 replay_runner.py:36] Average training steps per second: 211.69
I0901 23:29:32.497395 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -325.04
INFO:tensorflow:Starting iteration 2
I0901 23:29:36.795335 140252174653440 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 208.16

Steps executed: 321 Episode length: 321 Return: -311.39432734055475
I0901 23:29:42.120167 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.39
INFO:tensorflow:Starting iteration 3

Steps executed: 204 Episode length: 204 Return: -219.88315869841537
INFO:tensorflow:Average training steps per second: 213.48
I0901 23:29:51.143653 140252174653440 replay_runner.py:36] Average training steps per second: 213.48
I0901 23:29:51.377269 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.88
INFO:tensorflow:Starting iteration 4
I0901 23:29:55.654769 140252174653440 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 225.99

Steps executed: 1000 Episode length: 1000 Return: -185.35874127967423
I0901 23:30:03.229782 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -185.36
INFO:tensorflow:Starting iteration 5
I0901 23:30:07.502585 140252174653440 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 227.11

Steps executed: 710 Episode length: 710 Return: -789.9764248296971423
I0901 23:30:13.683960 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -789.98
INFO:tensorflow:Starting iteration 6

Steps executed: 249 Episode length: 249 Return: -445.6684312079079323
INFO:tensorflow:Average training steps per second: 231.70
I0901 23:30:22.335870 140252174653440 replay_runner.py:36] Average training steps per second: 231.70
I0901 23:30:22.663188 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -445.67
INFO:tensorflow:Starting iteration 7
I0901 23:30:27.154322 140252174653440 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 232.58

Steps executed: 1000 Episode length: 1000 Return: -79.180414056577553
I0901 23:30:34.102752 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -79.18
INFO:tensorflow:Starting iteration 8

Steps executed: 260 Episode length: 260 Return: -242.5939351175284753
INFO:tensorflow:Average training steps per second: 229.70
I0901 23:30:42.810678 140252174653440 replay_runner.py:36] Average training steps per second: 229.70
I0901 23:30:43.125646 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.59
INFO:tensorflow:Starting iteration 9
I0901 23:30:47.513286 140252174653440 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 219.94

Steps executed: 1000 Episode length: 1000 Return: -219.65505508926054
I0901 23:30:54.563707 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -219.66
INFO:tensorflow:Starting iteration 10
I0901 23:30:58.950836 140252174653440 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 218.50

Steps executed: 1000 Episode length: 1000 Return: -145.12974584494455
I0901 23:31:06.065442 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -145.13
INFO:tensorflow:Starting iteration 11
I0901 23:31:10.497047 140252174653440 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 224.80

Steps executed: 1000 Episode length: 1000 Return: -197.39709285667607
I0901 23:31:19.563416 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -197.40
INFO:tensorflow:Starting iteration 12
I0901 23:31:23.986864 140252174653440 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 228.72
I0901 23:31:28.359435 140252174653440 replay_runner.py:36] Average training steps per second: 228.72

Steps executed: 206 Episode length: 206 Return: -127.6122029385240907
INFO:tensorflow:Starting iteration 13
I0901 23:31:32.900823 140252174653440 replay_runner.py:41] Starting iteration 13
INFO:tensorflow:Average training steps per second: 227.32

Steps executed: 753 Episode length: 753 Return: -270.3237049145824407
I0901 23:31:39.243402 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -270.32
INFO:tensorflow:Starting iteration 14
I0901 23:31:43.618879 140252174653440 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 232.50

Steps executed: 1000 Episode length: 1000 Return: -100.24902680996742
I0901 23:31:51.749795 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.25
INFO:tensorflow:Starting iteration 15
I0901 23:31:56.094965 140252174653440 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 225.61

Steps executed: 1000 Episode length: 1000 Return: -70.067454906848062
I0901 23:32:05.697911 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -70.07
INFO:tensorflow:Starting iteration 16

Steps executed: 345 Episode length: 345 Return: -391.7479448760631062
INFO:tensorflow:Average training steps per second: 262.81
I0901 23:32:13.291704 140252174653440 replay_runner.py:36] Average training steps per second: 262.81
I0901 23:32:13.609049 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -391.75
INFO:tensorflow:Starting iteration 17

Steps executed: 342 Episode length: 342 Return: -20.03554165407973662
INFO:tensorflow:Average training steps per second: 252.53
I0901 23:32:21.377937 140252174653440 replay_runner.py:36] Average training steps per second: 252.53
I0901 23:32:21.841192 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -20.04
INFO:tensorflow:Starting iteration 18
I0901 23:32:26.124067 140252174653440 replay_runner.py:41] Starting iteration 18
INFO:tensorflow:Average training steps per second: 229.78

Steps executed: 623 Episode length: 623 Return: -323.8145029055330662
I0901 23:32:31.911740 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -323.81
INFO:tensorflow:Starting iteration 19

Steps executed: 236 Episode length: 236 Return: -220.4685198261071862
INFO:tensorflow:Average training steps per second: 225.44
I0901 23:32:41.378522 140252174653440 replay_runner.py:36] Average training steps per second: 225.44
I0901 23:32:41.652553 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -220.47
INFO:tensorflow:Starting iteration 20
I0901 23:32:45.912919 140252174653440 replay_runner.py:41] Starting iteration 20
INFO:tensorflow:Average training steps per second: 226.69
I0901 23:32:50.325003 140252174653440 replay_runner.py:36] Average training steps per second: 226.69

Steps executed: 416 Episode length: 416 Return: 260.38386281950034862
INFO:tensorflow:Starting iteration 21

Steps executed: 449 Episode length: 449 Return: 218.09600214257978862
INFO:tensorflow:Average training steps per second: 227.51
I0901 23:32:59.638858 140252174653440 replay_runner.py:36] Average training steps per second: 227.51
I0901 23:33:00.292753 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: 218.10
INFO:tensorflow:Starting iteration 22

Steps executed: 528 Episode length: 341 Return: -664.1597486757267762
INFO:tensorflow:Average training steps per second: 224.20
I0901 23:33:09.111417 140252174653440 replay_runner.py:36] Average training steps per second: 224.20
I0901 23:33:09.839592 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -433.80
INFO:tensorflow:Starting iteration 23
I0901 23:33:14.151866 140252174653440 replay_runner.py:41] Starting iteration 23
INFO:tensorflow:Average training steps per second: 232.03
I0901 23:33:18.462018 140252174653440 replay_runner.py:36] Average training steps per second: 232.03

Steps executed: 399 Episode length: 399 Return: -311.2300316821968762
INFO:tensorflow:Starting iteration 24

Steps executed: 299 Episode length: 153 Return: -31.48228438476383762
INFO:tensorflow:Average training steps per second: 230.65
I0901 23:33:27.786290 140252174653440 replay_runner.py:36] Average training steps per second: 230.65
I0901 23:33:28.053902 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.13
INFO:tensorflow:Starting iteration 25
I0901 23:33:32.471333 140252174653440 replay_runner.py:41] Starting iteration 25
INFO:tensorflow:Average training steps per second: 225.52
I0901 23:33:36.906936 140252174653440 replay_runner.py:36] Average training steps per second: 225.52

Steps executed: 222 Episode length: 100 Return: -150.0912456439234762
INFO:tensorflow:Starting iteration 26

Steps executed: 276 Episode length: 203 Return: 10.695336140326494762
INFO:tensorflow:Average training steps per second: 230.11
I0901 23:33:45.840722 140252174653440 replay_runner.py:36] Average training steps per second: 230.11
I0901 23:33:46.107463 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -341.23
INFO:tensorflow:Starting iteration 27
I0901 23:33:50.547213 140252174653440 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 232.85
I0901 23:33:54.842732 140252174653440 replay_runner.py:36] Average training steps per second: 232.85

Steps executed: 317 Episode length: 218 Return: -229.3362357414858762
INFO:tensorflow:Starting iteration 28

Steps executed: 283 Episode length: 99 Return: -436.40912051802644762
INFO:tensorflow:Average training steps per second: 232.21
I0901 23:34:03.934379 140252174653440 replay_runner.py:36] Average training steps per second: 232.21
I0901 23:34:04.183206 140252174653440 run_experiment.py:428] Average undiscounted return per evaluation episode: -651.48
INFO:tensorflow:Starting iteration 29
I0901 23:34:08.558295 140252174653440 replay_runner.py:41] Starting iteration 29
INFO:tensorflow:Average training steps per second: 231.71
I0901 23:34:12.874868 140252174653440 replay_runner.py:36] Average training steps per second: 231.71


Done fixed training!Episode length: 70 Return: -635.74402762214614562