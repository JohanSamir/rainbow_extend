Loaded trained dqn in acrobot
Training fixed agent 8, please be patient, may be a while...
I0901 12:44:51.365791 140586480396288 run_experiment.py:549] Creating TrainRunner ...
I0901 12:44:51.376543 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:44:51.376752 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:44:51.376986 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:44:51.377182 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:44:51.377299 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:44:51.377412 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:44:51.377543 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:44:51.377650 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:44:51.377822 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:44:51.377904 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:44:51.377987 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:44:51.378058 140586480396288 dqn_agent.py:283] 	 seed: 1630500291376494
I0901 12:44:51.381466 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:44:51.381668 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:44:51.381789 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:44:51.381874 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:44:51.381953 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:44:51.382039 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:44:51.382194 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:44:51.382284 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:44:51.382399 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:44:51.433876 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:51.919260 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:51.935727 140586480396288 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0901 12:44:51.946138 140586480396288 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0901 12:44:51.946403 140586480396288 dqn_agent.py:272] 	 gamma: 0.990000
I0901 12:44:51.946579 140586480396288 dqn_agent.py:273] 	 update_horizon: 1.000000
I0901 12:44:51.946734 140586480396288 dqn_agent.py:274] 	 min_replay_history: 500
I0901 12:44:51.946849 140586480396288 dqn_agent.py:275] 	 update_period: 4
I0901 12:44:51.946950 140586480396288 dqn_agent.py:276] 	 target_update_period: 100
I0901 12:44:51.947137 140586480396288 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0901 12:44:51.947288 140586480396288 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0901 12:44:51.947458 140586480396288 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0901 12:44:51.947561 140586480396288 dqn_agent.py:280] 	 optimizer: adam
I0901 12:44:51.947748 140586480396288 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0901 12:44:51.947908 140586480396288 dqn_agent.py:283] 	 seed: 1630500291946059
I0901 12:44:51.950862 140586480396288 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0901 12:44:51.951038 140586480396288 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0901 12:44:51.951134 140586480396288 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0901 12:44:51.951220 140586480396288 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0901 12:44:51.951340 140586480396288 circular_replay_buffer.py:159] 	 stack_size: 1
I0901 12:44:51.951597 140586480396288 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0901 12:44:51.951759 140586480396288 circular_replay_buffer.py:161] 	 batch_size: 128
I0901 12:44:51.951838 140586480396288 circular_replay_buffer.py:162] 	 update_horizon: 1
I0901 12:44:51.951931 140586480396288 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0901 12:44:51.994303 140586480396288 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0901 12:44:52.020117 140586480396288 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0901 12:44:52.020494 140586480396288 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 133.67
I0901 12:44:59.502188 140586480396288 replay_runner.py:36] Average training steps per second: 133.67
Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:45:01.152795 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1
I0901 12:45:01.412043 140586480396288 replay_runner.py:41] Starting iteration 1
INFO:tensorflow:Average training steps per second: 185.41
I0901 12:45:06.806261 140586480396288 replay_runner.py:36] Average training steps per second: 185.41
I0901 12:45:07.224221 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 2
I0901 12:45:07.473084 140586480396288 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 185.85
I0901 12:45:12.854216 140586480396288 replay_runner.py:36] Average training steps per second: 185.85
I0901 12:45:13.288979 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 3
I0901 12:45:13.518996 140586480396288 replay_runner.py:41] Starting iteration 3
INFO:tensorflow:Average training steps per second: 179.29
I0901 12:45:19.096867 140586480396288 replay_runner.py:36] Average training steps per second: 179.29
I0901 12:45:19.565651 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 4
I0901 12:45:19.804106 140586480396288 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 181.39
I0901 12:45:25.317460 140586480396288 replay_runner.py:36] Average training steps per second: 181.39
I0901 12:45:25.769247 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 5
I0901 12:45:26.026384 140586480396288 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 185.79
I0901 12:45:31.409155 140586480396288 replay_runner.py:36] Average training steps per second: 185.79
I0901 12:45:31.860282 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 6

Steps executed: 325 Episode length: 188 Return: -187.0
INFO:tensorflow:Average training steps per second: 185.62
I0901 12:45:37.497881 140586480396288 replay_runner.py:36] Average training steps per second: 185.62
I0901 12:45:37.808383 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -161.50
INFO:tensorflow:Starting iteration 7

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 186.43
I0901 12:45:43.403234 140586480396288 replay_runner.py:36] Average training steps per second: 186.43
I0901 12:45:43.841297 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 8

Steps executed: 300 Episode length: 300 Return: -299.0
INFO:tensorflow:Average training steps per second: 182.77
I0901 12:45:49.565606 140586480396288 replay_runner.py:36] Average training steps per second: 182.77
I0901 12:45:49.822680 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -299.00
INFO:tensorflow:Starting iteration 9

Steps executed: 250 Episode length: 96 Return: -95.0.0
INFO:tensorflow:Average training steps per second: 185.12
I0901 12:45:55.471898 140586480396288 replay_runner.py:36] Average training steps per second: 185.12
I0901 12:45:55.716665 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 10
I0901 12:45:55.975488 140586480396288 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 185.01

Steps executed: 381 Episode length: 381 Return: -380.0
I0901 12:46:01.731333 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -380.00
INFO:tensorflow:Starting iteration 11
I0901 12:46:01.985873 140586480396288 replay_runner.py:41] Starting iteration 11
INFO:tensorflow:Average training steps per second: 185.79

Steps executed: 597 Episode length: 500 Return: -500.0
I0901 12:46:07.887590 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -298.00
INFO:tensorflow:Starting iteration 12
I0901 12:46:08.130160 140586480396288 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 190.92

Steps executed: 500 Episode length: 500 Return: -500.0
I0901 12:46:13.817780 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 13

Steps executed: 250 Episode length: 87 Return: -86.0.0
INFO:tensorflow:Average training steps per second: 197.63
I0901 12:46:19.118450 140586480396288 replay_runner.py:36] Average training steps per second: 197.63
I0901 12:46:19.315331 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.33
INFO:tensorflow:Starting iteration 14

Steps executed: 209 Episode length: 95 Return: -94.0.0
INFO:tensorflow:Average training steps per second: 187.15
I0901 12:46:24.895746 140586480396288 replay_runner.py:36] Average training steps per second: 187.15
I0901 12:46:25.063197 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.50
INFO:tensorflow:Starting iteration 15

Steps executed: 354 Episode length: 174 Return: -173.0
INFO:tensorflow:Average training steps per second: 195.11
I0901 12:46:30.419306 140586480396288 replay_runner.py:36] Average training steps per second: 195.11
I0901 12:46:30.704707 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -176.00
INFO:tensorflow:Starting iteration 16

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 188.62
I0901 12:46:36.239495 140586480396288 replay_runner.py:36] Average training steps per second: 188.62
I0901 12:46:36.658942 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 17
I0901 12:46:36.883175 140586480396288 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 186.46
I0901 12:46:42.246529 140586480396288 replay_runner.py:36] Average training steps per second: 186.46
I0901 12:46:42.682227 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 18

Steps executed: 269 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 193.42
I0901 12:46:48.098761 140586480396288 replay_runner.py:36] Average training steps per second: 193.42
I0901 12:46:48.341474 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -133.50
INFO:tensorflow:Starting iteration 19

Steps executed: 663 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 185.04
I0901 12:46:53.999505 140586480396288 replay_runner.py:36] Average training steps per second: 185.04
I0901 12:46:54.564242 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -331.00
INFO:tensorflow:Starting iteration 20

Steps executed: 220 Episode length: 131 Return: -130.0
INFO:tensorflow:Average training steps per second: 191.43
I0901 12:47:00.029877 140586480396288 replay_runner.py:36] Average training steps per second: 191.43
I0901 12:47:00.228684 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.00
INFO:tensorflow:Starting iteration 21

Steps executed: 304 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 188.82
I0901 12:47:05.769724 140586480396288 replay_runner.py:36] Average training steps per second: 188.82
I0901 12:47:06.070246 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -100.33
INFO:tensorflow:Starting iteration 22

Steps executed: 256 Episode length: 119 Return: -118.0
INFO:tensorflow:Average training steps per second: 189.72
I0901 12:47:11.602092 140586480396288 replay_runner.py:36] Average training steps per second: 189.72
I0901 12:47:11.821659 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -127.00
INFO:tensorflow:Starting iteration 23

Steps executed: 171 Episode length: 71 Return: -70.000
INFO:tensorflow:Average training steps per second: 192.01
I0901 12:47:17.271449 140586480396288 replay_runner.py:36] Average training steps per second: 192.01

Steps executed: 267 Episode length: 96 Return: -95.000
INFO:tensorflow:Starting iteration 24

Steps executed: 208 Episode length: 117 Return: -116.0
INFO:tensorflow:Average training steps per second: 192.05
I0901 12:47:22.958363 140586480396288 replay_runner.py:36] Average training steps per second: 192.05
I0901 12:47:23.137198 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -103.00
INFO:tensorflow:Starting iteration 25

Steps executed: 295 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 193.57
I0901 12:47:28.541572 140586480396288 replay_runner.py:36] Average training steps per second: 193.57
I0901 12:47:28.791582 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -97.33
INFO:tensorflow:Starting iteration 26

Steps executed: 260 Episode length: 97 Return: -96.0.0
INFO:tensorflow:Average training steps per second: 194.92
I0901 12:47:34.166760 140586480396288 replay_runner.py:36] Average training steps per second: 194.92
I0901 12:47:34.389757 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -85.67
INFO:tensorflow:Starting iteration 27
I0901 12:47:34.631594 140586480396288 replay_runner.py:41] Starting iteration 27
INFO:tensorflow:Average training steps per second: 195.40

Steps executed: 276 Episode length: 85 Return: -84.0.0
I0901 12:47:40.000035 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -91.00
INFO:tensorflow:Starting iteration 28

Steps executed: 246 Episode length: 71 Return: -70.0.0
INFO:tensorflow:Average training steps per second: 194.64
I0901 12:47:45.384557 140586480396288 replay_runner.py:36] Average training steps per second: 194.64
I0901 12:47:45.610897 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -81.00
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 81 Return: -80.0.0
INFO:tensorflow:Average training steps per second: 190.28
I0901 12:47:51.119104 140586480396288 replay_runner.py:36] Average training steps per second: 190.28
I0901 12:47:51.341105 140586480396288 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.67