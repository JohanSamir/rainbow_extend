I0902 23:40:39.758036 139926926592000 run_experiment.py:549] Creating TrainRunner ...
I0902 23:40:39.767728 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:39.768038 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:39.768181 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:39.768268 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:39.768399 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:39.768507 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:39.768769 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:39.768944 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:39.769023 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:39.769172 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:39.769269 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:39.769495 139926926592000 dqn_agent.py:283] 	 seed: 1630626039767659
I0902 23:40:39.771772 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:39.771892 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:39.771973 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:39.772036 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:39.772093 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:39.772194 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:39.772456 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:39.772562 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:39.772675 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:39.808497 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:40.163892 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:40.178043 139926926592000 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:40:40.187567 139926926592000 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:40:40.187805 139926926592000 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:40:40.187959 139926926592000 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:40:40.188102 139926926592000 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:40:40.188215 139926926592000 dqn_agent.py:275] 	 update_period: 4
I0902 23:40:40.188341 139926926592000 dqn_agent.py:276] 	 target_update_period: 300
I0902 23:40:40.188449 139926926592000 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:40:40.188527 139926926592000 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:40:40.188688 139926926592000 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:40:40.188815 139926926592000 dqn_agent.py:280] 	 optimizer: adam
I0902 23:40:40.188991 139926926592000 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:40:40.189071 139926926592000 dqn_agent.py:283] 	 seed: 1630626040187510
I0902 23:40:40.190716 139926926592000 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:40:40.190849 139926926592000 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 23:40:40.190928 139926926592000 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:40:40.190991 139926926592000 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:40:40.191049 139926926592000 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:40:40.191134 139926926592000 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:40:40.191203 139926926592000 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:40:40.191286 139926926592000 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:40:40.191355 139926926592000 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:40:40.223553 139926926592000 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:40:40.256245 139926926592000 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:40:40.256508 139926926592000 replay_runner.py:41] Starting iteration 0
Loaded trained dqn in lunarlander
Training fixed agent 5, please be patient, may be a while...
INFO:tensorflow:Average training steps per second: 164.53
I0902 23:40:46.334731 139926926592000 replay_runner.py:36] Average training steps per second: 164.53
I0902 23:40:47.603718 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -510.65
Steps executed: 288 Episode length: 93 Return: -512.620838275491917
INFO:tensorflow:Starting iteration 1

Steps executed: 287 Episode length: 138 Return: -259.13796108165057
INFO:tensorflow:Average training steps per second: 225.71
I0902 23:40:56.260940 139926926592000 replay_runner.py:36] Average training steps per second: 225.71
I0902 23:40:56.517470 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -279.13
INFO:tensorflow:Starting iteration 2
I0902 23:41:00.786224 139926926592000 replay_runner.py:41] Starting iteration 2
INFO:tensorflow:Average training steps per second: 216.60

Steps executed: 395 Episode length: 395 Return: -598.29181009480677
I0902 23:41:06.106279 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -598.29
INFO:tensorflow:Starting iteration 3

Steps executed: 145 Episode length: 145 Return: -393.84613034271847
INFO:tensorflow:Average training steps per second: 220.86

Steps executed: 856 Episode length: 711 Return: -398.09453745944245
I0902 23:41:17.176031 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -395.97
INFO:tensorflow:Starting iteration 4
I0902 23:41:21.511441 139926926592000 replay_runner.py:41] Starting iteration 4
INFO:tensorflow:Average training steps per second: 223.08

Steps executed: 1000 Episode length: 1000 Return: -121.1872800096937
I0902 23:41:28.018753 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -121.19
INFO:tensorflow:Starting iteration 5
I0902 23:41:32.078499 139926926592000 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 213.57

Steps executed: 1000 Episode length: 1000 Return: -109.05142170963643
I0902 23:41:40.090434 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -109.05
INFO:tensorflow:Starting iteration 6
I0902 23:41:44.302242 139926926592000 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 213.25

Steps executed: 1000 Episode length: 1000 Return: -82.545640170579093
I0902 23:41:52.195494 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.55
INFO:tensorflow:Starting iteration 7
I0902 23:41:56.571674 139926926592000 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 214.79

Steps executed: 1000 Episode length: 1000 Return: -114.36295397617836
I0902 23:42:03.937757 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -114.36
INFO:tensorflow:Starting iteration 8

Steps executed: 214 Episode length: 51 Return: -389.37534083221075836
INFO:tensorflow:Average training steps per second: 217.72
I0902 23:42:12.886981 139926926592000 replay_runner.py:36] Average training steps per second: 217.72
I0902 23:42:13.090260 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -250.71
INFO:tensorflow:Starting iteration 9
I0902 23:42:17.418617 139926926592000 replay_runner.py:41] Starting iteration 9
INFO:tensorflow:Average training steps per second: 214.01

Steps executed: 970 Episode length: 970 Return: -383.5773746224418836
I0902 23:42:24.533102 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -383.58
INFO:tensorflow:Starting iteration 10
I0902 23:42:28.695070 139926926592000 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 214.81

Steps executed: 681 Episode length: 681 Return: -1495.842536021984436
I0902 23:42:34.767616 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -1495.84
INFO:tensorflow:Starting iteration 11

Steps executed: 170 Episode length: 170 Return: -352.0926888770126436
INFO:tensorflow:Average training steps per second: 221.48

Steps executed: 573 Episode length: 403 Return: -1222.937937120275436
I0902 23:42:44.397148 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -787.52
INFO:tensorflow:Starting iteration 12

Steps executed: 268 Episode length: 82 Return: -587.20197636687841436
INFO:tensorflow:Average training steps per second: 220.96
I0902 23:42:53.102494 139926926592000 replay_runner.py:36] Average training steps per second: 220.96
I0902 23:42:53.362491 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -564.06
INFO:tensorflow:Starting iteration 13

Steps executed: 589 Episode length: 589 Return: -187.6750313938275436
INFO:tensorflow:Average training steps per second: 218.98
I0902 23:43:02.163114 139926926592000 replay_runner.py:36] Average training steps per second: 218.98
I0902 23:43:03.377584 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -187.68
INFO:tensorflow:Starting iteration 14

Steps executed: 468 Episode length: 468 Return: -1339.952454584771436
INFO:tensorflow:Average training steps per second: 219.67
I0902 23:43:12.201789 139926926592000 replay_runner.py:36] Average training steps per second: 219.67
I0902 23:43:12.934597 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -1339.95
INFO:tensorflow:Starting iteration 15

Steps executed: 370 Episode length: 205 Return: -283.5192038654343436
INFO:tensorflow:Average training steps per second: 216.42
I0902 23:43:21.680108 139926926592000 replay_runner.py:36] Average training steps per second: 216.42
I0902 23:43:22.060137 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -264.52
INFO:tensorflow:Starting iteration 16

Steps executed: 251 Episode length: 251 Return: -58.89282304464117436
INFO:tensorflow:Average training steps per second: 216.62
I0902 23:43:30.937200 139926926592000 replay_runner.py:36] Average training steps per second: 216.62
I0902 23:43:31.235522 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -58.89
INFO:tensorflow:Starting iteration 17
I0902 23:43:35.544848 139926926592000 replay_runner.py:41] Starting iteration 17
INFO:tensorflow:Average training steps per second: 232.38
I0902 23:43:39.848730 139926926592000 replay_runner.py:36] Average training steps per second: 232.38

Steps executed: 253 Episode length: 133 Return: -37.79902762178349436
INFO:tensorflow:Starting iteration 18

Steps executed: 319 Episode length: 236 Return: -151.0980513923467236
INFO:tensorflow:Average training steps per second: 223.37
I0902 23:43:48.898901 139926926592000 replay_runner.py:36] Average training steps per second: 223.37
I0902 23:43:49.199717 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 19
I0902 23:43:53.359851 139926926592000 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 225.67

Steps executed: 375 Episode length: 195 Return: -137.3184759072182736
I0902 23:43:58.182965 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -72.59
INFO:tensorflow:Starting iteration 20

Steps executed: 228 Episode length: 228 Return: -60.62069855547055436
INFO:tensorflow:Average training steps per second: 216.09
I0902 23:44:07.237934 139926926592000 replay_runner.py:36] Average training steps per second: 216.09
I0902 23:44:07.513349 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -60.62
INFO:tensorflow:Starting iteration 21
I0902 23:44:11.836077 139926926592000 replay_runner.py:41] Starting iteration 21
INFO:tensorflow:Average training steps per second: 217.09

Steps executed: 1000 Episode length: 1000 Return: -166.17501649924176
I0902 23:44:20.403196 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -166.18
INFO:tensorflow:Starting iteration 22

Steps executed: 295 Episode length: 161 Return: -84.70429796146186176
INFO:tensorflow:Average training steps per second: 219.86
I0902 23:44:29.316125 139926926592000 replay_runner.py:36] Average training steps per second: 219.86
I0902 23:44:29.598918 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -63.87
INFO:tensorflow:Starting iteration 23

Steps executed: 295 Episode length: 295 Return: -538.6883451835185176
INFO:tensorflow:Average training steps per second: 217.99
I0902 23:44:38.588393 139926926592000 replay_runner.py:36] Average training steps per second: 217.99
I0902 23:44:39.028599 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -538.69
INFO:tensorflow:Starting iteration 24
I0902 23:44:43.420809 139926926592000 replay_runner.py:41] Starting iteration 24
INFO:tensorflow:Average training steps per second: 220.65
I0902 23:44:47.953357 139926926592000 replay_runner.py:36] Average training steps per second: 220.65

Steps executed: 303 Episode length: 131 Return: -181.5854367062498276
INFO:tensorflow:Starting iteration 25

Steps executed: 360 Episode length: 232 Return: 236.44084920555161676
INFO:tensorflow:Average training steps per second: 215.26
I0902 23:44:57.315998 139926926592000 replay_runner.py:36] Average training steps per second: 215.26
I0902 23:44:57.659770 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 96.45
INFO:tensorflow:Starting iteration 26

Steps executed: 259 Episode length: 180 Return: 235.19574315568133676
INFO:tensorflow:Average training steps per second: 218.06
I0902 23:45:06.564990 139926926592000 replay_runner.py:36] Average training steps per second: 218.06
I0902 23:45:06.778892 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: 60.01
INFO:tensorflow:Starting iteration 27

Steps executed: 202 Episode length: 202 Return: -777.4123393925425676
INFO:tensorflow:Average training steps per second: 217.60
I0902 23:45:15.655021 139926926592000 replay_runner.py:36] Average training steps per second: 217.60
I0902 23:45:15.874853 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -777.41
INFO:tensorflow:Starting iteration 28

Steps executed: 243 Episode length: 243 Return: -160.2728005325021776
INFO:tensorflow:Average training steps per second: 223.13
I0902 23:45:24.755816 139926926592000 replay_runner.py:36] Average training steps per second: 223.13
I0902 23:45:24.992460 139926926592000 run_experiment.py:428] Average undiscounted return per evaluation episode: -160.27
INFO:tensorflow:Starting iteration 29

Steps executed: 227 Episode length: 105 Return: -226.8554749161995776
INFO:tensorflow:Average training steps per second: 218.80
I0902 23:45:33.943042 139926926592000 replay_runner.py:36] Average training steps per second: 218.80

Done fixed training!Episode length: 105 Return: -226.8554749161995776