I0902 23:22:14.448409 140527680751616 run_experiment.py:549] Creating TrainRunner ...
I0902 23:22:14.457762 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:14.458059 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:14.458221 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:14.458313 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:14.458395 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:14.458467 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:14.458612 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:14.458745 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:14.459014 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:14.459183 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:14.459303 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:14.459376 140527680751616 dqn_agent.py:283] 	 seed: 1630624934457689
I0902 23:22:14.462171 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:14.462411 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:22:14.462537 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:14.462625 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:14.462702 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:14.462792 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:14.462863 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:14.462932 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:14.463001 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
Loaded trained dqn in acrobot
Training fixed agent 7, please be patient, may be a while...
I0902 23:22:16.363177 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.754661 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.766624 140527680751616 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 23:22:16.772888 140527680751616 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 23:22:16.773051 140527680751616 dqn_agent.py:272] 	 gamma: 0.990000
I0902 23:22:16.773171 140527680751616 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 23:22:16.773289 140527680751616 dqn_agent.py:274] 	 min_replay_history: 500
I0902 23:22:16.773355 140527680751616 dqn_agent.py:275] 	 update_period: 4
I0902 23:22:16.773444 140527680751616 dqn_agent.py:276] 	 target_update_period: 100
I0902 23:22:16.773545 140527680751616 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 23:22:16.773645 140527680751616 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 23:22:16.773764 140527680751616 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 23:22:16.773928 140527680751616 dqn_agent.py:280] 	 optimizer: adam
I0902 23:22:16.774220 140527680751616 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 23:22:16.774397 140527680751616 dqn_agent.py:283] 	 seed: 1630624936772849
I0902 23:22:16.777208 140527680751616 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 23:22:16.777347 140527680751616 circular_replay_buffer.py:156] 	 observation_shape: (6, 1)
I0902 23:22:16.777431 140527680751616 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 23:22:16.777543 140527680751616 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 23:22:16.777709 140527680751616 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 23:22:16.777814 140527680751616 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 23:22:16.777928 140527680751616 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 23:22:16.778049 140527680751616 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 23:22:16.778145 140527680751616 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 23:22:16.805770 140527680751616 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 23:22:16.822836 140527680751616 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 23:22:16.823047 140527680751616 replay_runner.py:41] Starting iteration 0
INFO:tensorflow:Average training steps per second: 151.42
I0902 23:22:23.427329 140527680751616 replay_runner.py:36] Average training steps per second: 151.42
Steps executed: 500 Episode length: 500 Return: -500.0
I0902 23:22:24.782585 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 1

Steps executed: 174 Episode length: 174 Return: -173.0
INFO:tensorflow:Average training steps per second: 201.43

Steps executed: 388 Episode length: 214 Return: -213.0
I0902 23:22:30.302443 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -193.00
INFO:tensorflow:Starting iteration 2

Steps executed: 290 Episode length: 290 Return: -289.0
INFO:tensorflow:Average training steps per second: 202.25
I0902 23:22:35.489008 140527680751616 replay_runner.py:36] Average training steps per second: 202.25
I0902 23:22:35.740572 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -289.00
INFO:tensorflow:Starting iteration 3

Steps executed: 292 Episode length: 292 Return: -291.0
INFO:tensorflow:Average training steps per second: 194.03
I0902 23:22:41.139773 140527680751616 replay_runner.py:36] Average training steps per second: 194.03
I0902 23:22:41.380246 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -291.00
INFO:tensorflow:Starting iteration 4

Steps executed: 222 Episode length: 103 Return: -102.0
INFO:tensorflow:Average training steps per second: 197.89
I0902 23:22:46.666074 140527680751616 replay_runner.py:36] Average training steps per second: 197.89
I0902 23:22:46.859168 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -110.00
INFO:tensorflow:Starting iteration 5
I0902 23:22:47.102724 140527680751616 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 198.04

Steps executed: 399 Episode length: 399 Return: -398.0
I0902 23:22:52.480933 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -398.00
INFO:tensorflow:Starting iteration 6
I0902 23:22:52.716761 140527680751616 replay_runner.py:41] Starting iteration 6
INFO:tensorflow:Average training steps per second: 193.07
I0902 23:22:57.896851 140527680751616 replay_runner.py:36] Average training steps per second: 193.07

Steps executed: 363 Episode length: 262 Return: -261.0
INFO:tensorflow:Starting iteration 7
I0902 23:22:58.456811 140527680751616 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 200.39
I0902 23:23:03.447446 140527680751616 replay_runner.py:36] Average training steps per second: 200.39
I0902 23:23:03.673920 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -84.33
INFO:tensorflow:Starting iteration 8

Steps executed: 256 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 192.13
I0902 23:23:09.131105 140527680751616 replay_runner.py:36] Average training steps per second: 192.13
I0902 23:23:09.324541 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -111.50
INFO:tensorflow:Starting iteration 9

Steps executed: 225 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 199.39
I0902 23:23:14.573247 140527680751616 replay_runner.py:36] Average training steps per second: 199.39
I0902 23:23:15.012754 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 10


Steps executed: 251 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 199.28
I0902 23:23:20.286965 140527680751616 replay_runner.py:36] Average training steps per second: 199.28
I0902 23:23:20.503869 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -82.67
INFO:tensorflow:Starting iteration 11

Steps executed: 485 Episode length: 370 Return: -369.0
INFO:tensorflow:Average training steps per second: 193.31
I0902 23:23:25.917322 140527680751616 replay_runner.py:36] Average training steps per second: 193.31
I0902 23:23:26.332781 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -241.50
INFO:tensorflow:Starting iteration 12

Steps executed: 240 Episode length: 145 Return: -144.0
INFO:tensorflow:Average training steps per second: 205.49
I0902 23:23:31.442320 140527680751616 replay_runner.py:36] Average training steps per second: 205.49
I0902 23:23:31.665291 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -119.00
INFO:tensorflow:Starting iteration 13

Steps executed: 235 Episode length: 82 Return: -81.0.0
INFO:tensorflow:Average training steps per second: 190.86
I0902 23:23:37.159254 140527680751616 replay_runner.py:36] Average training steps per second: 190.86
I0902 23:23:37.352835 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -77.33
INFO:tensorflow:Starting iteration 14
I0902 23:23:37.585691 140527680751616 replay_runner.py:41] Starting iteration 14
INFO:tensorflow:Average training steps per second: 192.04

Steps executed: 226 Episode length: 76 Return: -75.0.0
I0902 23:23:43.003446 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -74.33
INFO:tensorflow:Starting iteration 15
I0902 23:23:43.250452 140527680751616 replay_runner.py:41] Starting iteration 15
INFO:tensorflow:Average training steps per second: 198.08

Steps executed: 205 Episode length: 113 Return: -112.0
I0902 23:23:48.467874 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -101.50
INFO:tensorflow:Starting iteration 16

Steps executed: 96 Episode length: 96 Return: -95.02.0
INFO:tensorflow:Average training steps per second: 191.40
I0902 23:23:53.933234 140527680751616 replay_runner.py:36] Average training steps per second: 191.40

Steps executed: 596 Episode length: 500 Return: -500.0
INFO:tensorflow:Starting iteration 17

Steps executed: 206 Episode length: 64 Return: -63.0.0
INFO:tensorflow:Average training steps per second: 208.04
I0902 23:23:59.477504 140527680751616 replay_runner.py:36] Average training steps per second: 208.04
I0902 23:23:59.675110 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -67.67
INFO:tensorflow:Starting iteration 18

Steps executed: 223 Episode length: 73 Return: -72.0.0
INFO:tensorflow:Average training steps per second: 193.58
I0902 23:24:05.101077 140527680751616 replay_runner.py:36] Average training steps per second: 193.58
I0902 23:24:05.286781 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -73.33
INFO:tensorflow:Starting iteration 19

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.76
I0902 23:24:10.605755 140527680751616 replay_runner.py:36] Average training steps per second: 196.76
I0902 23:24:11.048599 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 20

Steps executed: 403 Episode length: 403 Return: -402.0
INFO:tensorflow:Average training steps per second: 202.77
I0902 23:24:16.223653 140527680751616 replay_runner.py:36] Average training steps per second: 202.77
I0902 23:24:16.550658 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -402.00
INFO:tensorflow:Starting iteration 21

Steps executed: 200 Episode length: 78 Return: -77.0.0
INFO:tensorflow:Average training steps per second: 193.66
I0902 23:24:21.946109 140527680751616 replay_runner.py:36] Average training steps per second: 193.66
I0902 23:24:22.107549 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -99.00
INFO:tensorflow:Starting iteration 22

Steps executed: 617 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 203.71
I0902 23:24:27.244567 140527680751616 replay_runner.py:36] Average training steps per second: 203.71
I0902 23:24:27.801892 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -308.00
INFO:tensorflow:Starting iteration 23

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 196.59
I0902 23:24:33.138309 140527680751616 replay_runner.py:36] Average training steps per second: 196.59
I0902 23:24:33.542921 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 24

Steps executed: 99 Episode length: 99 Return: -98.00.0
INFO:tensorflow:Average training steps per second: 206.42
I0902 23:24:38.623057 140527680751616 replay_runner.py:36] Average training steps per second: 206.42

Steps executed: 304 Episode length: 108 Return: -107.0
INFO:tensorflow:Starting iteration 25

Steps executed: 500 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 199.70
I0902 23:24:44.096198 140527680751616 replay_runner.py:36] Average training steps per second: 199.70
I0902 23:24:44.465365 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -500.00
INFO:tensorflow:Starting iteration 26

Steps executed: 585 Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 215.26
I0902 23:24:49.337302 140527680751616 replay_runner.py:36] Average training steps per second: 215.26
I0902 23:24:49.810685 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -292.00
INFO:tensorflow:Starting iteration 27

Steps executed: 107 Episode length: 107 Return: -106.0
INFO:tensorflow:Average training steps per second: 209.02
I0902 23:24:54.827943 140527680751616 replay_runner.py:36] Average training steps per second: 209.02

Steps executed: 234 Episode length: 127 Return: -126.0
INFO:tensorflow:Starting iteration 28

Steps executed: 457 Episode length: 286 Return: -285.0
INFO:tensorflow:Average training steps per second: 203.52
I0902 23:25:00.169145 140527680751616 replay_runner.py:36] Average training steps per second: 203.52
I0902 23:25:00.529894 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -151.33
INFO:tensorflow:Starting iteration 29

Done fixed training!Episode length: 500 Return: -500.0
INFO:tensorflow:Average training steps per second: 204.80
I0902 23:25:05.655646 140527680751616 replay_runner.py:36] Average training steps per second: 204.80
I0902 23:25:06.169880 140527680751616 run_experiment.py:428] Average undiscounted return per evaluation episode: -311.50