Loaded trained dqn in lunarlander
Training fixed agent 10, please be patient, may be a while...
I0902 00:34:56.029101 139644712736768 run_experiment.py:549] Creating TrainRunner ...
I0902 00:34:56.038280 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:56.038460 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:56.038558 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:56.038640 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:56.038715 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:56.038788 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:56.038860 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:56.038962 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:56.039075 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:56.039166 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:56.039262 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:56.039352 139644712736768 dqn_agent.py:283] 	 seed: 1630542896038233
I0902 00:34:56.041528 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:56.041697 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:56.041824 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:56.041937 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:56.042021 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:56.042107 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:56.042216 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:56.042355 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:56.042448 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:56.072486 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:56.353012 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:56.361801 139644712736768 run_experiment.py:269] Reloaded checkpoint and will start from iteration 30
I0902 00:34:56.368921 139644712736768 dqn_agent.py:271] Creating JaxDQNAgentNew agent with the following parameters:
I0902 00:34:56.369055 139644712736768 dqn_agent.py:272] 	 gamma: 0.990000
I0902 00:34:56.369113 139644712736768 dqn_agent.py:273] 	 update_horizon: 1.000000
I0902 00:34:56.369190 139644712736768 dqn_agent.py:274] 	 min_replay_history: 500
I0902 00:34:56.369243 139644712736768 dqn_agent.py:275] 	 update_period: 4
I0902 00:34:56.369316 139644712736768 dqn_agent.py:276] 	 target_update_period: 300
I0902 00:34:56.369384 139644712736768 dqn_agent.py:277] 	 epsilon_train: 0.010000
I0902 00:34:56.369477 139644712736768 dqn_agent.py:278] 	 epsilon_eval: 0.001000
I0902 00:34:56.369553 139644712736768 dqn_agent.py:279] 	 epsilon_decay_period: 250000
I0902 00:34:56.369620 139644712736768 dqn_agent.py:280] 	 optimizer: adam
I0902 00:34:56.369692 139644712736768 dqn_agent.py:282] 	 max_tf_checkpoints_to_keep: 4
I0902 00:34:56.369758 139644712736768 dqn_agent.py:283] 	 seed: 1630542896368889
I0902 00:34:56.371158 139644712736768 circular_replay_buffer.py:155] Creating a OutOfGraphPrioritizedReplayBuffer replay memory with the following parameters:
I0902 00:34:56.371277 139644712736768 circular_replay_buffer.py:156] 	 observation_shape: (8, 1)
I0902 00:34:56.371357 139644712736768 circular_replay_buffer.py:157] 	 observation_dtype: <class 'jax._src.numpy.lax_numpy.float64'>
I0902 00:34:56.371419 139644712736768 circular_replay_buffer.py:158] 	 terminal_dtype: <class 'numpy.uint8'>
I0902 00:34:56.371482 139644712736768 circular_replay_buffer.py:159] 	 stack_size: 1
I0902 00:34:56.371554 139644712736768 circular_replay_buffer.py:160] 	 replay_capacity: 50000
I0902 00:34:56.371619 139644712736768 circular_replay_buffer.py:161] 	 batch_size: 128
I0902 00:34:56.371694 139644712736768 circular_replay_buffer.py:162] 	 update_horizon: 1
I0902 00:34:56.371747 139644712736768 circular_replay_buffer.py:163] 	 gamma: 0.990000
I0902 00:34:56.394618 139644712736768 dqn_agent.py:70] Creating Adam optimizer with settings lr=0.001000, beta1=0.900000, beta2=0.999000, eps=0.000313
I0902 00:34:56.408244 139644712736768 run_experiment.py:516] Beginning training...
INFO:tensorflow:Starting iteration 0
I0902 00:34:56.408394 139644712736768 replay_runner.py:41] Starting iteration 0
Steps executed: 275 Episode length: 96 Return: -597.1926262701068
INFO:tensorflow:Average training steps per second: 250.55
I0902 00:35:00.399967 139644712736768 replay_runner.py:36] Average training steps per second: 250.55
I0902 00:35:01.257699 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -490.33
INFO:tensorflow:Starting iteration 1

Steps executed: 158 Episode length: 158 Return: -129.94119393082258
INFO:tensorflow:Average training steps per second: 333.13

Steps executed: 293 Episode length: 135 Return: -354.36746093827728
I0902 00:35:07.701509 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -242.15
INFO:tensorflow:Starting iteration 2

Steps executed: 250 Episode length: 150 Return: -647.89578988707568
INFO:tensorflow:Average training steps per second: 331.89
I0902 00:35:14.015140 139644712736768 replay_runner.py:36] Average training steps per second: 331.89
I0902 00:35:14.179661 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -737.39
INFO:tensorflow:Starting iteration 3

Steps executed: 349 Episode length: 179 Return: -445.23888089802256
INFO:tensorflow:Average training steps per second: 324.81
I0902 00:35:20.624746 139644712736768 replay_runner.py:36] Average training steps per second: 324.81
I0902 00:35:20.871616 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -456.94
INFO:tensorflow:Starting iteration 4

Steps executed: 243 Episode length: 243 Return: -206.33896190643554
INFO:tensorflow:Average training steps per second: 337.38
I0902 00:35:27.236691 139644712736768 replay_runner.py:36] Average training steps per second: 337.38
I0902 00:35:27.432707 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -206.34
INFO:tensorflow:Starting iteration 5
I0902 00:35:30.803168 139644712736768 replay_runner.py:41] Starting iteration 5
INFO:tensorflow:Average training steps per second: 338.29

Steps executed: 333 Episode length: 143 Return: -437.28479491842124
I0902 00:35:33.978921 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -273.24
INFO:tensorflow:Starting iteration 6

Steps executed: 278 Episode length: 278 Return: -548.89840482543424
INFO:tensorflow:Average training steps per second: 340.76
I0902 00:35:40.293459 139644712736768 replay_runner.py:36] Average training steps per second: 340.76
I0902 00:35:40.537094 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -548.90
INFO:tensorflow:Starting iteration 7
I0902 00:35:43.931599 139644712736768 replay_runner.py:41] Starting iteration 7
INFO:tensorflow:Average training steps per second: 341.50
I0902 00:35:46.860109 139644712736768 replay_runner.py:36] Average training steps per second: 341.50

Steps executed: 244 Episode length: 104 Return: -105.33411570296634
INFO:tensorflow:Starting iteration 8

Steps executed: 374 Episode length: 211 Return: -580.52380844923824
INFO:tensorflow:Average training steps per second: 352.42
I0902 00:35:53.277122 139644712736768 replay_runner.py:36] Average training steps per second: 352.42
I0902 00:35:53.555008 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -511.05
INFO:tensorflow:Starting iteration 9

Steps executed: 162 Episode length: 162 Return: -467.55876819390974
INFO:tensorflow:Average training steps per second: 359.71

Steps executed: 570 Episode length: 408 Return: -937.65826121184954
I0902 00:36:00.413037 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -702.61
INFO:tensorflow:Starting iteration 10
I0902 00:36:03.844038 139644712736768 replay_runner.py:41] Starting iteration 10
INFO:tensorflow:Average training steps per second: 350.27
I0902 00:36:06.699241 139644712736768 replay_runner.py:36] Average training steps per second: 350.27

Steps executed: 335 Episode length: 163 Return: -201.19476563066692
INFO:tensorflow:Starting iteration 11

Steps executed: 304 Episode length: 153 Return: -253.66570346352978
INFO:tensorflow:Average training steps per second: 351.49
I0902 00:36:13.242959 139644712736768 replay_runner.py:36] Average training steps per second: 351.49
I0902 00:36:13.448017 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -283.09
INFO:tensorflow:Starting iteration 12
I0902 00:36:16.908454 139644712736768 replay_runner.py:41] Starting iteration 12
INFO:tensorflow:Average training steps per second: 342.46

Steps executed: 399 Episode length: 399 Return: -2075.1119742729378
I0902 00:36:20.249085 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -2075.11
INFO:tensorflow:Starting iteration 13

Steps executed: 482 Episode length: 318 Return: -877.49612119244118
INFO:tensorflow:Average training steps per second: 339.55
I0902 00:36:26.600884 139644712736768 replay_runner.py:36] Average training steps per second: 339.55
I0902 00:36:26.978349 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -506.81
INFO:tensorflow:Starting iteration 14

Steps executed: 268 Episode length: 214 Return: -226.67147633972398
INFO:tensorflow:Average training steps per second: 329.49
I0902 00:36:33.360348 139644712736768 replay_runner.py:36] Average training steps per second: 329.49
I0902 00:36:33.563960 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -189.85
INFO:tensorflow:Starting iteration 15

Steps executed: 313 Episode length: 117 Return: -901.25155831124464
INFO:tensorflow:Average training steps per second: 325.94
I0902 00:36:40.035201 139644712736768 replay_runner.py:36] Average training steps per second: 325.94
I0902 00:36:40.236927 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -535.65
INFO:tensorflow:Starting iteration 16

Steps executed: 337 Episode length: 152 Return: -159.23491800024217
INFO:tensorflow:Average training steps per second: 338.28
I0902 00:36:46.555508 139644712736768 replay_runner.py:36] Average training steps per second: 338.28
I0902 00:36:46.787717 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -428.69
INFO:tensorflow:Starting iteration 17

Steps executed: 258 Episode length: 86 Return: -798.842114795625867
INFO:tensorflow:Average training steps per second: 331.93
I0902 00:36:53.169391 139644712736768 replay_runner.py:36] Average training steps per second: 331.93
I0902 00:36:53.332758 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -458.86
INFO:tensorflow:Starting iteration 18

Steps executed: 151 Episode length: 151 Return: -274.56593763946387
INFO:tensorflow:Average training steps per second: 327.92
I0902 00:36:59.764589 139644712736768 replay_runner.py:36] Average training steps per second: 327.92

Steps executed: 202 Episode length: 51 Return: -231.015805908982487
INFO:tensorflow:Starting iteration 19
I0902 00:37:03.274581 139644712736768 replay_runner.py:41] Starting iteration 19
INFO:tensorflow:Average training steps per second: 326.84

Steps executed: 237 Episode length: 118 Return: -281.91767685662734
I0902 00:37:06.489145 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -304.28
INFO:tensorflow:Starting iteration 20

Steps executed: 245 Episode length: 56 Return: -262.950887290807447
INFO:tensorflow:Average training steps per second: 330.84
I0902 00:37:12.892655 139644712736768 replay_runner.py:36] Average training steps per second: 330.84
I0902 00:37:13.056080 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -505.98
INFO:tensorflow:Starting iteration 21

Steps executed: 263 Episode length: 69 Return: -283.634610888924165
INFO:tensorflow:Average training steps per second: 337.18
I0902 00:37:19.429341 139644712736768 replay_runner.py:36] Average training steps per second: 337.18
I0902 00:37:19.588425 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -234.78
INFO:tensorflow:Starting iteration 22

Steps executed: 96 Episode length: 96 Return: -715.1785828196339165
INFO:tensorflow:Average training steps per second: 336.42

Steps executed: 205 Episode length: 53 Return: -232.386422793307565
I0902 00:37:26.072442 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -409.95
INFO:tensorflow:Starting iteration 23

Steps executed: 254 Episode length: 62 Return: -440.950534432763865
INFO:tensorflow:Average training steps per second: 348.38
I0902 00:37:32.319411 139644712736768 replay_runner.py:36] Average training steps per second: 348.38
I0902 00:37:32.470997 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -411.57
INFO:tensorflow:Starting iteration 24

Steps executed: 220 Episode length: 86 Return: -236.581548614721585
INFO:tensorflow:Average training steps per second: 351.13
I0902 00:37:38.695248 139644712736768 replay_runner.py:36] Average training steps per second: 351.13
I0902 00:37:38.833058 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -307.18
INFO:tensorflow:Starting iteration 25

Steps executed: 279 Episode length: 88 Return: -455.461506477563665
INFO:tensorflow:Average training steps per second: 338.02
I0902 00:37:45.182148 139644712736768 replay_runner.py:36] Average training steps per second: 338.02
I0902 00:37:45.343709 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -229.26
INFO:tensorflow:Starting iteration 26

Steps executed: 209 Episode length: 70 Return: -128.531457410585435
INFO:tensorflow:Average training steps per second: 337.28
I0902 00:37:51.731783 139644712736768 replay_runner.py:36] Average training steps per second: 337.28
I0902 00:37:51.866014 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -120.27
INFO:tensorflow:Starting iteration 27

Steps executed: 249 Episode length: 125 Return: -176.60867537978625
INFO:tensorflow:Average training steps per second: 367.02
I0902 00:37:58.056478 139644712736768 replay_runner.py:36] Average training steps per second: 367.02
I0902 00:37:58.204389 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -152.44
INFO:tensorflow:Starting iteration 28

Steps executed: 223 Episode length: 101 Return: -790.56797572437615
INFO:tensorflow:Average training steps per second: 352.47
I0902 00:38:04.472988 139644712736768 replay_runner.py:36] Average training steps per second: 352.47
I0902 00:38:04.596861 139644712736768 run_experiment.py:428] Average undiscounted return per evaluation episode: -339.94
INFO:tensorflow:Starting iteration 29

Steps executed: 219 Episode length: 52 Return: -112.112071611568215
INFO:tensorflow:Average training steps per second: 381.25
I0902 00:38:10.610480 139644712736768 replay_runner.py:36] Average training steps per second: 381.25

Done fixed training!Episode length: 52 Return: -112.112071611568215